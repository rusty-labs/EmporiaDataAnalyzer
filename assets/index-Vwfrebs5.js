(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))n(i);new MutationObserver(i=>{for(const a of i)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(i){const a={};return i.integrity&&(a.integrity=i.integrity),i.referrerPolicy&&(a.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?a.credentials="include":i.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function n(i){if(i.ep)return;i.ep=!0;const a=r(i);fetch(i.href,a)}})();function p4(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var Ng={exports:{}};/* @license
Papa Parse
v5.5.1
https://github.com/mholt/PapaParse
License: MIT
*/var g4=Ng.exports,OA;function m4(){return OA||(OA=1,function(e,t){((r,n)=>{e.exports=n()})(g4,function r(){var n=typeof self<"u"?self:typeof window<"u"?window:n!==void 0?n:{},i,a=!n.document&&!!n.postMessage,o=n.IS_PAPA_WORKER||!1,s={},l=0,u={};function h(w){this._handle=null,this._finished=!1,this._completed=!1,this._halted=!1,this._input=null,this._baseIndex=0,this._partialLine="",this._rowCount=0,this._start=0,this._nextChunk=null,this.isFirstChunk=!0,this._completeResults={data:[],errors:[],meta:{}},(function(b){var A=T(b);A.chunkSize=parseInt(A.chunkSize),b.step||b.chunk||(A.chunkSize=null),this._handle=new p(A),(this._handle.streamer=this)._config=A}).call(this,w),this.parseChunk=function(b,A){var E=parseInt(this._config.skipFirstNLines)||0;if(this.isFirstChunk&&0<E){let D=this._config.newline;D||(C=this._config.quoteChar||'"',D=this._handle.guessLineEndings(b,C)),b=[...b.split(D).slice(E)].join(D)}this.isFirstChunk&&M(this._config.beforeFirstChunk)&&(C=this._config.beforeFirstChunk(b))!==void 0&&(b=C),this.isFirstChunk=!1,this._halted=!1;var E=this._partialLine+b,C=(this._partialLine="",this._handle.parse(E,this._baseIndex,!this._finished));if(!this._handle.paused()&&!this._handle.aborted()){if(b=C.meta.cursor,E=(this._finished||(this._partialLine=E.substring(b-this._baseIndex),this._baseIndex=b),C&&C.data&&(this._rowCount+=C.data.length),this._finished||this._config.preview&&this._rowCount>=this._config.preview),o)n.postMessage({results:C,workerId:u.WORKER_ID,finished:E});else if(M(this._config.chunk)&&!A){if(this._config.chunk(C,this._handle),this._handle.paused()||this._handle.aborted())return void(this._halted=!0);this._completeResults=C=void 0}return this._config.step||this._config.chunk||(this._completeResults.data=this._completeResults.data.concat(C.data),this._completeResults.errors=this._completeResults.errors.concat(C.errors),this._completeResults.meta=C.meta),this._completed||!E||!M(this._config.complete)||C&&C.meta.aborted||(this._config.complete(this._completeResults,this._input),this._completed=!0),E||C&&C.meta.paused||this._nextChunk(),C}this._halted=!0},this._sendError=function(b){M(this._config.error)?this._config.error(b):o&&this._config.error&&n.postMessage({workerId:u.WORKER_ID,error:b,finished:!1})}}function f(w){var b;(w=w||{}).chunkSize||(w.chunkSize=u.RemoteChunkSize),h.call(this,w),this._nextChunk=a?function(){this._readChunk(),this._chunkLoaded()}:function(){this._readChunk()},this.stream=function(A){this._input=A,this._nextChunk()},this._readChunk=function(){if(this._finished)this._chunkLoaded();else{if(b=new XMLHttpRequest,this._config.withCredentials&&(b.withCredentials=this._config.withCredentials),a||(b.onload=S(this._chunkLoaded,this),b.onerror=S(this._chunkError,this)),b.open(this._config.downloadRequestBody?"POST":"GET",this._input,!a),this._config.downloadRequestHeaders){var A,E=this._config.downloadRequestHeaders;for(A in E)b.setRequestHeader(A,E[A])}var C;this._config.chunkSize&&(C=this._start+this._config.chunkSize-1,b.setRequestHeader("Range","bytes="+this._start+"-"+C));try{b.send(this._config.downloadRequestBody)}catch(D){this._chunkError(D.message)}a&&b.status===0&&this._chunkError()}},this._chunkLoaded=function(){b.readyState===4&&(b.status<200||400<=b.status?this._chunkError():(this._start+=this._config.chunkSize||b.responseText.length,this._finished=!this._config.chunkSize||this._start>=(A=>(A=A.getResponseHeader("Content-Range"))!==null?parseInt(A.substring(A.lastIndexOf("/")+1)):-1)(b),this.parseChunk(b.responseText)))},this._chunkError=function(A){A=b.statusText||A,this._sendError(new Error(A))}}function c(w){(w=w||{}).chunkSize||(w.chunkSize=u.LocalChunkSize),h.call(this,w);var b,A,E=typeof FileReader<"u";this.stream=function(C){this._input=C,A=C.slice||C.webkitSlice||C.mozSlice,E?((b=new FileReader).onload=S(this._chunkLoaded,this),b.onerror=S(this._chunkError,this)):b=new FileReaderSync,this._nextChunk()},this._nextChunk=function(){this._finished||this._config.preview&&!(this._rowCount<this._config.preview)||this._readChunk()},this._readChunk=function(){var C=this._input,D=(this._config.chunkSize&&(D=Math.min(this._start+this._config.chunkSize,this._input.size),C=A.call(C,this._start,D)),b.readAsText(C,this._config.encoding));E||this._chunkLoaded({target:{result:D}})},this._chunkLoaded=function(C){this._start+=this._config.chunkSize,this._finished=!this._config.chunkSize||this._start>=this._input.size,this.parseChunk(C.target.result)},this._chunkError=function(){this._sendError(b.error)}}function d(w){var b;h.call(this,w=w||{}),this.stream=function(A){return b=A,this._nextChunk()},this._nextChunk=function(){var A,E;if(!this._finished)return A=this._config.chunkSize,b=A?(E=b.substring(0,A),b.substring(A)):(E=b,""),this._finished=!b,this.parseChunk(E)}}function v(w){h.call(this,w=w||{});var b=[],A=!0,E=!1;this.pause=function(){h.prototype.pause.apply(this,arguments),this._input.pause()},this.resume=function(){h.prototype.resume.apply(this,arguments),this._input.resume()},this.stream=function(C){this._input=C,this._input.on("data",this._streamData),this._input.on("end",this._streamEnd),this._input.on("error",this._streamError)},this._checkIsFinished=function(){E&&b.length===1&&(this._finished=!0)},this._nextChunk=function(){this._checkIsFinished(),b.length?this.parseChunk(b.shift()):A=!0},this._streamData=S(function(C){try{b.push(typeof C=="string"?C:C.toString(this._config.encoding)),A&&(A=!1,this._checkIsFinished(),this.parseChunk(b.shift()))}catch(D){this._streamError(D)}},this),this._streamError=S(function(C){this._streamCleanUp(),this._sendError(C)},this),this._streamEnd=S(function(){this._streamCleanUp(),E=!0,this._streamData("")},this),this._streamCleanUp=S(function(){this._input.removeListener("data",this._streamData),this._input.removeListener("end",this._streamEnd),this._input.removeListener("error",this._streamError)},this)}function p(w){var b,A,E,C,D=Math.pow(2,53),L=-D,P=/^\s*-?(\d+\.?|\.\d+|\d+\.\d+)([eE][-+]?\d+)?\s*$/,N=/^((\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d\.\d+([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z))|(\d{4}-[01]\d-[0-3]\dT[0-2]\d:[0-5]\d([+-][0-2]\d:[0-5]\d|Z)))$/,O=this,I=0,k=0,z=!1,X=!1,Y=[],$={data:[],errors:[],meta:{}};function H(tt){return w.skipEmptyLines==="greedy"?tt.join("").trim()==="":tt.length===1&&tt[0].length===0}function Z(){if($&&E&&(ut("Delimiter","UndetectableDelimiter","Unable to auto-detect delimiting character; defaulted to '"+u.DefaultDelimiter+"'"),E=!1),w.skipEmptyLines&&($.data=$.data.filter(function(dt){return!H(dt)})),ct()){let dt=function(At,G){M(w.transformHeader)&&(At=w.transformHeader(At,G)),Y.push(At)};var nt=dt;if($)if(Array.isArray($.data[0])){for(var tt=0;ct()&&tt<$.data.length;tt++)$.data[tt].forEach(dt);$.data.splice(0,1)}else $.data.forEach(dt)}function et(dt,At){for(var G=w.header?{}:[],Dt=0;Dt<dt.length;Dt++){var Pt=Dt,Lt=dt[Dt],Lt=((zt,ne)=>(kt=>(w.dynamicTypingFunction&&w.dynamicTyping[kt]===void 0&&(w.dynamicTyping[kt]=w.dynamicTypingFunction(kt)),(w.dynamicTyping[kt]||w.dynamicTyping)===!0))(zt)?ne==="true"||ne==="TRUE"||ne!=="false"&&ne!=="FALSE"&&((kt=>{if(P.test(kt)&&(kt=parseFloat(kt),L<kt&&kt<D))return 1})(ne)?parseFloat(ne):N.test(ne)?new Date(ne):ne===""?null:ne):ne)(Pt=w.header?Dt>=Y.length?"__parsed_extra":Y[Dt]:Pt,Lt=w.transform?w.transform(Lt,Pt):Lt);Pt==="__parsed_extra"?(G[Pt]=G[Pt]||[],G[Pt].push(Lt)):G[Pt]=Lt}return w.header&&(Dt>Y.length?ut("FieldMismatch","TooManyFields","Too many fields: expected "+Y.length+" fields but parsed "+Dt,k+At):Dt<Y.length&&ut("FieldMismatch","TooFewFields","Too few fields: expected "+Y.length+" fields but parsed "+Dt,k+At)),G}var st;$&&(w.header||w.dynamicTyping||w.transform)&&(st=1,!$.data.length||Array.isArray($.data[0])?($.data=$.data.map(et),st=$.data.length):$.data=et($.data,0),w.header&&$.meta&&($.meta.fields=Y),k+=st)}function ct(){return w.header&&Y.length===0}function ut(tt,et,st,nt){tt={type:tt,code:et,message:st},nt!==void 0&&(tt.row=nt),$.errors.push(tt)}M(w.step)&&(C=w.step,w.step=function(tt){$=tt,ct()?Z():(Z(),$.data.length!==0&&(I+=tt.data.length,w.preview&&I>w.preview?A.abort():($.data=$.data[0],C($,O))))}),this.parse=function(tt,et,st){var nt=w.quoteChar||'"',nt=(w.newline||(w.newline=this.guessLineEndings(tt,nt)),E=!1,w.delimiter?M(w.delimiter)&&(w.delimiter=w.delimiter(tt),$.meta.delimiter=w.delimiter):((nt=((dt,At,G,Dt,Pt)=>{var Lt,zt,ne,kt;Pt=Pt||[",","	","|",";",u.RECORD_SEP,u.UNIT_SEP];for(var V=0;V<Pt.length;V++){for(var F,Q=Pt[V],_t=0,gt=0,pt=0,jt=(ne=void 0,new m({comments:Dt,delimiter:Q,newline:At,preview:10}).parse(dt)),Gt=0;Gt<jt.data.length;Gt++)G&&H(jt.data[Gt])?pt++:(F=jt.data[Gt].length,gt+=F,ne===void 0?ne=F:0<F&&(_t+=Math.abs(F-ne),ne=F));0<jt.data.length&&(gt/=jt.data.length-pt),(zt===void 0||_t<=zt)&&(kt===void 0||kt<gt)&&1.99<gt&&(zt=_t,Lt=Q,kt=gt)}return{successful:!!(w.delimiter=Lt),bestDelimiter:Lt}})(tt,w.newline,w.skipEmptyLines,w.comments,w.delimitersToGuess)).successful?w.delimiter=nt.bestDelimiter:(E=!0,w.delimiter=u.DefaultDelimiter),$.meta.delimiter=w.delimiter),T(w));return w.preview&&w.header&&nt.preview++,b=tt,A=new m(nt),$=A.parse(b,et,st),Z(),z?{meta:{paused:!0}}:$||{meta:{paused:!1}}},this.paused=function(){return z},this.pause=function(){z=!0,A.abort(),b=M(w.chunk)?"":b.substring(A.getCharIndex())},this.resume=function(){O.streamer._halted?(z=!1,O.streamer.parseChunk(b,!0)):setTimeout(O.resume,3)},this.aborted=function(){return X},this.abort=function(){X=!0,A.abort(),$.meta.aborted=!0,M(w.complete)&&w.complete($),b=""},this.guessLineEndings=function(dt,nt){dt=dt.substring(0,1048576);var nt=new RegExp(g(nt)+"([^]*?)"+g(nt),"gm"),st=(dt=dt.replace(nt,"")).split("\r"),nt=dt.split(`
`),dt=1<nt.length&&nt[0].length<st[0].length;if(st.length===1||dt)return`
`;for(var At=0,G=0;G<st.length;G++)st[G][0]===`
`&&At++;return At>=st.length/2?`\r
`:"\r"}}function g(w){return w.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function m(w){var b=(w=w||{}).delimiter,A=w.newline,E=w.comments,C=w.step,D=w.preview,L=w.fastMode,P=null,N=w.quoteChar==null?'"':w.quoteChar,O=N;if(w.escapeChar!==void 0&&(O=w.escapeChar),(typeof b!="string"||-1<u.BAD_DELIMITERS.indexOf(b))&&(b=","),E===b)throw new Error("Comment character same as delimiter");E===!0?E="#":(typeof E!="string"||-1<u.BAD_DELIMITERS.indexOf(E))&&(E=!1),A!==`
`&&A!=="\r"&&A!==`\r
`&&(A=`
`);var I=0,k=!1;this.parse=function(z,X,Y){if(typeof z!="string")throw new Error("Input must be a string");var $=z.length,H=b.length,Z=A.length,ct=E.length,ut=M(C),tt=[],et=[],st=[],nt=I=0;if(!z)return Q();if(L||L!==!1&&z.indexOf(N)===-1){for(var dt=z.split(A),At=0;At<dt.length;At++){if(st=dt[At],I+=st.length,At!==dt.length-1)I+=A.length;else if(Y)return Q();if(!E||st.substring(0,ct)!==E){if(ut){if(tt=[],ne(st.split(b)),_t(),k)return Q()}else ne(st.split(b));if(D&&D<=At)return tt=tt.slice(0,D),Q(!0)}}return Q()}for(var G=z.indexOf(b,I),Dt=z.indexOf(A,I),Pt=new RegExp(g(O)+g(N),"g"),Lt=z.indexOf(N,I);;)if(z[I]===N)for(Lt=I,I++;;){if((Lt=z.indexOf(N,Lt+1))===-1)return Y||et.push({type:"Quotes",code:"MissingQuotes",message:"Quoted field unterminated",row:tt.length,index:I}),V();if(Lt===$-1)return V(z.substring(I,Lt).replace(Pt,N));if(N===O&&z[Lt+1]===O)Lt++;else if(N===O||Lt===0||z[Lt-1]!==O){G!==-1&&G<Lt+1&&(G=z.indexOf(b,Lt+1));var zt=kt((Dt=Dt!==-1&&Dt<Lt+1?z.indexOf(A,Lt+1):Dt)===-1?G:Math.min(G,Dt));if(z.substr(Lt+1+zt,H)===b){st.push(z.substring(I,Lt).replace(Pt,N)),z[I=Lt+1+zt+H]!==N&&(Lt=z.indexOf(N,I)),G=z.indexOf(b,I),Dt=z.indexOf(A,I);break}if(zt=kt(Dt),z.substring(Lt+1+zt,Lt+1+zt+Z)===A){if(st.push(z.substring(I,Lt).replace(Pt,N)),F(Lt+1+zt+Z),G=z.indexOf(b,I),Lt=z.indexOf(N,I),ut&&(_t(),k))return Q();if(D&&tt.length>=D)return Q(!0);break}et.push({type:"Quotes",code:"InvalidQuotes",message:"Trailing quote on quoted field is malformed",row:tt.length,index:I}),Lt++}}else if(E&&st.length===0&&z.substring(I,I+ct)===E){if(Dt===-1)return Q();I=Dt+Z,Dt=z.indexOf(A,I),G=z.indexOf(b,I)}else if(G!==-1&&(G<Dt||Dt===-1))st.push(z.substring(I,G)),I=G+H,G=z.indexOf(b,I);else{if(Dt===-1)break;if(st.push(z.substring(I,Dt)),F(Dt+Z),ut&&(_t(),k))return Q();if(D&&tt.length>=D)return Q(!0)}return V();function ne(gt){tt.push(gt),nt=I}function kt(gt){var pt=0;return pt=gt!==-1&&(gt=z.substring(Lt+1,gt))&&gt.trim()===""?gt.length:pt}function V(gt){return Y||(gt===void 0&&(gt=z.substring(I)),st.push(gt),I=$,ne(st),ut&&_t()),Q()}function F(gt){I=gt,ne(st),st=[],Dt=z.indexOf(A,I)}function Q(gt){if(w.header&&!X&&tt.length){var pt=tt[0],jt={},Gt=new Set(pt);let Jt=!1;for(let Ne=0;Ne<pt.length;Ne++){let wt=pt[Ne];if(jt[wt=M(w.transformHeader)?w.transformHeader(wt,Ne):wt]){let qt,de=jt[wt];for(;qt=wt+"_"+de,de++,Gt.has(qt););Gt.add(qt),pt[Ne]=qt,jt[wt]++,Jt=!0,(P=P===null?{}:P)[qt]=wt}else jt[wt]=1,pt[Ne]=wt;Gt.add(wt)}Jt&&console.warn("Duplicate headers found and renamed.")}return{data:tt,errors:et,meta:{delimiter:b,linebreak:A,aborted:k,truncated:!!gt,cursor:nt+(X||0),renamedHeaders:P}}}function _t(){C(Q()),tt=[],et=[]}},this.abort=function(){k=!0},this.getCharIndex=function(){return I}}function _(w){var b=w.data,A=s[b.workerId],E=!1;if(b.error)A.userError(b.error,b.file);else if(b.results&&b.results.data){var C={abort:function(){E=!0,y(b.workerId,{data:[],errors:[],meta:{aborted:!0}})},pause:x,resume:x};if(M(A.userStep)){for(var D=0;D<b.results.data.length&&(A.userStep({data:b.results.data[D],errors:b.results.errors,meta:b.results.meta},C),!E);D++);delete b.results}else M(A.userChunk)&&(A.userChunk(b.results,C,b.file),delete b.results)}b.finished&&!E&&y(b.workerId,b.results)}function y(w,b){var A=s[w];M(A.userComplete)&&A.userComplete(b),A.terminate(),delete s[w]}function x(){throw new Error("Not implemented.")}function T(w){if(typeof w!="object"||w===null)return w;var b,A=Array.isArray(w)?[]:{};for(b in w)A[b]=T(w[b]);return A}function S(w,b){return function(){w.apply(b,arguments)}}function M(w){return typeof w=="function"}return u.parse=function(w,b){var A=(b=b||{}).dynamicTyping||!1;if(M(A)&&(b.dynamicTypingFunction=A,A={}),b.dynamicTyping=A,b.transform=!!M(b.transform)&&b.transform,!b.worker||!u.WORKERS_SUPPORTED)return A=null,u.NODE_STREAM_INPUT,typeof w=="string"?(w=(E=>E.charCodeAt(0)!==65279?E:E.slice(1))(w),A=new(b.download?f:d)(b)):w.readable===!0&&M(w.read)&&M(w.on)?A=new v(b):(n.File&&w instanceof File||w instanceof Object)&&(A=new c(b)),A.stream(w);(A=(()=>{var E;return!!u.WORKERS_SUPPORTED&&(E=(()=>{var C=n.URL||n.webkitURL||null,D=r.toString();return u.BLOB_URL||(u.BLOB_URL=C.createObjectURL(new Blob(["var global = (function() { if (typeof self !== 'undefined') { return self; } if (typeof window !== 'undefined') { return window; } if (typeof global !== 'undefined') { return global; } return {}; })(); global.IS_PAPA_WORKER=true; ","(",D,")();"],{type:"text/javascript"})))})(),(E=new n.Worker(E)).onmessage=_,E.id=l++,s[E.id]=E)})()).userStep=b.step,A.userChunk=b.chunk,A.userComplete=b.complete,A.userError=b.error,b.step=M(b.step),b.chunk=M(b.chunk),b.complete=M(b.complete),b.error=M(b.error),delete b.worker,A.postMessage({input:w,config:b,workerId:A.id})},u.unparse=function(w,b){var A=!1,E=!0,C=",",D=`\r
`,L='"',P=L+L,N=!1,O=null,I=!1,k=((()=>{if(typeof b=="object"){if(typeof b.delimiter!="string"||u.BAD_DELIMITERS.filter(function(Y){return b.delimiter.indexOf(Y)!==-1}).length||(C=b.delimiter),typeof b.quotes!="boolean"&&typeof b.quotes!="function"&&!Array.isArray(b.quotes)||(A=b.quotes),typeof b.skipEmptyLines!="boolean"&&typeof b.skipEmptyLines!="string"||(N=b.skipEmptyLines),typeof b.newline=="string"&&(D=b.newline),typeof b.quoteChar=="string"&&(L=b.quoteChar),typeof b.header=="boolean"&&(E=b.header),Array.isArray(b.columns)){if(b.columns.length===0)throw new Error("Option columns is empty");O=b.columns}b.escapeChar!==void 0&&(P=b.escapeChar+L),b.escapeFormulae instanceof RegExp?I=b.escapeFormulae:typeof b.escapeFormulae=="boolean"&&b.escapeFormulae&&(I=/^[=+\-@\t\r].*$/)}})(),new RegExp(g(L),"g"));if(typeof w=="string"&&(w=JSON.parse(w)),Array.isArray(w)){if(!w.length||Array.isArray(w[0]))return z(null,w,N);if(typeof w[0]=="object")return z(O||Object.keys(w[0]),w,N)}else if(typeof w=="object")return typeof w.data=="string"&&(w.data=JSON.parse(w.data)),Array.isArray(w.data)&&(w.fields||(w.fields=w.meta&&w.meta.fields||O),w.fields||(w.fields=Array.isArray(w.data[0])?w.fields:typeof w.data[0]=="object"?Object.keys(w.data[0]):[]),Array.isArray(w.data[0])||typeof w.data[0]=="object"||(w.data=[w.data])),z(w.fields||[],w.data||[],N);throw new Error("Unable to serialize unrecognized input");function z(Y,$,H){var Z="",ct=(typeof Y=="string"&&(Y=JSON.parse(Y)),typeof $=="string"&&($=JSON.parse($)),Array.isArray(Y)&&0<Y.length),ut=!Array.isArray($[0]);if(ct&&E){for(var tt=0;tt<Y.length;tt++)0<tt&&(Z+=C),Z+=X(Y[tt],tt);0<$.length&&(Z+=D)}for(var et=0;et<$.length;et++){var st=(ct?Y:$[et]).length,nt=!1,dt=ct?Object.keys($[et]).length===0:$[et].length===0;if(H&&!ct&&(nt=H==="greedy"?$[et].join("").trim()==="":$[et].length===1&&$[et][0].length===0),H==="greedy"&&ct){for(var At=[],G=0;G<st;G++){var Dt=ut?Y[G]:G;At.push($[et][Dt])}nt=At.join("").trim()===""}if(!nt){for(var Pt=0;Pt<st;Pt++){0<Pt&&!dt&&(Z+=C);var Lt=ct&&ut?Y[Pt]:Pt;Z+=X($[et][Lt],Pt)}et<$.length-1&&(!H||0<st&&!dt)&&(Z+=D)}}return Z}function X(Y,$){var H,Z;return Y==null?"":Y.constructor===Date?JSON.stringify(Y).slice(1,25):(Z=!1,I&&typeof Y=="string"&&I.test(Y)&&(Y="'"+Y,Z=!0),H=Y.toString().replace(k,P),(Z=Z||A===!0||typeof A=="function"&&A(Y,$)||Array.isArray(A)&&A[$]||((ct,ut)=>{for(var tt=0;tt<ut.length;tt++)if(-1<ct.indexOf(ut[tt]))return!0;return!1})(H,u.BAD_DELIMITERS)||-1<H.indexOf(C)||H.charAt(0)===" "||H.charAt(H.length-1)===" ")?L+H+L:H)}},u.RECORD_SEP="",u.UNIT_SEP="",u.BYTE_ORDER_MARK="\uFEFF",u.BAD_DELIMITERS=["\r",`
`,'"',u.BYTE_ORDER_MARK],u.WORKERS_SUPPORTED=!a&&!!n.Worker,u.NODE_STREAM_INPUT=1,u.LocalChunkSize=10485760,u.RemoteChunkSize=5242880,u.DefaultDelimiter=",",u.Parser=m,u.ParserHandle=p,u.NetworkStreamer=f,u.FileStreamer=c,u.StringStreamer=d,u.ReadableStreamStreamer=v,n.jQuery&&((i=n.jQuery).fn.parse=function(w){var b=w.config||{},A=[];return this.each(function(D){if(!(i(this).prop("tagName").toUpperCase()==="INPUT"&&i(this).attr("type").toLowerCase()==="file"&&n.FileReader)||!this.files||this.files.length===0)return!0;for(var L=0;L<this.files.length;L++)A.push({file:this.files[L],inputElem:this,instanceConfig:i.extend({},b)})}),E(),this;function E(){if(A.length===0)M(w.complete)&&w.complete();else{var D,L,P,N,O=A[0];if(M(w.before)){var I=w.before(O.file,O.inputElem);if(typeof I=="object"){if(I.action==="abort")return D="AbortError",L=O.file,P=O.inputElem,N=I.reason,void(M(w.error)&&w.error({name:D},L,P,N));if(I.action==="skip")return void C();typeof I.config=="object"&&(O.instanceConfig=i.extend(O.instanceConfig,I.config))}else if(I==="skip")return void C()}var k=O.instanceConfig.complete;O.instanceConfig.complete=function(z){M(k)&&k(z,O.file,O.inputElem),C()},u.parse(O.file,O.instanceConfig)}}function C(){A.splice(0,1),E()}}),o&&(n.onmessage=function(w){w=w.data,u.WORKER_ID===void 0&&w&&(u.WORKER_ID=w.workerId),typeof w.input=="string"?n.postMessage({workerId:u.WORKER_ID,results:u.parse(w.input,w.config),finished:!0}):(n.File&&w.input instanceof File||w.input instanceof Object)&&(w=u.parse(w.input,w.config))&&n.postMessage({workerId:u.WORKER_ID,results:w,finished:!0})}),(f.prototype=Object.create(h.prototype)).constructor=f,(c.prototype=Object.create(h.prototype)).constructor=c,(d.prototype=Object.create(d.prototype)).constructor=d,(v.prototype=Object.create(h.prototype)).constructor=v,u})}(Ng)),Ng.exports}var _4=m4();const y4=p4(_4);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var K1=function(e,t){return K1=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(r,n){r.__proto__=n}||function(r,n){for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])},K1(e,t)};function q(e,t){if(typeof t!="function"&&t!==null)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");K1(e,t);function r(){this.constructor=e}e.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)}var x4=function(){function e(){this.firefox=!1,this.ie=!1,this.edge=!1,this.newEdge=!1,this.weChat=!1}return e}(),S4=function(){function e(){this.browser=new x4,this.node=!1,this.wxa=!1,this.worker=!1,this.svgSupported=!1,this.touchEventsSupported=!1,this.pointerEventsSupported=!1,this.domSupported=!1,this.transformSupported=!1,this.transform3dSupported=!1,this.hasGlobalWindow=typeof window<"u"}return e}(),ye=new S4;typeof wx=="object"&&typeof wx.getSystemInfoSync=="function"?(ye.wxa=!0,ye.touchEventsSupported=!0):typeof document>"u"&&typeof self<"u"?ye.worker=!0:!ye.hasGlobalWindow||"Deno"in window?(ye.node=!0,ye.svgSupported=!0):T4(navigator.userAgent,ye);function T4(e,t){var r=t.browser,n=e.match(/Firefox\/([\d.]+)/),i=e.match(/MSIE\s([\d.]+)/)||e.match(/Trident\/.+?rv:(([\d.]+))/),a=e.match(/Edge?\/([\d.]+)/),o=/micromessenger/i.test(e);n&&(r.firefox=!0,r.version=n[1]),i&&(r.ie=!0,r.version=i[1]),a&&(r.edge=!0,r.version=a[1],r.newEdge=+a[1].split(".")[0]>18),o&&(r.weChat=!0),t.svgSupported=typeof SVGRect<"u",t.touchEventsSupported="ontouchstart"in window&&!r.ie&&!r.edge,t.pointerEventsSupported="onpointerdown"in window&&(r.edge||r.ie&&+r.version>=11),t.domSupported=typeof document<"u";var s=document.documentElement.style;t.transform3dSupported=(r.ie&&"transition"in s||r.edge||"WebKitCSSMatrix"in window&&"m11"in new WebKitCSSMatrix||"MozPerspective"in s)&&!("OTransition"in s),t.transformSupported=t.transform3dSupported||r.ie&&+r.version>=9}var zb=12,GN="sans-serif",Is=zb+"px "+GN,b4=20,w4=100,M4="007LLmW'55;N0500LLLLLLLLLL00NNNLzWW\\\\WQb\\0FWLg\\bWb\\WQ\\WrWWQ000CL5LLFLL0LL**F*gLLLL5F0LF\\FFF5.5N";function A4(e){var t={};if(typeof JSON>"u")return t;for(var r=0;r<e.length;r++){var n=String.fromCharCode(r+32),i=(e.charCodeAt(r)-b4)/w4;t[n]=i}return t}var E4=A4(M4),Ns={createCanvas:function(){return typeof document<"u"&&document.createElement("canvas")},measureText:function(){var e,t;return function(r,n){if(!e){var i=Ns.createCanvas();e=i&&i.getContext("2d")}if(e)return t!==n&&(t=e.font=n||Is),e.measureText(r);r=r||"",n=n||Is;var a=/((?:\d+)?\.?\d*)px/.exec(n),o=a&&+a[1]||zb,s=0;if(n.indexOf("mono")>=0)s=o*r.length;else for(var l=0;l<r.length;l++){var u=E4[r[l]];s+=u==null?o:u*o}return{width:s}}}(),loadImage:function(e,t,r){var n=new Image;return n.onload=t,n.onerror=r,n.src=e,n}},VN=ma(["Function","RegExp","Date","Error","CanvasGradient","CanvasPattern","Image","Canvas"],function(e,t){return e["[object "+t+"]"]=!0,e},{}),HN=ma(["Int8","Uint8","Uint8Clamped","Int16","Uint16","Int32","Uint32","Float32","Float64"],function(e,t){return e["[object "+t+"Array]"]=!0,e},{}),Of=Object.prototype.toString,x_=Array.prototype,C4=x_.forEach,D4=x_.filter,kb=x_.slice,L4=x_.map,FA=(function(){}).constructor,$v=FA?FA.prototype:null,Gb="__proto__",R4=2311;function WN(){return R4++}function Vb(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];typeof console<"u"&&console.error.apply(console,e)}function Qt(e){if(e==null||typeof e!="object")return e;var t=e,r=Of.call(e);if(r==="[object Array]"){if(!pd(e)){t=[];for(var n=0,i=e.length;n<i;n++)t[n]=Qt(e[n])}}else if(HN[r]){if(!pd(e)){var a=e.constructor;if(a.from)t=a.from(e);else{t=new a(e.length);for(var n=0,i=e.length;n<i;n++)t[n]=e[n]}}}else if(!VN[r]&&!pd(e)&&!lf(e)){t={};for(var o in e)e.hasOwnProperty(o)&&o!==Gb&&(t[o]=Qt(e[o]))}return t}function Ot(e,t,r){if(!Kt(t)||!Kt(e))return r?Qt(t):e;for(var n in t)if(t.hasOwnProperty(n)&&n!==Gb){var i=e[n],a=t[n];Kt(a)&&Kt(i)&&!at(a)&&!at(i)&&!lf(a)&&!lf(i)&&!BA(a)&&!BA(i)&&!pd(a)&&!pd(i)?Ot(i,a,r):(r||!(n in e))&&(e[n]=Qt(t[n]))}return e}function Hb(e,t){for(var r=e[0],n=1,i=e.length;n<i;n++)r=Ot(r,e[n],t);return r}function rt(e,t){if(Object.assign)Object.assign(e,t);else for(var r in t)t.hasOwnProperty(r)&&r!==Gb&&(e[r]=t[r]);return e}function Vt(e,t,r){for(var n=be(t),i=0,a=n.length;i<a;i++){var o=n[i];(r?t[o]!=null:e[o]==null)&&(e[o]=t[o])}return e}function pe(e,t){if(e){if(e.indexOf)return e.indexOf(t);for(var r=0,n=e.length;r<n;r++)if(e[r]===t)return r}return-1}function Wb(e,t){var r=e.prototype;function n(){}n.prototype=t.prototype,e.prototype=new n;for(var i in r)r.hasOwnProperty(i)&&(e.prototype[i]=r[i]);e.prototype.constructor=e,e.superClass=t}function Nr(e,t,r){if(e="prototype"in e?e.prototype:e,t="prototype"in t?t.prototype:t,Object.getOwnPropertyNames)for(var n=Object.getOwnPropertyNames(t),i=0;i<n.length;i++){var a=n[i];a!=="constructor"&&(r?t[a]!=null:e[a]==null)&&(e[a]=t[a])}else Vt(e,t,r)}function Dn(e){return!e||typeof e=="string"?!1:typeof e.length=="number"}function R(e,t,r){if(e&&t)if(e.forEach&&e.forEach===C4)e.forEach(t,r);else if(e.length===+e.length)for(var n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(r,e[a],a,e)}function ft(e,t,r){if(!e)return[];if(!t)return Xb(e);if(e.map&&e.map===L4)return e.map(t,r);for(var n=[],i=0,a=e.length;i<a;i++)n.push(t.call(r,e[i],i,e));return n}function ma(e,t,r,n){if(e&&t){for(var i=0,a=e.length;i<a;i++)r=t.call(n,r,e[i],i,e);return r}}function Xe(e,t,r){if(!e)return[];if(!t)return Xb(e);if(e.filter&&e.filter===D4)return e.filter(t,r);for(var n=[],i=0,a=e.length;i<a;i++)t.call(r,e[i],i,e)&&n.push(e[i]);return n}function P4(e,t,r){if(e&&t){for(var n=0,i=e.length;n<i;n++)if(t.call(r,e[n],n,e))return e[n]}}function be(e){if(!e)return[];if(Object.keys)return Object.keys(e);var t=[];for(var r in e)e.hasOwnProperty(r)&&t.push(r);return t}function I4(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return function(){return e.apply(t,r.concat(kb.call(arguments)))}}var It=$v&&Yt($v.bind)?$v.call.bind($v.bind):I4;function ue(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return function(){return e.apply(this,t.concat(kb.call(arguments)))}}function at(e){return Array.isArray?Array.isArray(e):Of.call(e)==="[object Array]"}function Yt(e){return typeof e=="function"}function Ct(e){return typeof e=="string"}function j1(e){return Of.call(e)==="[object String]"}function Be(e){return typeof e=="number"}function Kt(e){var t=typeof e;return t==="function"||!!e&&t==="object"}function BA(e){return!!VN[Of.call(e)]}function fi(e){return!!HN[Of.call(e)]}function lf(e){return typeof e=="object"&&typeof e.nodeType=="number"&&typeof e.ownerDocument=="object"}function S_(e){return e.colorStops!=null}function N4(e){return e.image!=null}function O4(e){return Of.call(e)==="[object RegExp]"}function Id(e){return e!==e}function pn(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var r=0,n=e.length;r<n;r++)if(e[r]!=null)return e[r]}function se(e,t){return e??t}function Ga(e,t,r){return e??t??r}function Xb(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];return kb.apply(e,t)}function Yb(e){if(typeof e=="number")return[e,e,e,e];var t=e.length;return t===2?[e[0],e[1],e[0],e[1]]:t===3?[e[0],e[1],e[2],e[1]]:e}function Hn(e,t){if(!e)throw new Error(t)}function ha(e){return e==null?null:typeof e.trim=="function"?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}var XN="__ec_primitive__";function fm(e){e[XN]=!0}function pd(e){return e[XN]}var F4=function(){function e(){this.data={}}return e.prototype.delete=function(t){var r=this.has(t);return r&&delete this.data[t],r},e.prototype.has=function(t){return this.data.hasOwnProperty(t)},e.prototype.get=function(t){return this.data[t]},e.prototype.set=function(t,r){return this.data[t]=r,this},e.prototype.keys=function(){return be(this.data)},e.prototype.forEach=function(t){var r=this.data;for(var n in r)r.hasOwnProperty(n)&&t(r[n],n)},e}(),YN=typeof Map=="function";function B4(){return YN?new Map:new F4}var U4=function(){function e(t){var r=at(t);this.data=B4();var n=this;t instanceof e?t.each(i):t&&R(t,i);function i(a,o){r?n.set(a,o):n.set(o,a)}}return e.prototype.hasKey=function(t){return this.data.has(t)},e.prototype.get=function(t){return this.data.get(t)},e.prototype.set=function(t,r){return this.data.set(t,r),r},e.prototype.each=function(t,r){this.data.forEach(function(n,i){t.call(r,n,i)})},e.prototype.keys=function(){var t=this.data.keys();return YN?Array.from(t):t},e.prototype.removeKey=function(t){this.data.delete(t)},e}();function Ut(e){return new U4(e)}function yu(e,t){for(var r=new e.constructor(e.length+t.length),n=0;n<e.length;n++)r[n]=e[n];for(var i=e.length,n=0;n<t.length;n++)r[n+i]=t[n];return r}function T_(e,t){var r;if(Object.create)r=Object.create(e);else{var n=function(){};n.prototype=e,r=new n}return t&&rt(r,t),r}function ZN(e){var t=e.style;t.webkitUserSelect="none",t.userSelect="none",t.webkitTapHighlightColor="rgba(0,0,0,0)",t["-webkit-touch-callout"]="none"}function Ft(e,t){return e.hasOwnProperty(t)}function Rr(){}var Og=180/Math.PI;function Ou(e,t){return e==null&&(e=0),t==null&&(t=0),[e,t]}function On(e,t){return e[0]=t[0],e[1]=t[1],e}function bo(e){return[e[0],e[1]]}function z4(e,t,r){return e[0]=t,e[1]=r,e}function UA(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e}function J1(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e}function $l(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e}function Q1(e){return Math.sqrt(k4(e))}function k4(e){return e[0]*e[0]+e[1]*e[1]}function Fg(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e}function Ff(e,t){var r=Q1(t);return r===0?(e[0]=0,e[1]=0):(e[0]=t[0]/r,e[1]=t[1]/r),e}function tS(e,t){return Math.sqrt((e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1]))}var gs=tS;function G4(e,t){return(e[0]-t[0])*(e[0]-t[0])+(e[1]-t[1])*(e[1]-t[1])}var lu=G4;function Bg(e,t,r,n){return e[0]=t[0]+n*(r[0]-t[0]),e[1]=t[1]+n*(r[1]-t[1]),e}function en(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e}function ms(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e}function _s(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e}var qu=function(){function e(t,r){this.target=t,this.topTarget=r&&r.topTarget}return e}(),V4=function(){function e(t){this.handler=t,t.on("mousedown",this._dragStart,this),t.on("mousemove",this._drag,this),t.on("mouseup",this._dragEnd,this)}return e.prototype._dragStart=function(t){for(var r=t.target;r&&!r.draggable;)r=r.parent||r.__hostTarget;r&&(this._draggingTarget=r,r.dragging=!0,this._x=t.offsetX,this._y=t.offsetY,this.handler.dispatchToElement(new qu(r,t),"dragstart",t.event))},e.prototype._drag=function(t){var r=this._draggingTarget;if(r){var n=t.offsetX,i=t.offsetY,a=n-this._x,o=i-this._y;this._x=n,this._y=i,r.drift(a,o,t),this.handler.dispatchToElement(new qu(r,t),"drag",t.event);var s=this.handler.findHover(n,i,r).target,l=this._dropTarget;this._dropTarget=s,r!==s&&(l&&s!==l&&this.handler.dispatchToElement(new qu(l,t),"dragleave",t.event),s&&s!==l&&this.handler.dispatchToElement(new qu(s,t),"dragenter",t.event))}},e.prototype._dragEnd=function(t){var r=this._draggingTarget;r&&(r.dragging=!1),this.handler.dispatchToElement(new qu(r,t),"dragend",t.event),this._dropTarget&&this.handler.dispatchToElement(new qu(this._dropTarget,t),"drop",t.event),this._draggingTarget=null,this._dropTarget=null},e}(),Zi=function(){function e(t){t&&(this._$eventProcessor=t)}return e.prototype.on=function(t,r,n,i){this._$handlers||(this._$handlers={});var a=this._$handlers;if(typeof r=="function"&&(i=n,n=r,r=null),!n||!t)return this;var o=this._$eventProcessor;r!=null&&o&&o.normalizeQuery&&(r=o.normalizeQuery(r)),a[t]||(a[t]=[]);for(var s=0;s<a[t].length;s++)if(a[t][s].h===n)return this;var l={h:n,query:r,ctx:i||this,callAtLast:n.zrEventfulCallAtLast},u=a[t].length-1,h=a[t][u];return h&&h.callAtLast?a[t].splice(u,0,l):a[t].push(l),this},e.prototype.isSilent=function(t){var r=this._$handlers;return!r||!r[t]||!r[t].length},e.prototype.off=function(t,r){var n=this._$handlers;if(!n)return this;if(!t)return this._$handlers={},this;if(r){if(n[t]){for(var i=[],a=0,o=n[t].length;a<o;a++)n[t][a].h!==r&&i.push(n[t][a]);n[t]=i}n[t]&&n[t].length===0&&delete n[t]}else delete n[t];return this},e.prototype.trigger=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=i.length,l=0;l<s;l++){var u=i[l];if(!(a&&a.filter&&u.query!=null&&!a.filter(t,u.query)))switch(o){case 0:u.h.call(u.ctx);break;case 1:u.h.call(u.ctx,r[0]);break;case 2:u.h.call(u.ctx,r[0],r[1]);break;default:u.h.apply(u.ctx,r);break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e.prototype.triggerWithContext=function(t){for(var r=[],n=1;n<arguments.length;n++)r[n-1]=arguments[n];if(!this._$handlers)return this;var i=this._$handlers[t],a=this._$eventProcessor;if(i)for(var o=r.length,s=r[o-1],l=i.length,u=0;u<l;u++){var h=i[u];if(!(a&&a.filter&&h.query!=null&&!a.filter(t,h.query)))switch(o){case 0:h.h.call(s);break;case 1:h.h.call(s,r[0]);break;case 2:h.h.call(s,r[0],r[1]);break;default:h.h.apply(s,r.slice(1,o-1));break}}return a&&a.afterTrigger&&a.afterTrigger(t),this},e}(),H4=Math.log(2);function eS(e,t,r,n,i,a){var o=n+"-"+i,s=e.length;if(a.hasOwnProperty(o))return a[o];if(t===1){var l=Math.round(Math.log((1<<s)-1&~i)/H4);return e[r][l]}for(var u=n|1<<r,h=r+1;n&1<<h;)h++;for(var f=0,c=0,d=0;c<s;c++){var v=1<<c;v&i||(f+=(d%2?-1:1)*e[r][c]*eS(e,t-1,h,u,i|v,a),d++)}return a[o]=f,f}function zA(e,t){var r=[[e[0],e[1],1,0,0,0,-t[0]*e[0],-t[0]*e[1]],[0,0,0,e[0],e[1],1,-t[1]*e[0],-t[1]*e[1]],[e[2],e[3],1,0,0,0,-t[2]*e[2],-t[2]*e[3]],[0,0,0,e[2],e[3],1,-t[3]*e[2],-t[3]*e[3]],[e[4],e[5],1,0,0,0,-t[4]*e[4],-t[4]*e[5]],[0,0,0,e[4],e[5],1,-t[5]*e[4],-t[5]*e[5]],[e[6],e[7],1,0,0,0,-t[6]*e[6],-t[6]*e[7]],[0,0,0,e[6],e[7],1,-t[7]*e[6],-t[7]*e[7]]],n={},i=eS(r,8,0,0,0,n);if(i!==0){for(var a=[],o=0;o<8;o++)for(var s=0;s<8;s++)a[s]==null&&(a[s]=0),a[s]+=((o+s)%2?-1:1)*eS(r,7,o===0?1:0,1<<o,1<<s,n)/i*t[o];return function(l,u,h){var f=u*a[6]+h*a[7]+1;l[0]=(u*a[0]+h*a[1]+a[2])/f,l[1]=(u*a[3]+h*a[4]+a[5])/f}}}var kA="___zrEVENTSAVED",T0=[];function W4(e,t,r,n,i){return rS(T0,t,n,i,!0)&&rS(e,r,T0[0],T0[1])}function rS(e,t,r,n,i){if(t.getBoundingClientRect&&ye.domSupported&&!qN(t)){var a=t[kA]||(t[kA]={}),o=X4(t,a),s=Y4(o,a,i);if(s)return s(e,r,n),!0}return!1}function X4(e,t){var r=t.markers;if(r)return r;r=t.markers=[];for(var n=["left","right"],i=["top","bottom"],a=0;a<4;a++){var o=document.createElement("div"),s=o.style,l=a%2,u=(a>>1)%2;s.cssText=["position: absolute","visibility: hidden","padding: 0","margin: 0","border-width: 0","user-select: none","width:0","height:0",n[l]+":0",i[u]+":0",n[1-l]+":auto",i[1-u]+":auto",""].join("!important;"),e.appendChild(o),r.push(o)}return r}function Y4(e,t,r){for(var n=r?"invTrans":"trans",i=t[n],a=t.srcCoords,o=[],s=[],l=!0,u=0;u<4;u++){var h=e[u].getBoundingClientRect(),f=2*u,c=h.left,d=h.top;o.push(c,d),l=l&&a&&c===a[f]&&d===a[f+1],s.push(e[u].offsetLeft,e[u].offsetTop)}return l&&i?i:(t.srcCoords=o,t[n]=r?zA(s,o):zA(o,s))}function qN(e){return e.nodeName.toUpperCase()==="CANVAS"}var Z4=/([&<>"'])/g,q4={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"};function Br(e){return e==null?"":(e+"").replace(Z4,function(t,r){return q4[r]})}var $4=/^(?:mouse|pointer|contextmenu|drag|drop)|click/,b0=[],K4=ye.browser.firefox&&+ye.browser.version.split(".")[0]<39;function nS(e,t,r,n){return r=r||{},n?GA(e,t,r):K4&&t.layerX!=null&&t.layerX!==t.offsetX?(r.zrX=t.layerX,r.zrY=t.layerY):t.offsetX!=null?(r.zrX=t.offsetX,r.zrY=t.offsetY):GA(e,t,r),r}function GA(e,t,r){if(ye.domSupported&&e.getBoundingClientRect){var n=t.clientX,i=t.clientY;if(qN(e)){var a=e.getBoundingClientRect();r.zrX=n-a.left,r.zrY=i-a.top;return}else if(rS(b0,e,n,i)){r.zrX=b0[0],r.zrY=b0[1];return}}r.zrX=r.zrY=0}function Zb(e){return e||window.event}function Ci(e,t,r){if(t=Zb(t),t.zrX!=null)return t;var n=t.type,i=n&&n.indexOf("touch")>=0;if(i){var o=n!=="touchend"?t.targetTouches[0]:t.changedTouches[0];o&&nS(e,o,t,r)}else{nS(e,t,t,r);var a=j4(t);t.zrDelta=a?a/120:-(t.detail||0)/3}var s=t.button;return t.which==null&&s!==void 0&&$4.test(t.type)&&(t.which=s&1?1:s&2?3:s&4?2:0),t}function j4(e){var t=e.wheelDelta;if(t)return t;var r=e.deltaX,n=e.deltaY;if(r==null||n==null)return t;var i=Math.abs(n!==0?n:r),a=n>0?-1:n<0?1:r>0?-1:1;return 3*i*a}function iS(e,t,r,n){e.addEventListener(t,r,n)}function J4(e,t,r,n){e.removeEventListener(t,r,n)}var Lo=function(e){e.preventDefault(),e.stopPropagation(),e.cancelBubble=!0};function VA(e){return e.which===2||e.which===3}var Q4=function(){function e(){this._track=[]}return e.prototype.recognize=function(t,r,n){return this._doTrack(t,r,n),this._recognize(t)},e.prototype.clear=function(){return this._track.length=0,this},e.prototype._doTrack=function(t,r,n){var i=t.touches;if(i){for(var a={points:[],touches:[],target:r,event:t},o=0,s=i.length;o<s;o++){var l=i[o],u=nS(n,l,{});a.points.push([u.zrX,u.zrY]),a.touches.push(l)}this._track.push(a)}},e.prototype._recognize=function(t){for(var r in w0)if(w0.hasOwnProperty(r)){var n=w0[r](this._track,t);if(n)return n}},e}();function HA(e){var t=e[1][0]-e[0][0],r=e[1][1]-e[0][1];return Math.sqrt(t*t+r*r)}function tV(e){return[(e[0][0]+e[1][0])/2,(e[0][1]+e[1][1])/2]}var w0={pinch:function(e,t){var r=e.length;if(r){var n=(e[r-1]||{}).points,i=(e[r-2]||{}).points||n;if(i&&i.length>1&&n&&n.length>1){var a=HA(n)/HA(i);!isFinite(a)&&(a=1),t.pinchScale=a;var o=tV(n);return t.pinchX=o[0],t.pinchY=o[1],{type:"pinch",target:e[0].target,event:t}}}}};function oi(){return[1,0,0,1,0,0]}function b_(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e}function qb(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function wo(e,t,r){var n=t[0]*r[0]+t[2]*r[1],i=t[1]*r[0]+t[3]*r[1],a=t[0]*r[2]+t[2]*r[3],o=t[1]*r[2]+t[3]*r[3],s=t[0]*r[4]+t[2]*r[5]+t[4],l=t[1]*r[4]+t[3]*r[5]+t[5];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e}function qa(e,t,r){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4]+r[0],e[5]=t[5]+r[1],e}function Fu(e,t,r,n){n===void 0&&(n=[0,0]);var i=t[0],a=t[2],o=t[4],s=t[1],l=t[3],u=t[5],h=Math.sin(r),f=Math.cos(r);return e[0]=i*f+s*h,e[1]=-i*h+s*f,e[2]=a*f+l*h,e[3]=-a*h+f*l,e[4]=f*(o-n[0])+h*(u-n[1])+n[0],e[5]=f*(u-n[1])-h*(o-n[0])+n[1],e}function $b(e,t,r){var n=r[0],i=r[1];return e[0]=t[0]*n,e[1]=t[1]*i,e[2]=t[2]*n,e[3]=t[3]*i,e[4]=t[4]*n,e[5]=t[5]*i,e}function Bu(e,t){var r=t[0],n=t[2],i=t[4],a=t[1],o=t[3],s=t[5],l=r*o-a*n;return l?(l=1/l,e[0]=o*l,e[1]=-a*l,e[2]=-n*l,e[3]=r*l,e[4]=(n*s-o*i)*l,e[5]=(a*i-r*s)*l,e):null}function eV(e){var t=oi();return qb(t,e),t}var he=function(){function e(t,r){this.x=t||0,this.y=r||0}return e.prototype.copy=function(t){return this.x=t.x,this.y=t.y,this},e.prototype.clone=function(){return new e(this.x,this.y)},e.prototype.set=function(t,r){return this.x=t,this.y=r,this},e.prototype.equal=function(t){return t.x===this.x&&t.y===this.y},e.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this},e.prototype.scale=function(t){this.x*=t,this.y*=t},e.prototype.scaleAndAdd=function(t,r){this.x+=t.x*r,this.y+=t.y*r},e.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this},e.prototype.dot=function(t){return this.x*t.x+this.y*t.y},e.prototype.len=function(){return Math.sqrt(this.x*this.x+this.y*this.y)},e.prototype.lenSquare=function(){return this.x*this.x+this.y*this.y},e.prototype.normalize=function(){var t=this.len();return this.x/=t,this.y/=t,this},e.prototype.distance=function(t){var r=this.x-t.x,n=this.y-t.y;return Math.sqrt(r*r+n*n)},e.prototype.distanceSquare=function(t){var r=this.x-t.x,n=this.y-t.y;return r*r+n*n},e.prototype.negate=function(){return this.x=-this.x,this.y=-this.y,this},e.prototype.transform=function(t){if(t){var r=this.x,n=this.y;return this.x=t[0]*r+t[2]*n+t[4],this.y=t[1]*r+t[3]*n+t[5],this}},e.prototype.toArray=function(t){return t[0]=this.x,t[1]=this.y,t},e.prototype.fromArray=function(t){this.x=t[0],this.y=t[1]},e.set=function(t,r,n){t.x=r,t.y=n},e.copy=function(t,r){t.x=r.x,t.y=r.y},e.len=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},e.lenSquare=function(t){return t.x*t.x+t.y*t.y},e.dot=function(t,r){return t.x*r.x+t.y*r.y},e.add=function(t,r,n){t.x=r.x+n.x,t.y=r.y+n.y},e.sub=function(t,r,n){t.x=r.x-n.x,t.y=r.y-n.y},e.scale=function(t,r,n){t.x=r.x*n,t.y=r.y*n},e.scaleAndAdd=function(t,r,n,i){t.x=r.x+n.x*i,t.y=r.y+n.y*i},e.lerp=function(t,r,n,i){var a=1-i;t.x=a*r.x+i*n.x,t.y=a*r.y+i*n.y},e}(),Kv=Math.min,jv=Math.max,Js=new he,Qs=new he,tl=new he,el=new he,hc=new he,fc=new he,fe=function(){function e(t,r,n,i){n<0&&(t=t+n,n=-n),i<0&&(r=r+i,i=-i),this.x=t,this.y=r,this.width=n,this.height=i}return e.prototype.union=function(t){var r=Kv(t.x,this.x),n=Kv(t.y,this.y);isFinite(this.x)&&isFinite(this.width)?this.width=jv(t.x+t.width,this.x+this.width)-r:this.width=t.width,isFinite(this.y)&&isFinite(this.height)?this.height=jv(t.y+t.height,this.y+this.height)-n:this.height=t.height,this.x=r,this.y=n},e.prototype.applyTransform=function(t){e.applyTransform(this,this,t)},e.prototype.calculateTransform=function(t){var r=this,n=t.width/r.width,i=t.height/r.height,a=oi();return qa(a,a,[-r.x,-r.y]),$b(a,a,[n,i]),qa(a,a,[t.x,t.y]),a},e.prototype.intersect=function(t,r){if(!t)return!1;t instanceof e||(t=e.create(t));var n=this,i=n.x,a=n.x+n.width,o=n.y,s=n.y+n.height,l=t.x,u=t.x+t.width,h=t.y,f=t.y+t.height,c=!(a<l||u<i||s<h||f<o);if(r){var d=1/0,v=0,p=Math.abs(a-l),g=Math.abs(u-i),m=Math.abs(s-h),_=Math.abs(f-o),y=Math.min(p,g),x=Math.min(m,_);a<l||u<i?y>v&&(v=y,p<g?he.set(fc,-p,0):he.set(fc,g,0)):y<d&&(d=y,p<g?he.set(hc,p,0):he.set(hc,-g,0)),s<h||f<o?x>v&&(v=x,m<_?he.set(fc,0,-m):he.set(fc,0,_)):y<d&&(d=y,m<_?he.set(hc,0,m):he.set(hc,0,-_))}return r&&he.copy(r,c?hc:fc),c},e.prototype.contain=function(t,r){var n=this;return t>=n.x&&t<=n.x+n.width&&r>=n.y&&r<=n.y+n.height},e.prototype.clone=function(){return new e(this.x,this.y,this.width,this.height)},e.prototype.copy=function(t){e.copy(this,t)},e.prototype.plain=function(){return{x:this.x,y:this.y,width:this.width,height:this.height}},e.prototype.isFinite=function(){return isFinite(this.x)&&isFinite(this.y)&&isFinite(this.width)&&isFinite(this.height)},e.prototype.isZero=function(){return this.width===0||this.height===0},e.create=function(t){return new e(t.x,t.y,t.width,t.height)},e.copy=function(t,r){t.x=r.x,t.y=r.y,t.width=r.width,t.height=r.height},e.applyTransform=function(t,r,n){if(!n){t!==r&&e.copy(t,r);return}if(n[1]<1e-5&&n[1]>-1e-5&&n[2]<1e-5&&n[2]>-1e-5){var i=n[0],a=n[3],o=n[4],s=n[5];t.x=r.x*i+o,t.y=r.y*a+s,t.width=r.width*i,t.height=r.height*a,t.width<0&&(t.x+=t.width,t.width=-t.width),t.height<0&&(t.y+=t.height,t.height=-t.height);return}Js.x=tl.x=r.x,Js.y=el.y=r.y,Qs.x=el.x=r.x+r.width,Qs.y=tl.y=r.y+r.height,Js.transform(n),el.transform(n),Qs.transform(n),tl.transform(n),t.x=Kv(Js.x,Qs.x,tl.x,el.x),t.y=Kv(Js.y,Qs.y,tl.y,el.y);var l=jv(Js.x,Qs.x,tl.x,el.x),u=jv(Js.y,Qs.y,tl.y,el.y);t.width=l-t.x,t.height=u-t.y},e}(),$N="silent";function rV(e,t,r){return{type:e,event:r,target:t.target,topTarget:t.topTarget,cancelBubble:!1,offsetX:r.zrX,offsetY:r.zrY,gestureEvent:r.gestureEvent,pinchX:r.pinchX,pinchY:r.pinchY,pinchScale:r.pinchScale,wheelDelta:r.zrDelta,zrByTouch:r.zrByTouch,which:r.which,stop:nV}}function nV(){Lo(this.event)}var iV=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.handler=null,r}return t.prototype.dispose=function(){},t.prototype.setCursor=function(){},t}(Zi),cc=function(){function e(t,r){this.x=t,this.y=r}return e}(),aV=["click","dblclick","mousewheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],M0=new fe(0,0,0,0),KN=function(e){q(t,e);function t(r,n,i,a,o){var s=e.call(this)||this;return s._hovered=new cc(0,0),s.storage=r,s.painter=n,s.painterRoot=a,s._pointerSize=o,i=i||new iV,s.proxy=null,s.setHandlerProxy(i),s._draggingMgr=new V4(s),s}return t.prototype.setHandlerProxy=function(r){this.proxy&&this.proxy.dispose(),r&&(R(aV,function(n){r.on&&r.on(n,this[n],this)},this),r.handler=this),this.proxy=r},t.prototype.mousemove=function(r){var n=r.zrX,i=r.zrY,a=jN(this,n,i),o=this._hovered,s=o.target;s&&!s.__zr&&(o=this.findHover(o.x,o.y),s=o.target);var l=this._hovered=a?new cc(n,i):this.findHover(n,i),u=l.target,h=this.proxy;h.setCursor&&h.setCursor(u?u.cursor:"default"),s&&u!==s&&this.dispatchToElement(o,"mouseout",r),this.dispatchToElement(l,"mousemove",r),u&&u!==s&&this.dispatchToElement(l,"mouseover",r)},t.prototype.mouseout=function(r){var n=r.zrEventControl;n!=="only_globalout"&&this.dispatchToElement(this._hovered,"mouseout",r),n!=="no_globalout"&&this.trigger("globalout",{type:"globalout",event:r})},t.prototype.resize=function(){this._hovered=new cc(0,0)},t.prototype.dispatch=function(r,n){var i=this[r];i&&i.call(this,n)},t.prototype.dispose=function(){this.proxy.dispose(),this.storage=null,this.proxy=null,this.painter=null},t.prototype.setCursorStyle=function(r){var n=this.proxy;n.setCursor&&n.setCursor(r)},t.prototype.dispatchToElement=function(r,n,i){r=r||{};var a=r.target;if(!(a&&a.silent)){for(var o="on"+n,s=rV(n,r,i);a&&(a[o]&&(s.cancelBubble=!!a[o].call(a,s)),a.trigger(n,s),a=a.__hostTarget?a.__hostTarget:a.parent,!s.cancelBubble););s.cancelBubble||(this.trigger(n,s),this.painter&&this.painter.eachOtherLayer&&this.painter.eachOtherLayer(function(l){typeof l[o]=="function"&&l[o].call(l,s),l.trigger&&l.trigger(n,s)}))}},t.prototype.findHover=function(r,n,i){var a=this.storage.getDisplayList(),o=new cc(r,n);if(WA(a,o,r,n,i),this._pointerSize&&!o.target){for(var s=[],l=this._pointerSize,u=l/2,h=new fe(r-u,n-u,l,l),f=a.length-1;f>=0;f--){var c=a[f];c!==i&&!c.ignore&&!c.ignoreCoarsePointer&&(!c.parent||!c.parent.ignoreCoarsePointer)&&(M0.copy(c.getBoundingRect()),c.transform&&M0.applyTransform(c.transform),M0.intersect(h)&&s.push(c))}if(s.length)for(var d=4,v=Math.PI/12,p=Math.PI*2,g=0;g<u;g+=d)for(var m=0;m<p;m+=v){var _=r+g*Math.cos(m),y=n+g*Math.sin(m);if(WA(s,o,_,y,i),o.target)return o}}return o},t.prototype.processGesture=function(r,n){this._gestureMgr||(this._gestureMgr=new Q4);var i=this._gestureMgr;n==="start"&&i.clear();var a=i.recognize(r,this.findHover(r.zrX,r.zrY,null).target,this.proxy.dom);if(n==="end"&&i.clear(),a){var o=a.type;r.gestureEvent=o;var s=new cc;s.target=a.target,this.dispatchToElement(s,o,a.event)}},t}(Zi);R(["click","mousedown","mouseup","mousewheel","dblclick","contextmenu"],function(e){KN.prototype[e]=function(t){var r=t.zrX,n=t.zrY,i=jN(this,r,n),a,o;if((e!=="mouseup"||!i)&&(a=this.findHover(r,n),o=a.target),e==="mousedown")this._downEl=o,this._downPoint=[t.zrX,t.zrY],this._upEl=o;else if(e==="mouseup")this._upEl=o;else if(e==="click"){if(this._downEl!==this._upEl||!this._downPoint||gs(this._downPoint,[t.zrX,t.zrY])>4)return;this._downPoint=null}this.dispatchToElement(a,e,t)}});function oV(e,t,r){if(e[e.rectHover?"rectContain":"contain"](t,r)){for(var n=e,i=void 0,a=!1;n;){if(n.ignoreClip&&(a=!0),!a){var o=n.getClipPath();if(o&&!o.contain(t,r))return!1}n.silent&&(i=!0);var s=n.__hostTarget;n=s||n.parent}return i?$N:!0}return!1}function WA(e,t,r,n,i){for(var a=e.length-1;a>=0;a--){var o=e[a],s=void 0;if(o!==i&&!o.ignore&&(s=oV(o,r,n))&&(!t.topTarget&&(t.topTarget=o),s!==$N)){t.target=o;break}}}function jN(e,t,r){var n=e.painter;return t<0||t>n.getWidth()||r<0||r>n.getHeight()}var JN=32,dc=7;function sV(e){for(var t=0;e>=JN;)t|=e&1,e>>=1;return e+t}function XA(e,t,r,n){var i=t+1;if(i===r)return 1;if(n(e[i++],e[t])<0){for(;i<r&&n(e[i],e[i-1])<0;)i++;lV(e,t,i)}else for(;i<r&&n(e[i],e[i-1])>=0;)i++;return i-t}function lV(e,t,r){for(r--;t<r;){var n=e[t];e[t++]=e[r],e[r--]=n}}function YA(e,t,r,n,i){for(n===t&&n++;n<r;n++){for(var a=e[n],o=t,s=n,l;o<s;)l=o+s>>>1,i(a,e[l])<0?s=l:o=l+1;var u=n-o;switch(u){case 3:e[o+3]=e[o+2];case 2:e[o+2]=e[o+1];case 1:e[o+1]=e[o];break;default:for(;u>0;)e[o+u]=e[o+u-1],u--}e[o]=a}}function A0(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])>0){for(s=n-i;l<s&&a(e,t[r+i+l])>0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}else{for(s=i+1;l<s&&a(e,t[r+i-l])<=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}for(o++;o<l;){var h=o+(l-o>>>1);a(e,t[r+h])>0?o=h+1:l=h}return l}function E0(e,t,r,n,i,a){var o=0,s=0,l=1;if(a(e,t[r+i])<0){for(s=i+1;l<s&&a(e,t[r+i-l])<0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s);var u=o;o=i-l,l=i-u}else{for(s=n-i;l<s&&a(e,t[r+i+l])>=0;)o=l,l=(l<<1)+1,l<=0&&(l=s);l>s&&(l=s),o+=i,l+=i}for(o++;o<l;){var h=o+(l-o>>>1);a(e,t[r+h])<0?l=h:o=h+1}return l}function uV(e,t){var r=dc,n,i,a=0,o=[];n=[],i=[];function s(d,v){n[a]=d,i[a]=v,a+=1}function l(){for(;a>1;){var d=a-2;if(d>=1&&i[d-1]<=i[d]+i[d+1]||d>=2&&i[d-2]<=i[d]+i[d-1])i[d-1]<i[d+1]&&d--;else if(i[d]>i[d+1])break;h(d)}}function u(){for(;a>1;){var d=a-2;d>0&&i[d-1]<i[d+1]&&d--,h(d)}}function h(d){var v=n[d],p=i[d],g=n[d+1],m=i[d+1];i[d]=p+m,d===a-3&&(n[d+1]=n[d+2],i[d+1]=i[d+2]),a--;var _=E0(e[g],e,v,p,0,t);v+=_,p-=_,p!==0&&(m=A0(e[v+p-1],e,g,m,m-1,t),m!==0&&(p<=m?f(v,p,g,m):c(v,p,g,m)))}function f(d,v,p,g){var m=0;for(m=0;m<v;m++)o[m]=e[d+m];var _=0,y=p,x=d;if(e[x++]=e[y++],--g===0){for(m=0;m<v;m++)e[x+m]=o[_+m];return}if(v===1){for(m=0;m<g;m++)e[x+m]=e[y+m];e[x+g]=o[_];return}for(var T=r,S,M,w;;){S=0,M=0,w=!1;do if(t(e[y],o[_])<0){if(e[x++]=e[y++],M++,S=0,--g===0){w=!0;break}}else if(e[x++]=o[_++],S++,M=0,--v===1){w=!0;break}while((S|M)<T);if(w)break;do{if(S=E0(e[y],o,_,v,0,t),S!==0){for(m=0;m<S;m++)e[x+m]=o[_+m];if(x+=S,_+=S,v-=S,v<=1){w=!0;break}}if(e[x++]=e[y++],--g===0){w=!0;break}if(M=A0(o[_],e,y,g,0,t),M!==0){for(m=0;m<M;m++)e[x+m]=e[y+m];if(x+=M,y+=M,g-=M,g===0){w=!0;break}}if(e[x++]=o[_++],--v===1){w=!0;break}T--}while(S>=dc||M>=dc);if(w)break;T<0&&(T=0),T+=2}if(r=T,r<1&&(r=1),v===1){for(m=0;m<g;m++)e[x+m]=e[y+m];e[x+g]=o[_]}else{if(v===0)throw new Error;for(m=0;m<v;m++)e[x+m]=o[_+m]}}function c(d,v,p,g){var m=0;for(m=0;m<g;m++)o[m]=e[p+m];var _=d+v-1,y=g-1,x=p+g-1,T=0,S=0;if(e[x--]=e[_--],--v===0){for(T=x-(g-1),m=0;m<g;m++)e[T+m]=o[m];return}if(g===1){for(x-=v,_-=v,S=x+1,T=_+1,m=v-1;m>=0;m--)e[S+m]=e[T+m];e[x]=o[y];return}for(var M=r;;){var w=0,b=0,A=!1;do if(t(o[y],e[_])<0){if(e[x--]=e[_--],w++,b=0,--v===0){A=!0;break}}else if(e[x--]=o[y--],b++,w=0,--g===1){A=!0;break}while((w|b)<M);if(A)break;do{if(w=v-E0(o[y],e,d,v,v-1,t),w!==0){for(x-=w,_-=w,v-=w,S=x+1,T=_+1,m=w-1;m>=0;m--)e[S+m]=e[T+m];if(v===0){A=!0;break}}if(e[x--]=o[y--],--g===1){A=!0;break}if(b=g-A0(e[_],o,0,g,g-1,t),b!==0){for(x-=b,y-=b,g-=b,S=x+1,T=y+1,m=0;m<b;m++)e[S+m]=o[T+m];if(g<=1){A=!0;break}}if(e[x--]=e[_--],--v===0){A=!0;break}M--}while(w>=dc||b>=dc);if(A)break;M<0&&(M=0),M+=2}if(r=M,r<1&&(r=1),g===1){for(x-=v,_-=v,S=x+1,T=_+1,m=v-1;m>=0;m--)e[S+m]=e[T+m];e[x]=o[y]}else{if(g===0)throw new Error;for(T=x-(g-1),m=0;m<g;m++)e[T+m]=o[m]}}return{mergeRuns:l,forceMergeRuns:u,pushRun:s}}function Ug(e,t,r,n){r||(r=0),n||(n=e.length);var i=n-r;if(!(i<2)){var a=0;if(i<JN){a=XA(e,r,n,t),YA(e,r,n,r+a,t);return}var o=uV(e,t),s=sV(i);do{if(a=XA(e,r,n,t),a<s){var l=i;l>s&&(l=s),YA(e,r,r+l,r+a,t),a=l}o.pushRun(r,a),o.mergeRuns(),i-=a,r+=a}while(i!==0);o.forceMergeRuns()}}var Va=1,zg=2,Jc=4,ZA=!1;function C0(){ZA||(ZA=!0,console.warn("z / z2 / zlevel of displayable is invalid, which may cause unexpected errors"))}function qA(e,t){return e.zlevel===t.zlevel?e.z===t.z?e.z2-t.z2:e.z-t.z:e.zlevel-t.zlevel}var hV=function(){function e(){this._roots=[],this._displayList=[],this._displayListLen=0,this.displayableSortFunc=qA}return e.prototype.traverse=function(t,r){for(var n=0;n<this._roots.length;n++)this._roots[n].traverse(t,r)},e.prototype.getDisplayList=function(t,r){r=r||!1;var n=this._displayList;return(t||!n.length)&&this.updateDisplayList(r),n},e.prototype.updateDisplayList=function(t){this._displayListLen=0;for(var r=this._roots,n=this._displayList,i=0,a=r.length;i<a;i++)this._updateAndAddDisplayable(r[i],null,t);n.length=this._displayListLen,Ug(n,qA)},e.prototype._updateAndAddDisplayable=function(t,r,n){if(!(t.ignore&&!n)){t.beforeUpdate(),t.update(),t.afterUpdate();var i=t.getClipPath();if(t.ignoreClip)r=null;else if(i){r?r=r.slice():r=[];for(var a=i,o=t;a;)a.parent=o,a.updateTransform(),r.push(a),o=a,a=a.getClipPath()}if(t.childrenRef){for(var s=t.childrenRef(),l=0;l<s.length;l++){var u=s[l];t.__dirty&&(u.__dirty|=Va),this._updateAndAddDisplayable(u,r,n)}t.__dirty=0}else{var h=t;r&&r.length?h.__clipPaths=r:h.__clipPaths&&h.__clipPaths.length>0&&(h.__clipPaths=[]),isNaN(h.z)&&(C0(),h.z=0),isNaN(h.z2)&&(C0(),h.z2=0),isNaN(h.zlevel)&&(C0(),h.zlevel=0),this._displayList[this._displayListLen++]=h}var f=t.getDecalElement&&t.getDecalElement();f&&this._updateAndAddDisplayable(f,r,n);var c=t.getTextGuideLine();c&&this._updateAndAddDisplayable(c,r,n);var d=t.getTextContent();d&&this._updateAndAddDisplayable(d,r,n)}},e.prototype.addRoot=function(t){t.__zr&&t.__zr.storage===this||this._roots.push(t)},e.prototype.delRoot=function(t){if(t instanceof Array){for(var r=0,n=t.length;r<n;r++)this.delRoot(t[r]);return}var i=pe(this._roots,t);i>=0&&this._roots.splice(i,1)},e.prototype.delAllRoots=function(){this._roots=[],this._displayList=[],this._displayListLen=0},e.prototype.getRoots=function(){return this._roots},e.prototype.dispose=function(){this._displayList=null,this._roots=null},e}(),xu;xu=ye.hasGlobalWindow&&(window.requestAnimationFrame&&window.requestAnimationFrame.bind(window)||window.msRequestAnimationFrame&&window.msRequestAnimationFrame.bind(window)||window.mozRequestAnimationFrame||window.webkitRequestAnimationFrame)||function(e){return setTimeout(e,16)};var gd={linear:function(e){return e},quadraticIn:function(e){return e*e},quadraticOut:function(e){return e*(2-e)},quadraticInOut:function(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)},cubicIn:function(e){return e*e*e},cubicOut:function(e){return--e*e*e+1},cubicInOut:function(e){return(e*=2)<1?.5*e*e*e:.5*((e-=2)*e*e+2)},quarticIn:function(e){return e*e*e*e},quarticOut:function(e){return 1- --e*e*e*e},quarticInOut:function(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)},quinticIn:function(e){return e*e*e*e*e},quinticOut:function(e){return--e*e*e*e*e+1},quinticInOut:function(e){return(e*=2)<1?.5*e*e*e*e*e:.5*((e-=2)*e*e*e*e+2)},sinusoidalIn:function(e){return 1-Math.cos(e*Math.PI/2)},sinusoidalOut:function(e){return Math.sin(e*Math.PI/2)},sinusoidalInOut:function(e){return .5*(1-Math.cos(Math.PI*e))},exponentialIn:function(e){return e===0?0:Math.pow(1024,e-1)},exponentialOut:function(e){return e===1?1:1-Math.pow(2,-10*e)},exponentialInOut:function(e){return e===0?0:e===1?1:(e*=2)<1?.5*Math.pow(1024,e-1):.5*(-Math.pow(2,-10*(e-1))+2)},circularIn:function(e){return 1-Math.sqrt(1-e*e)},circularOut:function(e){return Math.sqrt(1- --e*e)},circularInOut:function(e){return(e*=2)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},elasticIn:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),-(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)))},elasticOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),r*Math.pow(2,-10*e)*Math.sin((e-t)*(2*Math.PI)/n)+1)},elasticInOut:function(e){var t,r=.1,n=.4;return e===0?0:e===1?1:(!r||r<1?(r=1,t=n/4):t=n*Math.asin(1/r)/(2*Math.PI),(e*=2)<1?-.5*(r*Math.pow(2,10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)):r*Math.pow(2,-10*(e-=1))*Math.sin((e-t)*(2*Math.PI)/n)*.5+1)},backIn:function(e){var t=1.70158;return e*e*((t+1)*e-t)},backOut:function(e){var t=1.70158;return--e*e*((t+1)*e+t)+1},backInOut:function(e){var t=2.5949095;return(e*=2)<1?.5*(e*e*((t+1)*e-t)):.5*((e-=2)*e*((t+1)*e+t)+2)},bounceIn:function(e){return 1-gd.bounceOut(1-e)},bounceOut:function(e){return e<1/2.75?7.5625*e*e:e<2/2.75?7.5625*(e-=1.5/2.75)*e+.75:e<2.5/2.75?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375},bounceInOut:function(e){return e<.5?gd.bounceIn(e*2)*.5:gd.bounceOut(e*2-1)*.5+.5}},Jv=Math.pow,Es=Math.sqrt,QN=1e-8,tO=1e-4,$A=Es(3),Qv=1/3,Ia=Ou(),Ii=Ou(),jh=Ou();function ys(e){return e>-1e-8&&e<QN}function eO(e){return e>QN||e<-1e-8}function $r(e,t,r,n,i){var a=1-i;return a*a*(a*e+3*i*t)+i*i*(i*n+3*a*r)}function KA(e,t,r,n,i){var a=1-i;return 3*(((t-e)*a+2*(r-t)*i)*a+(n-r)*i*i)}function cm(e,t,r,n,i,a){var o=n+3*(t-r)-e,s=3*(r-t*2+e),l=3*(t-e),u=e-i,h=s*s-3*o*l,f=s*l-9*o*u,c=l*l-3*s*u,d=0;if(ys(h)&&ys(f))if(ys(s))a[0]=0;else{var v=-l/s;v>=0&&v<=1&&(a[d++]=v)}else{var p=f*f-4*h*c;if(ys(p)){var g=f/h,v=-s/o+g,m=-g/2;v>=0&&v<=1&&(a[d++]=v),m>=0&&m<=1&&(a[d++]=m)}else if(p>0){var _=Es(p),y=h*s+1.5*o*(-f+_),x=h*s+1.5*o*(-f-_);y<0?y=-Jv(-y,Qv):y=Jv(y,Qv),x<0?x=-Jv(-x,Qv):x=Jv(x,Qv);var v=(-s-(y+x))/(3*o);v>=0&&v<=1&&(a[d++]=v)}else{var T=(2*h*s-3*o*f)/(2*Es(h*h*h)),S=Math.acos(T)/3,M=Es(h),w=Math.cos(S),v=(-s-2*M*w)/(3*o),m=(-s+M*(w+$A*Math.sin(S)))/(3*o),b=(-s+M*(w-$A*Math.sin(S)))/(3*o);v>=0&&v<=1&&(a[d++]=v),m>=0&&m<=1&&(a[d++]=m),b>=0&&b<=1&&(a[d++]=b)}}return d}function rO(e,t,r,n,i){var a=6*r-12*t+6*e,o=9*t+3*n-3*e-9*r,s=3*t-3*e,l=0;if(ys(o)){if(eO(a)){var u=-s/a;u>=0&&u<=1&&(i[l++]=u)}}else{var h=a*a-4*o*s;if(ys(h))i[0]=-a/(2*o);else if(h>0){var f=Es(h),u=(-a+f)/(2*o),c=(-a-f)/(2*o);u>=0&&u<=1&&(i[l++]=u),c>=0&&c<=1&&(i[l++]=c)}}return l}function Os(e,t,r,n,i,a){var o=(t-e)*i+e,s=(r-t)*i+t,l=(n-r)*i+r,u=(s-o)*i+o,h=(l-s)*i+s,f=(h-u)*i+u;a[0]=e,a[1]=o,a[2]=u,a[3]=f,a[4]=f,a[5]=h,a[6]=l,a[7]=n}function nO(e,t,r,n,i,a,o,s,l,u,h){var f,c=.005,d=1/0,v,p,g,m;Ia[0]=l,Ia[1]=u;for(var _=0;_<1;_+=.05)Ii[0]=$r(e,r,i,o,_),Ii[1]=$r(t,n,a,s,_),g=lu(Ia,Ii),g<d&&(f=_,d=g);d=1/0;for(var y=0;y<32&&!(c<tO);y++)v=f-c,p=f+c,Ii[0]=$r(e,r,i,o,v),Ii[1]=$r(t,n,a,s,v),g=lu(Ii,Ia),v>=0&&g<d?(f=v,d=g):(jh[0]=$r(e,r,i,o,p),jh[1]=$r(t,n,a,s,p),m=lu(jh,Ia),p<=1&&m<d?(f=p,d=m):c*=.5);return h&&(h[0]=$r(e,r,i,o,f),h[1]=$r(t,n,a,s,f)),Es(d)}function fV(e,t,r,n,i,a,o,s,l){for(var u=e,h=t,f=0,c=1/l,d=1;d<=l;d++){var v=d*c,p=$r(e,r,i,o,v),g=$r(t,n,a,s,v),m=p-u,_=g-h;f+=Math.sqrt(m*m+_*_),u=p,h=g}return f}function dn(e,t,r,n){var i=1-n;return i*(i*e+2*n*t)+n*n*r}function aS(e,t,r,n){return 2*((1-n)*(t-e)+n*(r-t))}function cV(e,t,r,n,i){var a=e-2*t+r,o=2*(t-e),s=e-n,l=0;if(ys(a)){if(eO(o)){var u=-s/o;u>=0&&u<=1&&(i[l++]=u)}}else{var h=o*o-4*a*s;if(ys(h)){var u=-o/(2*a);u>=0&&u<=1&&(i[l++]=u)}else if(h>0){var f=Es(h),u=(-o+f)/(2*a),c=(-o-f)/(2*a);u>=0&&u<=1&&(i[l++]=u),c>=0&&c<=1&&(i[l++]=c)}}return l}function iO(e,t,r){var n=e+r-2*t;return n===0?.5:(e-t)/n}function Nd(e,t,r,n,i){var a=(t-e)*n+e,o=(r-t)*n+t,s=(o-a)*n+a;i[0]=e,i[1]=a,i[2]=s,i[3]=s,i[4]=o,i[5]=r}function aO(e,t,r,n,i,a,o,s,l){var u,h=.005,f=1/0;Ia[0]=o,Ia[1]=s;for(var c=0;c<1;c+=.05){Ii[0]=dn(e,r,i,c),Ii[1]=dn(t,n,a,c);var d=lu(Ia,Ii);d<f&&(u=c,f=d)}f=1/0;for(var v=0;v<32&&!(h<tO);v++){var p=u-h,g=u+h;Ii[0]=dn(e,r,i,p),Ii[1]=dn(t,n,a,p);var d=lu(Ii,Ia);if(p>=0&&d<f)u=p,f=d;else{jh[0]=dn(e,r,i,g),jh[1]=dn(t,n,a,g);var m=lu(jh,Ia);g<=1&&m<f?(u=g,f=m):h*=.5}}return l&&(l[0]=dn(e,r,i,u),l[1]=dn(t,n,a,u)),Es(f)}function dV(e,t,r,n,i,a,o){for(var s=e,l=t,u=0,h=1/o,f=1;f<=o;f++){var c=f*h,d=dn(e,r,i,c),v=dn(t,n,a,c),p=d-s,g=v-l;u+=Math.sqrt(p*p+g*g),s=d,l=v}return u}var vV=/cubic-bezier\(([0-9,\.e ]+)\)/;function Kb(e){var t=e&&vV.exec(e);if(t){var r=t[1].split(","),n=+ha(r[0]),i=+ha(r[1]),a=+ha(r[2]),o=+ha(r[3]);if(isNaN(n+i+a+o))return;var s=[];return function(l){return l<=0?0:l>=1?1:cm(0,n,a,1,l,s)&&$r(0,i,o,1,s[0])}}}var pV=function(){function e(t){this._inited=!1,this._startTime=0,this._pausedTime=0,this._paused=!1,this._life=t.life||1e3,this._delay=t.delay||0,this.loop=t.loop||!1,this.onframe=t.onframe||Rr,this.ondestroy=t.ondestroy||Rr,this.onrestart=t.onrestart||Rr,t.easing&&this.setEasing(t.easing)}return e.prototype.step=function(t,r){if(this._inited||(this._startTime=t+this._delay,this._inited=!0),this._paused){this._pausedTime+=r;return}var n=this._life,i=t-this._startTime-this._pausedTime,a=i/n;a<0&&(a=0),a=Math.min(a,1);var o=this.easingFunc,s=o?o(a):a;if(this.onframe(s),a===1)if(this.loop){var l=i%n;this._startTime=t-l,this._pausedTime=0,this.onrestart()}else return!0;return!1},e.prototype.pause=function(){this._paused=!0},e.prototype.resume=function(){this._paused=!1},e.prototype.setEasing=function(t){this.easing=t,this.easingFunc=Yt(t)?t:gd[t]||Kb(t)},e}(),oO=function(){function e(t){this.value=t}return e}(),gV=function(){function e(){this._len=0}return e.prototype.insert=function(t){var r=new oO(t);return this.insertEntry(r),r},e.prototype.insertEntry=function(t){this.head?(this.tail.next=t,t.prev=this.tail,t.next=null,this.tail=t):this.head=this.tail=t,this._len++},e.prototype.remove=function(t){var r=t.prev,n=t.next;r?r.next=n:this.head=n,n?n.prev=r:this.tail=r,t.next=t.prev=null,this._len--},e.prototype.len=function(){return this._len},e.prototype.clear=function(){this.head=this.tail=null,this._len=0},e}(),Bf=function(){function e(t){this._list=new gV,this._maxSize=10,this._map={},this._maxSize=t}return e.prototype.put=function(t,r){var n=this._list,i=this._map,a=null;if(i[t]==null){var o=n.len(),s=this._lastRemovedEntry;if(o>=this._maxSize&&o>0){var l=n.head;n.remove(l),delete i[l.key],a=l.value,this._lastRemovedEntry=l}s?s.value=r:s=new oO(r),s.key=t,n.insertEntry(s),i[t]=s}return a},e.prototype.get=function(t){var r=this._map[t],n=this._list;if(r!=null)return r!==n.tail&&(n.remove(r),n.insertEntry(r)),r.value},e.prototype.clear=function(){this._list.clear(),this._map={}},e.prototype.len=function(){return this._list.len()},e}(),jA={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function da(e){return e=Math.round(e),e<0?0:e>255?255:e}function mV(e){return e=Math.round(e),e<0?0:e>360?360:e}function Od(e){return e<0?0:e>1?1:e}function D0(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?da(parseFloat(t)/100*255):da(parseInt(t,10))}function uu(e){var t=e;return t.length&&t.charAt(t.length-1)==="%"?Od(parseFloat(t)/100):Od(parseFloat(t))}function L0(e,t,r){return r<0?r+=1:r>1&&(r-=1),r*6<1?e+(t-e)*r*6:r*2<1?t:r*3<2?e+(t-e)*(2/3-r)*6:e}function xs(e,t,r){return e+(t-e)*r}function Ei(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function oS(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var sO=new Bf(20),tp=null;function $u(e,t){tp&&oS(tp,t),tp=sO.put(e,tp||t.slice())}function kn(e,t){if(e){t=t||[];var r=sO.get(e);if(r)return oS(t,r);e=e+"";var n=e.replace(/ /g,"").toLowerCase();if(n in jA)return oS(t,jA[n]),$u(e,t),t;var i=n.length;if(n.charAt(0)==="#"){if(i===4||i===5){var a=parseInt(n.slice(1,4),16);if(!(a>=0&&a<=4095)){Ei(t,0,0,0,1);return}return Ei(t,(a&3840)>>4|(a&3840)>>8,a&240|(a&240)>>4,a&15|(a&15)<<4,i===5?parseInt(n.slice(4),16)/15:1),$u(e,t),t}else if(i===7||i===9){var a=parseInt(n.slice(1,7),16);if(!(a>=0&&a<=16777215)){Ei(t,0,0,0,1);return}return Ei(t,(a&16711680)>>16,(a&65280)>>8,a&255,i===9?parseInt(n.slice(7),16)/255:1),$u(e,t),t}return}var o=n.indexOf("("),s=n.indexOf(")");if(o!==-1&&s+1===i){var l=n.substr(0,o),u=n.substr(o+1,s-(o+1)).split(","),h=1;switch(l){case"rgba":if(u.length!==4)return u.length===3?Ei(t,+u[0],+u[1],+u[2],1):Ei(t,0,0,0,1);h=uu(u.pop());case"rgb":if(u.length>=3)return Ei(t,D0(u[0]),D0(u[1]),D0(u[2]),u.length===3?h:uu(u[3])),$u(e,t),t;Ei(t,0,0,0,1);return;case"hsla":if(u.length!==4){Ei(t,0,0,0,1);return}return u[3]=uu(u[3]),sS(u,t),$u(e,t),t;case"hsl":if(u.length!==3){Ei(t,0,0,0,1);return}return sS(u,t),$u(e,t),t;default:return}}Ei(t,0,0,0,1)}}function sS(e,t){var r=(parseFloat(e[0])%360+360)%360/360,n=uu(e[1]),i=uu(e[2]),a=i<=.5?i*(n+1):i+n-i*n,o=i*2-a;return t=t||[],Ei(t,da(L0(o,a,r+1/3)*255),da(L0(o,a,r)*255),da(L0(o,a,r-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}function _V(e){if(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=a-i,s=(a+i)/2,l,u;if(o===0)l=0,u=0;else{s<.5?u=o/(a+i):u=o/(2-a-i);var h=((a-t)/6+o/2)/o,f=((a-r)/6+o/2)/o,c=((a-n)/6+o/2)/o;t===a?l=c-f:r===a?l=1/3+h-c:n===a&&(l=2/3+f-h),l<0&&(l+=1),l>1&&(l-=1)}var d=[l*360,u,s];return e[3]!=null&&d.push(e[3]),d}}function uf(e,t){var r=kn(e);if(r){for(var n=0;n<3;n++)t<0?r[n]=r[n]*(1-t)|0:r[n]=(255-r[n])*t+r[n]|0,r[n]>255?r[n]=255:r[n]<0&&(r[n]=0);return Mo(r,r.length===4?"rgba":"rgb")}}function R0(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){r=r||[];var n=e*(t.length-1),i=Math.floor(n),a=Math.ceil(n),o=t[i],s=t[a],l=n-i;return r[0]=da(xs(o[0],s[0],l)),r[1]=da(xs(o[1],s[1],l)),r[2]=da(xs(o[2],s[2],l)),r[3]=Od(xs(o[3],s[3],l)),r}}function yV(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){var n=e*(t.length-1),i=Math.floor(n),a=Math.ceil(n),o=kn(t[i]),s=kn(t[a]),l=n-i,u=Mo([da(xs(o[0],s[0],l)),da(xs(o[1],s[1],l)),da(xs(o[2],s[2],l)),Od(xs(o[3],s[3],l))],"rgba");return r?{color:u,leftIndex:i,rightIndex:a,value:n}:u}}function md(e,t,r,n){var i=kn(e);if(e)return i=_V(i),t!=null&&(i[0]=mV(t)),r!=null&&(i[1]=uu(r)),n!=null&&(i[2]=uu(n)),Mo(sS(i),"rgba")}function dm(e,t){var r=kn(e);if(r&&t!=null)return r[3]=Od(t),Mo(r,"rgba")}function Mo(e,t){if(!(!e||!e.length)){var r=e[0]+","+e[1]+","+e[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(r+=","+e[3]),t+"("+r+")"}}function vm(e,t){var r=kn(e);return r?(.299*r[0]+.587*r[1]+.114*r[2])*r[3]/255+(1-r[3])*t:0}var JA=new Bf(100);function lS(e){if(Ct(e)){var t=JA.get(e);return t||(t=uf(e,-.1),JA.put(e,t)),t}else if(S_(e)){var r=rt({},e);return r.colorStops=ft(e.colorStops,function(n){return{offset:n.offset,color:uf(n.color,-.1)}}),r}return e}var pm=Math.round;function Fd(e){var t;if(!e||e==="transparent")e="none";else if(typeof e=="string"&&e.indexOf("rgba")>-1){var r=kn(e);r&&(e="rgb("+r[0]+","+r[1]+","+r[2]+")",t=r[3])}return{color:e,opacity:t??1}}var xV=1e-4;function Ss(e){return e<xV&&e>-1e-4}function ep(e){return pm(e*1e3)/1e3}function uS(e){return pm(e*1e4)/1e4}function SV(e){return"matrix("+ep(e[0])+","+ep(e[1])+","+ep(e[2])+","+ep(e[3])+","+uS(e[4])+","+uS(e[5])+")"}var TV={left:"start",right:"end",center:"middle",middle:"middle"};function bV(e,t,r){return r==="top"?e+=t/2:r==="bottom"&&(e-=t/2),e}function wV(e){return e&&(e.shadowBlur||e.shadowOffsetX||e.shadowOffsetY)}function MV(e){var t=e.style,r=e.getGlobalScale();return[t.shadowColor,(t.shadowBlur||0).toFixed(2),(t.shadowOffsetX||0).toFixed(2),(t.shadowOffsetY||0).toFixed(2),r[0],r[1]].join(",")}function lO(e){return e&&!!e.image}function AV(e){return e&&!!e.svgElement}function jb(e){return lO(e)||AV(e)}function uO(e){return e.type==="linear"}function hO(e){return e.type==="radial"}function fO(e){return e&&(e.type==="linear"||e.type==="radial")}function w_(e){return"url(#"+e+")"}function cO(e){var t=e.getGlobalScale(),r=Math.max(t[0],t[1]);return Math.max(Math.ceil(Math.log(r)/Math.log(10)),1)}function dO(e){var t=e.x||0,r=e.y||0,n=(e.rotation||0)*Og,i=se(e.scaleX,1),a=se(e.scaleY,1),o=e.skewX||0,s=e.skewY||0,l=[];return(t||r)&&l.push("translate("+t+"px,"+r+"px)"),n&&l.push("rotate("+n+")"),(i!==1||a!==1)&&l.push("scale("+i+","+a+")"),(o||s)&&l.push("skew("+pm(o*Og)+"deg, "+pm(s*Og)+"deg)"),l.join(" ")}var EV=function(){return ye.hasGlobalWindow&&Yt(window.btoa)?function(e){return window.btoa(unescape(encodeURIComponent(e)))}:typeof Buffer<"u"?function(e){return Buffer.from(e).toString("base64")}:function(e){return null}}(),hS=Array.prototype.slice;function vo(e,t,r){return(t-e)*r+e}function P0(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=vo(t[a],r[a],n);return e}function CV(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=vo(t[o][s],r[o][s],n)}return e}function rp(e,t,r,n){for(var i=t.length,a=0;a<i;a++)e[a]=t[a]+r[a]*n;return e}function QA(e,t,r,n){for(var i=t.length,a=i&&t[0].length,o=0;o<i;o++){e[o]||(e[o]=[]);for(var s=0;s<a;s++)e[o][s]=t[o][s]+r[o][s]*n}return e}function DV(e,t){for(var r=e.length,n=t.length,i=r>n?t:e,a=Math.min(r,n),o=i[a-1]||{color:[0,0,0,0],offset:0},s=a;s<Math.max(r,n);s++)i.push({offset:o.offset,color:o.color.slice()})}function LV(e,t,r){var n=e,i=t;if(!(!n.push||!i.push)){var a=n.length,o=i.length;if(a!==o){var s=a>o;if(s)n.length=o;else for(var l=a;l<o;l++)n.push(r===1?i[l]:hS.call(i[l]))}for(var u=n[0]&&n[0].length,l=0;l<n.length;l++)if(r===1)isNaN(n[l])&&(n[l]=i[l]);else for(var h=0;h<u;h++)isNaN(n[l][h])&&(n[l][h]=i[l][h])}}function _d(e){if(Dn(e)){var t=e.length;if(Dn(e[0])){for(var r=[],n=0;n<t;n++)r.push(hS.call(e[n]));return r}return hS.call(e)}return e}function kg(e){return e[0]=Math.floor(e[0])||0,e[1]=Math.floor(e[1])||0,e[2]=Math.floor(e[2])||0,e[3]=e[3]==null?1:e[3],"rgba("+e.join(",")+")"}function RV(e){return Dn(e&&e[0])?2:1}var np=0,Gg=1,vO=2,Qc=3,fS=4,cS=5,tE=6;function eE(e){return e===fS||e===cS}function ip(e){return e===Gg||e===vO}var vc=[0,0,0,0],PV=function(){function e(t){this.keyframes=[],this.discrete=!1,this._invalid=!1,this._needsSort=!1,this._lastFr=0,this._lastFrP=0,this.propName=t}return e.prototype.isFinished=function(){return this._finished},e.prototype.setFinished=function(){this._finished=!0,this._additiveTrack&&this._additiveTrack.setFinished()},e.prototype.needsAnimate=function(){return this.keyframes.length>=1},e.prototype.getAdditiveTrack=function(){return this._additiveTrack},e.prototype.addKeyframe=function(t,r,n){this._needsSort=!0;var i=this.keyframes,a=i.length,o=!1,s=tE,l=r;if(Dn(r)){var u=RV(r);s=u,(u===1&&!Be(r[0])||u===2&&!Be(r[0][0]))&&(o=!0)}else if(Be(r)&&!Id(r))s=np;else if(Ct(r))if(!isNaN(+r))s=np;else{var h=kn(r);h&&(l=h,s=Qc)}else if(S_(r)){var f=rt({},l);f.colorStops=ft(r.colorStops,function(d){return{offset:d.offset,color:kn(d.color)}}),uO(r)?s=fS:hO(r)&&(s=cS),l=f}a===0?this.valType=s:(s!==this.valType||s===tE)&&(o=!0),this.discrete=this.discrete||o;var c={time:t,value:l,rawValue:r,percent:0};return n&&(c.easing=n,c.easingFunc=Yt(n)?n:gd[n]||Kb(n)),i.push(c),c},e.prototype.prepare=function(t,r){var n=this.keyframes;this._needsSort&&n.sort(function(p,g){return p.time-g.time});for(var i=this.valType,a=n.length,o=n[a-1],s=this.discrete,l=ip(i),u=eE(i),h=0;h<a;h++){var f=n[h],c=f.value,d=o.value;f.percent=f.time/t,s||(l&&h!==a-1?LV(c,d,i):u&&DV(c.colorStops,d.colorStops))}if(!s&&i!==cS&&r&&this.needsAnimate()&&r.needsAnimate()&&i===r.valType&&!r._finished){this._additiveTrack=r;for(var v=n[0].value,h=0;h<a;h++)i===np?n[h].additiveValue=n[h].value-v:i===Qc?n[h].additiveValue=rp([],n[h].value,v,-1):ip(i)&&(n[h].additiveValue=i===Gg?rp([],n[h].value,v,-1):QA([],n[h].value,v,-1))}},e.prototype.step=function(t,r){if(!this._finished){this._additiveTrack&&this._additiveTrack._finished&&(this._additiveTrack=null);var n=this._additiveTrack!=null,i=n?"additiveValue":"value",a=this.valType,o=this.keyframes,s=o.length,l=this.propName,u=a===Qc,h,f=this._lastFr,c=Math.min,d,v;if(s===1)d=v=o[0];else{if(r<0)h=0;else if(r<this._lastFrP){var p=c(f+1,s-1);for(h=p;h>=0&&!(o[h].percent<=r);h--);h=c(h,s-2)}else{for(h=f;h<s&&!(o[h].percent>r);h++);h=c(h-1,s-2)}v=o[h+1],d=o[h]}if(d&&v){this._lastFr=h,this._lastFrP=r;var g=v.percent-d.percent,m=g===0?1:c((r-d.percent)/g,1);v.easingFunc&&(m=v.easingFunc(m));var _=n?this._additiveValue:u?vc:t[l];if((ip(a)||u)&&!_&&(_=this._additiveValue=[]),this.discrete)t[l]=m<1?d.rawValue:v.rawValue;else if(ip(a))a===Gg?P0(_,d[i],v[i],m):CV(_,d[i],v[i],m);else if(eE(a)){var y=d[i],x=v[i],T=a===fS;t[l]={type:T?"linear":"radial",x:vo(y.x,x.x,m),y:vo(y.y,x.y,m),colorStops:ft(y.colorStops,function(M,w){var b=x.colorStops[w];return{offset:vo(M.offset,b.offset,m),color:kg(P0([],M.color,b.color,m))}}),global:x.global},T?(t[l].x2=vo(y.x2,x.x2,m),t[l].y2=vo(y.y2,x.y2,m)):t[l].r=vo(y.r,x.r,m)}else if(u)P0(_,d[i],v[i],m),n||(t[l]=kg(_));else{var S=vo(d[i],v[i],m);n?this._additiveValue=S:t[l]=S}n&&this._addToTarget(t)}}},e.prototype._addToTarget=function(t){var r=this.valType,n=this.propName,i=this._additiveValue;r===np?t[n]=t[n]+i:r===Qc?(kn(t[n],vc),rp(vc,vc,i,1),t[n]=kg(vc)):r===Gg?rp(t[n],t[n],i,1):r===vO&&QA(t[n],t[n],i,1)},e}(),M_=function(){function e(t,r,n,i){if(this._tracks={},this._trackKeys=[],this._maxTime=0,this._started=0,this._clip=null,this._target=t,this._loop=r,r&&i){Vb("Can' use additive animation on looped animation.");return}this._additiveAnimators=i,this._allowDiscrete=n}return e.prototype.getMaxTime=function(){return this._maxTime},e.prototype.getDelay=function(){return this._delay},e.prototype.getLoop=function(){return this._loop},e.prototype.getTarget=function(){return this._target},e.prototype.changeTarget=function(t){this._target=t},e.prototype.when=function(t,r,n){return this.whenWithKeys(t,r,be(r),n)},e.prototype.whenWithKeys=function(t,r,n,i){for(var a=this._tracks,o=0;o<n.length;o++){var s=n[o],l=a[s];if(!l){l=a[s]=new PV(s);var u=void 0,h=this._getAdditiveTrack(s);if(h){var f=h.keyframes,c=f[f.length-1];u=c&&c.value,h.valType===Qc&&u&&(u=kg(u))}else u=this._target[s];if(u==null)continue;t>0&&l.addKeyframe(0,_d(u),i),this._trackKeys.push(s)}l.addKeyframe(t,_d(r[s]),i)}return this._maxTime=Math.max(this._maxTime,t),this},e.prototype.pause=function(){this._clip.pause(),this._paused=!0},e.prototype.resume=function(){this._clip.resume(),this._paused=!1},e.prototype.isPaused=function(){return!!this._paused},e.prototype.duration=function(t){return this._maxTime=t,this._force=!0,this},e.prototype._doneCallback=function(){this._setTracksFinished(),this._clip=null;var t=this._doneCbs;if(t)for(var r=t.length,n=0;n<r;n++)t[n].call(this)},e.prototype._abortedCallback=function(){this._setTracksFinished();var t=this.animation,r=this._abortedCbs;if(t&&t.removeClip(this._clip),this._clip=null,r)for(var n=0;n<r.length;n++)r[n].call(this)},e.prototype._setTracksFinished=function(){for(var t=this._tracks,r=this._trackKeys,n=0;n<r.length;n++)t[r[n]].setFinished()},e.prototype._getAdditiveTrack=function(t){var r,n=this._additiveAnimators;if(n)for(var i=0;i<n.length;i++){var a=n[i].getTrack(t);a&&(r=a)}return r},e.prototype.start=function(t){if(!(this._started>0)){this._started=1;for(var r=this,n=[],i=this._maxTime||0,a=0;a<this._trackKeys.length;a++){var o=this._trackKeys[a],s=this._tracks[o],l=this._getAdditiveTrack(o),u=s.keyframes,h=u.length;if(s.prepare(i,l),s.needsAnimate())if(!this._allowDiscrete&&s.discrete){var f=u[h-1];f&&(r._target[s.propName]=f.rawValue),s.setFinished()}else n.push(s)}if(n.length||this._force){var c=new pV({life:i,loop:this._loop,delay:this._delay||0,onframe:function(d){r._started=2;var v=r._additiveAnimators;if(v){for(var p=!1,g=0;g<v.length;g++)if(v[g]._clip){p=!0;break}p||(r._additiveAnimators=null)}for(var g=0;g<n.length;g++)n[g].step(r._target,d);var m=r._onframeCbs;if(m)for(var g=0;g<m.length;g++)m[g](r._target,d)},ondestroy:function(){r._doneCallback()}});this._clip=c,this.animation&&this.animation.addClip(c),t&&c.setEasing(t)}else this._doneCallback();return this}},e.prototype.stop=function(t){if(this._clip){var r=this._clip;t&&r.onframe(1),this._abortedCallback()}},e.prototype.delay=function(t){return this._delay=t,this},e.prototype.during=function(t){return t&&(this._onframeCbs||(this._onframeCbs=[]),this._onframeCbs.push(t)),this},e.prototype.done=function(t){return t&&(this._doneCbs||(this._doneCbs=[]),this._doneCbs.push(t)),this},e.prototype.aborted=function(t){return t&&(this._abortedCbs||(this._abortedCbs=[]),this._abortedCbs.push(t)),this},e.prototype.getClip=function(){return this._clip},e.prototype.getTrack=function(t){return this._tracks[t]},e.prototype.getTracks=function(){var t=this;return ft(this._trackKeys,function(r){return t._tracks[r]})},e.prototype.stopTracks=function(t,r){if(!t.length||!this._clip)return!0;for(var n=this._tracks,i=this._trackKeys,a=0;a<t.length;a++){var o=n[t[a]];o&&!o.isFinished()&&(r?o.step(this._target,1):this._started===1&&o.step(this._target,0),o.setFinished())}for(var s=!0,a=0;a<i.length;a++)if(!n[i[a]].isFinished()){s=!1;break}return s&&this._abortedCallback(),s},e.prototype.saveTo=function(t,r,n){if(t){r=r||this._trackKeys;for(var i=0;i<r.length;i++){var a=r[i],o=this._tracks[a];if(!(!o||o.isFinished())){var s=o.keyframes,l=s[n?0:s.length-1];l&&(t[a]=_d(l.rawValue))}}}},e.prototype.__changeFinalValue=function(t,r){r=r||be(t);for(var n=0;n<r.length;n++){var i=r[n],a=this._tracks[i];if(a){var o=a.keyframes;if(o.length>1){var s=o.pop();a.addKeyframe(s.time,t[i]),a.prepare(this._maxTime,a.getAdditiveTrack())}}}},e}();function Wh(){return new Date().getTime()}var IV=function(e){q(t,e);function t(r){var n=e.call(this)||this;return n._running=!1,n._time=0,n._pausedTime=0,n._pauseStart=0,n._paused=!1,r=r||{},n.stage=r.stage||{},n}return t.prototype.addClip=function(r){r.animation&&this.removeClip(r),this._head?(this._tail.next=r,r.prev=this._tail,r.next=null,this._tail=r):this._head=this._tail=r,r.animation=this},t.prototype.addAnimator=function(r){r.animation=this;var n=r.getClip();n&&this.addClip(n)},t.prototype.removeClip=function(r){if(r.animation){var n=r.prev,i=r.next;n?n.next=i:this._head=i,i?i.prev=n:this._tail=n,r.next=r.prev=r.animation=null}},t.prototype.removeAnimator=function(r){var n=r.getClip();n&&this.removeClip(n),r.animation=null},t.prototype.update=function(r){for(var n=Wh()-this._pausedTime,i=n-this._time,a=this._head;a;){var o=a.next,s=a.step(n,i);s&&(a.ondestroy(),this.removeClip(a)),a=o}this._time=n,r||(this.trigger("frame",i),this.stage.update&&this.stage.update())},t.prototype._startLoop=function(){var r=this;this._running=!0;function n(){r._running&&(xu(n),!r._paused&&r.update())}xu(n)},t.prototype.start=function(){this._running||(this._time=Wh(),this._pausedTime=0,this._startLoop())},t.prototype.stop=function(){this._running=!1},t.prototype.pause=function(){this._paused||(this._pauseStart=Wh(),this._paused=!0)},t.prototype.resume=function(){this._paused&&(this._pausedTime+=Wh()-this._pauseStart,this._paused=!1)},t.prototype.clear=function(){for(var r=this._head;r;){var n=r.next;r.prev=r.next=r.animation=null,r=n}this._head=this._tail=null},t.prototype.isFinished=function(){return this._head==null},t.prototype.animate=function(r,n){n=n||{},this.start();var i=new M_(r,n.loop);return this.addAnimator(i),i},t}(Zi),NV=300,I0=ye.domSupported,N0=function(){var e=["click","dblclick","mousewheel","wheel","mouseout","mouseup","mousedown","mousemove","contextmenu"],t=["touchstart","touchend","touchmove"],r={pointerdown:1,pointerup:1,pointermove:1,pointerout:1},n=ft(e,function(i){var a=i.replace("mouse","pointer");return r.hasOwnProperty(a)?a:i});return{mouse:e,touch:t,pointer:n}}(),rE={mouse:["mousemove","mouseup"],pointer:["pointermove","pointerup"]},nE=!1;function dS(e){var t=e.pointerType;return t==="pen"||t==="touch"}function OV(e){e.touching=!0,e.touchTimer!=null&&(clearTimeout(e.touchTimer),e.touchTimer=null),e.touchTimer=setTimeout(function(){e.touching=!1,e.touchTimer=null},700)}function O0(e){e&&(e.zrByTouch=!0)}function FV(e,t){return Ci(e.dom,new BV(e,t),!0)}function pO(e,t){for(var r=t,n=!1;r&&r.nodeType!==9&&!(n=r.domBelongToZr||r!==t&&r===e.painterRoot);)r=r.parentNode;return n}var BV=function(){function e(t,r){this.stopPropagation=Rr,this.stopImmediatePropagation=Rr,this.preventDefault=Rr,this.type=r.type,this.target=this.currentTarget=t.dom,this.pointerType=r.pointerType,this.clientX=r.clientX,this.clientY=r.clientY}return e}(),oa={mousedown:function(e){e=Ci(this.dom,e),this.__mayPointerCapture=[e.zrX,e.zrY],this.trigger("mousedown",e)},mousemove:function(e){e=Ci(this.dom,e);var t=this.__mayPointerCapture;t&&(e.zrX!==t[0]||e.zrY!==t[1])&&this.__togglePointerCapture(!0),this.trigger("mousemove",e)},mouseup:function(e){e=Ci(this.dom,e),this.__togglePointerCapture(!1),this.trigger("mouseup",e)},mouseout:function(e){e=Ci(this.dom,e);var t=e.toElement||e.relatedTarget;pO(this,t)||(this.__pointerCapturing&&(e.zrEventControl="no_globalout"),this.trigger("mouseout",e))},wheel:function(e){nE=!0,e=Ci(this.dom,e),this.trigger("mousewheel",e)},mousewheel:function(e){nE||(e=Ci(this.dom,e),this.trigger("mousewheel",e))},touchstart:function(e){e=Ci(this.dom,e),O0(e),this.__lastTouchMoment=new Date,this.handler.processGesture(e,"start"),oa.mousemove.call(this,e),oa.mousedown.call(this,e)},touchmove:function(e){e=Ci(this.dom,e),O0(e),this.handler.processGesture(e,"change"),oa.mousemove.call(this,e)},touchend:function(e){e=Ci(this.dom,e),O0(e),this.handler.processGesture(e,"end"),oa.mouseup.call(this,e),+new Date-+this.__lastTouchMoment<NV&&oa.click.call(this,e)},pointerdown:function(e){oa.mousedown.call(this,e)},pointermove:function(e){dS(e)||oa.mousemove.call(this,e)},pointerup:function(e){oa.mouseup.call(this,e)},pointerout:function(e){dS(e)||oa.mouseout.call(this,e)}};R(["click","dblclick","contextmenu"],function(e){oa[e]=function(t){t=Ci(this.dom,t),this.trigger(e,t)}});var vS={pointermove:function(e){dS(e)||vS.mousemove.call(this,e)},pointerup:function(e){vS.mouseup.call(this,e)},mousemove:function(e){this.trigger("mousemove",e)},mouseup:function(e){var t=this.__pointerCapturing;this.__togglePointerCapture(!1),this.trigger("mouseup",e),t&&(e.zrEventControl="only_globalout",this.trigger("mouseout",e))}};function UV(e,t){var r=t.domHandlers;ye.pointerEventsSupported?R(N0.pointer,function(n){Vg(t,n,function(i){r[n].call(e,i)})}):(ye.touchEventsSupported&&R(N0.touch,function(n){Vg(t,n,function(i){r[n].call(e,i),OV(t)})}),R(N0.mouse,function(n){Vg(t,n,function(i){i=Zb(i),t.touching||r[n].call(e,i)})}))}function zV(e,t){ye.pointerEventsSupported?R(rE.pointer,r):ye.touchEventsSupported||R(rE.mouse,r);function r(n){function i(a){a=Zb(a),pO(e,a.target)||(a=FV(e,a),t.domHandlers[n].call(e,a))}Vg(t,n,i,{capture:!0})}}function Vg(e,t,r,n){e.mounted[t]=r,e.listenerOpts[t]=n,iS(e.domTarget,t,r,n)}function F0(e){var t=e.mounted;for(var r in t)t.hasOwnProperty(r)&&J4(e.domTarget,r,t[r],e.listenerOpts[r]);e.mounted={}}var iE=function(){function e(t,r){this.mounted={},this.listenerOpts={},this.touching=!1,this.domTarget=t,this.domHandlers=r}return e}(),kV=function(e){q(t,e);function t(r,n){var i=e.call(this)||this;return i.__pointerCapturing=!1,i.dom=r,i.painterRoot=n,i._localHandlerScope=new iE(r,oa),I0&&(i._globalHandlerScope=new iE(document,vS)),UV(i,i._localHandlerScope),i}return t.prototype.dispose=function(){F0(this._localHandlerScope),I0&&F0(this._globalHandlerScope)},t.prototype.setCursor=function(r){this.dom.style&&(this.dom.style.cursor=r||"default")},t.prototype.__togglePointerCapture=function(r){if(this.__mayPointerCapture=null,I0&&+this.__pointerCapturing^+r){this.__pointerCapturing=r;var n=this._globalHandlerScope;r?zV(this,n):F0(n)}},t}(Zi),gO=1;ye.hasGlobalWindow&&(gO=Math.max(window.devicePixelRatio||window.screen&&window.screen.deviceXDPI/window.screen.logicalXDPI||1,1));var gm=gO,pS=.4,gS="#333",mS="#ccc",GV="#eee",aE=b_,VV=5e-5;function rl(e){return e>VV||e<-5e-5}var nl=[],Ku=[],B0=oi(),U0=Math.abs,yo=function(){function e(){}return e.prototype.getLocalTransform=function(t){return e.getLocalTransform(this,t)},e.prototype.setPosition=function(t){this.x=t[0],this.y=t[1]},e.prototype.setScale=function(t){this.scaleX=t[0],this.scaleY=t[1]},e.prototype.setSkew=function(t){this.skewX=t[0],this.skewY=t[1]},e.prototype.setOrigin=function(t){this.originX=t[0],this.originY=t[1]},e.prototype.needLocalTransform=function(){return rl(this.rotation)||rl(this.x)||rl(this.y)||rl(this.scaleX-1)||rl(this.scaleY-1)||rl(this.skewX)||rl(this.skewY)},e.prototype.updateTransform=function(){var t=this.parent&&this.parent.transform,r=this.needLocalTransform(),n=this.transform;if(!(r||t)){n&&(aE(n),this.invTransform=null);return}n=n||oi(),r?this.getLocalTransform(n):aE(n),t&&(r?wo(n,t,n):qb(n,t)),this.transform=n,this._resolveGlobalScaleRatio(n)},e.prototype._resolveGlobalScaleRatio=function(t){var r=this.globalScaleRatio;if(r!=null&&r!==1){this.getGlobalScale(nl);var n=nl[0]<0?-1:1,i=nl[1]<0?-1:1,a=((nl[0]-n)*r+n)/nl[0]||0,o=((nl[1]-i)*r+i)/nl[1]||0;t[0]*=a,t[1]*=a,t[2]*=o,t[3]*=o}this.invTransform=this.invTransform||oi(),Bu(this.invTransform,t)},e.prototype.getComputedTransform=function(){for(var t=this,r=[];t;)r.push(t),t=t.parent;for(;t=r.pop();)t.updateTransform();return this.transform},e.prototype.setLocalTransform=function(t){if(t){var r=t[0]*t[0]+t[1]*t[1],n=t[2]*t[2]+t[3]*t[3],i=Math.atan2(t[1],t[0]),a=Math.PI/2+i-Math.atan2(t[3],t[2]);n=Math.sqrt(n)*Math.cos(a),r=Math.sqrt(r),this.skewX=a,this.skewY=0,this.rotation=-i,this.x=+t[4],this.y=+t[5],this.scaleX=r,this.scaleY=n,this.originX=0,this.originY=0}},e.prototype.decomposeTransform=function(){if(this.transform){var t=this.parent,r=this.transform;t&&t.transform&&(t.invTransform=t.invTransform||oi(),wo(Ku,t.invTransform,r),r=Ku);var n=this.originX,i=this.originY;(n||i)&&(B0[4]=n,B0[5]=i,wo(Ku,r,B0),Ku[4]-=n,Ku[5]-=i,r=Ku),this.setLocalTransform(r)}},e.prototype.getGlobalScale=function(t){var r=this.transform;return t=t||[],r?(t[0]=Math.sqrt(r[0]*r[0]+r[1]*r[1]),t[1]=Math.sqrt(r[2]*r[2]+r[3]*r[3]),r[0]<0&&(t[0]=-t[0]),r[3]<0&&(t[1]=-t[1]),t):(t[0]=1,t[1]=1,t)},e.prototype.transformCoordToLocal=function(t,r){var n=[t,r],i=this.invTransform;return i&&en(n,n,i),n},e.prototype.transformCoordToGlobal=function(t,r){var n=[t,r],i=this.transform;return i&&en(n,n,i),n},e.prototype.getLineScale=function(){var t=this.transform;return t&&U0(t[0]-1)>1e-10&&U0(t[3]-1)>1e-10?Math.sqrt(U0(t[0]*t[3]-t[2]*t[1])):1},e.prototype.copyTransform=function(t){mO(this,t)},e.getLocalTransform=function(t,r){r=r||[];var n=t.originX||0,i=t.originY||0,a=t.scaleX,o=t.scaleY,s=t.anchorX,l=t.anchorY,u=t.rotation||0,h=t.x,f=t.y,c=t.skewX?Math.tan(t.skewX):0,d=t.skewY?Math.tan(-t.skewY):0;if(n||i||s||l){var v=n+s,p=i+l;r[4]=-v*a-c*p*o,r[5]=-p*o-d*v*a}else r[4]=r[5]=0;return r[0]=a,r[3]=o,r[1]=d*a,r[2]=c*o,u&&Fu(r,r,u),r[4]+=n+h,r[5]+=i+f,r},e.initDefaultProps=function(){var t=e.prototype;t.scaleX=t.scaleY=t.globalScaleRatio=1,t.x=t.y=t.originX=t.originY=t.skewX=t.skewY=t.rotation=t.anchorX=t.anchorY=0}(),e}(),$a=["x","y","originX","originY","anchorX","anchorY","rotation","scaleX","scaleY","skewX","skewY"];function mO(e,t){for(var r=0;r<$a.length;r++){var n=$a[r];e[n]=t[n]}}var oE={};function _i(e,t){t=t||Is;var r=oE[t];r||(r=oE[t]=new Bf(500));var n=r.get(e);return n==null&&(n=Ns.measureText(e,t).width,r.put(e,n)),n}function sE(e,t,r,n){var i=_i(e,t),a=A_(t),o=td(0,i,r),s=zh(0,a,n),l=new fe(o,s,i,a);return l}function _v(e,t,r,n){var i=((e||"")+"").split(`
`),a=i.length;if(a===1)return sE(i[0],t,r,n);for(var o=new fe(0,0,0,0),s=0;s<i.length;s++){var l=sE(i[s],t,r,n);s===0?o.copy(l):o.union(l)}return o}function td(e,t,r){return r==="right"?e-=t:r==="center"&&(e-=t/2),e}function zh(e,t,r){return r==="middle"?e-=t/2:r==="bottom"&&(e-=t),e}function A_(e){return _i("国",e)}function _a(e,t){return typeof e=="string"?e.lastIndexOf("%")>=0?parseFloat(e)/100*t:parseFloat(e):e}function mm(e,t,r){var n=t.position||"inside",i=t.distance!=null?t.distance:5,a=r.height,o=r.width,s=a/2,l=r.x,u=r.y,h="left",f="top";if(n instanceof Array)l+=_a(n[0],r.width),u+=_a(n[1],r.height),h=null,f=null;else switch(n){case"left":l-=i,u+=s,h="right",f="middle";break;case"right":l+=i+o,u+=s,f="middle";break;case"top":l+=o/2,u-=i,h="center",f="bottom";break;case"bottom":l+=o/2,u+=a+i,h="center";break;case"inside":l+=o/2,u+=s,h="center",f="middle";break;case"insideLeft":l+=i,u+=s,f="middle";break;case"insideRight":l+=o-i,u+=s,h="right",f="middle";break;case"insideTop":l+=o/2,u+=i,h="center";break;case"insideBottom":l+=o/2,u+=a-i,h="center",f="bottom";break;case"insideTopLeft":l+=i,u+=i;break;case"insideTopRight":l+=o-i,u+=i,h="right";break;case"insideBottomLeft":l+=i,u+=a-i,f="bottom";break;case"insideBottomRight":l+=o-i,u+=a-i,h="right",f="bottom";break}return e=e||{},e.x=l,e.y=u,e.align=h,e.verticalAlign=f,e}var z0="__zr_normal__",k0=$a.concat(["ignore"]),HV=ma($a,function(e,t){return e[t]=!0,e},{ignore:!1}),ju={},WV=new fe(0,0,0,0),E_=function(){function e(t){this.id=WN(),this.animators=[],this.currentStates=[],this.states={},this._init(t)}return e.prototype._init=function(t){this.attr(t)},e.prototype.drift=function(t,r,n){switch(this.draggable){case"horizontal":r=0;break;case"vertical":t=0;break}var i=this.transform;i||(i=this.transform=[1,0,0,1,0,0]),i[4]+=t,i[5]+=r,this.decomposeTransform(),this.markRedraw()},e.prototype.beforeUpdate=function(){},e.prototype.afterUpdate=function(){},e.prototype.update=function(){this.updateTransform(),this.__dirty&&this.updateInnerText()},e.prototype.updateInnerText=function(t){var r=this._textContent;if(r&&(!r.ignore||t)){this.textConfig||(this.textConfig={});var n=this.textConfig,i=n.local,a=r.innerTransformable,o=void 0,s=void 0,l=!1;a.parent=i?this:null;var u=!1;if(a.copyTransform(r),n.position!=null){var h=WV;n.layoutRect?h.copy(n.layoutRect):h.copy(this.getBoundingRect()),i||h.applyTransform(this.transform),this.calculateTextPosition?this.calculateTextPosition(ju,n,h):mm(ju,n,h),a.x=ju.x,a.y=ju.y,o=ju.align,s=ju.verticalAlign;var f=n.origin;if(f&&n.rotation!=null){var c=void 0,d=void 0;f==="center"?(c=h.width*.5,d=h.height*.5):(c=_a(f[0],h.width),d=_a(f[1],h.height)),u=!0,a.originX=-a.x+c+(i?0:h.x),a.originY=-a.y+d+(i?0:h.y)}}n.rotation!=null&&(a.rotation=n.rotation);var v=n.offset;v&&(a.x+=v[0],a.y+=v[1],u||(a.originX=-v[0],a.originY=-v[1]));var p=n.inside==null?typeof n.position=="string"&&n.position.indexOf("inside")>=0:n.inside,g=this._innerTextDefaultStyle||(this._innerTextDefaultStyle={}),m=void 0,_=void 0,y=void 0;p&&this.canBeInsideText()?(m=n.insideFill,_=n.insideStroke,(m==null||m==="auto")&&(m=this.getInsideTextFill()),(_==null||_==="auto")&&(_=this.getInsideTextStroke(m),y=!0)):(m=n.outsideFill,_=n.outsideStroke,(m==null||m==="auto")&&(m=this.getOutsideFill()),(_==null||_==="auto")&&(_=this.getOutsideStroke(m),y=!0)),m=m||"#000",(m!==g.fill||_!==g.stroke||y!==g.autoStroke||o!==g.align||s!==g.verticalAlign)&&(l=!0,g.fill=m,g.stroke=_,g.autoStroke=y,g.align=o,g.verticalAlign=s,r.setDefaultTextStyle(g)),r.__dirty|=Va,l&&r.dirtyStyle(!0)}},e.prototype.canBeInsideText=function(){return!0},e.prototype.getInsideTextFill=function(){return"#fff"},e.prototype.getInsideTextStroke=function(t){return"#000"},e.prototype.getOutsideFill=function(){return this.__zr&&this.__zr.isDarkMode()?mS:gS},e.prototype.getOutsideStroke=function(t){var r=this.__zr&&this.__zr.getBackgroundColor(),n=typeof r=="string"&&kn(r);n||(n=[255,255,255,1]);for(var i=n[3],a=this.__zr.isDarkMode(),o=0;o<3;o++)n[o]=n[o]*i+(a?0:255)*(1-i);return n[3]=1,Mo(n,"rgba")},e.prototype.traverse=function(t,r){},e.prototype.attrKV=function(t,r){t==="textConfig"?this.setTextConfig(r):t==="textContent"?this.setTextContent(r):t==="clipPath"?this.setClipPath(r):t==="extra"?(this.extra=this.extra||{},rt(this.extra,r)):this[t]=r},e.prototype.hide=function(){this.ignore=!0,this.markRedraw()},e.prototype.show=function(){this.ignore=!1,this.markRedraw()},e.prototype.attr=function(t,r){if(typeof t=="string")this.attrKV(t,r);else if(Kt(t))for(var n=t,i=be(n),a=0;a<i.length;a++){var o=i[a];this.attrKV(o,t[o])}return this.markRedraw(),this},e.prototype.saveCurrentToNormalState=function(t){this._innerSaveToNormal(t);for(var r=this._normalState,n=0;n<this.animators.length;n++){var i=this.animators[n],a=i.__fromStateTransition;if(!(i.getLoop()||a&&a!==z0)){var o=i.targetName,s=o?r[o]:r;i.saveTo(s)}}},e.prototype._innerSaveToNormal=function(t){var r=this._normalState;r||(r=this._normalState={}),t.textConfig&&!r.textConfig&&(r.textConfig=this.textConfig),this._savePrimaryToNormal(t,r,k0)},e.prototype._savePrimaryToNormal=function(t,r,n){for(var i=0;i<n.length;i++){var a=n[i];t[a]!=null&&!(a in r)&&(r[a]=this[a])}},e.prototype.hasState=function(){return this.currentStates.length>0},e.prototype.getState=function(t){return this.states[t]},e.prototype.ensureState=function(t){var r=this.states;return r[t]||(r[t]={}),r[t]},e.prototype.clearStates=function(t){this.useState(z0,!1,t)},e.prototype.useState=function(t,r,n,i){var a=t===z0,o=this.hasState();if(!(!o&&a)){var s=this.currentStates,l=this.stateTransition;if(!(pe(s,t)>=0&&(r||s.length===1))){var u;if(this.stateProxy&&!a&&(u=this.stateProxy(t)),u||(u=this.states&&this.states[t]),!u&&!a){Vb("State "+t+" not exists.");return}a||this.saveCurrentToNormalState(u);var h=!!(u&&u.hoverLayer||i);h&&this._toggleHoverLayerFlag(!0),this._applyStateObj(t,u,this._normalState,r,!n&&!this.__inHover&&l&&l.duration>0,l);var f=this._textContent,c=this._textGuide;return f&&f.useState(t,r,n,h),c&&c.useState(t,r,n,h),a?(this.currentStates=[],this._normalState={}):r?this.currentStates.push(t):this.currentStates=[t],this._updateAnimationTargets(),this.markRedraw(),!h&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2),u}}},e.prototype.useStates=function(t,r,n){if(!t.length)this.clearStates();else{var i=[],a=this.currentStates,o=t.length,s=o===a.length;if(s){for(var l=0;l<o;l++)if(t[l]!==a[l]){s=!1;break}}if(s)return;for(var l=0;l<o;l++){var u=t[l],h=void 0;this.stateProxy&&(h=this.stateProxy(u,t)),h||(h=this.states[u]),h&&i.push(h)}var f=i[o-1],c=!!(f&&f.hoverLayer||n);c&&this._toggleHoverLayerFlag(!0);var d=this._mergeStates(i),v=this.stateTransition;this.saveCurrentToNormalState(d),this._applyStateObj(t.join(","),d,this._normalState,!1,!r&&!this.__inHover&&v&&v.duration>0,v);var p=this._textContent,g=this._textGuide;p&&p.useStates(t,r,c),g&&g.useStates(t,r,c),this._updateAnimationTargets(),this.currentStates=t.slice(),this.markRedraw(),!c&&this.__inHover&&(this._toggleHoverLayerFlag(!1),this.__dirty&=-2)}},e.prototype.isSilent=function(){for(var t=this.silent,r=this.parent;!t&&r;){if(r.silent){t=!0;break}r=r.parent}return t},e.prototype._updateAnimationTargets=function(){for(var t=0;t<this.animators.length;t++){var r=this.animators[t];r.targetName&&r.changeTarget(this[r.targetName])}},e.prototype.removeState=function(t){var r=pe(this.currentStates,t);if(r>=0){var n=this.currentStates.slice();n.splice(r,1),this.useStates(n)}},e.prototype.replaceState=function(t,r,n){var i=this.currentStates.slice(),a=pe(i,t),o=pe(i,r)>=0;a>=0?o?i.splice(a,1):i[a]=r:n&&!o&&i.push(r),this.useStates(i)},e.prototype.toggleState=function(t,r){r?this.useState(t,!0):this.removeState(t)},e.prototype._mergeStates=function(t){for(var r={},n,i=0;i<t.length;i++){var a=t[i];rt(r,a),a.textConfig&&(n=n||{},rt(n,a.textConfig))}return n&&(r.textConfig=n),r},e.prototype._applyStateObj=function(t,r,n,i,a,o){var s=!(r&&i);r&&r.textConfig?(this.textConfig=rt({},i?this.textConfig:n.textConfig),rt(this.textConfig,r.textConfig)):s&&n.textConfig&&(this.textConfig=n.textConfig);for(var l={},u=!1,h=0;h<k0.length;h++){var f=k0[h],c=a&&HV[f];r&&r[f]!=null?c?(u=!0,l[f]=r[f]):this[f]=r[f]:s&&n[f]!=null&&(c?(u=!0,l[f]=n[f]):this[f]=n[f])}if(!a)for(var h=0;h<this.animators.length;h++){var d=this.animators[h],v=d.targetName;d.getLoop()||d.__changeFinalValue(v?(r||n)[v]:r||n)}u&&this._transitionState(t,l,o)},e.prototype._attachComponent=function(t){if(!(t.__zr&&!t.__hostTarget)&&t!==this){var r=this.__zr;r&&t.addSelfToZr(r),t.__zr=r,t.__hostTarget=this}},e.prototype._detachComponent=function(t){t.__zr&&t.removeSelfFromZr(t.__zr),t.__zr=null,t.__hostTarget=null},e.prototype.getClipPath=function(){return this._clipPath},e.prototype.setClipPath=function(t){this._clipPath&&this._clipPath!==t&&this.removeClipPath(),this._attachComponent(t),this._clipPath=t,this.markRedraw()},e.prototype.removeClipPath=function(){var t=this._clipPath;t&&(this._detachComponent(t),this._clipPath=null,this.markRedraw())},e.prototype.getTextContent=function(){return this._textContent},e.prototype.setTextContent=function(t){var r=this._textContent;r!==t&&(r&&r!==t&&this.removeTextContent(),t.innerTransformable=new yo,this._attachComponent(t),this._textContent=t,this.markRedraw())},e.prototype.setTextConfig=function(t){this.textConfig||(this.textConfig={}),rt(this.textConfig,t),this.markRedraw()},e.prototype.removeTextConfig=function(){this.textConfig=null,this.markRedraw()},e.prototype.removeTextContent=function(){var t=this._textContent;t&&(t.innerTransformable=null,this._detachComponent(t),this._textContent=null,this._innerTextDefaultStyle=null,this.markRedraw())},e.prototype.getTextGuideLine=function(){return this._textGuide},e.prototype.setTextGuideLine=function(t){this._textGuide&&this._textGuide!==t&&this.removeTextGuideLine(),this._attachComponent(t),this._textGuide=t,this.markRedraw()},e.prototype.removeTextGuideLine=function(){var t=this._textGuide;t&&(this._detachComponent(t),this._textGuide=null,this.markRedraw())},e.prototype.markRedraw=function(){this.__dirty|=Va;var t=this.__zr;t&&(this.__inHover?t.refreshHover():t.refresh()),this.__hostTarget&&this.__hostTarget.markRedraw()},e.prototype.dirty=function(){this.markRedraw()},e.prototype._toggleHoverLayerFlag=function(t){this.__inHover=t;var r=this._textContent,n=this._textGuide;r&&(r.__inHover=t),n&&(n.__inHover=t)},e.prototype.addSelfToZr=function(t){if(this.__zr!==t){this.__zr=t;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.addAnimator(r[n]);this._clipPath&&this._clipPath.addSelfToZr(t),this._textContent&&this._textContent.addSelfToZr(t),this._textGuide&&this._textGuide.addSelfToZr(t)}},e.prototype.removeSelfFromZr=function(t){if(this.__zr){this.__zr=null;var r=this.animators;if(r)for(var n=0;n<r.length;n++)t.animation.removeAnimator(r[n]);this._clipPath&&this._clipPath.removeSelfFromZr(t),this._textContent&&this._textContent.removeSelfFromZr(t),this._textGuide&&this._textGuide.removeSelfFromZr(t)}},e.prototype.animate=function(t,r,n){var i=t?this[t]:this,a=new M_(i,r,n);return t&&(a.targetName=t),this.addAnimator(a,t),a},e.prototype.addAnimator=function(t,r){var n=this.__zr,i=this;t.during(function(){i.updateDuringAnimation(r)}).done(function(){var a=i.animators,o=pe(a,t);o>=0&&a.splice(o,1)}),this.animators.push(t),n&&n.animation.addAnimator(t),n&&n.wakeUp()},e.prototype.updateDuringAnimation=function(t){this.markRedraw()},e.prototype.stopAnimation=function(t,r){for(var n=this.animators,i=n.length,a=[],o=0;o<i;o++){var s=n[o];!t||t===s.scope?s.stop(r):a.push(s)}return this.animators=a,this},e.prototype.animateTo=function(t,r,n){G0(this,t,r,n)},e.prototype.animateFrom=function(t,r,n){G0(this,t,r,n,!0)},e.prototype._transitionState=function(t,r,n,i){for(var a=G0(this,r,n,i),o=0;o<a.length;o++)a[o].__fromStateTransition=t},e.prototype.getBoundingRect=function(){return null},e.prototype.getPaintRect=function(){return null},e.initDefaultProps=function(){var t=e.prototype;t.type="element",t.name="",t.ignore=t.silent=t.isGroup=t.draggable=t.dragging=t.ignoreClip=t.__inHover=!1,t.__dirty=Va;function r(n,i,a,o){Object.defineProperty(t,n,{get:function(){if(!this[i]){var l=this[i]=[];s(this,l)}return this[i]},set:function(l){this[a]=l[0],this[o]=l[1],this[i]=l,s(this,l)}});function s(l,u){Object.defineProperty(u,0,{get:function(){return l[a]},set:function(h){l[a]=h}}),Object.defineProperty(u,1,{get:function(){return l[o]},set:function(h){l[o]=h}})}}Object.defineProperty&&(r("position","_legacyPos","x","y"),r("scale","_legacyScale","scaleX","scaleY"),r("origin","_legacyOrigin","originX","originY"))}(),e}();Nr(E_,Zi);Nr(E_,yo);function G0(e,t,r,n,i){r=r||{};var a=[];_O(e,"",e,t,r,n,a,i);var o=a.length,s=!1,l=r.done,u=r.aborted,h=function(){s=!0,o--,o<=0&&(s?l&&l():u&&u())},f=function(){o--,o<=0&&(s?l&&l():u&&u())};o||l&&l(),a.length>0&&r.during&&a[0].during(function(v,p){r.during(p)});for(var c=0;c<a.length;c++){var d=a[c];d.done(h),d.aborted(f),r.force&&d.duration(r.duration),d.start(r.easing)}return a}function V0(e,t,r){for(var n=0;n<r;n++)e[n]=t[n]}function XV(e){return Dn(e[0])}function YV(e,t,r){if(Dn(t[r]))if(Dn(e[r])||(e[r]=[]),fi(t[r])){var n=t[r].length;e[r].length!==n&&(e[r]=new t[r].constructor(n),V0(e[r],t[r],n))}else{var i=t[r],a=e[r],o=i.length;if(XV(i))for(var s=i[0].length,l=0;l<o;l++)a[l]?V0(a[l],i[l],s):a[l]=Array.prototype.slice.call(i[l]);else V0(a,i,o);a.length=i.length}else e[r]=t[r]}function ZV(e,t){return e===t||Dn(e)&&Dn(t)&&qV(e,t)}function qV(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++)if(e[n]!==t[n])return!1;return!0}function _O(e,t,r,n,i,a,o,s){for(var l=be(n),u=i.duration,h=i.delay,f=i.additive,c=i.setToFinal,d=!Kt(a),v=e.animators,p=[],g=0;g<l.length;g++){var m=l[g],_=n[m];if(_!=null&&r[m]!=null&&(d||a[m]))if(Kt(_)&&!Dn(_)&&!S_(_)){if(t){s||(r[m]=_,e.updateDuringAnimation(t));continue}_O(e,m,r[m],_,i,a&&a[m],o,s)}else p.push(m);else s||(r[m]=_,e.updateDuringAnimation(t),p.push(m))}var y=p.length;if(!f&&y)for(var x=0;x<v.length;x++){var T=v[x];if(T.targetName===t){var S=T.stopTracks(p);if(S){var M=pe(v,T);v.splice(M,1)}}}if(i.force||(p=Xe(p,function(E){return!ZV(n[E],r[E])}),y=p.length),y>0||i.force&&!o.length){var w=void 0,b=void 0,A=void 0;if(s){b={},c&&(w={});for(var x=0;x<y;x++){var m=p[x];b[m]=r[m],c?w[m]=n[m]:r[m]=n[m]}}else if(c){A={};for(var x=0;x<y;x++){var m=p[x];A[m]=_d(r[m]),YV(r,n,m)}}var T=new M_(r,!1,!1,f?Xe(v,function(C){return C.targetName===t}):null);T.targetName=t,i.scope&&(T.scope=i.scope),c&&w&&T.whenWithKeys(0,w,p),A&&T.whenWithKeys(0,A,p),T.whenWithKeys(u??500,s?b:n,p).delay(h||0),e.addAnimator(T,t),o.push(T)}}var re=function(e){q(t,e);function t(r){var n=e.call(this)||this;return n.isGroup=!0,n._children=[],n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.children=function(){return this._children.slice()},t.prototype.childAt=function(r){return this._children[r]},t.prototype.childOfName=function(r){for(var n=this._children,i=0;i<n.length;i++)if(n[i].name===r)return n[i]},t.prototype.childCount=function(){return this._children.length},t.prototype.add=function(r){return r&&r!==this&&r.parent!==this&&(this._children.push(r),this._doAdd(r)),this},t.prototype.addBefore=function(r,n){if(r&&r!==this&&r.parent!==this&&n&&n.parent===this){var i=this._children,a=i.indexOf(n);a>=0&&(i.splice(a,0,r),this._doAdd(r))}return this},t.prototype.replace=function(r,n){var i=pe(this._children,r);return i>=0&&this.replaceAt(n,i),this},t.prototype.replaceAt=function(r,n){var i=this._children,a=i[n];if(r&&r!==this&&r.parent!==this&&r!==a){i[n]=r,a.parent=null;var o=this.__zr;o&&a.removeSelfFromZr(o),this._doAdd(r)}return this},t.prototype._doAdd=function(r){r.parent&&r.parent.remove(r),r.parent=this;var n=this.__zr;n&&n!==r.__zr&&r.addSelfToZr(n),n&&n.refresh()},t.prototype.remove=function(r){var n=this.__zr,i=this._children,a=pe(i,r);return a<0?this:(i.splice(a,1),r.parent=null,n&&r.removeSelfFromZr(n),n&&n.refresh(),this)},t.prototype.removeAll=function(){for(var r=this._children,n=this.__zr,i=0;i<r.length;i++){var a=r[i];n&&a.removeSelfFromZr(n),a.parent=null}return r.length=0,this},t.prototype.eachChild=function(r,n){for(var i=this._children,a=0;a<i.length;a++){var o=i[a];r.call(n,o,a)}return this},t.prototype.traverse=function(r,n){for(var i=0;i<this._children.length;i++){var a=this._children[i],o=r.call(n,a);a.isGroup&&!o&&a.traverse(r,n)}return this},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.addSelfToZr(r)}},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++){var i=this._children[n];i.removeSelfFromZr(r)}},t.prototype.getBoundingRect=function(r){for(var n=new fe(0,0,0,0),i=r||this._children,a=[],o=null,s=0;s<i.length;s++){var l=i[s];if(!(l.ignore||l.invisible)){var u=l.getBoundingRect(),h=l.getLocalTransform(a);h?(fe.applyTransform(n,u,h),o=o||n.clone(),o.union(n)):(o=o||u.clone(),o.union(u))}}return o||n},t}(E_);re.prototype.type="group";/*!
* ZRender, a high performance 2d drawing library.
*
* Copyright (c) 2013, Baidu Inc.
* All rights reserved.
*
* LICENSE
* https://github.com/ecomfe/zrender/blob/master/LICENSE.txt
*/var Hg={},yO={};function $V(e){delete yO[e]}function KV(e){if(!e)return!1;if(typeof e=="string")return vm(e,1)<pS;if(e.colorStops){for(var t=e.colorStops,r=0,n=t.length,i=0;i<n;i++)r+=vm(t[i].color,1);return r/=n,r<pS}return!1}var jV=function(){function e(t,r,n){var i=this;this._sleepAfterStill=10,this._stillFrameAccum=0,this._needsRefresh=!0,this._needsRefreshHover=!0,this._darkMode=!1,n=n||{},this.dom=r,this.id=t;var a=new hV,o=n.renderer||"canvas";Hg[o]||(o=be(Hg)[0]),n.useDirtyRect=n.useDirtyRect==null?!1:n.useDirtyRect;var s=new Hg[o](r,a,n,t),l=n.ssr||s.ssrOnly;this.storage=a,this.painter=s;var u=!ye.node&&!ye.worker&&!l?new kV(s.getViewportRoot(),s.root):null,h=n.useCoarsePointer,f=h==null||h==="auto"?ye.touchEventsSupported:!!h,c=44,d;f&&(d=se(n.pointerSize,c)),this.handler=new KN(a,s,u,s.root,d),this.animation=new IV({stage:{update:l?null:function(){return i._flush(!0)}}}),l||this.animation.start()}return e.prototype.add=function(t){this._disposed||!t||(this.storage.addRoot(t),t.addSelfToZr(this),this.refresh())},e.prototype.remove=function(t){this._disposed||!t||(this.storage.delRoot(t),t.removeSelfFromZr(this),this.refresh())},e.prototype.configLayer=function(t,r){this._disposed||(this.painter.configLayer&&this.painter.configLayer(t,r),this.refresh())},e.prototype.setBackgroundColor=function(t){this._disposed||(this.painter.setBackgroundColor&&this.painter.setBackgroundColor(t),this.refresh(),this._backgroundColor=t,this._darkMode=KV(t))},e.prototype.getBackgroundColor=function(){return this._backgroundColor},e.prototype.setDarkMode=function(t){this._darkMode=t},e.prototype.isDarkMode=function(){return this._darkMode},e.prototype.refreshImmediately=function(t){this._disposed||(t||this.animation.update(!0),this._needsRefresh=!1,this.painter.refresh(),this._needsRefresh=!1)},e.prototype.refresh=function(){this._disposed||(this._needsRefresh=!0,this.animation.start())},e.prototype.flush=function(){this._disposed||this._flush(!1)},e.prototype._flush=function(t){var r,n=Wh();this._needsRefresh&&(r=!0,this.refreshImmediately(t)),this._needsRefreshHover&&(r=!0,this.refreshHoverImmediately());var i=Wh();r?(this._stillFrameAccum=0,this.trigger("rendered",{elapsedTime:i-n})):this._sleepAfterStill>0&&(this._stillFrameAccum++,this._stillFrameAccum>this._sleepAfterStill&&this.animation.stop())},e.prototype.setSleepAfterStill=function(t){this._sleepAfterStill=t},e.prototype.wakeUp=function(){this._disposed||(this.animation.start(),this._stillFrameAccum=0)},e.prototype.refreshHover=function(){this._needsRefreshHover=!0},e.prototype.refreshHoverImmediately=function(){this._disposed||(this._needsRefreshHover=!1,this.painter.refreshHover&&this.painter.getType()==="canvas"&&this.painter.refreshHover())},e.prototype.resize=function(t){this._disposed||(t=t||{},this.painter.resize(t.width,t.height),this.handler.resize())},e.prototype.clearAnimation=function(){this._disposed||this.animation.clear()},e.prototype.getWidth=function(){if(!this._disposed)return this.painter.getWidth()},e.prototype.getHeight=function(){if(!this._disposed)return this.painter.getHeight()},e.prototype.setCursorStyle=function(t){this._disposed||this.handler.setCursorStyle(t)},e.prototype.findHover=function(t,r){if(!this._disposed)return this.handler.findHover(t,r)},e.prototype.on=function(t,r,n){return this._disposed||this.handler.on(t,r,n),this},e.prototype.off=function(t,r){this._disposed||this.handler.off(t,r)},e.prototype.trigger=function(t,r){this._disposed||this.handler.trigger(t,r)},e.prototype.clear=function(){if(!this._disposed){for(var t=this.storage.getRoots(),r=0;r<t.length;r++)t[r]instanceof re&&t[r].removeSelfFromZr(this);this.storage.delAllRoots(),this.painter.clear()}},e.prototype.dispose=function(){this._disposed||(this.animation.stop(),this.clear(),this.storage.dispose(),this.painter.dispose(),this.handler.dispose(),this.animation=this.storage=this.painter=this.handler=null,this._disposed=!0,$V(this.id))},e}();function _S(e,t){var r=new jV(WN(),e,t);return yO[r.id]=r,r}function JV(e,t){Hg[e]=t}var yS;function QV(e){if(typeof yS=="function")return yS(e)}function t5(e){yS=e}var e5=1e-4,xO=20;function r5(e){return e.replace(/^\s+|\s+$/g,"")}function He(e,t,r,n){var i=t[0],a=t[1],o=r[0],s=r[1],l=a-i,u=s-o;if(l===0)return u===0?o:(o+s)/2;if(n)if(l>0){if(e<=i)return o;if(e>=a)return s}else{if(e>=i)return o;if(e<=a)return s}else{if(e===i)return o;if(e===a)return s}return(e-i)/l*u+o}function Tt(e,t){switch(e){case"center":case"middle":e="50%";break;case"left":case"top":e="0%";break;case"right":case"bottom":e="100%";break}return Ct(e)?r5(e).match(/%$/)?parseFloat(e)/100*t:parseFloat(e):e==null?NaN:+e}function dr(e,t,r){return t==null&&(t=10),t=Math.min(Math.max(0,t),xO),e=(+e).toFixed(t),r?e:+e}function ki(e){return e.sort(function(t,r){return t-r}),e}function Oa(e){if(e=+e,isNaN(e))return 0;if(e>1e-14){for(var t=1,r=0;r<15;r++,t*=10)if(Math.round(e*t)/t===e)return r}return Jb(e)}function Jb(e){var t=e.toString().toLowerCase(),r=t.indexOf("e"),n=r>0?+t.slice(r+1):0,i=r>0?r:t.length,a=t.indexOf("."),o=a<0?0:i-1-a;return Math.max(0,o-n)}function SO(e,t){var r=Math.log,n=Math.LN10,i=Math.floor(r(e[1]-e[0])/n),a=Math.round(r(Math.abs(t[1]-t[0]))/n),o=Math.min(Math.max(-i+a,0),20);return isFinite(o)?o:20}function n5(e,t){var r=ma(e,function(d,v){return d+(isNaN(v)?0:v)},0);if(r===0)return[];for(var n=Math.pow(10,t),i=ft(e,function(d){return(isNaN(d)?0:d)/r*n*100}),a=n*100,o=ft(i,function(d){return Math.floor(d)}),s=ma(o,function(d,v){return d+v},0),l=ft(i,function(d,v){return d-o[v]});s<a;){for(var u=Number.NEGATIVE_INFINITY,h=null,f=0,c=l.length;f<c;++f)l[f]>u&&(u=l[f],h=f);++o[h],l[h]=0,++s}return ft(o,function(d){return d/n})}function i5(e,t){var r=Math.max(Oa(e),Oa(t)),n=e+t;return r>xO?n:dr(n,r)}var lE=9007199254740991;function TO(e){var t=Math.PI*2;return(e%t+t)%t}function Bd(e){return e>-1e-4&&e<e5}var a5=/^(?:(\d{4})(?:[-\/](\d{1,2})(?:[-\/](\d{1,2})(?:[T ](\d{1,2})(?::(\d{1,2})(?::(\d{1,2})(?:[.,](\d+))?)?)?(Z|[\+\-]\d\d:?\d\d)?)?)?)?)?$/;function Xi(e){if(e instanceof Date)return e;if(Ct(e)){var t=a5.exec(e);if(!t)return new Date(NaN);if(t[8]){var r=+t[4]||0;return t[8].toUpperCase()!=="Z"&&(r-=+t[8].slice(0,3)),new Date(Date.UTC(+t[1],+(t[2]||1)-1,+t[3]||1,r,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0))}else return new Date(+t[1],+(t[2]||1)-1,+t[3]||1,+t[4]||0,+(t[5]||0),+t[6]||0,t[7]?+t[7].substring(0,3):0)}else if(e==null)return new Date(NaN);return new Date(Math.round(e))}function o5(e){return Math.pow(10,Qb(e))}function Qb(e){if(e===0)return 0;var t=Math.floor(Math.log(e)/Math.LN10);return e/Math.pow(10,t)>=10&&t++,t}function bO(e,t){var r=Qb(e),n=Math.pow(10,r),i=e/n,a;return i<1.5?a=1:i<2.5?a=2:i<4?a=3:i<7?a=5:a=10,e=a*n,r>=-20?+e.toFixed(r<0?-r:0):e}function H0(e,t){var r=(e.length-1)*t+1,n=Math.floor(r),i=+e[n-1],a=r-n;return a?i+a*(e[n]-i):i}function uE(e){e.sort(function(l,u){return s(l,u,0)?-1:1});for(var t=-1/0,r=1,n=0;n<e.length;){for(var i=e[n].interval,a=e[n].close,o=0;o<2;o++)i[o]<=t&&(i[o]=t,a[o]=o?1:1-r),t=i[o],r=a[o];i[0]===i[1]&&a[0]*a[1]!==1?e.splice(n,1):n++}return e;function s(l,u,h){return l.interval[h]<u.interval[h]||l.interval[h]===u.interval[h]&&(l.close[h]-u.close[h]===(h?-1:1)||!h&&s(l,u,1))}}function Ro(e){var t=parseFloat(e);return t==e&&(t!==0||!Ct(e)||e.indexOf("x")<=0)?t:NaN}function wO(e){return!isNaN(Ro(e))}function MO(){return Math.round(Math.random()*9)}function AO(e,t){return t===0?e:AO(t,e%t)}function hE(e,t){return e==null?t:t==null?e:e*t/AO(e,t)}function We(e){throw new Error(e)}function fE(e,t,r){return(t-e)*r+e}var EO="series\0",CO="\0_ec_\0";function er(e){return e instanceof Array?e:e==null?[]:[e]}function Su(e,t,r){if(e){e[t]=e[t]||{},e.emphasis=e.emphasis||{},e.emphasis[t]=e.emphasis[t]||{};for(var n=0,i=r.length;n<i;n++){var a=r[n];!e.emphasis[t].hasOwnProperty(a)&&e[t].hasOwnProperty(a)&&(e.emphasis[t][a]=e[t][a])}}}var cE=["fontStyle","fontWeight","fontSize","fontFamily","rich","tag","color","textBorderColor","textBorderWidth","width","height","lineHeight","align","verticalAlign","baseline","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY","backgroundColor","borderColor","borderWidth","borderRadius","padding"];function Uf(e){return Kt(e)&&!at(e)&&!(e instanceof Date)?e.value:e}function s5(e){return Kt(e)&&!(e instanceof Array)}function DO(e,t,r){var n=r==="normalMerge",i=r==="replaceMerge",a=r==="replaceAll";e=e||[],t=(t||[]).slice();var o=Ut();R(t,function(l,u){if(!Kt(l)){t[u]=null;return}});var s=l5(e,o,r);return(n||i)&&u5(s,e,o,t),n&&h5(s,t),n||i?f5(s,t,i):a&&c5(s,t),d5(s),s}function l5(e,t,r){var n=[];if(r==="replaceAll")return n;for(var i=0;i<e.length;i++){var a=e[i];a&&a.id!=null&&t.set(a.id,i),n.push({existing:r==="replaceMerge"||Ud(a)?null:a,newOption:null,keyInfo:null,brandNew:null})}return n}function u5(e,t,r,n){R(n,function(i,a){if(!(!i||i.id==null)){var o=yd(i.id),s=r.get(o);if(s!=null){var l=e[s];Hn(!l.newOption,'Duplicated option on id "'+o+'".'),l.newOption=i,l.existing=t[s],n[a]=null}}})}function h5(e,t){R(t,function(r,n){if(!(!r||r.name==null))for(var i=0;i<e.length;i++){var a=e[i].existing;if(!e[i].newOption&&a&&(a.id==null||r.id==null)&&!Ud(r)&&!Ud(a)&&LO("name",a,r)){e[i].newOption=r,t[n]=null;return}}})}function f5(e,t,r){R(t,function(n){if(n){for(var i,a=0;(i=e[a])&&(i.newOption||Ud(i.existing)||i.existing&&n.id!=null&&!LO("id",n,i.existing));)a++;i?(i.newOption=n,i.brandNew=r):e.push({newOption:n,brandNew:r,existing:null,keyInfo:null}),a++}})}function c5(e,t){R(t,function(r){e.push({newOption:r,brandNew:!0,existing:null,keyInfo:null})})}function d5(e){var t=Ut();R(e,function(r){var n=r.existing;n&&t.set(n.id,r)}),R(e,function(r){var n=r.newOption;Hn(!n||n.id==null||!t.get(n.id)||t.get(n.id)===r,"id duplicates: "+(n&&n.id)),n&&n.id!=null&&t.set(n.id,r),!r.keyInfo&&(r.keyInfo={})}),R(e,function(r,n){var i=r.existing,a=r.newOption,o=r.keyInfo;if(Kt(a)){if(o.name=a.name!=null?yd(a.name):i?i.name:EO+n,i)o.id=yd(i.id);else if(a.id!=null)o.id=yd(a.id);else{var s=0;do o.id="\0"+o.name+"\0"+s++;while(t.get(o.id))}t.set(o.id,r)}})}function LO(e,t,r){var n=Xr(t[e],null),i=Xr(r[e],null);return n!=null&&i!=null&&n===i}function yd(e){return Xr(e,"")}function Xr(e,t){return e==null?t:Ct(e)?e:Be(e)||j1(e)?e+"":t}function tw(e){var t=e.name;return!!(t&&t.indexOf(EO))}function Ud(e){return e&&e.id!=null&&yd(e.id).indexOf(CO)===0}function v5(e){return CO+e}function p5(e,t,r){R(e,function(n){var i=n.newOption;Kt(i)&&(n.keyInfo.mainType=t,n.keyInfo.subType=g5(t,i,n.existing,r))})}function g5(e,t,r,n){var i=t.type?t.type:r?r.subType:n.determineSubType(e,t);return i}function m5(e,t){var r={},n={};return i(e||[],r),i(t||[],n,r),[a(r),a(n)];function i(o,s,l){for(var u=0,h=o.length;u<h;u++){var f=Xr(o[u].seriesId,null);if(f==null)return;for(var c=er(o[u].dataIndex),d=l&&l[f],v=0,p=c.length;v<p;v++){var g=c[v];d&&d[g]?d[g]=null:(s[f]||(s[f]={}))[g]=1}}}function a(o,s){var l=[];for(var u in o)if(o.hasOwnProperty(u)&&o[u]!=null)if(s)l.push(+u);else{var h=a(o[u],!0);h.length&&l.push({seriesId:u,dataIndex:h})}return l}}function Tu(e,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return at(t.dataIndex)?ft(t.dataIndex,function(r){return e.indexOfRawIndex(r)}):e.indexOfRawIndex(t.dataIndex);if(t.name!=null)return at(t.name)?ft(t.name,function(r){return e.indexOfName(r)}):e.indexOfName(t.name)}function Le(){var e="__ec_inner_"+_5++;return function(t){return t[e]||(t[e]={})}}var _5=MO();function xd(e,t,r){var n=ew(t,r),i=n.mainTypeSpecified,a=n.queryOptionMap,o=n.others,s=o,l=r?r.defaultMainType:null;return!i&&l&&a.set(l,{}),a.each(function(u,h){var f=yv(e,h,u,{useDefault:l===h,enableAll:r&&r.enableAll!=null?r.enableAll:!0,enableNone:r&&r.enableNone!=null?r.enableNone:!0});s[h+"Models"]=f.models,s[h+"Model"]=f.models[0]}),s}function ew(e,t){var r;if(Ct(e)){var n={};n[e+"Index"]=0,r=n}else r=e;var i=Ut(),a={},o=!1;return R(r,function(s,l){if(l==="dataIndex"||l==="dataIndexInside"){a[l]=s;return}var u=l.match(/^(\w+)(Index|Id|Name)$/)||[],h=u[1],f=(u[2]||"").toLowerCase();if(!(!h||!f||t&&t.includeMainTypes&&pe(t.includeMainTypes,h)<0)){o=o||!!h;var c=i.get(h)||i.set(h,{});c[f]=s}}),{mainTypeSpecified:o,queryOptionMap:i,others:a}}var zr={useDefault:!0,enableAll:!1,enableNone:!1},y5={useDefault:!1,enableAll:!0,enableNone:!0};function yv(e,t,r,n){n=n||zr;var i=r.index,a=r.id,o=r.name,s={models:null,specified:i!=null||a!=null||o!=null};if(!s.specified){var l=void 0;return s.models=n.useDefault&&(l=e.getComponent(t))?[l]:[],s}return i==="none"||i===!1?(Hn(n.enableNone,'`"none"` or `false` is not a valid value on index option.'),s.models=[],s):(i==="all"&&(Hn(n.enableAll,'`"all"` is not a valid value on index option.'),i=a=o=null),s.models=e.queryComponents({mainType:t,index:i,id:a,name:o}),s)}function RO(e,t,r){e.setAttribute?e.setAttribute(t,r):e[t]=r}function x5(e,t){return e.getAttribute?e.getAttribute(t):e[t]}function S5(e){return e==="auto"?ye.domSupported?"html":"richText":e||"html"}function xS(e,t){var r=Ut(),n=[];return R(e,function(i){var a=t(i);(r.get(a)||(n.push(a),r.set(a,[]))).push(i)}),{keys:n,buckets:r}}function PO(e,t,r,n,i){var a=t==null||t==="auto";if(n==null)return n;if(Be(n)){var o=fE(r||0,n,i);return dr(o,a?Math.max(Oa(r||0),Oa(n)):t)}else{if(Ct(n))return i<1?r:n;for(var s=[],l=r,u=n,h=Math.max(l?l.length:0,u.length),f=0;f<h;++f){var c=e.getDimensionInfo(f);if(c&&c.type==="ordinal")s[f]=(i<1&&l?l:u)[f];else{var d=l&&l[f]?l[f]:0,v=u[f],o=fE(d,v,i);s[f]=dr(o,a?Math.max(Oa(d),Oa(v)):t)}}return s}}var T5=".",il="___EC__COMPONENT__CONTAINER___",IO="___EC__EXTENDED_CLASS___";function Fa(e){var t={main:"",sub:""};if(e){var r=e.split(T5);t.main=r[0]||"",t.sub=r[1]||""}return t}function b5(e){Hn(/^[a-zA-Z0-9_]+([.][a-zA-Z0-9_]+)?$/.test(e),'componentType "'+e+'" illegal')}function w5(e){return!!(e&&e[IO])}function rw(e,t){e.$constructor=e,e.extend=function(r){var n=this,i;return M5(n)?i=function(a){q(o,a);function o(){return a.apply(this,arguments)||this}return o}(n):(i=function(){(r.$constructor||n).apply(this,arguments)},Wb(i,this)),rt(i.prototype,r),i[IO]=!0,i.extend=this.extend,i.superCall=C5,i.superApply=D5,i.superClass=n,i}}function M5(e){return Yt(e)&&/^class\s/.test(Function.prototype.toString.call(e))}function NO(e,t){e.extend=t.extend}var A5=Math.round(Math.random()*10);function E5(e){var t=["__\0is_clz",A5++].join("_");e.prototype[t]=!0,e.isInstance=function(r){return!!(r&&r[t])}}function C5(e,t){for(var r=[],n=2;n<arguments.length;n++)r[n-2]=arguments[n];return this.superClass.prototype[t].apply(e,r)}function D5(e,t,r){return this.superClass.prototype[t].apply(e,r)}function C_(e){var t={};e.registerClass=function(n){var i=n.type||n.prototype.type;if(i){b5(i),n.prototype.type=i;var a=Fa(i);if(!a.sub)t[a.main]=n;else if(a.sub!==il){var o=r(a);o[a.sub]=n}}return n},e.getClass=function(n,i,a){var o=t[n];if(o&&o[il]&&(o=i?o[i]:null),a&&!o)throw new Error(i?"Component "+n+"."+(i||"")+" is used but not imported.":n+".type should be specified.");return o},e.getClassesByMainType=function(n){var i=Fa(n),a=[],o=t[i.main];return o&&o[il]?R(o,function(s,l){l!==il&&a.push(s)}):a.push(o),a},e.hasClass=function(n){var i=Fa(n);return!!t[i.main]},e.getAllClassMainTypes=function(){var n=[];return R(t,function(i,a){n.push(a)}),n},e.hasSubTypes=function(n){var i=Fa(n),a=t[i.main];return a&&a[il]};function r(n){var i=t[n.main];return(!i||!i[il])&&(i=t[n.main]={},i[il]=!0),i}}function bu(e,t){for(var r=0;r<e.length;r++)e[r][1]||(e[r][1]=e[r][0]);return t=t||!1,function(n,i,a){for(var o={},s=0;s<e.length;s++){var l=e[s][1];if(!(i&&pe(i,l)>=0||a&&pe(a,l)<0)){var u=n.getShallow(l,t);u!=null&&(o[e[s][0]]=u)}}return o}}var L5=[["fill","color"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["opacity"],["shadowColor"]],R5=bu(L5),P5=function(){function e(){}return e.prototype.getAreaStyle=function(t,r){return R5(this,t,r)},e}(),SS=new Bf(50);function I5(e){if(typeof e=="string"){var t=SS.get(e);return t&&t.image}else return e}function nw(e,t,r,n,i){if(e)if(typeof e=="string"){if(t&&t.__zrImageSrc===e||!r)return t;var a=SS.get(e),o={hostEl:r,cb:n,cbPayload:i};return a?(t=a.image,!D_(t)&&a.pending.push(o)):(t=Ns.loadImage(e,dE,dE),t.__zrImageSrc=e,SS.put(e,t.__cachedImgObj={image:t,pending:[o]})),t}else return e;else return t}function dE(){var e=this.__cachedImgObj;this.onload=this.onerror=this.__cachedImgObj=null;for(var t=0;t<e.pending.length;t++){var r=e.pending[t],n=r.cb;n&&n(this,r.cbPayload),r.hostEl.dirty()}e.pending.length=0}function D_(e){return e&&e.width&&e.height}var W0=/\{([a-zA-Z0-9_]+)\|([^}]*)\}/g;function N5(e,t,r,n,i,a){if(!r){e.text="",e.isTruncated=!1;return}var o=(t+"").split(`
`);a=OO(r,n,i,a);for(var s=!1,l={},u=0,h=o.length;u<h;u++)FO(l,o[u],a),o[u]=l.textLine,s=s||l.isTruncated;e.text=o.join(`
`),e.isTruncated=s}function OO(e,t,r,n){n=n||{};var i=rt({},n);i.font=t,r=se(r,"..."),i.maxIterations=se(n.maxIterations,2);var a=i.minChar=se(n.minChar,0);i.cnCharWidth=_i("国",t);var o=i.ascCharWidth=_i("a",t);i.placeholder=se(n.placeholder,"");for(var s=e=Math.max(0,e-1),l=0;l<a&&s>=o;l++)s-=o;var u=_i(r,t);return u>s&&(r="",u=0),s=e-u,i.ellipsis=r,i.ellipsisWidth=u,i.contentWidth=s,i.containerWidth=e,i}function FO(e,t,r){var n=r.containerWidth,i=r.font,a=r.contentWidth;if(!n){e.textLine="",e.isTruncated=!1;return}var o=_i(t,i);if(o<=n){e.textLine=t,e.isTruncated=!1;return}for(var s=0;;s++){if(o<=a||s>=r.maxIterations){t+=r.ellipsis;break}var l=s===0?O5(t,a,r.ascCharWidth,r.cnCharWidth):o>0?Math.floor(t.length*a/o):0;t=t.substr(0,l),o=_i(t,i)}t===""&&(t=r.placeholder),e.textLine=t,e.isTruncated=!0}function O5(e,t,r,n){for(var i=0,a=0,o=e.length;a<o&&i<t;a++){var s=e.charCodeAt(a);i+=0<=s&&s<=127?r:n}return a}function F5(e,t){e!=null&&(e+="");var r=t.overflow,n=t.padding,i=t.font,a=r==="truncate",o=A_(i),s=se(t.lineHeight,o),l=!!t.backgroundColor,u=t.lineOverflow==="truncate",h=!1,f=t.width,c;f!=null&&(r==="break"||r==="breakAll")?c=e?BO(e,t.font,f,r==="breakAll",0).lines:[]:c=e?e.split(`
`):[];var d=c.length*s,v=se(t.height,d);if(d>v&&u){var p=Math.floor(v/s);h=h||c.length>p,c=c.slice(0,p)}if(e&&a&&f!=null)for(var g=OO(f,i,t.ellipsis,{minChar:t.truncateMinChar,placeholder:t.placeholder}),m={},_=0;_<c.length;_++)FO(m,c[_],g),c[_]=m.textLine,h=h||m.isTruncated;for(var y=v,x=0,_=0;_<c.length;_++)x=Math.max(_i(c[_],i),x);f==null&&(f=x);var T=x;return n&&(y+=n[0]+n[2],T+=n[1]+n[3],f+=n[1]+n[3]),l&&(T=f),{lines:c,height:v,outerWidth:T,outerHeight:y,lineHeight:s,calculatedLineHeight:o,contentWidth:x,contentHeight:d,width:f,isTruncated:h}}var B5=function(){function e(){}return e}(),vE=function(){function e(t){this.tokens=[],t&&(this.tokens=t)}return e}(),U5=function(){function e(){this.width=0,this.height=0,this.contentWidth=0,this.contentHeight=0,this.outerWidth=0,this.outerHeight=0,this.lines=[],this.isTruncated=!1}return e}();function z5(e,t){var r=new U5;if(e!=null&&(e+=""),!e)return r;for(var n=t.width,i=t.height,a=t.overflow,o=(a==="break"||a==="breakAll")&&n!=null?{width:n,accumWidth:0,breakAll:a==="breakAll"}:null,s=W0.lastIndex=0,l;(l=W0.exec(e))!=null;){var u=l.index;u>s&&X0(r,e.substring(s,u),t,o),X0(r,l[2],t,o,l[1]),s=W0.lastIndex}s<e.length&&X0(r,e.substring(s,e.length),t,o);var h=[],f=0,c=0,d=t.padding,v=a==="truncate",p=t.lineOverflow==="truncate",g={};function m(z,X,Y){z.width=X,z.lineHeight=Y,f+=Y,c=Math.max(c,X)}t:for(var _=0;_<r.lines.length;_++){for(var y=r.lines[_],x=0,T=0,S=0;S<y.tokens.length;S++){var M=y.tokens[S],w=M.styleName&&t.rich[M.styleName]||{},b=M.textPadding=w.padding,A=b?b[1]+b[3]:0,E=M.font=w.font||t.font;M.contentHeight=A_(E);var C=se(w.height,M.contentHeight);if(M.innerHeight=C,b&&(C+=b[0]+b[2]),M.height=C,M.lineHeight=Ga(w.lineHeight,t.lineHeight,C),M.align=w&&w.align||t.align,M.verticalAlign=w&&w.verticalAlign||"middle",p&&i!=null&&f+M.lineHeight>i){var D=r.lines.length;S>0?(y.tokens=y.tokens.slice(0,S),m(y,T,x),r.lines=r.lines.slice(0,_+1)):r.lines=r.lines.slice(0,_),r.isTruncated=r.isTruncated||r.lines.length<D;break t}var L=w.width,P=L==null||L==="auto";if(typeof L=="string"&&L.charAt(L.length-1)==="%")M.percentWidth=L,h.push(M),M.contentWidth=_i(M.text,E);else{if(P){var N=w.backgroundColor,O=N&&N.image;O&&(O=I5(O),D_(O)&&(M.width=Math.max(M.width,O.width*C/O.height)))}var I=v&&n!=null?n-T:null;I!=null&&I<M.width?!P||I<A?(M.text="",M.width=M.contentWidth=0):(N5(g,M.text,I-A,E,t.ellipsis,{minChar:t.truncateMinChar}),M.text=g.text,r.isTruncated=r.isTruncated||g.isTruncated,M.width=M.contentWidth=_i(M.text,E)):M.contentWidth=_i(M.text,E)}M.width+=A,T+=M.width,w&&(x=Math.max(x,M.lineHeight))}m(y,T,x)}r.outerWidth=r.width=se(n,c),r.outerHeight=r.height=se(i,f),r.contentHeight=f,r.contentWidth=c,d&&(r.outerWidth+=d[1]+d[3],r.outerHeight+=d[0]+d[2]);for(var _=0;_<h.length;_++){var M=h[_],k=M.percentWidth;M.width=parseInt(k,10)/100*r.width}return r}function X0(e,t,r,n,i){var a=t==="",o=i&&r.rich[i]||{},s=e.lines,l=o.font||r.font,u=!1,h,f;if(n){var c=o.padding,d=c?c[1]+c[3]:0;if(o.width!=null&&o.width!=="auto"){var v=_a(o.width,n.width)+d;s.length>0&&v+n.accumWidth>n.width&&(h=t.split(`
`),u=!0),n.accumWidth=v}else{var p=BO(t,l,n.width,n.breakAll,n.accumWidth);n.accumWidth=p.accumWidth+d,f=p.linesWidths,h=p.lines}}else h=t.split(`
`);for(var g=0;g<h.length;g++){var m=h[g],_=new B5;if(_.styleName=i,_.text=m,_.isLineHolder=!m&&!a,typeof o.width=="number"?_.width=o.width:_.width=f?f[g]:_i(m,l),!g&&!u){var y=(s[s.length-1]||(s[0]=new vE)).tokens,x=y.length;x===1&&y[0].isLineHolder?y[0]=_:(m||!x||a)&&y.push(_)}else s.push(new vE([_]))}}function k5(e){var t=e.charCodeAt(0);return t>=32&&t<=591||t>=880&&t<=4351||t>=4608&&t<=5119||t>=7680&&t<=8303}var G5=ma(",&?/;] ".split(""),function(e,t){return e[t]=!0,e},{});function V5(e){return k5(e)?!!G5[e]:!0}function BO(e,t,r,n,i){for(var a=[],o=[],s="",l="",u=0,h=0,f=0;f<e.length;f++){var c=e.charAt(f);if(c===`
`){l&&(s+=l,h+=u),a.push(s),o.push(h),s="",l="",u=0,h=0;continue}var d=_i(c,t),v=n?!1:!V5(c);if(a.length?h+d>r:i+h+d>r){h?(s||l)&&(v?(s||(s=l,l="",u=0,h=u),a.push(s),o.push(h-u),l+=c,u+=d,s="",h=u):(l&&(s+=l,l="",u=0),a.push(s),o.push(h),s=c,h=d)):v?(a.push(l),o.push(u),l=c,u=d):(a.push(c),o.push(d));continue}h+=d,v?(l+=c,u+=d):(l&&(s+=l,l="",u=0),s+=c)}return!a.length&&!s&&(s=e,l="",u=0),l&&(s+=l),s&&(a.push(s),o.push(h)),a.length===1&&(h+=i),{accumWidth:h,lines:a,linesWidths:o}}var TS="__zr_style_"+Math.round(Math.random()*10),hu={shadowBlur:0,shadowOffsetX:0,shadowOffsetY:0,shadowColor:"#000",opacity:1,blend:"source-over"},L_={style:{shadowBlur:!0,shadowOffsetX:!0,shadowOffsetY:!0,shadowColor:!0,opacity:!0}};hu[TS]=!0;var pE=["z","z2","invisible"],H5=["invisible"],Yi=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype._init=function(r){for(var n=be(r),i=0;i<n.length;i++){var a=n[i];a==="style"?this.useStyle(r[a]):e.prototype.attrKV.call(this,a,r[a])}this.style||this.useStyle({})},t.prototype.beforeBrush=function(){},t.prototype.afterBrush=function(){},t.prototype.innerBeforeBrush=function(){},t.prototype.innerAfterBrush=function(){},t.prototype.shouldBePainted=function(r,n,i,a){var o=this.transform;if(this.ignore||this.invisible||this.style.opacity===0||this.culling&&W5(this,r,n)||o&&!o[0]&&!o[3])return!1;if(i&&this.__clipPaths){for(var s=0;s<this.__clipPaths.length;++s)if(this.__clipPaths[s].isZeroArea())return!1}if(a&&this.parent)for(var l=this.parent;l;){if(l.ignore)return!1;l=l.parent}return!0},t.prototype.contain=function(r,n){return this.rectContain(r,n)},t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.rectContain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();return a.contain(i[0],i[1])},t.prototype.getPaintRect=function(){var r=this._paintRect;if(!this._paintRect||this.__dirty){var n=this.transform,i=this.getBoundingRect(),a=this.style,o=a.shadowBlur||0,s=a.shadowOffsetX||0,l=a.shadowOffsetY||0;r=this._paintRect||(this._paintRect=new fe(0,0,0,0)),n?fe.applyTransform(r,i,n):r.copy(i),(o||s||l)&&(r.width+=o*2+Math.abs(s),r.height+=o*2+Math.abs(l),r.x=Math.min(r.x,r.x+s-o),r.y=Math.min(r.y,r.y+l-o));var u=this.dirtyRectTolerance;r.isZero()||(r.x=Math.floor(r.x-u),r.y=Math.floor(r.y-u),r.width=Math.ceil(r.width+1+u*2),r.height=Math.ceil(r.height+1+u*2))}return r},t.prototype.setPrevPaintRect=function(r){r?(this._prevPaintRect=this._prevPaintRect||new fe(0,0,0,0),this._prevPaintRect.copy(r)):this._prevPaintRect=null},t.prototype.getPrevPaintRect=function(){return this._prevPaintRect},t.prototype.animateStyle=function(r){return this.animate("style",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():this.markRedraw()},t.prototype.attrKV=function(r,n){r!=="style"?e.prototype.attrKV.call(this,r,n):this.style?this.setStyle(n):this.useStyle(n)},t.prototype.setStyle=function(r,n){return typeof r=="string"?this.style[r]=n:rt(this.style,r),this.dirtyStyle(),this},t.prototype.dirtyStyle=function(r){r||this.markRedraw(),this.__dirty|=zg,this._rect&&(this._rect=null)},t.prototype.dirty=function(){this.dirtyStyle()},t.prototype.styleChanged=function(){return!!(this.__dirty&zg)},t.prototype.styleUpdated=function(){this.__dirty&=-3},t.prototype.createStyle=function(r){return T_(hu,r)},t.prototype.useStyle=function(r){r[TS]||(r=this.createStyle(r)),this.__inHover?this.__hoverStyle=r:this.style=r,this.dirtyStyle()},t.prototype.isStyleObject=function(r){return r[TS]},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.style&&!n.style&&(n.style=this._mergeStyle(this.createStyle(),this.style)),this._savePrimaryToNormal(r,n,pE)},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.style?o?a?u=n.style:(u=this._mergeStyle(this.createStyle(),i.style),this._mergeStyle(u,n.style)):(u=this._mergeStyle(this.createStyle(),a?this.style:i.style),this._mergeStyle(u,n.style)):l&&(u=i.style),u)if(o){var h=this.style;if(this.style=this.createStyle(l?{}:h),l)for(var f=be(h),c=0;c<f.length;c++){var d=f[c];d in u&&(u[d]=u[d],this.style[d]=h[d])}for(var v=be(u),c=0;c<v.length;c++){var d=v[c];this.style[d]=this.style[d]}this._transitionState(r,{style:u},s,this.getAnimationStyleProps())}else this.useStyle(u);for(var p=this.__inHover?H5:pE,c=0;c<p.length;c++){var d=p[c];n&&n[d]!=null?this[d]=n[d]:l&&i[d]!=null&&(this[d]=i[d])}},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.style&&(i=i||{},this._mergeStyle(i,o.style))}return i&&(n.style=i),n},t.prototype._mergeStyle=function(r,n){return rt(r,n),r},t.prototype.getAnimationStyleProps=function(){return L_},t.initDefaultProps=function(){var r=t.prototype;r.type="displayable",r.invisible=!1,r.z=0,r.z2=0,r.zlevel=0,r.culling=!1,r.cursor="pointer",r.rectHover=!1,r.incremental=!1,r._rect=null,r.dirtyRectTolerance=0,r.__dirty=Va|zg}(),t}(E_),Y0=new fe(0,0,0,0),Z0=new fe(0,0,0,0);function W5(e,t,r){return Y0.copy(e.getBoundingRect()),e.transform&&Y0.applyTransform(e.transform),Z0.width=t,Z0.height=r,!Y0.intersect(Z0)}var ni=Math.min,ii=Math.max,q0=Math.sin,$0=Math.cos,al=Math.PI*2,ap=Ou(),op=Ou(),sp=Ou();function R_(e,t,r){if(e.length!==0){for(var n=e[0],i=n[0],a=n[0],o=n[1],s=n[1],l=1;l<e.length;l++)n=e[l],i=ni(i,n[0]),a=ii(a,n[0]),o=ni(o,n[1]),s=ii(s,n[1]);t[0]=i,t[1]=o,r[0]=a,r[1]=s}}function gE(e,t,r,n,i,a){i[0]=ni(e,r),i[1]=ni(t,n),a[0]=ii(e,r),a[1]=ii(t,n)}var mE=[],_E=[];function X5(e,t,r,n,i,a,o,s,l,u){var h=rO,f=$r,c=h(e,r,i,o,mE);l[0]=1/0,l[1]=1/0,u[0]=-1/0,u[1]=-1/0;for(var d=0;d<c;d++){var v=f(e,r,i,o,mE[d]);l[0]=ni(v,l[0]),u[0]=ii(v,u[0])}c=h(t,n,a,s,_E);for(var d=0;d<c;d++){var p=f(t,n,a,s,_E[d]);l[1]=ni(p,l[1]),u[1]=ii(p,u[1])}l[0]=ni(e,l[0]),u[0]=ii(e,u[0]),l[0]=ni(o,l[0]),u[0]=ii(o,u[0]),l[1]=ni(t,l[1]),u[1]=ii(t,u[1]),l[1]=ni(s,l[1]),u[1]=ii(s,u[1])}function Y5(e,t,r,n,i,a,o,s){var l=iO,u=dn,h=ii(ni(l(e,r,i),1),0),f=ii(ni(l(t,n,a),1),0),c=u(e,r,i,h),d=u(t,n,a,f);o[0]=ni(e,i,c),o[1]=ni(t,a,d),s[0]=ii(e,i,c),s[1]=ii(t,a,d)}function Z5(e,t,r,n,i,a,o,s,l){var u=ms,h=_s,f=Math.abs(i-a);if(f%al<1e-4&&f>1e-4){s[0]=e-r,s[1]=t-n,l[0]=e+r,l[1]=t+n;return}if(ap[0]=$0(i)*r+e,ap[1]=q0(i)*n+t,op[0]=$0(a)*r+e,op[1]=q0(a)*n+t,u(s,ap,op),h(l,ap,op),i=i%al,i<0&&(i=i+al),a=a%al,a<0&&(a=a+al),i>a&&!o?a+=al:i<a&&o&&(i+=al),o){var c=a;a=i,i=c}for(var d=0;d<a;d+=Math.PI/2)d>i&&(sp[0]=$0(d)*r+e,sp[1]=q0(d)*n+t,u(s,sp,s),h(l,sp,l))}var or={M:1,L:2,C:3,Q:4,A:5,Z:6,R:7},ol=[],sl=[],Ta=[],Zo=[],ba=[],wa=[],K0=Math.min,j0=Math.max,ll=Math.cos,ul=Math.sin,ro=Math.abs,bS=Math.PI,cs=bS*2,J0=typeof Float32Array<"u",pc=[];function Q0(e){var t=Math.round(e/bS*1e8)/1e8;return t%2*bS}function iw(e,t){var r=Q0(e[0]);r<0&&(r+=cs);var n=r-e[0],i=e[1];i+=n,!t&&i-r>=cs?i=r+cs:t&&r-i>=cs?i=r-cs:!t&&r>i?i=r+(cs-Q0(r-i)):t&&r<i&&(i=r-(cs-Q0(i-r))),e[0]=r,e[1]=i}var Ka=function(){function e(t){this.dpr=1,this._xi=0,this._yi=0,this._x0=0,this._y0=0,this._len=0,t&&(this._saveData=!1),this._saveData&&(this.data=[])}return e.prototype.increaseVersion=function(){this._version++},e.prototype.getVersion=function(){return this._version},e.prototype.setScale=function(t,r,n){n=n||0,n>0&&(this._ux=ro(n/gm/t)||0,this._uy=ro(n/gm/r)||0)},e.prototype.setDPR=function(t){this.dpr=t},e.prototype.setContext=function(t){this._ctx=t},e.prototype.getContext=function(){return this._ctx},e.prototype.beginPath=function(){return this._ctx&&this._ctx.beginPath(),this.reset(),this},e.prototype.reset=function(){this._saveData&&(this._len=0),this._pathSegLen&&(this._pathSegLen=null,this._pathLen=0),this._version++},e.prototype.moveTo=function(t,r){return this._drawPendingPt(),this.addData(or.M,t,r),this._ctx&&this._ctx.moveTo(t,r),this._x0=t,this._y0=r,this._xi=t,this._yi=r,this},e.prototype.lineTo=function(t,r){var n=ro(t-this._xi),i=ro(r-this._yi),a=n>this._ux||i>this._uy;if(this.addData(or.L,t,r),this._ctx&&a&&this._ctx.lineTo(t,r),a)this._xi=t,this._yi=r,this._pendingPtDist=0;else{var o=n*n+i*i;o>this._pendingPtDist&&(this._pendingPtX=t,this._pendingPtY=r,this._pendingPtDist=o)}return this},e.prototype.bezierCurveTo=function(t,r,n,i,a,o){return this._drawPendingPt(),this.addData(or.C,t,r,n,i,a,o),this._ctx&&this._ctx.bezierCurveTo(t,r,n,i,a,o),this._xi=a,this._yi=o,this},e.prototype.quadraticCurveTo=function(t,r,n,i){return this._drawPendingPt(),this.addData(or.Q,t,r,n,i),this._ctx&&this._ctx.quadraticCurveTo(t,r,n,i),this._xi=n,this._yi=i,this},e.prototype.arc=function(t,r,n,i,a,o){this._drawPendingPt(),pc[0]=i,pc[1]=a,iw(pc,o),i=pc[0],a=pc[1];var s=a-i;return this.addData(or.A,t,r,n,n,i,s,0,o?0:1),this._ctx&&this._ctx.arc(t,r,n,i,a,o),this._xi=ll(a)*n+t,this._yi=ul(a)*n+r,this},e.prototype.arcTo=function(t,r,n,i,a){return this._drawPendingPt(),this._ctx&&this._ctx.arcTo(t,r,n,i,a),this},e.prototype.rect=function(t,r,n,i){return this._drawPendingPt(),this._ctx&&this._ctx.rect(t,r,n,i),this.addData(or.R,t,r,n,i),this},e.prototype.closePath=function(){this._drawPendingPt(),this.addData(or.Z);var t=this._ctx,r=this._x0,n=this._y0;return t&&t.closePath(),this._xi=r,this._yi=n,this},e.prototype.fill=function(t){t&&t.fill(),this.toStatic()},e.prototype.stroke=function(t){t&&t.stroke(),this.toStatic()},e.prototype.len=function(){return this._len},e.prototype.setData=function(t){var r=t.length;!(this.data&&this.data.length===r)&&J0&&(this.data=new Float32Array(r));for(var n=0;n<r;n++)this.data[n]=t[n];this._len=r},e.prototype.appendPath=function(t){t instanceof Array||(t=[t]);for(var r=t.length,n=0,i=this._len,a=0;a<r;a++)n+=t[a].len();J0&&this.data instanceof Float32Array&&(this.data=new Float32Array(i+n));for(var a=0;a<r;a++)for(var o=t[a].data,s=0;s<o.length;s++)this.data[i++]=o[s];this._len=i},e.prototype.addData=function(t,r,n,i,a,o,s,l,u){if(this._saveData){var h=this.data;this._len+arguments.length>h.length&&(this._expandData(),h=this.data);for(var f=0;f<arguments.length;f++)h[this._len++]=arguments[f]}},e.prototype._drawPendingPt=function(){this._pendingPtDist>0&&(this._ctx&&this._ctx.lineTo(this._pendingPtX,this._pendingPtY),this._pendingPtDist=0)},e.prototype._expandData=function(){if(!(this.data instanceof Array)){for(var t=[],r=0;r<this._len;r++)t[r]=this.data[r];this.data=t}},e.prototype.toStatic=function(){if(this._saveData){this._drawPendingPt();var t=this.data;t instanceof Array&&(t.length=this._len,J0&&this._len>11&&(this.data=new Float32Array(t)))}},e.prototype.getBoundingRect=function(){Ta[0]=Ta[1]=ba[0]=ba[1]=Number.MAX_VALUE,Zo[0]=Zo[1]=wa[0]=wa[1]=-Number.MAX_VALUE;var t=this.data,r=0,n=0,i=0,a=0,o;for(o=0;o<this._len;){var s=t[o++],l=o===1;switch(l&&(r=t[o],n=t[o+1],i=r,a=n),s){case or.M:r=i=t[o++],n=a=t[o++],ba[0]=i,ba[1]=a,wa[0]=i,wa[1]=a;break;case or.L:gE(r,n,t[o],t[o+1],ba,wa),r=t[o++],n=t[o++];break;case or.C:X5(r,n,t[o++],t[o++],t[o++],t[o++],t[o],t[o+1],ba,wa),r=t[o++],n=t[o++];break;case or.Q:Y5(r,n,t[o++],t[o++],t[o],t[o+1],ba,wa),r=t[o++],n=t[o++];break;case or.A:var u=t[o++],h=t[o++],f=t[o++],c=t[o++],d=t[o++],v=t[o++]+d;o+=1;var p=!t[o++];l&&(i=ll(d)*f+u,a=ul(d)*c+h),Z5(u,h,f,c,d,v,p,ba,wa),r=ll(v)*f+u,n=ul(v)*c+h;break;case or.R:i=r=t[o++],a=n=t[o++];var g=t[o++],m=t[o++];gE(i,a,i+g,a+m,ba,wa);break;case or.Z:r=i,n=a;break}ms(Ta,Ta,ba),_s(Zo,Zo,wa)}return o===0&&(Ta[0]=Ta[1]=Zo[0]=Zo[1]=0),new fe(Ta[0],Ta[1],Zo[0]-Ta[0],Zo[1]-Ta[1])},e.prototype._calculateLength=function(){var t=this.data,r=this._len,n=this._ux,i=this._uy,a=0,o=0,s=0,l=0;this._pathSegLen||(this._pathSegLen=[]);for(var u=this._pathSegLen,h=0,f=0,c=0;c<r;){var d=t[c++],v=c===1;v&&(a=t[c],o=t[c+1],s=a,l=o);var p=-1;switch(d){case or.M:a=s=t[c++],o=l=t[c++];break;case or.L:{var g=t[c++],m=t[c++],_=g-a,y=m-o;(ro(_)>n||ro(y)>i||c===r-1)&&(p=Math.sqrt(_*_+y*y),a=g,o=m);break}case or.C:{var x=t[c++],T=t[c++],g=t[c++],m=t[c++],S=t[c++],M=t[c++];p=fV(a,o,x,T,g,m,S,M,10),a=S,o=M;break}case or.Q:{var x=t[c++],T=t[c++],g=t[c++],m=t[c++];p=dV(a,o,x,T,g,m,10),a=g,o=m;break}case or.A:var w=t[c++],b=t[c++],A=t[c++],E=t[c++],C=t[c++],D=t[c++],L=D+C;c+=1,v&&(s=ll(C)*A+w,l=ul(C)*E+b),p=j0(A,E)*K0(cs,Math.abs(D)),a=ll(L)*A+w,o=ul(L)*E+b;break;case or.R:{s=a=t[c++],l=o=t[c++];var P=t[c++],N=t[c++];p=P*2+N*2;break}case or.Z:{var _=s-a,y=l-o;p=Math.sqrt(_*_+y*y),a=s,o=l;break}}p>=0&&(u[f++]=p,h+=p)}return this._pathLen=h,h},e.prototype.rebuildPath=function(t,r){var n=this.data,i=this._ux,a=this._uy,o=this._len,s,l,u,h,f,c,d=r<1,v,p,g=0,m=0,_,y=0,x,T;if(!(d&&(this._pathSegLen||this._calculateLength(),v=this._pathSegLen,p=this._pathLen,_=r*p,!_)))t:for(var S=0;S<o;){var M=n[S++],w=S===1;switch(w&&(u=n[S],h=n[S+1],s=u,l=h),M!==or.L&&y>0&&(t.lineTo(x,T),y=0),M){case or.M:s=u=n[S++],l=h=n[S++],t.moveTo(u,h);break;case or.L:{f=n[S++],c=n[S++];var b=ro(f-u),A=ro(c-h);if(b>i||A>a){if(d){var E=v[m++];if(g+E>_){var C=(_-g)/E;t.lineTo(u*(1-C)+f*C,h*(1-C)+c*C);break t}g+=E}t.lineTo(f,c),u=f,h=c,y=0}else{var D=b*b+A*A;D>y&&(x=f,T=c,y=D)}break}case or.C:{var L=n[S++],P=n[S++],N=n[S++],O=n[S++],I=n[S++],k=n[S++];if(d){var E=v[m++];if(g+E>_){var C=(_-g)/E;Os(u,L,N,I,C,ol),Os(h,P,O,k,C,sl),t.bezierCurveTo(ol[1],sl[1],ol[2],sl[2],ol[3],sl[3]);break t}g+=E}t.bezierCurveTo(L,P,N,O,I,k),u=I,h=k;break}case or.Q:{var L=n[S++],P=n[S++],N=n[S++],O=n[S++];if(d){var E=v[m++];if(g+E>_){var C=(_-g)/E;Nd(u,L,N,C,ol),Nd(h,P,O,C,sl),t.quadraticCurveTo(ol[1],sl[1],ol[2],sl[2]);break t}g+=E}t.quadraticCurveTo(L,P,N,O),u=N,h=O;break}case or.A:var z=n[S++],X=n[S++],Y=n[S++],$=n[S++],H=n[S++],Z=n[S++],ct=n[S++],ut=!n[S++],tt=Y>$?Y:$,et=ro(Y-$)>.001,st=H+Z,nt=!1;if(d){var E=v[m++];g+E>_&&(st=H+Z*(_-g)/E,nt=!0),g+=E}if(et&&t.ellipse?t.ellipse(z,X,Y,$,ct,H,st,ut):t.arc(z,X,tt,H,st,ut),nt)break t;w&&(s=ll(H)*Y+z,l=ul(H)*$+X),u=ll(st)*Y+z,h=ul(st)*$+X;break;case or.R:s=u=n[S],l=h=n[S+1],f=n[S++],c=n[S++];var dt=n[S++],At=n[S++];if(d){var E=v[m++];if(g+E>_){var G=_-g;t.moveTo(f,c),t.lineTo(f+K0(G,dt),c),G-=dt,G>0&&t.lineTo(f+dt,c+K0(G,At)),G-=At,G>0&&t.lineTo(f+j0(dt-G,0),c+At),G-=dt,G>0&&t.lineTo(f,c+j0(At-G,0));break t}g+=E}t.rect(f,c,dt,At);break;case or.Z:if(d){var E=v[m++];if(g+E>_){var C=(_-g)/E;t.lineTo(u*(1-C)+s*C,h*(1-C)+l*C);break t}g+=E}t.closePath(),u=s,h=l}}},e.prototype.clone=function(){var t=new e,r=this.data;return t.data=r.slice?r.slice():Array.prototype.slice.call(r),t._len=this._len,t},e.CMD=or,e.initDefaultProps=function(){var t=e.prototype;t._saveData=!0,t._ux=0,t._uy=0,t._pendingPtDist=0,t._version=0}(),e}();function go(e,t,r,n,i,a,o){if(i===0)return!1;var s=i,l=0,u=e;if(o>t+s&&o>n+s||o<t-s&&o<n-s||a>e+s&&a>r+s||a<e-s&&a<r-s)return!1;if(e!==r)l=(t-n)/(e-r),u=(e*n-r*t)/(e-r);else return Math.abs(a-e)<=s/2;var h=l*a-o+u,f=h*h/(l*l+1);return f<=s/2*s/2}function q5(e,t,r,n,i,a,o,s,l,u,h){if(l===0)return!1;var f=l;if(h>t+f&&h>n+f&&h>a+f&&h>s+f||h<t-f&&h<n-f&&h<a-f&&h<s-f||u>e+f&&u>r+f&&u>i+f&&u>o+f||u<e-f&&u<r-f&&u<i-f&&u<o-f)return!1;var c=nO(e,t,r,n,i,a,o,s,u,h,null);return c<=f/2}function UO(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;if(l>t+u&&l>n+u&&l>a+u||l<t-u&&l<n-u&&l<a-u||s>e+u&&s>r+u&&s>i+u||s<e-u&&s<r-u&&s<i-u)return!1;var h=aO(e,t,r,n,i,a,s,l,null);return h<=u/2}var yE=Math.PI*2;function mi(e){return e%=yE,e<0&&(e+=yE),e}var gc=Math.PI*2;function $5(e,t,r,n,i,a,o,s,l){if(o===0)return!1;var u=o;s-=e,l-=t;var h=Math.sqrt(s*s+l*l);if(h-u>r||h+u<r)return!1;if(Math.abs(n-i)%gc<1e-4)return!0;if(a){var f=n;n=mi(i),i=mi(f)}else n=mi(n),i=mi(i);n>i&&(i+=gc);var c=Math.atan2(l,s);return c<0&&(c+=gc),c>=n&&c<=i||c+gc>=n&&c+gc<=i}function po(e,t,r,n,i,a){if(a>t&&a>n||a<t&&a<n||n===t)return 0;var o=(a-t)/(n-t),s=n<t?1:-1;(o===1||o===0)&&(s=n<t?.5:-.5);var l=o*(r-e)+e;return l===i?1/0:l>i?s:0}var qo=Ka.CMD,hl=Math.PI*2,K5=1e-4;function j5(e,t){return Math.abs(e-t)<K5}var Fn=[-1,-1,-1],Li=[-1,-1];function J5(){var e=Li[0];Li[0]=Li[1],Li[1]=e}function Q5(e,t,r,n,i,a,o,s,l,u){if(u>t&&u>n&&u>a&&u>s||u<t&&u<n&&u<a&&u<s)return 0;var h=cm(t,n,a,s,u,Fn);if(h===0)return 0;for(var f=0,c=-1,d=void 0,v=void 0,p=0;p<h;p++){var g=Fn[p],m=g===0||g===1?.5:1,_=$r(e,r,i,o,g);_<l||(c<0&&(c=rO(t,n,a,s,Li),Li[1]<Li[0]&&c>1&&J5(),d=$r(t,n,a,s,Li[0]),c>1&&(v=$r(t,n,a,s,Li[1]))),c===2?g<Li[0]?f+=d<t?m:-m:g<Li[1]?f+=v<d?m:-m:f+=s<v?m:-m:g<Li[0]?f+=d<t?m:-m:f+=s<d?m:-m)}return f}function tH(e,t,r,n,i,a,o,s){if(s>t&&s>n&&s>a||s<t&&s<n&&s<a)return 0;var l=cV(t,n,a,s,Fn);if(l===0)return 0;var u=iO(t,n,a);if(u>=0&&u<=1){for(var h=0,f=dn(t,n,a,u),c=0;c<l;c++){var d=Fn[c]===0||Fn[c]===1?.5:1,v=dn(e,r,i,Fn[c]);v<o||(Fn[c]<u?h+=f<t?d:-d:h+=a<f?d:-d)}return h}else{var d=Fn[0]===0||Fn[0]===1?.5:1,v=dn(e,r,i,Fn[0]);return v<o?0:a<t?d:-d}}function eH(e,t,r,n,i,a,o,s){if(s-=t,s>r||s<-r)return 0;var l=Math.sqrt(r*r-s*s);Fn[0]=-l,Fn[1]=l;var u=Math.abs(n-i);if(u<1e-4)return 0;if(u>=hl-1e-4){n=0,i=hl;var h=a?1:-1;return o>=Fn[0]+e&&o<=Fn[1]+e?h:0}if(n>i){var f=n;n=i,i=f}n<0&&(n+=hl,i+=hl);for(var c=0,d=0;d<2;d++){var v=Fn[d];if(v+e>o){var p=Math.atan2(s,v),h=a?1:-1;p<0&&(p=hl+p),(p>=n&&p<=i||p+hl>=n&&p+hl<=i)&&(p>Math.PI/2&&p<Math.PI*1.5&&(h=-h),c+=h)}}return c}function zO(e,t,r,n,i){for(var a=e.data,o=e.len(),s=0,l=0,u=0,h=0,f=0,c,d,v=0;v<o;){var p=a[v++],g=v===1;switch(p===qo.M&&v>1&&(r||(s+=po(l,u,h,f,n,i))),g&&(l=a[v],u=a[v+1],h=l,f=u),p){case qo.M:h=a[v++],f=a[v++],l=h,u=f;break;case qo.L:if(r){if(go(l,u,a[v],a[v+1],t,n,i))return!0}else s+=po(l,u,a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case qo.C:if(r){if(q5(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=Q5(l,u,a[v++],a[v++],a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case qo.Q:if(r){if(UO(l,u,a[v++],a[v++],a[v],a[v+1],t,n,i))return!0}else s+=tH(l,u,a[v++],a[v++],a[v],a[v+1],n,i)||0;l=a[v++],u=a[v++];break;case qo.A:var m=a[v++],_=a[v++],y=a[v++],x=a[v++],T=a[v++],S=a[v++];v+=1;var M=!!(1-a[v++]);c=Math.cos(T)*y+m,d=Math.sin(T)*x+_,g?(h=c,f=d):s+=po(l,u,c,d,n,i);var w=(n-m)*x/y+m;if(r){if($5(m,_,x,T,T+S,M,t,w,i))return!0}else s+=eH(m,_,x,T,T+S,M,w,i);l=Math.cos(T+S)*y+m,u=Math.sin(T+S)*x+_;break;case qo.R:h=l=a[v++],f=u=a[v++];var b=a[v++],A=a[v++];if(c=h+b,d=f+A,r){if(go(h,f,c,f,t,n,i)||go(c,f,c,d,t,n,i)||go(c,d,h,d,t,n,i)||go(h,d,h,f,t,n,i))return!0}else s+=po(c,f,c,d,n,i),s+=po(h,d,h,f,n,i);break;case qo.Z:if(r){if(go(l,u,h,f,t,n,i))return!0}else s+=po(l,u,h,f,n,i);l=h,u=f;break}}return!r&&!j5(u,f)&&(s+=po(l,u,h,f,n,i)||0),s!==0}function rH(e,t,r){return zO(e,0,!1,t,r)}function nH(e,t,r,n){return zO(e,t,!0,r,n)}var _m=Vt({fill:"#000",stroke:null,strokePercent:1,fillOpacity:1,strokeOpacity:1,lineDashOffset:0,lineWidth:1,lineCap:"butt",miterLimit:10,strokeNoScale:!1,strokeFirst:!1},hu),iH={style:Vt({fill:!0,stroke:!0,strokePercent:!0,fillOpacity:!0,strokeOpacity:!0,lineDashOffset:!0,lineWidth:!0,miterLimit:!0},L_.style)},ty=$a.concat(["invisible","culling","z","z2","zlevel","parent"]),_e=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.update=function(){var r=this;e.prototype.update.call(this);var n=this.style;if(n.decal){var i=this._decalEl=this._decalEl||new t;i.buildPath===t.prototype.buildPath&&(i.buildPath=function(l){r.buildPath(l,r.shape)}),i.silent=!0;var a=i.style;for(var o in n)a[o]!==n[o]&&(a[o]=n[o]);a.fill=n.fill?n.decal:null,a.decal=null,a.shadowColor=null,n.strokeFirst&&(a.stroke=null);for(var s=0;s<ty.length;++s)i[ty[s]]=this[ty[s]];i.__dirty|=Va}else this._decalEl&&(this._decalEl=null)},t.prototype.getDecalElement=function(){return this._decalEl},t.prototype._init=function(r){var n=be(r);this.shape=this.getDefaultShape();var i=this.getDefaultStyle();i&&this.useStyle(i);for(var a=0;a<n.length;a++){var o=n[a],s=r[o];o==="style"?this.style?rt(this.style,s):this.useStyle(s):o==="shape"?rt(this.shape,s):e.prototype.attrKV.call(this,o,s)}this.style||this.useStyle({})},t.prototype.getDefaultStyle=function(){return null},t.prototype.getDefaultShape=function(){return{}},t.prototype.canBeInsideText=function(){return this.hasFill()},t.prototype.getInsideTextFill=function(){var r=this.style.fill;if(r!=="none"){if(Ct(r)){var n=vm(r,0);return n>.5?gS:n>.2?GV:mS}else if(r)return mS}return gS},t.prototype.getInsideTextStroke=function(r){var n=this.style.fill;if(Ct(n)){var i=this.__zr,a=!!(i&&i.isDarkMode()),o=vm(r,0)<pS;if(a===o)return n}},t.prototype.buildPath=function(r,n,i){},t.prototype.pathUpdated=function(){this.__dirty&=-5},t.prototype.getUpdatedPathProxy=function(r){return!this.path&&this.createPathProxy(),this.path.beginPath(),this.buildPath(this.path,this.shape,r),this.path},t.prototype.createPathProxy=function(){this.path=new Ka(!1)},t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return!(n==null||n==="none"||!(r.lineWidth>0))},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.getBoundingRect=function(){var r=this._rect,n=this.style,i=!r;if(i){var a=!1;this.path||(a=!0,this.createPathProxy());var o=this.path;(a||this.__dirty&Jc)&&(o.beginPath(),this.buildPath(o,this.shape,!1),this.pathUpdated()),r=o.getBoundingRect()}if(this._rect=r,this.hasStroke()&&this.path&&this.path.len()>0){var s=this._rectStroke||(this._rectStroke=r.clone());if(this.__dirty||i){s.copy(r);var l=n.strokeNoScale?this.getLineScale():1,u=n.lineWidth;if(!this.hasFill()){var h=this.strokeContainThreshold;u=Math.max(u,h??4)}l>1e-10&&(s.width+=u/l,s.height+=u/l,s.x-=u/l/2,s.y-=u/l/2)}return s}return r},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect(),o=this.style;if(r=i[0],n=i[1],a.contain(r,n)){var s=this.path;if(this.hasStroke()){var l=o.lineWidth,u=o.strokeNoScale?this.getLineScale():1;if(u>1e-10&&(this.hasFill()||(l=Math.max(l,this.strokeContainThreshold)),nH(s,l/u,r,n)))return!0}if(this.hasFill())return rH(s,r,n)}return!1},t.prototype.dirtyShape=function(){this.__dirty|=Jc,this._rect&&(this._rect=null),this._decalEl&&this._decalEl.dirtyShape(),this.markRedraw()},t.prototype.dirty=function(){this.dirtyStyle(),this.dirtyShape()},t.prototype.animateShape=function(r){return this.animate("shape",r)},t.prototype.updateDuringAnimation=function(r){r==="style"?this.dirtyStyle():r==="shape"?this.dirtyShape():this.markRedraw()},t.prototype.attrKV=function(r,n){r==="shape"?this.setShape(n):e.prototype.attrKV.call(this,r,n)},t.prototype.setShape=function(r,n){var i=this.shape;return i||(i=this.shape={}),typeof r=="string"?i[r]=n:rt(i,r),this.dirtyShape(),this},t.prototype.shapeChanged=function(){return!!(this.__dirty&Jc)},t.prototype.createStyle=function(r){return T_(_m,r)},t.prototype._innerSaveToNormal=function(r){e.prototype._innerSaveToNormal.call(this,r);var n=this._normalState;r.shape&&!n.shape&&(n.shape=rt({},this.shape))},t.prototype._applyStateObj=function(r,n,i,a,o,s){e.prototype._applyStateObj.call(this,r,n,i,a,o,s);var l=!(n&&a),u;if(n&&n.shape?o?a?u=n.shape:(u=rt({},i.shape),rt(u,n.shape)):(u=rt({},a?this.shape:i.shape),rt(u,n.shape)):l&&(u=i.shape),u)if(o){this.shape=rt({},this.shape);for(var h={},f=be(u),c=0;c<f.length;c++){var d=f[c];typeof u[d]=="object"?this.shape[d]=u[d]:h[d]=u[d]}this._transitionState(r,{shape:h},s)}else this.shape=u,this.dirtyShape()},t.prototype._mergeStates=function(r){for(var n=e.prototype._mergeStates.call(this,r),i,a=0;a<r.length;a++){var o=r[a];o.shape&&(i=i||{},this._mergeStyle(i,o.shape))}return i&&(n.shape=i),n},t.prototype.getAnimationStyleProps=function(){return iH},t.prototype.isZeroArea=function(){return!1},t.extend=function(r){var n=function(a){q(o,a);function o(s){var l=a.call(this,s)||this;return r.init&&r.init.call(l,s),l}return o.prototype.getDefaultStyle=function(){return Qt(r.style)},o.prototype.getDefaultShape=function(){return Qt(r.shape)},o}(t);for(var i in r)typeof r[i]=="function"&&(n.prototype[i]=r[i]);return n},t.initDefaultProps=function(){var r=t.prototype;r.type="path",r.strokeContainThreshold=5,r.segmentIgnoreThreshold=0,r.subPixelOptimize=!1,r.autoBatch=!1,r.__dirty=Va|zg|Jc}(),t}(Yi),aH=Vt({strokeFirst:!0,font:Is,x:0,y:0,textAlign:"left",textBaseline:"top",miterLimit:2},_m),hf=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.hasStroke=function(){var r=this.style,n=r.stroke;return n!=null&&n!=="none"&&r.lineWidth>0},t.prototype.hasFill=function(){var r=this.style,n=r.fill;return n!=null&&n!=="none"},t.prototype.createStyle=function(r){return T_(aH,r)},t.prototype.setBoundingRect=function(r){this._rect=r},t.prototype.getBoundingRect=function(){var r=this.style;if(!this._rect){var n=r.text;n!=null?n+="":n="";var i=_v(n,r.font,r.textAlign,r.textBaseline);if(i.x+=r.x||0,i.y+=r.y||0,this.hasStroke()){var a=r.lineWidth;i.x-=a/2,i.y-=a/2,i.width+=a,i.height+=a}this._rect=i}return this._rect},t.initDefaultProps=function(){var r=t.prototype;r.dirtyRectTolerance=10}(),t}(Yi);hf.prototype.type="tspan";var oH=Vt({x:0,y:0},hu),sH={style:Vt({x:!0,y:!0,width:!0,height:!0,sx:!0,sy:!0,sWidth:!0,sHeight:!0},L_.style)};function lH(e){return!!(e&&typeof e!="string"&&e.width&&e.height)}var hn=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.createStyle=function(r){return T_(oH,r)},t.prototype._getSize=function(r){var n=this.style,i=n[r];if(i!=null)return i;var a=lH(n.image)?n.image:this.__image;if(!a)return 0;var o=r==="width"?"height":"width",s=n[o];return s==null?a[r]:a[r]/a[o]*s},t.prototype.getWidth=function(){return this._getSize("width")},t.prototype.getHeight=function(){return this._getSize("height")},t.prototype.getAnimationStyleProps=function(){return sH},t.prototype.getBoundingRect=function(){var r=this.style;return this._rect||(this._rect=new fe(r.x||0,r.y||0,this.getWidth(),this.getHeight())),this._rect},t}(Yi);hn.prototype.type="image";function uH(e,t){var r=t.x,n=t.y,i=t.width,a=t.height,o=t.r,s,l,u,h;i<0&&(r=r+i,i=-i),a<0&&(n=n+a,a=-a),typeof o=="number"?s=l=u=h=o:o instanceof Array?o.length===1?s=l=u=h=o[0]:o.length===2?(s=u=o[0],l=h=o[1]):o.length===3?(s=o[0],l=h=o[1],u=o[2]):(s=o[0],l=o[1],u=o[2],h=o[3]):s=l=u=h=0;var f;s+l>i&&(f=s+l,s*=i/f,l*=i/f),u+h>i&&(f=u+h,u*=i/f,h*=i/f),l+u>a&&(f=l+u,l*=a/f,u*=a/f),s+h>a&&(f=s+h,s*=a/f,h*=a/f),e.moveTo(r+s,n),e.lineTo(r+i-l,n),l!==0&&e.arc(r+i-l,n+l,l,-Math.PI/2,0),e.lineTo(r+i,n+a-u),u!==0&&e.arc(r+i-u,n+a-u,u,0,Math.PI/2),e.lineTo(r+h,n+a),h!==0&&e.arc(r+h,n+a-h,h,Math.PI/2,Math.PI),e.lineTo(r,n+s),s!==0&&e.arc(r+s,n+s,s,Math.PI,Math.PI*1.5)}var Xh=Math.round;function kO(e,t,r){if(t){var n=t.x1,i=t.x2,a=t.y1,o=t.y2;e.x1=n,e.x2=i,e.y1=a,e.y2=o;var s=r&&r.lineWidth;return s&&(Xh(n*2)===Xh(i*2)&&(e.x1=e.x2=Kl(n,s,!0)),Xh(a*2)===Xh(o*2)&&(e.y1=e.y2=Kl(a,s,!0))),e}}function GO(e,t,r){if(t){var n=t.x,i=t.y,a=t.width,o=t.height;e.x=n,e.y=i,e.width=a,e.height=o;var s=r&&r.lineWidth;return s&&(e.x=Kl(n,s,!0),e.y=Kl(i,s,!0),e.width=Math.max(Kl(n+a,s,!1)-e.x,a===0?0:1),e.height=Math.max(Kl(i+o,s,!1)-e.y,o===0?0:1)),e}}function Kl(e,t,r){if(!t)return e;var n=Xh(e*2);return(n+Xh(t))%2===0?n/2:(n+(r?1:-1))/2}var hH=function(){function e(){this.x=0,this.y=0,this.width=0,this.height=0}return e}(),fH={},Ae=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new hH},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=GO(fH,n,this.style);i=l.x,a=l.y,o=l.width,s=l.height,l.r=n.r,n=l}else i=n.x,a=n.y,o=n.width,s=n.height;n.r?uH(r,n):r.rect(i,a,o,s)},t.prototype.isZeroArea=function(){return!this.shape.width||!this.shape.height},t}(_e);Ae.prototype.type="rect";var xE={fill:"#000"},SE=2,cH={style:Vt({fill:!0,stroke:!0,fillOpacity:!0,strokeOpacity:!0,lineWidth:!0,fontSize:!0,lineHeight:!0,width:!0,height:!0,textShadowColor:!0,textShadowBlur:!0,textShadowOffsetX:!0,textShadowOffsetY:!0,backgroundColor:!0,padding:!0,borderColor:!0,borderWidth:!0,borderRadius:!0},L_.style)},we=function(e){q(t,e);function t(r){var n=e.call(this)||this;return n.type="text",n._children=[],n._defaultStyle=xE,n.attr(r),n}return t.prototype.childrenRef=function(){return this._children},t.prototype.update=function(){e.prototype.update.call(this),this.styleChanged()&&this._updateSubTexts();for(var r=0;r<this._children.length;r++){var n=this._children[r];n.zlevel=this.zlevel,n.z=this.z,n.z2=this.z2,n.culling=this.culling,n.cursor=this.cursor,n.invisible=this.invisible}},t.prototype.updateTransform=function(){var r=this.innerTransformable;r?(r.updateTransform(),r.transform&&(this.transform=r.transform)):e.prototype.updateTransform.call(this)},t.prototype.getLocalTransform=function(r){var n=this.innerTransformable;return n?n.getLocalTransform(r):e.prototype.getLocalTransform.call(this,r)},t.prototype.getComputedTransform=function(){return this.__hostTarget&&(this.__hostTarget.getComputedTransform(),this.__hostTarget.updateInnerText(!0)),e.prototype.getComputedTransform.call(this)},t.prototype._updateSubTexts=function(){this._childCursor=0,pH(this.style),this.style.rich?this._updateRichTexts():this._updatePlainTexts(),this._children.length=this._childCursor,this.styleUpdated()},t.prototype.addSelfToZr=function(r){e.prototype.addSelfToZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=r},t.prototype.removeSelfFromZr=function(r){e.prototype.removeSelfFromZr.call(this,r);for(var n=0;n<this._children.length;n++)this._children[n].__zr=null},t.prototype.getBoundingRect=function(){if(this.styleChanged()&&this._updateSubTexts(),!this._rect){for(var r=new fe(0,0,0,0),n=this._children,i=[],a=null,o=0;o<n.length;o++){var s=n[o],l=s.getBoundingRect(),u=s.getLocalTransform(i);u?(r.copy(l),r.applyTransform(u),a=a||r.clone(),a.union(r)):(a=a||l.clone(),a.union(l))}this._rect=a||r}return this._rect},t.prototype.setDefaultTextStyle=function(r){this._defaultStyle=r||xE},t.prototype.setTextContent=function(r){},t.prototype._mergeStyle=function(r,n){if(!n)return r;var i=n.rich,a=r.rich||i&&{};return rt(r,n),i&&a?(this._mergeRich(a,i),r.rich=a):a&&(r.rich=a),r},t.prototype._mergeRich=function(r,n){for(var i=be(n),a=0;a<i.length;a++){var o=i[a];r[o]=r[o]||{},rt(r[o],n[o])}},t.prototype.getAnimationStyleProps=function(){return cH},t.prototype._getOrCreateChild=function(r){var n=this._children[this._childCursor];return(!n||!(n instanceof r))&&(n=new r),this._children[this._childCursor++]=n,n.__zr=this.__zr,n.parent=this,n},t.prototype._updatePlainTexts=function(){var r=this.style,n=r.font||Is,i=r.padding,a=CE(r),o=F5(a,r),s=ey(r),l=!!r.backgroundColor,u=o.outerHeight,h=o.outerWidth,f=o.contentWidth,c=o.lines,d=o.lineHeight,v=this._defaultStyle;this.isTruncated=!!o.isTruncated;var p=r.x||0,g=r.y||0,m=r.align||v.align||"left",_=r.verticalAlign||v.verticalAlign||"top",y=p,x=zh(g,o.contentHeight,_);if(s||i){var T=td(p,h,m),S=zh(g,u,_);s&&this._renderBackground(r,r,T,S,h,u)}x+=d/2,i&&(y=EE(p,m,i),_==="top"?x+=i[0]:_==="bottom"&&(x-=i[2]));for(var M=0,w=!1,b=AE("fill"in r?r.fill:(w=!0,v.fill)),A=ME("stroke"in r?r.stroke:!l&&(!v.autoStroke||w)?(M=SE,v.stroke):null),E=r.textShadowBlur>0,C=r.width!=null&&(r.overflow==="truncate"||r.overflow==="break"||r.overflow==="breakAll"),D=o.calculatedLineHeight,L=0;L<c.length;L++){var P=this._getOrCreateChild(hf),N=P.createStyle();P.useStyle(N),N.text=c[L],N.x=y,N.y=x,N.textAlign=m,N.textBaseline="middle",N.opacity=r.opacity,N.strokeFirst=!0,E&&(N.shadowBlur=r.textShadowBlur||0,N.shadowColor=r.textShadowColor||"transparent",N.shadowOffsetX=r.textShadowOffsetX||0,N.shadowOffsetY=r.textShadowOffsetY||0),N.stroke=A,N.fill=b,A&&(N.lineWidth=r.lineWidth||M,N.lineDash=r.lineDash,N.lineDashOffset=r.lineDashOffset||0),N.font=n,bE(N,r),x+=d,C&&P.setBoundingRect(new fe(td(N.x,f,N.textAlign),zh(N.y,D,N.textBaseline),f,D))}},t.prototype._updateRichTexts=function(){var r=this.style,n=CE(r),i=z5(n,r),a=i.width,o=i.outerWidth,s=i.outerHeight,l=r.padding,u=r.x||0,h=r.y||0,f=this._defaultStyle,c=r.align||f.align,d=r.verticalAlign||f.verticalAlign;this.isTruncated=!!i.isTruncated;var v=td(u,o,c),p=zh(h,s,d),g=v,m=p;l&&(g+=l[3],m+=l[0]);var _=g+a;ey(r)&&this._renderBackground(r,r,v,p,o,s);for(var y=!!r.backgroundColor,x=0;x<i.lines.length;x++){for(var T=i.lines[x],S=T.tokens,M=S.length,w=T.lineHeight,b=T.width,A=0,E=g,C=_,D=M-1,L=void 0;A<M&&(L=S[A],!L.align||L.align==="left");)this._placeToken(L,r,w,m,E,"left",y),b-=L.width,E+=L.width,A++;for(;D>=0&&(L=S[D],L.align==="right");)this._placeToken(L,r,w,m,C,"right",y),b-=L.width,C-=L.width,D--;for(E+=(a-(E-g)-(_-C)-b)/2;A<=D;)L=S[A],this._placeToken(L,r,w,m,E+L.width/2,"center",y),E+=L.width,A++;m+=w}},t.prototype._placeToken=function(r,n,i,a,o,s,l){var u=n.rich[r.styleName]||{};u.text=r.text;var h=r.verticalAlign,f=a+i/2;h==="top"?f=a+r.height/2:h==="bottom"&&(f=a+i-r.height/2);var c=!r.isLineHolder&&ey(u);c&&this._renderBackground(u,n,s==="right"?o-r.width:s==="center"?o-r.width/2:o,f-r.height/2,r.width,r.height);var d=!!u.backgroundColor,v=r.textPadding;v&&(o=EE(o,s,v),f-=r.height/2-v[0]-r.innerHeight/2);var p=this._getOrCreateChild(hf),g=p.createStyle();p.useStyle(g);var m=this._defaultStyle,_=!1,y=0,x=AE("fill"in u?u.fill:"fill"in n?n.fill:(_=!0,m.fill)),T=ME("stroke"in u?u.stroke:"stroke"in n?n.stroke:!d&&!l&&(!m.autoStroke||_)?(y=SE,m.stroke):null),S=u.textShadowBlur>0||n.textShadowBlur>0;g.text=r.text,g.x=o,g.y=f,S&&(g.shadowBlur=u.textShadowBlur||n.textShadowBlur||0,g.shadowColor=u.textShadowColor||n.textShadowColor||"transparent",g.shadowOffsetX=u.textShadowOffsetX||n.textShadowOffsetX||0,g.shadowOffsetY=u.textShadowOffsetY||n.textShadowOffsetY||0),g.textAlign=s,g.textBaseline="middle",g.font=r.font||Is,g.opacity=Ga(u.opacity,n.opacity,1),bE(g,u),T&&(g.lineWidth=Ga(u.lineWidth,n.lineWidth,y),g.lineDash=se(u.lineDash,n.lineDash),g.lineDashOffset=n.lineDashOffset||0,g.stroke=T),x&&(g.fill=x);var M=r.contentWidth,w=r.contentHeight;p.setBoundingRect(new fe(td(g.x,M,g.textAlign),zh(g.y,w,g.textBaseline),M,w))},t.prototype._renderBackground=function(r,n,i,a,o,s){var l=r.backgroundColor,u=r.borderWidth,h=r.borderColor,f=l&&l.image,c=l&&!f,d=r.borderRadius,v=this,p,g;if(c||r.lineHeight||u&&h){p=this._getOrCreateChild(Ae),p.useStyle(p.createStyle()),p.style.fill=null;var m=p.shape;m.x=i,m.y=a,m.width=o,m.height=s,m.r=d,p.dirtyShape()}if(c){var _=p.style;_.fill=l||null,_.fillOpacity=se(r.fillOpacity,1)}else if(f){g=this._getOrCreateChild(hn),g.onload=function(){v.dirtyStyle()};var y=g.style;y.image=l.image,y.x=i,y.y=a,y.width=o,y.height=s}if(u&&h){var _=p.style;_.lineWidth=u,_.stroke=h,_.strokeOpacity=se(r.strokeOpacity,1),_.lineDash=r.borderDash,_.lineDashOffset=r.borderDashOffset||0,p.strokeContainThreshold=0,p.hasFill()&&p.hasStroke()&&(_.strokeFirst=!0,_.lineWidth*=2)}var x=(p||g).style;x.shadowBlur=r.shadowBlur||0,x.shadowColor=r.shadowColor||"transparent",x.shadowOffsetX=r.shadowOffsetX||0,x.shadowOffsetY=r.shadowOffsetY||0,x.opacity=Ga(r.opacity,n.opacity,1)},t.makeFont=function(r){var n="";return HO(r)&&(n=[r.fontStyle,r.fontWeight,VO(r.fontSize),r.fontFamily||"sans-serif"].join(" ")),n&&ha(n)||r.textFont||r.font},t}(Yi),dH={left:!0,right:1,center:1},vH={top:1,bottom:1,middle:1},TE=["fontStyle","fontWeight","fontSize","fontFamily"];function VO(e){return typeof e=="string"&&(e.indexOf("px")!==-1||e.indexOf("rem")!==-1||e.indexOf("em")!==-1)?e:isNaN(+e)?zb+"px":e+"px"}function bE(e,t){for(var r=0;r<TE.length;r++){var n=TE[r],i=t[n];i!=null&&(e[n]=i)}}function HO(e){return e.fontSize!=null||e.fontFamily||e.fontWeight}function pH(e){return wE(e),R(e.rich,wE),e}function wE(e){if(e){e.font=we.makeFont(e);var t=e.align;t==="middle"&&(t="center"),e.align=t==null||dH[t]?t:"left";var r=e.verticalAlign;r==="center"&&(r="middle"),e.verticalAlign=r==null||vH[r]?r:"top";var n=e.padding;n&&(e.padding=Yb(e.padding))}}function ME(e,t){return e==null||t<=0||e==="transparent"||e==="none"?null:e.image||e.colorStops?"#000":e}function AE(e){return e==null||e==="none"?null:e.image||e.colorStops?"#000":e}function EE(e,t,r){return t==="right"?e-r[1]:t==="center"?e+r[3]/2-r[1]/2:e+r[3]}function CE(e){var t=e.text;return t!=null&&(t+=""),t}function ey(e){return!!(e.backgroundColor||e.lineHeight||e.borderWidth&&e.borderColor)}var oe=Le(),wS=function(e,t,r,n){if(n){var i=oe(n);i.dataIndex=r,i.dataType=t,i.seriesIndex=e,i.ssrType="chart",n.type==="group"&&n.traverse(function(a){var o=oe(a);o.seriesIndex=e,o.dataIndex=r,o.dataType=t,o.ssrType="chart"})}},DE=1,LE={},WO=Le(),aw=Le(),ow=0,xv=1,P_=2,Wn=["emphasis","blur","select"],zd=["normal","emphasis","blur","select"],zf=10,gH=9,fu="highlight",Wg="downplay",Sd="select",Xg="unselect",Td="toggleSelect";function Ju(e){return e!=null&&e!=="none"}function I_(e,t,r){e.onHoverStateChange&&(e.hoverState||0)!==r&&e.onHoverStateChange(t),e.hoverState=r}function XO(e){I_(e,"emphasis",P_)}function YO(e){e.hoverState===P_&&I_(e,"normal",ow)}function sw(e){I_(e,"blur",xv)}function ZO(e){e.hoverState===xv&&I_(e,"normal",ow)}function mH(e){e.selected=!0}function _H(e){e.selected=!1}function RE(e,t,r){t(e,r)}function Go(e,t,r){RE(e,t,r),e.isGroup&&e.traverse(function(n){RE(n,t,r)})}function ym(e,t){switch(t){case"emphasis":e.hoverState=P_;break;case"normal":e.hoverState=ow;break;case"blur":e.hoverState=xv;break;case"select":e.selected=!0}}function yH(e,t,r,n){for(var i=e.style,a={},o=0;o<t.length;o++){var s=t[o],l=i[s];a[s]=l??n[s]}for(var o=0;o<e.animators.length;o++){var u=e.animators[o];u.__fromStateTransition&&u.__fromStateTransition.indexOf(r)<0&&u.targetName==="style"&&u.saveTo(a,t)}return a}function xH(e,t,r,n){var i=r&&pe(r,"select")>=0,a=!1;if(e instanceof _e){var o=WO(e),s=i&&o.selectFill||o.normalFill,l=i&&o.selectStroke||o.normalStroke;if(Ju(s)||Ju(l)){n=n||{};var u=n.style||{};u.fill==="inherit"?(a=!0,n=rt({},n),u=rt({},u),u.fill=s):!Ju(u.fill)&&Ju(s)?(a=!0,n=rt({},n),u=rt({},u),u.fill=lS(s)):!Ju(u.stroke)&&Ju(l)&&(a||(n=rt({},n),u=rt({},u)),u.stroke=lS(l)),n.style=u}}if(n&&n.z2==null){a||(n=rt({},n));var h=e.z2EmphasisLift;n.z2=e.z2+(h??zf)}return n}function SH(e,t,r){if(r&&r.z2==null){r=rt({},r);var n=e.z2SelectLift;r.z2=e.z2+(n??gH)}return r}function TH(e,t,r){var n=pe(e.currentStates,t)>=0,i=e.style.opacity,a=n?null:yH(e,["opacity"],t,{opacity:1});r=r||{};var o=r.style||{};return o.opacity==null&&(r=rt({},r),o=rt({opacity:n?i:a.opacity*.1},o),r.style=o),r}function ry(e,t){var r=this.states[e];if(this.style){if(e==="emphasis")return xH(this,e,t,r);if(e==="blur")return TH(this,e,r);if(e==="select")return SH(this,e,r)}return r}function wu(e){e.stateProxy=ry;var t=e.getTextContent(),r=e.getTextGuideLine();t&&(t.stateProxy=ry),r&&(r.stateProxy=ry)}function PE(e,t){!jO(e,t)&&!e.__highByOuter&&Go(e,XO)}function IE(e,t){!jO(e,t)&&!e.__highByOuter&&Go(e,YO)}function Po(e,t){e.__highByOuter|=1<<(t||0),Go(e,XO)}function Io(e,t){!(e.__highByOuter&=~(1<<(t||0)))&&Go(e,YO)}function qO(e){Go(e,sw)}function lw(e){Go(e,ZO)}function $O(e){Go(e,mH)}function KO(e){Go(e,_H)}function jO(e,t){return e.__highDownSilentOnTouch&&t.zrByTouch}function JO(e){var t=e.getModel(),r=[],n=[];t.eachComponent(function(i,a){var o=aw(a),s=i==="series",l=s?e.getViewOfSeriesModel(a):e.getViewOfComponentModel(a);!s&&n.push(l),o.isBlured&&(l.group.traverse(function(u){ZO(u)}),s&&r.push(a)),o.isBlured=!1}),R(n,function(i){i&&i.toggleBlurSeries&&i.toggleBlurSeries(r,!1,t)})}function MS(e,t,r,n){var i=n.getModel();r=r||"coordinateSystem";function a(u,h){for(var f=0;f<h.length;f++){var c=u.getItemGraphicEl(h[f]);c&&lw(c)}}if(e!=null&&!(!t||t==="none")){var o=i.getSeriesByIndex(e),s=o.coordinateSystem;s&&s.master&&(s=s.master);var l=[];i.eachSeries(function(u){var h=o===u,f=u.coordinateSystem;f&&f.master&&(f=f.master);var c=f&&s?f===s:h;if(!(r==="series"&&!h||r==="coordinateSystem"&&!c||t==="series"&&h)){var d=n.getViewOfSeriesModel(u);if(d.group.traverse(function(g){g.__highByOuter&&h&&t==="self"||sw(g)}),Dn(t))a(u.getData(),t);else if(Kt(t))for(var v=be(t),p=0;p<v.length;p++)a(u.getData(v[p]),t[v[p]]);l.push(u),aw(u).isBlured=!0}}),i.eachComponent(function(u,h){if(u!=="series"){var f=n.getViewOfComponentModel(h);f&&f.toggleBlurSeries&&f.toggleBlurSeries(l,!0,i)}})}}function AS(e,t,r){if(!(e==null||t==null)){var n=r.getModel().getComponent(e,t);if(n){aw(n).isBlured=!0;var i=r.getViewOfComponentModel(n);!i||!i.focusBlurEnabled||i.group.traverse(function(a){sw(a)})}}}function bH(e,t,r){var n=e.seriesIndex,i=e.getData(t.dataType);if(i){var a=Tu(i,t);a=(at(a)?a[0]:a)||0;var o=i.getItemGraphicEl(a);if(!o)for(var s=i.count(),l=0;!o&&l<s;)o=i.getItemGraphicEl(l++);if(o){var u=oe(o);MS(n,u.focus,u.blurScope,r)}else{var h=e.get(["emphasis","focus"]),f=e.get(["emphasis","blurScope"]);h!=null&&MS(n,h,f,r)}}}function uw(e,t,r,n){var i={focusSelf:!1,dispatchers:null};if(e==null||e==="series"||t==null||r==null)return i;var a=n.getModel().getComponent(e,t);if(!a)return i;var o=n.getViewOfComponentModel(a);if(!o||!o.findHighDownDispatchers)return i;for(var s=o.findHighDownDispatchers(r),l,u=0;u<s.length;u++)if(oe(s[u]).focus==="self"){l=!0;break}return{focusSelf:l,dispatchers:s}}function wH(e,t,r){var n=oe(e),i=uw(n.componentMainType,n.componentIndex,n.componentHighDownName,r),a=i.dispatchers,o=i.focusSelf;a?(o&&AS(n.componentMainType,n.componentIndex,r),R(a,function(s){return PE(s,t)})):(MS(n.seriesIndex,n.focus,n.blurScope,r),n.focus==="self"&&AS(n.componentMainType,n.componentIndex,r),PE(e,t))}function MH(e,t,r){JO(r);var n=oe(e),i=uw(n.componentMainType,n.componentIndex,n.componentHighDownName,r).dispatchers;i?R(i,function(a){return IE(a,t)}):IE(e,t)}function AH(e,t,r){if(CS(t)){var n=t.dataType,i=e.getData(n),a=Tu(i,t);at(a)||(a=[a]),e[t.type===Td?"toggleSelect":t.type===Sd?"select":"unselect"](a,n)}}function NE(e){var t=e.getAllData();R(t,function(r){var n=r.data,i=r.type;n.eachItemGraphicEl(function(a,o){e.isSelected(o,i)?$O(a):KO(a)})})}function EH(e){var t=[];return e.eachSeries(function(r){var n=r.getAllData();R(n,function(i){i.data;var a=i.type,o=r.getSelectedDataIndices();if(o.length>0){var s={dataIndex:o,seriesIndex:r.seriesIndex};a!=null&&(s.dataType=a),t.push(s)}})}),t}function cu(e,t,r){jl(e,!0),Go(e,wu),ES(e,t,r)}function CH(e){jl(e,!1)}function Sr(e,t,r,n){n?CH(e):cu(e,t,r)}function ES(e,t,r){var n=oe(e);t!=null?(n.focus=t,n.blurScope=r):n.focus&&(n.focus=null)}var OE=["emphasis","blur","select"],DH={itemStyle:"getItemStyle",lineStyle:"getLineStyle",areaStyle:"getAreaStyle"};function xn(e,t,r,n){r=r||"itemStyle";for(var i=0;i<OE.length;i++){var a=OE[i],o=t.getModel([a,r]),s=e.ensureState(a);s.style=n?n(o):o[DH[r]]()}}function jl(e,t){var r=t===!1,n=e;e.highDownSilentOnTouch&&(n.__highDownSilentOnTouch=e.highDownSilentOnTouch),(!r||n.__highDownDispatcher)&&(n.__highByOuter=n.__highByOuter||0,n.__highDownDispatcher=!r)}function kd(e){return!!(e&&e.__highDownDispatcher)}function LH(e,t,r){var n=oe(e);n.componentMainType=t.mainType,n.componentIndex=t.componentIndex,n.componentHighDownName=r}function RH(e){var t=LE[e];return t==null&&DE<=32&&(t=LE[e]=DE++),t}function CS(e){var t=e.type;return t===Sd||t===Xg||t===Td}function FE(e){var t=e.type;return t===fu||t===Wg}function PH(e){var t=WO(e);t.normalFill=e.style.fill,t.normalStroke=e.style.stroke;var r=e.states.select||{};t.selectFill=r.style&&r.style.fill||null,t.selectStroke=r.style&&r.style.stroke||null}var Qu=Ka.CMD,IH=[[],[],[]],BE=Math.sqrt,NH=Math.atan2;function QO(e,t){if(t){var r=e.data,n=e.len(),i,a,o,s,l,u,h=Qu.M,f=Qu.C,c=Qu.L,d=Qu.R,v=Qu.A,p=Qu.Q;for(o=0,s=0;o<n;){switch(i=r[o++],s=o,a=0,i){case h:a=1;break;case c:a=1;break;case f:a=3;break;case p:a=2;break;case v:var g=t[4],m=t[5],_=BE(t[0]*t[0]+t[1]*t[1]),y=BE(t[2]*t[2]+t[3]*t[3]),x=NH(-t[1]/y,t[0]/_);r[o]*=_,r[o++]+=g,r[o]*=y,r[o++]+=m,r[o++]*=_,r[o++]*=y,r[o++]+=x,r[o++]+=x,o+=2,s=o;break;case d:u[0]=r[o++],u[1]=r[o++],en(u,u,t),r[s++]=u[0],r[s++]=u[1],u[0]+=r[o++],u[1]+=r[o++],en(u,u,t),r[s++]=u[0],r[s++]=u[1]}for(l=0;l<a;l++){var T=IH[l];T[0]=r[o++],T[1]=r[o++],en(T,T,t),r[s++]=T[0],r[s++]=T[1]}}e.increaseVersion()}}var ny=Math.sqrt,lp=Math.sin,up=Math.cos,mc=Math.PI;function UE(e){return Math.sqrt(e[0]*e[0]+e[1]*e[1])}function DS(e,t){return(e[0]*t[0]+e[1]*t[1])/(UE(e)*UE(t))}function zE(e,t){return(e[0]*t[1]<e[1]*t[0]?-1:1)*Math.acos(DS(e,t))}function kE(e,t,r,n,i,a,o,s,l,u,h){var f=l*(mc/180),c=up(f)*(e-r)/2+lp(f)*(t-n)/2,d=-1*lp(f)*(e-r)/2+up(f)*(t-n)/2,v=c*c/(o*o)+d*d/(s*s);v>1&&(o*=ny(v),s*=ny(v));var p=(i===a?-1:1)*ny((o*o*(s*s)-o*o*(d*d)-s*s*(c*c))/(o*o*(d*d)+s*s*(c*c)))||0,g=p*o*d/s,m=p*-s*c/o,_=(e+r)/2+up(f)*g-lp(f)*m,y=(t+n)/2+lp(f)*g+up(f)*m,x=zE([1,0],[(c-g)/o,(d-m)/s]),T=[(c-g)/o,(d-m)/s],S=[(-1*c-g)/o,(-1*d-m)/s],M=zE(T,S);if(DS(T,S)<=-1&&(M=mc),DS(T,S)>=1&&(M=0),M<0){var w=Math.round(M/mc*1e6)/1e6;M=mc*2+w%2*mc}h.addData(u,_,y,o,s,x,M,f,a)}var OH=/([mlvhzcqtsa])([^mlvhzcqtsa]*)/ig,FH=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function BH(e){var t=new Ka;if(!e)return t;var r=0,n=0,i=r,a=n,o,s=Ka.CMD,l=e.match(OH);if(!l)return t;for(var u=0;u<l.length;u++){for(var h=l[u],f=h.charAt(0),c=void 0,d=h.match(FH)||[],v=d.length,p=0;p<v;p++)d[p]=parseFloat(d[p]);for(var g=0;g<v;){var m=void 0,_=void 0,y=void 0,x=void 0,T=void 0,S=void 0,M=void 0,w=r,b=n,A=void 0,E=void 0;switch(f){case"l":r+=d[g++],n+=d[g++],c=s.L,t.addData(c,r,n);break;case"L":r=d[g++],n=d[g++],c=s.L,t.addData(c,r,n);break;case"m":r+=d[g++],n+=d[g++],c=s.M,t.addData(c,r,n),i=r,a=n,f="l";break;case"M":r=d[g++],n=d[g++],c=s.M,t.addData(c,r,n),i=r,a=n,f="L";break;case"h":r+=d[g++],c=s.L,t.addData(c,r,n);break;case"H":r=d[g++],c=s.L,t.addData(c,r,n);break;case"v":n+=d[g++],c=s.L,t.addData(c,r,n);break;case"V":n=d[g++],c=s.L,t.addData(c,r,n);break;case"C":c=s.C,t.addData(c,d[g++],d[g++],d[g++],d[g++],d[g++],d[g++]),r=d[g-2],n=d[g-1];break;case"c":c=s.C,t.addData(c,d[g++]+r,d[g++]+n,d[g++]+r,d[g++]+n,d[g++]+r,d[g++]+n),r+=d[g-2],n+=d[g-1];break;case"S":m=r,_=n,A=t.len(),E=t.data,o===s.C&&(m+=r-E[A-4],_+=n-E[A-3]),c=s.C,w=d[g++],b=d[g++],r=d[g++],n=d[g++],t.addData(c,m,_,w,b,r,n);break;case"s":m=r,_=n,A=t.len(),E=t.data,o===s.C&&(m+=r-E[A-4],_+=n-E[A-3]),c=s.C,w=r+d[g++],b=n+d[g++],r+=d[g++],n+=d[g++],t.addData(c,m,_,w,b,r,n);break;case"Q":w=d[g++],b=d[g++],r=d[g++],n=d[g++],c=s.Q,t.addData(c,w,b,r,n);break;case"q":w=d[g++]+r,b=d[g++]+n,r+=d[g++],n+=d[g++],c=s.Q,t.addData(c,w,b,r,n);break;case"T":m=r,_=n,A=t.len(),E=t.data,o===s.Q&&(m+=r-E[A-4],_+=n-E[A-3]),r=d[g++],n=d[g++],c=s.Q,t.addData(c,m,_,r,n);break;case"t":m=r,_=n,A=t.len(),E=t.data,o===s.Q&&(m+=r-E[A-4],_+=n-E[A-3]),r+=d[g++],n+=d[g++],c=s.Q,t.addData(c,m,_,r,n);break;case"A":y=d[g++],x=d[g++],T=d[g++],S=d[g++],M=d[g++],w=r,b=n,r=d[g++],n=d[g++],c=s.A,kE(w,b,r,n,S,M,y,x,T,c,t);break;case"a":y=d[g++],x=d[g++],T=d[g++],S=d[g++],M=d[g++],w=r,b=n,r+=d[g++],n+=d[g++],c=s.A,kE(w,b,r,n,S,M,y,x,T,c,t);break}}(f==="z"||f==="Z")&&(c=s.Z,t.addData(c),r=i,n=a),o=c}return t.toStatic(),t}var t3=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.applyTransform=function(r){},t}(_e);function e3(e){return e.setData!=null}function r3(e,t){var r=BH(e),n=rt({},t);return n.buildPath=function(i){if(e3(i)){i.setData(r.data);var a=i.getContext();a&&i.rebuildPath(a,1)}else{var a=i;r.rebuildPath(a,1)}},n.applyTransform=function(i){QO(r,i),this.dirtyShape()},n}function n3(e,t){return new t3(r3(e,t))}function UH(e,t){var r=r3(e,t),n=function(i){q(a,i);function a(o){var s=i.call(this,o)||this;return s.applyTransform=r.applyTransform,s.buildPath=r.buildPath,s}return a}(t3);return n}function zH(e,t){for(var r=[],n=e.length,i=0;i<n;i++){var a=e[i];r.push(a.getUpdatedPathProxy(!0))}var o=new _e(t);return o.createPathProxy(),o.buildPath=function(s){if(e3(s)){s.appendPath(r);var l=s.getContext();l&&s.rebuildPath(l,1)}},o}function hw(e,t){t=t||{};var r=new _e;return e.shape&&r.setShape(e.shape),r.setStyle(e.style),t.bakeTransform?QO(r.path,e.getComputedTransform()):t.toLocal?r.setLocalTransform(e.getComputedTransform()):r.copyTransform(e),r.buildPath=e.buildPath,r.applyTransform=r.applyTransform,r.z=e.z,r.z2=e.z2,r.zlevel=e.zlevel,r}var kH=function(){function e(){this.cx=0,this.cy=0,this.r=0}return e}(),Vo=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new kH},t.prototype.buildPath=function(r,n){r.moveTo(n.cx+n.r,n.cy),r.arc(n.cx,n.cy,n.r,0,Math.PI*2)},t}(_e);Vo.prototype.type="circle";var GH=function(){function e(){this.cx=0,this.cy=0,this.rx=0,this.ry=0}return e}(),N_=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new GH},t.prototype.buildPath=function(r,n){var i=.5522848,a=n.cx,o=n.cy,s=n.rx,l=n.ry,u=s*i,h=l*i;r.moveTo(a-s,o),r.bezierCurveTo(a-s,o-h,a-u,o-l,a,o-l),r.bezierCurveTo(a+u,o-l,a+s,o-h,a+s,o),r.bezierCurveTo(a+s,o+h,a+u,o+l,a,o+l),r.bezierCurveTo(a-u,o+l,a-s,o+h,a-s,o),r.closePath()},t}(_e);N_.prototype.type="ellipse";var i3=Math.PI,iy=i3*2,fl=Math.sin,th=Math.cos,VH=Math.acos,bn=Math.atan2,GE=Math.abs,bd=Math.sqrt,ed=Math.max,Ma=Math.min,ia=1e-4;function HH(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,h=o-i,f=s-a,c=f*l-h*u;if(!(c*c<ia))return c=(h*(t-a)-f*(e-i))/c,[e+c*l,t+c*u]}function hp(e,t,r,n,i,a,o){var s=e-r,l=t-n,u=(o?a:-a)/bd(s*s+l*l),h=u*l,f=-u*s,c=e+h,d=t+f,v=r+h,p=n+f,g=(c+v)/2,m=(d+p)/2,_=v-c,y=p-d,x=_*_+y*y,T=i-a,S=c*p-v*d,M=(y<0?-1:1)*bd(ed(0,T*T*x-S*S)),w=(S*y-_*M)/x,b=(-S*_-y*M)/x,A=(S*y+_*M)/x,E=(-S*_+y*M)/x,C=w-g,D=b-m,L=A-g,P=E-m;return C*C+D*D>L*L+P*P&&(w=A,b=E),{cx:w,cy:b,x0:-h,y0:-f,x1:w*(i/T-1),y1:b*(i/T-1)}}function WH(e){var t;if(at(e)){var r=e.length;if(!r)return e;r===1?t=[e[0],e[0],0,0]:r===2?t=[e[0],e[0],e[1],e[1]]:r===3?t=e.concat(e[2]):t=e}else t=[e,e,e,e];return t}function XH(e,t){var r,n=ed(t.r,0),i=ed(t.r0||0,0),a=n>0,o=i>0;if(!(!a&&!o)){if(a||(n=i,i=0),i>n){var s=n;n=i,i=s}var l=t.startAngle,u=t.endAngle;if(!(isNaN(l)||isNaN(u))){var h=t.cx,f=t.cy,c=!!t.clockwise,d=GE(u-l),v=d>iy&&d%iy;if(v>ia&&(d=v),!(n>ia))e.moveTo(h,f);else if(d>iy-ia)e.moveTo(h+n*th(l),f+n*fl(l)),e.arc(h,f,n,l,u,!c),i>ia&&(e.moveTo(h+i*th(u),f+i*fl(u)),e.arc(h,f,i,u,l,c));else{var p=void 0,g=void 0,m=void 0,_=void 0,y=void 0,x=void 0,T=void 0,S=void 0,M=void 0,w=void 0,b=void 0,A=void 0,E=void 0,C=void 0,D=void 0,L=void 0,P=n*th(l),N=n*fl(l),O=i*th(u),I=i*fl(u),k=d>ia;if(k){var z=t.cornerRadius;z&&(r=WH(z),p=r[0],g=r[1],m=r[2],_=r[3]);var X=GE(n-i)/2;if(y=Ma(X,m),x=Ma(X,_),T=Ma(X,p),S=Ma(X,g),b=M=ed(y,x),A=w=ed(T,S),(M>ia||w>ia)&&(E=n*th(u),C=n*fl(u),D=i*th(l),L=i*fl(l),d<i3)){var Y=HH(P,N,D,L,E,C,O,I);if(Y){var $=P-Y[0],H=N-Y[1],Z=E-Y[0],ct=C-Y[1],ut=1/fl(VH(($*Z+H*ct)/(bd($*$+H*H)*bd(Z*Z+ct*ct)))/2),tt=bd(Y[0]*Y[0]+Y[1]*Y[1]);b=Ma(M,(n-tt)/(ut+1)),A=Ma(w,(i-tt)/(ut-1))}}}if(!k)e.moveTo(h+P,f+N);else if(b>ia){var et=Ma(m,b),st=Ma(_,b),nt=hp(D,L,P,N,n,et,c),dt=hp(E,C,O,I,n,st,c);e.moveTo(h+nt.cx+nt.x0,f+nt.cy+nt.y0),b<M&&et===st?e.arc(h+nt.cx,f+nt.cy,b,bn(nt.y0,nt.x0),bn(dt.y0,dt.x0),!c):(et>0&&e.arc(h+nt.cx,f+nt.cy,et,bn(nt.y0,nt.x0),bn(nt.y1,nt.x1),!c),e.arc(h,f,n,bn(nt.cy+nt.y1,nt.cx+nt.x1),bn(dt.cy+dt.y1,dt.cx+dt.x1),!c),st>0&&e.arc(h+dt.cx,f+dt.cy,st,bn(dt.y1,dt.x1),bn(dt.y0,dt.x0),!c))}else e.moveTo(h+P,f+N),e.arc(h,f,n,l,u,!c);if(!(i>ia)||!k)e.lineTo(h+O,f+I);else if(A>ia){var et=Ma(p,A),st=Ma(g,A),nt=hp(O,I,E,C,i,-st,c),dt=hp(P,N,D,L,i,-et,c);e.lineTo(h+nt.cx+nt.x0,f+nt.cy+nt.y0),A<w&&et===st?e.arc(h+nt.cx,f+nt.cy,A,bn(nt.y0,nt.x0),bn(dt.y0,dt.x0),!c):(st>0&&e.arc(h+nt.cx,f+nt.cy,st,bn(nt.y0,nt.x0),bn(nt.y1,nt.x1),!c),e.arc(h,f,i,bn(nt.cy+nt.y1,nt.cx+nt.x1),bn(dt.cy+dt.y1,dt.cx+dt.x1),c),et>0&&e.arc(h+dt.cx,f+dt.cy,et,bn(dt.y1,dt.x1),bn(dt.y0,dt.x0),!c))}else e.lineTo(h+O,f+I),e.arc(h,f,i,u,l,c)}e.closePath()}}}var YH=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0,this.cornerRadius=0}return e}(),Xn=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new YH},t.prototype.buildPath=function(r,n){XH(r,n)},t.prototype.isZeroArea=function(){return this.shape.startAngle===this.shape.endAngle||this.shape.r===this.shape.r0},t}(_e);Xn.prototype.type="sector";var ZH=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.r0=0}return e}(),Sv=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new ZH},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.PI*2;r.moveTo(i+n.r,a),r.arc(i,a,n.r,0,o,!1),r.moveTo(i+n.r0,a),r.arc(i,a,n.r0,0,o,!0)},t}(_e);Sv.prototype.type="ring";function qH(e,t,r,n){var i=[],a=[],o=[],s=[],l,u,h,f;if(n){h=[1/0,1/0],f=[-1/0,-1/0];for(var c=0,d=e.length;c<d;c++)ms(h,h,e[c]),_s(f,f,e[c]);ms(h,h,n[0]),_s(f,f,n[1])}for(var c=0,d=e.length;c<d;c++){var v=e[c];if(r)l=e[c?c-1:d-1],u=e[(c+1)%d];else if(c===0||c===d-1){i.push(bo(e[c]));continue}else l=e[c-1],u=e[c+1];$l(a,u,l),Fg(a,a,t);var p=tS(v,l),g=tS(v,u),m=p+g;m!==0&&(p/=m,g/=m),Fg(o,a,-p),Fg(s,a,g);var _=UA([],v,o),y=UA([],v,s);n&&(_s(_,_,h),ms(_,_,f),_s(y,y,h),ms(y,y,f)),i.push(_),i.push(y)}return r&&i.push(i.shift()),i}function a3(e,t,r){var n=t.smooth,i=t.points;if(i&&i.length>=2){if(n){var a=qH(i,n,r,t.smoothConstraint);e.moveTo(i[0][0],i[0][1]);for(var o=i.length,s=0;s<(r?o:o-1);s++){var l=a[s*2],u=a[s*2+1],h=i[(s+1)%o];e.bezierCurveTo(l[0],l[1],u[0],u[1],h[0],h[1])}}else{e.moveTo(i[0][0],i[0][1]);for(var s=1,f=i.length;s<f;s++)e.lineTo(i[s][0],i[s][1])}r&&e.closePath()}}var $H=function(){function e(){this.points=null,this.smooth=0,this.smoothConstraint=null}return e}(),Yn=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new $H},t.prototype.buildPath=function(r,n){a3(r,n,!0)},t}(_e);Yn.prototype.type="polygon";var KH=function(){function e(){this.points=null,this.percent=1,this.smooth=0,this.smoothConstraint=null}return e}(),$n=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new KH},t.prototype.buildPath=function(r,n){a3(r,n,!1)},t}(_e);$n.prototype.type="polyline";var jH={},JH=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return e}(),jr=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new JH},t.prototype.buildPath=function(r,n){var i,a,o,s;if(this.subPixelOptimize){var l=kO(jH,n,this.style);i=l.x1,a=l.y1,o=l.x2,s=l.y2}else i=n.x1,a=n.y1,o=n.x2,s=n.y2;var u=n.percent;u!==0&&(r.moveTo(i,a),u<1&&(o=i*(1-u)+o*u,s=a*(1-u)+s*u),r.lineTo(o,s))},t.prototype.pointAt=function(r){var n=this.shape;return[n.x1*(1-r)+n.x2*r,n.y1*(1-r)+n.y2*r]},t}(_e);jr.prototype.type="line";var Jn=[],QH=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.percent=1}return e}();function VE(e,t,r){var n=e.cpx2,i=e.cpy2;return n!=null||i!=null?[(r?KA:$r)(e.x1,e.cpx1,e.cpx2,e.x2,t),(r?KA:$r)(e.y1,e.cpy1,e.cpy2,e.y2,t)]:[(r?aS:dn)(e.x1,e.cpx1,e.x2,t),(r?aS:dn)(e.y1,e.cpy1,e.y2,t)]}var Tv=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new QH},t.prototype.buildPath=function(r,n){var i=n.x1,a=n.y1,o=n.x2,s=n.y2,l=n.cpx1,u=n.cpy1,h=n.cpx2,f=n.cpy2,c=n.percent;c!==0&&(r.moveTo(i,a),h==null||f==null?(c<1&&(Nd(i,l,o,c,Jn),l=Jn[1],o=Jn[2],Nd(a,u,s,c,Jn),u=Jn[1],s=Jn[2]),r.quadraticCurveTo(l,u,o,s)):(c<1&&(Os(i,l,h,o,c,Jn),l=Jn[1],h=Jn[2],o=Jn[3],Os(a,u,f,s,c,Jn),u=Jn[1],f=Jn[2],s=Jn[3]),r.bezierCurveTo(l,u,h,f,o,s)))},t.prototype.pointAt=function(r){return VE(this.shape,r,!1)},t.prototype.tangentAt=function(r){var n=VE(this.shape,r,!0);return Ff(n,n)},t}(_e);Tv.prototype.type="bezier-curve";var tW=function(){function e(){this.cx=0,this.cy=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),O_=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new tW},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r,0),s=n.startAngle,l=n.endAngle,u=n.clockwise,h=Math.cos(s),f=Math.sin(s);r.moveTo(h*o+i,f*o+a),r.arc(i,a,o,s,l,!u)},t}(_e);O_.prototype.type="arc";var fw=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="compound",r}return t.prototype._updatePathDirty=function(){for(var r=this.shape.paths,n=this.shapeChanged(),i=0;i<r.length;i++)n=n||r[i].shapeChanged();n&&this.dirtyShape()},t.prototype.beforeBrush=function(){this._updatePathDirty();for(var r=this.shape.paths||[],n=this.getGlobalScale(),i=0;i<r.length;i++)r[i].path||r[i].createPathProxy(),r[i].path.setScale(n[0],n[1],r[i].segmentIgnoreThreshold)},t.prototype.buildPath=function(r,n){for(var i=n.paths||[],a=0;a<i.length;a++)i[a].buildPath(r,i[a].shape,!0)},t.prototype.afterBrush=function(){for(var r=this.shape.paths||[],n=0;n<r.length;n++)r[n].pathUpdated()},t.prototype.getBoundingRect=function(){return this._updatePathDirty.call(this),_e.prototype.getBoundingRect.call(this)},t}(_e),o3=function(){function e(t){this.colorStops=t||[]}return e.prototype.addColorStop=function(t,r){this.colorStops.push({offset:t,color:r})},e}(),bv=function(e){q(t,e);function t(r,n,i,a,o,s){var l=e.call(this,o)||this;return l.x=r??0,l.y=n??0,l.x2=i??1,l.y2=a??0,l.type="linear",l.global=s||!1,l}return t}(o3),s3=function(e){q(t,e);function t(r,n,i,a,o){var s=e.call(this,a)||this;return s.x=r??.5,s.y=n??.5,s.r=i??.5,s.type="radial",s.global=o||!1,s}return t}(o3),cl=[0,0],dl=[0,0],fp=new he,cp=new he,xm=function(){function e(t,r){this._corners=[],this._axes=[],this._origin=[0,0];for(var n=0;n<4;n++)this._corners[n]=new he;for(var n=0;n<2;n++)this._axes[n]=new he;t&&this.fromBoundingRect(t,r)}return e.prototype.fromBoundingRect=function(t,r){var n=this._corners,i=this._axes,a=t.x,o=t.y,s=a+t.width,l=o+t.height;if(n[0].set(a,o),n[1].set(s,o),n[2].set(s,l),n[3].set(a,l),r)for(var u=0;u<4;u++)n[u].transform(r);he.sub(i[0],n[1],n[0]),he.sub(i[1],n[3],n[0]),i[0].normalize(),i[1].normalize();for(var u=0;u<2;u++)this._origin[u]=i[u].dot(n[0])},e.prototype.intersect=function(t,r){var n=!0,i=!r;return fp.set(1/0,1/0),cp.set(0,0),!this._intersectCheckOneSide(this,t,fp,cp,i,1)&&(n=!1,i)||!this._intersectCheckOneSide(t,this,fp,cp,i,-1)&&(n=!1,i)||i||he.copy(r,n?fp:cp),n},e.prototype._intersectCheckOneSide=function(t,r,n,i,a,o){for(var s=!0,l=0;l<2;l++){var u=this._axes[l];if(this._getProjMinMaxOnAxis(l,t._corners,cl),this._getProjMinMaxOnAxis(l,r._corners,dl),cl[1]<dl[0]||cl[0]>dl[1]){if(s=!1,a)return s;var h=Math.abs(dl[0]-cl[1]),f=Math.abs(cl[0]-dl[1]);Math.min(h,f)>i.len()&&(h<f?he.scale(i,u,-h*o):he.scale(i,u,f*o))}else if(n){var h=Math.abs(dl[0]-cl[1]),f=Math.abs(cl[0]-dl[1]);Math.min(h,f)<n.len()&&(h<f?he.scale(n,u,h*o):he.scale(n,u,-f*o))}}return s},e.prototype._getProjMinMaxOnAxis=function(t,r,n){for(var i=this._axes[t],a=this._origin,o=r[0].dot(i)+a[t],s=o,l=o,u=1;u<r.length;u++){var h=r[u].dot(i)+a[t];s=Math.min(h,s),l=Math.max(h,l)}n[0]=s,n[1]=l},e}(),eW=[],rW=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.notClear=!0,r.incremental=!0,r._displayables=[],r._temporaryDisplayables=[],r._cursor=0,r}return t.prototype.traverse=function(r,n){r.call(n,this)},t.prototype.useStyle=function(){this.style={}},t.prototype.getCursor=function(){return this._cursor},t.prototype.innerAfterBrush=function(){this._cursor=this._displayables.length},t.prototype.clearDisplaybles=function(){this._displayables=[],this._temporaryDisplayables=[],this._cursor=0,this.markRedraw(),this.notClear=!1},t.prototype.clearTemporalDisplayables=function(){this._temporaryDisplayables=[]},t.prototype.addDisplayable=function(r,n){n?this._temporaryDisplayables.push(r):this._displayables.push(r),this.markRedraw()},t.prototype.addDisplayables=function(r,n){n=n||!1;for(var i=0;i<r.length;i++)this.addDisplayable(r[i],n)},t.prototype.getDisplayables=function(){return this._displayables},t.prototype.getTemporalDisplayables=function(){return this._temporaryDisplayables},t.prototype.eachPendingDisplayable=function(r){for(var n=this._cursor;n<this._displayables.length;n++)r&&r(this._displayables[n]);for(var n=0;n<this._temporaryDisplayables.length;n++)r&&r(this._temporaryDisplayables[n])},t.prototype.update=function(){this.updateTransform();for(var r=this._cursor;r<this._displayables.length;r++){var n=this._displayables[r];n.parent=this,n.update(),n.parent=null}for(var r=0;r<this._temporaryDisplayables.length;r++){var n=this._temporaryDisplayables[r];n.parent=this,n.update(),n.parent=null}},t.prototype.getBoundingRect=function(){if(!this._rect){for(var r=new fe(1/0,1/0,-1/0,-1/0),n=0;n<this._displayables.length;n++){var i=this._displayables[n],a=i.getBoundingRect().clone();i.needLocalTransform()&&a.applyTransform(i.getLocalTransform(eW)),r.union(a)}this._rect=r}return this._rect},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(a.contain(i[0],i[1]))for(var o=0;o<this._displayables.length;o++){var s=this._displayables[o];if(s.contain(r,n))return!0}return!1},t}(Yi),l3=Le();function kf(e,t,r,n,i){var a;if(t&&t.ecModel){var o=t.ecModel.getUpdatePayload();a=o&&o.animation}var s=t&&t.isAnimationEnabled(),l=e==="update";if(s){var u=void 0,h=void 0,f=void 0;n?(u=se(n.duration,200),h=se(n.easing,"cubicOut"),f=0):(u=t.getShallow(l?"animationDurationUpdate":"animationDuration"),h=t.getShallow(l?"animationEasingUpdate":"animationEasing"),f=t.getShallow(l?"animationDelayUpdate":"animationDelay")),a&&(a.duration!=null&&(u=a.duration),a.easing!=null&&(h=a.easing),a.delay!=null&&(f=a.delay)),Yt(f)&&(f=f(r,i)),Yt(u)&&(u=u(r));var c={duration:u||0,delay:f,easing:h};return c}else return null}function cw(e,t,r,n,i,a,o){var s=!1,l;Yt(i)?(o=a,a=i,i=null):Kt(i)&&(a=i.cb,o=i.during,s=i.isFrom,l=i.removeOpt,i=i.dataIndex);var u=e==="leave";u||t.stopAnimation("leave");var h=kf(e,n,i,u?l||{}:null,n&&n.getAnimationDelayParams?n.getAnimationDelayParams(t,i):null);if(h&&h.duration>0){var f=h.duration,c=h.delay,d=h.easing,v={duration:f,delay:c||0,easing:d,done:a,force:!!a||!!o,setToFinal:!u,scope:e,during:o};s?t.animateFrom(r,v):t.animateTo(r,v)}else t.stopAnimation(),!s&&t.attr(r),o&&o(1),a&&a()}function ke(e,t,r,n,i,a){cw("update",e,t,r,n,i,a)}function vr(e,t,r,n,i,a){cw("enter",e,t,r,n,i,a)}function Jh(e){if(!e.__zr)return!0;for(var t=0;t<e.animators.length;t++){var r=e.animators[t];if(r.scope==="leave")return!0}return!1}function Fs(e,t,r,n,i,a){Jh(e)||cw("leave",e,t,r,n,i,a)}function HE(e,t,r,n){e.removeTextContent(),e.removeTextGuideLine(),Fs(e,{style:{opacity:0}},t,r,n)}function Gd(e,t,r){function n(){e.parent&&e.parent.remove(e)}e.isGroup?e.traverse(function(i){i.isGroup||HE(i,t,r,n)}):HE(e,t,r,n)}function ya(e){l3(e).oldStyle=e.style}function nW(e){return l3(e).oldStyle}var Sm=Math.max,Tm=Math.min,LS={};function iW(e){return _e.extend(e)}var aW=UH;function oW(e,t){return aW(e,t)}function Sa(e,t){LS[e]=t}function dw(e){if(LS.hasOwnProperty(e))return LS[e]}function F_(e,t,r,n){var i=n3(e,t);return r&&(n==="center"&&(r=h3(r,i.getBoundingRect())),f3(i,r)),i}function u3(e,t,r){var n=new hn({style:{image:e,x:t.x,y:t.y,width:t.width,height:t.height},onload:function(i){if(r==="center"){var a={width:i.width,height:i.height};n.setStyle(h3(t,a))}}});return n}function h3(e,t){var r=t.width/t.height,n=e.height*r,i;n<=e.width?i=e.height:(n=e.width,i=n/r);var a=e.x+e.width/2,o=e.y+e.height/2;return{x:a-n/2,y:o-i/2,width:n,height:i}}var Ui=zH;function f3(e,t){if(e.applyTransform){var r=e.getBoundingRect(),n=r.calculateTransform(t);e.applyTransform(n)}}function ff(e,t){return kO(e,e,{lineWidth:t}),e}function sW(e){return GO(e.shape,e.shape,e.style),e}var Yg=Kl;function du(e,t){for(var r=b_([]);e&&e!==t;)wo(r,e.getLocalTransform(),r),e=e.parent;return r}function va(e,t,r){return t&&!Dn(t)&&(t=yo.getLocalTransform(t)),r&&(t=Bu([],t)),en([],e,t)}function B_(e,t,r){var n=t[4]===0||t[5]===0||t[0]===0?1:Math.abs(2*t[4]/t[0]),i=t[4]===0||t[5]===0||t[2]===0?1:Math.abs(2*t[4]/t[2]),a=[e==="left"?-n:e==="right"?n:0,e==="top"?-i:e==="bottom"?i:0];return a=va(a,t,r),Math.abs(a[0])>Math.abs(a[1])?a[0]>0?"right":"left":a[1]>0?"bottom":"top"}function WE(e){return!e.isGroup}function lW(e){return e.shape!=null}function wv(e,t,r){if(!e||!t)return;function n(o){var s={};return o.traverse(function(l){WE(l)&&l.anid&&(s[l.anid]=l)}),s}function i(o){var s={x:o.x,y:o.y,rotation:o.rotation};return lW(o)&&(s.shape=rt({},o.shape)),s}var a=n(e);t.traverse(function(o){if(WE(o)&&o.anid){var s=a[o.anid];if(s){var l=i(o);o.attr(i(s)),ke(o,l,r,oe(o).dataIndex)}}})}function c3(e,t){return ft(e,function(r){var n=r[0];n=Sm(n,t.x),n=Tm(n,t.x+t.width);var i=r[1];return i=Sm(i,t.y),i=Tm(i,t.y+t.height),[n,i]})}function uW(e,t){var r=Sm(e.x,t.x),n=Tm(e.x+e.width,t.x+t.width),i=Sm(e.y,t.y),a=Tm(e.y+e.height,t.y+t.height);if(n>=r&&a>=i)return{x:r,y:i,width:n-r,height:a-i}}function Mv(e,t,r){var n=rt({rectHover:!0},t),i=n.style={strokeNoScale:!0};if(r=r||{x:-1,y:-1,width:2,height:2},e)return e.indexOf("image://")===0?(i.image=e.slice(8),Vt(i,r),new hn(n)):F_(e.replace("path://",""),n,r,"center")}function rd(e,t,r,n,i){for(var a=0,o=i[i.length-1];a<i.length;a++){var s=i[a];if(d3(e,t,r,n,s[0],s[1],o[0],o[1]))return!0;o=s}}function d3(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,h=o-i,f=s-a,c=ay(h,f,l,u);if(hW(c))return!1;var d=e-i,v=t-a,p=ay(d,v,l,u)/c;if(p<0||p>1)return!1;var g=ay(d,v,h,f)/c;return!(g<0||g>1)}function ay(e,t,r,n){return e*n-r*t}function hW(e){return e<=1e-6&&e>=-1e-6}function Uu(e){var t=e.itemTooltipOption,r=e.componentModel,n=e.itemName,i=Ct(t)?{formatter:t}:t,a=r.mainType,o=r.componentIndex,s={componentType:a,name:n,$vars:["name"]};s[a+"Index"]=o;var l=e.formatterParamsExtra;l&&R(be(l),function(h){Ft(s,h)||(s[h]=l[h],s.$vars.push(h))});var u=oe(e.el);u.componentMainType=a,u.componentIndex=o,u.tooltipConfig={name:n,option:Vt({content:n,encodeHTMLContent:!0,formatterParams:s},i)}}function XE(e,t){var r;e.isGroup&&(r=t(e)),r||e.traverse(t)}function Hs(e,t){if(e)if(at(e))for(var r=0;r<e.length;r++)XE(e[r],t);else XE(e,t)}Sa("circle",Vo);Sa("ellipse",N_);Sa("sector",Xn);Sa("ring",Sv);Sa("polygon",Yn);Sa("polyline",$n);Sa("rect",Ae);Sa("line",jr);Sa("bezierCurve",Tv);Sa("arc",O_);const zu=Object.freeze(Object.defineProperty({__proto__:null,Arc:O_,BezierCurve:Tv,BoundingRect:fe,Circle:Vo,CompoundPath:fw,Ellipse:N_,Group:re,Image:hn,IncrementalDisplayable:rW,Line:jr,LinearGradient:bv,OrientedBoundingRect:xm,Path:_e,Point:he,Polygon:Yn,Polyline:$n,RadialGradient:s3,Rect:Ae,Ring:Sv,Sector:Xn,Text:we,applyTransform:va,clipPointsByRect:c3,clipRectByRect:uW,createIcon:Mv,extendPath:oW,extendShape:iW,getShapeClass:dw,getTransform:du,groupTransition:wv,initProps:vr,isElementRemoved:Jh,lineLineIntersect:d3,linePolygonIntersect:rd,makeImage:u3,makePath:F_,mergePath:Ui,registerShape:Sa,removeElement:Fs,removeElementWithFadeOut:Gd,resizePath:f3,setTooltipConfig:Uu,subPixelOptimize:Yg,subPixelOptimizeLine:ff,subPixelOptimizeRect:sW,transformDirection:B_,traverseElements:Hs,updateProps:ke},Symbol.toStringTag,{value:"Module"}));var U_={};function v3(e,t){for(var r=0;r<Wn.length;r++){var n=Wn[r],i=t[n],a=e.ensureState(n);a.style=a.style||{},a.style.text=i}var o=e.currentStates.slice();e.clearStates(!0),e.setStyle({text:t.normal}),e.useStates(o,!0)}function RS(e,t,r){var n=e.labelFetcher,i=e.labelDataIndex,a=e.labelDimIndex,o=t.normal,s;n&&(s=n.getFormattedLabel(i,"normal",null,a,o&&o.get("formatter"),r!=null?{interpolatedValue:r}:null)),s==null&&(s=Yt(e.defaultText)?e.defaultText(i,e,r):e.defaultText);for(var l={normal:s},u=0;u<Wn.length;u++){var h=Wn[u],f=t[h];l[h]=se(n?n.getFormattedLabel(i,h,null,a,f&&f.get("formatter")):null,s)}return l}function Sn(e,t,r,n){r=r||U_;for(var i=e instanceof we,a=!1,o=0;o<zd.length;o++){var s=t[zd[o]];if(s&&s.getShallow("show")){a=!0;break}}var l=i?e:e.getTextContent();if(a){i||(l||(l=new we,e.setTextContent(l)),e.stateProxy&&(l.stateProxy=e.stateProxy));var u=RS(r,t),h=t.normal,f=!!h.getShallow("show"),c=je(h,n&&n.normal,r,!1,!i);c.text=u.normal,i||e.setTextConfig(bm(h,r,!1));for(var o=0;o<Wn.length;o++){var d=Wn[o],s=t[d];if(s){var v=l.ensureState(d),p=!!se(s.getShallow("show"),f);if(p!==f&&(v.ignore=!p),v.style=je(s,n&&n[d],r,!0,!i),v.style.text=u[d],!i){var g=e.ensureState(d);g.textConfig=bm(s,r,!0)}}}l.silent=!!h.getShallow("silent"),l.style.x!=null&&(c.x=l.style.x),l.style.y!=null&&(c.y=l.style.y),l.ignore=!f,l.useStyle(c),l.dirty(),r.enableTextSetter&&(Gf(l).setLabelText=function(m){var _=RS(r,t,m);v3(l,_)})}else l&&(l.ignore=!0);e.dirty()}function an(e,t){t=t||"label";for(var r={normal:e.getModel(t)},n=0;n<Wn.length;n++){var i=Wn[n];r[i]=e.getModel([i,t])}return r}function je(e,t,r,n,i){var a={};return fW(a,e,r,n,i),t&&rt(a,t),a}function bm(e,t,r){t=t||{};var n={},i,a=e.getShallow("rotate"),o=se(e.getShallow("distance"),r?null:5),s=e.getShallow("offset");return i=e.getShallow("position")||(r?null:"inside"),i==="outside"&&(i=t.defaultOutsidePosition||"top"),i!=null&&(n.position=i),s!=null&&(n.offset=s),a!=null&&(a*=Math.PI/180,n.rotation=a),o!=null&&(n.distance=o),n.outsideFill=e.get("color")==="inherit"?t.inheritColor||null:"auto",n}function fW(e,t,r,n,i){r=r||U_;var a=t.ecModel,o=a&&a.option.textStyle,s=cW(t),l;if(s){l={};for(var u in s)if(s.hasOwnProperty(u)){var h=t.getModel(["rich",u]);$E(l[u]={},h,o,r,n,i,!1,!0)}}l&&(e.rich=l);var f=t.get("overflow");f&&(e.overflow=f);var c=t.get("minMargin");c!=null&&(e.margin=c),$E(e,t,o,r,n,i,!0,!1)}function cW(e){for(var t;e&&e!==e.ecModel;){var r=(e.option||U_).rich;if(r){t=t||{};for(var n=be(r),i=0;i<n.length;i++){var a=n[i];t[a]=1}}e=e.parentModel}return t}var YE=["fontStyle","fontWeight","fontSize","fontFamily","textShadowColor","textShadowBlur","textShadowOffsetX","textShadowOffsetY"],ZE=["align","lineHeight","width","height","tag","verticalAlign","ellipsis"],qE=["padding","borderWidth","borderRadius","borderDashOffset","backgroundColor","borderColor","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"];function $E(e,t,r,n,i,a,o,s){r=!i&&r||U_;var l=n&&n.inheritColor,u=t.getShallow("color"),h=t.getShallow("textBorderColor"),f=se(t.getShallow("opacity"),r.opacity);(u==="inherit"||u==="auto")&&(l?u=l:u=null),(h==="inherit"||h==="auto")&&(l?h=l:h=null),a||(u=u||r.color,h=h||r.textBorderColor),u!=null&&(e.fill=u),h!=null&&(e.stroke=h);var c=se(t.getShallow("textBorderWidth"),r.textBorderWidth);c!=null&&(e.lineWidth=c);var d=se(t.getShallow("textBorderType"),r.textBorderType);d!=null&&(e.lineDash=d);var v=se(t.getShallow("textBorderDashOffset"),r.textBorderDashOffset);v!=null&&(e.lineDashOffset=v),!i&&f==null&&!s&&(f=n&&n.defaultOpacity),f!=null&&(e.opacity=f),!i&&!a&&e.fill==null&&n.inheritColor&&(e.fill=n.inheritColor);for(var p=0;p<YE.length;p++){var g=YE[p],m=se(t.getShallow(g),r[g]);m!=null&&(e[g]=m)}for(var p=0;p<ZE.length;p++){var g=ZE[p],m=t.getShallow(g);m!=null&&(e[g]=m)}if(e.verticalAlign==null){var _=t.getShallow("baseline");_!=null&&(e.verticalAlign=_)}if(!o||!n.disableBox){for(var p=0;p<qE.length;p++){var g=qE[p],m=t.getShallow(g);m!=null&&(e[g]=m)}var y=t.getShallow("borderType");y!=null&&(e.borderDash=y),(e.backgroundColor==="auto"||e.backgroundColor==="inherit")&&l&&(e.backgroundColor=l),(e.borderColor==="auto"||e.borderColor==="inherit")&&l&&(e.borderColor=l)}}function vw(e,t){var r=t&&t.getModel("textStyle");return ha([e.fontStyle||r&&r.getShallow("fontStyle")||"",e.fontWeight||r&&r.getShallow("fontWeight")||"",(e.fontSize||r&&r.getShallow("fontSize")||12)+"px",e.fontFamily||r&&r.getShallow("fontFamily")||"sans-serif"].join(" "))}var Gf=Le();function p3(e,t,r,n){if(e){var i=Gf(e);i.prevValue=i.value,i.value=r;var a=t.normal;i.valueAnimation=a.get("valueAnimation"),i.valueAnimation&&(i.precision=a.get("precision"),i.defaultInterpolatedText=n,i.statesModels=t)}}function g3(e,t,r,n,i){var a=Gf(e);if(!a.valueAnimation||a.prevValue===a.value)return;var o=a.defaultInterpolatedText,s=se(a.interpolatedValue,a.prevValue),l=a.value;function u(h){var f=PO(r,a.precision,s,l,h);a.interpolatedValue=h===1?null:f;var c=RS({labelDataIndex:t,labelFetcher:i,defaultText:o?o(f):f+""},a.statesModels,f);v3(e,c)}e.percent=0,(a.prevValue==null?vr:ke)(e,{percent:1},n,t,null,u)}var dW=["textStyle","color"],oy=["fontStyle","fontWeight","fontSize","fontFamily","padding","lineHeight","rich","width","height","overflow"],sy=new we,vW=function(){function e(){}return e.prototype.getTextColor=function(t){var r=this.ecModel;return this.getShallow("color")||(!t&&r?r.get(dW):null)},e.prototype.getFont=function(){return vw({fontStyle:this.getShallow("fontStyle"),fontWeight:this.getShallow("fontWeight"),fontSize:this.getShallow("fontSize"),fontFamily:this.getShallow("fontFamily")},this.ecModel)},e.prototype.getTextRect=function(t){for(var r={text:t,verticalAlign:this.getShallow("verticalAlign")||this.getShallow("baseline")},n=0;n<oy.length;n++)r[oy[n]]=this.getShallow(oy[n]);return sy.useStyle(r),sy.update(),sy.getBoundingRect()},e}(),m3=[["lineWidth","width"],["stroke","color"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","type"],["lineDashOffset","dashOffset"],["lineCap","cap"],["lineJoin","join"],["miterLimit"]],pW=bu(m3),gW=function(){function e(){}return e.prototype.getLineStyle=function(t){return pW(this,t)},e}(),_3=[["fill","color"],["stroke","borderColor"],["lineWidth","borderWidth"],["opacity"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"],["lineDash","borderType"],["lineDashOffset","borderDashOffset"],["lineCap","borderCap"],["lineJoin","borderJoin"],["miterLimit","borderMiterLimit"]],mW=bu(_3),_W=function(){function e(){}return e.prototype.getItemStyle=function(t,r){return mW(this,t,r)},e}(),Ie=function(){function e(t,r,n){this.parentModel=r,this.ecModel=n,this.option=t}return e.prototype.init=function(t,r,n){},e.prototype.mergeOption=function(t,r){Ot(this.option,t,!0)},e.prototype.get=function(t,r){return t==null?this.option:this._doGet(this.parsePath(t),!r&&this.parentModel)},e.prototype.getShallow=function(t,r){var n=this.option,i=n==null?n:n[t];if(i==null&&!r){var a=this.parentModel;a&&(i=a.getShallow(t))}return i},e.prototype.getModel=function(t,r){var n=t!=null,i=n?this.parsePath(t):null,a=n?this._doGet(i):this.option;return r=r||this.parentModel&&this.parentModel.getModel(this.resolveParentPath(i)),new e(a,r,this.ecModel)},e.prototype.isEmpty=function(){return this.option==null},e.prototype.restoreData=function(){},e.prototype.clone=function(){var t=this.constructor;return new t(Qt(this.option))},e.prototype.parsePath=function(t){return typeof t=="string"?t.split("."):t},e.prototype.resolveParentPath=function(t){return t},e.prototype.isAnimationEnabled=function(){if(!ye.node&&this.option){if(this.option.animation!=null)return!!this.option.animation;if(this.parentModel)return this.parentModel.isAnimationEnabled()}},e.prototype._doGet=function(t,r){var n=this.option;if(!t)return n;for(var i=0;i<t.length&&!(t[i]&&(n=n&&typeof n=="object"?n[t[i]]:null,n==null));i++);return n==null&&r&&(n=r._doGet(this.resolveParentPath(t),r.parentModel)),n},e}();rw(Ie);E5(Ie);Nr(Ie,gW);Nr(Ie,_W);Nr(Ie,P5);Nr(Ie,vW);var yW=Math.round(Math.random()*10);function Vf(e){return[e||"",yW++].join("_")}function xW(e){var t={};e.registerSubTypeDefaulter=function(r,n){var i=Fa(r);t[i.main]=n},e.determineSubType=function(r,n){var i=n.type;if(!i){var a=Fa(r).main;e.hasSubTypes(r)&&t[a]&&(i=t[a](n))}return i}}function SW(e,t){e.topologicalTravel=function(a,o,s,l){if(!a.length)return;var u=r(o),h=u.graph,f=u.noEntryList,c={};for(R(a,function(_){c[_]=!0});f.length;){var d=f.pop(),v=h[d],p=!!c[d];p&&(s.call(l,d,v.originalDeps.slice()),delete c[d]),R(v.successor,p?m:g)}R(c,function(){var _="";throw new Error(_)});function g(_){h[_].entryCount--,h[_].entryCount===0&&f.push(_)}function m(_){c[_]=!0,g(_)}};function r(a){var o={},s=[];return R(a,function(l){var u=n(o,l),h=u.originalDeps=t(l),f=i(h,a);u.entryCount=f.length,u.entryCount===0&&s.push(l),R(f,function(c){pe(u.predecessor,c)<0&&u.predecessor.push(c);var d=n(o,c);pe(d.successor,c)<0&&d.successor.push(l)})}),{graph:o,noEntryList:s}}function n(a,o){return a[o]||(a[o]={predecessor:[],successor:[]}),a[o]}function i(a,o){var s=[];return R(a,function(l){pe(o,l)>=0&&s.push(l)}),s}}function Ws(e,t){return Ot(Ot({},e,!0),t,!0)}const TW={time:{month:["January","February","March","April","May","June","July","August","September","October","November","December"],monthAbbr:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],dayOfWeek:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],dayOfWeekAbbr:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},legend:{selector:{all:"All",inverse:"Inv"}},toolbox:{brush:{title:{rect:"Box Select",polygon:"Lasso Select",lineX:"Horizontally Select",lineY:"Vertically Select",keep:"Keep Selections",clear:"Clear Selections"}},dataView:{title:"Data View",lang:["Data View","Close","Refresh"]},dataZoom:{title:{zoom:"Zoom",back:"Zoom Reset"}},magicType:{title:{line:"Switch to Line Chart",bar:"Switch to Bar Chart",stack:"Stack",tiled:"Tile"}},restore:{title:"Restore"},saveAsImage:{title:"Save as Image",lang:["Right Click to Save Image"]}},series:{typeNames:{pie:"Pie chart",bar:"Bar chart",line:"Line chart",scatter:"Scatter plot",effectScatter:"Ripple scatter plot",radar:"Radar chart",tree:"Tree",treemap:"Treemap",boxplot:"Boxplot",candlestick:"Candlestick",k:"K line chart",heatmap:"Heat map",map:"Map",parallel:"Parallel coordinate map",lines:"Line graph",graph:"Relationship graph",sankey:"Sankey diagram",funnel:"Funnel chart",gauge:"Gauge",pictorialBar:"Pictorial bar",themeRiver:"Theme River Map",sunburst:"Sunburst",custom:"Custom chart",chart:"Chart"}},aria:{general:{withTitle:'This is a chart about "{title}"',withoutTitle:"This is a chart"},series:{single:{prefix:"",withName:" with type {seriesType} named {seriesName}.",withoutName:" with type {seriesType}."},multiple:{prefix:". It consists of {seriesCount} series count.",withName:" The {seriesId} series is a {seriesType} representing {seriesName}.",withoutName:" The {seriesId} series is a {seriesType}.",separator:{middle:"",end:""}}},data:{allData:"The data is as follows: ",partialData:"The first {displayCnt} items are: ",withName:"the data for {name} is {value}",withoutName:"{value}",separator:{middle:", ",end:". "}}}},bW={time:{month:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],monthAbbr:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],dayOfWeekAbbr:["日","一","二","三","四","五","六"]},legend:{selector:{all:"全选",inverse:"反选"}},toolbox:{brush:{title:{rect:"矩形选择",polygon:"圈选",lineX:"横向选择",lineY:"纵向选择",keep:"保持选择",clear:"清除选择"}},dataView:{title:"数据视图",lang:["数据视图","关闭","刷新"]},dataZoom:{title:{zoom:"区域缩放",back:"区域缩放还原"}},magicType:{title:{line:"切换为折线图",bar:"切换为柱状图",stack:"切换为堆叠",tiled:"切换为平铺"}},restore:{title:"还原"},saveAsImage:{title:"保存为图片",lang:["右键另存为图片"]}},series:{typeNames:{pie:"饼图",bar:"柱状图",line:"折线图",scatter:"散点图",effectScatter:"涟漪散点图",radar:"雷达图",tree:"树图",treemap:"矩形树图",boxplot:"箱型图",candlestick:"K线图",k:"K线图",heatmap:"热力图",map:"地图",parallel:"平行坐标图",lines:"线图",graph:"关系图",sankey:"桑基图",funnel:"漏斗图",gauge:"仪表盘图",pictorialBar:"象形柱图",themeRiver:"主题河流图",sunburst:"旭日图",custom:"自定义图表",chart:"图表"}},aria:{general:{withTitle:"这是一个关于“{title}”的图表。",withoutTitle:"这是一个图表，"},series:{single:{prefix:"",withName:"图表类型是{seriesType}，表示{seriesName}。",withoutName:"图表类型是{seriesType}。"},multiple:{prefix:"它由{seriesCount}个图表系列组成。",withName:"第{seriesId}个系列是一个表示{seriesName}的{seriesType}，",withoutName:"第{seriesId}个系列是一个{seriesType}，",separator:{middle:"；",end:"。"}}},data:{allData:"其数据是——",partialData:"其中，前{displayCnt}项是——",withName:"{name}的数据是{value}",withoutName:"{value}",separator:{middle:"，",end:""}}}};var wm="ZH",pw="EN",Qh=pw,Zg={},gw={},y3=ye.domSupported?function(){var e=(document.documentElement.lang||navigator.language||navigator.browserLanguage||Qh).toUpperCase();return e.indexOf(wm)>-1?wm:Qh}():Qh;function x3(e,t){e=e.toUpperCase(),gw[e]=new Ie(t),Zg[e]=t}function wW(e){if(Ct(e)){var t=Zg[e.toUpperCase()]||{};return e===wm||e===pw?Qt(t):Ot(Qt(t),Qt(Zg[Qh]),!1)}else return Ot(Qt(e),Qt(Zg[Qh]),!1)}function PS(e){return gw[e]}function MW(){return gw[Qh]}x3(pw,TW);x3(wm,bW);var mw=1e3,_w=mw*60,wd=_w*60,zi=wd*24,KE=zi*365,nd={year:"{yyyy}",month:"{MMM}",day:"{d}",hour:"{HH}:{mm}",minute:"{HH}:{mm}",second:"{HH}:{mm}:{ss}",millisecond:"{HH}:{mm}:{ss} {SSS}",none:"{yyyy}-{MM}-{dd} {HH}:{mm}:{ss} {SSS}"},dp="{yyyy}-{MM}-{dd}",jE={year:"{yyyy}",month:"{yyyy}-{MM}",day:dp,hour:dp+" "+nd.hour,minute:dp+" "+nd.minute,second:dp+" "+nd.second,millisecond:nd.none},ly=["year","month","day","hour","minute","second","millisecond"],S3=["year","half-year","quarter","month","week","half-week","day","half-day","quarter-day","hour","minute","second","millisecond"];function Bn(e,t){return e+="","0000".substr(0,t-e.length)+e}function tf(e){switch(e){case"half-year":case"quarter":return"month";case"week":case"half-week":return"day";case"half-day":case"quarter-day":return"hour";default:return e}}function AW(e){return e===tf(e)}function EW(e){switch(e){case"year":case"month":return"day";case"millisecond":return"millisecond";default:return"second"}}function z_(e,t,r,n){var i=Xi(e),a=i[yw(r)](),o=i[ef(r)]()+1,s=Math.floor((o-1)/3)+1,l=i[k_(r)](),u=i["get"+(r?"UTC":"")+"Day"](),h=i[Vd(r)](),f=(h-1)%12+1,c=i[G_(r)](),d=i[V_(r)](),v=i[H_(r)](),p=h>=12?"pm":"am",g=p.toUpperCase(),m=n instanceof Ie?n:PS(n||y3)||MW(),_=m.getModel("time"),y=_.get("month"),x=_.get("monthAbbr"),T=_.get("dayOfWeek"),S=_.get("dayOfWeekAbbr");return(t||"").replace(/{a}/g,p+"").replace(/{A}/g,g+"").replace(/{yyyy}/g,a+"").replace(/{yy}/g,Bn(a%100+"",2)).replace(/{Q}/g,s+"").replace(/{MMMM}/g,y[o-1]).replace(/{MMM}/g,x[o-1]).replace(/{MM}/g,Bn(o,2)).replace(/{M}/g,o+"").replace(/{dd}/g,Bn(l,2)).replace(/{d}/g,l+"").replace(/{eeee}/g,T[u]).replace(/{ee}/g,S[u]).replace(/{e}/g,u+"").replace(/{HH}/g,Bn(h,2)).replace(/{H}/g,h+"").replace(/{hh}/g,Bn(f+"",2)).replace(/{h}/g,f+"").replace(/{mm}/g,Bn(c,2)).replace(/{m}/g,c+"").replace(/{ss}/g,Bn(d,2)).replace(/{s}/g,d+"").replace(/{SSS}/g,Bn(v,3)).replace(/{S}/g,v+"")}function CW(e,t,r,n,i){var a=null;if(Ct(r))a=r;else if(Yt(r))a=r(e.value,t,{level:e.level});else{var o=rt({},nd);if(e.level>0)for(var s=0;s<ly.length;++s)o[ly[s]]="{primary|"+o[ly[s]]+"}";var l=r?r.inherit===!1?r:Vt(r,o):o,u=T3(e.value,i);if(l[u])a=l[u];else if(l.inherit){for(var h=S3.indexOf(u),s=h-1;s>=0;--s)if(l[u]){a=l[u];break}a=a||o.none}if(at(a)){var f=e.level==null?0:e.level>=0?e.level:a.length+e.level;f=Math.min(f,a.length-1),a=a[f]}}return z_(new Date(e.value),a,i,n)}function T3(e,t){var r=Xi(e),n=r[ef(t)]()+1,i=r[k_(t)](),a=r[Vd(t)](),o=r[G_(t)](),s=r[V_(t)](),l=r[H_(t)](),u=l===0,h=u&&s===0,f=h&&o===0,c=f&&a===0,d=c&&i===1,v=d&&n===1;return v?"year":d?"month":c?"day":f?"hour":h?"minute":u?"second":"millisecond"}function JE(e,t,r){var n=Be(e)?Xi(e):e;switch(t=t||T3(e,r),t){case"year":return n[yw(r)]();case"half-year":return n[ef(r)]()>=6?1:0;case"quarter":return Math.floor((n[ef(r)]()+1)/4);case"month":return n[ef(r)]();case"day":return n[k_(r)]();case"half-day":return n[Vd(r)]()/24;case"hour":return n[Vd(r)]();case"minute":return n[G_(r)]();case"second":return n[V_(r)]();case"millisecond":return n[H_(r)]()}}function yw(e){return e?"getUTCFullYear":"getFullYear"}function ef(e){return e?"getUTCMonth":"getMonth"}function k_(e){return e?"getUTCDate":"getDate"}function Vd(e){return e?"getUTCHours":"getHours"}function G_(e){return e?"getUTCMinutes":"getMinutes"}function V_(e){return e?"getUTCSeconds":"getSeconds"}function H_(e){return e?"getUTCMilliseconds":"getMilliseconds"}function DW(e){return e?"setUTCFullYear":"setFullYear"}function b3(e){return e?"setUTCMonth":"setMonth"}function w3(e){return e?"setUTCDate":"setDate"}function M3(e){return e?"setUTCHours":"setHours"}function A3(e){return e?"setUTCMinutes":"setMinutes"}function E3(e){return e?"setUTCSeconds":"setSeconds"}function C3(e){return e?"setUTCMilliseconds":"setMilliseconds"}function Mm(e){if(!wO(e))return Ct(e)?e:"-";var t=(e+"").split(".");return t[0].replace(/(\d{1,3})(?=(?:\d{3})+(?!\d))/g,"$1,")+(t.length>1?"."+t[1]:"")}function D3(e,t){return e=(e||"").toLowerCase().replace(/-(.)/g,function(r,n){return n.toUpperCase()}),t&&e&&(e=e.charAt(0).toUpperCase()+e.slice(1)),e}var Hf=Yb;function IS(e,t,r){var n="{yyyy}-{MM}-{dd} {HH}:{mm}:{ss}";function i(h){return h&&ha(h)?h:"-"}function a(h){return!!(h!=null&&!isNaN(h)&&isFinite(h))}var o=t==="time",s=e instanceof Date;if(o||s){var l=o?Xi(e):e;if(isNaN(+l)){if(s)return"-"}else return z_(l,n,r)}if(t==="ordinal")return j1(e)?i(e):Be(e)&&a(e)?e+"":"-";var u=Ro(e);return a(u)?Mm(u):j1(e)?i(e):typeof e=="boolean"?e+"":"-"}var QE=["a","b","c","d","e","f","g"],uy=function(e,t){return"{"+e+(t??"")+"}"};function xw(e,t,r){at(t)||(t=[t]);var n=t.length;if(!n)return"";for(var i=t[0].$vars||[],a=0;a<i.length;a++){var o=QE[a];e=e.replace(uy(o),uy(o,0))}for(var s=0;s<n;s++)for(var l=0;l<i.length;l++){var u=t[s][i[l]];e=e.replace(uy(QE[l],s),r?Br(u):u)}return e}function LW(e,t,r){return R(t,function(n,i){e=e.replace("{"+i+"}",n)}),e}function L3(e,t){var r=Ct(e)?{color:e,extraCssText:t}:e||{},n=r.color,i=r.type;t=r.extraCssText;var a=r.renderMode||"html";if(!n)return"";if(a==="html")return i==="subItem"?'<span style="display:inline-block;vertical-align:middle;margin-right:8px;margin-left:3px;border-radius:4px;width:4px;height:4px;background-color:'+Br(n)+";"+(t||"")+'"></span>':'<span style="display:inline-block;margin-right:4px;border-radius:10px;width:10px;height:10px;background-color:'+Br(n)+";"+(t||"")+'"></span>';var o=r.markerId||"markerX";return{renderMode:a,content:"{"+o+"|}  ",style:i==="subItem"?{width:4,height:4,borderRadius:2,backgroundColor:n}:{width:10,height:10,borderRadius:5,backgroundColor:n}}}function RW(e,t,r){(e==="week"||e==="month"||e==="quarter"||e==="half-year"||e==="year")&&(e=`MM-dd
yyyy`);var n=Xi(t),i="get",a=n[i+"FullYear"](),o=n[i+"Month"]()+1,s=n[i+"Date"](),l=n[i+"Hours"](),u=n[i+"Minutes"](),h=n[i+"Seconds"](),f=n[i+"Milliseconds"]();return e=e.replace("MM",Bn(o,2)).replace("M",o).replace("yyyy",a).replace("yy",Bn(a%100+"",2)).replace("dd",Bn(s,2)).replace("d",s).replace("hh",Bn(l,2)).replace("h",l).replace("mm",Bn(u,2)).replace("m",u).replace("ss",Bn(h,2)).replace("s",h).replace("SSS",Bn(f,3)),e}function Mu(e,t){return t=t||"transparent",Ct(e)?e:Kt(e)&&e.colorStops&&(e.colorStops[0]||{}).color||t}function Am(e,t){if(t==="_blank"||t==="blank"){var r=window.open();r.opener=null,r.location.href=e}else window.open(e,t)}var qg=R,R3=["left","right","top","bottom","width","height"],Jl=[["width","left","right"],["height","top","bottom"]];function Sw(e,t,r,n,i){var a=0,o=0;n==null&&(n=1/0),i==null&&(i=1/0);var s=0;t.eachChild(function(l,u){var h=l.getBoundingRect(),f=t.childAt(u+1),c=f&&f.getBoundingRect(),d,v;if(e==="horizontal"){var p=h.width+(c?-c.x+h.x:0);d=a+p,d>n||l.newline?(a=0,d=p,o+=s+r,s=h.height):s=Math.max(s,h.height)}else{var g=h.height+(c?-c.y+h.y:0);v=o+g,v>i||l.newline?(a+=s+r,o=0,v=g,s=h.width):s=Math.max(s,h.width)}l.newline||(l.x=a,l.y=o,l.markRedraw(),e==="horizontal"?a=d+r:o=v+r)})}var vu=Sw;ue(Sw,"vertical");ue(Sw,"horizontal");function PW(e,t,r){var n=t.width,i=t.height,a=Tt(e.left,n),o=Tt(e.top,i),s=Tt(e.right,n),l=Tt(e.bottom,i);return(isNaN(a)||isNaN(parseFloat(e.left)))&&(a=0),(isNaN(s)||isNaN(parseFloat(e.right)))&&(s=n),(isNaN(o)||isNaN(parseFloat(e.top)))&&(o=0),(isNaN(l)||isNaN(parseFloat(e.bottom)))&&(l=i),r=Hf(r||0),{width:Math.max(s-a-r[1]-r[3],0),height:Math.max(l-o-r[0]-r[2],0)}}function Mr(e,t,r){r=Hf(r||0);var n=t.width,i=t.height,a=Tt(e.left,n),o=Tt(e.top,i),s=Tt(e.right,n),l=Tt(e.bottom,i),u=Tt(e.width,n),h=Tt(e.height,i),f=r[2]+r[0],c=r[1]+r[3],d=e.aspect;switch(isNaN(u)&&(u=n-s-c-a),isNaN(h)&&(h=i-l-f-o),d!=null&&(isNaN(u)&&isNaN(h)&&(d>n/i?u=n*.8:h=i*.8),isNaN(u)&&(u=d*h),isNaN(h)&&(h=u/d)),isNaN(a)&&(a=n-s-u-c),isNaN(o)&&(o=i-l-h-f),e.left||e.right){case"center":a=n/2-u/2-r[3];break;case"right":a=n-u-c;break}switch(e.top||e.bottom){case"middle":case"center":o=i/2-h/2-r[0];break;case"bottom":o=i-h-f;break}a=a||0,o=o||0,isNaN(u)&&(u=n-c-a-(s||0)),isNaN(h)&&(h=i-f-o-(l||0));var v=new fe(a+r[3],o+r[0],u,h);return v.margin=r,v}function W_(e,t,r,n,i,a){var o=!i||!i.hv||i.hv[0],s=!i||!i.hv||i.hv[1],l=i&&i.boundingMode||"all";if(a=a||e,a.x=e.x,a.y=e.y,!o&&!s)return!1;var u;if(l==="raw")u=e.type==="group"?new fe(0,0,+t.width||0,+t.height||0):e.getBoundingRect();else if(u=e.getBoundingRect(),e.needLocalTransform()){var h=e.getLocalTransform();u=u.clone(),u.applyTransform(h)}var f=Mr(Vt({width:u.width,height:u.height},t),r,n),c=o?f.x-u.x:0,d=s?f.y-u.y:0;return l==="raw"?(a.x=c,a.y=d):(a.x+=c,a.y+=d),a===e&&e.markRedraw(),!0}function IW(e,t){return e[Jl[t][0]]!=null||e[Jl[t][1]]!=null&&e[Jl[t][2]]!=null}function Hd(e){var t=e.layoutMode||e.constructor.layoutMode;return Kt(t)?t:t?{type:t}:null}function Bs(e,t,r){var n=r&&r.ignoreSize;!at(n)&&(n=[n,n]);var i=o(Jl[0],0),a=o(Jl[1],1);u(Jl[0],e,i),u(Jl[1],e,a);function o(h,f){var c={},d=0,v={},p=0,g=2;if(qg(h,function(y){v[y]=e[y]}),qg(h,function(y){s(t,y)&&(c[y]=v[y]=t[y]),l(c,y)&&d++,l(v,y)&&p++}),n[f])return l(t,h[1])?v[h[2]]=null:l(t,h[2])&&(v[h[1]]=null),v;if(p===g||!d)return v;if(d>=g)return c;for(var m=0;m<h.length;m++){var _=h[m];if(!s(c,_)&&s(e,_)){c[_]=e[_];break}}return c}function s(h,f){return h.hasOwnProperty(f)}function l(h,f){return h[f]!=null&&h[f]!=="auto"}function u(h,f,c){qg(h,function(d){f[d]=c[d]})}}function Wf(e){return P3({},e)}function P3(e,t){return t&&e&&qg(R3,function(r){t.hasOwnProperty(r)&&(e[r]=t[r])}),e}var NW=Le(),me=function(e){q(t,e);function t(r,n,i){var a=e.call(this,r,n,i)||this;return a.uid=Vf("ec_cpt_model"),a}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=Hd(this),a=i?Wf(r):{},o=n.getTheme();Ot(r,o.get(this.mainType)),Ot(r,this.getDefaultOption()),i&&Bs(r,a,i)},t.prototype.mergeOption=function(r,n){Ot(this.option,r,!0);var i=Hd(this);i&&Bs(this.option,r,i)},t.prototype.optionUpdated=function(r,n){},t.prototype.getDefaultOption=function(){var r=this.constructor;if(!w5(r))return r.defaultOption;var n=NW(this);if(!n.defaultOption){for(var i=[],a=r;a;){var o=a.prototype.defaultOption;o&&i.push(o),a=a.superClass}for(var s={},l=i.length-1;l>=0;l--)s=Ot(s,i[l],!0);n.defaultOption=s}return n.defaultOption},t.prototype.getReferringComponents=function(r,n){var i=r+"Index",a=r+"Id";return yv(this.ecModel,r,{index:this.get(i,!0),id:this.get(a,!0)},n)},t.prototype.getBoxLayoutParams=function(){var r=this;return{left:r.get("left"),top:r.get("top"),right:r.get("right"),bottom:r.get("bottom"),width:r.get("width"),height:r.get("height")}},t.prototype.getZLevelKey=function(){return""},t.prototype.setZLevel=function(r){this.option.zlevel=r},t.protoInitialize=function(){var r=t.prototype;r.type="component",r.id="",r.name="",r.mainType="",r.subType="",r.componentIndex=0}(),t}(Ie);NO(me,Ie);C_(me);xW(me);SW(me,OW);function OW(e){var t=[];return R(me.getClassesByMainType(e),function(r){t=t.concat(r.dependencies||r.prototype.dependencies||[])}),t=ft(t,function(r){return Fa(r).main}),e!=="dataset"&&pe(t,"dataset")<=0&&t.unshift("dataset"),t}var I3="";typeof navigator<"u"&&(I3=navigator.platform||"");var eh="rgba(0, 0, 0, 0.2)";const FW={darkMode:"auto",colorBy:"series",color:["#5470c6","#91cc75","#fac858","#ee6666","#73c0de","#3ba272","#fc8452","#9a60b4","#ea7ccc"],gradientColor:["#f6efa6","#d88273","#bf444c"],aria:{decal:{decals:[{color:eh,dashArrayX:[1,0],dashArrayY:[2,5],symbolSize:1,rotation:Math.PI/6},{color:eh,symbol:"circle",dashArrayX:[[8,8],[0,8,8,0]],dashArrayY:[6,0],symbolSize:.8},{color:eh,dashArrayX:[1,0],dashArrayY:[4,3],rotation:-Math.PI/4},{color:eh,dashArrayX:[[6,6],[0,6,6,0]],dashArrayY:[6,0]},{color:eh,dashArrayX:[[1,0],[1,6]],dashArrayY:[1,0,6,0],rotation:Math.PI/4},{color:eh,symbol:"triangle",dashArrayX:[[9,9],[0,9,9,0]],dashArrayY:[7,2],symbolSize:.75}]}},textStyle:{fontFamily:I3.match(/^Win/)?"Microsoft YaHei":"sans-serif",fontSize:12,fontStyle:"normal",fontWeight:"normal"},blendMode:null,stateAnimation:{duration:300,easing:"cubicOut"},animation:"auto",animationDuration:1e3,animationDurationUpdate:500,animationEasing:"cubicInOut",animationEasingUpdate:"cubicInOut",animationThreshold:2e3,progressiveThreshold:3e3,progressive:400,hoverLayerThreshold:3e3,useUTC:!1};var N3=Ut(["tooltip","label","itemName","itemId","itemGroupId","itemChildGroupId","seriesName"]),qi="original",Ln="arrayRows",$i="objectRows",ja="keyedColumns",Cs="typedArray",O3="unknown",Ha="column",Xf="row",yn={Must:1,Might:2,Not:3},F3=Le();function BW(e){F3(e).datasetMap=Ut()}function B3(e,t,r){var n={},i=bw(t);if(!i||!e)return n;var a=[],o=[],s=t.ecModel,l=F3(s).datasetMap,u=i.uid+"_"+r.seriesLayoutBy,h,f;e=e.slice(),R(e,function(p,g){var m=Kt(p)?p:e[g]={name:p};m.type==="ordinal"&&h==null&&(h=g,f=v(m)),n[m.name]=[]});var c=l.get(u)||l.set(u,{categoryWayDim:f,valueWayDim:0});R(e,function(p,g){var m=p.name,_=v(p);if(h==null){var y=c.valueWayDim;d(n[m],y,_),d(o,y,_),c.valueWayDim+=_}else if(h===g)d(n[m],0,_),d(a,0,_);else{var y=c.categoryWayDim;d(n[m],y,_),d(o,y,_),c.categoryWayDim+=_}});function d(p,g,m){for(var _=0;_<m;_++)p.push(g+_)}function v(p){var g=p.dimsDef;return g?g.length:1}return a.length&&(n.itemName=a),o.length&&(n.seriesName=o),n}function Tw(e,t,r){var n={},i=bw(e);if(!i)return n;var a=t.sourceFormat,o=t.dimensionsDefine,s;(a===$i||a===ja)&&R(o,function(h,f){(Kt(h)?h.name:h)==="name"&&(s=f)});var l=function(){for(var h={},f={},c=[],d=0,v=Math.min(5,r);d<v;d++){var p=z3(t.data,a,t.seriesLayoutBy,o,t.startIndex,d);c.push(p);var g=p===yn.Not;if(g&&h.v==null&&d!==s&&(h.v=d),(h.n==null||h.n===h.v||!g&&c[h.n]===yn.Not)&&(h.n=d),m(h)&&c[h.n]!==yn.Not)return h;g||(p===yn.Might&&f.v==null&&d!==s&&(f.v=d),(f.n==null||f.n===f.v)&&(f.n=d))}function m(_){return _.v!=null&&_.n!=null}return m(h)?h:m(f)?f:null}();if(l){n.value=[l.v];var u=s??l.n;n.itemName=[u],n.seriesName=[u]}return n}function bw(e){var t=e.get("data",!0);if(!t)return yv(e.ecModel,"dataset",{index:e.get("datasetIndex",!0),id:e.get("datasetId",!0)},zr).models[0]}function UW(e){return!e.get("transform",!0)&&!e.get("fromTransformResult",!0)?[]:yv(e.ecModel,"dataset",{index:e.get("fromDatasetIndex",!0),id:e.get("fromDatasetId",!0)},zr).models}function U3(e,t){return z3(e.data,e.sourceFormat,e.seriesLayoutBy,e.dimensionsDefine,e.startIndex,t)}function z3(e,t,r,n,i,a){var o,s=5;if(fi(e))return yn.Not;var l,u;if(n){var h=n[a];Kt(h)?(l=h.name,u=h.type):Ct(h)&&(l=h)}if(u!=null)return u==="ordinal"?yn.Must:yn.Not;if(t===Ln){var f=e;if(r===Xf){for(var c=f[a],d=0;d<(c||[]).length&&d<s;d++)if((o=x(c[i+d]))!=null)return o}else for(var d=0;d<f.length&&d<s;d++){var v=f[i+d];if(v&&(o=x(v[a]))!=null)return o}}else if(t===$i){var p=e;if(!l)return yn.Not;for(var d=0;d<p.length&&d<s;d++){var g=p[d];if(g&&(o=x(g[l]))!=null)return o}}else if(t===ja){var m=e;if(!l)return yn.Not;var c=m[l];if(!c||fi(c))return yn.Not;for(var d=0;d<c.length&&d<s;d++)if((o=x(c[d]))!=null)return o}else if(t===qi)for(var _=e,d=0;d<_.length&&d<s;d++){var g=_[d],y=Uf(g);if(!at(y))return yn.Not;if((o=x(y[a]))!=null)return o}function x(T){var S=Ct(T);if(T!=null&&Number.isFinite(Number(T))&&T!=="")return S?yn.Might:yn.Not;if(S&&T!=="-")return yn.Must}return yn.Not}var NS=Ut();function zW(e,t){Hn(NS.get(e)==null&&t),NS.set(e,t)}function kW(e,t,r){var n=NS.get(t);if(!n)return r;var i=n(e);return i?r.concat(i):r}var t2=Le(),GW=Le(),ww=function(){function e(){}return e.prototype.getColorFromPalette=function(t,r,n){var i=er(this.get("color",!0)),a=this.get("colorLayer",!0);return k3(this,t2,i,a,t,r,n)},e.prototype.clearColorPalette=function(){HW(this,t2)},e}();function OS(e,t,r,n){var i=er(e.get(["aria","decal","decals"]));return k3(e,GW,i,null,t,r,n)}function VW(e,t){for(var r=e.length,n=0;n<r;n++)if(e[n].length>t)return e[n];return e[r-1]}function k3(e,t,r,n,i,a,o){a=a||e;var s=t(a),l=s.paletteIdx||0,u=s.paletteNameMap=s.paletteNameMap||{};if(u.hasOwnProperty(i))return u[i];var h=o==null||!n?r:VW(n,o);if(h=h||r,!(!h||!h.length)){var f=h[l];return i&&(u[i]=f),s.paletteIdx=(l+1)%h.length,f}}function HW(e,t){t(e).paletteIdx=0,t(e).paletteNameMap={}}var vp,_c,e2,r2="\0_ec_inner",WW=1,Mw=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r,n,i,a,o,s){a=a||{},this.option=null,this._theme=new Ie(a),this._locale=new Ie(o),this._optionManager=s},t.prototype.setOption=function(r,n,i){var a=a2(n);this._optionManager.setOption(r,i,a),this._resetOption(null,a)},t.prototype.resetOption=function(r,n){return this._resetOption(r,a2(n))},t.prototype._resetOption=function(r,n){var i=!1,a=this._optionManager;if(!r||r==="recreate"){var o=a.mountOption(r==="recreate");!this.option||r==="recreate"?e2(this,o):(this.restoreData(),this._mergeOption(o,n)),i=!0}if((r==="timeline"||r==="media")&&this.restoreData(),!r||r==="recreate"||r==="timeline"){var s=a.getTimelineOption(this);s&&(i=!0,this._mergeOption(s,n))}if(!r||r==="recreate"||r==="media"){var l=a.getMediaOption(this);l.length&&R(l,function(u){i=!0,this._mergeOption(u,n)},this)}return i},t.prototype.mergeOption=function(r){this._mergeOption(r,null)},t.prototype._mergeOption=function(r,n){var i=this.option,a=this._componentsMap,o=this._componentsCount,s=[],l=Ut(),u=n&&n.replaceMergeMainTypeMap;BW(this),R(r,function(f,c){f!=null&&(me.hasClass(c)?c&&(s.push(c),l.set(c,!0)):i[c]=i[c]==null?Qt(f):Ot(i[c],f,!0))}),u&&u.each(function(f,c){me.hasClass(c)&&!l.get(c)&&(s.push(c),l.set(c,!0))}),me.topologicalTravel(s,me.getAllClassMainTypes(),h,this);function h(f){var c=kW(this,f,er(r[f])),d=a.get(f),v=d?u&&u.get(f)?"replaceMerge":"normalMerge":"replaceAll",p=DO(d,c,v);p5(p,f,me),i[f]=null,a.set(f,null),o.set(f,0);var g=[],m=[],_=0,y;R(p,function(x,T){var S=x.existing,M=x.newOption;if(!M)S&&(S.mergeOption({},this),S.optionUpdated({},!1));else{var w=f==="series",b=me.getClass(f,x.keyInfo.subType,!w);if(!b)return;if(f==="tooltip"){if(y)return;y=!0}if(S&&S.constructor===b)S.name=x.keyInfo.name,S.mergeOption(M,this),S.optionUpdated(M,!1);else{var A=rt({componentIndex:T},x.keyInfo);S=new b(M,this,this,A),rt(S,A),x.brandNew&&(S.__requireNewView=!0),S.init(M,this,this),S.optionUpdated(null,!0)}}S?(g.push(S.option),m.push(S),_++):(g.push(void 0),m.push(void 0))},this),i[f]=g,a.set(f,m),o.set(f,_),f==="series"&&vp(this)}this._seriesIndices||vp(this)},t.prototype.getOption=function(){var r=Qt(this.option);return R(r,function(n,i){if(me.hasClass(i)){for(var a=er(n),o=a.length,s=!1,l=o-1;l>=0;l--)a[l]&&!Ud(a[l])?s=!0:(a[l]=null,!s&&o--);a.length=o,r[i]=a}}),delete r[r2],r},t.prototype.getTheme=function(){return this._theme},t.prototype.getLocaleModel=function(){return this._locale},t.prototype.setUpdatePayload=function(r){this._payload=r},t.prototype.getUpdatePayload=function(){return this._payload},t.prototype.getComponent=function(r,n){var i=this._componentsMap.get(r);if(i){var a=i[n||0];if(a)return a;if(n==null){for(var o=0;o<i.length;o++)if(i[o])return i[o]}}},t.prototype.queryComponents=function(r){var n=r.mainType;if(!n)return[];var i=r.index,a=r.id,o=r.name,s=this._componentsMap.get(n);if(!s||!s.length)return[];var l;return i!=null?(l=[],R(er(i),function(u){s[u]&&l.push(s[u])})):a!=null?l=n2("id",a,s):o!=null?l=n2("name",o,s):l=Xe(s,function(u){return!!u}),i2(l,r)},t.prototype.findComponents=function(r){var n=r.query,i=r.mainType,a=s(n),o=a?this.queryComponents(a):Xe(this._componentsMap.get(i),function(u){return!!u});return l(i2(o,r));function s(u){var h=i+"Index",f=i+"Id",c=i+"Name";return u&&(u[h]!=null||u[f]!=null||u[c]!=null)?{mainType:i,index:u[h],id:u[f],name:u[c]}:null}function l(u){return r.filter?Xe(u,r.filter):u}},t.prototype.eachComponent=function(r,n,i){var a=this._componentsMap;if(Yt(r)){var o=n,s=r;a.each(function(f,c){for(var d=0;f&&d<f.length;d++){var v=f[d];v&&s.call(o,c,v,v.componentIndex)}})}else for(var l=Ct(r)?a.get(r):Kt(r)?this.findComponents(r):null,u=0;l&&u<l.length;u++){var h=l[u];h&&n.call(i,h,h.componentIndex)}},t.prototype.getSeriesByName=function(r){var n=Xr(r,null);return Xe(this._componentsMap.get("series"),function(i){return!!i&&n!=null&&i.name===n})},t.prototype.getSeriesByIndex=function(r){return this._componentsMap.get("series")[r]},t.prototype.getSeriesByType=function(r){return Xe(this._componentsMap.get("series"),function(n){return!!n&&n.subType===r})},t.prototype.getSeries=function(){return Xe(this._componentsMap.get("series"),function(r){return!!r})},t.prototype.getSeriesCount=function(){return this._componentsCount.get("series")},t.prototype.eachSeries=function(r,n){_c(this),R(this._seriesIndices,function(i){var a=this._componentsMap.get("series")[i];r.call(n,a,i)},this)},t.prototype.eachRawSeries=function(r,n){R(this._componentsMap.get("series"),function(i){i&&r.call(n,i,i.componentIndex)})},t.prototype.eachSeriesByType=function(r,n,i){_c(this),R(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];o.subType===r&&n.call(i,o,a)},this)},t.prototype.eachRawSeriesByType=function(r,n,i){return R(this.getSeriesByType(r),n,i)},t.prototype.isSeriesFiltered=function(r){return _c(this),this._seriesIndicesMap.get(r.componentIndex)==null},t.prototype.getCurrentSeriesIndices=function(){return(this._seriesIndices||[]).slice()},t.prototype.filterSeries=function(r,n){_c(this);var i=[];R(this._seriesIndices,function(a){var o=this._componentsMap.get("series")[a];r.call(n,o,a)&&i.push(a)},this),this._seriesIndices=i,this._seriesIndicesMap=Ut(i)},t.prototype.restoreData=function(r){vp(this);var n=this._componentsMap,i=[];n.each(function(a,o){me.hasClass(o)&&i.push(o)}),me.topologicalTravel(i,me.getAllClassMainTypes(),function(a){R(n.get(a),function(o){o&&(a!=="series"||!XW(o,r))&&o.restoreData()})})},t.internalField=function(){vp=function(r){var n=r._seriesIndices=[];R(r._componentsMap.get("series"),function(i){i&&n.push(i.componentIndex)}),r._seriesIndicesMap=Ut(n)},_c=function(r){},e2=function(r,n){r.option={},r.option[r2]=WW,r._componentsMap=Ut({series:[]}),r._componentsCount=Ut();var i=n.aria;Kt(i)&&i.enabled==null&&(i.enabled=!0),YW(n,r._theme.option),Ot(n,FW,!1),r._mergeOption(n,null)}}(),t}(Ie);function XW(e,t){if(t){var r=t.seriesIndex,n=t.seriesId,i=t.seriesName;return r!=null&&e.componentIndex!==r||n!=null&&e.id!==n||i!=null&&e.name!==i}}function YW(e,t){var r=e.color&&!e.colorLayer;R(t,function(n,i){i==="colorLayer"&&r||me.hasClass(i)||(typeof n=="object"?e[i]=e[i]?Ot(e[i],n,!1):Qt(n):e[i]==null&&(e[i]=n))})}function n2(e,t,r){if(at(t)){var n=Ut();return R(t,function(a){if(a!=null){var o=Xr(a,null);o!=null&&n.set(a,!0)}}),Xe(r,function(a){return a&&n.get(a[e])})}else{var i=Xr(t,null);return Xe(r,function(a){return a&&i!=null&&a[e]===i})}}function i2(e,t){return t.hasOwnProperty("subType")?Xe(e,function(r){return r&&r.subType===t.subType}):e}function a2(e){var t=Ut();return e&&R(er(e.replaceMerge),function(r){t.set(r,!0)}),{replaceMergeMainTypeMap:t}}Nr(Mw,ww);var ZW=["getDom","getZr","getWidth","getHeight","getDevicePixelRatio","dispatchAction","isSSR","isDisposed","on","off","getDataURL","getConnectedDataURL","getOption","getId","updateLabelLayout"],G3=function(){function e(t){R(ZW,function(r){this[r]=It(t[r],t)},this)}return e}(),hy={},Yf=function(){function e(){this._coordinateSystems=[]}return e.prototype.create=function(t,r){var n=[];R(hy,function(i,a){var o=i.create(t,r);n=n.concat(o||[])}),this._coordinateSystems=n},e.prototype.update=function(t,r){R(this._coordinateSystems,function(n){n.update&&n.update(t,r)})},e.prototype.getCoordinateSystems=function(){return this._coordinateSystems.slice()},e.register=function(t,r){hy[t]=r},e.get=function(t){return hy[t]},e}(),qW=/^(min|max)?(.+)$/,$W=function(){function e(t){this._timelineOptions=[],this._mediaList=[],this._currentMediaIndices=[],this._api=t}return e.prototype.setOption=function(t,r,n){t&&(R(er(t.series),function(o){o&&o.data&&fi(o.data)&&fm(o.data)}),R(er(t.dataset),function(o){o&&o.source&&fi(o.source)&&fm(o.source)})),t=Qt(t);var i=this._optionBackup,a=KW(t,r,!i);this._newBaseOption=a.baseOption,i?(a.timelineOptions.length&&(i.timelineOptions=a.timelineOptions),a.mediaList.length&&(i.mediaList=a.mediaList),a.mediaDefault&&(i.mediaDefault=a.mediaDefault)):this._optionBackup=a},e.prototype.mountOption=function(t){var r=this._optionBackup;return this._timelineOptions=r.timelineOptions,this._mediaList=r.mediaList,this._mediaDefault=r.mediaDefault,this._currentMediaIndices=[],Qt(t?r.baseOption:this._newBaseOption)},e.prototype.getTimelineOption=function(t){var r,n=this._timelineOptions;if(n.length){var i=t.getComponent("timeline");i&&(r=Qt(n[i.getCurrentIndex()]))}return r},e.prototype.getMediaOption=function(t){var r=this._api.getWidth(),n=this._api.getHeight(),i=this._mediaList,a=this._mediaDefault,o=[],s=[];if(!i.length&&!a)return s;for(var l=0,u=i.length;l<u;l++)jW(i[l].query,r,n)&&o.push(l);return!o.length&&a&&(o=[-1]),o.length&&!QW(o,this._currentMediaIndices)&&(s=ft(o,function(h){return Qt(h===-1?a.option:i[h].option)})),this._currentMediaIndices=o,s},e}();function KW(e,t,r){var n=[],i,a,o=e.baseOption,s=e.timeline,l=e.options,u=e.media,h=!!e.media,f=!!(l||s||o&&o.timeline);o?(a=o,a.timeline||(a.timeline=s)):((f||h)&&(e.options=e.media=null),a=e),h&&at(u)&&R(u,function(d){d&&d.option&&(d.query?n.push(d):i||(i=d))}),c(a),R(l,function(d){return c(d)}),R(n,function(d){return c(d.option)});function c(d){R(t,function(v){v(d,r)})}return{baseOption:a,timelineOptions:l||[],mediaDefault:i,mediaList:n}}function jW(e,t,r){var n={width:t,height:r,aspectratio:t/r},i=!0;return R(e,function(a,o){var s=o.match(qW);if(!(!s||!s[1]||!s[2])){var l=s[1],u=s[2].toLowerCase();JW(n[u],a,l)||(i=!1)}}),i}function JW(e,t,r){return r==="min"?e>=t:r==="max"?e<=t:e===t}function QW(e,t){return e.join(",")===t.join(",")}var Ji=R,Wd=Kt,o2=["areaStyle","lineStyle","nodeStyle","linkStyle","chordStyle","label","labelLine"];function fy(e){var t=e&&e.itemStyle;if(t)for(var r=0,n=o2.length;r<n;r++){var i=o2[r],a=t.normal,o=t.emphasis;a&&a[i]&&(e[i]=e[i]||{},e[i].normal?Ot(e[i].normal,a[i]):e[i].normal=a[i],a[i]=null),o&&o[i]&&(e[i]=e[i]||{},e[i].emphasis?Ot(e[i].emphasis,o[i]):e[i].emphasis=o[i],o[i]=null)}}function Cn(e,t,r){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var n=e[t].normal,i=e[t].emphasis;n&&(r?(e[t].normal=e[t].emphasis=null,Vt(e[t],n)):e[t]=n),i&&(e.emphasis=e.emphasis||{},e.emphasis[t]=i,i.focus&&(e.emphasis.focus=i.focus),i.blurScope&&(e.emphasis.blurScope=i.blurScope))}}function id(e){Cn(e,"itemStyle"),Cn(e,"lineStyle"),Cn(e,"areaStyle"),Cn(e,"label"),Cn(e,"labelLine"),Cn(e,"upperLabel"),Cn(e,"edgeLabel")}function Fr(e,t){var r=Wd(e)&&e[t],n=Wd(r)&&r.textStyle;if(n)for(var i=0,a=cE.length;i<a;i++){var o=cE[i];n.hasOwnProperty(o)&&(r[o]=n[o])}}function Di(e){e&&(id(e),Fr(e,"label"),e.emphasis&&Fr(e.emphasis,"label"))}function t8(e){if(Wd(e)){fy(e),id(e),Fr(e,"label"),Fr(e,"upperLabel"),Fr(e,"edgeLabel"),e.emphasis&&(Fr(e.emphasis,"label"),Fr(e.emphasis,"upperLabel"),Fr(e.emphasis,"edgeLabel"));var t=e.markPoint;t&&(fy(t),Di(t));var r=e.markLine;r&&(fy(r),Di(r));var n=e.markArea;n&&Di(n);var i=e.data;if(e.type==="graph"){i=i||e.nodes;var a=e.links||e.edges;if(a&&!fi(a))for(var o=0;o<a.length;o++)Di(a[o]);R(e.categories,function(u){id(u)})}if(i&&!fi(i))for(var o=0;o<i.length;o++)Di(i[o]);if(t=e.markPoint,t&&t.data)for(var s=t.data,o=0;o<s.length;o++)Di(s[o]);if(r=e.markLine,r&&r.data)for(var l=r.data,o=0;o<l.length;o++)at(l[o])?(Di(l[o][0]),Di(l[o][1])):Di(l[o]);e.type==="gauge"?(Fr(e,"axisLabel"),Fr(e,"title"),Fr(e,"detail")):e.type==="treemap"?(Cn(e.breadcrumb,"itemStyle"),R(e.levels,function(u){id(u)})):e.type==="tree"&&id(e.leaves)}}function no(e){return at(e)?e:e?[e]:[]}function s2(e){return(at(e)?e[0]:e)||{}}function e8(e,t){Ji(no(e.series),function(n){Wd(n)&&t8(n)});var r=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","parallelAxis","radar"];t&&r.push("valueAxis","categoryAxis","logAxis","timeAxis"),Ji(r,function(n){Ji(no(e[n]),function(i){i&&(Fr(i,"axisLabel"),Fr(i.axisPointer,"label"))})}),Ji(no(e.parallel),function(n){var i=n&&n.parallelAxisDefault;Fr(i,"axisLabel"),Fr(i&&i.axisPointer,"label")}),Ji(no(e.calendar),function(n){Cn(n,"itemStyle"),Fr(n,"dayLabel"),Fr(n,"monthLabel"),Fr(n,"yearLabel")}),Ji(no(e.radar),function(n){Fr(n,"name"),n.name&&n.axisName==null&&(n.axisName=n.name,delete n.name),n.nameGap!=null&&n.axisNameGap==null&&(n.axisNameGap=n.nameGap,delete n.nameGap)}),Ji(no(e.geo),function(n){Wd(n)&&(Di(n),Ji(no(n.regions),function(i){Di(i)}))}),Ji(no(e.timeline),function(n){Di(n),Cn(n,"label"),Cn(n,"itemStyle"),Cn(n,"controlStyle",!0);var i=n.data;at(i)&&R(i,function(a){Kt(a)&&(Cn(a,"label"),Cn(a,"itemStyle"))})}),Ji(no(e.toolbox),function(n){Cn(n,"iconStyle"),Ji(n.feature,function(i){Cn(i,"iconStyle")})}),Fr(s2(e.axisPointer),"label"),Fr(s2(e.tooltip).axisPointer,"label")}function r8(e,t){for(var r=t.split(","),n=e,i=0;i<r.length&&(n=n&&n[r[i]],n!=null);i++);return n}function n8(e,t,r,n){for(var i=t.split(","),a=e,o,s=0;s<i.length-1;s++)o=i[s],a[o]==null&&(a[o]={}),a=a[o];a[i[s]]==null&&(a[i[s]]=r)}function l2(e){e&&R(i8,function(t){t[0]in e&&!(t[1]in e)&&(e[t[1]]=e[t[0]])})}var i8=[["x","left"],["y","top"],["x2","right"],["y2","bottom"]],a8=["grid","geo","parallel","legend","toolbox","title","visualMap","dataZoom","timeline"],cy=[["borderRadius","barBorderRadius"],["borderColor","barBorderColor"],["borderWidth","barBorderWidth"]];function yc(e){var t=e&&e.itemStyle;if(t)for(var r=0;r<cy.length;r++){var n=cy[r][1],i=cy[r][0];t[n]!=null&&(t[i]=t[n])}}function u2(e){e&&e.alignTo==="edge"&&e.margin!=null&&e.edgeDistance==null&&(e.edgeDistance=e.margin)}function h2(e){e&&e.downplay&&!e.blur&&(e.blur=e.downplay)}function o8(e){e&&e.focusNodeAdjacency!=null&&(e.emphasis=e.emphasis||{},e.emphasis.focus==null&&(e.emphasis.focus="adjacency"))}function V3(e,t){if(e)for(var r=0;r<e.length;r++)t(e[r]),e[r]&&V3(e[r].children,t)}function H3(e,t){e8(e,t),e.series=er(e.series),R(e.series,function(r){if(Kt(r)){var n=r.type;if(n==="line")r.clipOverflow!=null&&(r.clip=r.clipOverflow);else if(n==="pie"||n==="gauge"){r.clockWise!=null&&(r.clockwise=r.clockWise),u2(r.label);var i=r.data;if(i&&!fi(i))for(var a=0;a<i.length;a++)u2(i[a]);r.hoverOffset!=null&&(r.emphasis=r.emphasis||{},(r.emphasis.scaleSize=null)&&(r.emphasis.scaleSize=r.hoverOffset))}else if(n==="gauge"){var o=r8(r,"pointer.color");o!=null&&n8(r,"itemStyle.color",o)}else if(n==="bar"){yc(r),yc(r.backgroundStyle),yc(r.emphasis);var i=r.data;if(i&&!fi(i))for(var a=0;a<i.length;a++)typeof i[a]=="object"&&(yc(i[a]),yc(i[a]&&i[a].emphasis))}else if(n==="sunburst"){var s=r.highlightPolicy;s&&(r.emphasis=r.emphasis||{},r.emphasis.focus||(r.emphasis.focus=s)),h2(r),V3(r.data,h2)}else n==="graph"||n==="sankey"?o8(r):n==="map"&&(r.mapType&&!r.map&&(r.map=r.mapType),r.mapLocation&&Vt(r,r.mapLocation));r.hoverAnimation!=null&&(r.emphasis=r.emphasis||{},r.emphasis&&r.emphasis.scale==null&&(r.emphasis.scale=r.hoverAnimation)),l2(r)}}),e.dataRange&&(e.visualMap=e.dataRange),R(a8,function(r){var n=e[r];n&&(at(n)||(n=[n]),R(n,function(i){l2(i)}))})}function s8(e){var t=Ut();e.eachSeries(function(r){var n=r.get("stack");if(n){var i=t.get(n)||t.set(n,[]),a=r.getData(),o={stackResultDimension:a.getCalculationInfo("stackResultDimension"),stackedOverDimension:a.getCalculationInfo("stackedOverDimension"),stackedDimension:a.getCalculationInfo("stackedDimension"),stackedByDimension:a.getCalculationInfo("stackedByDimension"),isStackedByIndex:a.getCalculationInfo("isStackedByIndex"),data:a,seriesModel:r};if(!o.stackedDimension||!(o.isStackedByIndex||o.stackedByDimension))return;i.length&&a.setCalculationInfo("stackedOnSeries",i[i.length-1].seriesModel),i.push(o)}}),t.each(l8)}function l8(e){R(e,function(t,r){var n=[],i=[NaN,NaN],a=[t.stackResultDimension,t.stackedOverDimension],o=t.data,s=t.isStackedByIndex,l=t.seriesModel.get("stackStrategy")||"samesign";o.modify(a,function(u,h,f){var c=o.get(t.stackedDimension,f);if(isNaN(c))return i;var d,v;s?v=o.getRawIndex(f):d=o.get(t.stackedByDimension,f);for(var p=NaN,g=r-1;g>=0;g--){var m=e[g];if(s||(v=m.data.rawIndexOf(m.stackedByDimension,d)),v>=0){var _=m.data.getByRawIndex(m.stackResultDimension,v);if(l==="all"||l==="positive"&&_>0||l==="negative"&&_<0||l==="samesign"&&c>=0&&_>0||l==="samesign"&&c<=0&&_<0){c=i5(c,_),p=_;break}}}return n[0]=c,n[1]=p,n})})}var X_=function(){function e(t){this.data=t.data||(t.sourceFormat===ja?{}:[]),this.sourceFormat=t.sourceFormat||O3,this.seriesLayoutBy=t.seriesLayoutBy||Ha,this.startIndex=t.startIndex||0,this.dimensionsDetectedCount=t.dimensionsDetectedCount,this.metaRawOption=t.metaRawOption;var r=this.dimensionsDefine=t.dimensionsDefine;if(r)for(var n=0;n<r.length;n++){var i=r[n];i.type==null&&U3(this,n)===yn.Must&&(i.type="ordinal")}}return e}();function Aw(e){return e instanceof X_}function FS(e,t,r){r=r||W3(e);var n=t.seriesLayoutBy,i=h8(e,r,n,t.sourceHeader,t.dimensions),a=new X_({data:e,sourceFormat:r,seriesLayoutBy:n,dimensionsDefine:i.dimensionsDefine,startIndex:i.startIndex,dimensionsDetectedCount:i.dimensionsDetectedCount,metaRawOption:Qt(t)});return a}function Ew(e){return new X_({data:e,sourceFormat:fi(e)?Cs:qi})}function u8(e){return new X_({data:e.data,sourceFormat:e.sourceFormat,seriesLayoutBy:e.seriesLayoutBy,dimensionsDefine:Qt(e.dimensionsDefine),startIndex:e.startIndex,dimensionsDetectedCount:e.dimensionsDetectedCount})}function W3(e){var t=O3;if(fi(e))t=Cs;else if(at(e)){e.length===0&&(t=Ln);for(var r=0,n=e.length;r<n;r++){var i=e[r];if(i!=null){if(at(i)||fi(i)){t=Ln;break}else if(Kt(i)){t=$i;break}}}}else if(Kt(e)){for(var a in e)if(Ft(e,a)&&Dn(e[a])){t=ja;break}}return t}function h8(e,t,r,n,i){var a,o;if(!e)return{dimensionsDefine:f2(i),startIndex:o,dimensionsDetectedCount:a};if(t===Ln){var s=e;n==="auto"||n==null?c2(function(u){u!=null&&u!=="-"&&(Ct(u)?o==null&&(o=1):o=0)},r,s,10):o=Be(n)?n:n?1:0,!i&&o===1&&(i=[],c2(function(u,h){i[h]=u!=null?u+"":""},r,s,1/0)),a=i?i.length:r===Xf?s.length:s[0]?s[0].length:null}else if(t===$i)i||(i=f8(e));else if(t===ja)i||(i=[],R(e,function(u,h){i.push(h)}));else if(t===qi){var l=Uf(e[0]);a=at(l)&&l.length||1}return{startIndex:o,dimensionsDefine:f2(i),dimensionsDetectedCount:a}}function f8(e){for(var t=0,r;t<e.length&&!(r=e[t++]););if(r)return be(r)}function f2(e){if(e){var t=Ut();return ft(e,function(r,n){r=Kt(r)?r:{name:r};var i={name:r.name,displayName:r.displayName,type:r.type};if(i.name==null)return i;i.name+="",i.displayName==null&&(i.displayName=i.name);var a=t.get(i.name);return a?i.name+="-"+a.count++:t.set(i.name,{count:1}),i})}}function c2(e,t,r,n){if(t===Xf)for(var i=0;i<r.length&&i<n;i++)e(r[i]?r[i][0]:null,i);else for(var a=r[0]||[],i=0;i<a.length&&i<n;i++)e(a[i],i)}function X3(e){var t=e.sourceFormat;return t===$i||t===ja}var vl,pl,gl,d2,v2,Y3=function(){function e(t,r){var n=Aw(t)?t:Ew(t);this._source=n;var i=this._data=n.data;n.sourceFormat===Cs&&(this._offset=0,this._dimSize=r,this._data=i),v2(this,i,n)}return e.prototype.getSource=function(){return this._source},e.prototype.count=function(){return 0},e.prototype.getItem=function(t,r){},e.prototype.appendData=function(t){},e.prototype.clean=function(){},e.protoInitialize=function(){var t=e.prototype;t.pure=!1,t.persistent=!0}(),e.internalField=function(){var t;v2=function(o,s,l){var u=l.sourceFormat,h=l.seriesLayoutBy,f=l.startIndex,c=l.dimensionsDefine,d=d2[Cw(u,h)];if(rt(o,d),u===Cs)o.getItem=r,o.count=i,o.fillStorage=n;else{var v=Z3(u,h);o.getItem=It(v,null,s,f,c);var p=q3(u,h);o.count=It(p,null,s,f,c)}};var r=function(o,s){o=o-this._offset,s=s||[];for(var l=this._data,u=this._dimSize,h=u*o,f=0;f<u;f++)s[f]=l[h+f];return s},n=function(o,s,l,u){for(var h=this._data,f=this._dimSize,c=0;c<f;c++){for(var d=u[c],v=d[0]==null?1/0:d[0],p=d[1]==null?-1/0:d[1],g=s-o,m=l[c],_=0;_<g;_++){var y=h[_*f+c];m[o+_]=y,y<v&&(v=y),y>p&&(p=y)}d[0]=v,d[1]=p}},i=function(){return this._data?this._data.length/this._dimSize:0};d2=(t={},t[Ln+"_"+Ha]={pure:!0,appendData:a},t[Ln+"_"+Xf]={pure:!0,appendData:function(){throw new Error('Do not support appendData when set seriesLayoutBy: "row".')}},t[$i]={pure:!0,appendData:a},t[ja]={pure:!0,appendData:function(o){var s=this._data;R(o,function(l,u){for(var h=s[u]||(s[u]=[]),f=0;f<(l||[]).length;f++)h.push(l[f])})}},t[qi]={appendData:a},t[Cs]={persistent:!1,pure:!0,appendData:function(o){this._data=o},clean:function(){this._offset+=this.count(),this._data=null}},t);function a(o){for(var s=0;s<o.length;s++)this._data.push(o[s])}}(),e}(),p2=function(e,t,r,n){return e[n]},c8=(vl={},vl[Ln+"_"+Ha]=function(e,t,r,n){return e[n+t]},vl[Ln+"_"+Xf]=function(e,t,r,n,i){n+=t;for(var a=i||[],o=e,s=0;s<o.length;s++){var l=o[s];a[s]=l?l[n]:null}return a},vl[$i]=p2,vl[ja]=function(e,t,r,n,i){for(var a=i||[],o=0;o<r.length;o++){var s=r[o].name,l=e[s];a[o]=l?l[n]:null}return a},vl[qi]=p2,vl);function Z3(e,t){var r=c8[Cw(e,t)];return r}var g2=function(e,t,r){return e.length},d8=(pl={},pl[Ln+"_"+Ha]=function(e,t,r){return Math.max(0,e.length-t)},pl[Ln+"_"+Xf]=function(e,t,r){var n=e[0];return n?Math.max(0,n.length-t):0},pl[$i]=g2,pl[ja]=function(e,t,r){var n=r[0].name,i=e[n];return i?i.length:0},pl[qi]=g2,pl);function q3(e,t){var r=d8[Cw(e,t)];return r}var dy=function(e,t,r){return e[t]},v8=(gl={},gl[Ln]=dy,gl[$i]=function(e,t,r){return e[r]},gl[ja]=dy,gl[qi]=function(e,t,r){var n=Uf(e);return n instanceof Array?n[t]:n},gl[Cs]=dy,gl);function $3(e){var t=v8[e];return t}function Cw(e,t){return e===Ln?e+"_"+t:e}function cf(e,t,r){if(e){var n=e.getRawDataItem(t);if(n!=null){var i=e.getStore(),a=i.getSource().sourceFormat;if(r!=null){var o=e.getDimensionIndex(r),s=i.getDimensionProperty(o);return $3(a)(n,o,s)}else{var l=n;return a===qi&&(l=Uf(n)),l}}}}var p8=/\{@(.+?)\}/g,Y_=function(){function e(){}return e.prototype.getDataParams=function(t,r){var n=this.getData(r),i=this.getRawValue(t,r),a=n.getRawIndex(t),o=n.getName(t),s=n.getRawDataItem(t),l=n.getItemVisual(t,"style"),u=l&&l[n.getItemVisual(t,"drawType")||"fill"],h=l&&l.stroke,f=this.mainType,c=f==="series",d=n.userOutput&&n.userOutput.get();return{componentType:f,componentSubType:this.subType,componentIndex:this.componentIndex,seriesType:c?this.subType:null,seriesIndex:this.seriesIndex,seriesId:c?this.id:null,seriesName:c?this.name:null,name:o,dataIndex:a,data:s,dataType:r,value:i,color:u,borderColor:h,dimensionNames:d?d.fullDimensions:null,encode:d?d.encode:null,$vars:["seriesName","name","value"]}},e.prototype.getFormattedLabel=function(t,r,n,i,a,o){r=r||"normal";var s=this.getData(n),l=this.getDataParams(t,n);if(o&&(l.value=o.interpolatedValue),i!=null&&at(l.value)&&(l.value=l.value[i]),!a){var u=s.getItemModel(t);a=u.get(r==="normal"?["label","formatter"]:[r,"label","formatter"])}if(Yt(a))return l.status=r,l.dimensionIndex=i,a(l);if(Ct(a)){var h=xw(a,l);return h.replace(p8,function(f,c){var d=c.length,v=c;v.charAt(0)==="["&&v.charAt(d-1)==="]"&&(v=+v.slice(1,d-1));var p=cf(s,t,v);if(o&&at(o.interpolatedValue)){var g=s.getDimensionIndex(v);g>=0&&(p=o.interpolatedValue[g])}return p!=null?p+"":""})}},e.prototype.getRawValue=function(t,r){return cf(this.getData(r),t)},e.prototype.formatTooltip=function(t,r,n){},e}();function m2(e){var t,r;return Kt(e)?e.type&&(r=e):t=e,{text:t,frag:r}}function Md(e){return new g8(e)}var g8=function(){function e(t){t=t||{},this._reset=t.reset,this._plan=t.plan,this._count=t.count,this._onDirty=t.onDirty,this._dirty=!0}return e.prototype.perform=function(t){var r=this._upstream,n=t&&t.skip;if(this._dirty&&r){var i=this.context;i.data=i.outputData=r.context.outputData}this.__pipeline&&(this.__pipeline.currentTask=this);var a;this._plan&&!n&&(a=this._plan(this.context));var o=h(this._modBy),s=this._modDataCount||0,l=h(t&&t.modBy),u=t&&t.modDataCount||0;(o!==l||s!==u)&&(a="reset");function h(_){return!(_>=1)&&(_=1),_}var f;(this._dirty||a==="reset")&&(this._dirty=!1,f=this._doReset(n)),this._modBy=l,this._modDataCount=u;var c=t&&t.step;if(r?this._dueEnd=r._outputDueEnd:this._dueEnd=this._count?this._count(this.context):1/0,this._progress){var d=this._dueIndex,v=Math.min(c!=null?this._dueIndex+c:1/0,this._dueEnd);if(!n&&(f||d<v)){var p=this._progress;if(at(p))for(var g=0;g<p.length;g++)this._doProgress(p[g],d,v,l,u);else this._doProgress(p,d,v,l,u)}this._dueIndex=v;var m=this._settedOutputEnd!=null?this._settedOutputEnd:v;this._outputDueEnd=m}else this._dueIndex=this._outputDueEnd=this._settedOutputEnd!=null?this._settedOutputEnd:this._dueEnd;return this.unfinished()},e.prototype.dirty=function(){this._dirty=!0,this._onDirty&&this._onDirty(this.context)},e.prototype._doProgress=function(t,r,n,i,a){_2.reset(r,n,i,a),this._callingProgress=t,this._callingProgress({start:r,end:n,count:n-r,next:_2.next},this.context)},e.prototype._doReset=function(t){this._dueIndex=this._outputDueEnd=this._dueEnd=0,this._settedOutputEnd=null;var r,n;!t&&this._reset&&(r=this._reset(this.context),r&&r.progress&&(n=r.forceFirstProgress,r=r.progress),at(r)&&!r.length&&(r=null)),this._progress=r,this._modBy=this._modDataCount=null;var i=this._downstream;return i&&i.dirty(),n},e.prototype.unfinished=function(){return this._progress&&this._dueIndex<this._dueEnd},e.prototype.pipe=function(t){(this._downstream!==t||this._dirty)&&(this._downstream=t,t._upstream=this,t.dirty())},e.prototype.dispose=function(){this._disposed||(this._upstream&&(this._upstream._downstream=null),this._downstream&&(this._downstream._upstream=null),this._dirty=!1,this._disposed=!0)},e.prototype.getUpstream=function(){return this._upstream},e.prototype.getDownstream=function(){return this._downstream},e.prototype.setOutputEnd=function(t){this._outputDueEnd=this._settedOutputEnd=t},e}(),_2=function(){var e,t,r,n,i,a={reset:function(l,u,h,f){t=l,e=u,r=h,n=f,i=Math.ceil(n/r),a.next=r>1&&n>0?s:o}};return a;function o(){return t<e?t++:null}function s(){var l=t%i*r+Math.ceil(t/i),u=t>=e?null:l<n?l:t;return t++,u}}();function Ds(e,t){var r=t&&t.type;return r==="ordinal"?e:(r==="time"&&!Be(e)&&e!=null&&e!=="-"&&(e=+Xi(e)),e==null||e===""?NaN:Number(e))}var m8=Ut({number:function(e){return parseFloat(e)},time:function(e){return+Xi(e)},trim:function(e){return Ct(e)?ha(e):e}});function K3(e){return m8.get(e)}var j3={lt:function(e,t){return e<t},lte:function(e,t){return e<=t},gt:function(e,t){return e>t},gte:function(e,t){return e>=t}},_8=function(){function e(t,r){if(!Be(r)){var n="";We(n)}this._opFn=j3[t],this._rvalFloat=Ro(r)}return e.prototype.evaluate=function(t){return Be(t)?this._opFn(t,this._rvalFloat):this._opFn(Ro(t),this._rvalFloat)},e}(),J3=function(){function e(t,r){var n=t==="desc";this._resultLT=n?1:-1,r==null&&(r=n?"min":"max"),this._incomparable=r==="min"?-1/0:1/0}return e.prototype.evaluate=function(t,r){var n=Be(t)?t:Ro(t),i=Be(r)?r:Ro(r),a=isNaN(n),o=isNaN(i);if(a&&(n=this._incomparable),o&&(i=this._incomparable),a&&o){var s=Ct(t),l=Ct(r);s&&(n=l?t:0),l&&(i=s?r:0)}return n<i?this._resultLT:n>i?-this._resultLT:0},e}(),y8=function(){function e(t,r){this._rval=r,this._isEQ=t,this._rvalTypeof=typeof r,this._rvalFloat=Ro(r)}return e.prototype.evaluate=function(t){var r=t===this._rval;if(!r){var n=typeof t;n!==this._rvalTypeof&&(n==="number"||this._rvalTypeof==="number")&&(r=Ro(t)===this._rvalFloat)}return this._isEQ?r:!r},e}();function x8(e,t){return e==="eq"||e==="ne"?new y8(e==="eq",t):Ft(j3,e)?new _8(e,t):null}var S8=function(){function e(){}return e.prototype.getRawData=function(){throw new Error("not supported")},e.prototype.getRawDataItem=function(t){throw new Error("not supported")},e.prototype.cloneRawData=function(){},e.prototype.getDimensionInfo=function(t){},e.prototype.cloneAllDimensionInfo=function(){},e.prototype.count=function(){},e.prototype.retrieveValue=function(t,r){},e.prototype.retrieveValueFromItem=function(t,r){},e.prototype.convertValue=function(t,r){return Ds(t,r)},e}();function T8(e,t){var r=new S8,n=e.data,i=r.sourceFormat=e.sourceFormat,a=e.startIndex,o="";e.seriesLayoutBy!==Ha&&We(o);var s=[],l={},u=e.dimensionsDefine;if(u)R(u,function(p,g){var m=p.name,_={index:g,name:m,displayName:p.displayName};if(s.push(_),m!=null){var y="";Ft(l,m)&&We(y),l[m]=_}});else for(var h=0;h<e.dimensionsDetectedCount;h++)s.push({index:h});var f=Z3(i,Ha);t.__isBuiltIn&&(r.getRawDataItem=function(p){return f(n,a,s,p)},r.getRawData=It(b8,null,e)),r.cloneRawData=It(w8,null,e);var c=q3(i,Ha);r.count=It(c,null,n,a,s);var d=$3(i);r.retrieveValue=function(p,g){var m=f(n,a,s,p);return v(m,g)};var v=r.retrieveValueFromItem=function(p,g){if(p!=null){var m=s[g];if(m)return d(p,g,m.name)}};return r.getDimensionInfo=It(M8,null,s,l),r.cloneAllDimensionInfo=It(A8,null,s),r}function b8(e){var t=e.sourceFormat;if(!Dw(t)){var r="";We(r)}return e.data}function w8(e){var t=e.sourceFormat,r=e.data;if(!Dw(t)){var n="";We(n)}if(t===Ln){for(var i=[],a=0,o=r.length;a<o;a++)i.push(r[a].slice());return i}else if(t===$i){for(var i=[],a=0,o=r.length;a<o;a++)i.push(rt({},r[a]));return i}}function M8(e,t,r){if(r!=null){if(Be(r)||!isNaN(r)&&!Ft(t,r))return e[r];if(Ft(t,r))return t[r]}}function A8(e){return Qt(e)}var Q3=Ut();function E8(e){e=Qt(e);var t=e.type,r="";t||We(r);var n=t.split(":");n.length!==2&&We(r);var i=!1;n[0]==="echarts"&&(t=n[1],i=!0),e.__isBuiltIn=i,Q3.set(t,e)}function C8(e,t,r){var n=er(e),i=n.length,a="";i||We(a);for(var o=0,s=i;o<s;o++){var l=n[o];t=D8(l,t),o!==s-1&&(t.length=Math.max(t.length,1))}return t}function D8(e,t,r,n){var i="";t.length||We(i),Kt(e)||We(i);var a=e.type,o=Q3.get(a);o||We(i);var s=ft(t,function(u){return T8(u,o)}),l=er(o.transform({upstream:s[0],upstreamList:s,config:Qt(e.config)}));return ft(l,function(u,h){var f="";Kt(u)||We(f),u.data||We(f);var c=W3(u.data);Dw(c)||We(f);var d,v=t[0];if(v&&h===0&&!u.dimensions){var p=v.startIndex;p&&(u.data=v.data.slice(0,p).concat(u.data)),d={seriesLayoutBy:Ha,sourceHeader:p,dimensions:v.metaRawOption.dimensions}}else d={seriesLayoutBy:Ha,sourceHeader:0,dimensions:u.dimensions};return FS(u.data,d,null)})}function Dw(e){return e===Ln||e===$i}var Z_="undefined",L8=typeof Uint32Array===Z_?Array:Uint32Array,R8=typeof Uint16Array===Z_?Array:Uint16Array,tF=typeof Int32Array===Z_?Array:Int32Array,y2=typeof Float64Array===Z_?Array:Float64Array,eF={float:y2,int:tF,ordinal:Array,number:Array,time:y2},vy;function rh(e){return e>65535?L8:R8}function nh(){return[1/0,-1/0]}function P8(e){var t=e.constructor;return t===Array?e.slice():new t(e)}function x2(e,t,r,n,i){var a=eF[r||"float"];if(i){var o=e[t],s=o&&o.length;if(s!==n){for(var l=new a(n),u=0;u<s;u++)l[u]=o[u];e[t]=l}}else e[t]=new a(n)}var BS=function(){function e(){this._chunks=[],this._rawExtent=[],this._extent=[],this._count=0,this._rawCount=0,this._calcDimNameToIdx=Ut()}return e.prototype.initData=function(t,r,n){this._provider=t,this._chunks=[],this._indices=null,this.getRawIndex=this._getRawIdxIdentity;var i=t.getSource(),a=this.defaultDimValueGetter=vy[i.sourceFormat];this._dimValueGetter=n||a,this._rawExtent=[],X3(i),this._dimensions=ft(r,function(o){return{type:o.type,property:o.property}}),this._initDataFromProvider(0,t.count())},e.prototype.getProvider=function(){return this._provider},e.prototype.getSource=function(){return this._provider.getSource()},e.prototype.ensureCalculationDimension=function(t,r){var n=this._calcDimNameToIdx,i=this._dimensions,a=n.get(t);if(a!=null){if(i[a].type===r)return a}else a=i.length;return i[a]={type:r},n.set(t,a),this._chunks[a]=new eF[r||"float"](this._rawCount),this._rawExtent[a]=nh(),a},e.prototype.collectOrdinalMeta=function(t,r){var n=this._chunks[t],i=this._dimensions[t],a=this._rawExtent,o=i.ordinalOffset||0,s=n.length;o===0&&(a[t]=nh());for(var l=a[t],u=o;u<s;u++){var h=n[u]=r.parseAndCollect(n[u]);isNaN(h)||(l[0]=Math.min(h,l[0]),l[1]=Math.max(h,l[1]))}i.ordinalMeta=r,i.ordinalOffset=s,i.type="ordinal"},e.prototype.getOrdinalMeta=function(t){var r=this._dimensions[t],n=r.ordinalMeta;return n},e.prototype.getDimensionProperty=function(t){var r=this._dimensions[t];return r&&r.property},e.prototype.appendData=function(t){var r=this._provider,n=this.count();r.appendData(t);var i=r.count();return r.persistent||(i+=n),n<i&&this._initDataFromProvider(n,i,!0),[n,i]},e.prototype.appendValues=function(t,r){for(var n=this._chunks,i=this._dimensions,a=i.length,o=this._rawExtent,s=this.count(),l=s+Math.max(t.length,r||0),u=0;u<a;u++){var h=i[u];x2(n,u,h.type,l,!0)}for(var f=[],c=s;c<l;c++)for(var d=c-s,v=0;v<a;v++){var h=i[v],p=vy.arrayRows.call(this,t[d]||f,h.property,d,v);n[v][c]=p;var g=o[v];p<g[0]&&(g[0]=p),p>g[1]&&(g[1]=p)}return this._rawCount=this._count=l,{start:s,end:l}},e.prototype._initDataFromProvider=function(t,r,n){for(var i=this._provider,a=this._chunks,o=this._dimensions,s=o.length,l=this._rawExtent,u=ft(o,function(_){return _.property}),h=0;h<s;h++){var f=o[h];l[h]||(l[h]=nh()),x2(a,h,f.type,r,n)}if(i.fillStorage)i.fillStorage(t,r,a,l);else for(var c=[],d=t;d<r;d++){c=i.getItem(d,c);for(var v=0;v<s;v++){var p=a[v],g=this._dimValueGetter(c,u[v],d,v);p[d]=g;var m=l[v];g<m[0]&&(m[0]=g),g>m[1]&&(m[1]=g)}}!i.persistent&&i.clean&&i.clean(),this._rawCount=this._count=r,this._extent=[]},e.prototype.count=function(){return this._count},e.prototype.get=function(t,r){if(!(r>=0&&r<this._count))return NaN;var n=this._chunks[t];return n?n[this.getRawIndex(r)]:NaN},e.prototype.getValues=function(t,r){var n=[],i=[];if(r==null){r=t,t=[];for(var a=0;a<this._dimensions.length;a++)i.push(a)}else i=t;for(var a=0,o=i.length;a<o;a++)n.push(this.get(i[a],r));return n},e.prototype.getByRawIndex=function(t,r){if(!(r>=0&&r<this._rawCount))return NaN;var n=this._chunks[t];return n?n[r]:NaN},e.prototype.getSum=function(t){var r=this._chunks[t],n=0;if(r)for(var i=0,a=this.count();i<a;i++){var o=this.get(t,i);isNaN(o)||(n+=o)}return n},e.prototype.getMedian=function(t){var r=[];this.each([t],function(a){isNaN(a)||r.push(a)});var n=r.sort(function(a,o){return a-o}),i=this.count();return i===0?0:i%2===1?n[(i-1)/2]:(n[i/2]+n[i/2-1])/2},e.prototype.indexOfRawIndex=function(t){if(t>=this._rawCount||t<0)return-1;if(!this._indices)return t;var r=this._indices,n=r[t];if(n!=null&&n<this._count&&n===t)return t;for(var i=0,a=this._count-1;i<=a;){var o=(i+a)/2|0;if(r[o]<t)i=o+1;else if(r[o]>t)a=o-1;else return o}return-1},e.prototype.indicesOfNearest=function(t,r,n){var i=this._chunks,a=i[t],o=[];if(!a)return o;n==null&&(n=1/0);for(var s=1/0,l=-1,u=0,h=0,f=this.count();h<f;h++){var c=this.getRawIndex(h),d=r-a[c],v=Math.abs(d);v<=n&&((v<s||v===s&&d>=0&&l<0)&&(s=v,l=d,u=0),d===l&&(o[u++]=h))}return o.length=u,o},e.prototype.getIndices=function(){var t,r=this._indices;if(r){var n=r.constructor,i=this._count;if(n===Array){t=new n(i);for(var a=0;a<i;a++)t[a]=r[a]}else t=new n(r.buffer,0,i)}else{var n=rh(this._rawCount);t=new n(this.count());for(var a=0;a<t.length;a++)t[a]=a}return t},e.prototype.filter=function(t,r){if(!this._count)return this;for(var n=this.clone(),i=n.count(),a=rh(n._rawCount),o=new a(i),s=[],l=t.length,u=0,h=t[0],f=n._chunks,c=0;c<i;c++){var d=void 0,v=n.getRawIndex(c);if(l===0)d=r(c);else if(l===1){var p=f[h][v];d=r(p,c)}else{for(var g=0;g<l;g++)s[g]=f[t[g]][v];s[g]=c,d=r.apply(null,s)}d&&(o[u++]=v)}return u<i&&(n._indices=o),n._count=u,n._extent=[],n._updateGetRawIdx(),n},e.prototype.selectRange=function(t){var r=this.clone(),n=r._count;if(!n)return this;var i=be(t),a=i.length;if(!a)return this;var o=r.count(),s=rh(r._rawCount),l=new s(o),u=0,h=i[0],f=t[h][0],c=t[h][1],d=r._chunks,v=!1;if(!r._indices){var p=0;if(a===1){for(var g=d[i[0]],m=0;m<n;m++){var _=g[m];(_>=f&&_<=c||isNaN(_))&&(l[u++]=p),p++}v=!0}else if(a===2){for(var g=d[i[0]],y=d[i[1]],x=t[i[1]][0],T=t[i[1]][1],m=0;m<n;m++){var _=g[m],S=y[m];(_>=f&&_<=c||isNaN(_))&&(S>=x&&S<=T||isNaN(S))&&(l[u++]=p),p++}v=!0}}if(!v)if(a===1)for(var m=0;m<o;m++){var M=r.getRawIndex(m),_=d[i[0]][M];(_>=f&&_<=c||isNaN(_))&&(l[u++]=M)}else for(var m=0;m<o;m++){for(var w=!0,M=r.getRawIndex(m),b=0;b<a;b++){var A=i[b],_=d[A][M];(_<t[A][0]||_>t[A][1])&&(w=!1)}w&&(l[u++]=r.getRawIndex(m))}return u<o&&(r._indices=l),r._count=u,r._extent=[],r._updateGetRawIdx(),r},e.prototype.map=function(t,r){var n=this.clone(t);return this._updateDims(n,t,r),n},e.prototype.modify=function(t,r){this._updateDims(this,t,r)},e.prototype._updateDims=function(t,r,n){for(var i=t._chunks,a=[],o=r.length,s=t.count(),l=[],u=t._rawExtent,h=0;h<r.length;h++)u[r[h]]=nh();for(var f=0;f<s;f++){for(var c=t.getRawIndex(f),d=0;d<o;d++)l[d]=i[r[d]][c];l[o]=f;var v=n&&n.apply(null,l);if(v!=null){typeof v!="object"&&(a[0]=v,v=a);for(var h=0;h<v.length;h++){var p=r[h],g=v[h],m=u[p],_=i[p];_&&(_[c]=g),g<m[0]&&(m[0]=g),g>m[1]&&(m[1]=g)}}}},e.prototype.lttbDownSample=function(t,r){var n=this.clone([t],!0),i=n._chunks,a=i[t],o=this.count(),s=0,l=Math.floor(1/r),u=this.getRawIndex(0),h,f,c,d=new(rh(this._rawCount))(Math.min((Math.ceil(o/l)+2)*2,o));d[s++]=u;for(var v=1;v<o-1;v+=l){for(var p=Math.min(v+l,o-1),g=Math.min(v+l*2,o),m=(g+p)/2,_=0,y=p;y<g;y++){var x=this.getRawIndex(y),T=a[x];isNaN(T)||(_+=T)}_/=g-p;var S=v,M=Math.min(v+l,o),w=v-1,b=a[u];h=-1,c=S;for(var A=-1,E=0,y=S;y<M;y++){var x=this.getRawIndex(y),T=a[x];if(isNaN(T)){E++,A<0&&(A=x);continue}f=Math.abs((w-m)*(T-b)-(w-y)*(_-b)),f>h&&(h=f,c=x)}E>0&&E<M-S&&(d[s++]=Math.min(A,c),c=Math.max(A,c)),d[s++]=c,u=c}return d[s++]=this.getRawIndex(o-1),n._count=s,n._indices=d,n.getRawIndex=this._getRawIdx,n},e.prototype.minmaxDownSample=function(t,r){for(var n=this.clone([t],!0),i=n._chunks,a=Math.floor(1/r),o=i[t],s=this.count(),l=new(rh(this._rawCount))(Math.ceil(s/a)*2),u=0,h=0;h<s;h+=a){var f=h,c=o[this.getRawIndex(f)],d=h,v=o[this.getRawIndex(d)],p=a;h+a>s&&(p=s-h);for(var g=0;g<p;g++){var m=this.getRawIndex(h+g),_=o[m];_<c&&(c=_,f=h+g),_>v&&(v=_,d=h+g)}var y=this.getRawIndex(f),x=this.getRawIndex(d);f<d?(l[u++]=y,l[u++]=x):(l[u++]=x,l[u++]=y)}return n._count=u,n._indices=l,n._updateGetRawIdx(),n},e.prototype.downSample=function(t,r,n,i){for(var a=this.clone([t],!0),o=a._chunks,s=[],l=Math.floor(1/r),u=o[t],h=this.count(),f=a._rawExtent[t]=nh(),c=new(rh(this._rawCount))(Math.ceil(h/l)),d=0,v=0;v<h;v+=l){l>h-v&&(l=h-v,s.length=l);for(var p=0;p<l;p++){var g=this.getRawIndex(v+p);s[p]=u[g]}var m=n(s),_=this.getRawIndex(Math.min(v+i(s,m)||0,h-1));u[_]=m,m<f[0]&&(f[0]=m),m>f[1]&&(f[1]=m),c[d++]=_}return a._count=d,a._indices=c,a._updateGetRawIdx(),a},e.prototype.each=function(t,r){if(this._count)for(var n=t.length,i=this._chunks,a=0,o=this.count();a<o;a++){var s=this.getRawIndex(a);switch(n){case 0:r(a);break;case 1:r(i[t[0]][s],a);break;case 2:r(i[t[0]][s],i[t[1]][s],a);break;default:for(var l=0,u=[];l<n;l++)u[l]=i[t[l]][s];u[l]=a,r.apply(null,u)}}},e.prototype.getDataExtent=function(t){var r=this._chunks[t],n=nh();if(!r)return n;var i=this.count(),a=!this._indices,o;if(a)return this._rawExtent[t].slice();if(o=this._extent[t],o)return o.slice();o=n;for(var s=o[0],l=o[1],u=0;u<i;u++){var h=this.getRawIndex(u),f=r[h];f<s&&(s=f),f>l&&(l=f)}return o=[s,l],this._extent[t]=o,o},e.prototype.getRawDataItem=function(t){var r=this.getRawIndex(t);if(this._provider.persistent)return this._provider.getItem(r);for(var n=[],i=this._chunks,a=0;a<i.length;a++)n.push(i[a][r]);return n},e.prototype.clone=function(t,r){var n=new e,i=this._chunks,a=t&&ma(t,function(s,l){return s[l]=!0,s},{});if(a)for(var o=0;o<i.length;o++)n._chunks[o]=a[o]?P8(i[o]):i[o];else n._chunks=i;return this._copyCommonProps(n),r||(n._indices=this._cloneIndices()),n._updateGetRawIdx(),n},e.prototype._copyCommonProps=function(t){t._count=this._count,t._rawCount=this._rawCount,t._provider=this._provider,t._dimensions=this._dimensions,t._extent=Qt(this._extent),t._rawExtent=Qt(this._rawExtent)},e.prototype._cloneIndices=function(){if(this._indices){var t=this._indices.constructor,r=void 0;if(t===Array){var n=this._indices.length;r=new t(n);for(var i=0;i<n;i++)r[i]=this._indices[i]}else r=new t(this._indices);return r}return null},e.prototype._getRawIdxIdentity=function(t){return t},e.prototype._getRawIdx=function(t){return t<this._count&&t>=0?this._indices[t]:-1},e.prototype._updateGetRawIdx=function(){this.getRawIndex=this._indices?this._getRawIdx:this._getRawIdxIdentity},e.internalField=function(){function t(r,n,i,a){return Ds(r[a],this._dimensions[a])}vy={arrayRows:t,objectRows:function(r,n,i,a){return Ds(r[n],this._dimensions[a])},keyedColumns:t,original:function(r,n,i,a){var o=r&&(r.value==null?r:r.value);return Ds(o instanceof Array?o[a]:o,this._dimensions[a])},typedArray:function(r,n,i,a){return r[a]}}}(),e}(),rF=function(){function e(t){this._sourceList=[],this._storeList=[],this._upstreamSignList=[],this._versionSignBase=0,this._dirty=!0,this._sourceHost=t}return e.prototype.dirty=function(){this._setLocalSource([],[]),this._storeList=[],this._dirty=!0},e.prototype._setLocalSource=function(t,r){this._sourceList=t,this._upstreamSignList=r,this._versionSignBase++,this._versionSignBase>9e10&&(this._versionSignBase=0)},e.prototype._getVersionSign=function(){return this._sourceHost.uid+"_"+this._versionSignBase},e.prototype.prepareSource=function(){this._isDirty()&&(this._createSource(),this._dirty=!1)},e.prototype._createSource=function(){this._setLocalSource([],[]);var t=this._sourceHost,r=this._getUpstreamSourceManagers(),n=!!r.length,i,a;if(pp(t)){var o=t,s=void 0,l=void 0,u=void 0;if(n){var h=r[0];h.prepareSource(),u=h.getSource(),s=u.data,l=u.sourceFormat,a=[h._getVersionSign()]}else s=o.get("data",!0),l=fi(s)?Cs:qi,a=[];var f=this._getSourceMetaRawOption()||{},c=u&&u.metaRawOption||{},d=se(f.seriesLayoutBy,c.seriesLayoutBy)||null,v=se(f.sourceHeader,c.sourceHeader),p=se(f.dimensions,c.dimensions),g=d!==c.seriesLayoutBy||!!v!=!!c.sourceHeader||p;i=g?[FS(s,{seriesLayoutBy:d,sourceHeader:v,dimensions:p},l)]:[]}else{var m=t;if(n){var _=this._applyTransform(r);i=_.sourceList,a=_.upstreamSignList}else{var y=m.get("source",!0);i=[FS(y,this._getSourceMetaRawOption(),null)],a=[]}}this._setLocalSource(i,a)},e.prototype._applyTransform=function(t){var r=this._sourceHost,n=r.get("transform",!0),i=r.get("fromTransformResult",!0);if(i!=null){var a="";t.length!==1&&T2(a)}var o,s=[],l=[];return R(t,function(u){u.prepareSource();var h=u.getSource(i||0),f="";i!=null&&!h&&T2(f),s.push(h),l.push(u._getVersionSign())}),n?o=C8(n,s,{datasetIndex:r.componentIndex}):i!=null&&(o=[u8(s[0])]),{sourceList:o,upstreamSignList:l}},e.prototype._isDirty=function(){if(this._dirty)return!0;for(var t=this._getUpstreamSourceManagers(),r=0;r<t.length;r++){var n=t[r];if(n._isDirty()||this._upstreamSignList[r]!==n._getVersionSign())return!0}},e.prototype.getSource=function(t){t=t||0;var r=this._sourceList[t];if(!r){var n=this._getUpstreamSourceManagers();return n[0]&&n[0].getSource(t)}return r},e.prototype.getSharedDataStore=function(t){var r=t.makeStoreSchema();return this._innerGetDataStore(r.dimensions,t.source,r.hash)},e.prototype._innerGetDataStore=function(t,r,n){var i=0,a=this._storeList,o=a[i];o||(o=a[i]={});var s=o[n];if(!s){var l=this._getUpstreamSourceManagers()[0];pp(this._sourceHost)&&l?s=l._innerGetDataStore(t,r,n):(s=new BS,s.initData(new Y3(r,t.length),t)),o[n]=s}return s},e.prototype._getUpstreamSourceManagers=function(){var t=this._sourceHost;if(pp(t)){var r=bw(t);return r?[r.getSourceManager()]:[]}else return ft(UW(t),function(n){return n.getSourceManager()})},e.prototype._getSourceMetaRawOption=function(){var t=this._sourceHost,r,n,i;if(pp(t))r=t.get("seriesLayoutBy",!0),n=t.get("sourceHeader",!0),i=t.get("dimensions",!0);else if(!this._getUpstreamSourceManagers().length){var a=t;r=a.get("seriesLayoutBy",!0),n=a.get("sourceHeader",!0),i=a.get("dimensions",!0)}return{seriesLayoutBy:r,sourceHeader:n,dimensions:i}},e}();function S2(e){var t=e.option.transform;t&&fm(e.option.transform)}function pp(e){return e.mainType==="series"}function T2(e){throw new Error(e)}var I8="line-height:1";function nF(e){var t=e.lineHeight;return t==null?I8:"line-height:"+Br(t+"")+"px"}function iF(e,t){var r=e.color||"#6e7079",n=e.fontSize||12,i=e.fontWeight||"400",a=e.color||"#464646",o=e.fontSize||14,s=e.fontWeight||"900";return t==="html"?{nameStyle:"font-size:"+Br(n+"")+"px;color:"+Br(r)+";font-weight:"+Br(i+""),valueStyle:"font-size:"+Br(o+"")+"px;color:"+Br(a)+";font-weight:"+Br(s+"")}:{nameStyle:{fontSize:n,fill:r,fontWeight:i},valueStyle:{fontSize:o,fill:a,fontWeight:s}}}var N8=[0,10,20,30],O8=["",`
`,`

`,`


`];function on(e,t){return t.type=e,t}function US(e){return e.type==="section"}function aF(e){return US(e)?F8:B8}function oF(e){if(US(e)){var t=0,r=e.blocks.length,n=r>1||r>0&&!e.noHeader;return R(e.blocks,function(i){var a=oF(i);a>=t&&(t=a+ +(n&&(!a||US(i)&&!i.noHeader)))}),t}return 0}function F8(e,t,r,n){var i=t.noHeader,a=U8(oF(t)),o=[],s=t.blocks||[];Hn(!s||at(s)),s=s||[];var l=e.orderMode;if(t.sortBlocks&&l){s=s.slice();var u={valueAsc:"asc",valueDesc:"desc"};if(Ft(u,l)){var h=new J3(u[l],null);s.sort(function(p,g){return h.evaluate(p.sortParam,g.sortParam)})}else l==="seriesDesc"&&s.reverse()}R(s,function(p,g){var m=t.valueFormatter,_=aF(p)(m?rt(rt({},e),{valueFormatter:m}):e,p,g>0?a.html:0,n);_!=null&&o.push(_)});var f=e.renderMode==="richText"?o.join(a.richText):zS(n,o.join(""),i?r:a.html);if(i)return f;var c=IS(t.header,"ordinal",e.useUTC),d=iF(n,e.renderMode).nameStyle,v=nF(n);return e.renderMode==="richText"?sF(e,c,d)+a.richText+f:zS(n,'<div style="'+d+";"+v+';">'+Br(c)+"</div>"+f,r)}function B8(e,t,r,n){var i=e.renderMode,a=t.noName,o=t.noValue,s=!t.markerType,l=t.name,u=e.useUTC,h=t.valueFormatter||e.valueFormatter||function(x){return x=at(x)?x:[x],ft(x,function(T,S){return IS(T,at(d)?d[S]:d,u)})};if(!(a&&o)){var f=s?"":e.markupStyleCreator.makeTooltipMarker(t.markerType,t.markerColor||"#333",i),c=a?"":IS(l,"ordinal",u),d=t.valueType,v=o?[]:h(t.value,t.dataIndex),p=!s||!a,g=!s&&a,m=iF(n,i),_=m.nameStyle,y=m.valueStyle;return i==="richText"?(s?"":f)+(a?"":sF(e,c,_))+(o?"":G8(e,v,p,g,y)):zS(n,(s?"":f)+(a?"":z8(c,!s,_))+(o?"":k8(v,p,g,y)),r)}}function b2(e,t,r,n,i,a){if(e){var o=aF(e),s={useUTC:i,renderMode:r,orderMode:n,markupStyleCreator:t,valueFormatter:e.valueFormatter};return o(s,e,0,a)}}function U8(e){return{html:N8[e],richText:O8[e]}}function zS(e,t,r){var n='<div style="clear:both"></div>',i="margin: "+r+"px 0 0",a=nF(e);return'<div style="'+i+";"+a+';">'+t+n+"</div>"}function z8(e,t,r){var n=t?"margin-left:2px":"";return'<span style="'+r+";"+n+'">'+Br(e)+"</span>"}function k8(e,t,r,n){var i=r?"10px":"20px",a=t?"float:right;margin-left:"+i:"";return e=at(e)?e:[e],'<span style="'+a+";"+n+'">'+ft(e,function(o){return Br(o)}).join("&nbsp;&nbsp;")+"</span>"}function sF(e,t,r){return e.markupStyleCreator.wrapRichTextStyle(t,r)}function G8(e,t,r,n,i){var a=[i],o=n?10:20;return r&&a.push({padding:[0,0,0,o],align:"right"}),e.markupStyleCreator.wrapRichTextStyle(at(t)?t.join("  "):t,a)}function lF(e,t){var r=e.getData().getItemVisual(t,"style"),n=r[e.visualDrawType];return Mu(n)}function uF(e,t){var r=e.get("padding");return r??(t==="richText"?[8,10]:10)}var py=function(){function e(){this.richTextStyles={},this._nextStyleNameId=MO()}return e.prototype._generateStyleName=function(){return"__EC_aUTo_"+this._nextStyleNameId++},e.prototype.makeTooltipMarker=function(t,r,n){var i=n==="richText"?this._generateStyleName():null,a=L3({color:r,type:t,renderMode:n,markerId:i});return Ct(a)?a:(this.richTextStyles[i]=a.style,a.content)},e.prototype.wrapRichTextStyle=function(t,r){var n={};at(r)?R(r,function(a){return rt(n,a)}):rt(n,r);var i=this._generateStyleName();return this.richTextStyles[i]=n,"{"+i+"|"+t+"}"},e}();function hF(e){var t=e.series,r=e.dataIndex,n=e.multipleSeries,i=t.getData(),a=i.mapDimensionsAll("defaultedTooltip"),o=a.length,s=t.getRawValue(r),l=at(s),u=lF(t,r),h,f,c,d;if(o>1||l&&!o){var v=V8(s,t,r,a,u);h=v.inlineValues,f=v.inlineValueTypes,c=v.blocks,d=v.inlineValues[0]}else if(o){var p=i.getDimensionInfo(a[0]);d=h=cf(i,r,a[0]),f=p.type}else d=h=l?s[0]:s;var g=tw(t),m=g&&t.name||"",_=i.getName(r),y=n?m:_;return on("section",{header:m,noHeader:n||!g,sortParam:d,blocks:[on("nameValue",{markerType:"item",markerColor:u,name:y,noName:!ha(y),value:h,valueType:f,dataIndex:r})].concat(c||[])})}function V8(e,t,r,n,i){var a=t.getData(),o=ma(e,function(f,c,d){var v=a.getDimensionInfo(d);return f=f||v&&v.tooltip!==!1&&v.displayName!=null},!1),s=[],l=[],u=[];n.length?R(n,function(f){h(cf(a,r,f),f)}):R(e,h);function h(f,c){var d=a.getDimensionInfo(c);!d||d.otherDims.tooltip===!1||(o?u.push(on("nameValue",{markerType:"subItem",markerColor:i,name:d.displayName,value:f,valueType:d.type})):(s.push(f),l.push(d.type)))}return{inlineValues:s,inlineValueTypes:l,blocks:u}}var $o=Le();function gp(e,t){return e.getName(t)||e.getId(t)}var $g="__universalTransitionEnabled",Ue=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._selectedDataIndicesMap={},r}return t.prototype.init=function(r,n,i){this.seriesIndex=this.componentIndex,this.dataTask=Md({count:W8,reset:X8}),this.dataTask.context={model:this},this.mergeDefaultAndTheme(r,i);var a=$o(this).sourceManager=new rF(this);a.prepareSource();var o=this.getInitialData(r,i);M2(o,this),this.dataTask.context.data=o,$o(this).dataBeforeProcessed=o,w2(this),this._initSelectedMapFromData(o)},t.prototype.mergeDefaultAndTheme=function(r,n){var i=Hd(this),a=i?Wf(r):{},o=this.subType;me.hasClass(o)&&(o+="Series"),Ot(r,n.getTheme().get(this.subType)),Ot(r,this.getDefaultOption()),Su(r,"label",["show"]),this.fillDataTextStyle(r.data),i&&Bs(r,a,i)},t.prototype.mergeOption=function(r,n){r=Ot(this.option,r,!0),this.fillDataTextStyle(r.data);var i=Hd(this);i&&Bs(this.option,r,i);var a=$o(this).sourceManager;a.dirty(),a.prepareSource();var o=this.getInitialData(r,n);M2(o,this),this.dataTask.dirty(),this.dataTask.context.data=o,$o(this).dataBeforeProcessed=o,w2(this),this._initSelectedMapFromData(o)},t.prototype.fillDataTextStyle=function(r){if(r&&!fi(r))for(var n=["show"],i=0;i<r.length;i++)r[i]&&r[i].label&&Su(r[i],"label",n)},t.prototype.getInitialData=function(r,n){},t.prototype.appendData=function(r){var n=this.getRawData();n.appendData(r.data)},t.prototype.getData=function(r){var n=kS(this);if(n){var i=n.context.data;return r==null||!i.getLinkedData?i:i.getLinkedData(r)}else return $o(this).data},t.prototype.getAllData=function(){var r=this.getData();return r&&r.getLinkedDataAll?r.getLinkedDataAll():[{data:r}]},t.prototype.setData=function(r){var n=kS(this);if(n){var i=n.context;i.outputData=r,n!==this.dataTask&&(i.data=r)}$o(this).data=r},t.prototype.getEncode=function(){var r=this.get("encode",!0);if(r)return Ut(r)},t.prototype.getSourceManager=function(){return $o(this).sourceManager},t.prototype.getSource=function(){return this.getSourceManager().getSource()},t.prototype.getRawData=function(){return $o(this).dataBeforeProcessed},t.prototype.getColorBy=function(){var r=this.get("colorBy");return r||"series"},t.prototype.isColorBySeries=function(){return this.getColorBy()==="series"},t.prototype.getBaseAxis=function(){var r=this.coordinateSystem;return r&&r.getBaseAxis&&r.getBaseAxis()},t.prototype.formatTooltip=function(r,n,i){return hF({series:this,dataIndex:r,multipleSeries:n})},t.prototype.isAnimationEnabled=function(){var r=this.ecModel;if(ye.node&&!(r&&r.ssr))return!1;var n=this.getShallow("animation");return n&&this.getData().count()>this.getShallow("animationThreshold")&&(n=!1),!!n},t.prototype.restoreData=function(){this.dataTask.dirty()},t.prototype.getColorFromPalette=function(r,n,i){var a=this.ecModel,o=ww.prototype.getColorFromPalette.call(this,r,n,i);return o||(o=a.getColorFromPalette(r,n,i)),o},t.prototype.coordDimToDataDim=function(r){return this.getRawData().mapDimensionsAll(r)},t.prototype.getProgressive=function(){return this.get("progressive")},t.prototype.getProgressiveThreshold=function(){return this.get("progressiveThreshold")},t.prototype.select=function(r,n){this._innerSelect(this.getData(n),r)},t.prototype.unselect=function(r,n){var i=this.option.selectedMap;if(i){var a=this.option.selectedMode,o=this.getData(n);if(a==="series"||i==="all"){this.option.selectedMap={},this._selectedDataIndicesMap={};return}for(var s=0;s<r.length;s++){var l=r[s],u=gp(o,l);i[u]=!1,this._selectedDataIndicesMap[u]=-1}}},t.prototype.toggleSelect=function(r,n){for(var i=[],a=0;a<r.length;a++)i[0]=r[a],this.isSelected(r[a],n)?this.unselect(i,n):this.select(i,n)},t.prototype.getSelectedDataIndices=function(){if(this.option.selectedMap==="all")return[].slice.call(this.getData().getIndices());for(var r=this._selectedDataIndicesMap,n=be(r),i=[],a=0;a<n.length;a++){var o=r[n[a]];o>=0&&i.push(o)}return i},t.prototype.isSelected=function(r,n){var i=this.option.selectedMap;if(!i)return!1;var a=this.getData(n);return(i==="all"||i[gp(a,r)])&&!a.getItemModel(r).get(["select","disabled"])},t.prototype.isUniversalTransitionEnabled=function(){if(this[$g])return!0;var r=this.option.universalTransition;return r?r===!0?!0:r&&r.enabled:!1},t.prototype._innerSelect=function(r,n){var i,a,o=this.option,s=o.selectedMode,l=n.length;if(!(!s||!l)){if(s==="series")o.selectedMap="all";else if(s==="multiple"){Kt(o.selectedMap)||(o.selectedMap={});for(var u=o.selectedMap,h=0;h<l;h++){var f=n[h],c=gp(r,f);u[c]=!0,this._selectedDataIndicesMap[c]=r.getRawIndex(f)}}else if(s==="single"||s===!0){var d=n[l-1],c=gp(r,d);o.selectedMap=(i={},i[c]=!0,i),this._selectedDataIndicesMap=(a={},a[c]=r.getRawIndex(d),a)}}},t.prototype._initSelectedMapFromData=function(r){if(!this.option.selectedMap){var n=[];r.hasItemOption&&r.each(function(i){var a=r.getRawDataItem(i);a&&a.selected&&n.push(i)}),n.length>0&&this._innerSelect(r,n)}},t.registerClass=function(r){return me.registerClass(r)},t.protoInitialize=function(){var r=t.prototype;r.type="series.__base__",r.seriesIndex=0,r.ignoreStyleOnData=!1,r.hasSymbolVisual=!1,r.defaultSymbol="circle",r.visualStyleAccessPath="itemStyle",r.visualDrawType="fill"}(),t}(me);Nr(Ue,Y_);Nr(Ue,ww);NO(Ue,me);function w2(e){var t=e.name;tw(e)||(e.name=H8(e)||t)}function H8(e){var t=e.getRawData(),r=t.mapDimensionsAll("seriesName"),n=[];return R(r,function(i){var a=t.getDimensionInfo(i);a.displayName&&n.push(a.displayName)}),n.join(" ")}function W8(e){return e.model.getRawData().count()}function X8(e){var t=e.model;return t.setData(t.getRawData().cloneShallow()),Y8}function Y8(e,t){t.outputData&&e.end>t.outputData.count()&&t.model.getRawData().cloneShallow(t.outputData)}function M2(e,t){R(yu(e.CHANGABLE_METHODS,e.DOWNSAMPLE_METHODS),function(r){e.wrapMethod(r,ue(Z8,t))})}function Z8(e,t){var r=kS(e);return r&&r.setOutputEnd((t||this).count()),t}function kS(e){var t=(e.ecModel||{}).scheduler,r=t&&t.getPipeline(e.uid);if(r){var n=r.currentTask;if(n){var i=n.agentStubMap;i&&(n=i.get(e.uid))}return n}}var nr=function(){function e(){this.group=new re,this.uid=Vf("viewComponent")}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){},e.prototype.updateLayout=function(t,r,n,i){},e.prototype.updateVisual=function(t,r,n,i){},e.prototype.toggleBlurSeries=function(t,r,n){},e.prototype.eachRendered=function(t){var r=this.group;r&&r.traverse(t)},e}();rw(nr);C_(nr);function Zf(){var e=Le();return function(t){var r=e(t),n=t.pipelineContext,i=!!r.large,a=!!r.progressiveRender,o=r.large=!!(n&&n.large),s=r.progressiveRender=!!(n&&n.progressiveRender);return(i!==o||a!==s)&&"reset"}}var fF=Le(),q8=Zf(),De=function(){function e(){this.group=new re,this.uid=Vf("viewChart"),this.renderTask=Md({plan:$8,reset:K8}),this.renderTask.context={view:this}}return e.prototype.init=function(t,r){},e.prototype.render=function(t,r,n,i){},e.prototype.highlight=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&E2(a,i,"emphasis")},e.prototype.downplay=function(t,r,n,i){var a=t.getData(i&&i.dataType);a&&E2(a,i,"normal")},e.prototype.remove=function(t,r){this.group.removeAll()},e.prototype.dispose=function(t,r){},e.prototype.updateView=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateLayout=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.updateVisual=function(t,r,n,i){this.render(t,r,n,i)},e.prototype.eachRendered=function(t){Hs(this.group,t)},e.markUpdateMethod=function(t,r){fF(t).updateMethod=r},e.protoInitialize=function(){var t=e.prototype;t.type="chart"}(),e}();function A2(e,t,r){e&&kd(e)&&(t==="emphasis"?Po:Io)(e,r)}function E2(e,t,r){var n=Tu(e,t),i=t&&t.highlightKey!=null?RH(t.highlightKey):null;n!=null?R(er(n),function(a){A2(e.getItemGraphicEl(a),r,i)}):e.eachItemGraphicEl(function(a){A2(a,r,i)})}rw(De);C_(De);function $8(e){return q8(e.model)}function K8(e){var t=e.model,r=e.ecModel,n=e.api,i=e.payload,a=t.pipelineContext.progressiveRender,o=e.view,s=i&&fF(i).updateMethod,l=a?"incrementalPrepareRender":s&&o[s]?s:"render";return l!=="render"&&o[l](t,r,n,i),j8[l]}var j8={incrementalPrepareRender:{progress:function(e,t){t.view.incrementalRender(e,t.model,t.ecModel,t.api,t.payload)}},render:{forceFirstProgress:!0,progress:function(e,t){t.view.render(t.model,t.ecModel,t.api,t.payload)}}},Em="\0__throttleOriginMethod",C2="\0__throttleRate",D2="\0__throttleType";function Lw(e,t,r){var n,i=0,a=0,o=null,s,l,u,h;t=t||0;function f(){a=new Date().getTime(),o=null,e.apply(l,u||[])}var c=function(){for(var d=[],v=0;v<arguments.length;v++)d[v]=arguments[v];n=new Date().getTime(),l=this,u=d;var p=h||t,g=h||r;h=null,s=n-(g?i:a)-p,clearTimeout(o),g?o=setTimeout(f,p):s>=0?f():o=setTimeout(f,-s),i=n};return c.clear=function(){o&&(clearTimeout(o),o=null)},c.debounceNextCall=function(d){h=d},c}function qf(e,t,r,n){var i=e[t];if(i){var a=i[Em]||i,o=i[D2],s=i[C2];if(s!==r||o!==n){if(r==null||!n)return e[t]=a;i=e[t]=Lw(a,r,n==="debounce"),i[Em]=a,i[D2]=n,i[C2]=r}return i}}function Xd(e,t){var r=e[t];r&&r[Em]&&(r.clear&&r.clear(),e[t]=r[Em])}var L2=Le(),R2={itemStyle:bu(_3,!0),lineStyle:bu(m3,!0)},J8={lineStyle:"stroke",itemStyle:"fill"};function cF(e,t){var r=e.visualStyleMapper||R2[t];return r||(console.warn("Unknown style type '"+t+"'."),R2.itemStyle)}function dF(e,t){var r=e.visualDrawType||J8[t];return r||(console.warn("Unknown style type '"+t+"'."),"fill")}var Q8={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=e.getModel(n),a=cF(e,n),o=a(i),s=i.getShallow("decal");s&&(r.setVisual("decal",s),s.dirty=!0);var l=dF(e,n),u=o[l],h=Yt(u)?u:null,f=o.fill==="auto"||o.stroke==="auto";if(!o[l]||h||f){var c=e.getColorFromPalette(e.name,null,t.getSeriesCount());o[l]||(o[l]=c,r.setVisual("colorFromPalette",!0)),o.fill=o.fill==="auto"||Yt(o.fill)?c:o.fill,o.stroke=o.stroke==="auto"||Yt(o.stroke)?c:o.stroke}if(r.setVisual("style",o),r.setVisual("drawType",l),!t.isSeriesFiltered(e)&&h)return r.setVisual("colorFromPalette",!1),{dataEach:function(d,v){var p=e.getDataParams(v),g=rt({},o);g[l]=h(p),d.setItemVisual(v,"style",g)}}}},xc=new Ie,t6={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!(e.ignoreStyleOnData||t.isSeriesFiltered(e))){var r=e.getData(),n=e.visualStyleAccessPath||"itemStyle",i=cF(e,n),a=r.getVisual("drawType");return{dataEach:r.hasItemOption?function(o,s){var l=o.getRawDataItem(s);if(l&&l[n]){xc.option=l[n];var u=i(xc),h=o.ensureUniqueItemVisual(s,"style");rt(h,u),xc.option.decal&&(o.setItemVisual(s,"decal",xc.option.decal),xc.option.decal.dirty=!0),a in u&&o.setItemVisual(s,"colorFromPalette",!1)}}:null}}}},e6={performRawSeries:!0,overallReset:function(e){var t=Ut();e.eachSeries(function(r){var n=r.getColorBy();if(!r.isColorBySeries()){var i=r.type+"-"+n,a=t.get(i);a||(a={},t.set(i,a)),L2(r).scope=a}}),e.eachSeries(function(r){if(!(r.isColorBySeries()||e.isSeriesFiltered(r))){var n=r.getRawData(),i={},a=r.getData(),o=L2(r).scope,s=r.visualStyleAccessPath||"itemStyle",l=dF(r,s);a.each(function(u){var h=a.getRawIndex(u);i[h]=u}),n.each(function(u){var h=i[u],f=a.getItemVisual(h,"colorFromPalette");if(f){var c=a.ensureUniqueItemVisual(h,"style"),d=n.getName(u)||u+"",v=n.count();c[l]=r.getColorFromPalette(d,o,v)}})}})}},mp=Math.PI;function r6(e,t){t=t||{},Vt(t,{text:"loading",textColor:"#000",fontSize:12,fontWeight:"normal",fontStyle:"normal",fontFamily:"sans-serif",maskColor:"rgba(255, 255, 255, 0.8)",showSpinner:!0,color:"#5470c6",spinnerRadius:10,lineWidth:5,zlevel:0});var r=new re,n=new Ae({style:{fill:t.maskColor},zlevel:t.zlevel,z:1e4});r.add(n);var i=new we({style:{text:t.text,fill:t.textColor,fontSize:t.fontSize,fontWeight:t.fontWeight,fontStyle:t.fontStyle,fontFamily:t.fontFamily},zlevel:t.zlevel,z:10001}),a=new Ae({style:{fill:"none"},textContent:i,textConfig:{position:"right",distance:10},zlevel:t.zlevel,z:10001});r.add(a);var o;return t.showSpinner&&(o=new O_({shape:{startAngle:-mp/2,endAngle:-mp/2+.1,r:t.spinnerRadius},style:{stroke:t.color,lineCap:"round",lineWidth:t.lineWidth},zlevel:t.zlevel,z:10001}),o.animateShape(!0).when(1e3,{endAngle:mp*3/2}).start("circularInOut"),o.animateShape(!0).when(1e3,{startAngle:mp*3/2}).delay(300).start("circularInOut"),r.add(o)),r.resize=function(){var s=i.getBoundingRect().width,l=t.showSpinner?t.spinnerRadius:0,u=(e.getWidth()-l*2-(t.showSpinner&&s?10:0)-s)/2-(t.showSpinner&&s?0:5+s/2)+(t.showSpinner?0:s/2)+(s?0:l),h=e.getHeight()/2;t.showSpinner&&o.setShape({cx:u,cy:h}),a.setShape({x:u-l,y:h-l,width:l*2,height:l*2}),n.setShape({x:0,y:0,width:e.getWidth(),height:e.getHeight()})},r.resize(),r}var vF=function(){function e(t,r,n,i){this._stageTaskMap=Ut(),this.ecInstance=t,this.api=r,n=this._dataProcessorHandlers=n.slice(),i=this._visualHandlers=i.slice(),this._allHandlers=n.concat(i)}return e.prototype.restoreData=function(t,r){t.restoreData(r),this._stageTaskMap.each(function(n){var i=n.overallTask;i&&i.dirty()})},e.prototype.getPerformArgs=function(t,r){if(t.__pipeline){var n=this._pipelineMap.get(t.__pipeline.id),i=n.context,a=!r&&n.progressiveEnabled&&(!i||i.progressiveRender)&&t.__idxInPipeline>n.blockIndex,o=a?n.step:null,s=i&&i.modDataCount,l=s!=null?Math.ceil(s/o):null;return{step:o,modBy:l,modDataCount:s}}},e.prototype.getPipeline=function(t){return this._pipelineMap.get(t)},e.prototype.updateStreamModes=function(t,r){var n=this._pipelineMap.get(t.uid),i=t.getData(),a=i.count(),o=n.progressiveEnabled&&r.incrementalPrepareRender&&a>=n.threshold,s=t.get("large")&&a>=t.get("largeThreshold"),l=t.get("progressiveChunkMode")==="mod"?a:null;t.pipelineContext=n.context={progressiveRender:o,modDataCount:l,large:s}},e.prototype.restorePipelines=function(t){var r=this,n=r._pipelineMap=Ut();t.eachSeries(function(i){var a=i.getProgressive(),o=i.uid;n.set(o,{id:o,head:null,tail:null,threshold:i.getProgressiveThreshold(),progressiveEnabled:a&&!(i.preventIncremental&&i.preventIncremental()),blockIndex:-1,step:Math.round(a||700),count:0}),r._pipe(i,i.dataTask)})},e.prototype.prepareStageTasks=function(){var t=this._stageTaskMap,r=this.api.getModel(),n=this.api;R(this._allHandlers,function(i){var a=t.get(i.uid)||t.set(i.uid,{}),o="";Hn(!(i.reset&&i.overallReset),o),i.reset&&this._createSeriesStageTask(i,a,r,n),i.overallReset&&this._createOverallStageTask(i,a,r,n)},this)},e.prototype.prepareView=function(t,r,n,i){var a=t.renderTask,o=a.context;o.model=r,o.ecModel=n,o.api=i,a.__block=!t.incrementalPrepareRender,this._pipe(r,a)},e.prototype.performDataProcessorTasks=function(t,r){this._performStageTasks(this._dataProcessorHandlers,t,r,{block:!0})},e.prototype.performVisualTasks=function(t,r,n){this._performStageTasks(this._visualHandlers,t,r,n)},e.prototype._performStageTasks=function(t,r,n,i){i=i||{};var a=!1,o=this;R(t,function(l,u){if(!(i.visualType&&i.visualType!==l.visualType)){var h=o._stageTaskMap.get(l.uid),f=h.seriesTaskMap,c=h.overallTask;if(c){var d,v=c.agentStubMap;v.each(function(g){s(i,g)&&(g.dirty(),d=!0)}),d&&c.dirty(),o.updatePayload(c,n);var p=o.getPerformArgs(c,i.block);v.each(function(g){g.perform(p)}),c.perform(p)&&(a=!0)}else f&&f.each(function(g,m){s(i,g)&&g.dirty();var _=o.getPerformArgs(g,i.block);_.skip=!l.performRawSeries&&r.isSeriesFiltered(g.context.model),o.updatePayload(g,n),g.perform(_)&&(a=!0)})}});function s(l,u){return l.setDirty&&(!l.dirtyMap||l.dirtyMap.get(u.__pipeline.id))}this.unfinished=a||this.unfinished},e.prototype.performSeriesTasks=function(t){var r;t.eachSeries(function(n){r=n.dataTask.perform()||r}),this.unfinished=r||this.unfinished},e.prototype.plan=function(){this._pipelineMap.each(function(t){var r=t.tail;do{if(r.__block){t.blockIndex=r.__idxInPipeline;break}r=r.getUpstream()}while(r)})},e.prototype.updatePayload=function(t,r){r!=="remain"&&(t.context.payload=r)},e.prototype._createSeriesStageTask=function(t,r,n,i){var a=this,o=r.seriesTaskMap,s=r.seriesTaskMap=Ut(),l=t.seriesType,u=t.getTargetSeries;t.createOnAllSeries?n.eachRawSeries(h):l?n.eachRawSeriesByType(l,h):u&&u(n,i).each(h);function h(f){var c=f.uid,d=s.set(c,o&&o.get(c)||Md({plan:s6,reset:l6,count:h6}));d.context={model:f,ecModel:n,api:i,useClearVisual:t.isVisual&&!t.isLayout,plan:t.plan,reset:t.reset,scheduler:a},a._pipe(f,d)}},e.prototype._createOverallStageTask=function(t,r,n,i){var a=this,o=r.overallTask=r.overallTask||Md({reset:n6});o.context={ecModel:n,api:i,overallReset:t.overallReset,scheduler:a};var s=o.agentStubMap,l=o.agentStubMap=Ut(),u=t.seriesType,h=t.getTargetSeries,f=!0,c=!1,d="";Hn(!t.createOnAllSeries,d),u?n.eachRawSeriesByType(u,v):h?h(n,i).each(v):(f=!1,R(n.getSeries(),v));function v(p){var g=p.uid,m=l.set(g,s&&s.get(g)||(c=!0,Md({reset:i6,onDirty:o6})));m.context={model:p,overallProgress:f},m.agent=o,m.__block=f,a._pipe(p,m)}c&&o.dirty()},e.prototype._pipe=function(t,r){var n=t.uid,i=this._pipelineMap.get(n);!i.head&&(i.head=r),i.tail&&i.tail.pipe(r),i.tail=r,r.__idxInPipeline=i.count++,r.__pipeline=i},e.wrapStageHandler=function(t,r){return Yt(t)&&(t={overallReset:t,seriesType:f6(t)}),t.uid=Vf("stageHandler"),r&&(t.visualType=r),t},e}();function n6(e){e.overallReset(e.ecModel,e.api,e.payload)}function i6(e){return e.overallProgress&&a6}function a6(){this.agent.dirty(),this.getDownstream().dirty()}function o6(){this.agent&&this.agent.dirty()}function s6(e){return e.plan?e.plan(e.model,e.ecModel,e.api,e.payload):null}function l6(e){e.useClearVisual&&e.data.clearAllVisual();var t=e.resetDefines=er(e.reset(e.model,e.ecModel,e.api,e.payload));return t.length>1?ft(t,function(r,n){return pF(n)}):u6}var u6=pF(0);function pF(e){return function(t,r){var n=r.data,i=r.resetDefines[e];if(i&&i.dataEach)for(var a=t.start;a<t.end;a++)i.dataEach(n,a);else i&&i.progress&&i.progress(t,n)}}function h6(e){return e.data.count()}function f6(e){Cm=null;try{e(Yd,gF)}catch{}return Cm}var Yd={},gF={},Cm;mF(Yd,Mw);mF(gF,G3);Yd.eachSeriesByType=Yd.eachRawSeriesByType=function(e){Cm=e};Yd.eachComponent=function(e){e.mainType==="series"&&e.subType&&(Cm=e.subType)};function mF(e,t){for(var r in t.prototype)e[r]=Rr}var P2=["#37A2DA","#32C5E9","#67E0E3","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#E062AE","#E690D1","#e7bcf3","#9d96f5","#8378EA","#96BFFF"];const c6={color:P2,colorLayer:[["#37A2DA","#ffd85c","#fd7b5f"],["#37A2DA","#67E0E3","#FFDB5C","#ff9f7f","#E062AE","#9d96f5"],["#37A2DA","#32C5E9","#9FE6B8","#FFDB5C","#ff9f7f","#fb7293","#e7bcf3","#8378EA","#96BFFF"],P2]};var En="#B9B8CE",I2="#100C2A",_p=function(){return{axisLine:{lineStyle:{color:En}},splitLine:{lineStyle:{color:"#484753"}},splitArea:{areaStyle:{color:["rgba(255,255,255,0.02)","rgba(255,255,255,0.05)"]}},minorSplitLine:{lineStyle:{color:"#20203B"}}}},N2=["#4992ff","#7cffb2","#fddd60","#ff6e76","#58d9f9","#05c091","#ff8a45","#8d48e3","#dd79ff"],_F={darkMode:!0,color:N2,backgroundColor:I2,axisPointer:{lineStyle:{color:"#817f91"},crossStyle:{color:"#817f91"},label:{color:"#fff"}},legend:{textStyle:{color:En},pageTextStyle:{color:En}},textStyle:{color:En},title:{textStyle:{color:"#EEF1FA"},subtextStyle:{color:"#B9B8CE"}},toolbox:{iconStyle:{borderColor:En}},dataZoom:{borderColor:"#71708A",textStyle:{color:En},brushStyle:{color:"rgba(135,163,206,0.3)"},handleStyle:{color:"#353450",borderColor:"#C5CBE3"},moveHandleStyle:{color:"#B0B6C3",opacity:.3},fillerColor:"rgba(135,163,206,0.2)",emphasis:{handleStyle:{borderColor:"#91B7F2",color:"#4D587D"},moveHandleStyle:{color:"#636D9A",opacity:.7}},dataBackground:{lineStyle:{color:"#71708A",width:1},areaStyle:{color:"#71708A"}},selectedDataBackground:{lineStyle:{color:"#87A3CE"},areaStyle:{color:"#87A3CE"}}},visualMap:{textStyle:{color:En}},timeline:{lineStyle:{color:En},label:{color:En},controlStyle:{color:En,borderColor:En}},calendar:{itemStyle:{color:I2},dayLabel:{color:En},monthLabel:{color:En},yearLabel:{color:En}},timeAxis:_p(),logAxis:_p(),valueAxis:_p(),categoryAxis:_p(),line:{symbol:"circle"},graph:{color:N2},gauge:{title:{color:En},axisLine:{lineStyle:{color:[[1,"rgba(207,212,219,0.2)"]]}},axisLabel:{color:En},detail:{color:"#EEF1FA"}},candlestick:{itemStyle:{color:"#f64e56",color0:"#54ea92",borderColor:"#f64e56",borderColor0:"#54ea92"}}};_F.categoryAxis.splitLine.show=!1;var d6=function(){function e(){}return e.prototype.normalizeQuery=function(t){var r={},n={},i={};if(Ct(t)){var a=Fa(t);r.mainType=a.main||null,r.subType=a.sub||null}else{var o=["Index","Name","Id"],s={name:1,dataIndex:1,dataType:1};R(t,function(l,u){for(var h=!1,f=0;f<o.length;f++){var c=o[f],d=u.lastIndexOf(c);if(d>0&&d===u.length-c.length){var v=u.slice(0,d);v!=="data"&&(r.mainType=v,r[c.toLowerCase()]=l,h=!0)}}s.hasOwnProperty(u)&&(n[u]=l,h=!0),h||(i[u]=l)})}return{cptQuery:r,dataQuery:n,otherQuery:i}},e.prototype.filter=function(t,r){var n=this.eventInfo;if(!n)return!0;var i=n.targetEl,a=n.packedEvent,o=n.model,s=n.view;if(!o||!s)return!0;var l=r.cptQuery,u=r.dataQuery;return h(l,o,"mainType")&&h(l,o,"subType")&&h(l,o,"index","componentIndex")&&h(l,o,"name")&&h(l,o,"id")&&h(u,a,"name")&&h(u,a,"dataIndex")&&h(u,a,"dataType")&&(!s.filterForExposedEvent||s.filterForExposedEvent(t,r.otherQuery,i,a));function h(f,c,d,v){return f[d]==null||c[v||d]===f[d]}},e.prototype.afterTrigger=function(){this.eventInfo=null},e}(),GS=["symbol","symbolSize","symbolRotate","symbolOffset"],O2=GS.concat(["symbolKeepAspect"]),v6={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){var r=e.getData();if(e.legendIcon&&r.setVisual("legendIcon",e.legendIcon),!e.hasSymbolVisual)return;for(var n={},i={},a=!1,o=0;o<GS.length;o++){var s=GS[o],l=e.get(s);Yt(l)?(a=!0,i[s]=l):n[s]=l}if(n.symbol=n.symbol||e.defaultSymbol,r.setVisual(rt({legendIcon:e.legendIcon||n.symbol,symbolKeepAspect:e.get("symbolKeepAspect")},n)),t.isSeriesFiltered(e))return;var u=be(i);function h(f,c){for(var d=e.getRawValue(c),v=e.getDataParams(c),p=0;p<u.length;p++){var g=u[p];f.setItemVisual(c,g,i[g](d,v))}}return{dataEach:a?h:null}}},p6={createOnAllSeries:!0,performRawSeries:!0,reset:function(e,t){if(!e.hasSymbolVisual||t.isSeriesFiltered(e))return;var r=e.getData();function n(i,a){for(var o=i.getItemModel(a),s=0;s<O2.length;s++){var l=O2[s],u=o.getShallow(l,!0);u!=null&&i.setItemVisual(a,l,u)}}return{dataEach:r.hasItemOption?n:null}}};function Rw(e,t,r){switch(r){case"color":var n=e.getItemVisual(t,"style");return n[e.getVisual("drawType")];case"opacity":return e.getItemVisual(t,"style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getItemVisual(t,r)}}function Av(e,t){switch(t){case"color":var r=e.getVisual("style");return r[e.getVisual("drawType")];case"opacity":return e.getVisual("style").opacity;case"symbol":case"symbolSize":case"liftZ":return e.getVisual(t)}}function yF(e,t,r,n){switch(r){case"color":var i=e.ensureUniqueItemVisual(t,"style");i[e.getVisual("drawType")]=n,e.setItemVisual(t,"colorFromPalette",!1);break;case"opacity":e.ensureUniqueItemVisual(t,"style").opacity=n;break;case"symbol":case"symbolSize":case"liftZ":e.setItemVisual(t,r,n);break}}function xF(e,t){function r(n,i){var a=[];return n.eachComponent({mainType:"series",subType:e,query:i},function(o){a.push(o.seriesIndex)}),a}R([[e+"ToggleSelect","toggleSelect"],[e+"Select","select"],[e+"UnSelect","unselect"]],function(n){t(n[0],function(i,a,o){i=rt({},i),o.dispatchAction(rt(i,{type:n[1],seriesIndex:r(a,i)}))})})}function ih(e,t,r,n,i){var a=e+t;r.isSilent(a)||n.eachComponent({mainType:"series",subType:"pie"},function(o){for(var s=o.seriesIndex,l=o.option.selectedMap,u=i.selected,h=0;h<u.length;h++)if(u[h].seriesIndex===s){var f=o.getData(),c=Tu(f,i.fromActionPayload);r.trigger(a,{type:a,seriesId:o.id,name:at(c)?f.getName(c[0]):f.getName(c),selected:Ct(l)?l:rt({},l)})}})}function g6(e,t,r){e.on("selectchanged",function(n){var i=r.getModel();n.isFromClick?(ih("map","selectchanged",t,i,n),ih("pie","selectchanged",t,i,n)):n.fromAction==="select"?(ih("map","selected",t,i,n),ih("pie","selected",t,i,n)):n.fromAction==="unselect"&&(ih("map","unselected",t,i,n),ih("pie","unselected",t,i,n))})}function Ql(e,t,r){for(var n;e&&!(t(e)&&(n=e,r));)e=e.__hostTarget||e.parent;return n}var m6=Math.round(Math.random()*9),_6=typeof Object.defineProperty=="function",y6=function(){function e(){this._id="__ec_inner_"+m6++}return e.prototype.get=function(t){return this._guard(t)[this._id]},e.prototype.set=function(t,r){var n=this._guard(t);return _6?Object.defineProperty(n,this._id,{value:r,enumerable:!1,configurable:!0}):n[this._id]=r,this},e.prototype.delete=function(t){return this.has(t)?(delete this._guard(t)[this._id],!0):!1},e.prototype.has=function(t){return!!this._guard(t)[this._id]},e.prototype._guard=function(t){if(t!==Object(t))throw TypeError("Value of WeakMap is not a non-null object.");return t},e}(),x6=_e.extend({type:"triangle",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n+a),e.lineTo(r-i,n+a),e.closePath()}}),S6=_e.extend({type:"diamond",shape:{cx:0,cy:0,width:0,height:0},buildPath:function(e,t){var r=t.cx,n=t.cy,i=t.width/2,a=t.height/2;e.moveTo(r,n-a),e.lineTo(r+i,n),e.lineTo(r,n+a),e.lineTo(r-i,n),e.closePath()}}),T6=_e.extend({type:"pin",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.x,n=t.y,i=t.width/5*3,a=Math.max(i,t.height),o=i/2,s=o*o/(a-o),l=n-a+o+s,u=Math.asin(s/o),h=Math.cos(u)*o,f=Math.sin(u),c=Math.cos(u),d=o*.6,v=o*.7;e.moveTo(r-h,l+s),e.arc(r,l,o,Math.PI-u,Math.PI*2+u),e.bezierCurveTo(r+h-f*d,l+s+c*d,r,n-v,r,n),e.bezierCurveTo(r,n-v,r-h+f*d,l+s+c*d,r-h,l+s),e.closePath()}}),b6=_e.extend({type:"arrow",shape:{x:0,y:0,width:0,height:0},buildPath:function(e,t){var r=t.height,n=t.width,i=t.x,a=t.y,o=n/3*2;e.moveTo(i,a),e.lineTo(i+o,a+r),e.lineTo(i,a+r/4*3),e.lineTo(i-o,a+r),e.lineTo(i,a),e.closePath()}}),w6={line:jr,rect:Ae,roundRect:Ae,square:Ae,circle:Vo,diamond:S6,pin:T6,arrow:b6,triangle:x6},M6={line:function(e,t,r,n,i){i.x1=e,i.y1=t+n/2,i.x2=e+r,i.y2=t+n/2},rect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n},roundRect:function(e,t,r,n,i){i.x=e,i.y=t,i.width=r,i.height=n,i.r=Math.min(r,n)/4},square:function(e,t,r,n,i){var a=Math.min(r,n);i.x=e,i.y=t,i.width=a,i.height=a},circle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.r=Math.min(r,n)/2},diamond:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n},pin:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},arrow:function(e,t,r,n,i){i.x=e+r/2,i.y=t+n/2,i.width=r,i.height=n},triangle:function(e,t,r,n,i){i.cx=e+r/2,i.cy=t+n/2,i.width=r,i.height=n}},Dm={};R(w6,function(e,t){Dm[t]=new e});var A6=_e.extend({type:"symbol",shape:{symbolType:"",x:0,y:0,width:0,height:0},calculateTextPosition:function(e,t,r){var n=mm(e,t,r),i=this.shape;return i&&i.symbolType==="pin"&&t.position==="inside"&&(n.y=r.y+r.height*.4),n},buildPath:function(e,t,r){var n=t.symbolType;if(n!=="none"){var i=Dm[n];i||(n="rect",i=Dm[n]),M6[n](t.x,t.y,t.width,t.height,i.shape),i.buildPath(e,i.shape,r)}}});function E6(e,t){if(this.type!=="image"){var r=this.style;this.__isEmptyBrush?(r.stroke=e,r.fill=t||"#fff",r.lineWidth=2):this.shape.symbolType==="line"?r.stroke=e:r.fill=e,this.markRedraw()}}function Pr(e,t,r,n,i,a,o){var s=e.indexOf("empty")===0;s&&(e=e.substr(5,1).toLowerCase()+e.substr(6));var l;return e.indexOf("image://")===0?l=u3(e.slice(8),new fe(t,r,n,i),o?"center":"cover"):e.indexOf("path://")===0?l=F_(e.slice(7),{},new fe(t,r,n,i),o?"center":"cover"):l=new A6({shape:{symbolType:e,x:t,y:r,width:n,height:i}}),l.__isEmptyBrush=s,l.setColor=E6,a&&l.setColor(a),l}function $f(e){return at(e)||(e=[+e,+e]),[e[0]||0,e[1]||0]}function ku(e,t){if(e!=null)return at(e)||(e=[e,e]),[Tt(e[0],t[0])||0,Tt(se(e[1],e[0]),t[1])||0]}function tu(e){return isFinite(e)}function C6(e,t,r){var n=t.x==null?0:t.x,i=t.x2==null?1:t.x2,a=t.y==null?0:t.y,o=t.y2==null?0:t.y2;t.global||(n=n*r.width+r.x,i=i*r.width+r.x,a=a*r.height+r.y,o=o*r.height+r.y),n=tu(n)?n:0,i=tu(i)?i:1,a=tu(a)?a:0,o=tu(o)?o:0;var s=e.createLinearGradient(n,a,i,o);return s}function D6(e,t,r){var n=r.width,i=r.height,a=Math.min(n,i),o=t.x==null?.5:t.x,s=t.y==null?.5:t.y,l=t.r==null?.5:t.r;t.global||(o=o*n+r.x,s=s*i+r.y,l=l*a),o=tu(o)?o:.5,s=tu(s)?s:.5,l=l>=0&&tu(l)?l:.5;var u=e.createRadialGradient(o,s,0,o,s,l);return u}function VS(e,t,r){for(var n=t.type==="radial"?D6(e,t,r):C6(e,t,r),i=t.colorStops,a=0;a<i.length;a++)n.addColorStop(i[a].offset,i[a].color);return n}function L6(e,t){if(e===t||!e&&!t)return!1;if(!e||!t||e.length!==t.length)return!0;for(var r=0;r<e.length;r++)if(e[r]!==t[r])return!0;return!1}function yp(e){return parseInt(e,10)}function Yh(e,t,r){var n=["width","height"][t],i=["clientWidth","clientHeight"][t],a=["paddingLeft","paddingTop"][t],o=["paddingRight","paddingBottom"][t];if(r[n]!=null&&r[n]!=="auto")return parseFloat(r[n]);var s=document.defaultView.getComputedStyle(e);return(e[i]||yp(s[n])||yp(e.style[n]))-(yp(s[a])||0)-(yp(s[o])||0)|0}function R6(e,t){return!e||e==="solid"||!(t>0)?null:e==="dashed"?[4*t,2*t]:e==="dotted"?[t]:Be(e)?[e]:at(e)?e:null}function Pw(e){var t=e.style,r=t.lineDash&&t.lineWidth>0&&R6(t.lineDash,t.lineWidth),n=t.lineDashOffset;if(r){var i=t.strokeNoScale&&e.getLineScale?e.getLineScale():1;i&&i!==1&&(r=ft(r,function(a){return a/i}),n/=i)}return[r,n]}var P6=new Ka(!0);function Lm(e){var t=e.stroke;return!(t==null||t==="none"||!(e.lineWidth>0))}function F2(e){return typeof e=="string"&&e!=="none"}function Rm(e){var t=e.fill;return t!=null&&t!=="none"}function B2(e,t){if(t.fillOpacity!=null&&t.fillOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.fillOpacity*t.opacity,e.fill(),e.globalAlpha=r}else e.fill()}function U2(e,t){if(t.strokeOpacity!=null&&t.strokeOpacity!==1){var r=e.globalAlpha;e.globalAlpha=t.strokeOpacity*t.opacity,e.stroke(),e.globalAlpha=r}else e.stroke()}function HS(e,t,r){var n=nw(t.image,t.__image,r);if(D_(n)){var i=e.createPattern(n,t.repeat||"repeat");if(typeof DOMMatrix=="function"&&i&&i.setTransform){var a=new DOMMatrix;a.translateSelf(t.x||0,t.y||0),a.rotateSelf(0,0,(t.rotation||0)*Og),a.scaleSelf(t.scaleX||1,t.scaleY||1),i.setTransform(a)}return i}}function I6(e,t,r,n){var i,a=Lm(r),o=Rm(r),s=r.strokePercent,l=s<1,u=!t.path;(!t.silent||l)&&u&&t.createPathProxy();var h=t.path||P6,f=t.__dirty;if(!n){var c=r.fill,d=r.stroke,v=o&&!!c.colorStops,p=a&&!!d.colorStops,g=o&&!!c.image,m=a&&!!d.image,_=void 0,y=void 0,x=void 0,T=void 0,S=void 0;(v||p)&&(S=t.getBoundingRect()),v&&(_=f?VS(e,c,S):t.__canvasFillGradient,t.__canvasFillGradient=_),p&&(y=f?VS(e,d,S):t.__canvasStrokeGradient,t.__canvasStrokeGradient=y),g&&(x=f||!t.__canvasFillPattern?HS(e,c,t):t.__canvasFillPattern,t.__canvasFillPattern=x),m&&(T=f||!t.__canvasStrokePattern?HS(e,d,t):t.__canvasStrokePattern,t.__canvasStrokePattern=x),v?e.fillStyle=_:g&&(x?e.fillStyle=x:o=!1),p?e.strokeStyle=y:m&&(T?e.strokeStyle=T:a=!1)}var M=t.getGlobalScale();h.setScale(M[0],M[1],t.segmentIgnoreThreshold);var w,b;e.setLineDash&&r.lineDash&&(i=Pw(t),w=i[0],b=i[1]);var A=!0;(u||f&Jc)&&(h.setDPR(e.dpr),l?h.setContext(null):(h.setContext(e),A=!1),h.reset(),t.buildPath(h,t.shape,n),h.toStatic(),t.pathUpdated()),A&&h.rebuildPath(e,l?s:1),w&&(e.setLineDash(w),e.lineDashOffset=b),n||(r.strokeFirst?(a&&U2(e,r),o&&B2(e,r)):(o&&B2(e,r),a&&U2(e,r))),w&&e.setLineDash([])}function N6(e,t,r){var n=t.__image=nw(r.image,t.__image,t,t.onload);if(!(!n||!D_(n))){var i=r.x||0,a=r.y||0,o=t.getWidth(),s=t.getHeight(),l=n.width/n.height;if(o==null&&s!=null?o=s*l:s==null&&o!=null?s=o/l:o==null&&s==null&&(o=n.width,s=n.height),r.sWidth&&r.sHeight){var u=r.sx||0,h=r.sy||0;e.drawImage(n,u,h,r.sWidth,r.sHeight,i,a,o,s)}else if(r.sx&&r.sy){var u=r.sx,h=r.sy,f=o-u,c=s-h;e.drawImage(n,u,h,f,c,i,a,o,s)}else e.drawImage(n,i,a,o,s)}}function O6(e,t,r){var n,i=r.text;if(i!=null&&(i+=""),i){e.font=r.font||Is,e.textAlign=r.textAlign,e.textBaseline=r.textBaseline;var a=void 0,o=void 0;e.setLineDash&&r.lineDash&&(n=Pw(t),a=n[0],o=n[1]),a&&(e.setLineDash(a),e.lineDashOffset=o),r.strokeFirst?(Lm(r)&&e.strokeText(i,r.x,r.y),Rm(r)&&e.fillText(i,r.x,r.y)):(Rm(r)&&e.fillText(i,r.x,r.y),Lm(r)&&e.strokeText(i,r.x,r.y)),a&&e.setLineDash([])}}var z2=["shadowBlur","shadowOffsetX","shadowOffsetY"],k2=[["lineCap","butt"],["lineJoin","miter"],["miterLimit",10]];function SF(e,t,r,n,i){var a=!1;if(!n&&(r=r||{},t===r))return!1;if(n||t.opacity!==r.opacity){ai(e,i),a=!0;var o=Math.max(Math.min(t.opacity,1),0);e.globalAlpha=isNaN(o)?hu.opacity:o}(n||t.blend!==r.blend)&&(a||(ai(e,i),a=!0),e.globalCompositeOperation=t.blend||hu.blend);for(var s=0;s<z2.length;s++){var l=z2[s];(n||t[l]!==r[l])&&(a||(ai(e,i),a=!0),e[l]=e.dpr*(t[l]||0))}return(n||t.shadowColor!==r.shadowColor)&&(a||(ai(e,i),a=!0),e.shadowColor=t.shadowColor||hu.shadowColor),a}function G2(e,t,r,n,i){var a=Zd(t,i.inHover),o=n?null:r&&Zd(r,i.inHover)||{};if(a===o)return!1;var s=SF(e,a,o,n,i);if((n||a.fill!==o.fill)&&(s||(ai(e,i),s=!0),F2(a.fill)&&(e.fillStyle=a.fill)),(n||a.stroke!==o.stroke)&&(s||(ai(e,i),s=!0),F2(a.stroke)&&(e.strokeStyle=a.stroke)),(n||a.opacity!==o.opacity)&&(s||(ai(e,i),s=!0),e.globalAlpha=a.opacity==null?1:a.opacity),t.hasStroke()){var l=a.lineWidth,u=l/(a.strokeNoScale&&t.getLineScale?t.getLineScale():1);e.lineWidth!==u&&(s||(ai(e,i),s=!0),e.lineWidth=u)}for(var h=0;h<k2.length;h++){var f=k2[h],c=f[0];(n||a[c]!==o[c])&&(s||(ai(e,i),s=!0),e[c]=a[c]||f[1])}return s}function F6(e,t,r,n,i){return SF(e,Zd(t,i.inHover),r&&Zd(r,i.inHover),n,i)}function TF(e,t){var r=t.transform,n=e.dpr||1;r?e.setTransform(n*r[0],n*r[1],n*r[2],n*r[3],n*r[4],n*r[5]):e.setTransform(n,0,0,n,0,0)}function B6(e,t,r){for(var n=!1,i=0;i<e.length;i++){var a=e[i];n=n||a.isZeroArea(),TF(t,a),t.beginPath(),a.buildPath(t,a.shape),t.clip()}r.allClipped=n}function U6(e,t){return e&&t?e[0]!==t[0]||e[1]!==t[1]||e[2]!==t[2]||e[3]!==t[3]||e[4]!==t[4]||e[5]!==t[5]:!(!e&&!t)}var V2=1,H2=2,W2=3,X2=4;function z6(e){var t=Rm(e),r=Lm(e);return!(e.lineDash||!(+t^+r)||t&&typeof e.fill!="string"||r&&typeof e.stroke!="string"||e.strokePercent<1||e.strokeOpacity<1||e.fillOpacity<1)}function ai(e,t){t.batchFill&&e.fill(),t.batchStroke&&e.stroke(),t.batchFill="",t.batchStroke=""}function Zd(e,t){return t&&e.__hoverStyle||e.style}function q_(e,t){eu(e,t,{inHover:!1,viewWidth:0,viewHeight:0},!0)}function eu(e,t,r,n){var i=t.transform;if(!t.shouldBePainted(r.viewWidth,r.viewHeight,!1,!1)){t.__dirty&=-2,t.__isRendered=!1;return}var a=t.__clipPaths,o=r.prevElClipPaths,s=!1,l=!1;if((!o||L6(a,o))&&(o&&o.length&&(ai(e,r),e.restore(),l=s=!0,r.prevElClipPaths=null,r.allClipped=!1,r.prevEl=null),a&&a.length&&(ai(e,r),e.save(),B6(a,e,r),s=!0),r.prevElClipPaths=a),r.allClipped){t.__isRendered=!1;return}t.beforeBrush&&t.beforeBrush(),t.innerBeforeBrush();var u=r.prevEl;u||(l=s=!0);var h=t instanceof _e&&t.autoBatch&&z6(t.style);s||U6(i,u.transform)?(ai(e,r),TF(e,t)):h||ai(e,r);var f=Zd(t,r.inHover);t instanceof _e?(r.lastDrawType!==V2&&(l=!0,r.lastDrawType=V2),G2(e,t,u,l,r),(!h||!r.batchFill&&!r.batchStroke)&&e.beginPath(),I6(e,t,f,h),h&&(r.batchFill=f.fill||"",r.batchStroke=f.stroke||"")):t instanceof hf?(r.lastDrawType!==W2&&(l=!0,r.lastDrawType=W2),G2(e,t,u,l,r),O6(e,t,f)):t instanceof hn?(r.lastDrawType!==H2&&(l=!0,r.lastDrawType=H2),F6(e,t,u,l,r),N6(e,t,f)):t.getTemporalDisplayables&&(r.lastDrawType!==X2&&(l=!0,r.lastDrawType=X2),k6(e,t,r)),h&&n&&ai(e,r),t.innerAfterBrush(),t.afterBrush&&t.afterBrush(),r.prevEl=t,t.__dirty=0,t.__isRendered=!0}function k6(e,t,r){var n=t.getDisplayables(),i=t.getTemporalDisplayables();e.save();var a={prevElClipPaths:null,prevEl:null,allClipped:!1,viewWidth:r.viewWidth,viewHeight:r.viewHeight,inHover:r.inHover},o,s;for(o=t.getCursor(),s=n.length;o<s;o++){var l=n[o];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),eu(e,l,a,o===s-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}for(var u=0,h=i.length;u<h;u++){var l=i[u];l.beforeBrush&&l.beforeBrush(),l.innerBeforeBrush(),eu(e,l,a,u===h-1),l.innerAfterBrush(),l.afterBrush&&l.afterBrush(),a.prevEl=l}t.clearTemporalDisplayables(),t.notClear=!0,e.restore()}var gy=new y6,Y2=new Bf(100),Z2=["symbol","symbolSize","symbolKeepAspect","color","backgroundColor","dashArrayX","dashArrayY","maxTileWidth","maxTileHeight"];function df(e,t){if(e==="none")return null;var r=t.getDevicePixelRatio(),n=t.getZr(),i=n.painter.type==="svg";e.dirty&&gy.delete(e);var a=gy.get(e);if(a)return a;var o=Vt(e,{symbol:"rect",symbolSize:1,symbolKeepAspect:!0,color:"rgba(0, 0, 0, 0.2)",backgroundColor:null,dashArrayX:5,dashArrayY:5,rotation:0,maxTileWidth:512,maxTileHeight:512});o.backgroundColor==="none"&&(o.backgroundColor=null);var s={repeat:"repeat"};return l(s),s.rotation=o.rotation,s.scaleX=s.scaleY=i?1:1/r,gy.set(e,s),e.dirty=!1,s;function l(u){for(var h=[r],f=!0,c=0;c<Z2.length;++c){var d=o[Z2[c]];if(d!=null&&!at(d)&&!Ct(d)&&!Be(d)&&typeof d!="boolean"){f=!1;break}h.push(d)}var v;if(f){v=h.join(",")+(i?"-svg":"");var p=Y2.get(v);p&&(i?u.svgElement=p:u.image=p)}var g=wF(o.dashArrayX),m=G6(o.dashArrayY),_=bF(o.symbol),y=V6(g),x=MF(m),T=!i&&Ns.createCanvas(),S=i&&{tag:"g",attrs:{},key:"dcl",children:[]},M=b(),w;T&&(T.width=M.width*r,T.height=M.height*r,w=T.getContext("2d")),A(),f&&Y2.put(v,T||S),u.image=T,u.svgElement=S,u.svgWidth=M.width,u.svgHeight=M.height;function b(){for(var E=1,C=0,D=y.length;C<D;++C)E=hE(E,y[C]);for(var L=1,C=0,D=_.length;C<D;++C)L=hE(L,_[C].length);E*=L;var P=x*y.length*_.length;return{width:Math.max(1,Math.min(E,o.maxTileWidth)),height:Math.max(1,Math.min(P,o.maxTileHeight))}}function A(){w&&(w.clearRect(0,0,T.width,T.height),o.backgroundColor&&(w.fillStyle=o.backgroundColor,w.fillRect(0,0,T.width,T.height)));for(var E=0,C=0;C<m.length;++C)E+=m[C];if(E<=0)return;for(var D=-x,L=0,P=0,N=0;D<M.height;){if(L%2===0){for(var O=P/2%_.length,I=0,k=0,z=0;I<M.width*2;){for(var X=0,C=0;C<g[N].length;++C)X+=g[N][C];if(X<=0)break;if(k%2===0){var Y=(1-o.symbolSize)*.5,$=I+g[N][k]*Y,H=D+m[L]*Y,Z=g[N][k]*o.symbolSize,ct=m[L]*o.symbolSize,ut=z/2%_[O].length;tt($,H,Z,ct,_[O][ut])}I+=g[N][k],++z,++k,k===g[N].length&&(k=0)}++N,N===g.length&&(N=0)}D+=m[L],++P,++L,L===m.length&&(L=0)}function tt(et,st,nt,dt,At){var G=i?1:r,Dt=Pr(At,et*G,st*G,nt*G,dt*G,o.color,o.symbolKeepAspect);if(i){var Pt=n.painter.renderOneToVNode(Dt);Pt&&S.children.push(Pt)}else q_(w,Dt)}}}}function bF(e){if(!e||e.length===0)return[["rect"]];if(Ct(e))return[[e]];for(var t=!0,r=0;r<e.length;++r)if(!Ct(e[r])){t=!1;break}if(t)return bF([e]);for(var n=[],r=0;r<e.length;++r)Ct(e[r])?n.push([e[r]]):n.push(e[r]);return n}function wF(e){if(!e||e.length===0)return[[0,0]];if(Be(e)){var t=Math.ceil(e);return[[t,t]]}for(var r=!0,n=0;n<e.length;++n)if(!Be(e[n])){r=!1;break}if(r)return wF([e]);for(var i=[],n=0;n<e.length;++n)if(Be(e[n])){var t=Math.ceil(e[n]);i.push([t,t])}else{var t=ft(e[n],function(s){return Math.ceil(s)});t.length%2===1?i.push(t.concat(t)):i.push(t)}return i}function G6(e){if(!e||typeof e=="object"&&e.length===0)return[0,0];if(Be(e)){var t=Math.ceil(e);return[t,t]}var r=ft(e,function(n){return Math.ceil(n)});return e.length%2?r.concat(r):r}function V6(e){return ft(e,function(t){return MF(t)})}function MF(e){for(var t=0,r=0;r<e.length;++r)t+=e[r];return e.length%2===1?t*2:t}function H6(e,t){e.eachRawSeries(function(r){if(!e.isSeriesFiltered(r)){var n=r.getData();n.hasItemVisual()&&n.each(function(o){var s=n.getItemVisual(o,"decal");if(s){var l=n.ensureUniqueItemVisual(o,"style");l.decal=df(s,t)}});var i=n.getVisual("decal");if(i){var a=n.getVisual("style");a.decal=df(i,t)}}})}var sa=new Zi,AF={};function W6(e,t){AF[e]=t}function EF(e){return AF[e]}var X6=1,Y6=800,Z6=900,q6=1e3,$6=2e3,K6=5e3,CF=1e3,j6=1100,Iw=2e3,DF=3e3,J6=4e3,$_=4500,Q6=4600,tX=5e3,eX=6e3,LF=7e3,rX={PROCESSOR:{FILTER:q6,SERIES_FILTER:Y6,STATISTIC:K6},VISUAL:{LAYOUT:CF,PROGRESSIVE_LAYOUT:j6,GLOBAL:Iw,CHART:DF,POST_CHART_LAYOUT:Q6,COMPONENT:J6,BRUSH:tX,CHART_ITEM:$_,ARIA:eX,DECAL:LF}},wn="__flagInMainProcess",Qn="__pendingUpdate",my="__needsUpdateStatus",q2=/^[a-zA-Z0-9_]+$/,_y="__connectUpdateStatus",$2=0,nX=1,iX=2;function RF(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];if(this.isDisposed()){this.id;return}return IF(this,e,t)}}function PF(e){return function(){for(var t=[],r=0;r<arguments.length;r++)t[r]=arguments[r];return IF(this,e,t)}}function IF(e,t,r){return r[0]=r[0]&&r[0].toLowerCase(),Zi.prototype[t].apply(e,r)}var NF=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(Zi),OF=NF.prototype;OF.on=PF("on");OF.off=PF("off");var ah,yy,xp,Ko,xy,Sy,Ty,Sc,Tc,K2,j2,by,J2,Sp,Q2,FF,Si,tC,BF=function(e){q(t,e);function t(r,n,i){var a=e.call(this,new d6)||this;a._chartsViews=[],a._chartsMap={},a._componentsViews=[],a._componentsMap={},a._pendingActions=[],i=i||{},Ct(n)&&(n=UF[n]),a._dom=r;var o="canvas",s="auto",l=!1;i.ssr&&t5(function(c){var d=oe(c),v=d.dataIndex;if(v!=null){var p=Ut();return p.set("series_index",d.seriesIndex),p.set("data_index",v),d.ssrType&&p.set("ssr_type",d.ssrType),p}});var u=a._zr=_S(r,{renderer:i.renderer||o,devicePixelRatio:i.devicePixelRatio,width:i.width,height:i.height,ssr:i.ssr,useDirtyRect:se(i.useDirtyRect,l),useCoarsePointer:se(i.useCoarsePointer,s),pointerSize:i.pointerSize});a._ssr=i.ssr,a._throttledZrFlush=Lw(It(u.flush,u),17),n=Qt(n),n&&H3(n,!0),a._theme=n,a._locale=wW(i.locale||y3),a._coordSysMgr=new Yf;var h=a._api=Q2(a);function f(c,d){return c.__prio-d.__prio}return Ug(Im,f),Ug(WS,f),a._scheduler=new vF(a,h,WS,Im),a._messageCenter=new NF,a._initEvents(),a.resize=It(a.resize,a),u.animation.on("frame",a._onframe,a),K2(u,a),j2(u,a),fm(a),a}return t.prototype._onframe=function(){if(!this._disposed){tC(this);var r=this._scheduler;if(this[Qn]){var n=this[Qn].silent;this[wn]=!0;try{ah(this),Ko.update.call(this,null,this[Qn].updateParams)}catch(l){throw this[wn]=!1,this[Qn]=null,l}this._zr.flush(),this[wn]=!1,this[Qn]=null,Sc.call(this,n),Tc.call(this,n)}else if(r.unfinished){var i=X6,a=this._model,o=this._api;r.unfinished=!1;do{var s=+new Date;r.performSeriesTasks(a),r.performDataProcessorTasks(a),Sy(this,a),r.performVisualTasks(a),Sp(this,this._model,o,"remain",{}),i-=+new Date-s}while(i>0&&r.unfinished);r.unfinished||this._zr.flush()}}},t.prototype.getDom=function(){return this._dom},t.prototype.getId=function(){return this.id},t.prototype.getZr=function(){return this._zr},t.prototype.isSSR=function(){return this._ssr},t.prototype.setOption=function(r,n,i){if(!this[wn]){if(this._disposed){this.id;return}var a,o,s;if(Kt(n)&&(i=n.lazyUpdate,a=n.silent,o=n.replaceMerge,s=n.transition,n=n.notMerge),this[wn]=!0,!this._model||n){var l=new $W(this._api),u=this._theme,h=this._model=new Mw;h.scheduler=this._scheduler,h.ssr=this._ssr,h.init(null,null,null,u,this._locale,l)}this._model.setOption(r,{replaceMerge:o},XS);var f={seriesTransition:s,optionChanged:!0};if(i)this[Qn]={silent:a,updateParams:f},this[wn]=!1,this.getZr().wakeUp();else{try{ah(this),Ko.update.call(this,null,f)}catch(c){throw this[Qn]=null,this[wn]=!1,c}this._ssr||this._zr.flush(),this[Qn]=null,this[wn]=!1,Sc.call(this,a),Tc.call(this,a)}}},t.prototype.setTheme=function(){},t.prototype.getModel=function(){return this._model},t.prototype.getOption=function(){return this._model&&this._model.getOption()},t.prototype.getWidth=function(){return this._zr.getWidth()},t.prototype.getHeight=function(){return this._zr.getHeight()},t.prototype.getDevicePixelRatio=function(){return this._zr.painter.dpr||ye.hasGlobalWindow&&window.devicePixelRatio||1},t.prototype.getRenderedCanvas=function(r){return this.renderToCanvas(r)},t.prototype.renderToCanvas=function(r){r=r||{};var n=this._zr.painter;return n.getRenderedCanvas({backgroundColor:r.backgroundColor||this._model.get("backgroundColor"),pixelRatio:r.pixelRatio||this.getDevicePixelRatio()})},t.prototype.renderToSVGString=function(r){r=r||{};var n=this._zr.painter;return n.renderToString({useViewBox:r.useViewBox})},t.prototype.getSvgDataURL=function(){if(ye.svgSupported){var r=this._zr,n=r.storage.getDisplayList();return R(n,function(i){i.stopAnimation(null,!0)}),r.painter.toDataURL()}},t.prototype.getDataURL=function(r){if(this._disposed){this.id;return}r=r||{};var n=r.excludeComponents,i=this._model,a=[],o=this;R(n,function(l){i.eachComponent({mainType:l},function(u){var h=o._componentsMap[u.__viewId];h.group.ignore||(a.push(h),h.group.ignore=!0)})});var s=this._zr.painter.getType()==="svg"?this.getSvgDataURL():this.renderToCanvas(r).toDataURL("image/"+(r&&r.type||"png"));return R(a,function(l){l.group.ignore=!1}),s},t.prototype.getConnectedDataURL=function(r){if(this._disposed){this.id;return}var n=r.type==="svg",i=this.group,a=Math.min,o=Math.max,s=1/0;if(eC[i]){var l=s,u=s,h=-s,f=-s,c=[],d=r&&r.pixelRatio||this.getDevicePixelRatio();R(Ed,function(y,x){if(y.group===i){var T=n?y.getZr().painter.getSvgDom().innerHTML:y.renderToCanvas(Qt(r)),S=y.getDom().getBoundingClientRect();l=a(S.left,l),u=a(S.top,u),h=o(S.right,h),f=o(S.bottom,f),c.push({dom:T,left:S.left,top:S.top})}}),l*=d,u*=d,h*=d,f*=d;var v=h-l,p=f-u,g=Ns.createCanvas(),m=_S(g,{renderer:n?"svg":"canvas"});if(m.resize({width:v,height:p}),n){var _="";return R(c,function(y){var x=y.left-l,T=y.top-u;_+='<g transform="translate('+x+","+T+')">'+y.dom+"</g>"}),m.painter.getSvgRoot().innerHTML=_,r.connectedBackgroundColor&&m.painter.setBackgroundColor(r.connectedBackgroundColor),m.refreshImmediately(),m.painter.toDataURL()}else return r.connectedBackgroundColor&&m.add(new Ae({shape:{x:0,y:0,width:v,height:p},style:{fill:r.connectedBackgroundColor}})),R(c,function(y){var x=new hn({style:{x:y.left*d-l,y:y.top*d-u,image:y.dom}});m.add(x)}),m.refreshImmediately(),g.toDataURL("image/"+(r&&r.type||"png"))}else return this.getDataURL(r)},t.prototype.convertToPixel=function(r,n){return xy(this,"convertToPixel",r,n)},t.prototype.convertFromPixel=function(r,n){return xy(this,"convertFromPixel",r,n)},t.prototype.containPixel=function(r,n){if(this._disposed){this.id;return}var i=this._model,a,o=xd(i,r);return R(o,function(s,l){l.indexOf("Models")>=0&&R(s,function(u){var h=u.coordinateSystem;if(h&&h.containPoint)a=a||!!h.containPoint(n);else if(l==="seriesModels"){var f=this._chartsMap[u.__viewId];f&&f.containPoint&&(a=a||f.containPoint(n,u))}},this)},this),!!a},t.prototype.getVisual=function(r,n){var i=this._model,a=xd(i,r,{defaultMainType:"series"}),o=a.seriesModel,s=o.getData(),l=a.hasOwnProperty("dataIndexInside")?a.dataIndexInside:a.hasOwnProperty("dataIndex")?s.indexOfRawIndex(a.dataIndex):null;return l!=null?Rw(s,l,n):Av(s,n)},t.prototype.getViewOfComponentModel=function(r){return this._componentsMap[r.__viewId]},t.prototype.getViewOfSeriesModel=function(r){return this._chartsMap[r.__viewId]},t.prototype._initEvents=function(){var r=this;R(aX,function(n){var i=function(a){var o=r.getModel(),s=a.target,l,u=n==="globalout";if(u?l={}:s&&Ql(s,function(v){var p=oe(v);if(p&&p.dataIndex!=null){var g=p.dataModel||o.getSeriesByIndex(p.seriesIndex);return l=g&&g.getDataParams(p.dataIndex,p.dataType,s)||{},!0}else if(p.eventData)return l=rt({},p.eventData),!0},!0),l){var h=l.componentType,f=l.componentIndex;(h==="markLine"||h==="markPoint"||h==="markArea")&&(h="series",f=l.seriesIndex);var c=h&&f!=null&&o.getComponent(h,f),d=c&&r[c.mainType==="series"?"_chartsMap":"_componentsMap"][c.__viewId];l.event=a,l.type=n,r._$eventProcessor.eventInfo={targetEl:s,packedEvent:l,model:c,view:d},r.trigger(n,l)}};i.zrEventfulCallAtLast=!0,r._zr.on(n,i,r)}),R(Ad,function(n,i){r._messageCenter.on(i,function(a){this.trigger(i,a)},r)}),R(["selectchanged"],function(n){r._messageCenter.on(n,function(i){this.trigger(n,i)},r)}),g6(this._messageCenter,this,this._api)},t.prototype.isDisposed=function(){return this._disposed},t.prototype.clear=function(){if(this._disposed){this.id;return}this.setOption({series:[]},!0)},t.prototype.dispose=function(){if(this._disposed){this.id;return}this._disposed=!0;var r=this.getDom();r&&RO(this.getDom(),Ow,"");var n=this,i=n._api,a=n._model;R(n._componentsViews,function(o){o.dispose(a,i)}),R(n._chartsViews,function(o){o.dispose(a,i)}),n._zr.dispose(),n._dom=n._model=n._chartsMap=n._componentsMap=n._chartsViews=n._componentsViews=n._scheduler=n._api=n._zr=n._throttledZrFlush=n._theme=n._coordSysMgr=n._messageCenter=null,delete Ed[n.id]},t.prototype.resize=function(r){if(!this[wn]){if(this._disposed){this.id;return}this._zr.resize(r);var n=this._model;if(this._loadingFX&&this._loadingFX.resize(),!!n){var i=n.resetOption("media"),a=r&&r.silent;this[Qn]&&(a==null&&(a=this[Qn].silent),i=!0,this[Qn]=null),this[wn]=!0;try{i&&ah(this),Ko.update.call(this,{type:"resize",animation:rt({duration:0},r&&r.animation)})}catch(o){throw this[wn]=!1,o}this[wn]=!1,Sc.call(this,a),Tc.call(this,a)}}},t.prototype.showLoading=function(r,n){if(this._disposed){this.id;return}if(Kt(r)&&(n=r,r=""),r=r||"default",this.hideLoading(),!!YS[r]){var i=YS[r](this._api,n),a=this._zr;this._loadingFX=i,a.add(i)}},t.prototype.hideLoading=function(){if(this._disposed){this.id;return}this._loadingFX&&this._zr.remove(this._loadingFX),this._loadingFX=null},t.prototype.makeActionFromEvent=function(r){var n=rt({},r);return n.type=Ad[r.type],n},t.prototype.dispatchAction=function(r,n){if(this._disposed){this.id;return}if(Kt(n)||(n={silent:!!n}),!!Pm[r.type]&&this._model){if(this[wn]){this._pendingActions.push(r);return}var i=n.silent;Ty.call(this,r,i);var a=n.flush;a?this._zr.flush():a!==!1&&ye.browser.weChat&&this._throttledZrFlush(),Sc.call(this,i),Tc.call(this,i)}},t.prototype.updateLabelLayout=function(){sa.trigger("series:layoutlabels",this._model,this._api,{updatedSeries:[]})},t.prototype.appendData=function(r){if(this._disposed){this.id;return}var n=r.seriesIndex,i=this.getModel(),a=i.getSeriesByIndex(n);a.appendData(r),this._scheduler.unfinished=!0,this.getZr().wakeUp()},t.internalField=function(){ah=function(f){var c=f._scheduler;c.restorePipelines(f._model),c.prepareStageTasks(),yy(f,!0),yy(f,!1),c.plan()},yy=function(f,c){for(var d=f._model,v=f._scheduler,p=c?f._componentsViews:f._chartsViews,g=c?f._componentsMap:f._chartsMap,m=f._zr,_=f._api,y=0;y<p.length;y++)p[y].__alive=!1;c?d.eachComponent(function(S,M){S!=="series"&&x(M)}):d.eachSeries(x);function x(S){var M=S.__requireNewView;S.__requireNewView=!1;var w="_ec_"+S.id+"_"+S.type,b=!M&&g[w];if(!b){var A=Fa(S.type),E=c?nr.getClass(A.main,A.sub):De.getClass(A.sub);b=new E,b.init(d,_),g[w]=b,p.push(b),m.add(b.group)}S.__viewId=b.__id=w,b.__alive=!0,b.__model=S,b.group.__ecComponentInfo={mainType:S.mainType,index:S.componentIndex},!c&&v.prepareView(b,S,d,_)}for(var y=0;y<p.length;){var T=p[y];T.__alive?y++:(!c&&T.renderTask.dispose(),m.remove(T.group),T.dispose(d,_),p.splice(y,1),g[T.__id]===T&&delete g[T.__id],T.__id=T.group.__ecComponentInfo=null)}},xp=function(f,c,d,v,p){var g=f._model;if(g.setUpdatePayload(d),!v){R([].concat(f._componentsViews).concat(f._chartsViews),T);return}var m={};m[v+"Id"]=d[v+"Id"],m[v+"Index"]=d[v+"Index"],m[v+"Name"]=d[v+"Name"];var _={mainType:v,query:m};p&&(_.subType=p);var y=d.excludeSeriesId,x;y!=null&&(x=Ut(),R(er(y),function(S){var M=Xr(S,null);M!=null&&x.set(M,!0)})),g&&g.eachComponent(_,function(S){var M=x&&x.get(S.id)!=null;if(!M)if(FE(d))if(S instanceof Ue)d.type===fu&&!d.notBlur&&!S.get(["emphasis","disabled"])&&bH(S,d,f._api);else{var w=uw(S.mainType,S.componentIndex,d.name,f._api),b=w.focusSelf,A=w.dispatchers;d.type===fu&&b&&!d.notBlur&&AS(S.mainType,S.componentIndex,f._api),A&&R(A,function(E){d.type===fu?Po(E):Io(E)})}else CS(d)&&S instanceof Ue&&(AH(S,d,f._api),NE(S),Si(f))},f),g&&g.eachComponent(_,function(S){var M=x&&x.get(S.id)!=null;M||T(f[v==="series"?"_chartsMap":"_componentsMap"][S.__viewId])},f);function T(S){S&&S.__alive&&S[c]&&S[c](S.__model,g,f._api,d)}},Ko={prepareAndUpdate:function(f){ah(this),Ko.update.call(this,f,{optionChanged:f.newOption!=null})},update:function(f,c){var d=this._model,v=this._api,p=this._zr,g=this._coordSysMgr,m=this._scheduler;if(d){d.setUpdatePayload(f),m.restoreData(d,f),m.performSeriesTasks(d),g.create(d,v),m.performDataProcessorTasks(d,f),Sy(this,d),g.update(d,v),r(d),m.performVisualTasks(d,f),by(this,d,v,f,c);var _=d.get("backgroundColor")||"transparent",y=d.get("darkMode");p.setBackgroundColor(_),y!=null&&y!=="auto"&&p.setDarkMode(y),sa.trigger("afterupdate",d,v)}},updateTransform:function(f){var c=this,d=this._model,v=this._api;if(d){d.setUpdatePayload(f);var p=[];d.eachComponent(function(m,_){if(m!=="series"){var y=c.getViewOfComponentModel(_);if(y&&y.__alive)if(y.updateTransform){var x=y.updateTransform(_,d,v,f);x&&x.update&&p.push(y)}else p.push(y)}});var g=Ut();d.eachSeries(function(m){var _=c._chartsMap[m.__viewId];if(_.updateTransform){var y=_.updateTransform(m,d,v,f);y&&y.update&&g.set(m.uid,1)}else g.set(m.uid,1)}),r(d),this._scheduler.performVisualTasks(d,f,{setDirty:!0,dirtyMap:g}),Sp(this,d,v,f,{},g),sa.trigger("afterupdate",d,v)}},updateView:function(f){var c=this._model;c&&(c.setUpdatePayload(f),De.markUpdateMethod(f,"updateView"),r(c),this._scheduler.performVisualTasks(c,f,{setDirty:!0}),by(this,c,this._api,f,{}),sa.trigger("afterupdate",c,this._api))},updateVisual:function(f){var c=this,d=this._model;d&&(d.setUpdatePayload(f),d.eachSeries(function(v){v.getData().clearAllVisual()}),De.markUpdateMethod(f,"updateVisual"),r(d),this._scheduler.performVisualTasks(d,f,{visualType:"visual",setDirty:!0}),d.eachComponent(function(v,p){if(v!=="series"){var g=c.getViewOfComponentModel(p);g&&g.__alive&&g.updateVisual(p,d,c._api,f)}}),d.eachSeries(function(v){var p=c._chartsMap[v.__viewId];p.updateVisual(v,d,c._api,f)}),sa.trigger("afterupdate",d,this._api))},updateLayout:function(f){Ko.update.call(this,f)}},xy=function(f,c,d,v){if(f._disposed){f.id;return}for(var p=f._model,g=f._coordSysMgr.getCoordinateSystems(),m,_=xd(p,d),y=0;y<g.length;y++){var x=g[y];if(x[c]&&(m=x[c](p,_,v))!=null)return m}},Sy=function(f,c){var d=f._chartsMap,v=f._scheduler;c.eachSeries(function(p){v.updateStreamModes(p,d[p.__viewId])})},Ty=function(f,c){var d=this,v=this.getModel(),p=f.type,g=f.escapeConnect,m=Pm[p],_=m.actionInfo,y=(_.update||"update").split(":"),x=y.pop(),T=y[0]!=null&&Fa(y[0]);this[wn]=!0;var S=[f],M=!1;f.batch&&(M=!0,S=ft(f.batch,function(L){return L=Vt(rt({},L),f),L.batch=null,L}));var w=[],b,A=CS(f),E=FE(f);if(E&&JO(this._api),R(S,function(L){if(b=m.action(L,d._model,d._api),b=b||rt({},L),b.type=_.event||b.type,w.push(b),E){var P=ew(f),N=P.queryOptionMap,O=P.mainTypeSpecified,I=O?N.keys()[0]:"series";xp(d,x,L,I),Si(d)}else A?(xp(d,x,L,"series"),Si(d)):T&&xp(d,x,L,T.main,T.sub)}),x!=="none"&&!E&&!A&&!T)try{this[Qn]?(ah(this),Ko.update.call(this,f),this[Qn]=null):Ko[x].call(this,f)}catch(L){throw this[wn]=!1,L}if(M?b={type:_.event||p,escapeConnect:g,batch:w}:b=w[0],this[wn]=!1,!c){var C=this._messageCenter;if(C.trigger(b.type,b),A){var D={type:"selectchanged",escapeConnect:g,selected:EH(v),isFromClick:f.isFromClick||!1,fromAction:f.type,fromActionPayload:f};C.trigger(D.type,D)}}},Sc=function(f){for(var c=this._pendingActions;c.length;){var d=c.shift();Ty.call(this,d,f)}},Tc=function(f){!f&&this.trigger("updated")},K2=function(f,c){f.on("rendered",function(d){c.trigger("rendered",d),f.animation.isFinished()&&!c[Qn]&&!c._scheduler.unfinished&&!c._pendingActions.length&&c.trigger("finished")})},j2=function(f,c){f.on("mouseover",function(d){var v=d.target,p=Ql(v,kd);p&&(wH(p,d,c._api),Si(c))}).on("mouseout",function(d){var v=d.target,p=Ql(v,kd);p&&(MH(p,d,c._api),Si(c))}).on("click",function(d){var v=d.target,p=Ql(v,function(_){return oe(_).dataIndex!=null},!0);if(p){var g=p.selected?"unselect":"select",m=oe(p);c._api.dispatchAction({type:g,dataType:m.dataType,dataIndexInside:m.dataIndex,seriesIndex:m.seriesIndex,isFromClick:!0})}})};function r(f){f.clearColorPalette(),f.eachSeries(function(c){c.clearColorPalette()})}function n(f){var c=[],d=[],v=!1;if(f.eachComponent(function(_,y){var x=y.get("zlevel")||0,T=y.get("z")||0,S=y.getZLevelKey();v=v||!!S,(_==="series"?d:c).push({zlevel:x,z:T,idx:y.componentIndex,type:_,key:S})}),v){var p=c.concat(d),g,m;Ug(p,function(_,y){return _.zlevel===y.zlevel?_.z-y.z:_.zlevel-y.zlevel}),R(p,function(_){var y=f.getComponent(_.type,_.idx),x=_.zlevel,T=_.key;g!=null&&(x=Math.max(g,x)),T?(x===g&&T!==m&&x++,m=T):m&&(x===g&&x++,m=""),g=x,y.setZLevel(x)})}}by=function(f,c,d,v,p){n(c),J2(f,c,d,v,p),R(f._chartsViews,function(g){g.__alive=!1}),Sp(f,c,d,v,p),R(f._chartsViews,function(g){g.__alive||g.remove(c,d)})},J2=function(f,c,d,v,p,g){R(g||f._componentsViews,function(m){var _=m.__model;u(_,m),m.render(_,c,d,v),s(_,m),h(_,m)})},Sp=function(f,c,d,v,p,g){var m=f._scheduler;p=rt(p||{},{updatedSeries:c.getSeries()}),sa.trigger("series:beforeupdate",c,d,p);var _=!1;c.eachSeries(function(y){var x=f._chartsMap[y.__viewId];x.__alive=!0;var T=x.renderTask;m.updatePayload(T,v),u(y,x),g&&g.get(y.uid)&&T.dirty(),T.perform(m.getPerformArgs(T))&&(_=!0),x.group.silent=!!y.get("silent"),o(y,x),NE(y)}),m.unfinished=_||m.unfinished,sa.trigger("series:layoutlabels",c,d,p),sa.trigger("series:transition",c,d,p),c.eachSeries(function(y){var x=f._chartsMap[y.__viewId];s(y,x),h(y,x)}),a(f,c),sa.trigger("series:afterupdate",c,d,p)},Si=function(f){f[my]=!0,f.getZr().wakeUp()},tC=function(f){f[my]&&(f.getZr().storage.traverse(function(c){Jh(c)||i(c)}),f[my]=!1)};function i(f){for(var c=[],d=f.currentStates,v=0;v<d.length;v++){var p=d[v];p==="emphasis"||p==="blur"||p==="select"||c.push(p)}f.selected&&f.states.select&&c.push("select"),f.hoverState===P_&&f.states.emphasis?c.push("emphasis"):f.hoverState===xv&&f.states.blur&&c.push("blur"),f.useStates(c)}function a(f,c){var d=f._zr,v=d.storage,p=0;v.traverse(function(g){g.isGroup||p++}),p>c.get("hoverLayerThreshold")&&!ye.node&&!ye.worker&&c.eachSeries(function(g){if(!g.preventUsingHoverLayer){var m=f._chartsMap[g.__viewId];m.__alive&&m.eachRendered(function(_){_.states.emphasis&&(_.states.emphasis.hoverLayer=!0)})}})}function o(f,c){var d=f.get("blendMode")||null;c.eachRendered(function(v){v.isGroup||(v.style.blend=d)})}function s(f,c){if(!f.preventAutoZ){var d=f.get("z")||0,v=f.get("zlevel")||0;c.eachRendered(function(p){return l(p,d,v,-1/0),!0})}}function l(f,c,d,v){var p=f.getTextContent(),g=f.getTextGuideLine(),m=f.isGroup;if(m)for(var _=f.childrenRef(),y=0;y<_.length;y++)v=Math.max(l(_[y],c,d,v),v);else f.z=c,f.zlevel=d,v=Math.max(f.z2,v);if(p&&(p.z=c,p.zlevel=d,isFinite(v)&&(p.z2=v+2)),g){var x=f.textGuideLineConfig;g.z=c,g.zlevel=d,isFinite(v)&&(g.z2=v+(x&&x.showAbove?1:-1))}return v}function u(f,c){c.eachRendered(function(d){if(!Jh(d)){var v=d.getTextContent(),p=d.getTextGuideLine();d.stateTransition&&(d.stateTransition=null),v&&v.stateTransition&&(v.stateTransition=null),p&&p.stateTransition&&(p.stateTransition=null),d.hasState()?(d.prevStates=d.currentStates,d.clearStates()):d.prevStates&&(d.prevStates=null)}})}function h(f,c){var d=f.getModel("stateAnimation"),v=f.isAnimationEnabled(),p=d.get("duration"),g=p>0?{duration:p,delay:d.get("delay"),easing:d.get("easing")}:null;c.eachRendered(function(m){if(m.states&&m.states.emphasis){if(Jh(m))return;if(m instanceof _e&&PH(m),m.__dirty){var _=m.prevStates;_&&m.useStates(_)}if(v){m.stateTransition=g;var y=m.getTextContent(),x=m.getTextGuideLine();y&&(y.stateTransition=g),x&&(x.stateTransition=g)}m.__dirty&&i(m)}})}Q2=function(f){return new(function(c){q(d,c);function d(){return c!==null&&c.apply(this,arguments)||this}return d.prototype.getCoordinateSystems=function(){return f._coordSysMgr.getCoordinateSystems()},d.prototype.getComponentByElement=function(v){for(;v;){var p=v.__ecComponentInfo;if(p!=null)return f._model.getComponent(p.mainType,p.index);v=v.parent}},d.prototype.enterEmphasis=function(v,p){Po(v,p),Si(f)},d.prototype.leaveEmphasis=function(v,p){Io(v,p),Si(f)},d.prototype.enterBlur=function(v){qO(v),Si(f)},d.prototype.leaveBlur=function(v){lw(v),Si(f)},d.prototype.enterSelect=function(v){$O(v),Si(f)},d.prototype.leaveSelect=function(v){KO(v),Si(f)},d.prototype.getModel=function(){return f.getModel()},d.prototype.getViewOfComponentModel=function(v){return f.getViewOfComponentModel(v)},d.prototype.getViewOfSeriesModel=function(v){return f.getViewOfSeriesModel(v)},d}(G3))(f)},FF=function(f){function c(d,v){for(var p=0;p<d.length;p++){var g=d[p];g[_y]=v}}R(Ad,function(d,v){f._messageCenter.on(v,function(p){if(eC[f.group]&&f[_y]!==$2){if(p&&p.escapeConnect)return;var g=f.makeActionFromEvent(p),m=[];R(Ed,function(_){_!==f&&_.group===f.group&&m.push(_)}),c(m,$2),R(m,function(_){_[_y]!==nX&&_.dispatchAction(g)}),c(m,iX)}})})}}(),t}(Zi),Nw=BF.prototype;Nw.on=RF("on");Nw.off=RF("off");Nw.one=function(e,t,r){var n=this;function i(){for(var a=[],o=0;o<arguments.length;o++)a[o]=arguments[o];t&&t.apply&&t.apply(this,a),n.off(e,i)}this.on.call(this,e,i,r)};var aX=["click","dblclick","mouseover","mouseout","mousemove","mousedown","mouseup","globalout","contextmenu"];var Pm={},Ad={},WS=[],XS=[],Im=[],UF={},YS={},Ed={},eC={},oX=+new Date-0,Ow="_echarts_instance_";function sX(e,t,r){{var n=lX(e);if(n)return n}var i=new BF(e,t,r);return i.id="ec_"+oX++,Ed[i.id]=i,RO(e,Ow,i.id),FF(i),sa.trigger("afterinit",i),i}function lX(e){return Ed[x5(e,Ow)]}function zF(e,t){UF[e]=t}function Fw(e){pe(XS,e)<0&&XS.push(e)}function kF(e,t){Uw(WS,e,t,$6)}function GF(e){Bw("afterinit",e)}function VF(e){Bw("afterupdate",e)}function Bw(e,t){sa.on(e,t)}function Ja(e,t,r){Yt(t)&&(r=t,t="");var n=Kt(e)?e.type:[e,e={event:t}][0];e.event=(e.event||n).toLowerCase(),t=e.event,!Ad[t]&&(Hn(q2.test(n)&&q2.test(t)),Pm[n]||(Pm[n]={action:r,actionInfo:e}),Ad[t]=n)}function uX(e,t){Yf.register(e,t)}function HF(e){var t=Yf.get(e);if(t)return t.getDimensionsInfo?t.getDimensionsInfo():t.dimensions.slice()}function hX(e,t){Uw(Im,e,t,CF,"layout")}function Gu(e,t){Uw(Im,e,t,DF,"visual")}var rC=[];function Uw(e,t,r,n,i){if((Yt(t)||Kt(t))&&(r=t,t=n),!(pe(rC,r)>=0)){rC.push(r);var a=vF.wrapStageHandler(r,i);a.__prio=t,a.__raw=r,e.push(a)}}function WF(e,t){YS[e]=t}function fX(e,t,r){var n=EF("registerMap");n&&n(e,t,r)}function ZS(e){var t=EF("getMap");return t&&t(e)}var cX=E8;Gu(Iw,Q8);Gu($_,t6);Gu($_,e6);Gu(Iw,v6);Gu($_,p6);Gu(LF,H6);Fw(H3);kF(Z6,s8);WF("default",r6);Ja({type:fu,event:fu,update:fu},Rr);Ja({type:Wg,event:Wg,update:Wg},Rr);Ja({type:Sd,event:Sd,update:Sd},Rr);Ja({type:Xg,event:Xg,update:Xg},Rr);Ja({type:Td,event:Td,update:Td},Rr);zF("light",c6);zF("dark",_F);var nC=[],dX={registerPreprocessor:Fw,registerProcessor:kF,registerPostInit:GF,registerPostUpdate:VF,registerUpdateLifecycle:Bw,registerAction:Ja,registerCoordinateSystem:uX,registerLayout:hX,registerVisual:Gu,registerTransform:cX,registerLoading:WF,registerMap:fX,registerImpl:W6,PRIORITY:rX,ComponentModel:me,ComponentView:nr,SeriesModel:Ue,ChartView:De,registerComponentModel:function(e){me.registerClass(e)},registerComponentView:function(e){nr.registerClass(e)},registerSeriesModel:function(e){Ue.registerClass(e)},registerChartView:function(e){De.registerClass(e)},registerSubTypeDefaulter:function(e,t){me.registerSubTypeDefaulter(e,t)},registerPainter:function(e,t){JV(e,t)}};function te(e){if(at(e)){R(e,function(t){te(t)});return}pe(nC,e)>=0||(nC.push(e),Yt(e)&&(e={install:e}),e.install(dX))}function bc(e){return e==null?0:e.length||1}function iC(e){return e}var No=function(){function e(t,r,n,i,a,o){this._old=t,this._new=r,this._oldKeyGetter=n||iC,this._newKeyGetter=i||iC,this.context=a,this._diffModeMultiple=o==="multiple"}return e.prototype.add=function(t){return this._add=t,this},e.prototype.update=function(t){return this._update=t,this},e.prototype.updateManyToOne=function(t){return this._updateManyToOne=t,this},e.prototype.updateOneToMany=function(t){return this._updateOneToMany=t,this},e.prototype.updateManyToMany=function(t){return this._updateManyToMany=t,this},e.prototype.remove=function(t){return this._remove=t,this},e.prototype.execute=function(){this[this._diffModeMultiple?"_executeMultiple":"_executeOneToOne"]()},e.prototype._executeOneToOne=function(){var t=this._old,r=this._new,n={},i=new Array(t.length),a=new Array(r.length);this._initIndexMap(t,null,i,"_oldKeyGetter"),this._initIndexMap(r,n,a,"_newKeyGetter");for(var o=0;o<t.length;o++){var s=i[o],l=n[s],u=bc(l);if(u>1){var h=l.shift();l.length===1&&(n[s]=l[0]),this._update&&this._update(h,o)}else u===1?(n[s]=null,this._update&&this._update(l,o)):this._remove&&this._remove(o)}this._performRestAdd(a,n)},e.prototype._executeMultiple=function(){var t=this._old,r=this._new,n={},i={},a=[],o=[];this._initIndexMap(t,n,a,"_oldKeyGetter"),this._initIndexMap(r,i,o,"_newKeyGetter");for(var s=0;s<a.length;s++){var l=a[s],u=n[l],h=i[l],f=bc(u),c=bc(h);if(f>1&&c===1)this._updateManyToOne&&this._updateManyToOne(h,u),i[l]=null;else if(f===1&&c>1)this._updateOneToMany&&this._updateOneToMany(h,u),i[l]=null;else if(f===1&&c===1)this._update&&this._update(h,u),i[l]=null;else if(f>1&&c>1)this._updateManyToMany&&this._updateManyToMany(h,u),i[l]=null;else if(f>1)for(var d=0;d<f;d++)this._remove&&this._remove(u[d]);else this._remove&&this._remove(u)}this._performRestAdd(o,i)},e.prototype._performRestAdd=function(t,r){for(var n=0;n<t.length;n++){var i=t[n],a=r[i],o=bc(a);if(o>1)for(var s=0;s<o;s++)this._add&&this._add(a[s]);else o===1&&this._add&&this._add(a);r[i]=null}},e.prototype._initIndexMap=function(t,r,n,i){for(var a=this._diffModeMultiple,o=0;o<t.length;o++){var s="_ec_"+this[i](t[o],o);if(a||(n[o]=s),!!r){var l=r[s],u=bc(l);u===0?(r[s]=o,a&&n.push(s)):u===1?r[s]=[l,o]:l.push(o)}}},e}(),vX=function(){function e(t,r){this._encode=t,this._schema=r}return e.prototype.get=function(){return{fullDimensions:this._getFullDimensionNames(),encode:this._encode}},e.prototype._getFullDimensionNames=function(){return this._cachedDimNames||(this._cachedDimNames=this._schema?this._schema.makeOutputDimensionNames():[]),this._cachedDimNames},e}();function pX(e,t){var r={},n=r.encode={},i=Ut(),a=[],o=[],s={};R(e.dimensions,function(c){var d=e.getDimensionInfo(c),v=d.coordDim;if(v){var p=d.coordDimIndex;wy(n,v)[p]=c,d.isExtraCoord||(i.set(v,1),gX(d.type)&&(a[0]=c),wy(s,v)[p]=e.getDimensionIndex(d.name)),d.defaultTooltip&&o.push(c)}N3.each(function(g,m){var _=wy(n,m),y=d.otherDims[m];y!=null&&y!==!1&&(_[y]=d.name)})});var l=[],u={};i.each(function(c,d){var v=n[d];u[d]=v[0],l=l.concat(v)}),r.dataDimsOnCoord=l,r.dataDimIndicesOnCoord=ft(l,function(c){return e.getDimensionInfo(c).storeDimIndex}),r.encodeFirstDimNotExtra=u;var h=n.label;h&&h.length&&(a=h.slice());var f=n.tooltip;return f&&f.length?o=f.slice():o.length||(o=a.slice()),n.defaultedLabel=a,n.defaultedTooltip=o,r.userOutput=new vX(s,t),r}function wy(e,t){return e.hasOwnProperty(t)||(e[t]=[]),e[t]}function Nm(e){return e==="category"?"ordinal":e==="time"?"time":"float"}function gX(e){return!(e==="ordinal"||e==="time")}var Kg=function(){function e(t){this.otherDims={},t!=null&&rt(this,t)}return e}(),mX=Le(),_X={float:"f",int:"i",ordinal:"o",number:"n",time:"t"},XF=function(){function e(t){this.dimensions=t.dimensions,this._dimOmitted=t.dimensionOmitted,this.source=t.source,this._fullDimCount=t.fullDimensionCount,this._updateDimOmitted(t.dimensionOmitted)}return e.prototype.isDimensionOmitted=function(){return this._dimOmitted},e.prototype._updateDimOmitted=function(t){this._dimOmitted=t,t&&(this._dimNameMap||(this._dimNameMap=qF(this.source)))},e.prototype.getSourceDimensionIndex=function(t){return se(this._dimNameMap.get(t),-1)},e.prototype.getSourceDimension=function(t){var r=this.source.dimensionsDefine;if(r)return r[t]},e.prototype.makeStoreSchema=function(){for(var t=this._fullDimCount,r=X3(this.source),n=!$F(t),i="",a=[],o=0,s=0;o<t;o++){var l=void 0,u=void 0,h=void 0,f=this.dimensions[s];if(f&&f.storeDimIndex===o)l=r?f.name:null,u=f.type,h=f.ordinalMeta,s++;else{var c=this.getSourceDimension(o);c&&(l=r?c.name:null,u=c.type)}a.push({property:l,type:u,ordinalMeta:h}),r&&l!=null&&(!f||!f.isCalculationCoord)&&(i+=n?l.replace(/\`/g,"`1").replace(/\$/g,"`2"):l),i+="$",i+=_X[u]||"f",h&&(i+=h.uid),i+="$"}var d=this.source,v=[d.seriesLayoutBy,d.startIndex,i].join("$$");return{dimensions:a,hash:v}},e.prototype.makeOutputDimensionNames=function(){for(var t=[],r=0,n=0;r<this._fullDimCount;r++){var i=void 0,a=this.dimensions[n];if(a&&a.storeDimIndex===r)a.isCalculationCoord||(i=a.name),n++;else{var o=this.getSourceDimension(r);o&&(i=o.name)}t.push(i)}return t},e.prototype.appendCalculationDimension=function(t){this.dimensions.push(t),t.isCalculationCoord=!0,this._fullDimCount++,this._updateDimOmitted(!0)},e}();function YF(e){return e instanceof XF}function ZF(e){for(var t=Ut(),r=0;r<(e||[]).length;r++){var n=e[r],i=Kt(n)?n.name:n;i!=null&&t.get(i)==null&&t.set(i,r)}return t}function qF(e){var t=mX(e);return t.dimNameMap||(t.dimNameMap=ZF(e.dimensionsDefine))}function $F(e){return e>30}var wc=Kt,jo=ft,yX=typeof Int32Array>"u"?Array:Int32Array,xX="e\0\0",aC=-1,SX=["hasItemOption","_nameList","_idList","_invertedIndicesMap","_dimSummary","userOutput","_rawData","_dimValueGetter","_nameDimIdx","_idDimIdx","_nameRepeatCount"],TX=["_approximateExtent"],oC,Tp,Mc,Ac,My,Ec,Ay,xr=function(){function e(t,r){this.type="list",this._dimOmitted=!1,this._nameList=[],this._idList=[],this._visual={},this._layout={},this._itemVisuals=[],this._itemLayouts=[],this._graphicEls=[],this._approximateExtent={},this._calculationInfo={},this.hasItemOption=!1,this.TRANSFERABLE_METHODS=["cloneShallow","downSample","minmaxDownSample","lttbDownSample","map"],this.CHANGABLE_METHODS=["filterSelf","selectRange"],this.DOWNSAMPLE_METHODS=["downSample","minmaxDownSample","lttbDownSample"];var n,i=!1;YF(t)?(n=t.dimensions,this._dimOmitted=t.isDimensionOmitted(),this._schema=t):(i=!0,n=t),n=n||["x","y"];for(var a={},o=[],s={},l=!1,u={},h=0;h<n.length;h++){var f=n[h],c=Ct(f)?new Kg({name:f}):f instanceof Kg?f:new Kg(f),d=c.name;c.type=c.type||"float",c.coordDim||(c.coordDim=d,c.coordDimIndex=0);var v=c.otherDims=c.otherDims||{};o.push(d),a[d]=c,u[d]!=null&&(l=!0),c.createInvertedIndices&&(s[d]=[]),v.itemName===0&&(this._nameDimIdx=h),v.itemId===0&&(this._idDimIdx=h),i&&(c.storeDimIndex=h)}if(this.dimensions=o,this._dimInfos=a,this._initGetDimensionInfo(l),this.hostModel=r,this._invertedIndicesMap=s,this._dimOmitted){var p=this._dimIdxToName=Ut();R(o,function(g){p.set(a[g].storeDimIndex,g)})}}return e.prototype.getDimension=function(t){var r=this._recognizeDimIndex(t);if(r==null)return t;if(r=t,!this._dimOmitted)return this.dimensions[r];var n=this._dimIdxToName.get(r);if(n!=null)return n;var i=this._schema.getSourceDimension(r);if(i)return i.name},e.prototype.getDimensionIndex=function(t){var r=this._recognizeDimIndex(t);if(r!=null)return r;if(t==null)return-1;var n=this._getDimInfo(t);return n?n.storeDimIndex:this._dimOmitted?this._schema.getSourceDimensionIndex(t):-1},e.prototype._recognizeDimIndex=function(t){if(Be(t)||t!=null&&!isNaN(t)&&!this._getDimInfo(t)&&(!this._dimOmitted||this._schema.getSourceDimensionIndex(t)<0))return+t},e.prototype._getStoreDimIndex=function(t){var r=this.getDimensionIndex(t);return r},e.prototype.getDimensionInfo=function(t){return this._getDimInfo(this.getDimension(t))},e.prototype._initGetDimensionInfo=function(t){var r=this._dimInfos;this._getDimInfo=t?function(n){return r.hasOwnProperty(n)?r[n]:void 0}:function(n){return r[n]}},e.prototype.getDimensionsOnCoord=function(){return this._dimSummary.dataDimsOnCoord.slice()},e.prototype.mapDimension=function(t,r){var n=this._dimSummary;if(r==null)return n.encodeFirstDimNotExtra[t];var i=n.encode[t];return i?i[r]:null},e.prototype.mapDimensionsAll=function(t){var r=this._dimSummary,n=r.encode[t];return(n||[]).slice()},e.prototype.getStore=function(){return this._store},e.prototype.initData=function(t,r,n){var i=this,a;if(t instanceof BS&&(a=t),!a){var o=this.dimensions,s=Aw(t)||Dn(t)?new Y3(t,o.length):t;a=new BS;var l=jo(o,function(u){return{type:i._dimInfos[u].type,property:u}});a.initData(s,l,n)}this._store=a,this._nameList=(r||[]).slice(),this._idList=[],this._nameRepeatCount={},this._doInit(0,a.count()),this._dimSummary=pX(this,this._schema),this.userOutput=this._dimSummary.userOutput},e.prototype.appendData=function(t){var r=this._store.appendData(t);this._doInit(r[0],r[1])},e.prototype.appendValues=function(t,r){var n=this._store.appendValues(t,r&&r.length),i=n.start,a=n.end,o=this._shouldMakeIdFromName();if(this._updateOrdinalMeta(),r)for(var s=i;s<a;s++){var l=s-i;this._nameList[s]=r[l],o&&Ay(this,s)}},e.prototype._updateOrdinalMeta=function(){for(var t=this._store,r=this.dimensions,n=0;n<r.length;n++){var i=this._dimInfos[r[n]];i.ordinalMeta&&t.collectOrdinalMeta(i.storeDimIndex,i.ordinalMeta)}},e.prototype._shouldMakeIdFromName=function(){var t=this._store.getProvider();return this._idDimIdx==null&&t.getSource().sourceFormat!==Cs&&!t.fillStorage},e.prototype._doInit=function(t,r){if(!(t>=r)){var n=this._store,i=n.getProvider();this._updateOrdinalMeta();var a=this._nameList,o=this._idList,s=i.getSource().sourceFormat,l=s===qi;if(l&&!i.pure)for(var u=[],h=t;h<r;h++){var f=i.getItem(h,u);if(!this.hasItemOption&&s5(f)&&(this.hasItemOption=!0),f){var c=f.name;a[h]==null&&c!=null&&(a[h]=Xr(c,null));var d=f.id;o[h]==null&&d!=null&&(o[h]=Xr(d,null))}}if(this._shouldMakeIdFromName())for(var h=t;h<r;h++)Ay(this,h);oC(this)}},e.prototype.getApproximateExtent=function(t){return this._approximateExtent[t]||this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.setApproximateExtent=function(t,r){r=this.getDimension(r),this._approximateExtent[r]=t.slice()},e.prototype.getCalculationInfo=function(t){return this._calculationInfo[t]},e.prototype.setCalculationInfo=function(t,r){wc(t)?rt(this._calculationInfo,t):this._calculationInfo[t]=r},e.prototype.getName=function(t){var r=this.getRawIndex(t),n=this._nameList[r];return n==null&&this._nameDimIdx!=null&&(n=Mc(this,this._nameDimIdx,r)),n==null&&(n=""),n},e.prototype._getCategory=function(t,r){var n=this._store.get(t,r),i=this._store.getOrdinalMeta(t);return i?i.categories[n]:n},e.prototype.getId=function(t){return Tp(this,this.getRawIndex(t))},e.prototype.count=function(){return this._store.count()},e.prototype.get=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.get(i.storeDimIndex,r)},e.prototype.getByRawIndex=function(t,r){var n=this._store,i=this._dimInfos[t];if(i)return n.getByRawIndex(i.storeDimIndex,r)},e.prototype.getIndices=function(){return this._store.getIndices()},e.prototype.getDataExtent=function(t){return this._store.getDataExtent(this._getStoreDimIndex(t))},e.prototype.getSum=function(t){return this._store.getSum(this._getStoreDimIndex(t))},e.prototype.getMedian=function(t){return this._store.getMedian(this._getStoreDimIndex(t))},e.prototype.getValues=function(t,r){var n=this,i=this._store;return at(t)?i.getValues(jo(t,function(a){return n._getStoreDimIndex(a)}),r):i.getValues(t)},e.prototype.hasValue=function(t){for(var r=this._dimSummary.dataDimIndicesOnCoord,n=0,i=r.length;n<i;n++)if(isNaN(this._store.get(r[n],t)))return!1;return!0},e.prototype.indexOfName=function(t){for(var r=0,n=this._store.count();r<n;r++)if(this.getName(r)===t)return r;return-1},e.prototype.getRawIndex=function(t){return this._store.getRawIndex(t)},e.prototype.indexOfRawIndex=function(t){return this._store.indexOfRawIndex(t)},e.prototype.rawIndexOf=function(t,r){var n=t&&this._invertedIndicesMap[t],i=n&&n[r];return i==null||isNaN(i)?aC:i},e.prototype.indicesOfNearest=function(t,r,n){return this._store.indicesOfNearest(this._getStoreDimIndex(t),r,n)},e.prototype.each=function(t,r,n){Yt(t)&&(n=r,r=t,t=[]);var i=n||this,a=jo(Ac(t),this._getStoreDimIndex,this);this._store.each(a,i?It(r,i):r)},e.prototype.filterSelf=function(t,r,n){Yt(t)&&(n=r,r=t,t=[]);var i=n||this,a=jo(Ac(t),this._getStoreDimIndex,this);return this._store=this._store.filter(a,i?It(r,i):r),this},e.prototype.selectRange=function(t){var r=this,n={},i=be(t);return R(i,function(a){var o=r._getStoreDimIndex(a);n[o]=t[a]}),this._store=this._store.selectRange(n),this},e.prototype.mapArray=function(t,r,n){Yt(t)&&(n=r,r=t,t=[]),n=n||this;var i=[];return this.each(t,function(){i.push(r&&r.apply(this,arguments))},n),i},e.prototype.map=function(t,r,n,i){var a=n||i||this,o=jo(Ac(t),this._getStoreDimIndex,this),s=Ec(this);return s._store=this._store.map(o,a?It(r,a):r),s},e.prototype.modify=function(t,r,n,i){var a=n||i||this,o=jo(Ac(t),this._getStoreDimIndex,this);this._store.modify(o,a?It(r,a):r)},e.prototype.downSample=function(t,r,n,i){var a=Ec(this);return a._store=this._store.downSample(this._getStoreDimIndex(t),r,n,i),a},e.prototype.minmaxDownSample=function(t,r){var n=Ec(this);return n._store=this._store.minmaxDownSample(this._getStoreDimIndex(t),r),n},e.prototype.lttbDownSample=function(t,r){var n=Ec(this);return n._store=this._store.lttbDownSample(this._getStoreDimIndex(t),r),n},e.prototype.getRawDataItem=function(t){return this._store.getRawDataItem(t)},e.prototype.getItemModel=function(t){var r=this.hostModel,n=this.getRawDataItem(t);return new Ie(n,r,r&&r.ecModel)},e.prototype.diff=function(t){var r=this;return new No(t?t.getStore().getIndices():[],this.getStore().getIndices(),function(n){return Tp(t,n)},function(n){return Tp(r,n)})},e.prototype.getVisual=function(t){var r=this._visual;return r&&r[t]},e.prototype.setVisual=function(t,r){this._visual=this._visual||{},wc(t)?rt(this._visual,t):this._visual[t]=r},e.prototype.getItemVisual=function(t,r){var n=this._itemVisuals[t],i=n&&n[r];return i??this.getVisual(r)},e.prototype.hasItemVisual=function(){return this._itemVisuals.length>0},e.prototype.ensureUniqueItemVisual=function(t,r){var n=this._itemVisuals,i=n[t];i||(i=n[t]={});var a=i[r];return a==null&&(a=this.getVisual(r),at(a)?a=a.slice():wc(a)&&(a=rt({},a)),i[r]=a),a},e.prototype.setItemVisual=function(t,r,n){var i=this._itemVisuals[t]||{};this._itemVisuals[t]=i,wc(r)?rt(i,r):i[r]=n},e.prototype.clearAllVisual=function(){this._visual={},this._itemVisuals=[]},e.prototype.setLayout=function(t,r){wc(t)?rt(this._layout,t):this._layout[t]=r},e.prototype.getLayout=function(t){return this._layout[t]},e.prototype.getItemLayout=function(t){return this._itemLayouts[t]},e.prototype.setItemLayout=function(t,r,n){this._itemLayouts[t]=n?rt(this._itemLayouts[t]||{},r):r},e.prototype.clearItemLayouts=function(){this._itemLayouts.length=0},e.prototype.setItemGraphicEl=function(t,r){var n=this.hostModel&&this.hostModel.seriesIndex;wS(n,this.dataType,t,r),this._graphicEls[t]=r},e.prototype.getItemGraphicEl=function(t){return this._graphicEls[t]},e.prototype.eachItemGraphicEl=function(t,r){R(this._graphicEls,function(n,i){n&&t&&t.call(r,n,i)})},e.prototype.cloneShallow=function(t){return t||(t=new e(this._schema?this._schema:jo(this.dimensions,this._getDimInfo,this),this.hostModel)),My(t,this),t._store=this._store,t},e.prototype.wrapMethod=function(t,r){var n=this[t];Yt(n)&&(this.__wrappedMethods=this.__wrappedMethods||[],this.__wrappedMethods.push(t),this[t]=function(){var i=n.apply(this,arguments);return r.apply(this,[i].concat(Xb(arguments)))})},e.internalField=function(){oC=function(t){var r=t._invertedIndicesMap;R(r,function(n,i){var a=t._dimInfos[i],o=a.ordinalMeta,s=t._store;if(o){n=r[i]=new yX(o.categories.length);for(var l=0;l<n.length;l++)n[l]=aC;for(var l=0;l<s.count();l++)n[s.get(a.storeDimIndex,l)]=l}})},Mc=function(t,r,n){return Xr(t._getCategory(r,n),null)},Tp=function(t,r){var n=t._idList[r];return n==null&&t._idDimIdx!=null&&(n=Mc(t,t._idDimIdx,r)),n==null&&(n=xX+r),n},Ac=function(t){return at(t)||(t=t!=null?[t]:[]),t},Ec=function(t){var r=new e(t._schema?t._schema:jo(t.dimensions,t._getDimInfo,t),t.hostModel);return My(r,t),r},My=function(t,r){R(SX.concat(r.__wrappedMethods||[]),function(n){r.hasOwnProperty(n)&&(t[n]=r[n])}),t.__wrappedMethods=r.__wrappedMethods,R(TX,function(n){t[n]=Qt(r[n])}),t._calculationInfo=rt({},r._calculationInfo)},Ay=function(t,r){var n=t._nameList,i=t._idList,a=t._nameDimIdx,o=t._idDimIdx,s=n[r],l=i[r];if(s==null&&a!=null&&(n[r]=s=Mc(t,a,r)),l==null&&o!=null&&(i[r]=l=Mc(t,o,r)),l==null&&s!=null){var u=t._nameRepeatCount,h=u[s]=(u[s]||0)+1;l=s,h>1&&(l+="__ec__"+h),i[r]=l}}}(),e}();function Ev(e,t){return Kf(e,t).dimensions}function Kf(e,t){Aw(e)||(e=Ew(e)),t=t||{};var r=t.coordDimensions||[],n=t.dimensionsDefine||e.dimensionsDefine||[],i=Ut(),a=[],o=wX(e,r,n,t.dimensionsCount),s=t.canOmitUnusedDimensions&&$F(o),l=n===e.dimensionsDefine,u=l?qF(e):ZF(n),h=t.encodeDefine;!h&&t.encodeDefaulter&&(h=t.encodeDefaulter(e,o));for(var f=Ut(h),c=new tF(o),d=0;d<c.length;d++)c[d]=-1;function v(b){var A=c[b];if(A<0){var E=n[b],C=Kt(E)?E:{name:E},D=new Kg,L=C.name;L!=null&&u.get(L)!=null&&(D.name=D.displayName=L),C.type!=null&&(D.type=C.type),C.displayName!=null&&(D.displayName=C.displayName);var P=a.length;return c[b]=P,D.storeDimIndex=b,a.push(D),D}return a[A]}if(!s)for(var d=0;d<o;d++)v(d);f.each(function(b,A){var E=er(b).slice();if(E.length===1&&!Ct(E[0])&&E[0]<0){f.set(A,!1);return}var C=f.set(A,[]);R(E,function(D,L){var P=Ct(D)?u.get(D):D;P!=null&&P<o&&(C[L]=P,g(v(P),A,L))})});var p=0;R(r,function(b){var A,E,C,D;if(Ct(b))A=b,D={};else{D=b,A=D.name;var L=D.ordinalMeta;D.ordinalMeta=null,D=rt({},D),D.ordinalMeta=L,E=D.dimsDef,C=D.otherDims,D.name=D.coordDim=D.coordDimIndex=D.dimsDef=D.otherDims=null}var P=f.get(A);if(P!==!1){if(P=er(P),!P.length)for(var N=0;N<(E&&E.length||1);N++){for(;p<o&&v(p).coordDim!=null;)p++;p<o&&P.push(p++)}R(P,function(O,I){var k=v(O);if(l&&D.type!=null&&(k.type=D.type),g(Vt(k,D),A,I),k.name==null&&E){var z=E[I];!Kt(z)&&(z={name:z}),k.name=k.displayName=z.name,k.defaultTooltip=z.defaultTooltip}C&&Vt(k.otherDims,C)})}});function g(b,A,E){N3.get(A)!=null?b.otherDims[A]=E:(b.coordDim=A,b.coordDimIndex=E,i.set(A,!0))}var m=t.generateCoord,_=t.generateCoordCount,y=_!=null;_=m?_||1:0;var x=m||"value";function T(b){b.name==null&&(b.name=b.coordDim)}if(s)R(a,function(b){T(b)}),a.sort(function(b,A){return b.storeDimIndex-A.storeDimIndex});else for(var S=0;S<o;S++){var M=v(S),w=M.coordDim;w==null&&(M.coordDim=MX(x,i,y),M.coordDimIndex=0,(!m||_<=0)&&(M.isExtraCoord=!0),_--),T(M),M.type==null&&(U3(e,S)===yn.Must||M.isExtraCoord&&(M.otherDims.itemName!=null||M.otherDims.seriesName!=null))&&(M.type="ordinal")}return bX(a),new XF({source:e,dimensions:a,fullDimensionCount:o,dimensionOmitted:s})}function bX(e){for(var t=Ut(),r=0;r<e.length;r++){var n=e[r],i=n.name,a=t.get(i)||0;a>0&&(n.name=i+(a-1)),a++,t.set(i,a)}}function wX(e,t,r,n){var i=Math.max(e.dimensionsDetectedCount||1,t.length,r.length,n||0);return R(t,function(a){var o;Kt(a)&&(o=a.dimsDef)&&(i=Math.max(i,o.length))}),i}function MX(e,t,r){if(r||t.hasKey(e)){for(var n=0;t.hasKey(e+n);)n++;e+=n}return t.set(e,!0),e}var AX=function(){function e(t){this.coordSysDims=[],this.axisMap=Ut(),this.categoryAxisMap=Ut(),this.coordSysName=t}return e}();function EX(e){var t=e.get("coordinateSystem"),r=new AX(t),n=CX[t];if(n)return n(e,r,r.axisMap,r.categoryAxisMap),r}var CX={cartesian2d:function(e,t,r,n){var i=e.getReferringComponents("xAxis",zr).models[0],a=e.getReferringComponents("yAxis",zr).models[0];t.coordSysDims=["x","y"],r.set("x",i),r.set("y",a),oh(i)&&(n.set("x",i),t.firstCategoryDimIndex=0),oh(a)&&(n.set("y",a),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},singleAxis:function(e,t,r,n){var i=e.getReferringComponents("singleAxis",zr).models[0];t.coordSysDims=["single"],r.set("single",i),oh(i)&&(n.set("single",i),t.firstCategoryDimIndex=0)},polar:function(e,t,r,n){var i=e.getReferringComponents("polar",zr).models[0],a=i.findAxisModel("radiusAxis"),o=i.findAxisModel("angleAxis");t.coordSysDims=["radius","angle"],r.set("radius",a),r.set("angle",o),oh(a)&&(n.set("radius",a),t.firstCategoryDimIndex=0),oh(o)&&(n.set("angle",o),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=1))},geo:function(e,t,r,n){t.coordSysDims=["lng","lat"]},parallel:function(e,t,r,n){var i=e.ecModel,a=i.getComponent("parallel",e.get("parallelIndex")),o=t.coordSysDims=a.dimensions.slice();R(a.parallelAxisIndex,function(s,l){var u=i.getComponent("parallelAxis",s),h=o[l];r.set(h,u),oh(u)&&(n.set(h,u),t.firstCategoryDimIndex==null&&(t.firstCategoryDimIndex=l))})}};function oh(e){return e.get("type")==="category"}function KF(e,t,r){r=r||{};var n=r.byIndex,i=r.stackedCoordDimension,a,o,s;DX(t)?a=t:(o=t.schema,a=o.dimensions,s=t.store);var l=!!(e&&e.get("stack")),u,h,f,c;if(R(a,function(_,y){Ct(_)&&(a[y]=_={name:_}),l&&!_.isExtraCoord&&(!n&&!u&&_.ordinalMeta&&(u=_),!h&&_.type!=="ordinal"&&_.type!=="time"&&(!i||i===_.coordDim)&&(h=_))}),h&&!n&&!u&&(n=!0),h){f="__\0ecstackresult_"+e.id,c="__\0ecstackedover_"+e.id,u&&(u.createInvertedIndices=!0);var d=h.coordDim,v=h.type,p=0;R(a,function(_){_.coordDim===d&&p++});var g={name:f,coordDim:d,coordDimIndex:p,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length},m={name:c,coordDim:c,coordDimIndex:p+1,type:v,isExtraCoord:!0,isCalculationCoord:!0,storeDimIndex:a.length+1};o?(s&&(g.storeDimIndex=s.ensureCalculationDimension(c,v),m.storeDimIndex=s.ensureCalculationDimension(f,v)),o.appendCalculationDimension(g),o.appendCalculationDimension(m)):(a.push(g),a.push(m))}return{stackedDimension:h&&h.name,stackedByDimension:u&&u.name,isStackedByIndex:n,stackedOverDimension:c,stackResultDimension:f}}function DX(e){return!YF(e.schema)}function Oo(e,t){return!!t&&t===e.getCalculationInfo("stackedDimension")}function zw(e,t){return Oo(e,t)?e.getCalculationInfo("stackResultDimension"):t}function LX(e,t){var r=e.get("coordinateSystem"),n=Yf.get(r),i;return t&&t.coordSysDims&&(i=ft(t.coordSysDims,function(a){var o={name:a},s=t.axisMap.get(a);if(s){var l=s.get("type");o.type=Nm(l)}return o})),i||(i=n&&(n.getDimensionsInfo?n.getDimensionsInfo():n.dimensions.slice())||["x","y"]),i}function RX(e,t,r){var n,i;return r&&R(e,function(a,o){var s=a.coordDim,l=r.categoryAxisMap.get(s);l&&(n==null&&(n=o),a.ordinalMeta=l.getOrdinalMeta(),t&&(a.createInvertedIndices=!0)),a.otherDims.itemName!=null&&(i=!0)}),!i&&n!=null&&(e[n].otherDims.itemName=0),n}function Qa(e,t,r){r=r||{};var n=t.getSourceManager(),i,a=!1;e?(a=!0,i=Ew(e)):(i=n.getSource(),a=i.sourceFormat===qi);var o=EX(t),s=LX(t,o),l=r.useEncodeDefaulter,u=Yt(l)?l:l?ue(B3,s,t):null,h={coordDimensions:s,generateCoord:r.generateCoord,encodeDefine:t.getEncode(),encodeDefaulter:u,canOmitUnusedDimensions:!a},f=Kf(i,h),c=RX(f.dimensions,r.createInvertedIndices,o),d=a?null:n.getSharedDataStore(f),v=KF(t,{schema:f,store:d}),p=new xr(f,t);p.setCalculationInfo(v);var g=c!=null&&PX(i)?function(m,_,y,x){return x===c?y:this.defaultDimValueGetter(m,_,y,x)}:null;return p.hasItemOption=!1,p.initData(a?i:d,null,g),p}function PX(e){if(e.sourceFormat===qi){var t=IX(e.data||[]);return!at(Uf(t))}}function IX(e){for(var t=0;t<e.length&&e[t]==null;)t++;return e[t]}var to=function(){function e(t){this._setting=t||{},this._extent=[1/0,-1/0]}return e.prototype.getSetting=function(t){return this._setting[t]},e.prototype.unionExtent=function(t){var r=this._extent;t[0]<r[0]&&(r[0]=t[0]),t[1]>r[1]&&(r[1]=t[1])},e.prototype.unionExtentFromData=function(t,r){this.unionExtent(t.getApproximateExtent(r))},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.setExtent=function(t,r){var n=this._extent;isNaN(t)||(n[0]=t),isNaN(r)||(n[1]=r)},e.prototype.isInExtentRange=function(t){return this._extent[0]<=t&&this._extent[1]>=t},e.prototype.isBlank=function(){return this._isBlank},e.prototype.setBlank=function(t){this._isBlank=t},e}();C_(to);var NX=0,Om=function(){function e(t){this.categories=t.categories||[],this._needCollect=t.needCollect,this._deduplication=t.deduplication,this.uid=++NX}return e.createByAxisModel=function(t){var r=t.option,n=r.data,i=n&&ft(n,OX);return new e({categories:i,needCollect:!i,deduplication:r.dedplication!==!1})},e.prototype.getOrdinal=function(t){return this._getOrCreateMap().get(t)},e.prototype.parseAndCollect=function(t){var r,n=this._needCollect;if(!Ct(t)&&!n)return t;if(n&&!this._deduplication)return r=this.categories.length,this.categories[r]=t,r;var i=this._getOrCreateMap();return r=i.get(t),r==null&&(n?(r=this.categories.length,this.categories[r]=t,i.set(t,r)):r=NaN),r},e.prototype._getOrCreateMap=function(){return this._map||(this._map=Ut(this.categories))},e}();function OX(e){return Kt(e)&&e.value!=null?e.value:e+""}function qS(e){return e.type==="interval"||e.type==="log"}function FX(e,t,r,n){var i={},a=e[1]-e[0],o=i.interval=bO(a/t);r!=null&&o<r&&(o=i.interval=r),n!=null&&o>n&&(o=i.interval=n);var s=i.intervalPrecision=jF(o),l=i.niceTickExtent=[dr(Math.ceil(e[0]/o)*o,s),dr(Math.floor(e[1]/o)*o,s)];return BX(l,e),i}function Ey(e){var t=Math.pow(10,Qb(e)),r=e/t;return r?r===2?r=3:r===3?r=5:r*=2:r=1,dr(r*t)}function jF(e){return Oa(e)+2}function sC(e,t,r){e[t]=Math.max(Math.min(e[t],r[1]),r[0])}function BX(e,t){!isFinite(e[0])&&(e[0]=t[0]),!isFinite(e[1])&&(e[1]=t[1]),sC(e,0,t),sC(e,1,t),e[0]>e[1]&&(e[0]=e[1])}function K_(e,t){return e>=t[0]&&e<=t[1]}function j_(e,t){return t[1]===t[0]?.5:(e-t[0])/(t[1]-t[0])}function J_(e,t){return e*(t[1]-t[0])+t[0]}var Q_=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;n.type="ordinal";var i=n.getSetting("ordinalMeta");return i||(i=new Om({})),at(i)&&(i=new Om({categories:ft(i,function(a){return Kt(a)?a.value:a})})),n._ordinalMeta=i,n._extent=n.getSetting("extent")||[0,i.categories.length-1],n}return t.prototype.parse=function(r){return r==null?NaN:Ct(r)?this._ordinalMeta.getOrdinal(r):Math.round(r)},t.prototype.contain=function(r){return r=this.parse(r),K_(r,this._extent)&&this._ordinalMeta.categories[r]!=null},t.prototype.normalize=function(r){return r=this._getTickNumber(this.parse(r)),j_(r,this._extent)},t.prototype.scale=function(r){return r=Math.round(J_(r,this._extent)),this.getRawOrdinalNumber(r)},t.prototype.getTicks=function(){for(var r=[],n=this._extent,i=n[0];i<=n[1];)r.push({value:i}),i++;return r},t.prototype.getMinorTicks=function(r){},t.prototype.setSortInfo=function(r){if(r==null){this._ordinalNumbersByTick=this._ticksByOrdinalNumber=null;return}for(var n=r.ordinalNumbers,i=this._ordinalNumbersByTick=[],a=this._ticksByOrdinalNumber=[],o=0,s=this._ordinalMeta.categories.length,l=Math.min(s,n.length);o<l;++o){var u=n[o];i[o]=u,a[u]=o}for(var h=0;o<s;++o){for(;a[h]!=null;)h++;i.push(h),a[h]=o}},t.prototype._getTickNumber=function(r){var n=this._ticksByOrdinalNumber;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getRawOrdinalNumber=function(r){var n=this._ordinalNumbersByTick;return n&&r>=0&&r<n.length?n[r]:r},t.prototype.getLabel=function(r){if(!this.isBlank()){var n=this.getRawOrdinalNumber(r.value),i=this._ordinalMeta.categories[n];return i==null?"":i+""}},t.prototype.count=function(){return this._extent[1]-this._extent[0]+1},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.isInExtentRange=function(r){return r=this._getTickNumber(r),this._extent[0]<=r&&this._extent[1]>=r},t.prototype.getOrdinalMeta=function(){return this._ordinalMeta},t.prototype.calcNiceTicks=function(){},t.prototype.calcNiceExtent=function(){},t.type="ordinal",t}(to);to.registerClass(Q_);var ml=dr,Fo=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="interval",r._interval=0,r._intervalPrecision=2,r}return t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return K_(r,this._extent)},t.prototype.normalize=function(r){return j_(r,this._extent)},t.prototype.scale=function(r){return J_(r,this._extent)},t.prototype.setExtent=function(r,n){var i=this._extent;isNaN(r)||(i[0]=parseFloat(r)),isNaN(n)||(i[1]=parseFloat(n))},t.prototype.unionExtent=function(r){var n=this._extent;r[0]<n[0]&&(n[0]=r[0]),r[1]>n[1]&&(n[1]=r[1]),this.setExtent(n[0],n[1])},t.prototype.getInterval=function(){return this._interval},t.prototype.setInterval=function(r){this._interval=r,this._niceExtent=this._extent.slice(),this._intervalPrecision=jF(r)},t.prototype.getTicks=function(r){var n=this._interval,i=this._extent,a=this._niceExtent,o=this._intervalPrecision,s=[];if(!n)return s;var l=1e4;i[0]<a[0]&&(r?s.push({value:ml(a[0]-n,o)}):s.push({value:i[0]}));for(var u=a[0];u<=a[1]&&(s.push({value:u}),u=ml(u+n,o),u!==s[s.length-1].value);)if(s.length>l)return[];var h=s.length?s[s.length-1].value:a[1];return i[1]>h&&(r?s.push({value:ml(h+n,o)}):s.push({value:i[1]})),s},t.prototype.getMinorTicks=function(r){for(var n=this.getTicks(!0),i=[],a=this.getExtent(),o=1;o<n.length;o++){for(var s=n[o],l=n[o-1],u=0,h=[],f=s.value-l.value,c=f/r;u<r-1;){var d=ml(l.value+(u+1)*c);d>a[0]&&d<a[1]&&h.push(d),u++}i.push(h)}return i},t.prototype.getLabel=function(r,n){if(r==null)return"";var i=n&&n.precision;i==null?i=Oa(r.value)||0:i==="auto"&&(i=this._intervalPrecision);var a=ml(r.value,i,!0);return Mm(a)},t.prototype.calcNiceTicks=function(r,n,i){r=r||5;var a=this._extent,o=a[1]-a[0];if(isFinite(o)){o<0&&(o=-o,a.reverse());var s=FX(a,r,n,i);this._intervalPrecision=s.intervalPrecision,this._interval=s.interval,this._niceExtent=s.niceTickExtent}},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1])if(n[0]!==0){var i=Math.abs(n[0]);r.fixMax||(n[1]+=i/2),n[0]-=i/2}else n[1]=1;var a=n[1]-n[0];isFinite(a)||(n[0]=0,n[1]=1),this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval);var o=this._interval;r.fixMin||(n[0]=ml(Math.floor(n[0]/o)*o)),r.fixMax||(n[1]=ml(Math.ceil(n[1]/o)*o))},t.prototype.setNiceExtent=function(r,n){this._niceExtent=[r,n]},t.type="interval",t}(to);to.registerClass(Fo);var JF=typeof Float32Array<"u",UX=JF?Float32Array:Array;function Ba(e){return at(e)?JF?new Float32Array(e):e:new UX(e)}var $S="__ec_stack_";function QF(e){return e.get("stack")||$S+e.seriesIndex}function kw(e){return e.dim+e.index}function zX(e){var t=[],r=e.axis,n="axis0";if(r.type==="category"){for(var i=r.getBandWidth(),a=0;a<e.count;a++)t.push(Vt({bandWidth:i,axisKey:n,stackId:$S+a},e));for(var o=rB(t),s=[],a=0;a<e.count;a++){var l=o[n][$S+a];l.offsetCenter=l.offset+l.width/2,s.push(l)}return s}}function tB(e,t){var r=[];return t.eachSeriesByType(e,function(n){aB(n)&&r.push(n)}),r}function kX(e){var t={};R(e,function(l){var u=l.coordinateSystem,h=u.getBaseAxis();if(!(h.type!=="time"&&h.type!=="value"))for(var f=l.getData(),c=h.dim+"_"+h.index,d=f.getDimensionIndex(f.mapDimension(h.dim)),v=f.getStore(),p=0,g=v.count();p<g;++p){var m=v.get(d,p);t[c]?t[c].push(m):t[c]=[m]}});var r={};for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];if(i){i.sort(function(l,u){return l-u});for(var a=null,o=1;o<i.length;++o){var s=i[o]-i[o-1];s>0&&(a=a===null?s:Math.min(a,s))}r[n]=a}}return r}function eB(e){var t=kX(e),r=[];return R(e,function(n){var i=n.coordinateSystem,a=i.getBaseAxis(),o=a.getExtent(),s;if(a.type==="category")s=a.getBandWidth();else if(a.type==="value"||a.type==="time"){var l=a.dim+"_"+a.index,u=t[l],h=Math.abs(o[1]-o[0]),f=a.scale.getExtent(),c=Math.abs(f[1]-f[0]);s=u?h/c*u:h}else{var d=n.getData();s=Math.abs(o[1]-o[0])/d.count()}var v=Tt(n.get("barWidth"),s),p=Tt(n.get("barMaxWidth"),s),g=Tt(n.get("barMinWidth")||(oB(n)?.5:1),s),m=n.get("barGap"),_=n.get("barCategoryGap");r.push({bandWidth:s,barWidth:v,barMaxWidth:p,barMinWidth:g,barGap:m,barCategoryGap:_,axisKey:kw(a),stackId:QF(n)})}),rB(r)}function rB(e){var t={};R(e,function(n,i){var a=n.axisKey,o=n.bandWidth,s=t[a]||{bandWidth:o,remainedWidth:o,autoWidthCount:0,categoryGap:null,gap:"20%",stacks:{}},l=s.stacks;t[a]=s;var u=n.stackId;l[u]||s.autoWidthCount++,l[u]=l[u]||{width:0,maxWidth:0};var h=n.barWidth;h&&!l[u].width&&(l[u].width=h,h=Math.min(s.remainedWidth,h),s.remainedWidth-=h);var f=n.barMaxWidth;f&&(l[u].maxWidth=f);var c=n.barMinWidth;c&&(l[u].minWidth=c);var d=n.barGap;d!=null&&(s.gap=d);var v=n.barCategoryGap;v!=null&&(s.categoryGap=v)});var r={};return R(t,function(n,i){r[i]={};var a=n.stacks,o=n.bandWidth,s=n.categoryGap;if(s==null){var l=be(a).length;s=Math.max(35-l*4,15)+"%"}var u=Tt(s,o),h=Tt(n.gap,1),f=n.remainedWidth,c=n.autoWidthCount,d=(f-u)/(c+(c-1)*h);d=Math.max(d,0),R(a,function(m){var _=m.maxWidth,y=m.minWidth;if(m.width){var x=m.width;_&&(x=Math.min(x,_)),y&&(x=Math.max(x,y)),m.width=x,f-=x+h*x,c--}else{var x=d;_&&_<x&&(x=Math.min(_,f)),y&&y>x&&(x=y),x!==d&&(m.width=x,f-=x+h*x,c--)}}),d=(f-u)/(c+(c-1)*h),d=Math.max(d,0);var v=0,p;R(a,function(m,_){m.width||(m.width=d),p=m,v+=m.width*(1+h)}),p&&(v-=p.width*h);var g=-v/2;R(a,function(m,_){r[i][_]=r[i][_]||{bandWidth:o,offset:g,width:m.width},g+=m.width*(1+h)})}),r}function GX(e,t,r){if(e&&t){var n=e[kw(t)];return n}}function nB(e,t){var r=tB(e,t),n=eB(r);R(r,function(i){var a=i.getData(),o=i.coordinateSystem,s=o.getBaseAxis(),l=QF(i),u=n[kw(s)][l],h=u.offset,f=u.width;a.setLayout({bandWidth:u.bandWidth,offset:h,size:f})})}function iB(e){return{seriesType:e,plan:Zf(),reset:function(t){if(aB(t)){var r=t.getData(),n=t.coordinateSystem,i=n.getBaseAxis(),a=n.getOtherAxis(i),o=r.getDimensionIndex(r.mapDimension(a.dim)),s=r.getDimensionIndex(r.mapDimension(i.dim)),l=t.get("showBackground",!0),u=r.mapDimension(a.dim),h=r.getCalculationInfo("stackResultDimension"),f=Oo(r,u)&&!!r.getCalculationInfo("stackedOnSeries"),c=a.isHorizontal(),d=VX(i,a),v=oB(t),p=t.get("barMinHeight")||0,g=h&&r.getDimensionIndex(h),m=r.getLayout("size"),_=r.getLayout("offset");return{progress:function(y,x){for(var T=y.count,S=v&&Ba(T*3),M=v&&l&&Ba(T*3),w=v&&Ba(T),b=n.master.getRect(),A=c?b.width:b.height,E,C=x.getStore(),D=0;(E=y.next())!=null;){var L=C.get(f?g:o,E),P=C.get(s,E),N=d,O=void 0;f&&(O=+L-C.get(o,E));var I=void 0,k=void 0,z=void 0,X=void 0;if(c){var Y=n.dataToPoint([L,P]);if(f){var $=n.dataToPoint([O,P]);N=$[0]}I=N,k=Y[1]+_,z=Y[0]-N,X=m,Math.abs(z)<p&&(z=(z<0?-1:1)*p)}else{var Y=n.dataToPoint([P,L]);if(f){var $=n.dataToPoint([P,O]);N=$[1]}I=Y[0]+_,k=N,z=m,X=Y[1]-N,Math.abs(X)<p&&(X=(X<=0?-1:1)*p)}v?(S[D]=I,S[D+1]=k,S[D+2]=c?z:X,M&&(M[D]=c?b.x:I,M[D+1]=c?k:b.y,M[D+2]=A),w[E]=E):x.setItemLayout(E,{x:I,y:k,width:z,height:X}),D+=3}v&&x.setLayout({largePoints:S,largeDataIndices:w,largeBackgroundPoints:M,valueAxisHorizontal:c})}}}}}}function aB(e){return e.coordinateSystem&&e.coordinateSystem.type==="cartesian2d"}function oB(e){return e.pipelineContext&&e.pipelineContext.large}function VX(e,t){var r=t.model.get("startValue");return r||(r=0),t.toGlobalCoord(t.dataToCoord(t.type==="log"?r>0?r:1:r))}var HX=function(e,t,r,n){for(;r<n;){var i=r+n>>>1;e[i][1]<t?r=i+1:n=i}return r},Gw=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="time",n}return t.prototype.getLabel=function(r){var n=this.getSetting("useUTC");return z_(r.value,jE[EW(tf(this._minLevelUnit))]||jE.second,n,this.getSetting("locale"))},t.prototype.getFormattedLabel=function(r,n,i){var a=this.getSetting("useUTC"),o=this.getSetting("locale");return CW(r,n,i,o,a)},t.prototype.getTicks=function(){var r=this._interval,n=this._extent,i=[];if(!r)return i;i.push({value:n[0],level:0});var a=this.getSetting("useUTC"),o=KX(this._minLevelUnit,this._approxInterval,a,n);return i=i.concat(o),i.push({value:n[1],level:0}),i},t.prototype.calcNiceExtent=function(r){var n=this._extent;if(n[0]===n[1]&&(n[0]-=zi,n[1]+=zi),n[1]===-1/0&&n[0]===1/0){var i=new Date;n[1]=+new Date(i.getFullYear(),i.getMonth(),i.getDate()),n[0]=n[1]-zi}this.calcNiceTicks(r.splitNumber,r.minInterval,r.maxInterval)},t.prototype.calcNiceTicks=function(r,n,i){r=r||10;var a=this._extent,o=a[1]-a[0];this._approxInterval=o/r,n!=null&&this._approxInterval<n&&(this._approxInterval=n),i!=null&&this._approxInterval>i&&(this._approxInterval=i);var s=bp.length,l=Math.min(HX(bp,this._approxInterval,0,s),s-1);this._interval=bp[l][1],this._minLevelUnit=bp[Math.max(l-1,0)][0]},t.prototype.parse=function(r){return Be(r)?r:+Xi(r)},t.prototype.contain=function(r){return K_(this.parse(r),this._extent)},t.prototype.normalize=function(r){return j_(this.parse(r),this._extent)},t.prototype.scale=function(r){return J_(r,this._extent)},t.type="time",t}(Fo),bp=[["second",mw],["minute",_w],["hour",wd],["quarter-day",wd*6],["half-day",wd*12],["day",zi*1.2],["half-week",zi*3.5],["week",zi*7],["month",zi*31],["quarter",zi*95],["half-year",KE/2],["year",KE]];function WX(e,t,r,n){var i=Xi(t),a=Xi(r),o=function(v){return JE(i,v,n)===JE(a,v,n)},s=function(){return o("year")},l=function(){return s()&&o("month")},u=function(){return l()&&o("day")},h=function(){return u()&&o("hour")},f=function(){return h()&&o("minute")},c=function(){return f()&&o("second")},d=function(){return c()&&o("millisecond")};switch(e){case"year":return s();case"month":return l();case"day":return u();case"hour":return h();case"minute":return f();case"second":return c();case"millisecond":return d()}}function XX(e,t){return e/=zi,e>16?16:e>7.5?7:e>3.5?4:e>1.5?2:1}function YX(e){var t=30*zi;return e/=t,e>6?6:e>3?3:e>2?2:1}function ZX(e){return e/=wd,e>12?12:e>6?6:e>3.5?4:e>2?2:1}function lC(e,t){return e/=t?_w:mw,e>30?30:e>20?20:e>15?15:e>10?10:e>5?5:e>2?2:1}function qX(e){return bO(e)}function $X(e,t,r){var n=new Date(e);switch(tf(t)){case"year":case"month":n[b3(r)](0);case"day":n[w3(r)](1);case"hour":n[M3(r)](0);case"minute":n[A3(r)](0);case"second":n[E3(r)](0),n[C3(r)](0)}return n.getTime()}function KX(e,t,r,n){var i=1e4,a=S3,o=0;function s(A,E,C,D,L,P,N){for(var O=new Date(E),I=E,k=O[D]();I<C&&I<=n[1];)N.push({value:I}),k+=A,O[L](k),I=O.getTime();N.push({value:I,notAdd:!0})}function l(A,E,C){var D=[],L=!E.length;if(!WX(tf(A),n[0],n[1],r)){L&&(E=[{value:$X(new Date(n[0]),A,r)},{value:n[1]}]);for(var P=0;P<E.length-1;P++){var N=E[P].value,O=E[P+1].value;if(N!==O){var I=void 0,k=void 0,z=void 0,X=!1;switch(A){case"year":I=Math.max(1,Math.round(t/zi/365)),k=yw(r),z=DW(r);break;case"half-year":case"quarter":case"month":I=YX(t),k=ef(r),z=b3(r);break;case"week":case"half-week":case"day":I=XX(t),k=k_(r),z=w3(r),X=!0;break;case"half-day":case"quarter-day":case"hour":I=ZX(t),k=Vd(r),z=M3(r);break;case"minute":I=lC(t,!0),k=G_(r),z=A3(r);break;case"second":I=lC(t,!1),k=V_(r),z=E3(r);break;case"millisecond":I=qX(t),k=H_(r),z=C3(r);break}s(I,N,O,k,z,X,D),A==="year"&&C.length>1&&P===0&&C.unshift({value:C[0].value-I})}}for(var P=0;P<D.length;P++)C.push(D[P]);return D}}for(var u=[],h=[],f=0,c=0,d=0;d<a.length&&o++<i;++d){var v=tf(a[d]);if(AW(a[d])){l(a[d],u[u.length-1]||[],h);var p=a[d+1]?tf(a[d+1]):null;if(v!==p){if(h.length){c=f,h.sort(function(A,E){return A.value-E.value});for(var g=[],m=0;m<h.length;++m){var _=h[m].value;(m===0||h[m-1].value!==_)&&(g.push(h[m]),_>=n[0]&&_<=n[1]&&f++)}var y=(n[1]-n[0])/t;if(f>y*1.5&&c>y/1.5||(u.push(g),f>y||e===a[d]))break}h=[]}}}for(var x=Xe(ft(u,function(A){return Xe(A,function(E){return E.value>=n[0]&&E.value<=n[1]&&!E.notAdd})}),function(A){return A.length>0}),T=[],S=x.length-1,d=0;d<x.length;++d)for(var M=x[d],w=0;w<M.length;++w)T.push({value:M[w].value,level:S-d});T.sort(function(A,E){return A.value-E.value});for(var b=[],d=0;d<T.length;++d)(d===0||T[d].value!==T[d-1].value)&&b.push(T[d]);return b}to.registerClass(Gw);var uC=to.prototype,Cd=Fo.prototype,jX=dr,JX=Math.floor,QX=Math.ceil,wp=Math.pow,Qi=Math.log,Vw=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="log",r.base=10,r._originalScale=new Fo,r._interval=0,r}return t.prototype.getTicks=function(r){var n=this._originalScale,i=this._extent,a=n.getExtent(),o=Cd.getTicks.call(this,r);return ft(o,function(s){var l=s.value,u=dr(wp(this.base,l));return u=l===i[0]&&this._fixMin?Mp(u,a[0]):u,u=l===i[1]&&this._fixMax?Mp(u,a[1]):u,{value:u}},this)},t.prototype.setExtent=function(r,n){var i=Qi(this.base);r=Qi(Math.max(0,r))/i,n=Qi(Math.max(0,n))/i,Cd.setExtent.call(this,r,n)},t.prototype.getExtent=function(){var r=this.base,n=uC.getExtent.call(this);n[0]=wp(r,n[0]),n[1]=wp(r,n[1]);var i=this._originalScale,a=i.getExtent();return this._fixMin&&(n[0]=Mp(n[0],a[0])),this._fixMax&&(n[1]=Mp(n[1],a[1])),n},t.prototype.unionExtent=function(r){this._originalScale.unionExtent(r);var n=this.base;r[0]=Qi(r[0])/Qi(n),r[1]=Qi(r[1])/Qi(n),uC.unionExtent.call(this,r)},t.prototype.unionExtentFromData=function(r,n){this.unionExtent(r.getApproximateExtent(n))},t.prototype.calcNiceTicks=function(r){r=r||10;var n=this._extent,i=n[1]-n[0];if(!(i===1/0||i<=0)){var a=o5(i),o=r/i*a;for(o<=.5&&(a*=10);!isNaN(a)&&Math.abs(a)<1&&Math.abs(a)>0;)a*=10;var s=[dr(QX(n[0]/a)*a),dr(JX(n[1]/a)*a)];this._interval=a,this._niceExtent=s}},t.prototype.calcNiceExtent=function(r){Cd.calcNiceExtent.call(this,r),this._fixMin=r.fixMin,this._fixMax=r.fixMax},t.prototype.parse=function(r){return r},t.prototype.contain=function(r){return r=Qi(r)/Qi(this.base),K_(r,this._extent)},t.prototype.normalize=function(r){return r=Qi(r)/Qi(this.base),j_(r,this._extent)},t.prototype.scale=function(r){return r=J_(r,this._extent),wp(this.base,r)},t.type="log",t}(to),sB=Vw.prototype;sB.getMinorTicks=Cd.getMinorTicks;sB.getLabel=Cd.getLabel;function Mp(e,t){return jX(e,Oa(t))}to.registerClass(Vw);var t9=function(){function e(t,r,n){this._prepareParams(t,r,n)}return e.prototype._prepareParams=function(t,r,n){n[1]<n[0]&&(n=[NaN,NaN]),this._dataMin=n[0],this._dataMax=n[1];var i=this._isOrdinal=t.type==="ordinal";this._needCrossZero=t.type==="interval"&&r.getNeedCrossZero&&r.getNeedCrossZero();var a=r.get("min",!0);a==null&&(a=r.get("startValue",!0));var o=this._modelMinRaw=a;Yt(o)?this._modelMinNum=Ap(t,o({min:n[0],max:n[1]})):o!=="dataMin"&&(this._modelMinNum=Ap(t,o));var s=this._modelMaxRaw=r.get("max",!0);if(Yt(s)?this._modelMaxNum=Ap(t,s({min:n[0],max:n[1]})):s!=="dataMax"&&(this._modelMaxNum=Ap(t,s)),i)this._axisDataLen=r.getCategories().length;else{var l=r.get("boundaryGap"),u=at(l)?l:[l||0,l||0];typeof u[0]=="boolean"||typeof u[1]=="boolean"?this._boundaryGapInner=[0,0]:this._boundaryGapInner=[_a(u[0],1),_a(u[1],1)]}},e.prototype.calculate=function(){var t=this._isOrdinal,r=this._dataMin,n=this._dataMax,i=this._axisDataLen,a=this._boundaryGapInner,o=t?null:n-r||Math.abs(r),s=this._modelMinRaw==="dataMin"?r:this._modelMinNum,l=this._modelMaxRaw==="dataMax"?n:this._modelMaxNum,u=s!=null,h=l!=null;s==null&&(s=t?i?0:NaN:r-a[0]*o),l==null&&(l=t?i?i-1:NaN:n+a[1]*o),(s==null||!isFinite(s))&&(s=NaN),(l==null||!isFinite(l))&&(l=NaN);var f=Id(s)||Id(l)||t&&!i;this._needCrossZero&&(s>0&&l>0&&!u&&(s=0),s<0&&l<0&&!h&&(l=0));var c=this._determinedMin,d=this._determinedMax;return c!=null&&(s=c,u=!0),d!=null&&(l=d,h=!0),{min:s,max:l,minFixed:u,maxFixed:h,isBlank:f}},e.prototype.modifyDataMinMax=function(t,r){this[r9[t]]=r},e.prototype.setDeterminedMinMax=function(t,r){var n=e9[t];this[n]=r},e.prototype.freeze=function(){this.frozen=!0},e}(),e9={min:"_determinedMin",max:"_determinedMax"},r9={min:"_dataMin",max:"_dataMax"};function lB(e,t,r){var n=e.rawExtentInfo;return n||(n=new t9(e,t,r),e.rawExtentInfo=n,n)}function Ap(e,t){return t==null?null:Id(t)?NaN:e.parse(t)}function uB(e,t){var r=e.type,n=lB(e,t,e.getExtent()).calculate();e.setBlank(n.isBlank);var i=n.min,a=n.max,o=t.ecModel;if(o&&r==="time"){var s=tB("bar",o),l=!1;if(R(s,function(f){l=l||f.getBaseAxis()===t.axis}),l){var u=eB(s),h=n9(i,a,t,u);i=h.min,a=h.max}}return{extent:[i,a],fixMin:n.minFixed,fixMax:n.maxFixed}}function n9(e,t,r,n){var i=r.axis.getExtent(),a=Math.abs(i[1]-i[0]),o=GX(n,r.axis);if(o===void 0)return{min:e,max:t};var s=1/0;R(o,function(d){s=Math.min(d.offset,s)});var l=-1/0;R(o,function(d){l=Math.max(d.offset+d.width,l)}),s=Math.abs(s),l=Math.abs(l);var u=s+l,h=t-e,f=1-(s+l)/a,c=h/f-h;return t+=c*(l/u),e-=c*(s/u),{min:e,max:t}}function Au(e,t){var r=t,n=uB(e,r),i=n.extent,a=r.get("splitNumber");e instanceof Vw&&(e.base=r.get("logBase"));var o=e.type,s=r.get("interval"),l=o==="interval"||o==="time";e.setExtent(i[0],i[1]),e.calcNiceExtent({splitNumber:a,fixMin:n.fixMin,fixMax:n.fixMax,minInterval:l?r.get("minInterval"):null,maxInterval:l?r.get("maxInterval"):null}),s!=null&&e.setInterval&&e.setInterval(s)}function Cv(e,t){if(t=t||e.get("type"),t)switch(t){case"category":return new Q_({ordinalMeta:e.getOrdinalMeta?e.getOrdinalMeta():e.getCategories(),extent:[1/0,-1/0]});case"time":return new Gw({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new(to.getClass(t)||Fo)}}function i9(e){var t=e.scale.getExtent(),r=t[0],n=t[1];return!(r>0&&n>0||r<0&&n<0)}function jf(e){var t=e.getLabelModel().get("formatter"),r=e.type==="category"?e.scale.getExtent()[0]:null;return e.scale.type==="time"?function(n){return function(i,a){return e.scale.getFormattedLabel(i,a,n)}}(t):Ct(t)?function(n){return function(i){var a=e.scale.getLabel(i),o=n.replace("{value}",a??"");return o}}(t):Yt(t)?function(n){return function(i,a){return r!=null&&(a=i.value-r),n(Hw(e,i),a,i.level!=null?{level:i.level}:null)}}(t):function(n){return e.scale.getLabel(n)}}function Hw(e,t){return e.type==="category"?e.scale.getLabel(t):t.value}function a9(e){var t=e.model,r=e.scale;if(!(!t.get(["axisLabel","show"])||r.isBlank())){var n,i,a=r.getExtent();r instanceof Q_?i=r.count():(n=r.getTicks(),i=n.length);var o=e.getLabelModel(),s=jf(e),l,u=1;i>40&&(u=Math.ceil(i/40));for(var h=0;h<i;h+=u){var f=n?n[h]:{value:a[0]+h},c=s(f,h),d=o.getTextRect(c),v=o9(d,o.get("rotate")||0);l?l.union(v):l=v}return l}}function o9(e,t){var r=t*Math.PI/180,n=e.width,i=e.height,a=n*Math.abs(Math.cos(r))+Math.abs(i*Math.sin(r)),o=n*Math.abs(Math.sin(r))+Math.abs(i*Math.cos(r)),s=new fe(e.x,e.y,a,o);return s}function Ww(e){var t=e.get("interval");return t??"auto"}function hB(e){return e.type==="category"&&Ww(e.getLabelModel())===0}function Fm(e,t){var r={};return R(e.mapDimensionsAll(t),function(n){r[zw(e,n)]=!0}),be(r)}function s9(e,t,r){t&&R(Fm(t,r),function(n){var i=t.getApproximateExtent(n);i[0]<e[0]&&(e[0]=i[0]),i[1]>e[1]&&(e[1]=i[1])})}var Jf=function(){function e(){}return e.prototype.getNeedCrossZero=function(){var t=this.option;return!t.scale},e.prototype.getCoordSysModel=function(){},e}();function l9(e){return Qa(null,e)}var Xw={isDimensionStacked:Oo,enableDataStack:KF,getStackedDimension:zw};function Yw(e,t){var r=t;t instanceof Ie||(r=new Ie(t));var n=Cv(r);return n.setExtent(e[0],e[1]),Au(n,r),n}function u9(e){Nr(e,Jf)}var h9=1e-8;function hC(e,t){return Math.abs(e-t)<h9}function Hl(e,t,r){var n=0,i=e[0];if(!i)return!1;for(var a=1;a<e.length;a++){var o=e[a];n+=po(i[0],i[1],o[0],o[1],t,r),i=o}var s=e[0];return(!hC(i[0],s[0])||!hC(i[1],s[1]))&&(n+=po(i[0],i[1],s[0],s[1],t,r)),n!==0}var f9=[];function Cy(e,t){for(var r=0;r<e.length;r++)en(e[r],e[r],t)}function fC(e,t,r,n){for(var i=0;i<e.length;i++){var a=e[i];n&&(a=n.project(a)),a&&isFinite(a[0])&&isFinite(a[1])&&(ms(t,t,a),_s(r,r,a))}}function c9(e){for(var t=0,r=0,n=0,i=e.length,a=e[i-1][0],o=e[i-1][1],s=0;s<i;s++){var l=e[s][0],u=e[s][1],h=a*u-l*o;t+=h,r+=(a+l)*h,n+=(o+u)*h,a=l,o=u}return t?[r/t/3,n/t/3,t]:[e[0][0]||0,e[0][1]||0]}var fB=function(){function e(t){this.name=t}return e.prototype.setCenter=function(t){this._center=t},e.prototype.getCenter=function(){var t=this._center;return t||(t=this._center=this.calcCenter()),t},e}(),cC=function(){function e(t,r){this.type="polygon",this.exterior=t,this.interiors=r}return e}(),dC=function(){function e(t){this.type="linestring",this.points=t}return e}(),cB=function(e){q(t,e);function t(r,n,i){var a=e.call(this,r)||this;return a.type="geoJSON",a.geometries=n,a._center=i&&[i[0],i[1]],a}return t.prototype.calcCenter=function(){for(var r=this.geometries,n,i=0,a=0;a<r.length;a++){var o=r[a],s=o.exterior,l=s&&s.length;l>i&&(n=o,i=l)}if(n)return c9(n.exterior);var u=this.getBoundingRect();return[u.x+u.width/2,u.y+u.height/2]},t.prototype.getBoundingRect=function(r){var n=this._rect;if(n&&!r)return n;var i=[1/0,1/0],a=[-1/0,-1/0],o=this.geometries;return R(o,function(s){s.type==="polygon"?fC(s.exterior,i,a,r):R(s.points,function(l){fC(l,i,a,r)})}),isFinite(i[0])&&isFinite(i[1])&&isFinite(a[0])&&isFinite(a[1])||(i[0]=i[1]=a[0]=a[1]=0),n=new fe(i[0],i[1],a[0]-i[0],a[1]-i[1]),r||(this._rect=n),n},t.prototype.contain=function(r){var n=this.getBoundingRect(),i=this.geometries;if(!n.contain(r[0],r[1]))return!1;t:for(var a=0,o=i.length;a<o;a++){var s=i[a];if(s.type==="polygon"){var l=s.exterior,u=s.interiors;if(Hl(l,r[0],r[1])){for(var h=0;h<(u?u.length:0);h++)if(Hl(u[h],r[0],r[1]))continue t;return!0}}}return!1},t.prototype.transformTo=function(r,n,i,a){var o=this.getBoundingRect(),s=o.width/o.height;i?a||(a=i/s):i=s*a;for(var l=new fe(r,n,i,a),u=o.calculateTransform(l),h=this.geometries,f=0;f<h.length;f++){var c=h[f];c.type==="polygon"?(Cy(c.exterior,u),R(c.interiors,function(d){Cy(d,u)})):R(c.points,function(d){Cy(d,u)})}o=this._rect,o.copy(l),this._center=[o.x+o.width/2,o.y+o.height/2]},t.prototype.cloneShallow=function(r){r==null&&(r=this.name);var n=new t(r,this.geometries,this._center);return n._rect=this._rect,n.transformTo=null,n},t}(fB),d9=function(e){q(t,e);function t(r,n){var i=e.call(this,r)||this;return i.type="geoSVG",i._elOnlyForCalculate=n,i}return t.prototype.calcCenter=function(){for(var r=this._elOnlyForCalculate,n=r.getBoundingRect(),i=[n.x+n.width/2,n.y+n.height/2],a=b_(f9),o=r;o&&!o.isGeoSVGGraphicRoot;)wo(a,o.getLocalTransform(),a),o=o.parent;return Bu(a,a),en(i,i,a),i},t}(fB);function v9(e){if(!e.UTF8Encoding)return e;var t=e,r=t.UTF8Scale;r==null&&(r=1024);var n=t.features;return R(n,function(i){var a=i.geometry,o=a.encodeOffsets,s=a.coordinates;if(o)switch(a.type){case"LineString":a.coordinates=dB(s,o,r);break;case"Polygon":Dy(s,o,r);break;case"MultiLineString":Dy(s,o,r);break;case"MultiPolygon":R(s,function(l,u){return Dy(l,o[u],r)})}}),t.UTF8Encoding=!1,t}function Dy(e,t,r){for(var n=0;n<e.length;n++)e[n]=dB(e[n],t[n],r)}function dB(e,t,r){for(var n=[],i=t[0],a=t[1],o=0;o<e.length;o+=2){var s=e.charCodeAt(o)-64,l=e.charCodeAt(o+1)-64;s=s>>1^-(s&1),l=l>>1^-(l&1),s+=i,l+=a,i=s,a=l,n.push([s/r,l/r])}return n}function vB(e,t){return e=v9(e),ft(Xe(e.features,function(r){return r.geometry&&r.properties&&r.geometry.coordinates.length>0}),function(r){var n=r.properties,i=r.geometry,a=[];switch(i.type){case"Polygon":var o=i.coordinates;a.push(new cC(o[0],o.slice(1)));break;case"MultiPolygon":R(i.coordinates,function(l){l[0]&&a.push(new cC(l[0],l.slice(1)))});break;case"LineString":a.push(new dC([i.coordinates]));break;case"MultiLineString":a.push(new dC(i.coordinates))}var s=new cB(n[t||"name"],a,n.cp);return s.properties=n,s})}var qd=Le();function pB(e,t){var r=ft(t,function(n){return e.scale.parse(n)});return e.type==="time"&&r.length>0&&(r.sort(),r.unshift(r[0]),r.push(r[r.length-1])),r}function p9(e){var t=e.getLabelModel().get("customValues");if(t){var r=jf(e),n=e.scale.getExtent(),i=pB(e,t),a=Xe(i,function(o){return o>=n[0]&&o<=n[1]});return{labels:ft(a,function(o){var s={value:o};return{formattedLabel:r(s),rawLabel:e.scale.getLabel(s),tickValue:o}})}}return e.type==="category"?m9(e):y9(e)}function g9(e,t){var r=e.getTickModel().get("customValues");if(r){var n=e.scale.getExtent(),i=pB(e,r);return{ticks:Xe(i,function(a){return a>=n[0]&&a<=n[1]})}}return e.type==="category"?_9(e,t):{ticks:ft(e.scale.getTicks(),function(a){return a.value})}}function m9(e){var t=e.getLabelModel(),r=gB(e,t);return!t.get("show")||e.scale.isBlank()?{labels:[],labelCategoryInterval:r.labelCategoryInterval}:r}function gB(e,t){var r=mB(e,"labels"),n=Ww(t),i=_B(r,n);if(i)return i;var a,o;return Yt(n)?a=SB(e,n):(o=n==="auto"?x9(e):n,a=xB(e,o)),yB(r,n,{labels:a,labelCategoryInterval:o})}function _9(e,t){var r=mB(e,"ticks"),n=Ww(t),i=_B(r,n);if(i)return i;var a,o;if((!t.get("show")||e.scale.isBlank())&&(a=[]),Yt(n))a=SB(e,n,!0);else if(n==="auto"){var s=gB(e,e.getLabelModel());o=s.labelCategoryInterval,a=ft(s.labels,function(l){return l.tickValue})}else o=n,a=xB(e,o,!0);return yB(r,n,{ticks:a,tickCategoryInterval:o})}function y9(e){var t=e.scale.getTicks(),r=jf(e);return{labels:ft(t,function(n,i){return{level:n.level,formattedLabel:r(n,i),rawLabel:e.scale.getLabel(n),tickValue:n.value}})}}function mB(e,t){return qd(e)[t]||(qd(e)[t]=[])}function _B(e,t){for(var r=0;r<e.length;r++)if(e[r].key===t)return e[r].value}function yB(e,t,r){return e.push({key:t,value:r}),r}function x9(e){var t=qd(e).autoInterval;return t??(qd(e).autoInterval=e.calculateCategoryInterval())}function S9(e){var t=T9(e),r=jf(e),n=(t.axisRotate-t.labelRotate)/180*Math.PI,i=e.scale,a=i.getExtent(),o=i.count();if(a[1]-a[0]<1)return 0;var s=1;o>40&&(s=Math.max(1,Math.floor(o/40)));for(var l=a[0],u=e.dataToCoord(l+1)-e.dataToCoord(l),h=Math.abs(u*Math.cos(n)),f=Math.abs(u*Math.sin(n)),c=0,d=0;l<=a[1];l+=s){var v=0,p=0,g=_v(r({value:l}),t.font,"center","top");v=g.width*1.3,p=g.height*1.3,c=Math.max(c,v,7),d=Math.max(d,p,7)}var m=c/h,_=d/f;isNaN(m)&&(m=1/0),isNaN(_)&&(_=1/0);var y=Math.max(0,Math.floor(Math.min(m,_))),x=qd(e.model),T=e.getExtent(),S=x.lastAutoInterval,M=x.lastTickCount;return S!=null&&M!=null&&Math.abs(S-y)<=1&&Math.abs(M-o)<=1&&S>y&&x.axisExtent0===T[0]&&x.axisExtent1===T[1]?y=S:(x.lastTickCount=o,x.lastAutoInterval=y,x.axisExtent0=T[0],x.axisExtent1=T[1]),y}function T9(e){var t=e.getLabelModel();return{axisRotate:e.getRotate?e.getRotate():e.isHorizontal&&!e.isHorizontal()?90:0,labelRotate:t.get("rotate")||0,font:t.getFont()}}function xB(e,t,r){var n=jf(e),i=e.scale,a=i.getExtent(),o=e.getLabelModel(),s=[],l=Math.max((t||0)+1,1),u=a[0],h=i.count();u!==0&&l>1&&h/l>2&&(u=Math.round(Math.ceil(u/l)*l));var f=hB(e),c=o.get("showMinLabel")||f,d=o.get("showMaxLabel")||f;c&&u!==a[0]&&p(a[0]);for(var v=u;v<=a[1];v+=l)p(v);d&&v-l!==a[1]&&p(a[1]);function p(g){var m={value:g};s.push(r?g:{formattedLabel:n(m),rawLabel:i.getLabel(m),tickValue:g})}return s}function SB(e,t,r){var n=e.scale,i=jf(e),a=[];return R(n.getTicks(),function(o){var s=n.getLabel(o),l=o.value;t(o.value,s)&&a.push(r?l:{formattedLabel:i(o),rawLabel:s,tickValue:l})}),a}var vC=[0,1],Kn=function(){function e(t,r,n){this.onBand=!1,this.inverse=!1,this.dim=t,this.scale=r,this._extent=n||[0,0]}return e.prototype.contain=function(t){var r=this._extent,n=Math.min(r[0],r[1]),i=Math.max(r[0],r[1]);return t>=n&&t<=i},e.prototype.containData=function(t){return this.scale.contain(t)},e.prototype.getExtent=function(){return this._extent.slice()},e.prototype.getPixelPrecision=function(t){return SO(t||this.scale.getExtent(),this._extent)},e.prototype.setExtent=function(t,r){var n=this._extent;n[0]=t,n[1]=r},e.prototype.dataToCoord=function(t,r){var n=this._extent,i=this.scale;return t=i.normalize(t),this.onBand&&i.type==="ordinal"&&(n=n.slice(),pC(n,i.count())),He(t,vC,n,r)},e.prototype.coordToData=function(t,r){var n=this._extent,i=this.scale;this.onBand&&i.type==="ordinal"&&(n=n.slice(),pC(n,i.count()));var a=He(t,n,vC,r);return this.scale.scale(a)},e.prototype.pointToData=function(t,r){},e.prototype.getTicksCoords=function(t){t=t||{};var r=t.tickModel||this.getTickModel(),n=g9(this,r),i=n.ticks,a=ft(i,function(s){return{coord:this.dataToCoord(this.scale.type==="ordinal"?this.scale.getRawOrdinalNumber(s):s),tickValue:s}},this),o=r.get("alignWithLabel");return b9(this,a,o,t.clamp),a},e.prototype.getMinorTicksCoords=function(){if(this.scale.type==="ordinal")return[];var t=this.model.getModel("minorTick"),r=t.get("splitNumber");r>0&&r<100||(r=5);var n=this.scale.getMinorTicks(r),i=ft(n,function(a){return ft(a,function(o){return{coord:this.dataToCoord(o),tickValue:o}},this)},this);return i},e.prototype.getViewLabels=function(){return p9(this).labels},e.prototype.getLabelModel=function(){return this.model.getModel("axisLabel")},e.prototype.getTickModel=function(){return this.model.getModel("axisTick")},e.prototype.getBandWidth=function(){var t=this._extent,r=this.scale.getExtent(),n=r[1]-r[0]+(this.onBand?1:0);n===0&&(n=1);var i=Math.abs(t[1]-t[0]);return Math.abs(i)/n},e.prototype.calculateCategoryInterval=function(){return S9(this)},e}();function pC(e,t){var r=e[1]-e[0],n=t,i=r/n/2;e[0]+=i,e[1]-=i}function b9(e,t,r,n){var i=t.length;if(!e.onBand||r||!i)return;var a=e.getExtent(),o,s;if(i===1)t[0].coord=a[0],o=t[1]={coord:a[1],tickValue:t[0].tickValue};else{var l=t[i-1].tickValue-t[0].tickValue,u=(t[i-1].coord-t[0].coord)/l;R(t,function(d){d.coord-=u/2});var h=e.scale.getExtent();s=1+h[1]-t[i-1].tickValue,o={coord:t[i-1].coord+u*s,tickValue:h[1]+1},t.push(o)}var f=a[0]>a[1];c(t[0].coord,a[0])&&(n?t[0].coord=a[0]:t.shift()),n&&c(a[0],t[0].coord)&&t.unshift({coord:a[0]}),c(a[1],o.coord)&&(n?o.coord=a[1]:t.pop()),n&&c(o.coord,a[1])&&t.push({coord:a[1]});function c(d,v){return d=dr(d),v=dr(v),f?d>v:d<v}}var Cc=Math.PI*2,_l=Ka.CMD,w9=["top","right","bottom","left"];function M9(e,t,r,n,i){var a=r.width,o=r.height;switch(e){case"top":n.set(r.x+a/2,r.y-t),i.set(0,-1);break;case"bottom":n.set(r.x+a/2,r.y+o+t),i.set(0,1);break;case"left":n.set(r.x-t,r.y+o/2),i.set(-1,0);break;case"right":n.set(r.x+a+t,r.y+o/2),i.set(1,0);break}}function A9(e,t,r,n,i,a,o,s,l){o-=e,s-=t;var u=Math.sqrt(o*o+s*s);o/=u,s/=u;var h=o*r+e,f=s*r+t;if(Math.abs(n-i)%Cc<1e-4)return l[0]=h,l[1]=f,u-r;if(a){var c=n;n=mi(i),i=mi(c)}else n=mi(n),i=mi(i);n>i&&(i+=Cc);var d=Math.atan2(s,o);if(d<0&&(d+=Cc),d>=n&&d<=i||d+Cc>=n&&d+Cc<=i)return l[0]=h,l[1]=f,u-r;var v=r*Math.cos(n)+e,p=r*Math.sin(n)+t,g=r*Math.cos(i)+e,m=r*Math.sin(i)+t,_=(v-o)*(v-o)+(p-s)*(p-s),y=(g-o)*(g-o)+(m-s)*(m-s);return _<y?(l[0]=v,l[1]=p,Math.sqrt(_)):(l[0]=g,l[1]=m,Math.sqrt(y))}function Bm(e,t,r,n,i,a,o,s){var l=i-e,u=a-t,h=r-e,f=n-t,c=Math.sqrt(h*h+f*f);h/=c,f/=c;var d=l*h+u*f,v=d/c;s&&(v=Math.min(Math.max(v,0),1)),v*=c;var p=o[0]=e+v*h,g=o[1]=t+v*f;return Math.sqrt((p-i)*(p-i)+(g-a)*(g-a))}function TB(e,t,r,n,i,a,o){r<0&&(e=e+r,r=-r),n<0&&(t=t+n,n=-n);var s=e+r,l=t+n,u=o[0]=Math.min(Math.max(i,e),s),h=o[1]=Math.min(Math.max(a,t),l);return Math.sqrt((u-i)*(u-i)+(h-a)*(h-a))}var la=[];function E9(e,t,r){var n=TB(t.x,t.y,t.width,t.height,e.x,e.y,la);return r.set(la[0],la[1]),n}function C9(e,t,r){for(var n=0,i=0,a=0,o=0,s,l,u=1/0,h=t.data,f=e.x,c=e.y,d=0;d<h.length;){var v=h[d++];d===1&&(n=h[d],i=h[d+1],a=n,o=i);var p=u;switch(v){case _l.M:a=h[d++],o=h[d++],n=a,i=o;break;case _l.L:p=Bm(n,i,h[d],h[d+1],f,c,la,!0),n=h[d++],i=h[d++];break;case _l.C:p=nO(n,i,h[d++],h[d++],h[d++],h[d++],h[d],h[d+1],f,c,la),n=h[d++],i=h[d++];break;case _l.Q:p=aO(n,i,h[d++],h[d++],h[d],h[d+1],f,c,la),n=h[d++],i=h[d++];break;case _l.A:var g=h[d++],m=h[d++],_=h[d++],y=h[d++],x=h[d++],T=h[d++];d+=1;var S=!!(1-h[d++]);s=Math.cos(x)*_+g,l=Math.sin(x)*y+m,d<=1&&(a=s,o=l);var M=(f-g)*y/_+g;p=A9(g,m,y,x,x+T,S,M,c,la),n=Math.cos(x+T)*_+g,i=Math.sin(x+T)*y+m;break;case _l.R:a=n=h[d++],o=i=h[d++];var w=h[d++],b=h[d++];p=TB(a,o,w,b,f,c,la);break;case _l.Z:p=Bm(n,i,a,o,f,c,la,!0),n=a,i=o;break}p<u&&(u=p,r.set(la[0],la[1]))}return u}var fa=new he,hr=new he,Dr=new he,Ua=new he,Na=new he;function gC(e,t){if(e){var r=e.getTextGuideLine(),n=e.getTextContent();if(n&&r){var i=e.textGuideLineConfig||{},a=[[0,0],[0,0],[0,0]],o=i.candidates||w9,s=n.getBoundingRect().clone();s.applyTransform(n.getComputedTransform());var l=1/0,u=i.anchor,h=e.getComputedTransform(),f=h&&Bu([],h),c=t.get("length2")||0;u&&Dr.copy(u);for(var d=0;d<o.length;d++){var v=o[d];M9(v,0,s,fa,Ua),he.scaleAndAdd(hr,fa,Ua,c),hr.transform(f);var p=e.getBoundingRect(),g=u?u.distance(hr):e instanceof _e?C9(hr,e.path,Dr):E9(hr,p,Dr);g<l&&(l=g,hr.transform(h),Dr.transform(h),Dr.toArray(a[0]),hr.toArray(a[1]),fa.toArray(a[2]))}bB(a,t.get("minTurnAngle")),r.setShape({points:a})}}}var Um=[],Un=new he;function bB(e,t){if(t<=180&&t>0){t=t/180*Math.PI,fa.fromArray(e[0]),hr.fromArray(e[1]),Dr.fromArray(e[2]),he.sub(Ua,fa,hr),he.sub(Na,Dr,hr);var r=Ua.len(),n=Na.len();if(!(r<.001||n<.001)){Ua.scale(1/r),Na.scale(1/n);var i=Ua.dot(Na),a=Math.cos(t);if(a<i){var o=Bm(hr.x,hr.y,Dr.x,Dr.y,fa.x,fa.y,Um,!1);Un.fromArray(Um),Un.scaleAndAdd(Na,o/Math.tan(Math.PI-t));var s=Dr.x!==hr.x?(Un.x-hr.x)/(Dr.x-hr.x):(Un.y-hr.y)/(Dr.y-hr.y);if(isNaN(s))return;s<0?he.copy(Un,hr):s>1&&he.copy(Un,Dr),Un.toArray(e[1])}}}}function D9(e,t,r){if(r<=180&&r>0){r=r/180*Math.PI,fa.fromArray(e[0]),hr.fromArray(e[1]),Dr.fromArray(e[2]),he.sub(Ua,hr,fa),he.sub(Na,Dr,hr);var n=Ua.len(),i=Na.len();if(!(n<.001||i<.001)){Ua.scale(1/n),Na.scale(1/i);var a=Ua.dot(t),o=Math.cos(r);if(a<o){var s=Bm(hr.x,hr.y,Dr.x,Dr.y,fa.x,fa.y,Um,!1);Un.fromArray(Um);var l=Math.PI/2,u=Math.acos(Na.dot(t)),h=l+u-r;if(h>=l)he.copy(Un,Dr);else{Un.scaleAndAdd(Na,s/Math.tan(Math.PI/2-h));var f=Dr.x!==hr.x?(Un.x-hr.x)/(Dr.x-hr.x):(Un.y-hr.y)/(Dr.y-hr.y);if(isNaN(f))return;f<0?he.copy(Un,hr):f>1&&he.copy(Un,Dr)}Un.toArray(e[1])}}}}function Ly(e,t,r,n){var i=r==="normal",a=i?e:e.ensureState(r);a.ignore=t;var o=n.get("smooth");o&&o===!0&&(o=.3),a.shape=a.shape||{},o>0&&(a.shape.smooth=o);var s=n.getModel("lineStyle").getLineStyle();i?e.useStyle(s):a.style=s}function L9(e,t){var r=t.smooth,n=t.points;if(n)if(e.moveTo(n[0][0],n[0][1]),r>0&&n.length>=3){var i=gs(n[0],n[1]),a=gs(n[1],n[2]);if(!i||!a){e.lineTo(n[1][0],n[1][1]),e.lineTo(n[2][0],n[2][1]);return}var o=Math.min(i,a)*r,s=Bg([],n[1],n[0],o/i),l=Bg([],n[1],n[2],o/a),u=Bg([],s,l,.5);e.bezierCurveTo(s[0],s[1],s[0],s[1],u[0],u[1]),e.bezierCurveTo(l[0],l[1],l[0],l[1],n[2][0],n[2][1])}else for(var h=1;h<n.length;h++)e.lineTo(n[h][0],n[h][1])}function Zw(e,t,r){var n=e.getTextGuideLine(),i=e.getTextContent();if(!i){n&&e.removeTextGuideLine();return}for(var a=t.normal,o=a.get("show"),s=i.ignore,l=0;l<zd.length;l++){var u=zd[l],h=t[u],f=u==="normal";if(h){var c=h.get("show"),d=f?s:se(i.states[u]&&i.states[u].ignore,s);if(d||!se(c,o)){var v=f?n:n&&n.states[u];v&&(v.ignore=!0),n&&Ly(n,!0,u,h);continue}n||(n=new $n,e.setTextGuideLine(n),!f&&(s||!o)&&Ly(n,!0,"normal",t.normal),e.stateProxy&&(n.stateProxy=e.stateProxy)),Ly(n,!1,u,h)}}if(n){Vt(n.style,r),n.style.fill=null;var p=a.get("showAbove"),g=e.textGuideLineConfig=e.textGuideLineConfig||{};g.showAbove=p||!1,n.buildPath=L9}}function qw(e,t){t=t||"labelLine";for(var r={normal:e.getModel(t)},n=0;n<Wn.length;n++){var i=Wn[n];r[i]=e.getModel([i,t])}return r}function wB(e){for(var t=[],r=0;r<e.length;r++){var n=e[r];if(!n.defaultAttr.ignore){var i=n.label,a=i.getComputedTransform(),o=i.getBoundingRect(),s=!a||a[1]<1e-5&&a[2]<1e-5,l=i.style.margin||0,u=o.clone();u.applyTransform(a),u.x-=l/2,u.y-=l/2,u.width+=l,u.height+=l;var h=s?new xm(o,a):null;t.push({label:i,labelLine:n.labelLine,rect:u,localRect:o,obb:h,priority:n.priority,defaultAttr:n.defaultAttr,layoutOption:n.computedLayoutOption,axisAligned:s,transform:a})}}return t}function MB(e,t,r,n,i,a){var o=e.length;if(o<2)return;e.sort(function(S,M){return S.rect[t]-M.rect[t]});for(var s=0,l,u=!1,h=0;h<o;h++){var f=e[h],c=f.rect;l=c[t]-s,l<0&&(c[t]-=l,f.label[t]-=l,u=!0),s=c[t]+c[r]}var d=e[0],v=e[o-1],p,g;m(),p<0&&x(-p,.8),g<0&&x(g,.8),m(),_(p,g,1),_(g,p,-1),m(),p<0&&T(-p),g<0&&T(g);function m(){p=d.rect[t]-n,g=i-v.rect[t]-v.rect[r]}function _(S,M,w){if(S<0){var b=Math.min(M,-S);if(b>0){y(b*w,0,o);var A=b+S;A<0&&x(-A*w,1)}else x(-S*w,1)}}function y(S,M,w){S!==0&&(u=!0);for(var b=M;b<w;b++){var A=e[b],E=A.rect;E[t]+=S,A.label[t]+=S}}function x(S,M){for(var w=[],b=0,A=1;A<o;A++){var E=e[A-1].rect,C=Math.max(e[A].rect[t]-E[t]-E[r],0);w.push(C),b+=C}if(b){var D=Math.min(Math.abs(S)/b,M);if(S>0)for(var A=0;A<o-1;A++){var L=w[A]*D;y(L,0,A+1)}else for(var A=o-1;A>0;A--){var L=w[A-1]*D;y(-L,A,o)}}}function T(S){var M=S<0?-1:1;S=Math.abs(S);for(var w=Math.ceil(S/(o-1)),b=0;b<o-1;b++)if(M>0?y(w,0,b+1):y(-w,o-b-1,o),S-=w,S<=0)return}return u}function R9(e,t,r,n){return MB(e,"x","width",t,r)}function AB(e,t,r,n){return MB(e,"y","height",t,r)}function EB(e){var t=[];e.sort(function(p,g){return g.priority-p.priority});var r=new fe(0,0,0,0);function n(p){if(!p.ignore){var g=p.ensureState("emphasis");g.ignore==null&&(g.ignore=!1)}p.ignore=!0}for(var i=0;i<e.length;i++){var a=e[i],o=a.axisAligned,s=a.localRect,l=a.transform,u=a.label,h=a.labelLine;r.copy(a.rect),r.width-=.1,r.height-=.1,r.x+=.05,r.y+=.05;for(var f=a.obb,c=!1,d=0;d<t.length;d++){var v=t[d];if(r.intersect(v.rect)){if(o&&v.axisAligned){c=!0;break}if(v.obb||(v.obb=new xm(v.localRect,v.transform)),f||(f=new xm(s,l)),f.intersect(v.obb)){c=!0;break}}}c?(n(u),h&&n(h)):(u.attr("ignore",a.defaultAttr.ignore),h&&h.attr("ignore",a.defaultAttr.labelGuideIgnore),t.push(a))}}function P9(e){if(e){for(var t=[],r=0;r<e.length;r++)t.push(e[r].slice());return t}}function I9(e,t){var r=e.label,n=t&&t.getTextGuideLine();return{dataIndex:e.dataIndex,dataType:e.dataType,seriesIndex:e.seriesModel.seriesIndex,text:e.label.style.text,rect:e.hostRect,labelRect:e.rect,align:r.style.align,verticalAlign:r.style.verticalAlign,labelLinePoints:P9(n&&n.shape.points)}}var mC=["align","verticalAlign","width","height","fontSize"],Pn=new yo,Ry=Le(),N9=Le();function Ep(e,t,r){for(var n=0;n<r.length;n++){var i=r[n];t[i]!=null&&(e[i]=t[i])}}var Cp=["x","y","rotation"],O9=function(){function e(){this._labelList=[],this._chartViewList=[]}return e.prototype.clearLabels=function(){this._labelList=[],this._chartViewList=[]},e.prototype._addLabel=function(t,r,n,i,a){var o=i.style,s=i.__hostTarget,l=s.textConfig||{},u=i.getComputedTransform(),h=i.getBoundingRect().plain();fe.applyTransform(h,h,u),u?Pn.setLocalTransform(u):(Pn.x=Pn.y=Pn.rotation=Pn.originX=Pn.originY=0,Pn.scaleX=Pn.scaleY=1),Pn.rotation=mi(Pn.rotation);var f=i.__hostTarget,c;if(f){c=f.getBoundingRect().plain();var d=f.getComputedTransform();fe.applyTransform(c,c,d)}var v=c&&f.getTextGuideLine();this._labelList.push({label:i,labelLine:v,seriesModel:n,dataIndex:t,dataType:r,layoutOption:a,computedLayoutOption:null,rect:h,hostRect:c,priority:c?c.width*c.height:0,defaultAttr:{ignore:i.ignore,labelGuideIgnore:v&&v.ignore,x:Pn.x,y:Pn.y,scaleX:Pn.scaleX,scaleY:Pn.scaleY,rotation:Pn.rotation,style:{x:o.x,y:o.y,align:o.align,verticalAlign:o.verticalAlign,width:o.width,height:o.height,fontSize:o.fontSize},cursor:i.cursor,attachedPos:l.position,attachedRot:l.rotation}})},e.prototype.addLabelsOfSeries=function(t){var r=this;this._chartViewList.push(t);var n=t.__model,i=n.get("labelLayout");(Yt(i)||be(i).length)&&t.group.traverse(function(a){if(a.ignore)return!0;var o=a.getTextContent(),s=oe(a);o&&!o.disableLabelLayout&&r._addLabel(s.dataIndex,s.dataType,n,o,i)})},e.prototype.updateLayoutConfig=function(t){var r=t.getWidth(),n=t.getHeight();function i(y,x){return function(){gC(y,x)}}for(var a=0;a<this._labelList.length;a++){var o=this._labelList[a],s=o.label,l=s.__hostTarget,u=o.defaultAttr,h=void 0;Yt(o.layoutOption)?h=o.layoutOption(I9(o,l)):h=o.layoutOption,h=h||{},o.computedLayoutOption=h;var f=Math.PI/180;l&&l.setTextConfig({local:!1,position:h.x!=null||h.y!=null?null:u.attachedPos,rotation:h.rotate!=null?h.rotate*f:u.attachedRot,offset:[h.dx||0,h.dy||0]});var c=!1;if(h.x!=null?(s.x=Tt(h.x,r),s.setStyle("x",0),c=!0):(s.x=u.x,s.setStyle("x",u.style.x)),h.y!=null?(s.y=Tt(h.y,n),s.setStyle("y",0),c=!0):(s.y=u.y,s.setStyle("y",u.style.y)),h.labelLinePoints){var d=l.getTextGuideLine();d&&(d.setShape({points:h.labelLinePoints}),c=!1)}var v=Ry(s);v.needsUpdateLabelLine=c,s.rotation=h.rotate!=null?h.rotate*f:u.rotation,s.scaleX=u.scaleX,s.scaleY=u.scaleY;for(var p=0;p<mC.length;p++){var g=mC[p];s.setStyle(g,h[g]!=null?h[g]:u.style[g])}if(h.draggable){if(s.draggable=!0,s.cursor="move",l){var m=o.seriesModel;if(o.dataIndex!=null){var _=o.seriesModel.getData(o.dataType);m=_.getItemModel(o.dataIndex)}s.on("drag",i(l,m.getModel("labelLine")))}}else s.off("drag"),s.cursor=u.cursor}},e.prototype.layout=function(t){var r=t.getWidth(),n=t.getHeight(),i=wB(this._labelList),a=Xe(i,function(l){return l.layoutOption.moveOverlap==="shiftX"}),o=Xe(i,function(l){return l.layoutOption.moveOverlap==="shiftY"});R9(a,0,r),AB(o,0,n);var s=Xe(i,function(l){return l.layoutOption.hideOverlap});EB(s)},e.prototype.processLabelsOverall=function(){var t=this;R(this._chartViewList,function(r){var n=r.__model,i=r.ignoreLabelLineUpdate,a=n.isAnimationEnabled();r.group.traverse(function(o){if(o.ignore&&!o.forceLabelAnimation)return!0;var s=!i,l=o.getTextContent();!s&&l&&(s=Ry(l).needsUpdateLabelLine),s&&t._updateLabelLine(o,n),a&&t._animateLabels(o,n)})})},e.prototype._updateLabelLine=function(t,r){var n=t.getTextContent(),i=oe(t),a=i.dataIndex;if(n&&a!=null){var o=r.getData(i.dataType),s=o.getItemModel(a),l={},u=o.getItemVisual(a,"style");if(u){var h=o.getVisual("drawType");l.stroke=u[h]}var f=s.getModel("labelLine");Zw(t,qw(s),l),gC(t,f)}},e.prototype._animateLabels=function(t,r){var n=t.getTextContent(),i=t.getTextGuideLine();if(n&&(t.forceLabelAnimation||!n.ignore&&!n.invisible&&!t.disableLabelAnimation&&!Jh(t))){var a=Ry(n),o=a.oldLayout,s=oe(t),l=s.dataIndex,u={x:n.x,y:n.y,rotation:n.rotation},h=r.getData(s.dataType);if(o){n.attr(o);var c=t.prevStates;c&&(pe(c,"select")>=0&&n.attr(a.oldLayoutSelect),pe(c,"emphasis")>=0&&n.attr(a.oldLayoutEmphasis)),ke(n,u,r,l)}else if(n.attr(u),!Gf(n).valueAnimation){var f=se(n.style.opacity,1);n.style.opacity=0,vr(n,{style:{opacity:f}},r,l)}if(a.oldLayout=u,n.states.select){var d=a.oldLayoutSelect={};Ep(d,u,Cp),Ep(d,n.states.select,Cp)}if(n.states.emphasis){var v=a.oldLayoutEmphasis={};Ep(v,u,Cp),Ep(v,n.states.emphasis,Cp)}g3(n,l,h,r,r)}if(i&&!i.ignore&&!i.invisible){var a=N9(i),o=a.oldLayout,p={points:i.shape.points};o?(i.attr({shape:o}),ke(i,{shape:p},r)):(i.setShape(p),i.style.strokePercent=0,vr(i,{style:{strokePercent:1}},r)),a.oldLayout=p}},e}(),Py=Le();function CB(e){e.registerUpdateLifecycle("series:beforeupdate",function(t,r,n){var i=Py(r).labelManager;i||(i=Py(r).labelManager=new O9),i.clearLabels()}),e.registerUpdateLifecycle("series:layoutlabels",function(t,r,n){var i=Py(r).labelManager;n.updatedSeries.forEach(function(a){i.addLabelsOfSeries(r.getViewOfSeriesModel(a))}),i.updateLayoutConfig(r),i.layout(r),i.processLabelsOverall()})}var Iy=Math.sin,Ny=Math.cos,DB=Math.PI,yl=Math.PI*2,F9=180/DB,LB=function(){function e(){}return e.prototype.reset=function(t){this._start=!0,this._d=[],this._str="",this._p=Math.pow(10,t||4)},e.prototype.moveTo=function(t,r){this._add("M",t,r)},e.prototype.lineTo=function(t,r){this._add("L",t,r)},e.prototype.bezierCurveTo=function(t,r,n,i,a,o){this._add("C",t,r,n,i,a,o)},e.prototype.quadraticCurveTo=function(t,r,n,i){this._add("Q",t,r,n,i)},e.prototype.arc=function(t,r,n,i,a,o){this.ellipse(t,r,n,n,0,i,a,o)},e.prototype.ellipse=function(t,r,n,i,a,o,s,l){var u=s-o,h=!l,f=Math.abs(u),c=Ss(f-yl)||(h?u>=yl:-u>=yl),d=u>0?u%yl:u%yl+yl,v=!1;c?v=!0:Ss(f)?v=!1:v=d>=DB==!!h;var p=t+n*Ny(o),g=r+i*Iy(o);this._start&&this._add("M",p,g);var m=Math.round(a*F9);if(c){var _=1/this._p,y=(h?1:-1)*(yl-_);this._add("A",n,i,m,1,+h,t+n*Ny(o+y),r+i*Iy(o+y)),_>.01&&this._add("A",n,i,m,0,+h,p,g)}else{var x=t+n*Ny(s),T=r+i*Iy(s);this._add("A",n,i,m,+v,+h,x,T)}},e.prototype.rect=function(t,r,n,i){this._add("M",t,r),this._add("l",n,0),this._add("l",0,i),this._add("l",-n,0),this._add("Z")},e.prototype.closePath=function(){this._d.length>0&&this._add("Z")},e.prototype._add=function(t,r,n,i,a,o,s,l,u){for(var h=[],f=this._p,c=1;c<arguments.length;c++){var d=arguments[c];if(isNaN(d)){this._invalid=!0;return}h.push(Math.round(d*f)/f)}this._d.push(t+h.join(" ")),this._start=t==="Z"},e.prototype.generateStr=function(){this._str=this._invalid?"":this._d.join(""),this._d=[]},e.prototype.getStr=function(){return this._str},e}(),$w="none",B9=Math.round;function U9(e){var t=e.fill;return t!=null&&t!==$w}function z9(e){var t=e.stroke;return t!=null&&t!==$w}var KS=["lineCap","miterLimit","lineJoin"],k9=ft(KS,function(e){return"stroke-"+e.toLowerCase()});function G9(e,t,r,n){var i=t.opacity==null?1:t.opacity;if(r instanceof hn){e("opacity",i);return}if(U9(t)){var a=Fd(t.fill);e("fill",a.color);var o=t.fillOpacity!=null?t.fillOpacity*a.opacity*i:a.opacity*i;o<1&&e("fill-opacity",o)}else e("fill",$w);if(z9(t)){var s=Fd(t.stroke);e("stroke",s.color);var l=t.strokeNoScale?r.getLineScale():1,u=l?(t.lineWidth||0)/l:0,h=t.strokeOpacity!=null?t.strokeOpacity*s.opacity*i:s.opacity*i,f=t.strokeFirst;if(u!==1&&e("stroke-width",u),f&&e("paint-order",f?"stroke":"fill"),h<1&&e("stroke-opacity",h),t.lineDash){var c=Pw(r),d=c[0],v=c[1];d&&(v=B9(v||0),e("stroke-dasharray",d.join(",")),(v||n)&&e("stroke-dashoffset",v))}for(var p=0;p<KS.length;p++){var g=KS[p];if(t[g]!==_m[g]){var m=t[g]||_m[g];m&&e(k9[p],m)}}}}var RB="http://www.w3.org/2000/svg",PB="http://www.w3.org/1999/xlink",V9="http://www.w3.org/2000/xmlns/",H9="http://www.w3.org/XML/1998/namespace",_C="ecmeta_";function IB(e){return document.createElementNS(RB,e)}function Jr(e,t,r,n,i){return{tag:e,attrs:r||{},children:n,text:i,key:t}}function W9(e,t){var r=[];if(t)for(var n in t){var i=t[n],a=n;i!==!1&&(i!==!0&&i!=null&&(a+='="'+i+'"'),r.push(a))}return"<"+e+" "+r.join(" ")+">"}function X9(e){return"</"+e+">"}function Kw(e,t){t=t||{};var r=t.newline?`
`:"";function n(i){var a=i.children,o=i.tag,s=i.attrs,l=i.text;return W9(o,s)+(o!=="style"?Br(l):l||"")+(a?""+r+ft(a,function(u){return n(u)}).join(r)+r:"")+X9(o)}return n(e)}function Y9(e,t,r){r=r||{};var n=r.newline?`
`:"",i=" {"+n,a=n+"}",o=ft(be(e),function(l){return l+i+ft(be(e[l]),function(u){return u+":"+e[l][u]+";"}).join(n)+a}).join(n),s=ft(be(t),function(l){return"@keyframes "+l+i+ft(be(t[l]),function(u){return u+i+ft(be(t[l][u]),function(h){var f=t[l][u][h];return h==="d"&&(f='path("'+f+'")'),h+":"+f+";"}).join(n)+a}).join(n)+a}).join(n);return!o&&!s?"":["<![CDATA[",o,s,"]]>"].join(n)}function jS(e){return{zrId:e,shadowCache:{},patternCache:{},gradientCache:{},clipPathCache:{},defs:{},cssNodes:{},cssAnims:{},cssStyleCache:{},cssAnimIdx:0,shadowIdx:0,gradientIdx:0,patternIdx:0,clipPathIdx:0}}function yC(e,t,r,n){return Jr("svg","root",{width:e,height:t,xmlns:RB,"xmlns:xlink":PB,version:"1.1",baseProfile:"full",viewBox:n?"0 0 "+e+" "+t:!1},r)}var Z9=0;function NB(){return Z9++}var xC={cubicIn:"0.32,0,0.67,0",cubicOut:"0.33,1,0.68,1",cubicInOut:"0.65,0,0.35,1",quadraticIn:"0.11,0,0.5,0",quadraticOut:"0.5,1,0.89,1",quadraticInOut:"0.45,0,0.55,1",quarticIn:"0.5,0,0.75,0",quarticOut:"0.25,1,0.5,1",quarticInOut:"0.76,0,0.24,1",quinticIn:"0.64,0,0.78,0",quinticOut:"0.22,1,0.36,1",quinticInOut:"0.83,0,0.17,1",sinusoidalIn:"0.12,0,0.39,0",sinusoidalOut:"0.61,1,0.88,1",sinusoidalInOut:"0.37,0,0.63,1",exponentialIn:"0.7,0,0.84,0",exponentialOut:"0.16,1,0.3,1",exponentialInOut:"0.87,0,0.13,1",circularIn:"0.55,0,1,0.45",circularOut:"0,0.55,0.45,1",circularInOut:"0.85,0,0.15,1"},Ol="transform-origin";function q9(e,t,r){var n=rt({},e.shape);rt(n,t),e.buildPath(r,n);var i=new LB;return i.reset(cO(e)),r.rebuildPath(i,1),i.generateStr(),i.getStr()}function $9(e,t){var r=t.originX,n=t.originY;(r||n)&&(e[Ol]=r+"px "+n+"px")}var K9={fill:"fill",opacity:"opacity",lineWidth:"stroke-width",lineDashOffset:"stroke-dashoffset"};function OB(e,t){var r=t.zrId+"-ani-"+t.cssAnimIdx++;return t.cssAnims[r]=e,r}function j9(e,t,r){var n=e.shape.paths,i={},a,o;if(R(n,function(l){var u=jS(r.zrId);u.animation=!0,t0(l,{},u,!0);var h=u.cssAnims,f=u.cssNodes,c=be(h),d=c.length;if(d){o=c[d-1];var v=h[o];for(var p in v){var g=v[p];i[p]=i[p]||{d:""},i[p].d+=g.d||""}for(var m in f){var _=f[m].animation;_.indexOf(o)>=0&&(a=_)}}}),!!a){t.d=!1;var s=OB(i,r);return a.replace(o,s)}}function SC(e){return Ct(e)?xC[e]?"cubic-bezier("+xC[e]+")":Kb(e)?e:"":""}function t0(e,t,r,n){var i=e.animators,a=i.length,o=[];if(e instanceof fw){var s=j9(e,t,r);if(s)o.push(s);else if(!a)return}else if(!a)return;for(var l={},u=0;u<a;u++){var h=i[u],f=[h.getMaxTime()/1e3+"s"],c=SC(h.getClip().easing),d=h.getDelay();c?f.push(c):f.push("linear"),d&&f.push(d/1e3+"s"),h.getLoop()&&f.push("infinite");var v=f.join(" ");l[v]=l[v]||[v,[]],l[v][1].push(h)}function p(_){var y=_[1],x=y.length,T={},S={},M={},w="animation-timing-function";function b(tt,et,st){for(var nt=tt.getTracks(),dt=tt.getMaxTime(),At=0;At<nt.length;At++){var G=nt[At];if(G.needsAnimate()){var Dt=G.keyframes,Pt=G.propName;if(st&&(Pt=st(Pt)),Pt)for(var Lt=0;Lt<Dt.length;Lt++){var zt=Dt[Lt],ne=Math.round(zt.time/dt*100)+"%",kt=SC(zt.easing),V=zt.rawValue;(Ct(V)||Be(V))&&(et[ne]=et[ne]||{},et[ne][Pt]=zt.rawValue,kt&&(et[ne][w]=kt))}}}}for(var A=0;A<x;A++){var E=y[A],C=E.targetName;C?C==="shape"&&b(E,S):!n&&b(E,T)}for(var D in T){var L={};mO(L,e),rt(L,T[D]);var P=dO(L),N=T[D][w];M[D]=P?{transform:P}:{},$9(M[D],L),N&&(M[D][w]=N)}var O,I=!0;for(var D in S){M[D]=M[D]||{};var k=!O,N=S[D][w];k&&(O=new Ka);var z=O.len();O.reset(),M[D].d=q9(e,S[D],O);var X=O.len();if(!k&&z!==X){I=!1;break}N&&(M[D][w]=N)}if(!I)for(var D in M)delete M[D].d;if(!n)for(var A=0;A<x;A++){var E=y[A],C=E.targetName;C==="style"&&b(E,M,function(nt){return K9[nt]})}for(var Y=be(M),$=!0,H,A=1;A<Y.length;A++){var Z=Y[A-1],ct=Y[A];if(M[Z][Ol]!==M[ct][Ol]){$=!1;break}H=M[Z][Ol]}if($&&H){for(var D in M)M[D][Ol]&&delete M[D][Ol];t[Ol]=H}if(Xe(Y,function(tt){return be(M[tt]).length>0}).length){var ut=OB(M,r);return ut+" "+_[0]+" both"}}for(var g in l){var s=p(l[g]);s&&o.push(s)}if(o.length){var m=r.zrId+"-cls-"+NB();r.cssNodes["."+m]={animation:o.join(",")},t.class=m}}function J9(e,t,r){if(!e.ignore)if(e.isSilent()){var n={"pointer-events":"none"};TC(n,t,r)}else{var i=e.states.emphasis&&e.states.emphasis.style?e.states.emphasis.style:{},a=i.fill;if(!a){var o=e.style&&e.style.fill,s=e.states.select&&e.states.select.style&&e.states.select.style.fill,l=e.currentStates.indexOf("select")>=0&&s||o;l&&(a=lS(l))}var u=i.lineWidth;if(u){var h=!i.strokeNoScale&&e.transform?e.transform[0]:1;u=u/h}var n={cursor:"pointer"};a&&(n.fill=a),i.stroke&&(n.stroke=i.stroke),u&&(n["stroke-width"]=u),TC(n,t,r)}}function TC(e,t,r,n){var i=JSON.stringify(e),a=r.cssStyleCache[i];a||(a=r.zrId+"-cls-"+NB(),r.cssStyleCache[i]=a,r.cssNodes["."+a+":hover"]=e),t.class=t.class?t.class+" "+a:a}var $d=Math.round;function FB(e){return e&&Ct(e.src)}function BB(e){return e&&Yt(e.toDataURL)}function jw(e,t,r,n){G9(function(i,a){var o=i==="fill"||i==="stroke";o&&fO(a)?zB(t,e,i,n):o&&jb(a)?kB(r,e,i,n):e[i]=a,o&&n.ssr&&a==="none"&&(e["pointer-events"]="visible")},t,r,!1),a7(r,e,n)}function Jw(e,t){var r=QV(t);r&&(r.each(function(n,i){n!=null&&(e[(_C+i).toLowerCase()]=n+"")}),t.isSilent()&&(e[_C+"silent"]="true"))}function bC(e){return Ss(e[0]-1)&&Ss(e[1])&&Ss(e[2])&&Ss(e[3]-1)}function Q9(e){return Ss(e[4])&&Ss(e[5])}function Qw(e,t,r){if(t&&!(Q9(t)&&bC(t))){var n=1e4;e.transform=bC(t)?"translate("+$d(t[4]*n)/n+" "+$d(t[5]*n)/n+")":SV(t)}}function wC(e,t,r){for(var n=e.points,i=[],a=0;a<n.length;a++)i.push($d(n[a][0]*r)/r),i.push($d(n[a][1]*r)/r);t.points=i.join(" ")}function MC(e){return!e.smooth}function t7(e){var t=ft(e,function(r){return typeof r=="string"?[r,r]:r});return function(r,n,i){for(var a=0;a<t.length;a++){var o=t[a],s=r[o[0]];s!=null&&(n[o[1]]=$d(s*i)/i)}}}var e7={circle:[t7(["cx","cy","r"])],polyline:[wC,MC],polygon:[wC,MC]};function r7(e){for(var t=e.animators,r=0;r<t.length;r++)if(t[r].targetName==="shape")return!0;return!1}function UB(e,t){var r=e.style,n=e.shape,i=e7[e.type],a={},o=t.animation,s="path",l=e.style.strokePercent,u=t.compress&&cO(e)||4;if(i&&!t.willUpdate&&!(i[1]&&!i[1](n))&&!(o&&r7(e))&&!(l<1)){s=e.type;var h=Math.pow(10,u);i[0](n,a,h)}else{var f=!e.path||e.shapeChanged();e.path||e.createPathProxy();var c=e.path;f&&(c.beginPath(),e.buildPath(c,e.shape),e.pathUpdated());var d=c.getVersion(),v=e,p=v.__svgPathBuilder;(v.__svgPathVersion!==d||!p||l!==v.__svgPathStrokePercent)&&(p||(p=v.__svgPathBuilder=new LB),p.reset(u),c.rebuildPath(p,l),p.generateStr(),v.__svgPathVersion=d,v.__svgPathStrokePercent=l),a.d=p.getStr()}return Qw(a,e.transform),jw(a,r,e,t),Jw(a,e),t.animation&&t0(e,a,t),t.emphasis&&J9(e,a,t),Jr(s,e.id+"",a)}function n7(e,t){var r=e.style,n=r.image;if(n&&!Ct(n)&&(FB(n)?n=n.src:BB(n)&&(n=n.toDataURL())),!!n){var i=r.x||0,a=r.y||0,o=r.width,s=r.height,l={href:n,width:o,height:s};return i&&(l.x=i),a&&(l.y=a),Qw(l,e.transform),jw(l,r,e,t),Jw(l,e),t.animation&&t0(e,l,t),Jr("image",e.id+"",l)}}function i7(e,t){var r=e.style,n=r.text;if(n!=null&&(n+=""),!(!n||isNaN(r.x)||isNaN(r.y))){var i=r.font||Is,a=r.x||0,o=bV(r.y||0,A_(i),r.textBaseline),s=TV[r.textAlign]||r.textAlign,l={"dominant-baseline":"central","text-anchor":s};if(HO(r)){var u="",h=r.fontStyle,f=VO(r.fontSize);if(!parseFloat(f))return;var c=r.fontFamily||GN,d=r.fontWeight;u+="font-size:"+f+";font-family:"+c+";",h&&h!=="normal"&&(u+="font-style:"+h+";"),d&&d!=="normal"&&(u+="font-weight:"+d+";"),l.style=u}else l.style="font: "+i;return n.match(/\s/)&&(l["xml:space"]="preserve"),a&&(l.x=a),o&&(l.y=o),Qw(l,e.transform),jw(l,r,e,t),Jw(l,e),t.animation&&t0(e,l,t),Jr("text",e.id+"",l,void 0,n)}}function AC(e,t){if(e instanceof _e)return UB(e,t);if(e instanceof hn)return n7(e,t);if(e instanceof hf)return i7(e,t)}function a7(e,t,r){var n=e.style;if(wV(n)){var i=MV(e),a=r.shadowCache,o=a[i];if(!o){var s=e.getGlobalScale(),l=s[0],u=s[1];if(!l||!u)return;var h=n.shadowOffsetX||0,f=n.shadowOffsetY||0,c=n.shadowBlur,d=Fd(n.shadowColor),v=d.opacity,p=d.color,g=c/2/l,m=c/2/u,_=g+" "+m;o=r.zrId+"-s"+r.shadowIdx++,r.defs[o]=Jr("filter",o,{id:o,x:"-100%",y:"-100%",width:"300%",height:"300%"},[Jr("feDropShadow","",{dx:h/l,dy:f/u,stdDeviation:_,"flood-color":p,"flood-opacity":v})]),a[i]=o}t.filter=w_(o)}}function zB(e,t,r,n){var i=e[r],a,o={gradientUnits:i.global?"userSpaceOnUse":"objectBoundingBox"};if(uO(i))a="linearGradient",o.x1=i.x,o.y1=i.y,o.x2=i.x2,o.y2=i.y2;else if(hO(i))a="radialGradient",o.cx=se(i.x,.5),o.cy=se(i.y,.5),o.r=se(i.r,.5);else return;for(var s=i.colorStops,l=[],u=0,h=s.length;u<h;++u){var f=uS(s[u].offset)*100+"%",c=s[u].color,d=Fd(c),v=d.color,p=d.opacity,g={offset:f};g["stop-color"]=v,p<1&&(g["stop-opacity"]=p),l.push(Jr("stop",u+"",g))}var m=Jr(a,"",o,l),_=Kw(m),y=n.gradientCache,x=y[_];x||(x=n.zrId+"-g"+n.gradientIdx++,y[_]=x,o.id=x,n.defs[x]=Jr(a,x,o,l)),t[r]=w_(x)}function kB(e,t,r,n){var i=e.style[r],a=e.getBoundingRect(),o={},s=i.repeat,l=s==="no-repeat",u=s==="repeat-x",h=s==="repeat-y",f;if(lO(i)){var c=i.imageWidth,d=i.imageHeight,v=void 0,p=i.image;if(Ct(p)?v=p:FB(p)?v=p.src:BB(p)&&(v=p.toDataURL()),typeof Image>"u"){var g="Image width/height must been given explictly in svg-ssr renderer.";Hn(c,g),Hn(d,g)}else if(c==null||d==null){var m=function(A,E){if(A){var C=A.elm,D=c||E.width,L=d||E.height;A.tag==="pattern"&&(u?(L=1,D/=a.width):h&&(D=1,L/=a.height)),A.attrs.width=D,A.attrs.height=L,C&&(C.setAttribute("width",D),C.setAttribute("height",L))}},_=nw(v,null,e,function(A){l||m(S,A),m(f,A)});_&&_.width&&_.height&&(c=c||_.width,d=d||_.height)}f=Jr("image","img",{href:v,width:c,height:d}),o.width=c,o.height=d}else i.svgElement&&(f=Qt(i.svgElement),o.width=i.svgWidth,o.height=i.svgHeight);if(f){var y,x;l?y=x=1:u?(x=1,y=o.width/a.width):h?(y=1,x=o.height/a.height):o.patternUnits="userSpaceOnUse",y!=null&&!isNaN(y)&&(o.width=y),x!=null&&!isNaN(x)&&(o.height=x);var T=dO(i);T&&(o.patternTransform=T);var S=Jr("pattern","",o,[f]),M=Kw(S),w=n.patternCache,b=w[M];b||(b=n.zrId+"-p"+n.patternIdx++,w[M]=b,o.id=b,S=n.defs[b]=Jr("pattern",b,o,[f])),t[r]=w_(b)}}function o7(e,t,r){var n=r.clipPathCache,i=r.defs,a=n[e.id];if(!a){a=r.zrId+"-c"+r.clipPathIdx++;var o={id:a};n[e.id]=a,i[a]=Jr("clipPath",a,o,[UB(e,r)])}t["clip-path"]=w_(a)}function EC(e){return document.createTextNode(e)}function Wl(e,t,r){e.insertBefore(t,r)}function CC(e,t){e.removeChild(t)}function DC(e,t){e.appendChild(t)}function GB(e){return e.parentNode}function VB(e){return e.nextSibling}function Oy(e,t){e.textContent=t}var LC=58,s7=120,l7=Jr("","");function JS(e){return e===void 0}function La(e){return e!==void 0}function u7(e,t,r){for(var n={},i=t;i<=r;++i){var a=e[i].key;a!==void 0&&(n[a]=i)}return n}function ad(e,t){var r=e.key===t.key,n=e.tag===t.tag;return n&&r}function Kd(e){var t,r=e.children,n=e.tag;if(La(n)){var i=e.elm=IB(n);if(tM(l7,e),at(r))for(t=0;t<r.length;++t){var a=r[t];a!=null&&DC(i,Kd(a))}else La(e.text)&&!Kt(e.text)&&DC(i,EC(e.text))}else e.elm=EC(e.text);return e.elm}function HB(e,t,r,n,i){for(;n<=i;++n){var a=r[n];a!=null&&Wl(e,Kd(a),t)}}function zm(e,t,r,n){for(;r<=n;++r){var i=t[r];if(i!=null)if(La(i.tag)){var a=GB(i.elm);CC(a,i.elm)}else CC(e,i.elm)}}function tM(e,t){var r,n=t.elm,i=e&&e.attrs||{},a=t.attrs||{};if(i!==a){for(r in a){var o=a[r],s=i[r];s!==o&&(o===!0?n.setAttribute(r,""):o===!1?n.removeAttribute(r):r==="style"?n.style.cssText=o:r.charCodeAt(0)!==s7?n.setAttribute(r,o):r==="xmlns:xlink"||r==="xmlns"?n.setAttributeNS(V9,r,o):r.charCodeAt(3)===LC?n.setAttributeNS(H9,r,o):r.charCodeAt(5)===LC?n.setAttributeNS(PB,r,o):n.setAttribute(r,o))}for(r in i)r in a||n.removeAttribute(r)}}function h7(e,t,r){for(var n=0,i=0,a=t.length-1,o=t[0],s=t[a],l=r.length-1,u=r[0],h=r[l],f,c,d,v;n<=a&&i<=l;)o==null?o=t[++n]:s==null?s=t[--a]:u==null?u=r[++i]:h==null?h=r[--l]:ad(o,u)?(kh(o,u),o=t[++n],u=r[++i]):ad(s,h)?(kh(s,h),s=t[--a],h=r[--l]):ad(o,h)?(kh(o,h),Wl(e,o.elm,VB(s.elm)),o=t[++n],h=r[--l]):ad(s,u)?(kh(s,u),Wl(e,s.elm,o.elm),s=t[--a],u=r[++i]):(JS(f)&&(f=u7(t,n,a)),c=f[u.key],JS(c)?Wl(e,Kd(u),o.elm):(d=t[c],d.tag!==u.tag?Wl(e,Kd(u),o.elm):(kh(d,u),t[c]=void 0,Wl(e,d.elm,o.elm))),u=r[++i]);(n<=a||i<=l)&&(n>a?(v=r[l+1]==null?null:r[l+1].elm,HB(e,v,r,i,l)):zm(e,t,n,a))}function kh(e,t){var r=t.elm=e.elm,n=e.children,i=t.children;e!==t&&(tM(e,t),JS(t.text)?La(n)&&La(i)?n!==i&&h7(r,n,i):La(i)?(La(e.text)&&Oy(r,""),HB(r,null,i,0,i.length-1)):La(n)?zm(r,n,0,n.length-1):La(e.text)&&Oy(r,""):e.text!==t.text&&(La(n)&&zm(r,n,0,n.length-1),Oy(r,t.text)))}function f7(e,t){if(ad(e,t))kh(e,t);else{var r=e.elm,n=GB(r);Kd(t),n!==null&&(Wl(n,t.elm,VB(r)),zm(n,[e],0,0))}return t}var c7=0,d7=function(){function e(t,r,n){if(this.type="svg",this.refreshHover=RC(),this.configLayer=RC(),this.storage=r,this._opts=n=rt({},n),this.root=t,this._id="zr"+c7++,this._oldVNode=yC(n.width,n.height),t&&!n.ssr){var i=this._viewport=document.createElement("div");i.style.cssText="position:relative;overflow:hidden";var a=this._svgDom=this._oldVNode.elm=IB("svg");tM(null,this._oldVNode),i.appendChild(a),t.appendChild(i)}this.resize(n.width,n.height)}return e.prototype.getType=function(){return this.type},e.prototype.getViewportRoot=function(){return this._viewport},e.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},e.prototype.getSvgDom=function(){return this._svgDom},e.prototype.refresh=function(){if(this.root){var t=this.renderToVNode({willUpdate:!0});t.attrs.style="position:absolute;left:0;top:0;user-select:none",f7(this._oldVNode,t),this._oldVNode=t}},e.prototype.renderOneToVNode=function(t){return AC(t,jS(this._id))},e.prototype.renderToVNode=function(t){t=t||{};var r=this.storage.getDisplayList(!0),n=this._width,i=this._height,a=jS(this._id);a.animation=t.animation,a.willUpdate=t.willUpdate,a.compress=t.compress,a.emphasis=t.emphasis,a.ssr=this._opts.ssr;var o=[],s=this._bgVNode=v7(n,i,this._backgroundColor,a);s&&o.push(s);var l=t.compress?null:this._mainVNode=Jr("g","main",{},[]);this._paintList(r,a,l?l.children:o),l&&o.push(l);var u=ft(be(a.defs),function(c){return a.defs[c]});if(u.length&&o.push(Jr("defs","defs",{},u)),t.animation){var h=Y9(a.cssNodes,a.cssAnims,{newline:!0});if(h){var f=Jr("style","stl",{},[],h);o.push(f)}}return yC(n,i,o,t.useViewBox)},e.prototype.renderToString=function(t){return t=t||{},Kw(this.renderToVNode({animation:se(t.cssAnimation,!0),emphasis:se(t.cssEmphasis,!0),willUpdate:!1,compress:!0,useViewBox:se(t.useViewBox,!0)}),{newline:!0})},e.prototype.setBackgroundColor=function(t){this._backgroundColor=t},e.prototype.getSvgRoot=function(){return this._mainVNode&&this._mainVNode.elm},e.prototype._paintList=function(t,r,n){for(var i=t.length,a=[],o=0,s,l,u=0,h=0;h<i;h++){var f=t[h];if(!f.invisible){var c=f.__clipPaths,d=c&&c.length||0,v=l&&l.length||0,p=void 0;for(p=Math.max(d-1,v-1);p>=0&&!(c&&l&&c[p]===l[p]);p--);for(var g=v-1;g>p;g--)o--,s=a[o-1];for(var m=p+1;m<d;m++){var _={};o7(c[m],_,r);var y=Jr("g","clip-g-"+u++,_,[]);(s?s.children:n).push(y),a[o++]=y,s=y}l=c;var x=AC(f,r);x&&(s?s.children:n).push(x)}}},e.prototype.resize=function(t,r){var n=this._opts,i=this.root,a=this._viewport;if(t!=null&&(n.width=t),r!=null&&(n.height=r),i&&a&&(a.style.display="none",t=Yh(i,0,n),r=Yh(i,1,n),a.style.display=""),this._width!==t||this._height!==r){if(this._width=t,this._height=r,a){var o=a.style;o.width=t+"px",o.height=r+"px"}if(jb(this._backgroundColor))this.refresh();else{var s=this._svgDom;s&&(s.setAttribute("width",t),s.setAttribute("height",r));var l=this._bgVNode&&this._bgVNode.elm;l&&(l.setAttribute("width",t),l.setAttribute("height",r))}}},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e.prototype.dispose=function(){this.root&&(this.root.innerHTML=""),this._svgDom=this._viewport=this.storage=this._oldVNode=this._bgVNode=this._mainVNode=null},e.prototype.clear=function(){this._svgDom&&(this._svgDom.innerHTML=null),this._oldVNode=null},e.prototype.toDataURL=function(t){var r=this.renderToString(),n="data:image/svg+xml;";return t?(r=EV(r),r&&n+"base64,"+r):n+"charset=UTF-8,"+encodeURIComponent(r)},e}();function RC(e){return function(){}}function v7(e,t,r,n){var i;if(r&&r!=="none")if(i=Jr("rect","bg",{width:e,height:t,x:"0",y:"0"}),fO(r))zB({fill:r},i.attrs,"fill",n);else if(jb(r))kB({style:{fill:r},dirty:Rr,getBoundingRect:function(){return{width:e,height:t}}},i.attrs,"fill",n);else{var a=Fd(r),o=a.color,s=a.opacity;i.attrs.fill=o,s<1&&(i.attrs["fill-opacity"]=s)}return i}function p7(e){e.registerPainter("svg",d7)}function PC(e,t,r){var n=Ns.createCanvas(),i=t.getWidth(),a=t.getHeight(),o=n.style;return o&&(o.position="absolute",o.left="0",o.top="0",o.width=i+"px",o.height=a+"px",n.setAttribute("data-zr-dom-id",e)),n.width=i*r,n.height=a*r,n}var Fy=function(e){q(t,e);function t(r,n,i){var a=e.call(this)||this;a.motionBlur=!1,a.lastFrameAlpha=.7,a.dpr=1,a.virtual=!1,a.config={},a.incremental=!1,a.zlevel=0,a.maxRepaintRectCount=5,a.__dirty=!0,a.__firstTimePaint=!0,a.__used=!1,a.__drawIndex=0,a.__startIndex=0,a.__endIndex=0,a.__prevStartIndex=null,a.__prevEndIndex=null;var o;i=i||gm,typeof r=="string"?o=PC(r,n,i):Kt(r)&&(o=r,r=o.id),a.id=r,a.dom=o;var s=o.style;return s&&(ZN(o),o.onselectstart=function(){return!1},s.padding="0",s.margin="0",s.borderWidth="0"),a.painter=n,a.dpr=i,a}return t.prototype.getElementCount=function(){return this.__endIndex-this.__startIndex},t.prototype.afterBrush=function(){this.__prevStartIndex=this.__startIndex,this.__prevEndIndex=this.__endIndex},t.prototype.initContext=function(){this.ctx=this.dom.getContext("2d"),this.ctx.dpr=this.dpr},t.prototype.setUnpainted=function(){this.__firstTimePaint=!0},t.prototype.createBackBuffer=function(){var r=this.dpr;this.domBack=PC("back-"+this.id,this.painter,r),this.ctxBack=this.domBack.getContext("2d"),r!==1&&this.ctxBack.scale(r,r)},t.prototype.createRepaintRects=function(r,n,i,a){if(this.__firstTimePaint)return this.__firstTimePaint=!1,null;var o=[],s=this.maxRepaintRectCount,l=!1,u=new fe(0,0,0,0);function h(_){if(!(!_.isFinite()||_.isZero()))if(o.length===0){var y=new fe(0,0,0,0);y.copy(_),o.push(y)}else{for(var x=!1,T=1/0,S=0,M=0;M<o.length;++M){var w=o[M];if(w.intersect(_)){var b=new fe(0,0,0,0);b.copy(w),b.union(_),o[M]=b,x=!0;break}else if(l){u.copy(_),u.union(w);var A=_.width*_.height,E=w.width*w.height,C=u.width*u.height,D=C-A-E;D<T&&(T=D,S=M)}}if(l&&(o[S].union(_),x=!0),!x){var y=new fe(0,0,0,0);y.copy(_),o.push(y)}l||(l=o.length>=s)}}for(var f=this.__startIndex;f<this.__endIndex;++f){var c=r[f];if(c){var d=c.shouldBePainted(i,a,!0,!0),v=c.__isRendered&&(c.__dirty&Va||!d)?c.getPrevPaintRect():null;v&&h(v);var p=d&&(c.__dirty&Va||!c.__isRendered)?c.getPaintRect():null;p&&h(p)}}for(var f=this.__prevStartIndex;f<this.__prevEndIndex;++f){var c=n[f],d=c&&c.shouldBePainted(i,a,!0,!0);if(c&&(!d||!c.__zr)&&c.__isRendered){var v=c.getPrevPaintRect();v&&h(v)}}var g;do{g=!1;for(var f=0;f<o.length;){if(o[f].isZero()){o.splice(f,1);continue}for(var m=f+1;m<o.length;)o[f].intersect(o[m])?(g=!0,o[f].union(o[m]),o.splice(m,1)):m++;f++}}while(g);return this._paintRects=o,o},t.prototype.debugGetPaintRects=function(){return(this._paintRects||[]).slice()},t.prototype.resize=function(r,n){var i=this.dpr,a=this.dom,o=a.style,s=this.domBack;o&&(o.width=r+"px",o.height=n+"px"),a.width=r*i,a.height=n*i,s&&(s.width=r*i,s.height=n*i,i!==1&&this.ctxBack.scale(i,i))},t.prototype.clear=function(r,n,i){var a=this.dom,o=this.ctx,s=a.width,l=a.height;n=n||this.clearColor;var u=this.motionBlur&&!r,h=this.lastFrameAlpha,f=this.dpr,c=this;u&&(this.domBack||this.createBackBuffer(),this.ctxBack.globalCompositeOperation="copy",this.ctxBack.drawImage(a,0,0,s/f,l/f));var d=this.domBack;function v(p,g,m,_){if(o.clearRect(p,g,m,_),n&&n!=="transparent"){var y=void 0;if(S_(n)){var x=n.global||n.__width===m&&n.__height===_;y=x&&n.__canvasGradient||VS(o,n,{x:0,y:0,width:m,height:_}),n.__canvasGradient=y,n.__width=m,n.__height=_}else N4(n)&&(n.scaleX=n.scaleX||f,n.scaleY=n.scaleY||f,y=HS(o,n,{dirty:function(){c.setUnpainted(),c.painter.refresh()}}));o.save(),o.fillStyle=y||n,o.fillRect(p,g,m,_),o.restore()}u&&(o.save(),o.globalAlpha=h,o.drawImage(d,p,g,m,_),o.restore())}!i||u?v(0,0,s,l):i.length&&R(i,function(p){v(p.x*f,p.y*f,p.width*f,p.height*f)})},t}(Zi),IC=1e5,xl=314159,Dp=.01,g7=.001;function m7(e){return e?e.__builtin__?!0:!(typeof e.resize!="function"||typeof e.refresh!="function"):!1}function _7(e,t){var r=document.createElement("div");return r.style.cssText=["position:relative","width:"+e+"px","height:"+t+"px","padding:0","margin:0","border-width:0"].join(";")+";",r}var y7=function(){function e(t,r,n,i){this.type="canvas",this._zlevelList=[],this._prevDisplayList=[],this._layers={},this._layerConfig={},this._needsManuallyCompositing=!1,this.type="canvas";var a=!t.nodeName||t.nodeName.toUpperCase()==="CANVAS";this._opts=n=rt({},n||{}),this.dpr=n.devicePixelRatio||gm,this._singleCanvas=a,this.root=t;var o=t.style;o&&(ZN(t),t.innerHTML=""),this.storage=r;var s=this._zlevelList;this._prevDisplayList=[];var l=this._layers;if(a){var h=t,f=h.width,c=h.height;n.width!=null&&(f=n.width),n.height!=null&&(c=n.height),this.dpr=n.devicePixelRatio||1,h.width=f*this.dpr,h.height=c*this.dpr,this._width=f,this._height=c;var d=new Fy(h,this,this.dpr);d.__builtin__=!0,d.initContext(),l[xl]=d,d.zlevel=xl,s.push(xl),this._domRoot=t}else{this._width=Yh(t,0,n),this._height=Yh(t,1,n);var u=this._domRoot=_7(this._width,this._height);t.appendChild(u)}}return e.prototype.getType=function(){return"canvas"},e.prototype.isSingleCanvas=function(){return this._singleCanvas},e.prototype.getViewportRoot=function(){return this._domRoot},e.prototype.getViewportRootOffset=function(){var t=this.getViewportRoot();if(t)return{offsetLeft:t.offsetLeft||0,offsetTop:t.offsetTop||0}},e.prototype.refresh=function(t){var r=this.storage.getDisplayList(!0),n=this._prevDisplayList,i=this._zlevelList;this._redrawId=Math.random(),this._paintList(r,n,t,this._redrawId);for(var a=0;a<i.length;a++){var o=i[a],s=this._layers[o];if(!s.__builtin__&&s.refresh){var l=a===0?this._backgroundColor:null;s.refresh(l)}}return this._opts.useDirtyRect&&(this._prevDisplayList=r.slice()),this},e.prototype.refreshHover=function(){this._paintHoverList(this.storage.getDisplayList(!1))},e.prototype._paintHoverList=function(t){var r=t.length,n=this._hoverlayer;if(n&&n.clear(),!!r){for(var i={inHover:!0,viewWidth:this._width,viewHeight:this._height},a,o=0;o<r;o++){var s=t[o];s.__inHover&&(n||(n=this._hoverlayer=this.getLayer(IC)),a||(a=n.ctx,a.save()),eu(a,s,i,o===r-1))}a&&a.restore()}},e.prototype.getHoverLayer=function(){return this.getLayer(IC)},e.prototype.paintOne=function(t,r){q_(t,r)},e.prototype._paintList=function(t,r,n,i){if(this._redrawId===i){n=n||!1,this._updateLayerStatus(t);var a=this._doPaintList(t,r,n),o=a.finished,s=a.needsRefreshHover;if(this._needsManuallyCompositing&&this._compositeManually(),s&&this._paintHoverList(t),o)this.eachLayer(function(u){u.afterBrush&&u.afterBrush()});else{var l=this;xu(function(){l._paintList(t,r,n,i)})}}},e.prototype._compositeManually=function(){var t=this.getLayer(xl).ctx,r=this._domRoot.width,n=this._domRoot.height;t.clearRect(0,0,r,n),this.eachBuiltinLayer(function(i){i.virtual&&t.drawImage(i.dom,0,0,r,n)})},e.prototype._doPaintList=function(t,r,n){for(var i=this,a=[],o=this._opts.useDirtyRect,s=0;s<this._zlevelList.length;s++){var l=this._zlevelList[s],u=this._layers[l];u.__builtin__&&u!==this._hoverlayer&&(u.__dirty||n)&&a.push(u)}for(var h=!0,f=!1,c=function(p){var g=a[p],m=g.ctx,_=o&&g.createRepaintRects(t,r,d._width,d._height),y=n?g.__startIndex:g.__drawIndex,x=!n&&g.incremental&&Date.now,T=x&&Date.now(),S=g.zlevel===d._zlevelList[0]?d._backgroundColor:null;if(g.__startIndex===g.__endIndex)g.clear(!1,S,_);else if(y===g.__startIndex){var M=t[y];(!M.incremental||!M.notClear||n)&&g.clear(!1,S,_)}y===-1&&(console.error("For some unknown reason. drawIndex is -1"),y=g.__startIndex);var w,b=function(D){var L={inHover:!1,allClipped:!1,prevEl:null,viewWidth:i._width,viewHeight:i._height};for(w=y;w<g.__endIndex;w++){var P=t[w];if(P.__inHover&&(f=!0),i._doPaintEl(P,g,o,D,L,w===g.__endIndex-1),x){var N=Date.now()-T;if(N>15)break}}L.prevElClipPaths&&m.restore()};if(_)if(_.length===0)w=g.__endIndex;else for(var A=d.dpr,E=0;E<_.length;++E){var C=_[E];m.save(),m.beginPath(),m.rect(C.x*A,C.y*A,C.width*A,C.height*A),m.clip(),b(C),m.restore()}else m.save(),b(),m.restore();g.__drawIndex=w,g.__drawIndex<g.__endIndex&&(h=!1)},d=this,v=0;v<a.length;v++)c(v);return ye.wxa&&R(this._layers,function(p){p&&p.ctx&&p.ctx.draw&&p.ctx.draw()}),{finished:h,needsRefreshHover:f}},e.prototype._doPaintEl=function(t,r,n,i,a,o){var s=r.ctx;if(n){var l=t.getPaintRect();(!i||l&&l.intersect(i))&&(eu(s,t,a,o),t.setPrevPaintRect(l))}else eu(s,t,a,o)},e.prototype.getLayer=function(t,r){this._singleCanvas&&!this._needsManuallyCompositing&&(t=xl);var n=this._layers[t];return n||(n=new Fy("zr_"+t,this,this.dpr),n.zlevel=t,n.__builtin__=!0,this._layerConfig[t]?Ot(n,this._layerConfig[t],!0):this._layerConfig[t-Dp]&&Ot(n,this._layerConfig[t-Dp],!0),r&&(n.virtual=r),this.insertLayer(t,n),n.initContext()),n},e.prototype.insertLayer=function(t,r){var n=this._layers,i=this._zlevelList,a=i.length,o=this._domRoot,s=null,l=-1;if(!n[t]&&m7(r)){if(a>0&&t>i[0]){for(l=0;l<a-1&&!(i[l]<t&&i[l+1]>t);l++);s=n[i[l]]}if(i.splice(l+1,0,t),n[t]=r,!r.virtual)if(s){var u=s.dom;u.nextSibling?o.insertBefore(r.dom,u.nextSibling):o.appendChild(r.dom)}else o.firstChild?o.insertBefore(r.dom,o.firstChild):o.appendChild(r.dom);r.painter||(r.painter=this)}},e.prototype.eachLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i];t.call(r,this._layers[a],a)}},e.prototype.eachBuiltinLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__&&t.call(r,o,a)}},e.prototype.eachOtherLayer=function(t,r){for(var n=this._zlevelList,i=0;i<n.length;i++){var a=n[i],o=this._layers[a];o.__builtin__||t.call(r,o,a)}},e.prototype.getLayers=function(){return this._layers},e.prototype._updateLayerStatus=function(t){this.eachBuiltinLayer(function(f,c){f.__dirty=f.__used=!1});function r(f){a&&(a.__endIndex!==f&&(a.__dirty=!0),a.__endIndex=f)}if(this._singleCanvas)for(var n=1;n<t.length;n++){var i=t[n];if(i.zlevel!==t[n-1].zlevel||i.incremental){this._needsManuallyCompositing=!0;break}}var a=null,o=0,s,l;for(l=0;l<t.length;l++){var i=t[l],u=i.zlevel,h=void 0;s!==u&&(s=u,o=0),i.incremental?(h=this.getLayer(u+g7,this._needsManuallyCompositing),h.incremental=!0,o=1):h=this.getLayer(u+(o>0?Dp:0),this._needsManuallyCompositing),h.__builtin__||Vb("ZLevel "+u+" has been used by unkown layer "+h.id),h!==a&&(h.__used=!0,h.__startIndex!==l&&(h.__dirty=!0),h.__startIndex=l,h.incremental?h.__drawIndex=-1:h.__drawIndex=l,r(l),a=h),i.__dirty&Va&&!i.__inHover&&(h.__dirty=!0,h.incremental&&h.__drawIndex<0&&(h.__drawIndex=l))}r(l),this.eachBuiltinLayer(function(f,c){!f.__used&&f.getElementCount()>0&&(f.__dirty=!0,f.__startIndex=f.__endIndex=f.__drawIndex=0),f.__dirty&&f.__drawIndex<0&&(f.__drawIndex=f.__startIndex)})},e.prototype.clear=function(){return this.eachBuiltinLayer(this._clearLayer),this},e.prototype._clearLayer=function(t){t.clear()},e.prototype.setBackgroundColor=function(t){this._backgroundColor=t,R(this._layers,function(r){r.setUnpainted()})},e.prototype.configLayer=function(t,r){if(r){var n=this._layerConfig;n[t]?Ot(n[t],r,!0):n[t]=r;for(var i=0;i<this._zlevelList.length;i++){var a=this._zlevelList[i];if(a===t||a===t+Dp){var o=this._layers[a];Ot(o,n[t],!0)}}}},e.prototype.delLayer=function(t){var r=this._layers,n=this._zlevelList,i=r[t];i&&(i.dom.parentNode.removeChild(i.dom),delete r[t],n.splice(pe(n,t),1))},e.prototype.resize=function(t,r){if(this._domRoot.style){var n=this._domRoot;n.style.display="none";var i=this._opts,a=this.root;if(t!=null&&(i.width=t),r!=null&&(i.height=r),t=Yh(a,0,i),r=Yh(a,1,i),n.style.display="",this._width!==t||r!==this._height){n.style.width=t+"px",n.style.height=r+"px";for(var o in this._layers)this._layers.hasOwnProperty(o)&&this._layers[o].resize(t,r);this.refresh(!0)}this._width=t,this._height=r}else{if(t==null||r==null)return;this._width=t,this._height=r,this.getLayer(xl).resize(t,r)}return this},e.prototype.clearLayer=function(t){var r=this._layers[t];r&&r.clear()},e.prototype.dispose=function(){this.root.innerHTML="",this.root=this.storage=this._domRoot=this._layers=null},e.prototype.getRenderedCanvas=function(t){if(t=t||{},this._singleCanvas&&!this._compositeManually)return this._layers[xl].dom;var r=new Fy("image",this,t.pixelRatio||this.dpr);r.initContext(),r.clear(!1,t.backgroundColor||this._backgroundColor);var n=r.ctx;if(t.pixelRatio<=this.dpr){this.refresh();var i=r.dom.width,a=r.dom.height;this.eachLayer(function(f){f.__builtin__?n.drawImage(f.dom,0,0,i,a):f.renderToCanvas&&(n.save(),f.renderToCanvas(n),n.restore())})}else for(var o={inHover:!1,viewWidth:this._width,viewHeight:this._height},s=this.storage.getDisplayList(!0),l=0,u=s.length;l<u;l++){var h=s[l];eu(n,h,o,l===u-1)}return r.dom},e.prototype.getWidth=function(){return this._width},e.prototype.getHeight=function(){return this._height},e}();function WB(e){e.registerPainter("canvas",y7)}var x7=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r){return Qa(null,this,{useEncodeDefaulter:!0})},t.prototype.getLegendIcon=function(r){var n=new re,i=Pr("line",0,r.itemHeight/2,r.itemWidth,0,r.lineStyle.stroke,!1);n.add(i),i.setStyle(r.lineStyle);var a=this.getData().getVisual("symbol"),o=this.getData().getVisual("symbolRotate"),s=a==="none"?"circle":a,l=r.itemHeight*.8,u=Pr(s,(r.itemWidth-l)/2,(r.itemHeight-l)/2,l,l,r.itemStyle.fill);n.add(u),u.setStyle(r.itemStyle);var h=r.iconRotate==="inherit"?o:r.iconRotate||0;return u.rotation=h*Math.PI/180,u.setOrigin([r.itemWidth/2,r.itemHeight/2]),s.indexOf("empty")>-1&&(u.style.stroke=u.style.fill,u.style.fill="#fff",u.style.lineWidth=2),n},t.type="series.line",t.dependencies=["grid","polar"],t.defaultOption={z:3,coordinateSystem:"cartesian2d",legendHoverLink:!0,clip:!0,label:{position:"top"},endLabel:{show:!1,valueAnimation:!0,distance:8},lineStyle:{width:2,type:"solid"},emphasis:{scale:!0},step:!1,smooth:!1,smoothMonotone:null,symbol:"emptyCircle",symbolSize:4,symbolRotate:null,showSymbol:!0,showAllSymbol:"auto",connectNulls:!1,sampling:"none",animationEasing:"linear",progressive:0,hoverLayerThreshold:1/0,universalTransition:{divideShape:"clone"},triggerLineEvent:!1},t}(Ue);function vf(e,t){var r=e.mapDimensionsAll("defaultedLabel"),n=r.length;if(n===1){var i=cf(e,t,r[0]);return i!=null?i+"":null}else if(n){for(var a=[],o=0;o<r.length;o++)a.push(cf(e,t,r[o]));return a.join(" ")}}function XB(e,t){var r=e.mapDimensionsAll("defaultedLabel");if(!at(t))return t+"";for(var n=[],i=0;i<r.length;i++){var a=e.getDimensionIndex(r[i]);a>=0&&n.push(t[a])}return n.join(" ")}var Dv=function(e){q(t,e);function t(r,n,i,a){var o=e.call(this)||this;return o.updateData(r,n,i,a),o}return t.prototype._createSymbol=function(r,n,i,a,o){this.removeAll();var s=Pr(r,-1,-1,2,2,null,o);s.attr({z2:100,culling:!0,scaleX:a[0]/2,scaleY:a[1]/2}),s.drift=S7,this._symbolType=r,this.add(s)},t.prototype.stopSymbolAnimation=function(r){this.childAt(0).stopAnimation(null,r)},t.prototype.getSymbolType=function(){return this._symbolType},t.prototype.getSymbolPath=function(){return this.childAt(0)},t.prototype.highlight=function(){Po(this.childAt(0))},t.prototype.downplay=function(){Io(this.childAt(0))},t.prototype.setZ=function(r,n){var i=this.childAt(0);i.zlevel=r,i.z=n},t.prototype.setDraggable=function(r,n){var i=this.childAt(0);i.draggable=r,i.cursor=!n&&r?"move":i.cursor},t.prototype.updateData=function(r,n,i,a){this.silent=!1;var o=r.getItemVisual(n,"symbol")||"circle",s=r.hostModel,l=t.getSymbolSize(r,n),u=o!==this._symbolType,h=a&&a.disableAnimation;if(u){var f=r.getItemVisual(n,"symbolKeepAspect");this._createSymbol(o,r,n,l,f)}else{var c=this.childAt(0);c.silent=!1;var d={scaleX:l[0]/2,scaleY:l[1]/2};h?c.attr(d):ke(c,d,s,n),ya(c)}if(this._updateCommon(r,n,l,i,a),u){var c=this.childAt(0);if(!h){var d={scaleX:this._sizeX,scaleY:this._sizeY,style:{opacity:c.style.opacity}};c.scaleX=c.scaleY=0,c.style.opacity=0,vr(c,d,s,n)}}h&&this.childAt(0).stopAnimation("leave")},t.prototype._updateCommon=function(r,n,i,a,o){var s=this.childAt(0),l=r.hostModel,u,h,f,c,d,v,p,g,m;if(a&&(u=a.emphasisItemStyle,h=a.blurItemStyle,f=a.selectItemStyle,c=a.focus,d=a.blurScope,p=a.labelStatesModels,g=a.hoverScale,m=a.cursorStyle,v=a.emphasisDisabled),!a||r.hasItemOption){var _=a&&a.itemModel?a.itemModel:r.getItemModel(n),y=_.getModel("emphasis");u=y.getModel("itemStyle").getItemStyle(),f=_.getModel(["select","itemStyle"]).getItemStyle(),h=_.getModel(["blur","itemStyle"]).getItemStyle(),c=y.get("focus"),d=y.get("blurScope"),v=y.get("disabled"),p=an(_),g=y.getShallow("scale"),m=_.getShallow("cursor")}var x=r.getItemVisual(n,"symbolRotate");s.attr("rotation",(x||0)*Math.PI/180||0);var T=ku(r.getItemVisual(n,"symbolOffset"),i);T&&(s.x=T[0],s.y=T[1]),m&&s.attr("cursor",m);var S=r.getItemVisual(n,"style"),M=S.fill;if(s instanceof hn){var w=s.style;s.useStyle(rt({image:w.image,x:w.x,y:w.y,width:w.width,height:w.height},S))}else s.__isEmptyBrush?s.useStyle(rt({},S)):s.useStyle(S),s.style.decal=null,s.setColor(M,o&&o.symbolInnerColor),s.style.strokeNoScale=!0;var b=r.getItemVisual(n,"liftZ"),A=this._z2;b!=null?A==null&&(this._z2=s.z2,s.z2+=b):A!=null&&(s.z2=A,this._z2=null);var E=o&&o.useNameLabel;Sn(s,p,{labelFetcher:l,labelDataIndex:n,defaultText:C,inheritColor:M,defaultOpacity:S.opacity});function C(P){return E?r.getName(P):vf(r,P)}this._sizeX=i[0]/2,this._sizeY=i[1]/2;var D=s.ensureState("emphasis");D.style=u,s.ensureState("select").style=f,s.ensureState("blur").style=h;var L=g==null||g===!0?Math.max(1.1,3/this._sizeY):isFinite(g)&&g>0?+g:1;D.scaleX=this._sizeX*L,D.scaleY=this._sizeY*L,this.setSymbolScale(1),Sr(this,c,d,v)},t.prototype.setSymbolScale=function(r){this.scaleX=this.scaleY=r},t.prototype.fadeOut=function(r,n,i){var a=this.childAt(0),o=oe(this).dataIndex,s=i&&i.animation;if(this.silent=a.silent=!0,i&&i.fadeLabel){var l=a.getTextContent();l&&Fs(l,{style:{opacity:0}},n,{dataIndex:o,removeOpt:s,cb:function(){a.removeTextContent()}})}else a.removeTextContent();Fs(a,{style:{opacity:0},scaleX:0,scaleY:0},n,{dataIndex:o,cb:r,removeOpt:s})},t.getSymbolSize=function(r,n){return $f(r.getItemVisual(n,"symbolSize"))},t}(re);function S7(e,t){this.parent.drift(e,t)}function By(e,t,r,n){return t&&!isNaN(t[0])&&!isNaN(t[1])&&!(n.isIgnore&&n.isIgnore(r))&&!(n.clipShape&&!n.clipShape.contain(t[0],t[1]))&&e.getItemVisual(r,"symbol")!=="none"}function NC(e){return e!=null&&!Kt(e)&&(e={isIgnore:e}),e||{}}function OC(e){var t=e.hostModel,r=t.getModel("emphasis");return{emphasisItemStyle:r.getModel("itemStyle").getItemStyle(),blurItemStyle:t.getModel(["blur","itemStyle"]).getItemStyle(),selectItemStyle:t.getModel(["select","itemStyle"]).getItemStyle(),focus:r.get("focus"),blurScope:r.get("blurScope"),emphasisDisabled:r.get("disabled"),hoverScale:r.get("scale"),labelStatesModels:an(t),cursorStyle:t.get("cursor")}}var Lv=function(){function e(t){this.group=new re,this._SymbolCtor=t||Dv}return e.prototype.updateData=function(t,r){this._progressiveEls=null,r=NC(r);var n=this.group,i=t.hostModel,a=this._data,o=this._SymbolCtor,s=r.disableAnimation,l=OC(t),u={disableAnimation:s},h=r.getSymbolPoint||function(f){return t.getItemLayout(f)};a||n.removeAll(),t.diff(a).add(function(f){var c=h(f);if(By(t,c,f,r)){var d=new o(t,f,l,u);d.setPosition(c),t.setItemGraphicEl(f,d),n.add(d)}}).update(function(f,c){var d=a.getItemGraphicEl(c),v=h(f);if(!By(t,v,f,r)){n.remove(d);return}var p=t.getItemVisual(f,"symbol")||"circle",g=d&&d.getSymbolType&&d.getSymbolType();if(!d||g&&g!==p)n.remove(d),d=new o(t,f,l,u),d.setPosition(v);else{d.updateData(t,f,l,u);var m={x:v[0],y:v[1]};s?d.attr(m):ke(d,m,i)}n.add(d),t.setItemGraphicEl(f,d)}).remove(function(f){var c=a.getItemGraphicEl(f);c&&c.fadeOut(function(){n.remove(c)},i)}).execute(),this._getSymbolPoint=h,this._data=t},e.prototype.updateLayout=function(){var t=this,r=this._data;r&&r.eachItemGraphicEl(function(n,i){var a=t._getSymbolPoint(i);n.setPosition(a),n.markRedraw()})},e.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=OC(t),this._data=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(t,r,n){this._progressiveEls=[],n=NC(n);function i(l){l.isGroup||(l.incremental=!0,l.ensureState("emphasis").hoverLayer=!0)}for(var a=t.start;a<t.end;a++){var o=r.getItemLayout(a);if(By(r,o,a,n)){var s=new this._SymbolCtor(r,a,this._seriesScope);s.traverse(i),s.setPosition(o),this.group.add(s),r.setItemGraphicEl(a,s),this._progressiveEls.push(s)}}},e.prototype.eachRendered=function(t){Hs(this._progressiveEls||this.group,t)},e.prototype.remove=function(t){var r=this.group,n=this._data;n&&t?n.eachItemGraphicEl(function(i){i.fadeOut(function(){r.remove(i)},n.hostModel)}):r.removeAll()},e}();function YB(e,t,r){var n=e.getBaseAxis(),i=e.getOtherAxis(n),a=T7(i,r),o=n.dim,s=i.dim,l=t.mapDimension(s),u=t.mapDimension(o),h=s==="x"||s==="radius"?1:0,f=ft(e.dimensions,function(v){return t.mapDimension(v)}),c=!1,d=t.getCalculationInfo("stackResultDimension");return Oo(t,f[0])&&(c=!0,f[0]=d),Oo(t,f[1])&&(c=!0,f[1]=d),{dataDimsForPoint:f,valueStart:a,valueAxisDim:s,baseAxisDim:o,stacked:!!c,valueDim:l,baseDim:u,baseDataOffset:h,stackedOverDimension:t.getCalculationInfo("stackedOverDimension")}}function T7(e,t){var r=0,n=e.scale.getExtent();return t==="start"?r=n[0]:t==="end"?r=n[1]:Be(t)&&!isNaN(t)?r=t:n[0]>0?r=n[0]:n[1]<0&&(r=n[1]),r}function ZB(e,t,r,n){var i=NaN;e.stacked&&(i=r.get(r.getCalculationInfo("stackedOverDimension"),n)),isNaN(i)&&(i=e.valueStart);var a=e.baseDataOffset,o=[];return o[a]=r.get(e.baseDim,n),o[1-a]=i,t.dataToPoint(o)}function b7(e,t){var r=[];return t.diff(e).add(function(n){r.push({cmd:"+",idx:n})}).update(function(n,i){r.push({cmd:"=",idx:i,idx1:n})}).remove(function(n){r.push({cmd:"-",idx:n})}).execute(),r}function w7(e,t,r,n,i,a,o,s){for(var l=b7(e,t),u=[],h=[],f=[],c=[],d=[],v=[],p=[],g=YB(i,t,o),m=e.getLayout("points")||[],_=t.getLayout("points")||[],y=0;y<l.length;y++){var x=l[y],T=!0,S=void 0,M=void 0;switch(x.cmd){case"=":S=x.idx*2,M=x.idx1*2;var w=m[S],b=m[S+1],A=_[M],E=_[M+1];(isNaN(w)||isNaN(b))&&(w=A,b=E),u.push(w,b),h.push(A,E),f.push(r[S],r[S+1]),c.push(n[M],n[M+1]),p.push(t.getRawIndex(x.idx1));break;case"+":var C=x.idx,D=g.dataDimsForPoint,L=i.dataToPoint([t.get(D[0],C),t.get(D[1],C)]);M=C*2,u.push(L[0],L[1]),h.push(_[M],_[M+1]);var P=ZB(g,i,t,C);f.push(P[0],P[1]),c.push(n[M],n[M+1]),p.push(t.getRawIndex(C));break;case"-":T=!1}T&&(d.push(x),v.push(v.length))}v.sort(function(Z,ct){return p[Z]-p[ct]});for(var N=u.length,O=Ba(N),I=Ba(N),k=Ba(N),z=Ba(N),X=[],y=0;y<v.length;y++){var Y=v[y],$=y*2,H=Y*2;O[$]=u[H],O[$+1]=u[H+1],I[$]=h[H],I[$+1]=h[H+1],k[$]=f[H],k[$+1]=f[H+1],z[$]=c[H],z[$+1]=c[H+1],X[y]=d[Y]}return{current:O,next:I,stackedOnCurrent:k,stackedOnNext:z,status:X}}var Jo=Math.min,Qo=Math.max;function pu(e,t){return isNaN(e)||isNaN(t)}function QS(e,t,r,n,i,a,o,s,l){for(var u,h,f,c,d,v,p=r,g=0;g<n;g++){var m=t[p*2],_=t[p*2+1];if(p>=i||p<0)break;if(pu(m,_)){if(l){p+=a;continue}break}if(p===r)e[a>0?"moveTo":"lineTo"](m,_),f=m,c=_;else{var y=m-u,x=_-h;if(y*y+x*x<.5){p+=a;continue}if(o>0){for(var T=p+a,S=t[T*2],M=t[T*2+1];S===m&&M===_&&g<n;)g++,T+=a,p+=a,S=t[T*2],M=t[T*2+1],m=t[p*2],_=t[p*2+1],y=m-u,x=_-h;var w=g+1;if(l)for(;pu(S,M)&&w<n;)w++,T+=a,S=t[T*2],M=t[T*2+1];var b=.5,A=0,E=0,C=void 0,D=void 0;if(w>=n||pu(S,M))d=m,v=_;else{A=S-u,E=M-h;var L=m-u,P=S-m,N=_-h,O=M-_,I=void 0,k=void 0;if(s==="x"){I=Math.abs(L),k=Math.abs(P);var z=A>0?1:-1;d=m-z*I*o,v=_,C=m+z*k*o,D=_}else if(s==="y"){I=Math.abs(N),k=Math.abs(O);var X=E>0?1:-1;d=m,v=_-X*I*o,C=m,D=_+X*k*o}else I=Math.sqrt(L*L+N*N),k=Math.sqrt(P*P+O*O),b=k/(k+I),d=m-A*o*(1-b),v=_-E*o*(1-b),C=m+A*o*b,D=_+E*o*b,C=Jo(C,Qo(S,m)),D=Jo(D,Qo(M,_)),C=Qo(C,Jo(S,m)),D=Qo(D,Jo(M,_)),A=C-m,E=D-_,d=m-A*I/k,v=_-E*I/k,d=Jo(d,Qo(u,m)),v=Jo(v,Qo(h,_)),d=Qo(d,Jo(u,m)),v=Qo(v,Jo(h,_)),A=m-d,E=_-v,C=m+A*k/I,D=_+E*k/I}e.bezierCurveTo(f,c,d,v,m,_),f=C,c=D}else e.lineTo(m,_)}u=m,h=_,p+=a}return g}var qB=function(){function e(){this.smooth=0,this.smoothConstraint=!0}return e}(),M7=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polyline",n}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new qB},t.prototype.buildPath=function(r,n){var i=n.points,a=0,o=i.length/2;if(n.connectNulls){for(;o>0&&pu(i[o*2-2],i[o*2-1]);o--);for(;a<o&&pu(i[a*2],i[a*2+1]);a++);}for(;a<o;)a+=QS(r,i,a,o,o,1,n.smooth,n.smoothMonotone,n.connectNulls)+1},t.prototype.getPointOn=function(r,n){this.path||(this.createPathProxy(),this.buildPath(this.path,this.shape));for(var i=this.path,a=i.data,o=Ka.CMD,s,l,u=n==="x",h=[],f=0;f<a.length;){var c=a[f++],d=void 0,v=void 0,p=void 0,g=void 0,m=void 0,_=void 0,y=void 0;switch(c){case o.M:s=a[f++],l=a[f++];break;case o.L:if(d=a[f++],v=a[f++],y=u?(r-s)/(d-s):(r-l)/(v-l),y<=1&&y>=0){var x=u?(v-l)*y+l:(d-s)*y+s;return u?[r,x]:[x,r]}s=d,l=v;break;case o.C:d=a[f++],v=a[f++],p=a[f++],g=a[f++],m=a[f++],_=a[f++];var T=u?cm(s,d,p,m,r,h):cm(l,v,g,_,r,h);if(T>0)for(var S=0;S<T;S++){var M=h[S];if(M<=1&&M>=0){var x=u?$r(l,v,g,_,M):$r(s,d,p,m,M);return u?[r,x]:[x,r]}}s=m,l=_;break}}},t}(_e),A7=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t}(qB),$B=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-polygon",n}return t.prototype.getDefaultShape=function(){return new A7},t.prototype.buildPath=function(r,n){var i=n.points,a=n.stackedOnPoints,o=0,s=i.length/2,l=n.smoothMonotone;if(n.connectNulls){for(;s>0&&pu(i[s*2-2],i[s*2-1]);s--);for(;o<s&&pu(i[o*2],i[o*2+1]);o++);}for(;o<s;){var u=QS(r,i,o,s,s,1,n.smooth,l,n.connectNulls);QS(r,a,o+u-1,u,s,-1,n.stackedOnSmooth,l,n.connectNulls),o+=u+1,r.closePath()}},t}(_e);function KB(e,t,r,n,i){var a=e.getArea(),o=a.x,s=a.y,l=a.width,u=a.height,h=r.get(["lineStyle","width"])||0;o-=h/2,s-=h/2,l+=h,u+=h,l=Math.ceil(l),o!==Math.floor(o)&&(o=Math.floor(o),l++);var f=new Ae({shape:{x:o,y:s,width:l,height:u}});if(t){var c=e.getBaseAxis(),d=c.isHorizontal(),v=c.inverse;d?(v&&(f.shape.x+=l),f.shape.width=0):(v||(f.shape.y+=u),f.shape.height=0);var p=Yt(i)?function(g){i(g,f)}:null;vr(f,{shape:{width:l,height:u,x:o,y:s}},r,null,n,p)}return f}function jB(e,t,r){var n=e.getArea(),i=dr(n.r0,1),a=dr(n.r,1),o=new Xn({shape:{cx:dr(e.cx,1),cy:dr(e.cy,1),r0:i,r:a,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}});if(t){var s=e.getBaseAxis().dim==="angle";s?o.shape.endAngle=n.startAngle:o.shape.r=i,vr(o,{shape:{endAngle:n.endAngle,r:a}},r)}return o}function Rv(e,t,r,n,i){if(e){if(e.type==="polar")return jB(e,t,r);if(e.type==="cartesian2d")return KB(e,t,r,n,i)}else return null;return null}function Vu(e,t){return e.type===t}function FC(e,t){if(e.length===t.length){for(var r=0;r<e.length;r++)if(e[r]!==t[r])return;return!0}}function BC(e){for(var t=1/0,r=1/0,n=-1/0,i=-1/0,a=0;a<e.length;){var o=e[a++],s=e[a++];isNaN(o)||(t=Math.min(o,t),n=Math.max(o,n)),isNaN(s)||(r=Math.min(s,r),i=Math.max(s,i))}return[[t,r],[n,i]]}function UC(e,t){var r=BC(e),n=r[0],i=r[1],a=BC(t),o=a[0],s=a[1];return Math.max(Math.abs(n[0]-o[0]),Math.abs(n[1]-o[1]),Math.abs(i[0]-s[0]),Math.abs(i[1]-s[1]))}function zC(e){return Be(e)?e:e?.5:0}function E7(e,t,r){if(!r.valueDim)return[];for(var n=t.count(),i=Ba(n*2),a=0;a<n;a++){var o=ZB(r,e,t,a);i[a*2]=o[0],i[a*2+1]=o[1]}return i}function ts(e,t,r,n,i){var a=r.getBaseAxis(),o=a.dim==="x"||a.dim==="radius"?0:1,s=[],l=0,u=[],h=[],f=[],c=[];if(i){for(l=0;l<e.length;l+=2){var d=t||e;!isNaN(d[l])&&!isNaN(d[l+1])&&c.push(e[l],e[l+1])}e=c}for(l=0;l<e.length-2;l+=2)switch(f[0]=e[l+2],f[1]=e[l+3],h[0]=e[l],h[1]=e[l+1],s.push(h[0],h[1]),n){case"end":u[o]=f[o],u[1-o]=h[1-o],s.push(u[0],u[1]);break;case"middle":var v=(h[o]+f[o])/2,p=[];u[o]=p[o]=v,u[1-o]=h[1-o],p[1-o]=f[1-o],s.push(u[0],u[1]),s.push(p[0],p[1]);break;default:u[o]=h[o],u[1-o]=f[1-o],s.push(u[0],u[1])}return s.push(e[l++],e[l++]),s}function C7(e,t){var r=[],n=e.length,i,a;function o(h,f,c){var d=h.coord,v=(c-d)/(f.coord-d),p=yV(v,[h.color,f.color]);return{coord:c,color:p}}for(var s=0;s<n;s++){var l=e[s],u=l.coord;if(u<0)i=l;else if(u>t){a?r.push(o(a,l,t)):i&&r.push(o(i,l,0),o(i,l,t));break}else i&&(r.push(o(i,l,0)),i=null),r.push(l),a=l}return r}function D7(e,t,r){var n=e.getVisual("visualMeta");if(!(!n||!n.length||!e.count())&&t.type==="cartesian2d"){for(var i,a,o=n.length-1;o>=0;o--){var s=e.getDimensionInfo(n[o].dimension);if(i=s&&s.coordDim,i==="x"||i==="y"){a=n[o];break}}if(a){var l=t.getAxis(i),u=ft(a.stops,function(y){return{coord:l.toGlobalCoord(l.dataToCoord(y.value)),color:y.color}}),h=u.length,f=a.outerColors.slice();h&&u[0].coord>u[h-1].coord&&(u.reverse(),f.reverse());var c=C7(u,i==="x"?r.getWidth():r.getHeight()),d=c.length;if(!d&&h)return u[0].coord<0?f[1]?f[1]:u[h-1].color:f[0]?f[0]:u[0].color;var v=10,p=c[0].coord-v,g=c[d-1].coord+v,m=g-p;if(m<.001)return"transparent";R(c,function(y){y.offset=(y.coord-p)/m}),c.push({offset:d?c[d-1].offset:.5,color:f[1]||"transparent"}),c.unshift({offset:d?c[0].offset:.5,color:f[0]||"transparent"});var _=new bv(0,0,0,0,c,!0);return _[i]=p,_[i+"2"]=g,_}}}function L7(e,t,r){var n=e.get("showAllSymbol"),i=n==="auto";if(!(n&&!i)){var a=r.getAxesByScale("ordinal")[0];if(a&&!(i&&R7(a,t))){var o=t.mapDimension(a.dim),s={};return R(a.getViewLabels(),function(l){var u=a.scale.getRawOrdinalNumber(l.tickValue);s[u]=1}),function(l){return!s.hasOwnProperty(t.get(o,l))}}}}function R7(e,t){var r=e.getExtent(),n=Math.abs(r[1]-r[0])/e.scale.count();isNaN(n)&&(n=0);for(var i=t.count(),a=Math.max(1,Math.round(i/5)),o=0;o<i;o+=a)if(Dv.getSymbolSize(t,o)[e.isHorizontal()?1:0]*1.5>n)return!1;return!0}function P7(e,t){return isNaN(e)||isNaN(t)}function I7(e){for(var t=e.length/2;t>0&&P7(e[t*2-2],e[t*2-1]);t--);return t-1}function kC(e,t){return[e[t*2],e[t*2+1]]}function N7(e,t,r){for(var n=e.length/2,i=r==="x"?0:1,a,o,s=0,l=-1,u=0;u<n;u++)if(o=e[u*2+i],!(isNaN(o)||isNaN(e[u*2+1-i]))){if(u===0){a=o;continue}if(a<=t&&o>=t||a>=t&&o<=t){l=u;break}s=u,a=o}return{range:[s,l],t:(t-a)/(o-a)}}function JB(e){if(e.get(["endLabel","show"]))return!0;for(var t=0;t<Wn.length;t++)if(e.get([Wn[t],"endLabel","show"]))return!0;return!1}function Uy(e,t,r,n){if(Vu(t,"cartesian2d")){var i=n.getModel("endLabel"),a=i.get("valueAnimation"),o=n.getData(),s={lastFrameIndex:0},l=JB(n)?function(d,v){e._endLabelOnDuring(d,v,o,s,a,i,t)}:null,u=t.getBaseAxis().isHorizontal(),h=KB(t,r,n,function(){var d=e._endLabel;d&&r&&s.originalX!=null&&d.attr({x:s.originalX,y:s.originalY})},l);if(!n.get("clip",!0)){var f=h.shape,c=Math.max(f.width,f.height);u?(f.y-=c,f.height+=c*2):(f.x-=c,f.width+=c*2)}return l&&l(1,h),h}else return jB(t,r,n)}function O7(e,t){var r=t.getBaseAxis(),n=r.isHorizontal(),i=r.inverse,a=n?i?"right":"left":"center",o=n?"middle":i?"top":"bottom";return{normal:{align:e.get("align")||a,verticalAlign:e.get("verticalAlign")||o}}}var F7=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(){var r=new re,n=new Lv;this.group.add(n.group),this._symbolDraw=n,this._lineGroup=r,this._changePolyState=It(this._changePolyState,this)},t.prototype.render=function(r,n,i){var a=r.coordinateSystem,o=this.group,s=r.getData(),l=r.getModel("lineStyle"),u=r.getModel("areaStyle"),h=s.getLayout("points")||[],f=a.type==="polar",c=this._coordSys,d=this._symbolDraw,v=this._polyline,p=this._polygon,g=this._lineGroup,m=!n.ssr&&r.get("animation"),_=!u.isEmpty(),y=u.get("origin"),x=YB(a,s,y),T=_&&E7(a,s,x),S=r.get("showSymbol"),M=r.get("connectNulls"),w=S&&!f&&L7(r,s,a),b=this._data;b&&b.eachItemGraphicEl(function(Z,ct){Z.__temp&&(o.remove(Z),b.setItemGraphicEl(ct,null))}),S||d.remove(),o.add(g);var A=f?!1:r.get("step"),E;a&&a.getArea&&r.get("clip",!0)&&(E=a.getArea(),E.width!=null?(E.x-=.1,E.y-=.1,E.width+=.2,E.height+=.2):E.r0&&(E.r0-=.5,E.r+=.5)),this._clipShapeForSymbol=E;var C=D7(s,a,i)||s.getVisual("style")[s.getVisual("drawType")];if(!(v&&c.type===a.type&&A===this._step))S&&d.updateData(s,{isIgnore:w,clipShape:E,disableAnimation:!0,getSymbolPoint:function(Z){return[h[Z*2],h[Z*2+1]]}}),m&&this._initSymbolLabelAnimation(s,a,E),A&&(T&&(T=ts(T,h,a,A,M)),h=ts(h,null,a,A,M)),v=this._newPolyline(h),_?p=this._newPolygon(h,T):p&&(g.remove(p),p=this._polygon=null),f||this._initOrUpdateEndLabel(r,a,Mu(C)),g.setClipPath(Uy(this,a,!0,r));else{_&&!p?p=this._newPolygon(h,T):p&&!_&&(g.remove(p),p=this._polygon=null),f||this._initOrUpdateEndLabel(r,a,Mu(C));var D=g.getClipPath();if(D){var L=Uy(this,a,!1,r);vr(D,{shape:L.shape},r)}else g.setClipPath(Uy(this,a,!0,r));S&&d.updateData(s,{isIgnore:w,clipShape:E,disableAnimation:!0,getSymbolPoint:function(Z){return[h[Z*2],h[Z*2+1]]}}),(!FC(this._stackedOnPoints,T)||!FC(this._points,h))&&(m?this._doUpdateAnimation(s,T,a,i,A,y,M):(A&&(T&&(T=ts(T,h,a,A,M)),h=ts(h,null,a,A,M)),v.setShape({points:h}),p&&p.setShape({points:h,stackedOnPoints:T})))}var P=r.getModel("emphasis"),N=P.get("focus"),O=P.get("blurScope"),I=P.get("disabled");if(v.useStyle(Vt(l.getLineStyle(),{fill:"none",stroke:C,lineJoin:"bevel"})),xn(v,r,"lineStyle"),v.style.lineWidth>0&&r.get(["emphasis","lineStyle","width"])==="bolder"){var k=v.getState("emphasis").style;k.lineWidth=+v.style.lineWidth+1}oe(v).seriesIndex=r.seriesIndex,Sr(v,N,O,I);var z=zC(r.get("smooth")),X=r.get("smoothMonotone");if(v.setShape({smooth:z,smoothMonotone:X,connectNulls:M}),p){var Y=s.getCalculationInfo("stackedOnSeries"),$=0;p.useStyle(Vt(u.getAreaStyle(),{fill:C,opacity:.7,lineJoin:"bevel",decal:s.getVisual("style").decal})),Y&&($=zC(Y.get("smooth"))),p.setShape({smooth:z,stackedOnSmooth:$,smoothMonotone:X,connectNulls:M}),xn(p,r,"areaStyle"),oe(p).seriesIndex=r.seriesIndex,Sr(p,N,O,I)}var H=this._changePolyState;s.eachItemGraphicEl(function(Z){Z&&(Z.onHoverStateChange=H)}),this._polyline.onHoverStateChange=H,this._data=s,this._coordSys=a,this._stackedOnPoints=T,this._points=h,this._step=A,this._valueOrigin=y,r.get("triggerLineEvent")&&(this.packEventData(r,v),p&&this.packEventData(r,p))},t.prototype.packEventData=function(r,n){oe(n).eventData={componentType:"series",componentSubType:"line",componentIndex:r.componentIndex,seriesIndex:r.seriesIndex,seriesName:r.name,seriesType:"line"}},t.prototype.highlight=function(r,n,i,a){var o=r.getData(),s=Tu(o,a);if(this._changePolyState("emphasis"),!(s instanceof Array)&&s!=null&&s>=0){var l=o.getLayout("points"),u=o.getItemGraphicEl(s);if(!u){var h=l[s*2],f=l[s*2+1];if(isNaN(h)||isNaN(f)||this._clipShapeForSymbol&&!this._clipShapeForSymbol.contain(h,f))return;var c=r.get("zlevel")||0,d=r.get("z")||0;u=new Dv(o,s),u.x=h,u.y=f,u.setZ(c,d);var v=u.getSymbolPath().getTextContent();v&&(v.zlevel=c,v.z=d,v.z2=this._polyline.z2+1),u.__temp=!0,o.setItemGraphicEl(s,u),u.stopSymbolAnimation(!0),this.group.add(u)}u.highlight()}else De.prototype.highlight.call(this,r,n,i,a)},t.prototype.downplay=function(r,n,i,a){var o=r.getData(),s=Tu(o,a);if(this._changePolyState("normal"),s!=null&&s>=0){var l=o.getItemGraphicEl(s);l&&(l.__temp?(o.setItemGraphicEl(s,null),this.group.remove(l)):l.downplay())}else De.prototype.downplay.call(this,r,n,i,a)},t.prototype._changePolyState=function(r){var n=this._polygon;ym(this._polyline,r),n&&ym(n,r)},t.prototype._newPolyline=function(r){var n=this._polyline;return n&&this._lineGroup.remove(n),n=new M7({shape:{points:r},segmentIgnoreThreshold:2,z2:10}),this._lineGroup.add(n),this._polyline=n,n},t.prototype._newPolygon=function(r,n){var i=this._polygon;return i&&this._lineGroup.remove(i),i=new $B({shape:{points:r,stackedOnPoints:n},segmentIgnoreThreshold:2}),this._lineGroup.add(i),this._polygon=i,i},t.prototype._initSymbolLabelAnimation=function(r,n,i){var a,o,s=n.getBaseAxis(),l=s.inverse;n.type==="cartesian2d"?(a=s.isHorizontal(),o=!1):n.type==="polar"&&(a=s.dim==="angle",o=!0);var u=r.hostModel,h=u.get("animationDuration");Yt(h)&&(h=h(null));var f=u.get("animationDelay")||0,c=Yt(f)?f(null):f;r.eachItemGraphicEl(function(d,v){var p=d;if(p){var g=[d.x,d.y],m=void 0,_=void 0,y=void 0;if(i)if(o){var x=i,T=n.pointToCoord(g);a?(m=x.startAngle,_=x.endAngle,y=-T[1]/180*Math.PI):(m=x.r0,_=x.r,y=T[0])}else{var S=i;a?(m=S.x,_=S.x+S.width,y=d.x):(m=S.y+S.height,_=S.y,y=d.y)}var M=_===m?0:(y-m)/(_-m);l&&(M=1-M);var w=Yt(f)?f(v):h*M+c,b=p.getSymbolPath(),A=b.getTextContent();p.attr({scaleX:0,scaleY:0}),p.animateTo({scaleX:1,scaleY:1},{duration:200,setToFinal:!0,delay:w}),A&&A.animateFrom({style:{opacity:0}},{duration:300,delay:w}),b.disableLabelAnimation=!0}})},t.prototype._initOrUpdateEndLabel=function(r,n,i){var a=r.getModel("endLabel");if(JB(r)){var o=r.getData(),s=this._polyline,l=o.getLayout("points");if(!l){s.removeTextContent(),this._endLabel=null;return}var u=this._endLabel;u||(u=this._endLabel=new we({z2:200}),u.ignoreClip=!0,s.setTextContent(this._endLabel),s.disableLabelAnimation=!0);var h=I7(l);h>=0&&(Sn(s,an(r,"endLabel"),{inheritColor:i,labelFetcher:r,labelDataIndex:h,defaultText:function(f,c,d){return d!=null?XB(o,d):vf(o,f)},enableTextSetter:!0},O7(a,n)),s.textConfig.position=null)}else this._endLabel&&(this._polyline.removeTextContent(),this._endLabel=null)},t.prototype._endLabelOnDuring=function(r,n,i,a,o,s,l){var u=this._endLabel,h=this._polyline;if(u){r<1&&a.originalX==null&&(a.originalX=u.x,a.originalY=u.y);var f=i.getLayout("points"),c=i.hostModel,d=c.get("connectNulls"),v=s.get("precision"),p=s.get("distance")||0,g=l.getBaseAxis(),m=g.isHorizontal(),_=g.inverse,y=n.shape,x=_?m?y.x:y.y+y.height:m?y.x+y.width:y.y,T=(m?p:0)*(_?-1:1),S=(m?0:-p)*(_?-1:1),M=m?"x":"y",w=N7(f,x,M),b=w.range,A=b[1]-b[0],E=void 0;if(A>=1){if(A>1&&!d){var C=kC(f,b[0]);u.attr({x:C[0]+T,y:C[1]+S}),o&&(E=c.getRawValue(b[0]))}else{var C=h.getPointOn(x,M);C&&u.attr({x:C[0]+T,y:C[1]+S});var D=c.getRawValue(b[0]),L=c.getRawValue(b[1]);o&&(E=PO(i,v,D,L,w.t))}a.lastFrameIndex=b[0]}else{var P=r===1||a.lastFrameIndex>0?b[0]:0,C=kC(f,P);o&&(E=c.getRawValue(P)),u.attr({x:C[0]+T,y:C[1]+S})}if(o){var N=Gf(u);typeof N.setLabelText=="function"&&N.setLabelText(E)}}},t.prototype._doUpdateAnimation=function(r,n,i,a,o,s,l){var u=this._polyline,h=this._polygon,f=r.hostModel,c=w7(this._data,r,this._stackedOnPoints,n,this._coordSys,i,this._valueOrigin),d=c.current,v=c.stackedOnCurrent,p=c.next,g=c.stackedOnNext;if(o&&(v=ts(c.stackedOnCurrent,c.current,i,o,l),d=ts(c.current,null,i,o,l),g=ts(c.stackedOnNext,c.next,i,o,l),p=ts(c.next,null,i,o,l)),UC(d,p)>3e3||h&&UC(v,g)>3e3){u.stopAnimation(),u.setShape({points:p}),h&&(h.stopAnimation(),h.setShape({points:p,stackedOnPoints:g}));return}u.shape.__points=c.current,u.shape.points=d;var m={shape:{points:p}};c.current!==d&&(m.shape.__points=c.next),u.stopAnimation(),ke(u,m,f),h&&(h.setShape({points:d,stackedOnPoints:v}),h.stopAnimation(),ke(h,{shape:{stackedOnPoints:g}},f),u.shape.points!==h.shape.points&&(h.shape.points=u.shape.points));for(var _=[],y=c.status,x=0;x<y.length;x++){var T=y[x].cmd;if(T==="="){var S=r.getItemGraphicEl(y[x].idx1);S&&_.push({el:S,ptIdx:x})}}u.animators&&u.animators.length&&u.animators[0].during(function(){h&&h.dirtyShape();for(var M=u.shape.__points,w=0;w<_.length;w++){var b=_[w].el,A=_[w].ptIdx*2;b.x=M[A],b.y=M[A+1],b.markRedraw()}})},t.prototype.remove=function(r){var n=this.group,i=this._data;this._lineGroup.removeAll(),this._symbolDraw.remove(!0),i&&i.eachItemGraphicEl(function(a,o){a.__temp&&(n.remove(a),i.setItemGraphicEl(o,null))}),this._polyline=this._polygon=this._coordSys=this._points=this._stackedOnPoints=this._endLabel=this._data=null},t.type="line",t}(De);function Pv(e,t){return{seriesType:e,plan:Zf(),reset:function(r){var n=r.getData(),i=r.coordinateSystem,a=r.pipelineContext,o=t||a.large;if(i){var s=ft(i.dimensions,function(d){return n.mapDimension(d)}).slice(0,2),l=s.length,u=n.getCalculationInfo("stackResultDimension");Oo(n,s[0])&&(s[0]=u),Oo(n,s[1])&&(s[1]=u);var h=n.getStore(),f=n.getDimensionIndex(s[0]),c=n.getDimensionIndex(s[1]);return l&&{progress:function(d,v){for(var p=d.end-d.start,g=o&&Ba(p*l),m=[],_=[],y=d.start,x=0;y<d.end;y++){var T=void 0;if(l===1){var S=h.get(f,y);T=i.dataToPoint(S,null,_)}else m[0]=h.get(f,y),m[1]=h.get(c,y),T=i.dataToPoint(m,null,_);o?(g[x++]=T[0],g[x++]=T[1]):v.setItemLayout(y,T.slice())}o&&v.setLayout("points",g)}}}}}}var B7={average:function(e){for(var t=0,r=0,n=0;n<e.length;n++)isNaN(e[n])||(t+=e[n],r++);return r===0?NaN:t/r},sum:function(e){for(var t=0,r=0;r<e.length;r++)t+=e[r]||0;return t},max:function(e){for(var t=-1/0,r=0;r<e.length;r++)e[r]>t&&(t=e[r]);return isFinite(t)?t:NaN},min:function(e){for(var t=1/0,r=0;r<e.length;r++)e[r]<t&&(t=e[r]);return isFinite(t)?t:NaN},nearest:function(e){return e[0]}},U7=function(e){return Math.round(e.length/2)};function QB(e){return{seriesType:e,reset:function(t,r,n){var i=t.getData(),a=t.get("sampling"),o=t.coordinateSystem,s=i.count();if(s>10&&o.type==="cartesian2d"&&a){var l=o.getBaseAxis(),u=o.getOtherAxis(l),h=l.getExtent(),f=n.getDevicePixelRatio(),c=Math.abs(h[1]-h[0])*(f||1),d=Math.round(s/c);if(isFinite(d)&&d>1){a==="lttb"?t.setData(i.lttbDownSample(i.mapDimension(u.dim),1/d)):a==="minmax"&&t.setData(i.minmaxDownSample(i.mapDimension(u.dim),1/d));var v=void 0;Ct(a)?v=B7[a]:Yt(a)&&(v=a),v&&t.setData(i.downSample(i.mapDimension(u.dim),1/d,v,U7))}}}}}function z7(e){e.registerChartView(F7),e.registerSeriesModel(x7),e.registerLayout(Pv("line",!0)),e.registerVisual({seriesType:"line",reset:function(t){var r=t.getData(),n=t.getModel("lineStyle").getLineStyle();n&&!n.stroke&&(n.stroke=r.getVisual("style").fill),r.setVisual("legendLineStyle",n)}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,QB("line"))}var jd=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,n){return Qa(null,this,{useEncodeDefaulter:!0})},t.prototype.getMarkerPosition=function(r,n,i){var a=this.coordinateSystem;if(a&&a.clampData){var o=a.clampData(r),s=a.dataToPoint(o);if(i)R(a.getAxes(),function(c,d){if(c.type==="category"&&n!=null){var v=c.getTicksCoords(),p=c.getTickModel().get("alignWithLabel"),g=o[d],m=n[d]==="x1"||n[d]==="y1";if(m&&!p&&(g+=1),v.length<2)return;if(v.length===2){s[d]=c.toGlobalCoord(c.getExtent()[m?1:0]);return}for(var _=void 0,y=void 0,x=1,T=0;T<v.length;T++){var S=v[T].coord,M=T===v.length-1?v[T-1].tickValue+x:v[T].tickValue;if(M===g){y=S;break}else if(M<g)_=S;else if(_!=null&&M>g){y=(S+_)/2;break}T===1&&(x=M-v[0].tickValue)}y==null&&(_?_&&(y=v[v.length-1].coord):y=v[0].coord),s[d]=c.toGlobalCoord(y)}});else{var l=this.getData(),u=l.getLayout("offset"),h=l.getLayout("size"),f=a.getBaseAxis().isHorizontal()?0:1;s[f]+=u+h/2}return s}return[NaN,NaN]},t.type="series.__base_bar__",t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,barMinHeight:0,barMinAngle:0,large:!1,largeThreshold:400,progressive:3e3,progressiveChunkMode:"mod"},t}(Ue);Ue.registerClass(jd);var k7=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(){return Qa(null,this,{useEncodeDefaulter:!0,createInvertedIndices:!!this.get("realtimeSort",!0)||null})},t.prototype.getProgressive=function(){return this.get("large")?this.get("progressive"):!1},t.prototype.getProgressiveThreshold=function(){var r=this.get("progressiveThreshold"),n=this.get("largeThreshold");return n>r&&(r=n),r},t.prototype.brushSelector=function(r,n,i){return i.rect(n.getItemLayout(r))},t.type="series.bar",t.dependencies=["grid","polar"],t.defaultOption=Ws(jd.defaultOption,{clip:!0,roundCap:!1,showBackground:!1,backgroundStyle:{color:"rgba(180, 180, 180, 0.2)",borderColor:null,borderWidth:0,borderType:"solid",borderRadius:0,shadowBlur:0,shadowColor:null,shadowOffsetX:0,shadowOffsetY:0,opacity:1},select:{itemStyle:{borderColor:"#212121"}},realtimeSort:!1}),t}(jd),G7=function(){function e(){this.cx=0,this.cy=0,this.r0=0,this.r=0,this.startAngle=0,this.endAngle=Math.PI*2,this.clockwise=!0}return e}(),km=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="sausage",n}return t.prototype.getDefaultShape=function(){return new G7},t.prototype.buildPath=function(r,n){var i=n.cx,a=n.cy,o=Math.max(n.r0||0,0),s=Math.max(n.r,0),l=(s-o)*.5,u=o+l,h=n.startAngle,f=n.endAngle,c=n.clockwise,d=Math.PI*2,v=c?f-h<d:h-f<d;v||(h=f-(c?d:-d));var p=Math.cos(h),g=Math.sin(h),m=Math.cos(f),_=Math.sin(f);v?(r.moveTo(p*o+i,g*o+a),r.arc(p*u+i,g*u+a,l,-Math.PI+h,h,!c)):r.moveTo(p*s+i,g*s+a),r.arc(i,a,s,h,f,!c),r.arc(m*u+i,_*u+a,l,f-Math.PI*2,f-Math.PI,!c),o!==0&&r.arc(i,a,o,f,h,c)},t}(_e);function V7(e,t){t=t||{};var r=t.isRoundCap;return function(n,i,a){var o=i.position;if(!o||o instanceof Array)return mm(n,i,a);var s=e(o),l=i.distance!=null?i.distance:5,u=this.shape,h=u.cx,f=u.cy,c=u.r,d=u.r0,v=(c+d)/2,p=u.startAngle,g=u.endAngle,m=(p+g)/2,_=r?Math.abs(c-d)/2:0,y=Math.cos,x=Math.sin,T=h+c*y(p),S=f+c*x(p),M="left",w="top";switch(s){case"startArc":T=h+(d-l)*y(m),S=f+(d-l)*x(m),M="center",w="top";break;case"insideStartArc":T=h+(d+l)*y(m),S=f+(d+l)*x(m),M="center",w="bottom";break;case"startAngle":T=h+v*y(p)+Lp(p,l+_,!1),S=f+v*x(p)+Rp(p,l+_,!1),M="right",w="middle";break;case"insideStartAngle":T=h+v*y(p)+Lp(p,-l+_,!1),S=f+v*x(p)+Rp(p,-l+_,!1),M="left",w="middle";break;case"middle":T=h+v*y(m),S=f+v*x(m),M="center",w="middle";break;case"endArc":T=h+(c+l)*y(m),S=f+(c+l)*x(m),M="center",w="bottom";break;case"insideEndArc":T=h+(c-l)*y(m),S=f+(c-l)*x(m),M="center",w="top";break;case"endAngle":T=h+v*y(g)+Lp(g,l+_,!0),S=f+v*x(g)+Rp(g,l+_,!0),M="left",w="middle";break;case"insideEndAngle":T=h+v*y(g)+Lp(g,-l+_,!0),S=f+v*x(g)+Rp(g,-l+_,!0),M="right",w="middle";break;default:return mm(n,i,a)}return n=n||{},n.x=T,n.y=S,n.align=M,n.verticalAlign=w,n}}function H7(e,t,r,n){if(Be(n)){e.setTextConfig({rotation:n});return}else if(at(t)){e.setTextConfig({rotation:0});return}var i=e.shape,a=i.clockwise?i.startAngle:i.endAngle,o=i.clockwise?i.endAngle:i.startAngle,s=(a+o)/2,l,u=r(t);switch(u){case"startArc":case"insideStartArc":case"middle":case"insideEndArc":case"endArc":l=s;break;case"startAngle":case"insideStartAngle":l=a;break;case"endAngle":case"insideEndAngle":l=o;break;default:e.setTextConfig({rotation:0});return}var h=Math.PI*1.5-l;u==="middle"&&h>Math.PI/2&&h<Math.PI*1.5&&(h-=Math.PI),e.setTextConfig({rotation:h})}function Lp(e,t,r){return t*Math.sin(e)*(r?-1:1)}function Rp(e,t,r){return t*Math.cos(e)*(r?1:-1)}function ru(e,t,r){var n=e.get("borderRadius");if(n==null)return r?{cornerRadius:0}:null;at(n)||(n=[n,n,n,n]);var i=Math.abs(t.r||0-t.r0||0);return{cornerRadius:ft(n,function(a){return _a(a,i)})}}var zy=Math.max,ky=Math.min;function W7(e,t){var r=e.getArea&&e.getArea();if(Vu(e,"cartesian2d")){var n=e.getBaseAxis();if(n.type!=="category"||!n.onBand){var i=t.getLayout("bandWidth");n.isHorizontal()?(r.x-=i,r.width+=i*2):(r.y-=i,r.height+=i*2)}}return r}var X7=function(e){q(t,e);function t(){var r=e.call(this)||this;return r.type=t.type,r._isFirstFrame=!0,r}return t.prototype.render=function(r,n,i,a){this._model=r,this._removeOnRenderedListener(i),this._updateDrawMode(r);var o=r.get("coordinateSystem");(o==="cartesian2d"||o==="polar")&&(this._progressiveEls=null,this._isLargeDraw?this._renderLarge(r,n,i):this._renderNormal(r,n,i,a))},t.prototype.incrementalPrepareRender=function(r){this._clear(),this._updateDrawMode(r),this._updateLargeClip(r)},t.prototype.incrementalRender=function(r,n){this._progressiveEls=[],this._incrementalRenderLarge(r,n)},t.prototype.eachRendered=function(r){Hs(this._progressiveEls||this.group,r)},t.prototype._updateDrawMode=function(r){var n=r.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},t.prototype._renderNormal=function(r,n,i,a){var o=this.group,s=r.getData(),l=this._data,u=r.coordinateSystem,h=u.getBaseAxis(),f;u.type==="cartesian2d"?f=h.isHorizontal():u.type==="polar"&&(f=h.dim==="angle");var c=r.isAnimationEnabled()?r:null,d=Y7(r,u);d&&this._enableRealtimeSort(d,s,i);var v=r.get("clip",!0)||d,p=W7(u,s);o.removeClipPath();var g=r.get("roundCap",!0),m=r.get("showBackground",!0),_=r.getModel("backgroundStyle"),y=_.get("borderRadius")||0,x=[],T=this._backgroundEls,S=a&&a.isInitSort,M=a&&a.type==="changeAxisOrder";function w(E){var C=Pp[u.type](s,E),D=Q7(u,f,C);return D.useStyle(_.getItemStyle()),u.type==="cartesian2d"?D.setShape("r",y):D.setShape("cornerRadius",y),x[E]=D,D}s.diff(l).add(function(E){var C=s.getItemModel(E),D=Pp[u.type](s,E,C);if(m&&w(E),!(!s.hasValue(E)||!XC[u.type](D))){var L=!1;v&&(L=GC[u.type](p,D));var P=VC[u.type](r,s,E,D,f,c,h.model,!1,g);d&&(P.forceLabelAnimation=!0),YC(P,s,E,C,D,r,f,u.type==="polar"),S?P.attr({shape:D}):d?HC(d,c,P,D,E,f,!1,!1):vr(P,{shape:D},r,E),s.setItemGraphicEl(E,P),o.add(P),P.ignore=L}}).update(function(E,C){var D=s.getItemModel(E),L=Pp[u.type](s,E,D);if(m){var P=void 0;T.length===0?P=w(C):(P=T[C],P.useStyle(_.getItemStyle()),u.type==="cartesian2d"?P.setShape("r",y):P.setShape("cornerRadius",y),x[E]=P);var N=Pp[u.type](s,E),O=eU(f,N,u);ke(P,{shape:O},c,E)}var I=l.getItemGraphicEl(C);if(!s.hasValue(E)||!XC[u.type](L)){o.remove(I);return}var k=!1;if(v&&(k=GC[u.type](p,L),k&&o.remove(I)),I?ya(I):I=VC[u.type](r,s,E,L,f,c,h.model,!!I,g),d&&(I.forceLabelAnimation=!0),M){var z=I.getTextContent();if(z){var X=Gf(z);X.prevValue!=null&&(X.prevValue=X.value)}}else YC(I,s,E,D,L,r,f,u.type==="polar");S?I.attr({shape:L}):d?HC(d,c,I,L,E,f,!0,M):ke(I,{shape:L},r,E,null),s.setItemGraphicEl(E,I),I.ignore=k,o.add(I)}).remove(function(E){var C=l.getItemGraphicEl(E);C&&Gd(C,r,E)}).execute();var b=this._backgroundGroup||(this._backgroundGroup=new re);b.removeAll();for(var A=0;A<x.length;++A)b.add(x[A]);o.add(b),this._backgroundEls=x,this._data=s},t.prototype._renderLarge=function(r,n,i){this._clear(),qC(r,this.group),this._updateLargeClip(r)},t.prototype._incrementalRenderLarge=function(r,n){this._removeBackground(),qC(n,this.group,this._progressiveEls,!0)},t.prototype._updateLargeClip=function(r){var n=r.get("clip",!0)&&Rv(r.coordinateSystem,!1,r),i=this.group;n?i.setClipPath(n):i.removeClipPath()},t.prototype._enableRealtimeSort=function(r,n,i){var a=this;if(n.count()){var o=r.baseAxis;if(this._isFirstFrame)this._dispatchInitSort(n,r,i),this._isFirstFrame=!1;else{var s=function(l){var u=n.getItemGraphicEl(l),h=u&&u.shape;return h&&Math.abs(o.isHorizontal()?h.height:h.width)||0};this._onRendered=function(){a._updateSortWithinSameData(n,s,o,i)},i.getZr().on("rendered",this._onRendered)}}},t.prototype._dataSort=function(r,n,i){var a=[];return r.each(r.mapDimension(n.dim),function(o,s){var l=i(s);l=l??NaN,a.push({dataIndex:s,mappedValue:l,ordinalNumber:o})}),a.sort(function(o,s){return s.mappedValue-o.mappedValue}),{ordinalNumbers:ft(a,function(o){return o.ordinalNumber})}},t.prototype._isOrderChangedWithinSameData=function(r,n,i){for(var a=i.scale,o=r.mapDimension(i.dim),s=Number.MAX_VALUE,l=0,u=a.getOrdinalMeta().categories.length;l<u;++l){var h=r.rawIndexOf(o,a.getRawOrdinalNumber(l)),f=h<0?Number.MIN_VALUE:n(r.indexOfRawIndex(h));if(f>s)return!0;s=f}return!1},t.prototype._isOrderDifferentInView=function(r,n){for(var i=n.scale,a=i.getExtent(),o=Math.max(0,a[0]),s=Math.min(a[1],i.getOrdinalMeta().categories.length-1);o<=s;++o)if(r.ordinalNumbers[o]!==i.getRawOrdinalNumber(o))return!0},t.prototype._updateSortWithinSameData=function(r,n,i,a){if(this._isOrderChangedWithinSameData(r,n,i)){var o=this._dataSort(r,i,n);this._isOrderDifferentInView(o,i)&&(this._removeOnRenderedListener(a),a.dispatchAction({type:"changeAxisOrder",componentType:i.dim+"Axis",axisId:i.index,sortInfo:o}))}},t.prototype._dispatchInitSort=function(r,n,i){var a=n.baseAxis,o=this._dataSort(r,a,function(s){return r.get(r.mapDimension(n.otherAxis.dim),s)});i.dispatchAction({type:"changeAxisOrder",componentType:a.dim+"Axis",isInitSort:!0,axisId:a.index,sortInfo:o})},t.prototype.remove=function(r,n){this._clear(this._model),this._removeOnRenderedListener(n)},t.prototype.dispose=function(r,n){this._removeOnRenderedListener(n)},t.prototype._removeOnRenderedListener=function(r){this._onRendered&&(r.getZr().off("rendered",this._onRendered),this._onRendered=null)},t.prototype._clear=function(r){var n=this.group,i=this._data;r&&r.isAnimationEnabled()&&i&&!this._isLargeDraw?(this._removeBackground(),this._backgroundEls=[],i.eachItemGraphicEl(function(a){Gd(a,r,oe(a).dataIndex)})):n.removeAll(),this._data=null,this._isFirstFrame=!0},t.prototype._removeBackground=function(){this.group.remove(this._backgroundGroup),this._backgroundGroup=null},t.type="bar",t}(De),GC={cartesian2d:function(e,t){var r=t.width<0?-1:1,n=t.height<0?-1:1;r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height);var i=e.x+e.width,a=e.y+e.height,o=zy(t.x,e.x),s=ky(t.x+t.width,i),l=zy(t.y,e.y),u=ky(t.y+t.height,a),h=s<o,f=u<l;return t.x=h&&o>i?s:o,t.y=f&&l>a?u:l,t.width=h?0:s-o,t.height=f?0:u-l,r<0&&(t.x+=t.width,t.width=-t.width),n<0&&(t.y+=t.height,t.height=-t.height),h||f},polar:function(e,t){var r=t.r0<=t.r?1:-1;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}var i=ky(t.r,e.r),a=zy(t.r0,e.r0);t.r=i,t.r0=a;var o=i-a<0;if(r<0){var n=t.r;t.r=t.r0,t.r0=n}return o}},VC={cartesian2d:function(e,t,r,n,i,a,o,s,l){var u=new Ae({shape:rt({},n),z2:1});if(u.__dataIndex=r,u.name="item",a){var h=u.shape,f=i?"height":"width";h[f]=0}return u},polar:function(e,t,r,n,i,a,o,s,l){var u=!i&&l?km:Xn,h=new u({shape:n,z2:1});h.name="item";var f=tU(i);if(h.calculateTextPosition=V7(f,{isRoundCap:u===km}),a){var c=h.shape,d=i?"r":"endAngle",v={};c[d]=i?n.r0:n.startAngle,v[d]=n[d],(s?ke:vr)(h,{shape:v},a)}return h}};function Y7(e,t){var r=e.get("realtimeSort",!0),n=t.getBaseAxis();if(r&&n.type==="category"&&t.type==="cartesian2d")return{baseAxis:n,otherAxis:t.getOtherAxis(n)}}function HC(e,t,r,n,i,a,o,s){var l,u;a?(u={x:n.x,width:n.width},l={y:n.y,height:n.height}):(u={y:n.y,height:n.height},l={x:n.x,width:n.width}),s||(o?ke:vr)(r,{shape:l},t,i,null);var h=t?e.baseAxis.model:null;(o?ke:vr)(r,{shape:u},h,i)}function WC(e,t){for(var r=0;r<t.length;r++)if(!isFinite(e[t[r]]))return!0;return!1}var Z7=["x","y","width","height"],q7=["cx","cy","r","startAngle","endAngle"],XC={cartesian2d:function(e){return!WC(e,Z7)},polar:function(e){return!WC(e,q7)}},Pp={cartesian2d:function(e,t,r){var n=e.getItemLayout(t),i=r?K7(r,n):0,a=n.width>0?1:-1,o=n.height>0?1:-1;return{x:n.x+a*i/2,y:n.y+o*i/2,width:n.width-a*i,height:n.height-o*i}},polar:function(e,t,r){var n=e.getItemLayout(t);return{cx:n.cx,cy:n.cy,r0:n.r0,r:n.r,startAngle:n.startAngle,endAngle:n.endAngle,clockwise:n.clockwise}}};function $7(e){return e.startAngle!=null&&e.endAngle!=null&&e.startAngle===e.endAngle}function tU(e){return function(t){var r=t?"Arc":"Angle";return function(n){switch(n){case"start":case"insideStart":case"end":case"insideEnd":return n+r;default:return n}}}(e)}function YC(e,t,r,n,i,a,o,s){var l=t.getItemVisual(r,"style");if(s){if(!a.get("roundCap")){var h=e.shape,f=ru(n.getModel("itemStyle"),h,!0);rt(h,f),e.setShape(h)}}else{var u=n.get(["itemStyle","borderRadius"])||0;e.setShape("r",u)}e.useStyle(l);var c=n.getShallow("cursor");c&&e.attr("cursor",c);var d=s?o?i.r>=i.r0?"endArc":"startArc":i.endAngle>=i.startAngle?"endAngle":"startAngle":o?i.height>=0?"bottom":"top":i.width>=0?"right":"left",v=an(n);Sn(e,v,{labelFetcher:a,labelDataIndex:r,defaultText:vf(a.getData(),r),inheritColor:l.fill,defaultOpacity:l.opacity,defaultOutsidePosition:d});var p=e.getTextContent();if(s&&p){var g=n.get(["label","position"]);e.textConfig.inside=g==="middle"?!0:null,H7(e,g==="outside"?d:g,tU(o),n.get(["label","rotate"]))}p3(p,v,a.getRawValue(r),function(_){return XB(t,_)});var m=n.getModel(["emphasis"]);Sr(e,m.get("focus"),m.get("blurScope"),m.get("disabled")),xn(e,n),$7(i)&&(e.style.fill="none",e.style.stroke="none",R(e.states,function(_){_.style&&(_.style.fill=_.style.stroke="none")}))}function K7(e,t){var r=e.get(["itemStyle","borderColor"]);if(!r||r==="none")return 0;var n=e.get(["itemStyle","borderWidth"])||0,i=isNaN(t.width)?Number.MAX_VALUE:Math.abs(t.width),a=isNaN(t.height)?Number.MAX_VALUE:Math.abs(t.height);return Math.min(n,i,a)}var j7=function(){function e(){}return e}(),ZC=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="largeBar",n}return t.prototype.getDefaultShape=function(){return new j7},t.prototype.buildPath=function(r,n){for(var i=n.points,a=this.baseDimIdx,o=1-this.baseDimIdx,s=[],l=[],u=this.barWidth,h=0;h<i.length;h+=3)l[a]=u,l[o]=i[h+2],s[a]=i[h+a],s[o]=i[h+o],r.rect(s[0],s[1],l[0],l[1])},t}(_e);function qC(e,t,r,n){var i=e.getData(),a=i.getLayout("valueAxisHorizontal")?1:0,o=i.getLayout("largeDataIndices"),s=i.getLayout("size"),l=e.getModel("backgroundStyle"),u=i.getLayout("largeBackgroundPoints");if(u){var h=new ZC({shape:{points:u},incremental:!!n,silent:!0,z2:0});h.baseDimIdx=a,h.largeDataIndices=o,h.barWidth=s,h.useStyle(l.getItemStyle()),t.add(h),r&&r.push(h)}var f=new ZC({shape:{points:i.getLayout("largePoints")},incremental:!!n,ignoreCoarsePointer:!0,z2:1});f.baseDimIdx=a,f.largeDataIndices=o,f.barWidth=s,t.add(f),f.useStyle(i.getVisual("style")),f.style.stroke=null,oe(f).seriesIndex=e.seriesIndex,e.get("silent")||(f.on("mousedown",$C),f.on("mousemove",$C)),r&&r.push(f)}var $C=Lw(function(e){var t=this,r=J7(t,e.offsetX,e.offsetY);oe(t).dataIndex=r>=0?r:null},30,!1);function J7(e,t,r){for(var n=e.baseDimIdx,i=1-n,a=e.shape.points,o=e.largeDataIndices,s=[],l=[],u=e.barWidth,h=0,f=a.length/3;h<f;h++){var c=h*3;if(l[n]=u,l[i]=a[c+2],s[n]=a[c+n],s[i]=a[c+i],l[i]<0&&(s[i]+=l[i],l[i]=-l[i]),t>=s[0]&&t<=s[0]+l[0]&&r>=s[1]&&r<=s[1]+l[1])return o[h]}return-1}function eU(e,t,r){if(Vu(r,"cartesian2d")){var n=t,i=r.getArea();return{x:e?n.x:i.x,y:e?i.y:n.y,width:e?n.width:i.width,height:e?i.height:n.height}}else{var i=r.getArea(),a=t;return{cx:i.cx,cy:i.cy,r0:e?i.r0:a.r0,r:e?i.r:a.r,startAngle:e?a.startAngle:0,endAngle:e?a.endAngle:Math.PI*2}}}function Q7(e,t,r){var n=e.type==="polar"?Xn:Ae;return new n({shape:eU(t,r,e),silent:!0,z2:0})}function tY(e){e.registerChartView(X7),e.registerSeriesModel(k7),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,ue(nB,"bar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,iB("bar")),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,QB("bar")),e.registerAction({type:"changeAxisOrder",event:"changeAxisOrder",update:"update"},function(t,r){var n=t.componentType||"series";r.eachComponent({mainType:n,query:t},function(i){t.sortInfo&&i.axis.setCategorySortInfo(t.sortInfo)})})}var KC=Math.PI*2,Ip=Math.PI/180;function rU(e,t){return Mr(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function nU(e,t){var r=rU(e,t),n=e.get("center"),i=e.get("radius");at(i)||(i=[0,i]);var a=Tt(r.width,t.getWidth()),o=Tt(r.height,t.getHeight()),s=Math.min(a,o),l=Tt(i[0],s/2),u=Tt(i[1],s/2),h,f,c=e.coordinateSystem;if(c){var d=c.dataToPoint(n);h=d[0]||0,f=d[1]||0}else at(n)||(n=[n,n]),h=Tt(n[0],a)+r.x,f=Tt(n[1],o)+r.y;return{cx:h,cy:f,r0:l,r:u}}function eY(e,t,r){t.eachSeriesByType(e,function(n){var i=n.getData(),a=i.mapDimension("value"),o=rU(n,r),s=nU(n,r),l=s.cx,u=s.cy,h=s.r,f=s.r0,c=-n.get("startAngle")*Ip,d=n.get("endAngle"),v=n.get("padAngle")*Ip;d=d==="auto"?c-KC:-d*Ip;var p=n.get("minAngle")*Ip,g=p+v,m=0;i.each(a,function(O){!isNaN(O)&&m++});var _=i.getSum(a),y=Math.PI/(_||m)*2,x=n.get("clockwise"),T=n.get("roseType"),S=n.get("stillShowZeroSum"),M=i.getDataExtent(a);M[0]=0;var w=x?1:-1,b=[c,d],A=w*v/2;iw(b,!x),c=b[0],d=b[1];var E=iU(n);E.startAngle=c,E.endAngle=d,E.clockwise=x;var C=Math.abs(d-c),D=C,L=0,P=c;if(i.setLayout({viewRect:o,r:h}),i.each(a,function(O,I){var k;if(isNaN(O)){i.setItemLayout(I,{angle:NaN,startAngle:NaN,endAngle:NaN,clockwise:x,cx:l,cy:u,r0:f,r:T?NaN:h});return}T!=="area"?k=_===0&&S?y:O*y:k=C/m,k<g?(k=g,D-=g):L+=O;var z=P+w*k,X=0,Y=0;v>k?(X=P+w*k/2,Y=X):(X=P+A,Y=z-A),i.setItemLayout(I,{angle:k,startAngle:X,endAngle:Y,clockwise:x,cx:l,cy:u,r0:f,r:T?He(O,M,[f,h]):h}),P=z}),D<KC&&m)if(D<=.001){var N=C/m;i.each(a,function(O,I){if(!isNaN(O)){var k=i.getItemLayout(I);k.angle=N;var z=0,X=0;N<v?(z=c+w*(I+1/2)*N,X=z):(z=c+w*I*N+A,X=c+w*(I+1)*N-A),k.startAngle=z,k.endAngle=X}})}else y=D/L,P=c,i.each(a,function(O,I){if(!isNaN(O)){var k=i.getItemLayout(I),z=k.angle===g?g:O*y,X=0,Y=0;z<v?(X=P+w*z/2,Y=X):(X=P+A,Y=P+w*z-A),k.startAngle=X,k.endAngle=Y,P+=w*z}})})}var iU=Le();function Iv(e){return{seriesType:e,reset:function(t,r){var n=r.findComponents({mainType:"legend"});if(!(!n||!n.length)){var i=t.getData();i.filterSelf(function(a){for(var o=i.getName(a),s=0;s<n.length;s++)if(!n[s].isSelected(o))return!1;return!0})}}}}var rY=Math.PI/180;function jC(e,t,r,n,i,a,o,s,l,u){if(e.length<2)return;function h(p){for(var g=p.rB,m=g*g,_=0;_<p.list.length;_++){var y=p.list[_],x=Math.abs(y.label.y-r),T=n+y.len,S=T*T,M=Math.sqrt(Math.abs((1-x*x/m)*S)),w=t+(M+y.len2)*i,b=w-y.label.x,A=y.targetTextWidth-b*i;aU(y,A,!0),y.label.x=w}}function f(p){for(var g={list:[],maxY:0},m={list:[],maxY:0},_=0;_<p.length;_++)if(p[_].labelAlignTo==="none"){var y=p[_],x=y.label.y>r?m:g,T=Math.abs(y.label.y-r);if(T>=x.maxY){var S=y.label.x-t-y.len2*i,M=n+y.len,w=Math.abs(S)<M?Math.sqrt(T*T/(1-S*S/M/M)):M;x.rB=w,x.maxY=T}x.list.push(y)}h(g),h(m)}for(var c=e.length,d=0;d<c;d++)if(e[d].position==="outer"&&e[d].labelAlignTo==="labelLine"){var v=e[d].label.x-u;e[d].linePoints[1][0]+=v,e[d].label.x=u}AB(e,l,l+o)&&f(e)}function nY(e,t,r,n,i,a,o,s){for(var l=[],u=[],h=Number.MAX_VALUE,f=-Number.MAX_VALUE,c=0;c<e.length;c++){var d=e[c].label;Gy(e[c])||(d.x<t?(h=Math.min(h,d.x),l.push(e[c])):(f=Math.max(f,d.x),u.push(e[c])))}for(var c=0;c<e.length;c++){var v=e[c];if(!Gy(v)&&v.linePoints){if(v.labelStyleWidth!=null)continue;var d=v.label,p=v.linePoints,g=void 0;v.labelAlignTo==="edge"?d.x<t?g=p[2][0]-v.labelDistance-o-v.edgeDistance:g=o+i-v.edgeDistance-p[2][0]-v.labelDistance:v.labelAlignTo==="labelLine"?d.x<t?g=h-o-v.bleedMargin:g=o+i-f-v.bleedMargin:d.x<t?g=d.x-o-v.bleedMargin:g=o+i-d.x-v.bleedMargin,v.targetTextWidth=g,aU(v,g)}}jC(u,t,r,n,1,i,a,o,s,f),jC(l,t,r,n,-1,i,a,o,s,h);for(var c=0;c<e.length;c++){var v=e[c];if(!Gy(v)&&v.linePoints){var d=v.label,p=v.linePoints,m=v.labelAlignTo==="edge",_=d.style.padding,y=_?_[1]+_[3]:0,x=d.style.backgroundColor?0:y,T=v.rect.width+x,S=p[1][0]-p[2][0];m?d.x<t?p[2][0]=o+v.edgeDistance+T+v.labelDistance:p[2][0]=o+i-v.edgeDistance-T-v.labelDistance:(d.x<t?p[2][0]=d.x+v.labelDistance:p[2][0]=d.x-v.labelDistance,p[1][0]=p[2][0]+S),p[1][1]=p[2][1]=d.y}}}function aU(e,t,r){if(r===void 0&&(r=!1),e.labelStyleWidth==null){var n=e.label,i=n.style,a=e.rect,o=i.backgroundColor,s=i.padding,l=s?s[1]+s[3]:0,u=i.overflow,h=a.width+(o?0:l);if(t<h||r){var f=a.height;if(u&&u.match("break")){n.setStyle("backgroundColor",null),n.setStyle("width",t-l);var c=n.getBoundingRect();n.setStyle("width",Math.ceil(c.width)),n.setStyle("backgroundColor",o)}else{var d=t-l,v=t<h?d:r?d>e.unconstrainedWidth?null:d:null;n.setStyle("width",v)}var p=n.getBoundingRect();a.width=p.width;var g=(n.style.margin||0)+2.1;a.height=p.height+g,a.y-=(a.height-f)/2}}}function Gy(e){return e.position==="center"}function iY(e){var t=e.getData(),r=[],n,i,a=!1,o=(e.get("minShowLabelAngle")||0)*rY,s=t.getLayout("viewRect"),l=t.getLayout("r"),u=s.width,h=s.x,f=s.y,c=s.height;function d(S){S.ignore=!0}function v(S){if(!S.ignore)return!0;for(var M in S.states)if(S.states[M].ignore===!1)return!0;return!1}t.each(function(S){var M=t.getItemGraphicEl(S),w=M.shape,b=M.getTextContent(),A=M.getTextGuideLine(),E=t.getItemModel(S),C=E.getModel("label"),D=C.get("position")||E.get(["emphasis","label","position"]),L=C.get("distanceToLabelLine"),P=C.get("alignTo"),N=Tt(C.get("edgeDistance"),u),O=C.get("bleedMargin"),I=E.getModel("labelLine"),k=I.get("length");k=Tt(k,u);var z=I.get("length2");if(z=Tt(z,u),Math.abs(w.endAngle-w.startAngle)<o){R(b.states,d),b.ignore=!0,A&&(R(A.states,d),A.ignore=!0);return}if(v(b)){var X=(w.startAngle+w.endAngle)/2,Y=Math.cos(X),$=Math.sin(X),H,Z,ct,ut;n=w.cx,i=w.cy;var tt=D==="inside"||D==="inner";if(D==="center")H=w.cx,Z=w.cy,ut="center";else{var et=(tt?(w.r+w.r0)/2*Y:w.r*Y)+n,st=(tt?(w.r+w.r0)/2*$:w.r*$)+i;if(H=et+Y*3,Z=st+$*3,!tt){var nt=et+Y*(k+l-w.r),dt=st+$*(k+l-w.r),At=nt+(Y<0?-1:1)*z,G=dt;P==="edge"?H=Y<0?h+N:h+u-N:H=At+(Y<0?-L:L),Z=G,ct=[[et,st],[nt,dt],[At,G]]}ut=tt?"center":P==="edge"?Y>0?"right":"left":Y>0?"left":"right"}var Dt=Math.PI,Pt=0,Lt=C.get("rotate");if(Be(Lt))Pt=Lt*(Dt/180);else if(D==="center")Pt=0;else if(Lt==="radial"||Lt===!0){var zt=Y<0?-X+Dt:-X;Pt=zt}else if(Lt==="tangential"&&D!=="outside"&&D!=="outer"){var ne=Math.atan2(Y,$);ne<0&&(ne=Dt*2+ne);var kt=$>0;kt&&(ne=Dt+ne),Pt=ne-Dt}if(a=!!Pt,b.x=H,b.y=Z,b.rotation=Pt,b.setStyle({verticalAlign:"middle"}),tt){b.setStyle({align:ut});var Q=b.states.select;Q&&(Q.x+=b.x,Q.y+=b.y)}else{var V=b.getBoundingRect().clone();V.applyTransform(b.getComputedTransform());var F=(b.style.margin||0)+2.1;V.y-=F/2,V.height+=F,r.push({label:b,labelLine:A,position:D,len:k,len2:z,minTurnAngle:I.get("minTurnAngle"),maxSurfaceAngle:I.get("maxSurfaceAngle"),surfaceNormal:new he(Y,$),linePoints:ct,textAlign:ut,labelDistance:L,labelAlignTo:P,edgeDistance:N,bleedMargin:O,rect:V,unconstrainedWidth:V.width,labelStyleWidth:b.style.width})}M.setTextConfig({inside:tt})}}),!a&&e.get("avoidLabelOverlap")&&nY(r,n,i,l,u,c,h,f);for(var p=0;p<r.length;p++){var g=r[p],m=g.label,_=g.labelLine,y=isNaN(m.x)||isNaN(m.y);if(m){m.setStyle({align:g.textAlign}),y&&(R(m.states,d),m.ignore=!0);var x=m.states.select;x&&(x.x+=m.x,x.y+=m.y)}if(_){var T=g.linePoints;y||!T?(R(_.states,d),_.ignore=!0):(bB(T,g.minTurnAngle),D9(T,g.surfaceNormal,g.maxSurfaceAngle),_.setShape({points:T}),m.__hostTarget.textGuideLineConfig={anchor:new he(T[0][0],T[0][1])})}}}var aY=function(e){q(t,e);function t(r,n,i){var a=e.call(this)||this;a.z2=2;var o=new we;return a.setTextContent(o),a.updateData(r,n,i,!0),a}return t.prototype.updateData=function(r,n,i,a){var o=this,s=r.hostModel,l=r.getItemModel(n),u=l.getModel("emphasis"),h=r.getItemLayout(n),f=rt(ru(l.getModel("itemStyle"),h,!0),h);if(isNaN(f.startAngle)){o.setShape(f);return}if(a){o.setShape(f);var c=s.getShallow("animationType");s.ecModel.ssr?(vr(o,{scaleX:0,scaleY:0},s,{dataIndex:n,isFrom:!0}),o.originX=f.cx,o.originY=f.cy):c==="scale"?(o.shape.r=h.r0,vr(o,{shape:{r:h.r}},s,n)):i!=null?(o.setShape({startAngle:i,endAngle:i}),vr(o,{shape:{startAngle:h.startAngle,endAngle:h.endAngle}},s,n)):(o.shape.endAngle=h.startAngle,ke(o,{shape:{endAngle:h.endAngle}},s,n))}else ya(o),ke(o,{shape:f},s,n);o.useStyle(r.getItemVisual(n,"style")),xn(o,l);var d=(h.startAngle+h.endAngle)/2,v=s.get("selectedOffset"),p=Math.cos(d)*v,g=Math.sin(d)*v,m=l.getShallow("cursor");m&&o.attr("cursor",m),this._updateLabel(s,r,n),o.ensureState("emphasis").shape=rt({r:h.r+(u.get("scale")&&u.get("scaleSize")||0)},ru(u.getModel("itemStyle"),h)),rt(o.ensureState("select"),{x:p,y:g,shape:ru(l.getModel(["select","itemStyle"]),h)}),rt(o.ensureState("blur"),{shape:ru(l.getModel(["blur","itemStyle"]),h)});var _=o.getTextGuideLine(),y=o.getTextContent();_&&rt(_.ensureState("select"),{x:p,y:g}),rt(y.ensureState("select"),{x:p,y:g}),Sr(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(r,n,i){var a=this,o=n.getItemModel(i),s=o.getModel("labelLine"),l=n.getItemVisual(i,"style"),u=l&&l.fill,h=l&&l.opacity;Sn(a,an(o),{labelFetcher:n.hostModel,labelDataIndex:i,inheritColor:u,defaultOpacity:h,defaultText:r.getFormattedLabel(i,"normal")||n.getName(i)});var f=a.getTextContent();a.setTextConfig({position:null,rotation:null}),f.attr({z2:10});var c=r.get(["label","position"]);if(c!=="outside"&&c!=="outer")a.removeTextGuideLine();else{var d=this.getTextGuideLine();d||(d=new $n,this.setTextGuideLine(d)),Zw(this,qw(o),{stroke:u,opacity:Ga(s.get(["lineStyle","opacity"]),h,1)})}},t}(Xn),oY=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,n,i,a){var o=r.getData(),s=this._data,l=this.group,u;if(!s&&o.count()>0){for(var h=o.getItemLayout(0),f=1;isNaN(h&&h.startAngle)&&f<o.count();++f)h=o.getItemLayout(f);h&&(u=h.startAngle)}if(this._emptyCircleSector&&l.remove(this._emptyCircleSector),o.count()===0&&r.get("showEmptyCircle")){var c=iU(r),d=new Xn({shape:rt(nU(r,i),c)});d.useStyle(r.getModel("emptyCircleStyle").getItemStyle()),this._emptyCircleSector=d,l.add(d)}o.diff(s).add(function(v){var p=new aY(o,v,u);o.setItemGraphicEl(v,p),l.add(p)}).update(function(v,p){var g=s.getItemGraphicEl(p);g.updateData(o,v,u),g.off("click"),l.add(g),o.setItemGraphicEl(v,g)}).remove(function(v){var p=s.getItemGraphicEl(v);Gd(p,r,v)}).execute(),iY(r),r.get("animationTypeUpdate")!=="expansion"&&(this._data=o)},t.prototype.dispose=function(){},t.prototype.containPoint=function(r,n){var i=n.getData(),a=i.getItemLayout(0);if(a){var o=r[0]-a.cx,s=r[1]-a.cy,l=Math.sqrt(o*o+s*s);return l<=a.r&&l>=a.r0}},t.type="pie",t}(De);function Qf(e,t,r){t=at(t)&&{coordDimensions:t}||rt({encodeDefine:e.getEncode()},t);var n=e.getSource(),i=Kf(n,t).dimensions,a=new xr(i,e);return a.initData(n,r),a}var Nv=function(){function e(t,r){this._getDataWithEncodedVisual=t,this._getRawData=r}return e.prototype.getAllNames=function(){var t=this._getRawData();return t.mapArray(t.getName)},e.prototype.containName=function(t){var r=this._getRawData();return r.indexOfName(t)>=0},e.prototype.indexOfName=function(t){var r=this._getDataWithEncodedVisual();return r.indexOfName(t)},e.prototype.getItemVisual=function(t,r){var n=this._getDataWithEncodedVisual();return n.getItemVisual(t,r)},e}(),sY=Le(),lY=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new Nv(It(this.getData,this),It(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.mergeOption=function(){e.prototype.mergeOption.apply(this,arguments)},t.prototype.getInitialData=function(){return Qf(this,{coordDimensions:["value"],encodeDefaulter:ue(Tw,this)})},t.prototype.getDataParams=function(r){var n=this.getData(),i=sY(n),a=i.seats;if(!a){var o=[];n.each(n.mapDimension("value"),function(l){o.push(l)}),a=i.seats=n5(o,n.hostModel.get("percentPrecision"))}var s=e.prototype.getDataParams.call(this,r);return s.percent=a[r]||0,s.$vars.push("percent"),s},t.prototype._defaultLabelLine=function(r){Su(r,"labelLine",["show"]);var n=r.labelLine,i=r.emphasis.labelLine;n.show=n.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},t.type="series.pie",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,endAngle:"auto",padAngle:0,minAngle:0,minShowLabelAngle:0,selectedOffset:10,percentPrecision:2,stillShowZeroSum:!0,left:0,top:0,right:0,bottom:0,width:null,height:null,label:{rotate:0,show:!0,overflow:"truncate",position:"outer",alignTo:"none",edgeDistance:"25%",bleedMargin:10,distanceToLabelLine:5},labelLine:{show:!0,length:15,length2:15,smooth:!1,minTurnAngle:90,maxSurfaceAngle:90,lineStyle:{width:1,type:"solid"}},itemStyle:{borderWidth:1,borderJoin:"round"},showEmptyCircle:!0,emptyCircleStyle:{color:"lightgray",opacity:1},labelLayout:{hideOverlap:!0},emphasis:{scale:!0,scaleSize:5},avoidLabelOverlap:!0,animationType:"expansion",animationDuration:1e3,animationTypeUpdate:"transition",animationEasingUpdate:"cubicInOut",animationDurationUpdate:500,animationEasing:"cubicInOut"},t}(Ue);function uY(e){return{seriesType:e,reset:function(t,r){var n=t.getData();n.filterSelf(function(i){var a=n.mapDimension("value"),o=n.get(a,i);return!(Be(o)&&!isNaN(o)&&o<0)})}}}function hY(e){e.registerChartView(oY),e.registerSeriesModel(lY),xF("pie",e.registerAction),e.registerLayout(ue(eY,"pie")),e.registerProcessor(Iv("pie")),e.registerProcessor(uY("pie"))}var fY=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r,n){return Qa(null,this,{useEncodeDefaulter:!0})},t.prototype.getProgressive=function(){var r=this.option.progressive;return r??(this.option.large?5e3:this.get("progressive"))},t.prototype.getProgressiveThreshold=function(){var r=this.option.progressiveThreshold;return r??(this.option.large?1e4:this.get("progressiveThreshold"))},t.prototype.brushSelector=function(r,n,i){return i.point(n.getItemLayout(r))},t.prototype.getZLevelKey=function(){return this.getData().count()>this.getProgressiveThreshold()?this.id:""},t.type="series.scatter",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,symbolSize:10,large:!1,largeThreshold:2e3,itemStyle:{opacity:.8},emphasis:{scale:!0},clip:!0,select:{itemStyle:{borderColor:"#212121"}},universalTransition:{divideShape:"clone"}},t}(Ue),oU=4,cY=function(){function e(){}return e}(),dY=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n._off=0,n.hoverDataIdx=-1,n}return t.prototype.getDefaultShape=function(){return new cY},t.prototype.reset=function(){this.notClear=!1,this._off=0},t.prototype.buildPath=function(r,n){var i=n.points,a=n.size,o=this.symbolProxy,s=o.shape,l=r.getContext?r.getContext():r,u=l&&a[0]<oU,h=this.softClipShape,f;if(u){this._ctx=l;return}for(this._ctx=null,f=this._off;f<i.length;){var c=i[f++],d=i[f++];isNaN(c)||isNaN(d)||h&&!h.contain(c,d)||(s.x=c-a[0]/2,s.y=d-a[1]/2,s.width=a[0],s.height=a[1],o.buildPath(r,s,!0))}this.incremental&&(this._off=f,this.notClear=!0)},t.prototype.afterBrush=function(){var r=this.shape,n=r.points,i=r.size,a=this._ctx,o=this.softClipShape,s;if(a){for(s=this._off;s<n.length;){var l=n[s++],u=n[s++];isNaN(l)||isNaN(u)||o&&!o.contain(l,u)||a.fillRect(l-i[0]/2,u-i[1]/2,i[0],i[1])}this.incremental&&(this._off=s,this.notClear=!0)}},t.prototype.findDataIndex=function(r,n){for(var i=this.shape,a=i.points,o=i.size,s=Math.max(o[0],4),l=Math.max(o[1],4),u=a.length/2-1;u>=0;u--){var h=u*2,f=a[h]-s/2,c=a[h+1]-l/2;if(r>=f&&n>=c&&r<=f+s&&n<=c+l)return u}return-1},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(r=i[0],n=i[1],a.contain(r,n)){var o=this.hoverDataIdx=this.findDataIndex(r,n);return o>=0}return this.hoverDataIdx=-1,!1},t.prototype.getBoundingRect=function(){var r=this._rect;if(!r){for(var n=this.shape,i=n.points,a=n.size,o=a[0],s=a[1],l=1/0,u=1/0,h=-1/0,f=-1/0,c=0;c<i.length;){var d=i[c++],v=i[c++];l=Math.min(d,l),h=Math.max(d,h),u=Math.min(v,u),f=Math.max(v,f)}r=this._rect=new fe(l-o/2,u-s/2,h-l+o,f-u+s)}return r},t}(_e),vY=function(){function e(){this.group=new re}return e.prototype.updateData=function(t,r){this._clear();var n=this._create();n.setShape({points:t.getLayout("points")}),this._setCommon(n,t,r)},e.prototype.updateLayout=function(t){var r=t.getLayout("points");this.group.eachChild(function(n){if(n.startIndex!=null){var i=(n.endIndex-n.startIndex)*2,a=n.startIndex*4*2;r=new Float32Array(r.buffer,a,i)}n.setShape("points",r),n.reset()})},e.prototype.incrementalPrepareUpdate=function(t){this._clear()},e.prototype.incrementalUpdate=function(t,r,n){var i=this._newAdded[0],a=r.getLayout("points"),o=i&&i.shape.points;if(o&&o.length<2e4){var s=o.length,l=new Float32Array(s+a.length);l.set(o),l.set(a,s),i.endIndex=t.end,i.setShape({points:l})}else{this._newAdded=[];var u=this._create();u.startIndex=t.start,u.endIndex=t.end,u.incremental=!0,u.setShape({points:a}),this._setCommon(u,r,n)}},e.prototype.eachRendered=function(t){this._newAdded[0]&&t(this._newAdded[0])},e.prototype._create=function(){var t=new dY({cursor:"default"});return t.ignoreCoarsePointer=!0,this.group.add(t),this._newAdded.push(t),t},e.prototype._setCommon=function(t,r,n){var i=r.hostModel;n=n||{};var a=r.getVisual("symbolSize");t.setShape("size",a instanceof Array?a:[a,a]),t.softClipShape=n.clipShape||null,t.symbolProxy=Pr(r.getVisual("symbol"),0,0,0,0),t.setColor=t.symbolProxy.setColor;var o=t.shape.size[0]<oU;t.useStyle(i.getModel("itemStyle").getItemStyle(o?["color","shadowBlur","shadowColor"]:["color"]));var s=r.getVisual("style"),l=s&&s.fill;l&&t.setColor(l);var u=oe(t);u.seriesIndex=i.seriesIndex,t.on("mousemove",function(h){u.dataIndex=null;var f=t.hoverDataIdx;f>=0&&(u.dataIndex=f+(t.startIndex||0))})},e.prototype.remove=function(){this._clear()},e.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},e}(),pY=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=r.getData(),o=this._updateSymbolDraw(a,r);o.updateData(a,{clipShape:this._getClipShape(r)}),this._finished=!0},t.prototype.incrementalPrepareRender=function(r,n,i){var a=r.getData(),o=this._updateSymbolDraw(a,r);o.incrementalPrepareUpdate(a),this._finished=!1},t.prototype.incrementalRender=function(r,n,i){this._symbolDraw.incrementalUpdate(r,n.getData(),{clipShape:this._getClipShape(n)}),this._finished=r.end===n.getData().count()},t.prototype.updateTransform=function(r,n,i){var a=r.getData();if(this.group.dirty(),!this._finished||a.count()>1e4)return{update:!0};var o=Pv("").reset(r,n,i);o.progress&&o.progress({start:0,end:a.count(),count:a.count()},a),this._symbolDraw.updateLayout(a)},t.prototype.eachRendered=function(r){this._symbolDraw&&this._symbolDraw.eachRendered(r)},t.prototype._getClipShape=function(r){if(r.get("clip",!0)){var n=r.coordinateSystem;return n&&n.getArea&&n.getArea(.1)}},t.prototype._updateSymbolDraw=function(r,n){var i=this._symbolDraw,a=n.pipelineContext,o=a.large;return(!i||o!==this._isLargeDraw)&&(i&&i.remove(),i=this._symbolDraw=o?new vY:new Lv,this._isLargeDraw=o,this.group.removeAll()),this.group.add(i.group),i},t.prototype.remove=function(r,n){this._symbolDraw&&this._symbolDraw.remove(!0),this._symbolDraw=null},t.prototype.dispose=function(){},t.type="scatter",t}(De),gY=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.type="grid",t.dependencies=["xAxis","yAxis"],t.layoutMode="box",t.defaultOption={show:!1,z:0,left:"10%",top:60,right:"10%",bottom:70,containLabel:!1,backgroundColor:"rgba(0,0,0,0)",borderWidth:1,borderColor:"#ccc"},t}(me),tT=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("grid",zr).models[0]},t.type="cartesian2dAxis",t}(me);Nr(tT,Jf);var sU={show:!0,z:0,inverse:!1,name:"",nameLocation:"end",nameRotate:null,nameTruncate:{maxWidth:null,ellipsis:"...",placeholder:"."},nameTextStyle:{},nameGap:15,silent:!1,triggerEvent:!1,tooltip:{show:!1},axisPointer:{},axisLine:{show:!0,onZero:!0,onZeroAxisIndex:null,lineStyle:{color:"#6E7079",width:1,type:"solid"},symbol:["none","none"],symbolSize:[10,15]},axisTick:{show:!0,inside:!1,length:5,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,showMinLabel:null,showMaxLabel:null,margin:8,fontSize:12},splitLine:{show:!0,showMinLine:!0,showMaxLine:!0,lineStyle:{color:["#E0E6F1"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.2)","rgba(210,219,238,0.2)"]}}},mY=Ot({boundaryGap:!0,deduplication:null,splitLine:{show:!1},axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"}},sU),eM=Ot({boundaryGap:[0,0],axisLine:{show:"auto"},axisTick:{show:"auto"},splitNumber:5,minorTick:{show:!1,splitNumber:5,length:3,lineStyle:{}},minorSplitLine:{show:!1,lineStyle:{color:"#F4F7FD",width:1}}},sU),_Y=Ot({splitNumber:6,axisLabel:{showMinLabel:!1,showMaxLabel:!1,rich:{primary:{fontWeight:"bold"}}},splitLine:{show:!1}},eM),yY=Vt({logBase:10},eM);const lU={category:mY,value:eM,time:_Y,log:yY};var xY={value:1,category:1,time:1,log:1};function pf(e,t,r,n){R(xY,function(i,a){var o=Ot(Ot({},lU[a],!0),n,!0),s=function(l){q(u,l);function u(){var h=l!==null&&l.apply(this,arguments)||this;return h.type=t+"Axis."+a,h}return u.prototype.mergeDefaultAndTheme=function(h,f){var c=Hd(this),d=c?Wf(h):{},v=f.getTheme();Ot(h,v.get(a+"Axis")),Ot(h,this.getDefaultOption()),h.type=JC(h),c&&Bs(h,d,c)},u.prototype.optionUpdated=function(){var h=this.option;h.type==="category"&&(this.__ordinalMeta=Om.createByAxisModel(this))},u.prototype.getCategories=function(h){var f=this.option;if(f.type==="category")return h?f.data:this.__ordinalMeta.categories},u.prototype.getOrdinalMeta=function(){return this.__ordinalMeta},u.type=t+"Axis."+a,u.defaultOption=o,u}(r);e.registerComponentModel(s)}),e.registerSubTypeDefaulter(t+"Axis",JC)}function JC(e){return e.type||(e.data?"category":"value")}var rM=function(){function e(t){this.type="cartesian",this._dimList=[],this._axes={},this.name=t||""}return e.prototype.getAxis=function(t){return this._axes[t]},e.prototype.getAxes=function(){return ft(this._dimList,function(t){return this._axes[t]},this)},e.prototype.getAxesByScale=function(t){return t=t.toLowerCase(),Xe(this.getAxes(),function(r){return r.scale.type===t})},e.prototype.addAxis=function(t){var r=t.dim;this._axes[r]=t,this._dimList.push(r)},e}(),eT=["x","y"];function QC(e){return e.type==="interval"||e.type==="time"}var SY=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="cartesian2d",r.dimensions=eT,r}return t.prototype.calcAffineTransform=function(){this._transform=this._invTransform=null;var r=this.getAxis("x").scale,n=this.getAxis("y").scale;if(!(!QC(r)||!QC(n))){var i=r.getExtent(),a=n.getExtent(),o=this.dataToPoint([i[0],a[0]]),s=this.dataToPoint([i[1],a[1]]),l=i[1]-i[0],u=a[1]-a[0];if(!(!l||!u)){var h=(s[0]-o[0])/l,f=(s[1]-o[1])/u,c=o[0]-i[0]*h,d=o[1]-a[0]*f,v=this._transform=[h,0,0,f,c,d];this._invTransform=Bu([],v)}}},t.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAxis("x")},t.prototype.containPoint=function(r){var n=this.getAxis("x"),i=this.getAxis("y");return n.contain(n.toLocalCoord(r[0]))&&i.contain(i.toLocalCoord(r[1]))},t.prototype.containData=function(r){return this.getAxis("x").containData(r[0])&&this.getAxis("y").containData(r[1])},t.prototype.containZone=function(r,n){var i=this.dataToPoint(r),a=this.dataToPoint(n),o=this.getArea(),s=new fe(i[0],i[1],a[0]-i[0],a[1]-i[1]);return o.intersect(s)},t.prototype.dataToPoint=function(r,n,i){i=i||[];var a=r[0],o=r[1];if(this._transform&&a!=null&&isFinite(a)&&o!=null&&isFinite(o))return en(i,r,this._transform);var s=this.getAxis("x"),l=this.getAxis("y");return i[0]=s.toGlobalCoord(s.dataToCoord(a,n)),i[1]=l.toGlobalCoord(l.dataToCoord(o,n)),i},t.prototype.clampData=function(r,n){var i=this.getAxis("x").scale,a=this.getAxis("y").scale,o=i.getExtent(),s=a.getExtent(),l=i.parse(r[0]),u=a.parse(r[1]);return n=n||[],n[0]=Math.min(Math.max(Math.min(o[0],o[1]),l),Math.max(o[0],o[1])),n[1]=Math.min(Math.max(Math.min(s[0],s[1]),u),Math.max(s[0],s[1])),n},t.prototype.pointToData=function(r,n){var i=[];if(this._invTransform)return en(i,r,this._invTransform);var a=this.getAxis("x"),o=this.getAxis("y");return i[0]=a.coordToData(a.toLocalCoord(r[0]),n),i[1]=o.coordToData(o.toLocalCoord(r[1]),n),i},t.prototype.getOtherAxis=function(r){return this.getAxis(r.dim==="x"?"y":"x")},t.prototype.getArea=function(r){r=r||0;var n=this.getAxis("x").getGlobalExtent(),i=this.getAxis("y").getGlobalExtent(),a=Math.min(n[0],n[1])-r,o=Math.min(i[0],i[1])-r,s=Math.max(n[0],n[1])-a+r,l=Math.max(i[0],i[1])-o+r;return new fe(a,o,s,l)},t}(rM),TY=function(e){q(t,e);function t(r,n,i,a,o){var s=e.call(this,r,n,i)||this;return s.index=0,s.type=a||"value",s.position=o||"bottom",s}return t.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},t.prototype.getGlobalExtent=function(r){var n=this.getExtent();return n[0]=this.toGlobalCoord(n[0]),n[1]=this.toGlobalCoord(n[1]),r&&n[0]>n[1]&&n.reverse(),n},t.prototype.pointToData=function(r,n){return this.coordToData(this.toLocalCoord(r[this.dim==="x"?0:1]),n)},t.prototype.setCategorySortInfo=function(r){if(this.type!=="category")return!1;this.model.option.categorySortInfo=r,this.scale.setSortInfo(r)},t}(Kn);function rT(e,t,r){r=r||{};var n=e.coordinateSystem,i=t.axis,a={},o=i.getAxesOnZeroOf()[0],s=i.position,l=o?"onZero":s,u=i.dim,h=n.getRect(),f=[h.x,h.x+h.width,h.y,h.y+h.height],c={left:0,right:1,top:0,bottom:1,onZero:2},d=t.get("offset")||0,v=u==="x"?[f[2]-d,f[3]+d]:[f[0]-d,f[1]+d];if(o){var p=o.toGlobalCoord(o.dataToCoord(0));v[c.onZero]=Math.max(Math.min(p,v[1]),v[0])}a.position=[u==="y"?v[c[l]]:f[0],u==="x"?v[c[l]]:f[3]],a.rotation=Math.PI/2*(u==="x"?0:1);var g={top:-1,bottom:1,left:-1,right:1};a.labelDirection=a.tickDirection=a.nameDirection=g[s],a.labelOffset=o?v[c[s]]-v[c.onZero]:0,t.get(["axisTick","inside"])&&(a.tickDirection=-a.tickDirection),pn(r.labelInside,t.get(["axisLabel","inside"]))&&(a.labelDirection=-a.labelDirection);var m=t.get(["axisLabel","rotate"]);return a.labelRotate=l==="top"?-m:m,a.z2=1,a}function tD(e){return e.get("coordinateSystem")==="cartesian2d"}function eD(e){var t={xAxisModel:null,yAxisModel:null};return R(t,function(r,n){var i=n.replace(/Model$/,""),a=e.getReferringComponents(i,zr).models[0];t[n]=a}),t}var Vy=Math.log;function uU(e,t,r){var n=Fo.prototype,i=n.getTicks.call(r),a=n.getTicks.call(r,!0),o=i.length-1,s=n.getInterval.call(r),l=uB(e,t),u=l.extent,h=l.fixMin,f=l.fixMax;if(e.type==="log"){var c=Vy(e.base);u=[Vy(u[0])/c,Vy(u[1])/c]}e.setExtent(u[0],u[1]),e.calcNiceExtent({splitNumber:o,fixMin:h,fixMax:f});var d=n.getExtent.call(e);h&&(u[0]=d[0]),f&&(u[1]=d[1]);var v=n.getInterval.call(e),p=u[0],g=u[1];if(h&&f)v=(g-p)/o;else if(h)for(g=u[0]+v*o;g<u[1]&&isFinite(g)&&isFinite(u[1]);)v=Ey(v),g=u[0]+v*o;else if(f)for(p=u[1]-v*o;p>u[0]&&isFinite(p)&&isFinite(u[0]);)v=Ey(v),p=u[1]-v*o;else{var m=e.getTicks().length-1;m>o&&(v=Ey(v));var _=v*o;g=Math.ceil(u[1]/v)*v,p=dr(g-_),p<0&&u[0]>=0?(p=0,g=dr(_)):g>0&&u[1]<=0&&(g=0,p=-dr(_))}var y=(i[0].value-a[0].value)/s,x=(i[o].value-a[o].value)/s;n.setExtent.call(e,p+v*y,g+v*x),n.setInterval.call(e,v),(y||x)&&n.setNiceExtent.call(e,p+v,g-v)}var bY=function(){function e(t,r,n){this.type="grid",this._coordsMap={},this._coordsList=[],this._axesMap={},this._axesList=[],this.axisPointerEnabled=!0,this.dimensions=eT,this._initCartesian(t,r,n),this.model=t}return e.prototype.getRect=function(){return this._rect},e.prototype.update=function(t,r){var n=this._axesMap;this._updateScale(t,this.model);function i(o){var s,l=be(o),u=l.length;if(u){for(var h=[],f=u-1;f>=0;f--){var c=+l[f],d=o[c],v=d.model,p=d.scale;qS(p)&&v.get("alignTicks")&&v.get("interval")==null?h.push(d):(Au(p,v),qS(p)&&(s=d))}h.length&&(s||(s=h.pop(),Au(s.scale,s.model)),R(h,function(g){uU(g.scale,g.model,s.scale)}))}}i(n.x),i(n.y);var a={};R(n.x,function(o){rD(n,"y",o,a)}),R(n.y,function(o){rD(n,"x",o,a)}),this.resize(this.model,r)},e.prototype.resize=function(t,r,n){var i=t.getBoxLayoutParams(),a=!n&&t.get("containLabel"),o=Mr(i,{width:r.getWidth(),height:r.getHeight()});this._rect=o;var s=this._axesList;l(),a&&(R(s,function(u){if(!u.model.get(["axisLabel","inside"])){var h=a9(u);if(h){var f=u.isHorizontal()?"height":"width",c=u.model.get(["axisLabel","margin"]);o[f]-=h[f]+c,u.position==="top"?o.y+=h.height+c:u.position==="left"&&(o.x+=h.width+c)}}}),l()),R(this._coordsList,function(u){u.calcAffineTransform()});function l(){R(s,function(u){var h=u.isHorizontal(),f=h?[0,o.width]:[0,o.height],c=u.inverse?1:0;u.setExtent(f[c],f[1-c]),wY(u,h?o.x:o.y)})}},e.prototype.getAxis=function(t,r){var n=this._axesMap[t];if(n!=null)return n[r||0]},e.prototype.getAxes=function(){return this._axesList.slice()},e.prototype.getCartesian=function(t,r){if(t!=null&&r!=null){var n="x"+t+"y"+r;return this._coordsMap[n]}Kt(t)&&(r=t.yAxisIndex,t=t.xAxisIndex);for(var i=0,a=this._coordsList;i<a.length;i++)if(a[i].getAxis("x").index===t||a[i].getAxis("y").index===r)return a[i]},e.prototype.getCartesians=function(){return this._coordsList.slice()},e.prototype.convertToPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.dataToPoint(n):i.axis?i.axis.toGlobalCoord(i.axis.dataToCoord(n)):null},e.prototype.convertFromPixel=function(t,r,n){var i=this._findConvertTarget(r);return i.cartesian?i.cartesian.pointToData(n):i.axis?i.axis.coordToData(i.axis.toLocalCoord(n)):null},e.prototype._findConvertTarget=function(t){var r=t.seriesModel,n=t.xAxisModel||r&&r.getReferringComponents("xAxis",zr).models[0],i=t.yAxisModel||r&&r.getReferringComponents("yAxis",zr).models[0],a=t.gridModel,o=this._coordsList,s,l;if(r)s=r.coordinateSystem,pe(o,s)<0&&(s=null);else if(n&&i)s=this.getCartesian(n.componentIndex,i.componentIndex);else if(n)l=this.getAxis("x",n.componentIndex);else if(i)l=this.getAxis("y",i.componentIndex);else if(a){var u=a.coordinateSystem;u===this&&(s=this._coordsList[0])}return{cartesian:s,axis:l}},e.prototype.containPoint=function(t){var r=this._coordsList[0];if(r)return r.containPoint(t)},e.prototype._initCartesian=function(t,r,n){var i=this,a=this,o={left:!1,right:!1,top:!1,bottom:!1},s={x:{},y:{}},l={x:0,y:0};if(r.eachComponent("xAxis",u("x"),this),r.eachComponent("yAxis",u("y"),this),!l.x||!l.y){this._axesMap={},this._axesList=[];return}this._axesMap=s,R(s.x,function(h,f){R(s.y,function(c,d){var v="x"+f+"y"+d,p=new SY(v);p.master=i,p.model=t,i._coordsMap[v]=p,i._coordsList.push(p),p.addAxis(h),p.addAxis(c)})});function u(h){return function(f,c){if(Hy(f,t)){var d=f.get("position");h==="x"?d!=="top"&&d!=="bottom"&&(d=o.bottom?"top":"bottom"):d!=="left"&&d!=="right"&&(d=o.left?"right":"left"),o[d]=!0;var v=new TY(h,Cv(f),[0,0],f.get("type"),d),p=v.type==="category";v.onBand=p&&f.get("boundaryGap"),v.inverse=f.get("inverse"),f.axis=v,v.model=f,v.grid=a,v.index=c,a._axesList.push(v),s[h][c]=v,l[h]++}}}},e.prototype._updateScale=function(t,r){R(this._axesList,function(i){if(i.scale.setExtent(1/0,-1/0),i.type==="category"){var a=i.model.get("categorySortInfo");i.scale.setSortInfo(a)}}),t.eachSeries(function(i){if(tD(i)){var a=eD(i),o=a.xAxisModel,s=a.yAxisModel;if(!Hy(o,r)||!Hy(s,r))return;var l=this.getCartesian(o.componentIndex,s.componentIndex),u=i.getData(),h=l.getAxis("x"),f=l.getAxis("y");n(u,h),n(u,f)}},this);function n(i,a){R(Fm(i,a.dim),function(o){a.scale.unionExtentFromData(i,o)})}},e.prototype.getTooltipAxes=function(t){var r=[],n=[];return R(this.getCartesians(),function(i){var a=t!=null&&t!=="auto"?i.getAxis(t):i.getBaseAxis(),o=i.getOtherAxis(a);pe(r,a)<0&&r.push(a),pe(n,o)<0&&n.push(o)}),{baseAxes:r,otherAxes:n}},e.create=function(t,r){var n=[];return t.eachComponent("grid",function(i,a){var o=new e(i,t,r);o.name="grid_"+a,o.resize(i,r,!0),i.coordinateSystem=o,n.push(o)}),t.eachSeries(function(i){if(tD(i)){var a=eD(i),o=a.xAxisModel,s=a.yAxisModel,l=o.getCoordSysModel(),u=l.coordinateSystem;i.coordinateSystem=u.getCartesian(o.componentIndex,s.componentIndex)}}),n},e.dimensions=eT,e}();function Hy(e,t){return e.getCoordSysModel()===t}function rD(e,t,r,n){r.getAxesOnZeroOf=function(){return a?[a]:[]};var i=e[t],a,o=r.model,s=o.get(["axisLine","onZero"]),l=o.get(["axisLine","onZeroAxisIndex"]);if(!s)return;if(l!=null)nD(i[l])&&(a=i[l]);else for(var u in i)if(i.hasOwnProperty(u)&&nD(i[u])&&!n[h(i[u])]){a=i[u];break}a&&(n[h(a)]=!0);function h(f){return f.dim+"_"+f.index}}function nD(e){return e&&e.type!=="category"&&e.type!=="time"&&i9(e)}function wY(e,t){var r=e.getExtent(),n=r[0]+r[1];e.toGlobalCoord=e.dim==="x"?function(i){return i+t}:function(i){return n-i+t},e.toLocalCoord=e.dim==="x"?function(i){return i-t}:function(i){return n-i+t}}var Ts=Math.PI,Gn=function(){function e(t,r){this.group=new re,this.opt=r,this.axisModel=t,Vt(r,{labelOffset:0,nameDirection:1,tickDirection:1,labelDirection:1,silent:!0,handleAutoShown:function(){return!0}});var n=new re({x:r.position[0],y:r.position[1],rotation:r.rotation});n.updateTransform(),this._transformGroup=n}return e.prototype.hasBuilder=function(t){return!!iD[t]},e.prototype.add=function(t){iD[t](this.opt,this.axisModel,this.group,this._transformGroup)},e.prototype.getGroup=function(){return this.group},e.innerTextLayout=function(t,r,n){var i=TO(r-t),a,o;return Bd(i)?(o=n>0?"top":"bottom",a="center"):Bd(i-Ts)?(o=n>0?"bottom":"top",a="center"):(o="middle",i>0&&i<Ts?a=n>0?"right":"left":a=n>0?"left":"right"),{rotation:i,textAlign:a,textVerticalAlign:o}},e.makeAxisEventDataBase=function(t){var r={componentType:t.mainType,componentIndex:t.componentIndex};return r[t.mainType+"Index"]=t.componentIndex,r},e.isLabelSilent=function(t){var r=t.get("tooltip");return t.get("silent")||!(t.get("triggerEvent")||r&&r.show)},e}(),iD={axisLine:function(e,t,r,n){var i=t.get(["axisLine","show"]);if(i==="auto"&&e.handleAutoShown&&(i=e.handleAutoShown("axisLine")),!!i){var a=t.axis.getExtent(),o=n.transform,s=[a[0],0],l=[a[1],0],u=s[0]>l[0];o&&(en(s,s,o),en(l,l,o));var h=rt({lineCap:"round"},t.getModel(["axisLine","lineStyle"]).getLineStyle()),f=new jr({shape:{x1:s[0],y1:s[1],x2:l[0],y2:l[1]},style:h,strokeContainThreshold:e.strokeContainThreshold||5,silent:!0,z2:1});ff(f.shape,f.style.lineWidth),f.anid="line",r.add(f);var c=t.get(["axisLine","symbol"]);if(c!=null){var d=t.get(["axisLine","symbolSize"]);Ct(c)&&(c=[c,c]),(Ct(d)||Be(d))&&(d=[d,d]);var v=ku(t.get(["axisLine","symbolOffset"])||0,d),p=d[0],g=d[1];R([{rotate:e.rotation+Math.PI/2,offset:v[0],r:0},{rotate:e.rotation-Math.PI/2,offset:v[1],r:Math.sqrt((s[0]-l[0])*(s[0]-l[0])+(s[1]-l[1])*(s[1]-l[1]))}],function(m,_){if(c[_]!=="none"&&c[_]!=null){var y=Pr(c[_],-p/2,-g/2,p,g,h.stroke,!0),x=m.r+m.offset,T=u?l:s;y.attr({rotation:m.rotate,x:T[0]+x*Math.cos(e.rotation),y:T[1]-x*Math.sin(e.rotation),silent:!0,z2:11}),r.add(y)}})}}},axisTickLabel:function(e,t,r,n){var i=EY(r,n,t,e),a=DY(r,n,t,e);if(AY(t,a,i),CY(r,n,t,e.tickDirection),t.get(["axisLabel","hideOverlap"])){var o=wB(ft(a,function(s){return{label:s,priority:s.z2,defaultAttr:{ignore:s.ignore}}}));EB(o)}},axisName:function(e,t,r,n){var i=pn(e.axisName,t.get("name"));if(i){var a=t.get("nameLocation"),o=e.nameDirection,s=t.getModel("nameTextStyle"),l=t.get("nameGap")||0,u=t.axis.getExtent(),h=u[0]>u[1]?-1:1,f=[a==="start"?u[0]-h*l:a==="end"?u[1]+h*l:(u[0]+u[1])/2,oD(a)?e.labelOffset+o*l:0],c,d=t.get("nameRotate");d!=null&&(d=d*Ts/180);var v;oD(a)?c=Gn.innerTextLayout(e.rotation,d??e.rotation,o):(c=MY(e.rotation,a,d||0,u),v=e.axisNameAvailableWidth,v!=null&&(v=Math.abs(v/Math.sin(c.rotation)),!isFinite(v)&&(v=null)));var p=s.getFont(),g=t.get("nameTruncate",!0)||{},m=g.ellipsis,_=pn(e.nameTruncateMaxWidth,g.maxWidth,v),y=new we({x:f[0],y:f[1],rotation:c.rotation,silent:Gn.isLabelSilent(t),style:je(s,{text:i,font:p,overflow:"truncate",width:_,ellipsis:m,fill:s.getTextColor()||t.get(["axisLine","lineStyle","color"]),align:s.get("align")||c.textAlign,verticalAlign:s.get("verticalAlign")||c.textVerticalAlign}),z2:1});if(Uu({el:y,componentModel:t,itemName:i}),y.__fullText=i,y.anid="name",t.get("triggerEvent")){var x=Gn.makeAxisEventDataBase(t);x.targetType="axisName",x.name=i,oe(y).eventData=x}n.add(y),y.updateTransform(),r.add(y),y.decomposeTransform()}}};function MY(e,t,r,n){var i=TO(r-e),a,o,s=n[0]>n[1],l=t==="start"&&!s||t!=="start"&&s;return Bd(i-Ts/2)?(o=l?"bottom":"top",a="center"):Bd(i-Ts*1.5)?(o=l?"top":"bottom",a="center"):(o="middle",i<Ts*1.5&&i>Ts/2?a=l?"left":"right":a=l?"right":"left"),{rotation:i,textAlign:a,textVerticalAlign:o}}function AY(e,t,r){if(!hB(e.axis)){var n=e.get(["axisLabel","showMinLabel"]),i=e.get(["axisLabel","showMaxLabel"]);t=t||[],r=r||[];var a=t[0],o=t[1],s=t[t.length-1],l=t[t.length-2],u=r[0],h=r[1],f=r[r.length-1],c=r[r.length-2];n===!1?(Ti(a),Ti(u)):aD(a,o)&&(n?(Ti(o),Ti(h)):(Ti(a),Ti(u))),i===!1?(Ti(s),Ti(f)):aD(l,s)&&(i?(Ti(l),Ti(c)):(Ti(s),Ti(f)))}}function Ti(e){e&&(e.ignore=!0)}function aD(e,t){var r=e&&e.getBoundingRect().clone(),n=t&&t.getBoundingRect().clone();if(!(!r||!n)){var i=b_([]);return Fu(i,i,-e.rotation),r.applyTransform(wo([],i,e.getLocalTransform())),n.applyTransform(wo([],i,t.getLocalTransform())),r.intersect(n)}}function oD(e){return e==="middle"||e==="center"}function hU(e,t,r,n,i){for(var a=[],o=[],s=[],l=0;l<e.length;l++){var u=e[l].coord;o[0]=u,o[1]=0,s[0]=u,s[1]=r,t&&(en(o,o,t),en(s,s,t));var h=new jr({shape:{x1:o[0],y1:o[1],x2:s[0],y2:s[1]},style:n,z2:2,autoBatch:!0,silent:!0});ff(h.shape,h.style.lineWidth),h.anid=i+"_"+e[l].tickValue,a.push(h)}return a}function EY(e,t,r,n){var i=r.axis,a=r.getModel("axisTick"),o=a.get("show");if(o==="auto"&&n.handleAutoShown&&(o=n.handleAutoShown("axisTick")),!(!o||i.scale.isBlank())){for(var s=a.getModel("lineStyle"),l=n.tickDirection*a.get("length"),u=i.getTicksCoords(),h=hU(u,t.transform,l,Vt(s.getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])}),"ticks"),f=0;f<h.length;f++)e.add(h[f]);return h}}function CY(e,t,r,n){var i=r.axis,a=r.getModel("minorTick");if(!(!a.get("show")||i.scale.isBlank())){var o=i.getMinorTicksCoords();if(o.length)for(var s=a.getModel("lineStyle"),l=n*a.get("length"),u=Vt(s.getLineStyle(),Vt(r.getModel("axisTick").getLineStyle(),{stroke:r.get(["axisLine","lineStyle","color"])})),h=0;h<o.length;h++)for(var f=hU(o[h],t.transform,l,u,"minorticks_"+h),c=0;c<f.length;c++)e.add(f[c])}}function DY(e,t,r,n){var i=r.axis,a=pn(n.axisLabelShow,r.get(["axisLabel","show"]));if(!(!a||i.scale.isBlank())){var o=r.getModel("axisLabel"),s=o.get("margin"),l=i.getViewLabels(),u=(pn(n.labelRotate,o.get("rotate"))||0)*Ts/180,h=Gn.innerTextLayout(n.rotation,u,n.labelDirection),f=r.getCategories&&r.getCategories(!0),c=[],d=Gn.isLabelSilent(r),v=r.get("triggerEvent");return R(l,function(p,g){var m=i.scale.type==="ordinal"?i.scale.getRawOrdinalNumber(p.tickValue):p.tickValue,_=p.formattedLabel,y=p.rawLabel,x=o;if(f&&f[m]){var T=f[m];Kt(T)&&T.textStyle&&(x=new Ie(T.textStyle,o,r.ecModel))}var S=x.getTextColor()||r.get(["axisLine","lineStyle","color"]),M=i.dataToCoord(m),w=x.getShallow("align",!0)||h.textAlign,b=se(x.getShallow("alignMinLabel",!0),w),A=se(x.getShallow("alignMaxLabel",!0),w),E=x.getShallow("verticalAlign",!0)||x.getShallow("baseline",!0)||h.textVerticalAlign,C=se(x.getShallow("verticalAlignMinLabel",!0),E),D=se(x.getShallow("verticalAlignMaxLabel",!0),E),L=new we({x:M,y:n.labelOffset+n.labelDirection*s,rotation:h.rotation,silent:d,z2:10+(p.level||0),style:je(x,{text:_,align:g===0?b:g===l.length-1?A:w,verticalAlign:g===0?C:g===l.length-1?D:E,fill:Yt(S)?S(i.type==="category"?y:i.type==="value"?m+"":m,g):S})});if(L.anid="label_"+m,Uu({el:L,componentModel:r,itemName:_,formatterParamsExtra:{isTruncated:function(){return L.isTruncated},value:y,tickIndex:g}}),v){var P=Gn.makeAxisEventDataBase(r);P.targetType="axisLabel",P.value=y,P.tickIndex=g,i.type==="category"&&(P.dataIndex=m),oe(L).eventData=P}t.add(L),L.updateTransform(),c.push(L),e.add(L),L.decomposeTransform()}),c}}function LY(e,t){var r={axesInfo:{},seriesInvolved:!1,coordSysAxesInfo:{},coordSysMap:{}};return RY(r,e,t),r.seriesInvolved&&IY(r,e),r}function RY(e,t,r){var n=t.getComponent("tooltip"),i=t.getComponent("axisPointer"),a=i.get("link",!0)||[],o=[];R(r.getCoordinateSystems(),function(s){if(!s.axisPointerEnabled)return;var l=Jd(s.model),u=e.coordSysAxesInfo[l]={};e.coordSysMap[l]=s;var h=s.model,f=h.getModel("tooltip",n);if(R(s.getAxes(),ue(p,!1,null)),s.getTooltipAxes&&n&&f.get("show")){var c=f.get("trigger")==="axis",d=f.get(["axisPointer","type"])==="cross",v=s.getTooltipAxes(f.get(["axisPointer","axis"]));(c||d)&&R(v.baseAxes,ue(p,d?"cross":!0,c)),d&&R(v.otherAxes,ue(p,"cross",!1))}function p(g,m,_){var y=_.model.getModel("axisPointer",i),x=y.get("show");if(!(!x||x==="auto"&&!g&&!nT(y))){m==null&&(m=y.get("triggerTooltip")),y=g?PY(_,f,i,t,g,m):y;var T=y.get("snap"),S=y.get("triggerEmphasis"),M=Jd(_.model),w=m||T||_.type==="category",b=e.axesInfo[M]={key:M,axis:_,coordSys:s,axisPointerModel:y,triggerTooltip:m,triggerEmphasis:S,involveSeries:w,snap:T,useHandle:nT(y),seriesModels:[],linkGroup:null};u[M]=b,e.seriesInvolved=e.seriesInvolved||w;var A=NY(a,_);if(A!=null){var E=o[A]||(o[A]={axesInfo:{}});E.axesInfo[M]=b,E.mapper=a[A].mapper,b.linkGroup=E}}}})}function PY(e,t,r,n,i,a){var o=t.getModel("axisPointer"),s=["type","snap","lineStyle","shadowStyle","label","animation","animationDurationUpdate","animationEasingUpdate","z"],l={};R(s,function(c){l[c]=Qt(o.get(c))}),l.snap=e.type!=="category"&&!!a,o.get("type")==="cross"&&(l.type="line");var u=l.label||(l.label={});if(u.show==null&&(u.show=!1),i==="cross"){var h=o.get(["label","show"]);if(u.show=h??!0,!a){var f=l.lineStyle=o.get("crossStyle");f&&Vt(u,f.textStyle)}}return e.model.getModel("axisPointer",new Ie(l,r,n))}function IY(e,t){t.eachSeries(function(r){var n=r.coordinateSystem,i=r.get(["tooltip","trigger"],!0),a=r.get(["tooltip","show"],!0);!n||i==="none"||i===!1||i==="item"||a===!1||r.get(["axisPointer","show"],!0)===!1||R(e.coordSysAxesInfo[Jd(n.model)],function(o){var s=o.axis;n.getAxis(s.dim)===s&&(o.seriesModels.push(r),o.seriesDataCount==null&&(o.seriesDataCount=0),o.seriesDataCount+=r.getData().count())})})}function NY(e,t){for(var r=t.model,n=t.dim,i=0;i<e.length;i++){var a=e[i]||{};if(Wy(a[n+"AxisId"],r.id)||Wy(a[n+"AxisIndex"],r.componentIndex)||Wy(a[n+"AxisName"],r.name))return i}}function Wy(e,t){return e==="all"||at(e)&&pe(e,t)>=0||e===t}function OY(e){var t=nM(e);if(t){var r=t.axisPointerModel,n=t.axis.scale,i=r.option,a=r.get("status"),o=r.get("value");o!=null&&(o=n.parse(o));var s=nT(r);a==null&&(i.status=s?"show":"hide");var l=n.getExtent().slice();l[0]>l[1]&&l.reverse(),(o==null||o>l[1])&&(o=l[1]),o<l[0]&&(o=l[0]),i.value=o,s&&(i.status=t.axis.scale.isBlank()?"hide":"show")}}function nM(e){var t=(e.ecModel.getComponent("axisPointer")||{}).coordSysAxesInfo;return t&&t.axesInfo[Jd(e)]}function FY(e){var t=nM(e);return t&&t.axisPointerModel}function nT(e){return!!e.get(["handle","show"])}function Jd(e){return e.type+"||"+e.id}var sD={},Hu=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i,a){this.axisPointerClass&&OY(r),e.prototype.render.apply(this,arguments),this._doUpdateAxisPointerClass(r,i,!0)},t.prototype.updateAxisPointer=function(r,n,i,a){this._doUpdateAxisPointerClass(r,i,!1)},t.prototype.remove=function(r,n){var i=this._axisPointer;i&&i.remove(n)},t.prototype.dispose=function(r,n){this._disposeAxisPointer(n),e.prototype.dispose.apply(this,arguments)},t.prototype._doUpdateAxisPointerClass=function(r,n,i){var a=t.getAxisPointerClass(this.axisPointerClass);if(a){var o=FY(r);o?(this._axisPointer||(this._axisPointer=new a)).render(r,o,n,i):this._disposeAxisPointer(n)}},t.prototype._disposeAxisPointer=function(r){this._axisPointer&&this._axisPointer.dispose(r),this._axisPointer=null},t.registerAxisPointerClass=function(r,n){sD[r]=n},t.getAxisPointerClass=function(r){return r&&sD[r]},t.type="axis",t}(nr),iT=Le();function fU(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitArea"),o=a.getModel("areaStyle"),s=o.get("color"),l=n.coordinateSystem.getRect(),u=i.getTicksCoords({tickModel:a,clamp:!0});if(u.length){var h=s.length,f=iT(e).splitAreaColors,c=Ut(),d=0;if(f)for(var v=0;v<u.length;v++){var p=f.get(u[v].tickValue);if(p!=null){d=(p+(h-1)*v)%h;break}}var g=i.toGlobalCoord(u[0].coord),m=o.getAreaStyle();s=at(s)?s:[s];for(var v=1;v<u.length;v++){var _=i.toGlobalCoord(u[v].coord),y=void 0,x=void 0,T=void 0,S=void 0;i.isHorizontal()?(y=g,x=l.y,T=_-y,S=l.height,g=y+T):(y=l.x,x=g,T=l.width,S=_-x,g=x+S);var M=u[v-1].tickValue;M!=null&&c.set(M,d),t.add(new Ae({anid:M!=null?"area_"+M:null,shape:{x:y,y:x,width:T,height:S},style:Vt({fill:s[d]},m),autoBatch:!0,silent:!0})),d=(d+1)%h}iT(e).splitAreaColors=c}}}function cU(e){iT(e).splitAreaColors=null}var BY=["axisLine","axisTickLabel","axisName"],UY=["splitArea","splitLine","minorSplitLine"],dU=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="CartesianAxisPointer",r}return t.prototype.render=function(r,n,i,a){this.group.removeAll();var o=this._axisGroup;if(this._axisGroup=new re,this.group.add(this._axisGroup),!!r.get("show")){var s=r.getCoordSysModel(),l=rT(s,r),u=new Gn(r,rt({handleAutoShown:function(f){for(var c=s.coordinateSystem.getCartesians(),d=0;d<c.length;d++)if(qS(c[d].getOtherAxis(r.axis).scale))return!0;return!1}},l));R(BY,u.add,u),this._axisGroup.add(u.getGroup()),R(UY,function(f){r.get([f,"show"])&&zY[f](this,this._axisGroup,r,s)},this);var h=a&&a.type==="changeAxisOrder"&&a.isInitSort;h||wv(o,this._axisGroup,r),e.prototype.render.call(this,r,n,i,a)}},t.prototype.remove=function(){cU(this)},t.type="cartesianAxis",t}(Hu),zY={splitLine:function(e,t,r,n){var i=r.axis;if(!i.scale.isBlank()){var a=r.getModel("splitLine"),o=a.getModel("lineStyle"),s=o.get("color"),l=a.get("showMinLine")!==!1,u=a.get("showMaxLine")!==!1;s=at(s)?s:[s];for(var h=n.coordinateSystem.getRect(),f=i.isHorizontal(),c=0,d=i.getTicksCoords({tickModel:a}),v=[],p=[],g=o.getLineStyle(),m=0;m<d.length;m++){var _=i.toGlobalCoord(d[m].coord);if(!(m===0&&!l||m===d.length-1&&!u)){var y=d[m].tickValue;f?(v[0]=_,v[1]=h.y,p[0]=_,p[1]=h.y+h.height):(v[0]=h.x,v[1]=_,p[0]=h.x+h.width,p[1]=_);var x=c++%s.length,T=new jr({anid:y!=null?"line_"+y:null,autoBatch:!0,shape:{x1:v[0],y1:v[1],x2:p[0],y2:p[1]},style:Vt({stroke:s[x]},g),silent:!0});ff(T.shape,g.lineWidth),t.add(T)}}}},minorSplitLine:function(e,t,r,n){var i=r.axis,a=r.getModel("minorSplitLine"),o=a.getModel("lineStyle"),s=n.coordinateSystem.getRect(),l=i.isHorizontal(),u=i.getMinorTicksCoords();if(u.length)for(var h=[],f=[],c=o.getLineStyle(),d=0;d<u.length;d++)for(var v=0;v<u[d].length;v++){var p=i.toGlobalCoord(u[d][v].coord);l?(h[0]=p,h[1]=s.y,f[0]=p,f[1]=s.y+s.height):(h[0]=s.x,h[1]=p,f[0]=s.x+s.width,f[1]=p);var g=new jr({anid:"minor_line_"+u[d][v].tickValue,autoBatch:!0,shape:{x1:h[0],y1:h[1],x2:f[0],y2:f[1]},style:c,silent:!0});ff(g.shape,c.lineWidth),t.add(g)}},splitArea:function(e,t,r,n){fU(e,t,r,n)}},vU=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="xAxis",t}(dU),kY=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=vU.type,r}return t.type="yAxis",t}(dU),GY=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="grid",r}return t.prototype.render=function(r,n){this.group.removeAll(),r.get("show")&&this.group.add(new Ae({shape:r.coordinateSystem.getRect(),style:Vt({fill:r.get("backgroundColor")},r.getItemStyle()),silent:!0,z2:-1}))},t.type="grid",t}(nr),lD={offset:0};function pU(e){e.registerComponentView(GY),e.registerComponentModel(gY),e.registerCoordinateSystem("cartesian2d",bY),pf(e,"x",tT,lD),pf(e,"y",tT,lD),e.registerComponentView(vU),e.registerComponentView(kY),e.registerPreprocessor(function(t){t.xAxis&&t.yAxis&&!t.grid&&(t.grid={})})}function VY(e){te(pU),e.registerSeriesModel(fY),e.registerChartView(pY),e.registerLayout(Pv("scatter"))}function HY(e){e.eachSeriesByType("radar",function(t){var r=t.getData(),n=[],i=t.coordinateSystem;if(i){var a=i.getIndicatorAxes();R(a,function(o,s){r.each(r.mapDimension(a[s].dim),function(l,u){n[u]=n[u]||[];var h=i.dataToPoint(l,s);n[u][s]=uD(h)?h:hD(i)})}),r.each(function(o){var s=P4(n[o],function(l){return uD(l)})||hD(i);n[o].push(s.slice()),r.setItemLayout(o,n[o])})}})}function uD(e){return!isNaN(e[0])&&!isNaN(e[1])}function hD(e){return[e.cx,e.cy]}function WY(e){var t=e.polar;if(t){at(t)||(t=[t]);var r=[];R(t,function(n,i){n.indicator?(n.type&&!n.shape&&(n.shape=n.type),e.radar=e.radar||[],at(e.radar)||(e.radar=[e.radar]),e.radar.push(n)):r.push(n)}),e.polar=r}R(e.series,function(n){n&&n.type==="radar"&&n.polarIndex&&(n.radarIndex=n.polarIndex)})}var XY=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=r.coordinateSystem,o=this.group,s=r.getData(),l=this._data;function u(c,d){var v=c.getItemVisual(d,"symbol")||"circle";if(v!=="none"){var p=$f(c.getItemVisual(d,"symbolSize")),g=Pr(v,-1,-1,2,2),m=c.getItemVisual(d,"symbolRotate")||0;return g.attr({style:{strokeNoScale:!0},z2:100,scaleX:p[0]/2,scaleY:p[1]/2,rotation:m*Math.PI/180||0}),g}}function h(c,d,v,p,g,m){v.removeAll();for(var _=0;_<d.length-1;_++){var y=u(p,g);y&&(y.__dimIdx=_,c[_]?(y.setPosition(c[_]),zu[m?"initProps":"updateProps"](y,{x:d[_][0],y:d[_][1]},r,g)):y.setPosition(d[_]),v.add(y))}}function f(c){return ft(c,function(d){return[a.cx,a.cy]})}s.diff(l).add(function(c){var d=s.getItemLayout(c);if(d){var v=new Yn,p=new $n,g={shape:{points:d}};v.shape.points=f(d),p.shape.points=f(d),vr(v,g,r,c),vr(p,g,r,c);var m=new re,_=new re;m.add(p),m.add(v),m.add(_),h(p.shape.points,d,_,s,c,!0),s.setItemGraphicEl(c,m)}}).update(function(c,d){var v=l.getItemGraphicEl(d),p=v.childAt(0),g=v.childAt(1),m=v.childAt(2),_={shape:{points:s.getItemLayout(c)}};_.shape.points&&(h(p.shape.points,_.shape.points,m,s,c,!1),ya(g),ya(p),ke(p,_,r),ke(g,_,r),s.setItemGraphicEl(c,v))}).remove(function(c){o.remove(l.getItemGraphicEl(c))}).execute(),s.eachItemGraphicEl(function(c,d){var v=s.getItemModel(d),p=c.childAt(0),g=c.childAt(1),m=c.childAt(2),_=s.getItemVisual(d,"style"),y=_.fill;o.add(c),p.useStyle(Vt(v.getModel("lineStyle").getLineStyle(),{fill:"none",stroke:y})),xn(p,v,"lineStyle"),xn(g,v,"areaStyle");var x=v.getModel("areaStyle"),T=x.isEmpty()&&x.parentModel.isEmpty();g.ignore=T,R(["emphasis","select","blur"],function(w){var b=v.getModel([w,"areaStyle"]),A=b.isEmpty()&&b.parentModel.isEmpty();g.ensureState(w).ignore=A&&T}),g.useStyle(Vt(x.getAreaStyle(),{fill:y,opacity:.7,decal:_.decal}));var S=v.getModel("emphasis"),M=S.getModel("itemStyle").getItemStyle();m.eachChild(function(w){if(w instanceof hn){var b=w.style;w.useStyle(rt({image:b.image,x:b.x,y:b.y,width:b.width,height:b.height},_))}else w.useStyle(_),w.setColor(y),w.style.strokeNoScale=!0;var A=w.ensureState("emphasis");A.style=Qt(M);var E=s.getStore().get(s.getDimensionIndex(w.__dimIdx),d);(E==null||isNaN(E))&&(E=""),Sn(w,an(v),{labelFetcher:s.hostModel,labelDataIndex:d,labelDimIndex:w.__dimIdx,defaultText:E,inheritColor:y,defaultOpacity:_.opacity})}),Sr(c,S.get("focus"),S.get("blurScope"),S.get("disabled"))}),this._data=s},t.prototype.remove=function(){this.group.removeAll(),this._data=null},t.type="radar",t}(De),YY=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new Nv(It(this.getData,this),It(this.getRawData,this))},t.prototype.getInitialData=function(r,n){return Qf(this,{generateCoord:"indicator_",generateCoordCount:1/0})},t.prototype.formatTooltip=function(r,n,i){var a=this.getData(),o=this.coordinateSystem,s=o.getIndicatorAxes(),l=this.getData().getName(r),u=l===""?this.name:l,h=lF(this,r);return on("section",{header:u,sortBlocks:!0,blocks:ft(s,function(f){var c=a.get(a.mapDimension(f.dim),r);return on("nameValue",{markerType:"subItem",markerColor:h,name:f.name,value:c,sortParam:c})})})},t.prototype.getTooltipPosition=function(r){if(r!=null){for(var n=this.getData(),i=this.coordinateSystem,a=n.getValues(ft(i.dimensions,function(u){return n.mapDimension(u)}),r),o=0,s=a.length;o<s;o++)if(!isNaN(a[o])){var l=i.getIndicatorAxes();return i.coordToPoint(l[o].dataToCoord(a[o]),o)}}},t.type="series.radar",t.dependencies=["radar"],t.defaultOption={z:2,colorBy:"data",coordinateSystem:"radar",legendHoverLink:!0,radarIndex:0,lineStyle:{width:2,type:"solid",join:"round"},label:{position:"top"},symbolSize:8},t}(Ue),Dc=lU.value;function Np(e,t){return Vt({show:t},e)}var ZY=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(){var r=this.get("boundaryGap"),n=this.get("splitNumber"),i=this.get("scale"),a=this.get("axisLine"),o=this.get("axisTick"),s=this.get("axisLabel"),l=this.get("axisName"),u=this.get(["axisName","show"]),h=this.get(["axisName","formatter"]),f=this.get("axisNameGap"),c=this.get("triggerEvent"),d=ft(this.get("indicator")||[],function(v){v.max!=null&&v.max>0&&!v.min?v.min=0:v.min!=null&&v.min<0&&!v.max&&(v.max=0);var p=l;v.color!=null&&(p=Vt({color:v.color},l));var g=Ot(Qt(v),{boundaryGap:r,splitNumber:n,scale:i,axisLine:a,axisTick:o,axisLabel:s,name:v.text,showName:u,nameLocation:"end",nameGap:f,nameTextStyle:p,triggerEvent:c},!1);if(Ct(h)){var m=g.name;g.name=h.replace("{value}",m??"")}else Yt(h)&&(g.name=h(g.name,g));var _=new Ie(g,null,this.ecModel);return Nr(_,Jf.prototype),_.mainType="radar",_.componentIndex=this.componentIndex,_},this);this._indicatorModels=d},t.prototype.getIndicatorModels=function(){return this._indicatorModels},t.type="radar",t.defaultOption={z:0,center:["50%","50%"],radius:"75%",startAngle:90,axisName:{show:!0},boundaryGap:[0,0],splitNumber:5,axisNameGap:15,scale:!1,shape:"polygon",axisLine:Ot({lineStyle:{color:"#bbb"}},Dc.axisLine),axisLabel:Np(Dc.axisLabel,!1),axisTick:Np(Dc.axisTick,!1),splitLine:Np(Dc.splitLine,!0),splitArea:Np(Dc.splitArea,!0),indicator:[]},t}(me),qY=["axisLine","axisTickLabel","axisName"],$Y=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=this.group;a.removeAll(),this._buildAxes(r),this._buildSplitLineAndArea(r)},t.prototype._buildAxes=function(r){var n=r.coordinateSystem,i=n.getIndicatorAxes(),a=ft(i,function(o){var s=o.model.get("showName")?o.name:"",l=new Gn(o.model,{axisName:s,position:[n.cx,n.cy],rotation:o.angle,labelDirection:-1,tickDirection:-1,nameDirection:1});return l});R(a,function(o){R(qY,o.add,o),this.group.add(o.getGroup())},this)},t.prototype._buildSplitLineAndArea=function(r){var n=r.coordinateSystem,i=n.getIndicatorAxes();if(!i.length)return;var a=r.get("shape"),o=r.getModel("splitLine"),s=r.getModel("splitArea"),l=o.getModel("lineStyle"),u=s.getModel("areaStyle"),h=o.get("show"),f=s.get("show"),c=l.get("color"),d=u.get("color"),v=at(c)?c:[c],p=at(d)?d:[d],g=[],m=[];function _(P,N,O){var I=O%N.length;return P[I]=P[I]||[],I}if(a==="circle")for(var y=i[0].getTicksCoords(),x=n.cx,T=n.cy,S=0;S<y.length;S++){if(h){var M=_(g,v,S);g[M].push(new Vo({shape:{cx:x,cy:T,r:y[S].coord}}))}if(f&&S<y.length-1){var M=_(m,p,S);m[M].push(new Sv({shape:{cx:x,cy:T,r0:y[S].coord,r:y[S+1].coord}}))}}else for(var w,b=ft(i,function(P,N){var O=P.getTicksCoords();return w=w==null?O.length-1:Math.min(O.length-1,w),ft(O,function(I){return n.coordToPoint(I.coord,N)})}),A=[],S=0;S<=w;S++){for(var E=[],C=0;C<i.length;C++)E.push(b[C][S]);if(E[0]&&E.push(E[0].slice()),h){var M=_(g,v,S);g[M].push(new $n({shape:{points:E}}))}if(f&&A){var M=_(m,p,S-1);m[M].push(new Yn({shape:{points:E.concat(A)}}))}A=E.slice().reverse()}var D=l.getLineStyle(),L=u.getAreaStyle();R(m,function(P,N){this.group.add(Ui(P,{style:Vt({stroke:"none",fill:p[N%p.length]},L),silent:!0}))},this),R(g,function(P,N){this.group.add(Ui(P,{style:Vt({fill:"none",stroke:v[N%v.length]},D),silent:!0}))},this)},t.type="radar",t}(nr),KY=function(e){q(t,e);function t(r,n,i){var a=e.call(this,r,n,i)||this;return a.type="value",a.angle=0,a.name="",a}return t}(Kn),jY=function(){function e(t,r,n){this.dimensions=[],this._model=t,this._indicatorAxes=ft(t.getIndicatorModels(),function(i,a){var o="indicator_"+a,s=new KY(o,new Fo);return s.name=i.get("name"),s.model=i,i.axis=s,this.dimensions.push(o),s},this),this.resize(t,n)}return e.prototype.getIndicatorAxes=function(){return this._indicatorAxes},e.prototype.dataToPoint=function(t,r){var n=this._indicatorAxes[r];return this.coordToPoint(n.dataToCoord(t),r)},e.prototype.coordToPoint=function(t,r){var n=this._indicatorAxes[r],i=n.angle,a=this.cx+t*Math.cos(i),o=this.cy-t*Math.sin(i);return[a,o]},e.prototype.pointToData=function(t){var r=t[0]-this.cx,n=t[1]-this.cy,i=Math.sqrt(r*r+n*n);r/=i,n/=i;for(var a=Math.atan2(-n,r),o=1/0,s,l=-1,u=0;u<this._indicatorAxes.length;u++){var h=this._indicatorAxes[u],f=Math.abs(a-h.angle);f<o&&(s=h,l=u,o=f)}return[l,+(s&&s.coordToData(i))]},e.prototype.resize=function(t,r){var n=t.get("center"),i=r.getWidth(),a=r.getHeight(),o=Math.min(i,a)/2;this.cx=Tt(n[0],i),this.cy=Tt(n[1],a),this.startAngle=t.get("startAngle")*Math.PI/180;var s=t.get("radius");(Ct(s)||Be(s))&&(s=[0,s]),this.r0=Tt(s[0],o),this.r=Tt(s[1],o),R(this._indicatorAxes,function(l,u){l.setExtent(this.r0,this.r);var h=this.startAngle+u*Math.PI*2/this._indicatorAxes.length;h=Math.atan2(Math.sin(h),Math.cos(h)),l.angle=h},this)},e.prototype.update=function(t,r){var n=this._indicatorAxes,i=this._model;R(n,function(s){s.scale.setExtent(1/0,-1/0)}),t.eachSeriesByType("radar",function(s,l){if(!(s.get("coordinateSystem")!=="radar"||t.getComponent("radar",s.get("radarIndex"))!==i)){var u=s.getData();R(n,function(h){h.scale.unionExtentFromData(u,u.mapDimension(h.dim))})}},this);var a=i.get("splitNumber"),o=new Fo;o.setExtent(0,a),o.setInterval(1),R(n,function(s,l){uU(s.scale,s.model,o)})},e.prototype.convertToPixel=function(t,r,n){return console.warn("Not implemented."),null},e.prototype.convertFromPixel=function(t,r,n){return console.warn("Not implemented."),null},e.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},e.create=function(t,r){var n=[];return t.eachComponent("radar",function(i){var a=new e(i,t,r);n.push(a),i.coordinateSystem=a}),t.eachSeriesByType("radar",function(i){i.get("coordinateSystem")==="radar"&&(i.coordinateSystem=n[i.get("radarIndex")||0])}),n},e.dimensions=[],e}();function JY(e){e.registerCoordinateSystem("radar",jY),e.registerComponentModel(ZY),e.registerComponentView($Y),e.registerVisual({seriesType:"radar",reset:function(t){var r=t.getData();r.each(function(n){r.setItemVisual(n,"legendIcon","roundRect")}),r.setVisual("legendIcon","roundRect")}})}function QY(e){te(JY),e.registerChartView(XY),e.registerSeriesModel(YY),e.registerLayout(HY),e.registerProcessor(Iv("radar")),e.registerPreprocessor(WY)}var fD="\0_ec_interaction_mutex";function tZ(e,t,r){var n=iM(e);n[t]=r}function eZ(e,t,r){var n=iM(e),i=n[t];i===r&&(n[t]=null)}function cD(e,t){return!!iM(e)[t]}function iM(e){return e[fD]||(e[fD]={})}Ja({type:"takeGlobalCursor",event:"globalCursorTaken",update:"update"},Rr);var Ov=function(e){q(t,e);function t(r){var n=e.call(this)||this;n._zr=r;var i=It(n._mousedownHandler,n),a=It(n._mousemoveHandler,n),o=It(n._mouseupHandler,n),s=It(n._mousewheelHandler,n),l=It(n._pinchHandler,n);return n.enable=function(u,h){this.disable(),this._opt=Vt(Qt(h)||{},{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),u==null&&(u=!0),(u===!0||u==="move"||u==="pan")&&(r.on("mousedown",i),r.on("mousemove",a),r.on("mouseup",o)),(u===!0||u==="scale"||u==="zoom")&&(r.on("mousewheel",s),r.on("pinch",l))},n.disable=function(){r.off("mousedown",i),r.off("mousemove",a),r.off("mouseup",o),r.off("mousewheel",s),r.off("pinch",l)},n}return t.prototype.isDragging=function(){return this._dragging},t.prototype.isPinching=function(){return this._pinching},t.prototype.setPointerChecker=function(r){this.pointerChecker=r},t.prototype.dispose=function(){this.disable()},t.prototype._mousedownHandler=function(r){if(!VA(r)){for(var n=r.target;n;){if(n.draggable)return;n=n.__hostTarget||n.parent}var i=r.offsetX,a=r.offsetY;this.pointerChecker&&this.pointerChecker(r,i,a)&&(this._x=i,this._y=a,this._dragging=!0)}},t.prototype._mousemoveHandler=function(r){if(!(!this._dragging||!jg("moveOnMouseMove",r,this._opt)||r.gestureEvent==="pinch"||cD(this._zr,"globalPan"))){var n=r.offsetX,i=r.offsetY,a=this._x,o=this._y,s=n-a,l=i-o;this._x=n,this._y=i,this._opt.preventDefaultMouseMove&&Lo(r.event),gU(this,"pan","moveOnMouseMove",r,{dx:s,dy:l,oldX:a,oldY:o,newX:n,newY:i,isAvailableBehavior:null})}},t.prototype._mouseupHandler=function(r){VA(r)||(this._dragging=!1)},t.prototype._mousewheelHandler=function(r){var n=jg("zoomOnMouseWheel",r,this._opt),i=jg("moveOnMouseWheel",r,this._opt),a=r.wheelDelta,o=Math.abs(a),s=r.offsetX,l=r.offsetY;if(!(a===0||!n&&!i)){if(n){var u=o>3?1.4:o>1?1.2:1.1,h=a>0?u:1/u;Xy(this,"zoom","zoomOnMouseWheel",r,{scale:h,originX:s,originY:l,isAvailableBehavior:null})}if(i){var f=Math.abs(a),c=(a>0?1:-1)*(f>3?.4:f>1?.15:.05);Xy(this,"scrollMove","moveOnMouseWheel",r,{scrollDelta:c,originX:s,originY:l,isAvailableBehavior:null})}}},t.prototype._pinchHandler=function(r){if(!cD(this._zr,"globalPan")){var n=r.pinchScale>1?1.1:1/1.1;Xy(this,"zoom",null,r,{scale:n,originX:r.pinchX,originY:r.pinchY,isAvailableBehavior:null})}},t}(Zi);function Xy(e,t,r,n,i){e.pointerChecker&&e.pointerChecker(n,i.originX,i.originY)&&(Lo(n.event),gU(e,t,r,n,i))}function gU(e,t,r,n,i){i.isAvailableBehavior=It(jg,null,r,n),e.trigger(t,i)}function jg(e,t,r){var n=r[e];return!e||n&&(!Ct(n)||t.event[n+"Key"])}function aM(e,t,r){var n=e.target;n.x+=t,n.y+=r,n.dirty()}function oM(e,t,r,n){var i=e.target,a=e.zoomLimit,o=e.zoom=e.zoom||1;if(o*=t,a){var s=a.min||0,l=a.max||1/0;o=Math.max(Math.min(l,o),s)}var u=o/e.zoom;e.zoom=o,i.x-=(r-i.x)*(u-1),i.y-=(n-i.y)*(u-1),i.scaleX*=u,i.scaleY*=u,i.dirty()}var rZ={axisPointer:1,tooltip:1,brush:1};function e0(e,t,r){var n=t.getComponentByElement(e.topTarget),i=n&&n.coordinateSystem;return n&&n!==r&&!rZ.hasOwnProperty(n.mainType)&&i&&i.model!==r}function mU(e){if(Ct(e)){var t=new DOMParser;e=t.parseFromString(e,"text/xml")}var r=e;for(r.nodeType===9&&(r=r.firstChild);r.nodeName.toLowerCase()!=="svg"||r.nodeType!==1;)r=r.nextSibling;return r}var Yy,Gm={fill:"fill",stroke:"stroke","stroke-width":"lineWidth",opacity:"opacity","fill-opacity":"fillOpacity","stroke-opacity":"strokeOpacity","stroke-dasharray":"lineDash","stroke-dashoffset":"lineDashOffset","stroke-linecap":"lineCap","stroke-linejoin":"lineJoin","stroke-miterlimit":"miterLimit","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","text-anchor":"textAlign",visibility:"visibility",display:"display"},dD=be(Gm),Vm={"alignment-baseline":"textBaseline","stop-color":"stopColor"},vD=be(Vm),nZ=function(){function e(){this._defs={},this._root=null}return e.prototype.parse=function(t,r){r=r||{};var n=mU(t);this._defsUsePending=[];var i=new re;this._root=i;var a=[],o=n.getAttribute("viewBox")||"",s=parseFloat(n.getAttribute("width")||r.width),l=parseFloat(n.getAttribute("height")||r.height);isNaN(s)&&(s=null),isNaN(l)&&(l=null),vi(n,i,null,!0,!1);for(var u=n.firstChild;u;)this._parseNode(u,i,a,null,!1,!1),u=u.nextSibling;oZ(this._defs,this._defsUsePending),this._defsUsePending=[];var h,f;if(o){var c=r0(o);c.length>=4&&(h={x:parseFloat(c[0]||0),y:parseFloat(c[1]||0),width:parseFloat(c[2]),height:parseFloat(c[3])})}if(h&&s!=null&&l!=null&&(f=yU(h,{x:0,y:0,width:s,height:l}),!r.ignoreViewBox)){var d=i;i=new re,i.add(d),d.scaleX=d.scaleY=f.scale,d.x=f.x,d.y=f.y}return!r.ignoreRootClip&&s!=null&&l!=null&&i.setClipPath(new Ae({shape:{x:0,y:0,width:s,height:l}})),{root:i,width:s,height:l,viewBoxRect:h,viewBoxTransform:f,named:a}},e.prototype._parseNode=function(t,r,n,i,a,o){var s=t.nodeName.toLowerCase(),l,u=i;if(s==="defs"&&(a=!0),s==="text"&&(o=!0),s==="defs"||s==="switch")l=r;else{if(!a){var h=Yy[s];if(h&&Ft(Yy,s)){l=h.call(this,t,r);var f=t.getAttribute("name");if(f){var c={name:f,namedFrom:null,svgNodeTagLower:s,el:l};n.push(c),s==="g"&&(u=c)}else i&&n.push({name:i.name,namedFrom:i,svgNodeTagLower:s,el:l});r.add(l)}}var d=pD[s];if(d&&Ft(pD,s)){var v=d.call(this,t),p=t.getAttribute("id");p&&(this._defs[p]=v)}}if(l&&l.isGroup)for(var g=t.firstChild;g;)g.nodeType===1?this._parseNode(g,l,n,u,a,o):g.nodeType===3&&o&&this._parseText(g,l),g=g.nextSibling},e.prototype._parseText=function(t,r){var n=new hf({style:{text:t.textContent},silent:!0,x:this._textX||0,y:this._textY||0});bi(r,n),vi(t,n,this._defsUsePending,!1,!1),iZ(n,r);var i=n.style,a=i.fontSize;a&&a<9&&(i.fontSize=9,n.scaleX*=a/9,n.scaleY*=a/9);var o=(i.fontSize||i.fontFamily)&&[i.fontStyle,i.fontWeight,(i.fontSize||12)+"px",i.fontFamily||"sans-serif"].join(" ");i.font=o;var s=n.getBoundingRect();return this._textX+=s.width,r.add(n),n},e.internalField=function(){Yy={g:function(t,r){var n=new re;return bi(r,n),vi(t,n,this._defsUsePending,!1,!1),n},rect:function(t,r){var n=new Ae;return bi(r,n),vi(t,n,this._defsUsePending,!1,!1),n.setShape({x:parseFloat(t.getAttribute("x")||"0"),y:parseFloat(t.getAttribute("y")||"0"),width:parseFloat(t.getAttribute("width")||"0"),height:parseFloat(t.getAttribute("height")||"0")}),n.silent=!0,n},circle:function(t,r){var n=new Vo;return bi(r,n),vi(t,n,this._defsUsePending,!1,!1),n.setShape({cx:parseFloat(t.getAttribute("cx")||"0"),cy:parseFloat(t.getAttribute("cy")||"0"),r:parseFloat(t.getAttribute("r")||"0")}),n.silent=!0,n},line:function(t,r){var n=new jr;return bi(r,n),vi(t,n,this._defsUsePending,!1,!1),n.setShape({x1:parseFloat(t.getAttribute("x1")||"0"),y1:parseFloat(t.getAttribute("y1")||"0"),x2:parseFloat(t.getAttribute("x2")||"0"),y2:parseFloat(t.getAttribute("y2")||"0")}),n.silent=!0,n},ellipse:function(t,r){var n=new N_;return bi(r,n),vi(t,n,this._defsUsePending,!1,!1),n.setShape({cx:parseFloat(t.getAttribute("cx")||"0"),cy:parseFloat(t.getAttribute("cy")||"0"),rx:parseFloat(t.getAttribute("rx")||"0"),ry:parseFloat(t.getAttribute("ry")||"0")}),n.silent=!0,n},polygon:function(t,r){var n=t.getAttribute("points"),i;n&&(i=_D(n));var a=new Yn({shape:{points:i||[]},silent:!0});return bi(r,a),vi(t,a,this._defsUsePending,!1,!1),a},polyline:function(t,r){var n=t.getAttribute("points"),i;n&&(i=_D(n));var a=new $n({shape:{points:i||[]},silent:!0});return bi(r,a),vi(t,a,this._defsUsePending,!1,!1),a},image:function(t,r){var n=new hn;return bi(r,n),vi(t,n,this._defsUsePending,!1,!1),n.setStyle({image:t.getAttribute("xlink:href")||t.getAttribute("href"),x:+t.getAttribute("x"),y:+t.getAttribute("y"),width:+t.getAttribute("width"),height:+t.getAttribute("height")}),n.silent=!0,n},text:function(t,r){var n=t.getAttribute("x")||"0",i=t.getAttribute("y")||"0",a=t.getAttribute("dx")||"0",o=t.getAttribute("dy")||"0";this._textX=parseFloat(n)+parseFloat(a),this._textY=parseFloat(i)+parseFloat(o);var s=new re;return bi(r,s),vi(t,s,this._defsUsePending,!1,!0),s},tspan:function(t,r){var n=t.getAttribute("x"),i=t.getAttribute("y");n!=null&&(this._textX=parseFloat(n)),i!=null&&(this._textY=parseFloat(i));var a=t.getAttribute("dx")||"0",o=t.getAttribute("dy")||"0",s=new re;return bi(r,s),vi(t,s,this._defsUsePending,!1,!0),this._textX+=parseFloat(a),this._textY+=parseFloat(o),s},path:function(t,r){var n=t.getAttribute("d")||"",i=n3(n);return bi(r,i),vi(t,i,this._defsUsePending,!1,!1),i.silent=!0,i}}}(),e}(),pD={lineargradient:function(e){var t=parseInt(e.getAttribute("x1")||"0",10),r=parseInt(e.getAttribute("y1")||"0",10),n=parseInt(e.getAttribute("x2")||"10",10),i=parseInt(e.getAttribute("y2")||"0",10),a=new bv(t,r,n,i);return gD(e,a),mD(e,a),a},radialgradient:function(e){var t=parseInt(e.getAttribute("cx")||"0",10),r=parseInt(e.getAttribute("cy")||"0",10),n=parseInt(e.getAttribute("r")||"0",10),i=new s3(t,r,n);return gD(e,i),mD(e,i),i}};function gD(e,t){var r=e.getAttribute("gradientUnits");r==="userSpaceOnUse"&&(t.global=!0)}function mD(e,t){for(var r=e.firstChild;r;){if(r.nodeType===1&&r.nodeName.toLocaleLowerCase()==="stop"){var n=r.getAttribute("offset"),i=void 0;n&&n.indexOf("%")>0?i=parseInt(n,10)/100:n?i=parseFloat(n):i=0;var a={};_U(r,a,a);var o=a.stopColor||r.getAttribute("stop-color")||"#000000";t.colorStops.push({offset:i,color:o})}r=r.nextSibling}}function bi(e,t){e&&e.__inheritedStyle&&(t.__inheritedStyle||(t.__inheritedStyle={}),Vt(t.__inheritedStyle,e.__inheritedStyle))}function _D(e){for(var t=r0(e),r=[],n=0;n<t.length;n+=2){var i=parseFloat(t[n]),a=parseFloat(t[n+1]);r.push([i,a])}return r}function vi(e,t,r,n,i){var a=t,o=a.__inheritedStyle=a.__inheritedStyle||{},s={};e.nodeType===1&&(uZ(e,t),_U(e,o,s),n||hZ(e,o,s)),a.style=a.style||{},o.fill!=null&&(a.style.fill=yD(a,"fill",o.fill,r)),o.stroke!=null&&(a.style.stroke=yD(a,"stroke",o.stroke,r)),R(["lineWidth","opacity","fillOpacity","strokeOpacity","miterLimit","fontSize"],function(l){o[l]!=null&&(a.style[l]=parseFloat(o[l]))}),R(["lineDashOffset","lineCap","lineJoin","fontWeight","fontFamily","fontStyle","textAlign"],function(l){o[l]!=null&&(a.style[l]=o[l])}),i&&(a.__selfStyle=s),o.lineDash&&(a.style.lineDash=ft(r0(o.lineDash),function(l){return parseFloat(l)})),(o.visibility==="hidden"||o.visibility==="collapse")&&(a.invisible=!0),o.display==="none"&&(a.ignore=!0)}function iZ(e,t){var r=t.__selfStyle;if(r){var n=r.textBaseline,i=n;!n||n==="auto"||n==="baseline"?i="alphabetic":n==="before-edge"||n==="text-before-edge"?i="top":n==="after-edge"||n==="text-after-edge"?i="bottom":(n==="central"||n==="mathematical")&&(i="middle"),e.style.textBaseline=i}var a=t.__inheritedStyle;if(a){var o=a.textAlign,s=o;o&&(o==="middle"&&(s="center"),e.style.textAlign=s)}}var aZ=/^url\(\s*#(.*?)\)/;function yD(e,t,r,n){var i=r&&r.match(aZ);if(i){var a=ha(i[1]);n.push([e,t,a]);return}return r==="none"&&(r=null),r}function oZ(e,t){for(var r=0;r<t.length;r++){var n=t[r];n[0].style[n[1]]=e[n[2]]}}var sZ=/-?([0-9]*\.)?[0-9]+([eE]-?[0-9]+)?/g;function r0(e){return e.match(sZ)||[]}var lZ=/(translate|scale|rotate|skewX|skewY|matrix)\(([\-\s0-9\.eE,]*)\)/g,Zy=Math.PI/180;function uZ(e,t){var r=e.getAttribute("transform");if(r){r=r.replace(/,/g," ");var n=[],i=null;r.replace(lZ,function(f,c,d){return n.push(c,d),""});for(var a=n.length-1;a>0;a-=2){var o=n[a],s=n[a-1],l=r0(o);switch(i=i||oi(),s){case"translate":qa(i,i,[parseFloat(l[0]),parseFloat(l[1]||"0")]);break;case"scale":$b(i,i,[parseFloat(l[0]),parseFloat(l[1]||l[0])]);break;case"rotate":Fu(i,i,-parseFloat(l[0])*Zy,[parseFloat(l[1]||"0"),parseFloat(l[2]||"0")]);break;case"skewX":var u=Math.tan(parseFloat(l[0])*Zy);wo(i,[1,0,u,1,0,0],i);break;case"skewY":var h=Math.tan(parseFloat(l[0])*Zy);wo(i,[1,h,0,1,0,0],i);break;case"matrix":i[0]=parseFloat(l[0]),i[1]=parseFloat(l[1]),i[2]=parseFloat(l[2]),i[3]=parseFloat(l[3]),i[4]=parseFloat(l[4]),i[5]=parseFloat(l[5]);break}}t.setLocalTransform(i)}}var xD=/([^\s:;]+)\s*:\s*([^:;]+)/g;function _U(e,t,r){var n=e.getAttribute("style");if(n){xD.lastIndex=0;for(var i;(i=xD.exec(n))!=null;){var a=i[1],o=Ft(Gm,a)?Gm[a]:null;o&&(t[o]=i[2]);var s=Ft(Vm,a)?Vm[a]:null;s&&(r[s]=i[2])}}}function hZ(e,t,r){for(var n=0;n<dD.length;n++){var i=dD[n],a=e.getAttribute(i);a!=null&&(t[Gm[i]]=a)}for(var n=0;n<vD.length;n++){var i=vD[n],a=e.getAttribute(i);a!=null&&(r[Vm[i]]=a)}}function yU(e,t){var r=t.width/e.width,n=t.height/e.height,i=Math.min(r,n);return{scale:i,x:-(e.x+e.width/2)*i+(t.x+t.width/2),y:-(e.y+e.height/2)*i+(t.y+t.height/2)}}function fZ(e,t){var r=new nZ;return r.parse(e,t)}var cZ=Ut(["rect","circle","line","ellipse","polygon","polyline","path","text","tspan","g"]),dZ=function(){function e(t,r){this.type="geoSVG",this._usedGraphicMap=Ut(),this._freedGraphics=[],this._mapName=t,this._parsedXML=mU(r)}return e.prototype.load=function(){var t=this._firstGraphic;if(!t){t=this._firstGraphic=this._buildGraphic(this._parsedXML),this._freedGraphics.push(t),this._boundingRect=this._firstGraphic.boundingRect.clone();var r=pZ(t.named),n=r.regions,i=r.regionsMap;this._regions=n,this._regionsMap=i}return{boundingRect:this._boundingRect,regions:this._regions,regionsMap:this._regionsMap}},e.prototype._buildGraphic=function(t){var r,n;try{r=t&&fZ(t,{ignoreViewBox:!0,ignoreRootClip:!0})||{},n=r.root,Hn(n!=null)}catch(g){throw new Error(`Invalid svg format
`+g.message)}var i=new re;i.add(n),i.isGeoSVGGraphicRoot=!0;var a=r.width,o=r.height,s=r.viewBoxRect,l=this._boundingRect;if(!l){var u=void 0,h=void 0,f=void 0,c=void 0;if(a!=null?(u=0,f=a):s&&(u=s.x,f=s.width),o!=null?(h=0,c=o):s&&(h=s.y,c=s.height),u==null||h==null){var d=n.getBoundingRect();u==null&&(u=d.x,f=d.width),h==null&&(h=d.y,c=d.height)}l=this._boundingRect=new fe(u,h,f,c)}if(s){var v=yU(s,l);n.scaleX=n.scaleY=v.scale,n.x=v.x,n.y=v.y}i.setClipPath(new Ae({shape:l.plain()}));var p=[];return R(r.named,function(g){cZ.get(g.svgNodeTagLower)!=null&&(p.push(g),vZ(g.el))}),{root:i,boundingRect:l,named:p}},e.prototype.useGraphic=function(t){var r=this._usedGraphicMap,n=r.get(t);return n||(n=this._freedGraphics.pop()||this._buildGraphic(this._parsedXML),r.set(t,n),n)},e.prototype.freeGraphic=function(t){var r=this._usedGraphicMap,n=r.get(t);n&&(r.removeKey(t),this._freedGraphics.push(n))},e}();function vZ(e){e.silent=!1,e.isGroup&&e.traverse(function(t){t.silent=!1})}function pZ(e){var t=[],r=Ut();return R(e,function(n){if(n.namedFrom==null){var i=new d9(n.name,n.el);t.push(i),r.set(n.name,i)}}),{regions:t,regionsMap:r}}var aT=[126,25],SD="南海诸岛",Fl=[[[0,3.5],[7,11.2],[15,11.9],[30,7],[42,.7],[52,.7],[56,7.7],[59,.7],[64,.7],[64,0],[5,0],[0,3.5]],[[13,16.1],[19,14.7],[16,21.7],[11,23.1],[13,16.1]],[[12,32.2],[14,38.5],[15,38.5],[13,32.2],[12,32.2]],[[16,47.6],[12,53.2],[13,53.2],[18,47.6],[16,47.6]],[[6,64.4],[8,70],[9,70],[8,64.4],[6,64.4]],[[23,82.6],[29,79.8],[30,79.8],[25,82.6],[23,82.6]],[[37,70.7],[43,62.3],[44,62.3],[39,70.7],[37,70.7]],[[48,51.1],[51,45.5],[53,45.5],[50,51.1],[48,51.1]],[[51,35],[51,28.7],[53,28.7],[53,35],[51,35]],[[52,22.4],[55,17.5],[56,17.5],[53,22.4],[52,22.4]],[[58,12.6],[62,7],[63,7],[60,12.6],[58,12.6]],[[0,3.5],[0,93.1],[64,93.1],[64,0],[63,0],[63,92.4],[1,92.4],[1,3.5],[0,3.5]]];for(var Sl=0;Sl<Fl.length;Sl++)for(var sh=0;sh<Fl[Sl].length;sh++)Fl[Sl][sh][0]/=10.5,Fl[Sl][sh][1]/=-10.5/.75,Fl[Sl][sh][0]+=aT[0],Fl[Sl][sh][1]+=aT[1];function gZ(e,t){if(e==="china"){for(var r=0;r<t.length;r++)if(t[r].name===SD)return;t.push(new cB(SD,ft(Fl,function(n){return{type:"polygon",exterior:n}}),aT))}}var mZ={南海诸岛:[32,80],广东:[0,-10],香港:[10,5],澳门:[-10,10],天津:[5,5]};function xU(e,t){if(e==="china"){var r=mZ[t.name];if(r){var n=t.getCenter();n[0]+=r[0]/10.5,n[1]+=-r[1]/(10.5/.75),t.setCenter(n)}}}var _Z=[[[123.45165252685547,25.73527164402261],[123.49731445312499,25.73527164402261],[123.49731445312499,25.750734064600884],[123.45165252685547,25.750734064600884],[123.45165252685547,25.73527164402261]]];function yZ(e,t){e==="china"&&t.name==="台湾"&&t.geometries.push({type:"polygon",exterior:_Z[0]})}var xZ="name",SZ=function(){function e(t,r,n){this.type="geoJSON",this._parsedMap=Ut(),this._mapName=t,this._specialAreas=n,this._geoJSON=bZ(r)}return e.prototype.load=function(t,r){r=r||xZ;var n=this._parsedMap.get(r);if(!n){var i=this._parseToRegions(r);n=this._parsedMap.set(r,{regions:i,boundingRect:TZ(i)})}var a=Ut(),o=[];return R(n.regions,function(s){var l=s.name;t&&Ft(t,l)&&(s=s.cloneShallow(l=t[l])),o.push(s),a.set(l,s)}),{regions:o,boundingRect:n.boundingRect||new fe(0,0,0,0),regionsMap:a}},e.prototype._parseToRegions=function(t){var r=this._mapName,n=this._geoJSON,i;try{i=n?vB(n,t):[]}catch(a){throw new Error(`Invalid geoJson format
`+a.message)}return gZ(r,i),R(i,function(a){var o=a.name;xU(r,a),yZ(r,a);var s=this._specialAreas&&this._specialAreas[o];s&&a.transformTo(s.left,s.top,s.width,s.height)},this),i},e.prototype.getMapForUser=function(){return{geoJson:this._geoJSON,geoJSON:this._geoJSON,specialAreas:this._specialAreas}},e}();function TZ(e){for(var t,r=0;r<e.length;r++){var n=e[r].getBoundingRect();t=t||n.clone(),t.union(n)}return t}function bZ(e){return Ct(e)?typeof JSON<"u"&&JSON.parse?JSON.parse(e):new Function("return ("+e+");")():e}var Lc=Ut();const Bo={registerMap:function(e,t,r){if(t.svg){var n=new dZ(e,t.svg);Lc.set(e,n)}else{var i=t.geoJson||t.geoJSON;i&&!t.features?r=t.specialAreas:i=t;var n=new SZ(e,i,r);Lc.set(e,n)}},getGeoResource:function(e){return Lc.get(e)},getMapForUser:function(e){var t=Lc.get(e);return t&&t.type==="geoJSON"&&t.getMapForUser()},load:function(e,t,r){var n=Lc.get(e);if(n)return n.load(t,r)}};var sM=["rect","circle","line","ellipse","polygon","polyline","path"],wZ=Ut(sM),MZ=Ut(sM.concat(["g"])),AZ=Ut(sM.concat(["g"])),SU=Le();function Op(e){var t=e.getItemStyle(),r=e.get("areaColor");return r!=null&&(t.fill=r),t}function TD(e){var t=e.style;t&&(t.stroke=t.stroke||t.fill,t.fill=null)}var TU=function(){function e(t){var r=new re;this.uid=Vf("ec_map_draw"),this._controller=new Ov(t.getZr()),this._controllerHost={target:r},this.group=r,r.add(this._regionsGroup=new re),r.add(this._svgGroup=new re)}return e.prototype.draw=function(t,r,n,i,a){var o=t.mainType==="geo",s=t.getData&&t.getData();o&&r.eachComponent({mainType:"series",subType:"map"},function(m){!s&&m.getHostGeoModel()===t&&(s=m.getData())});var l=t.coordinateSystem,u=this._regionsGroup,h=this.group,f=l.getTransformInfo(),c=f.raw,d=f.roam,v=!u.childAt(0)||a;v?(h.x=d.x,h.y=d.y,h.scaleX=d.scaleX,h.scaleY=d.scaleY,h.dirty()):ke(h,d,t);var p=s&&s.getVisual("visualMeta")&&s.getVisual("visualMeta").length>0,g={api:n,geo:l,mapOrGeoModel:t,data:s,isVisualEncodedByVisualMap:p,isGeo:o,transformInfoRaw:c};l.resourceType==="geoJSON"?this._buildGeoJSON(g):l.resourceType==="geoSVG"&&this._buildSVG(g),this._updateController(t,r,n),this._updateMapSelectHandler(t,u,n,i)},e.prototype._buildGeoJSON=function(t){var r=this._regionsGroupByName=Ut(),n=Ut(),i=this._regionsGroup,a=t.transformInfoRaw,o=t.mapOrGeoModel,s=t.data,l=t.geo.projection,u=l&&l.stream;function h(d,v){return v&&(d=v(d)),d&&[d[0]*a.scaleX+a.x,d[1]*a.scaleY+a.y]}function f(d){for(var v=[],p=!u&&l&&l.project,g=0;g<d.length;++g){var m=h(d[g],p);m&&v.push(m)}return v}function c(d){return{shape:{points:f(d)}}}i.removeAll(),R(t.geo.regions,function(d){var v=d.name,p=r.get(v),g=n.get(v)||{},m=g.dataIdx,_=g.regionModel;if(!p){p=r.set(v,new re),i.add(p),m=s?s.indexOfName(v):null,_=t.isGeo?o.getRegionModel(v):s?s.getItemModel(m):null;var y=_.get("silent",!0);y!=null&&(p.silent=y),n.set(v,{dataIdx:m,regionModel:_})}var x=[],T=[];R(d.geometries,function(w){if(w.type==="polygon"){var b=[w.exterior].concat(w.interiors||[]);u&&(b=CD(b,u)),R(b,function(E){x.push(new Yn(c(E)))})}else{var A=w.points;u&&(A=CD(A,u,!0)),R(A,function(E){T.push(new $n(c(E)))})}});var S=h(d.getCenter(),l&&l.project);function M(w,b){if(w.length){var A=new fw({culling:!0,segmentIgnoreThreshold:1,shape:{paths:w}});p.add(A),bD(t,A,m,_),wD(t,A,v,_,o,m,S),b&&(TD(A),R(A.states,TD))}}M(x),M(T,!0)}),r.each(function(d,v){var p=n.get(v),g=p.dataIdx,m=p.regionModel;MD(t,d,v,m,o,g),AD(t,d,v,m,o),ED(t,d,v,m,o)},this)},e.prototype._buildSVG=function(t){var r=t.geo.map,n=t.transformInfoRaw;this._svgGroup.x=n.x,this._svgGroup.y=n.y,this._svgGroup.scaleX=n.scaleX,this._svgGroup.scaleY=n.scaleY,this._svgResourceChanged(r)&&(this._freeSVG(),this._useSVG(r));var i=this._svgDispatcherMap=Ut(),a=!1;R(this._svgGraphicRecord.named,function(o){var s=o.name,l=t.mapOrGeoModel,u=t.data,h=o.svgNodeTagLower,f=o.el,c=u?u.indexOfName(s):null,d=l.getRegionModel(s);wZ.get(h)!=null&&f instanceof Yi&&bD(t,f,c,d),f instanceof Yi&&(f.culling=!0);var v=d.get("silent",!0);if(v!=null&&(f.silent=v),f.z2EmphasisLift=0,!o.namedFrom&&(AZ.get(h)!=null&&wD(t,f,s,d,l,c,null),MD(t,f,s,d,l,c),AD(t,f,s,d,l),MZ.get(h)!=null)){var p=ED(t,f,s,d,l);p==="self"&&(a=!0);var g=i.get(s)||i.set(s,[]);g.push(f)}},this),this._enableBlurEntireSVG(a,t)},e.prototype._enableBlurEntireSVG=function(t,r){if(t&&r.isGeo){var n=r.mapOrGeoModel.getModel(["blur","itemStyle"]).getItemStyle(),i=n.opacity;this._svgGraphicRecord.root.traverse(function(a){if(!a.isGroup){wu(a);var o=a.ensureState("blur").style||{};o.opacity==null&&i!=null&&(o.opacity=i),a.ensureState("emphasis")}})}},e.prototype.remove=function(){this._regionsGroup.removeAll(),this._regionsGroupByName=null,this._svgGroup.removeAll(),this._freeSVG(),this._controller.dispose(),this._controllerHost=null},e.prototype.findHighDownDispatchers=function(t,r){if(t==null)return[];var n=r.coordinateSystem;if(n.resourceType==="geoJSON"){var i=this._regionsGroupByName;if(i){var a=i.get(t);return a?[a]:[]}}else if(n.resourceType==="geoSVG")return this._svgDispatcherMap&&this._svgDispatcherMap.get(t)||[]},e.prototype._svgResourceChanged=function(t){return this._svgMapName!==t},e.prototype._useSVG=function(t){var r=Bo.getGeoResource(t);if(r&&r.type==="geoSVG"){var n=r.useGraphic(this.uid);this._svgGroup.add(n.root),this._svgGraphicRecord=n,this._svgMapName=t}},e.prototype._freeSVG=function(){var t=this._svgMapName;if(t!=null){var r=Bo.getGeoResource(t);r&&r.type==="geoSVG"&&r.freeGraphic(this.uid),this._svgGraphicRecord=null,this._svgDispatcherMap=null,this._svgGroup.removeAll(),this._svgMapName=null}},e.prototype._updateController=function(t,r,n){var i=t.coordinateSystem,a=this._controller,o=this._controllerHost;o.zoomLimit=t.get("scaleLimit"),o.zoom=i.getZoom(),a.enable(t.get("roam")||!1);var s=t.mainType;function l(){var u={type:"geoRoam",componentType:s};return u[s+"Id"]=t.id,u}a.off("pan").on("pan",function(u){this._mouseDownFlag=!1,aM(o,u.dx,u.dy),n.dispatchAction(rt(l(),{dx:u.dx,dy:u.dy,animation:{duration:0}}))},this),a.off("zoom").on("zoom",function(u){this._mouseDownFlag=!1,oM(o,u.scale,u.originX,u.originY),n.dispatchAction(rt(l(),{totalZoom:o.zoom,zoom:u.scale,originX:u.originX,originY:u.originY,animation:{duration:0}}))},this),a.setPointerChecker(function(u,h,f){return i.containPoint([h,f])&&!e0(u,n,t)})},e.prototype.resetForLabelLayout=function(){this.group.traverse(function(t){var r=t.getTextContent();r&&(r.ignore=SU(r).ignore)})},e.prototype._updateMapSelectHandler=function(t,r,n,i){var a=this;r.off("mousedown"),r.off("click"),t.get("selectedMode")&&(r.on("mousedown",function(){a._mouseDownFlag=!0}),r.on("click",function(o){a._mouseDownFlag&&(a._mouseDownFlag=!1)}))},e}();function bD(e,t,r,n){var i=n.getModel("itemStyle"),a=n.getModel(["emphasis","itemStyle"]),o=n.getModel(["blur","itemStyle"]),s=n.getModel(["select","itemStyle"]),l=Op(i),u=Op(a),h=Op(s),f=Op(o),c=e.data;if(c){var d=c.getItemVisual(r,"style"),v=c.getItemVisual(r,"decal");e.isVisualEncodedByVisualMap&&d.fill&&(l.fill=d.fill),v&&(l.decal=df(v,e.api))}t.setStyle(l),t.style.strokeNoScale=!0,t.ensureState("emphasis").style=u,t.ensureState("select").style=h,t.ensureState("blur").style=f,wu(t)}function wD(e,t,r,n,i,a,o){var s=e.data,l=e.isGeo,u=s&&isNaN(s.get(s.mapDimension("value"),a)),h=s&&s.getItemLayout(a);if(l||u||h&&h.showLabel){var f=l?r:a,c=void 0;(!s||a>=0)&&(c=i);var d=o?{normal:{align:"center",verticalAlign:"middle"}}:null;Sn(t,an(n),{labelFetcher:c,labelDataIndex:f,defaultText:r},d);var v=t.getTextContent();if(v&&(SU(v).ignore=v.ignore,t.textConfig&&o)){var p=t.getBoundingRect().clone();t.textConfig.layoutRect=p,t.textConfig.position=[(o[0]-p.x)/p.width*100+"%",(o[1]-p.y)/p.height*100+"%"]}t.disableLabelAnimation=!0}else t.removeTextContent(),t.removeTextConfig(),t.disableLabelAnimation=null}function MD(e,t,r,n,i,a){e.data?e.data.setItemGraphicEl(a,t):oe(t).eventData={componentType:"geo",componentIndex:i.componentIndex,geoIndex:i.componentIndex,name:r,region:n&&n.option||{}}}function AD(e,t,r,n,i){e.data||Uu({el:t,componentModel:i,itemName:r,itemTooltipOption:n.get("tooltip")})}function ED(e,t,r,n,i){t.highDownSilentOnTouch=!!i.get("selectedMode");var a=n.getModel("emphasis"),o=a.get("focus");return Sr(t,o,a.get("blurScope"),a.get("disabled")),e.isGeo&&LH(t,i,r),o}function CD(e,t,r){var n=[],i;function a(){i=[]}function o(){i.length&&(n.push(i),i=[])}var s=t({polygonStart:a,polygonEnd:o,lineStart:a,lineEnd:o,point:function(l,u){isFinite(l)&&isFinite(u)&&i.push([l,u])},sphere:function(){}});return!r&&s.polygonStart(),R(e,function(l){s.lineStart();for(var u=0;u<l.length;u++)s.point(l[u][0],l[u][1]);s.lineEnd()}),!r&&s.polygonEnd(),n}var EZ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i,a){if(!(a&&a.type==="mapToggleSelect"&&a.from===this.uid)){var o=this.group;if(o.removeAll(),!r.getHostGeoModel()){if(this._mapDraw&&a&&a.type==="geoRoam"&&this._mapDraw.resetForLabelLayout(),a&&a.type==="geoRoam"&&a.componentType==="series"&&a.seriesId===r.id){var s=this._mapDraw;s&&o.add(s.group)}else if(r.needsDrawMap){var s=this._mapDraw||new TU(i);o.add(s.group),s.draw(r,n,i,this,a),this._mapDraw=s}else this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;r.get("showLegendSymbol")&&n.getComponent("legend")&&this._renderSymbols(r,n,i)}}},t.prototype.remove=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null,this.group.removeAll()},t.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null},t.prototype._renderSymbols=function(r,n,i){var a=r.originalData,o=this.group;a.each(a.mapDimension("value"),function(s,l){if(!isNaN(s)){var u=a.getItemLayout(l);if(!(!u||!u.point)){var h=u.point,f=u.offset,c=new Vo({style:{fill:r.getData().getVisual("style").fill},shape:{cx:h[0]+f*9,cy:h[1],r:3},silent:!0,z2:8+(f?0:zf+1)});if(!f){var d=r.mainSeries.getData(),v=a.getName(l),p=d.indexOfName(v),g=a.getItemModel(l),m=g.getModel("label"),_=d.getItemGraphicEl(p);Sn(c,an(g),{labelFetcher:{getFormattedLabel:function(y,x){return r.getFormattedLabel(p,x)}},defaultText:v}),c.disableLabelAnimation=!0,m.get("position")||c.setTextConfig({position:"bottom"}),_.onHoverStateChange=function(y){ym(c,y)}}o.add(c)}}})},t.type="map",t}(De),CZ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.needsDrawMap=!1,r.seriesGroup=[],r.getTooltipPosition=function(n){if(n!=null){var i=this.getData().getName(n),a=this.coordinateSystem,o=a.getRegion(i);return o&&a.dataToPoint(o.getCenter())}},r}return t.prototype.getInitialData=function(r){for(var n=Qf(this,{coordDimensions:["value"],encodeDefaulter:ue(Tw,this)}),i=Ut(),a=[],o=0,s=n.count();o<s;o++){var l=n.getName(o);i.set(l,o)}var u=Bo.load(this.getMapType(),this.option.nameMap,this.option.nameProperty);return R(u.regions,function(h){var f=h.name,c=i.get(f),d=h.properties&&h.properties.echartsStyle,v;c==null?(v={name:f},a.push(v)):v=n.getRawDataItem(c),d&&Ot(v,d)}),n.appendData(a),n},t.prototype.getHostGeoModel=function(){var r=this.option.geoIndex;return r!=null?this.ecModel.getComponent("geo",r):null},t.prototype.getMapType=function(){return(this.getHostGeoModel()||this).option.map},t.prototype.getRawValue=function(r){var n=this.getData();return n.get(n.mapDimension("value"),r)},t.prototype.getRegionModel=function(r){var n=this.getData();return n.getItemModel(n.indexOfName(r))},t.prototype.formatTooltip=function(r,n,i){for(var a=this.getData(),o=this.getRawValue(r),s=a.getName(r),l=this.seriesGroup,u=[],h=0;h<l.length;h++){var f=l[h].originalData.indexOfName(s),c=a.mapDimension("value");isNaN(l[h].originalData.get(c,f))||u.push(l[h].name)}return on("section",{header:u.join(", "),noHeader:!u.length,blocks:[on("nameValue",{name:s,value:o})]})},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.getLegendIcon=function(r){var n=r.icon||"roundRect",i=Pr(n,0,0,r.itemWidth,r.itemHeight,r.itemStyle.fill);return i.setStyle(r.itemStyle),i.style.stroke="none",n.indexOf("empty")>-1&&(i.style.stroke=i.style.fill,i.style.fill="#fff",i.style.lineWidth=2),i},t.type="series.map",t.dependencies=["geo"],t.layoutMode="box",t.defaultOption={z:2,coordinateSystem:"geo",map:"",left:"center",top:"center",aspectScale:null,showLegendSymbol:!0,boundingCoords:null,center:null,zoom:1,scaleLimit:null,selectedMode:!0,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444",areaColor:"#eee"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{areaColor:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},nameProperty:"name"},t}(Ue);function DZ(e,t){var r={};return R(e,function(n){n.each(n.mapDimension("value"),function(i,a){var o="ec-"+n.getName(a);r[o]=r[o]||[],isNaN(i)||r[o].push(i)})}),e[0].map(e[0].mapDimension("value"),function(n,i){for(var a="ec-"+e[0].getName(i),o=0,s=1/0,l=-1/0,u=r[a].length,h=0;h<u;h++)s=Math.min(s,r[a][h]),l=Math.max(l,r[a][h]),o+=r[a][h];var f;return t==="min"?f=s:t==="max"?f=l:t==="average"?f=o/u:f=o,u===0?NaN:f})}function LZ(e){var t={};e.eachSeriesByType("map",function(r){var n=r.getHostGeoModel(),i=n?"o"+n.id:"i"+r.getMapType();(t[i]=t[i]||[]).push(r)}),R(t,function(r,n){for(var i=DZ(ft(r,function(o){return o.getData()}),r[0].get("mapValueCalculation")),a=0;a<r.length;a++)r[a].originalData=r[a].getData();for(var a=0;a<r.length;a++)r[a].seriesGroup=r,r[a].needsDrawMap=a===0&&!r[a].getHostGeoModel(),r[a].setData(i.cloneShallow()),r[a].mainSeries=r[0]})}function RZ(e){var t={};e.eachSeriesByType("map",function(r){var n=r.getMapType();if(!(r.getHostGeoModel()||t[n])){var i={};R(r.seriesGroup,function(o){var s=o.coordinateSystem,l=o.originalData;o.get("showLegendSymbol")&&e.getComponent("legend")&&l.each(l.mapDimension("value"),function(u,h){var f=l.getName(h),c=s.getRegion(f);if(!(!c||isNaN(u))){var d=i[f]||0,v=s.dataToPoint(c.getCenter());i[f]=d+1,l.setItemLayout(h,{point:v,offset:d})}})});var a=r.getData();a.each(function(o){var s=a.getName(o),l=a.getItemLayout(o)||{};l.showLabel=!i[s],a.setItemLayout(o,l)}),t[n]=!0}})}var DD=en,Fv=function(e){q(t,e);function t(r){var n=e.call(this)||this;return n.type="view",n.dimensions=["x","y"],n._roamTransformable=new yo,n._rawTransformable=new yo,n.name=r,n}return t.prototype.setBoundingRect=function(r,n,i,a){return this._rect=new fe(r,n,i,a),this._rect},t.prototype.getBoundingRect=function(){return this._rect},t.prototype.setViewRect=function(r,n,i,a){this._transformTo(r,n,i,a),this._viewRect=new fe(r,n,i,a)},t.prototype._transformTo=function(r,n,i,a){var o=this.getBoundingRect(),s=this._rawTransformable;s.transform=o.calculateTransform(new fe(r,n,i,a));var l=s.parent;s.parent=null,s.decomposeTransform(),s.parent=l,this._updateTransform()},t.prototype.setCenter=function(r,n){r&&(this._center=[Tt(r[0],n.getWidth()),Tt(r[1],n.getHeight())],this._updateCenterAndZoom())},t.prototype.setZoom=function(r){r=r||1;var n=this.zoomLimit;n&&(n.max!=null&&(r=Math.min(n.max,r)),n.min!=null&&(r=Math.max(n.min,r))),this._zoom=r,this._updateCenterAndZoom()},t.prototype.getDefaultCenter=function(){var r=this.getBoundingRect(),n=r.x+r.width/2,i=r.y+r.height/2;return[n,i]},t.prototype.getCenter=function(){return this._center||this.getDefaultCenter()},t.prototype.getZoom=function(){return this._zoom||1},t.prototype.getRoamTransform=function(){return this._roamTransformable.getLocalTransform()},t.prototype._updateCenterAndZoom=function(){var r=this._rawTransformable.getLocalTransform(),n=this._roamTransformable,i=this.getDefaultCenter(),a=this.getCenter(),o=this.getZoom();a=en([],a,r),i=en([],i,r),n.originX=a[0],n.originY=a[1],n.x=i[0]-a[0],n.y=i[1]-a[1],n.scaleX=n.scaleY=o,this._updateTransform()},t.prototype._updateTransform=function(){var r=this._roamTransformable,n=this._rawTransformable;n.parent=r,r.updateTransform(),n.updateTransform(),qb(this.transform||(this.transform=[]),n.transform||oi()),this._rawTransform=n.getLocalTransform(),this.invTransform=this.invTransform||[],Bu(this.invTransform,this.transform),this.decomposeTransform()},t.prototype.getTransformInfo=function(){var r=this._rawTransformable,n=this._roamTransformable,i=new yo;return i.transform=n.transform,i.decomposeTransform(),{roam:{x:i.x,y:i.y,scaleX:i.scaleX,scaleY:i.scaleY},raw:{x:r.x,y:r.y,scaleX:r.scaleX,scaleY:r.scaleY}}},t.prototype.getViewRect=function(){return this._viewRect},t.prototype.getViewRectAfterRoam=function(){var r=this.getBoundingRect().clone();return r.applyTransform(this.transform),r},t.prototype.dataToPoint=function(r,n,i){var a=n?this._rawTransform:this.transform;return i=i||[],a?DD(i,r,a):On(i,r)},t.prototype.pointToData=function(r){var n=this.invTransform;return n?DD([],r,n):[r[0],r[1]]},t.prototype.convertToPixel=function(r,n,i){var a=LD(n);return a===this?a.dataToPoint(i):null},t.prototype.convertFromPixel=function(r,n,i){var a=LD(n);return a===this?a.pointToData(i):null},t.prototype.containPoint=function(r){return this.getViewRectAfterRoam().contain(r[0],r[1])},t.dimensions=["x","y"],t}(yo);function LD(e){var t=e.seriesModel;return t?t.coordinateSystem:null}var PZ={geoJSON:{aspectScale:.75,invertLongitute:!0},geoSVG:{aspectScale:1,invertLongitute:!1}},bU=["lng","lat"],oT=function(e){q(t,e);function t(r,n,i){var a=e.call(this,r)||this;a.dimensions=bU,a.type="geo",a._nameCoordMap=Ut(),a.map=n;var o=i.projection,s=Bo.load(n,i.nameMap,i.nameProperty),l=Bo.getGeoResource(n);a.resourceType=l?l.type:null;var u=a.regions=s.regions,h=PZ[l.type];a._regionsMap=s.regionsMap,a.regions=s.regions,a.projection=o;var f;if(o)for(var c=0;c<u.length;c++){var d=u[c].getBoundingRect(o);f=f||d.clone(),f.union(d)}else f=s.boundingRect;return a.setBoundingRect(f.x,f.y,f.width,f.height),a.aspectScale=o?1:se(i.aspectScale,h.aspectScale),a._invertLongitute=o?!1:h.invertLongitute,a}return t.prototype._transformTo=function(r,n,i,a){var o=this.getBoundingRect(),s=this._invertLongitute;o=o.clone(),s&&(o.y=-o.y-o.height);var l=this._rawTransformable;l.transform=o.calculateTransform(new fe(r,n,i,a));var u=l.parent;l.parent=null,l.decomposeTransform(),l.parent=u,s&&(l.scaleY=-l.scaleY),this._updateTransform()},t.prototype.getRegion=function(r){return this._regionsMap.get(r)},t.prototype.getRegionByCoord=function(r){for(var n=this.regions,i=0;i<n.length;i++){var a=n[i];if(a.type==="geoJSON"&&a.contain(r))return n[i]}},t.prototype.addGeoCoord=function(r,n){this._nameCoordMap.set(r,n)},t.prototype.getGeoCoord=function(r){var n=this._regionsMap.get(r);return this._nameCoordMap.get(r)||n&&n.getCenter()},t.prototype.dataToPoint=function(r,n,i){if(Ct(r)&&(r=this.getGeoCoord(r)),r){var a=this.projection;return a&&(r=a.project(r)),r&&this.projectedToPoint(r,n,i)}},t.prototype.pointToData=function(r){var n=this.projection;return n&&(r=n.unproject(r)),r&&this.pointToProjected(r)},t.prototype.pointToProjected=function(r){return e.prototype.pointToData.call(this,r)},t.prototype.projectedToPoint=function(r,n,i){return e.prototype.dataToPoint.call(this,r,n,i)},t.prototype.convertToPixel=function(r,n,i){var a=RD(n);return a===this?a.dataToPoint(i):null},t.prototype.convertFromPixel=function(r,n,i){var a=RD(n);return a===this?a.pointToData(i):null},t}(Fv);Nr(oT,Fv);function RD(e){var t=e.geoModel,r=e.seriesModel;return t?t.coordinateSystem:r?r.coordinateSystem||(r.getReferringComponents("geo",zr).models[0]||{}).coordinateSystem:null}function PD(e,t){var r=e.get("boundingCoords");if(r!=null){var n=r[0],i=r[1];if(isFinite(n[0])&&isFinite(n[1])&&isFinite(i[0])&&isFinite(i[1])){var a=this.projection;if(a){var o=n[0],s=n[1],l=i[0],u=i[1];n=[1/0,1/0],i=[-1/0,-1/0];var h=function(S,M,w,b){for(var A=w-S,E=b-M,C=0;C<=100;C++){var D=C/100,L=a.project([S+A*D,M+E*D]);ms(n,n,L),_s(i,i,L)}};h(o,s,l,s),h(l,s,l,u),h(l,u,o,u),h(o,u,l,s)}this.setBoundingRect(n[0],n[1],i[0]-n[0],i[1]-n[1])}}var f=this.getBoundingRect(),c=e.get("layoutCenter"),d=e.get("layoutSize"),v=t.getWidth(),p=t.getHeight(),g=f.width/f.height*this.aspectScale,m=!1,_,y;c&&d&&(_=[Tt(c[0],v),Tt(c[1],p)],y=Tt(d,Math.min(v,p)),!isNaN(_[0])&&!isNaN(_[1])&&!isNaN(y)&&(m=!0));var x;if(m)x={},g>1?(x.width=y,x.height=y/g):(x.height=y,x.width=y*g),x.y=_[1]-x.height/2,x.x=_[0]-x.width/2;else{var T=e.getBoxLayoutParams();T.aspect=g,x=Mr(T,{width:v,height:p})}this.setViewRect(x.x,x.y,x.width,x.height),this.setCenter(e.get("center"),t),this.setZoom(e.get("zoom"))}function IZ(e,t){R(t.get("geoCoord"),function(r,n){e.addGeoCoord(n,r)})}var NZ=function(){function e(){this.dimensions=bU}return e.prototype.create=function(t,r){var n=[];function i(o){return{nameProperty:o.get("nameProperty"),aspectScale:o.get("aspectScale"),projection:o.get("projection")}}t.eachComponent("geo",function(o,s){var l=o.get("map"),u=new oT(l+s,l,rt({nameMap:o.get("nameMap")},i(o)));u.zoomLimit=o.get("scaleLimit"),n.push(u),o.coordinateSystem=u,u.model=o,u.resize=PD,u.resize(o,r)}),t.eachSeries(function(o){var s=o.get("coordinateSystem");if(s==="geo"){var l=o.get("geoIndex")||0;o.coordinateSystem=n[l]}});var a={};return t.eachSeriesByType("map",function(o){if(!o.getHostGeoModel()){var s=o.getMapType();a[s]=a[s]||[],a[s].push(o)}}),R(a,function(o,s){var l=ft(o,function(h){return h.get("nameMap")}),u=new oT(s,s,rt({nameMap:Hb(l)},i(o[0])));u.zoomLimit=pn.apply(null,ft(o,function(h){return h.get("scaleLimit")})),n.push(u),u.resize=PD,u.resize(o[0],r),R(o,function(h){h.coordinateSystem=u,IZ(u,h)})}),n},e.prototype.getFilledRegions=function(t,r,n,i){for(var a=(t||[]).slice(),o=Ut(),s=0;s<a.length;s++)o.set(a[s].name,a[s]);var l=Bo.load(r,n,i);return R(l.regions,function(u){var h=u.name,f=o.get(h),c=u.properties&&u.properties.echartsStyle;f||(f={name:h},a.push(f)),c&&Ot(f,c)}),a},e}(),wU=new NZ,OZ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n,i){var a=Bo.getGeoResource(r.map);if(a&&a.type==="geoJSON"){var o=r.itemStyle=r.itemStyle||{};"color"in o||(o.color="#eee")}this.mergeDefaultAndTheme(r,i),Su(r,"label",["show"])},t.prototype.optionUpdated=function(){var r=this,n=this.option;n.regions=wU.getFilledRegions(n.regions,n.map,n.nameMap,n.nameProperty);var i={};this._optionModelMap=ma(n.regions||[],function(a,o){var s=o.name;return s&&(a.set(s,new Ie(o,r,r.ecModel)),o.selected&&(i[s]=!0)),a},Ut()),n.selectedMap||(n.selectedMap=i)},t.prototype.getRegionModel=function(r){return this._optionModelMap.get(r)||new Ie(null,this,this.ecModel)},t.prototype.getFormattedLabel=function(r,n){var i=this.getRegionModel(r),a=n==="normal"?i.get(["label","formatter"]):i.get(["emphasis","label","formatter"]),o={name:r};if(Yt(a))return o.status=n,a(o);if(Ct(a))return a.replace("{a}",r??"")},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.select=function(r){var n=this.option,i=n.selectedMode;if(i){i!=="multiple"&&(n.selectedMap=null);var a=n.selectedMap||(n.selectedMap={});a[r]=!0}},t.prototype.unSelect=function(r){var n=this.option.selectedMap;n&&(n[r]=!1)},t.prototype.toggleSelected=function(r){this[this.isSelected(r)?"unSelect":"select"](r)},t.prototype.isSelected=function(r){var n=this.option.selectedMap;return!!(n&&n[r])},t.type="geo",t.layoutMode="box",t.defaultOption={z:0,show:!0,left:"center",top:"center",aspectScale:null,silent:!1,map:"",boundingCoords:null,center:null,zoom:1,scaleLimit:null,label:{show:!1,color:"#000"},itemStyle:{borderWidth:.5,borderColor:"#444"},emphasis:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},select:{label:{show:!0,color:"rgb(100,0,0)"},itemStyle:{color:"rgba(255,215,0,0.8)"}},regions:[]},t}(me);function ID(e,t){return e.pointToProjected?e.pointToProjected(t):e.pointToData(t)}function lM(e,t,r,n){var i=e.getZoom(),a=e.getCenter(),o=t.zoom,s=e.projectedToPoint?e.projectedToPoint(a):e.dataToPoint(a);if(t.dx!=null&&t.dy!=null&&(s[0]-=t.dx,s[1]-=t.dy,e.setCenter(ID(e,s),n)),o!=null){if(r){var l=r.min||0,u=r.max||1/0;o=Math.max(Math.min(i*o,u),l)/i}e.scaleX*=o,e.scaleY*=o;var h=(t.originX-e.x)*(o-1),f=(t.originY-e.y)*(o-1);e.x-=h,e.y-=f,e.updateTransform(),e.setCenter(ID(e,s),n),e.setZoom(o*i)}return{center:e.getCenter(),zoom:e.getZoom()}}var FZ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.focusBlurEnabled=!0,r}return t.prototype.init=function(r,n){this._api=n},t.prototype.render=function(r,n,i,a){if(this._model=r,!r.get("show")){this._mapDraw&&this._mapDraw.remove(),this._mapDraw=null;return}this._mapDraw||(this._mapDraw=new TU(i));var o=this._mapDraw;o.draw(r,n,i,this,a),o.group.on("click",this._handleRegionClick,this),o.group.silent=r.get("silent"),this.group.add(o.group),this.updateSelectStatus(r,n,i)},t.prototype._handleRegionClick=function(r){var n;Ql(r.target,function(i){return(n=oe(i).eventData)!=null},!0),n&&this._api.dispatchAction({type:"geoToggleSelect",geoId:this._model.id,name:n.name})},t.prototype.updateSelectStatus=function(r,n,i){var a=this;this._mapDraw.group.traverse(function(o){var s=oe(o).eventData;if(s)return a._model.isSelected(s.name)?i.enterSelect(o):i.leaveSelect(o),!0})},t.prototype.findHighDownDispatchers=function(r){return this._mapDraw&&this._mapDraw.findHighDownDispatchers(r,this._model)},t.prototype.dispose=function(){this._mapDraw&&this._mapDraw.remove()},t.type="geo",t}(nr);function BZ(e,t,r){Bo.registerMap(e,t,r)}function MU(e){e.registerCoordinateSystem("geo",wU),e.registerComponentModel(OZ),e.registerComponentView(FZ),e.registerImpl("registerMap",BZ),e.registerImpl("getMap",function(r){return Bo.getMapForUser(r)});function t(r,n){n.update="geo:updateSelectStatus",e.registerAction(n,function(i,a){var o={},s=[];return a.eachComponent({mainType:"geo",query:i},function(l){l[r](i.name);var u=l.coordinateSystem;R(u.regions,function(f){o[f.name]=l.isSelected(f.name)||!1});var h=[];R(o,function(f,c){o[c]&&h.push(c)}),s.push({geoIndex:l.componentIndex,name:h})}),{selected:o,allSelected:s,name:i.name}})}t("toggleSelected",{type:"geoToggleSelect",event:"geoselectchanged"}),t("select",{type:"geoSelect",event:"geoselected"}),t("unSelect",{type:"geoUnSelect",event:"geounselected"}),e.registerAction({type:"geoRoam",event:"geoRoam",update:"updateTransform"},function(r,n,i){var a=r.componentType||"series";n.eachComponent({mainType:a,query:r},function(o){var s=o.coordinateSystem;if(s.type==="geo"){var l=lM(s,r,o.get("scaleLimit"),i);o.setCenter&&o.setCenter(l.center),o.setZoom&&o.setZoom(l.zoom),a==="series"&&R(o.seriesGroup,function(u){u.setCenter(l.center),u.setZoom(l.zoom)})}})})}function UZ(e){te(MU),e.registerChartView(EZ),e.registerSeriesModel(CZ),e.registerLayout(RZ),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,LZ),xF("map",e.registerAction)}function zZ(e){var t=e;t.hierNode={defaultAncestor:null,ancestor:t,prelim:0,modifier:0,change:0,shift:0,i:0,thread:null};for(var r=[t],n,i;n=r.pop();)if(i=n.children,n.isExpand&&i.length)for(var a=i.length,o=a-1;o>=0;o--){var s=i[o];s.hierNode={defaultAncestor:null,ancestor:s,prelim:0,modifier:0,change:0,shift:0,i:o,thread:null},r.push(s)}}function kZ(e,t){var r=e.isExpand?e.children:[],n=e.parentNode.children,i=e.hierNode.i?n[e.hierNode.i-1]:null;if(r.length){HZ(e);var a=(r[0].hierNode.prelim+r[r.length-1].hierNode.prelim)/2;i?(e.hierNode.prelim=i.hierNode.prelim+t(e,i),e.hierNode.modifier=e.hierNode.prelim-a):e.hierNode.prelim=a}else i&&(e.hierNode.prelim=i.hierNode.prelim+t(e,i));e.parentNode.hierNode.defaultAncestor=WZ(e,i,e.parentNode.hierNode.defaultAncestor||n[0],t)}function GZ(e){var t=e.hierNode.prelim+e.parentNode.hierNode.modifier;e.setLayout({x:t},!0),e.hierNode.modifier+=e.parentNode.hierNode.modifier}function ND(e){return arguments.length?e:ZZ}function od(e,t){return e-=Math.PI/2,{x:t*Math.cos(e),y:t*Math.sin(e)}}function VZ(e,t){return Mr(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function HZ(e){for(var t=e.children,r=t.length,n=0,i=0;--r>=0;){var a=t[r];a.hierNode.prelim+=n,a.hierNode.modifier+=n,i+=a.hierNode.change,n+=a.hierNode.shift+i}}function WZ(e,t,r,n){if(t){for(var i=e,a=e,o=a.parentNode.children[0],s=t,l=i.hierNode.modifier,u=a.hierNode.modifier,h=o.hierNode.modifier,f=s.hierNode.modifier;s=qy(s),a=$y(a),s&&a;){i=qy(i),o=$y(o),i.hierNode.ancestor=e;var c=s.hierNode.prelim+f-a.hierNode.prelim-u+n(s,a);c>0&&(YZ(XZ(s,e,r),e,c),u+=c,l+=c),f+=s.hierNode.modifier,u+=a.hierNode.modifier,l+=i.hierNode.modifier,h+=o.hierNode.modifier}s&&!qy(i)&&(i.hierNode.thread=s,i.hierNode.modifier+=f-l),a&&!$y(o)&&(o.hierNode.thread=a,o.hierNode.modifier+=u-h,r=e)}return r}function qy(e){var t=e.children;return t.length&&e.isExpand?t[t.length-1]:e.hierNode.thread}function $y(e){var t=e.children;return t.length&&e.isExpand?t[0]:e.hierNode.thread}function XZ(e,t,r){return e.hierNode.ancestor.parentNode===t.parentNode?e.hierNode.ancestor:r}function YZ(e,t,r){var n=r/(t.hierNode.i-e.hierNode.i);t.hierNode.change-=n,t.hierNode.shift+=r,t.hierNode.modifier+=r,t.hierNode.prelim+=r,e.hierNode.change+=n}function ZZ(e,t){return e.parentNode===t.parentNode?1:2}var qZ=function(){function e(){this.parentPoint=[],this.childPoints=[]}return e}(),$Z=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new qZ},t.prototype.buildPath=function(r,n){var i=n.childPoints,a=i.length,o=n.parentPoint,s=i[0],l=i[a-1];if(a===1){r.moveTo(o[0],o[1]),r.lineTo(s[0],s[1]);return}var u=n.orient,h=u==="TB"||u==="BT"?0:1,f=1-h,c=Tt(n.forkPosition,1),d=[];d[h]=o[h],d[f]=o[f]+(l[f]-o[f])*c,r.moveTo(o[0],o[1]),r.lineTo(d[0],d[1]),r.moveTo(s[0],s[1]),d[h]=s[h],r.lineTo(d[0],d[1]),d[h]=l[h],r.lineTo(d[0],d[1]),r.lineTo(l[0],l[1]);for(var v=1;v<a-1;v++){var p=i[v];r.moveTo(p[0],p[1]),d[h]=p[h],r.lineTo(d[0],d[1])}},t}(_e),KZ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._mainGroup=new re,r}return t.prototype.init=function(r,n){this._controller=new Ov(n.getZr()),this._controllerHost={target:this.group},this.group.add(this._mainGroup)},t.prototype.render=function(r,n,i){var a=r.getData(),o=r.layoutInfo,s=this._mainGroup,l=r.get("layout");l==="radial"?(s.x=o.x+o.width/2,s.y=o.y+o.height/2):(s.x=o.x,s.y=o.y),this._updateViewCoordSys(r,i),this._updateController(r,n,i);var u=this._data;a.diff(u).add(function(h){OD(a,h)&&FD(a,h,null,s,r)}).update(function(h,f){var c=u.getItemGraphicEl(f);if(!OD(a,h)){c&&UD(u,f,c,s,r);return}FD(a,h,c,s,r)}).remove(function(h){var f=u.getItemGraphicEl(h);f&&UD(u,h,f,s,r)}).execute(),this._nodeScaleRatio=r.get("nodeScaleRatio"),this._updateNodeAndLinkScale(r),r.get("expandAndCollapse")===!0&&a.eachItemGraphicEl(function(h,f){h.off("click").on("click",function(){i.dispatchAction({type:"treeExpandAndCollapse",seriesId:r.id,dataIndex:f})})}),this._data=a},t.prototype._updateViewCoordSys=function(r,n){var i=r.getData(),a=[];i.each(function(f){var c=i.getItemLayout(f);c&&!isNaN(c.x)&&!isNaN(c.y)&&a.push([+c.x,+c.y])});var o=[],s=[];R_(a,o,s);var l=this._min,u=this._max;s[0]-o[0]===0&&(o[0]=l?l[0]:o[0]-1,s[0]=u?u[0]:s[0]+1),s[1]-o[1]===0&&(o[1]=l?l[1]:o[1]-1,s[1]=u?u[1]:s[1]+1);var h=r.coordinateSystem=new Fv;h.zoomLimit=r.get("scaleLimit"),h.setBoundingRect(o[0],o[1],s[0]-o[0],s[1]-o[1]),h.setCenter(r.get("center"),n),h.setZoom(r.get("zoom")),this.group.attr({x:h.x,y:h.y,scaleX:h.scaleX,scaleY:h.scaleY}),this._min=o,this._max=s},t.prototype._updateController=function(r,n,i){var a=this,o=this._controller,s=this._controllerHost,l=this.group;o.setPointerChecker(function(u,h,f){var c=l.getBoundingRect();return c.applyTransform(l.transform),c.contain(h,f)&&!e0(u,i,r)}),o.enable(r.get("roam")),s.zoomLimit=r.get("scaleLimit"),s.zoom=r.coordinateSystem.getZoom(),o.off("pan").off("zoom").on("pan",function(u){aM(s,u.dx,u.dy),i.dispatchAction({seriesId:r.id,type:"treeRoam",dx:u.dx,dy:u.dy})}).on("zoom",function(u){oM(s,u.scale,u.originX,u.originY),i.dispatchAction({seriesId:r.id,type:"treeRoam",zoom:u.scale,originX:u.originX,originY:u.originY}),a._updateNodeAndLinkScale(r),i.updateLabelLayout()})},t.prototype._updateNodeAndLinkScale=function(r){var n=r.getData(),i=this._getNodeGlobalScale(r);n.eachItemGraphicEl(function(a,o){a.setSymbolScale(i)})},t.prototype._getNodeGlobalScale=function(r){var n=r.coordinateSystem;if(n.type!=="view")return 1;var i=this._nodeScaleRatio,a=n.scaleX||1,o=n.getZoom(),s=(o-1)*i+1;return s/a},t.prototype.dispose=function(){this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype.remove=function(){this._mainGroup.removeAll(),this._data=null},t.type="tree",t}(De);function OD(e,t){var r=e.getItemLayout(t);return r&&!isNaN(r.x)&&!isNaN(r.y)}function FD(e,t,r,n,i){var a=!r,o=e.tree.getNodeByDataIndex(t),s=o.getModel(),l=o.getVisual("style").fill,u=o.isExpand===!1&&o.children.length!==0?l:"#fff",h=e.tree.root,f=o.parentNode===h?o:o.parentNode||o,c=e.getItemGraphicEl(f.dataIndex),d=f.getLayout(),v=c?{x:c.__oldX,y:c.__oldY,rawX:c.__radialOldRawX,rawY:c.__radialOldRawY}:d,p=o.getLayout();a?(r=new Dv(e,t,null,{symbolInnerColor:u,useNameLabel:!0}),r.x=v.x,r.y=v.y):r.updateData(e,t,null,{symbolInnerColor:u,useNameLabel:!0}),r.__radialOldRawX=r.__radialRawX,r.__radialOldRawY=r.__radialRawY,r.__radialRawX=p.rawX,r.__radialRawY=p.rawY,n.add(r),e.setItemGraphicEl(t,r),r.__oldX=r.x,r.__oldY=r.y,ke(r,{x:p.x,y:p.y},i);var g=r.getSymbolPath();if(i.get("layout")==="radial"){var m=h.children[0],_=m.getLayout(),y=m.children.length,x=void 0,T=void 0;if(p.x===_.x&&o.isExpand===!0&&m.children.length){var S={x:(m.children[0].getLayout().x+m.children[y-1].getLayout().x)/2,y:(m.children[0].getLayout().y+m.children[y-1].getLayout().y)/2};x=Math.atan2(S.y-_.y,S.x-_.x),x<0&&(x=Math.PI*2+x),T=S.x<_.x,T&&(x=x-Math.PI)}else x=Math.atan2(p.y-_.y,p.x-_.x),x<0&&(x=Math.PI*2+x),o.children.length===0||o.children.length!==0&&o.isExpand===!1?(T=p.x<_.x,T&&(x=x-Math.PI)):(T=p.x>_.x,T||(x=x-Math.PI));var M=T?"left":"right",w=s.getModel("label"),b=w.get("rotate"),A=b*(Math.PI/180),E=g.getTextContent();E&&(g.setTextConfig({position:w.get("position")||M,rotation:b==null?-x:A,origin:"center"}),E.setStyle("verticalAlign","middle"))}var C=s.get(["emphasis","focus"]),D=C==="relative"?yu(o.getAncestorsIndices(),o.getDescendantIndices()):C==="ancestor"?o.getAncestorsIndices():C==="descendant"?o.getDescendantIndices():null;D&&(oe(r).focus=D),jZ(i,o,h,r,v,d,p,n),r.__edge&&(r.onHoverStateChange=function(L){if(L!=="blur"){var P=o.parentNode&&e.getItemGraphicEl(o.parentNode.dataIndex);P&&P.hoverState===xv||ym(r.__edge,L)}})}function jZ(e,t,r,n,i,a,o,s){var l=t.getModel(),u=e.get("edgeShape"),h=e.get("layout"),f=e.getOrient(),c=e.get(["lineStyle","curveness"]),d=e.get("edgeForkPosition"),v=l.getModel("lineStyle").getLineStyle(),p=n.__edge;if(u==="curve")t.parentNode&&t.parentNode!==r&&(p||(p=n.__edge=new Tv({shape:sT(h,f,c,i,i)})),ke(p,{shape:sT(h,f,c,a,o)},e));else if(u==="polyline"&&h==="orthogonal"&&t!==r&&t.children&&t.children.length!==0&&t.isExpand===!0){for(var g=t.children,m=[],_=0;_<g.length;_++){var y=g[_].getLayout();m.push([y.x,y.y])}p||(p=n.__edge=new $Z({shape:{parentPoint:[o.x,o.y],childPoints:[[o.x,o.y]],orient:f,forkPosition:d}})),ke(p,{shape:{parentPoint:[o.x,o.y],childPoints:m}},e)}p&&!(u==="polyline"&&!t.isExpand)&&(p.useStyle(Vt({strokeNoScale:!0,fill:null},v)),xn(p,l,"lineStyle"),wu(p),s.add(p))}function BD(e,t,r,n,i){var a=t.tree.root,o=AU(a,e),s=o.source,l=o.sourceLayout,u=t.getItemGraphicEl(e.dataIndex);if(u){var h=t.getItemGraphicEl(s.dataIndex),f=h.__edge,c=u.__edge||(s.isExpand===!1||s.children.length===1?f:void 0),d=n.get("edgeShape"),v=n.get("layout"),p=n.get("orient"),g=n.get(["lineStyle","curveness"]);c&&(d==="curve"?Fs(c,{shape:sT(v,p,g,l,l),style:{opacity:0}},n,{cb:function(){r.remove(c)},removeOpt:i}):d==="polyline"&&n.get("layout")==="orthogonal"&&Fs(c,{shape:{parentPoint:[l.x,l.y],childPoints:[[l.x,l.y]]},style:{opacity:0}},n,{cb:function(){r.remove(c)},removeOpt:i}))}}function AU(e,t){for(var r=t.parentNode===e?t:t.parentNode||t,n;n=r.getLayout(),n==null;)r=r.parentNode===e?r:r.parentNode||r;return{source:r,sourceLayout:n}}function UD(e,t,r,n,i){var a=e.tree.getNodeByDataIndex(t),o=e.tree.root,s=AU(o,a).sourceLayout,l={duration:i.get("animationDurationUpdate"),easing:i.get("animationEasingUpdate")};Fs(r,{x:s.x+1,y:s.y+1},i,{cb:function(){n.remove(r),e.setItemGraphicEl(t,null)},removeOpt:l}),r.fadeOut(null,e.hostModel,{fadeLabel:!0,animation:l}),a.children.forEach(function(u){BD(u,e,n,i,l)}),BD(a,e,n,i,l)}function sT(e,t,r,n,i){var a,o,s,l,u,h,f,c;if(e==="radial"){u=n.rawX,f=n.rawY,h=i.rawX,c=i.rawY;var d=od(u,f),v=od(u,f+(c-f)*r),p=od(h,c+(f-c)*r),g=od(h,c);return{x1:d.x||0,y1:d.y||0,x2:g.x||0,y2:g.y||0,cpx1:v.x||0,cpy1:v.y||0,cpx2:p.x||0,cpy2:p.y||0}}else u=n.x,f=n.y,h=i.x,c=i.y,(t==="LR"||t==="RL")&&(a=u+(h-u)*r,o=f,s=h+(u-h)*r,l=c),(t==="TB"||t==="BT")&&(a=u,o=f+(c-f)*r,s=h,l=c+(f-c)*r);return{x1:u,y1:f,x2:h,y2:c,cpx1:a,cpy1:o,cpx2:s,cpy2:l}}var Gi=Le();function uM(e){var t=e.mainData,r=e.datas;r||(r={main:t},e.datasAttr={main:"data"}),e.datas=e.mainData=null,EU(t,r,e),R(r,function(n){R(t.TRANSFERABLE_METHODS,function(i){n.wrapMethod(i,ue(JZ,e))})}),t.wrapMethod("cloneShallow",ue(tq,e)),R(t.CHANGABLE_METHODS,function(n){t.wrapMethod(n,ue(QZ,e))}),Hn(r[t.dataType]===t)}function JZ(e,t){if(nq(this)){var r=rt({},Gi(this).datas);r[this.dataType]=t,EU(t,r,e)}else hM(t,this.dataType,Gi(this).mainData,e);return t}function QZ(e,t){return e.struct&&e.struct.update(),t}function tq(e,t){return R(Gi(t).datas,function(r,n){r!==t&&hM(r.cloneShallow(),n,t,e)}),t}function eq(e){var t=Gi(this).mainData;return e==null||t==null?t:Gi(t).datas[e]}function rq(){var e=Gi(this).mainData;return e==null?[{data:e}]:ft(be(Gi(e).datas),function(t){return{type:t,data:Gi(e).datas[t]}})}function nq(e){return Gi(e).mainData===e}function EU(e,t,r){Gi(e).datas={},R(t,function(n,i){hM(n,i,e,r)})}function hM(e,t,r,n){Gi(r).datas[t]=e,Gi(e).mainData=r,e.dataType=t,n.struct&&(e[n.structAttr]=n.struct,n.struct[n.datasAttr[t]]=e),e.getLinkedData=eq,e.getLinkedDataAll=rq}var iq=function(){function e(t,r){this.depth=0,this.height=0,this.dataIndex=-1,this.children=[],this.viewChildren=[],this.isExpand=!1,this.name=t||"",this.hostTree=r}return e.prototype.isRemoved=function(){return this.dataIndex<0},e.prototype.eachNode=function(t,r,n){Yt(t)&&(n=r,r=t,t=null),t=t||{},Ct(t)&&(t={order:t});var i=t.order||"preorder",a=this[t.attr||"children"],o;i==="preorder"&&(o=r.call(n,this));for(var s=0;!o&&s<a.length;s++)a[s].eachNode(t,r,n);i==="postorder"&&r.call(n,this)},e.prototype.updateDepthAndHeight=function(t){var r=0;this.depth=t;for(var n=0;n<this.children.length;n++){var i=this.children[n];i.updateDepthAndHeight(t+1),i.height>r&&(r=i.height)}this.height=r+1},e.prototype.getNodeById=function(t){if(this.getId()===t)return this;for(var r=0,n=this.children,i=n.length;r<i;r++){var a=n[r].getNodeById(t);if(a)return a}},e.prototype.contains=function(t){if(t===this)return!0;for(var r=0,n=this.children,i=n.length;r<i;r++){var a=n[r].contains(t);if(a)return a}},e.prototype.getAncestors=function(t){for(var r=[],n=t?this:this.parentNode;n;)r.push(n),n=n.parentNode;return r.reverse(),r},e.prototype.getAncestorsIndices=function(){for(var t=[],r=this;r;)t.push(r.dataIndex),r=r.parentNode;return t.reverse(),t},e.prototype.getDescendantIndices=function(){var t=[];return this.eachNode(function(r){t.push(r.dataIndex)}),t},e.prototype.getValue=function(t){var r=this.hostTree.data;return r.getStore().get(r.getDimensionIndex(t||"value"),this.dataIndex)},e.prototype.setLayout=function(t,r){this.dataIndex>=0&&this.hostTree.data.setItemLayout(this.dataIndex,t,r)},e.prototype.getLayout=function(){return this.hostTree.data.getItemLayout(this.dataIndex)},e.prototype.getModel=function(t){if(!(this.dataIndex<0)){var r=this.hostTree,n=r.data.getItemModel(this.dataIndex);return n.getModel(t)}},e.prototype.getLevelModel=function(){return(this.hostTree.levelModels||[])[this.depth]},e.prototype.setVisual=function(t,r){this.dataIndex>=0&&this.hostTree.data.setItemVisual(this.dataIndex,t,r)},e.prototype.getVisual=function(t){return this.hostTree.data.getItemVisual(this.dataIndex,t)},e.prototype.getRawIndex=function(){return this.hostTree.data.getRawIndex(this.dataIndex)},e.prototype.getId=function(){return this.hostTree.data.getId(this.dataIndex)},e.prototype.getChildIndex=function(){if(this.parentNode){for(var t=this.parentNode.children,r=0;r<t.length;++r)if(t[r]===this)return r;return-1}return-1},e.prototype.isAncestorOf=function(t){for(var r=t.parentNode;r;){if(r===this)return!0;r=r.parentNode}return!1},e.prototype.isDescendantOf=function(t){return t!==this&&t.isAncestorOf(this)},e}(),fM=function(){function e(t){this.type="tree",this._nodes=[],this.hostModel=t}return e.prototype.eachNode=function(t,r,n){this.root.eachNode(t,r,n)},e.prototype.getNodeByDataIndex=function(t){var r=this.data.getRawIndex(t);return this._nodes[r]},e.prototype.getNodeById=function(t){return this.root.getNodeById(t)},e.prototype.update=function(){for(var t=this.data,r=this._nodes,n=0,i=r.length;n<i;n++)r[n].dataIndex=-1;for(var n=0,i=t.count();n<i;n++)r[t.getRawIndex(n)].dataIndex=n},e.prototype.clearLayouts=function(){this.data.clearItemLayouts()},e.createTree=function(t,r,n){var i=new e(r),a=[],o=1;s(t);function s(h,f){var c=h.value;o=Math.max(o,at(c)?c.length:1),a.push(h);var d=new iq(Xr(h.name,""),i);f?aq(d,f):i.root=d,i._nodes.push(d);var v=h.children;if(v)for(var p=0;p<v.length;p++)s(v[p],d)}i.root.updateDepthAndHeight(0);var l=Kf(a,{coordDimensions:["value"],dimensionsCount:o}).dimensions,u=new xr(l,r);return u.initData(a),n&&n(u),uM({mainData:u,struct:i,structAttr:"tree"}),i.update(),i},e}();function aq(e,t){var r=t.children;e.parentNode!==t&&(r.push(e),e.parentNode=t)}function Qd(e,t,r){if(e&&pe(t,e.type)>=0){var n=r.getData().tree.root,i=e.targetNode;if(Ct(i)&&(i=n.getNodeById(i)),i&&n.contains(i))return{node:i};var a=e.targetNodeId;if(a!=null&&(i=n.getNodeById(a)))return{node:i}}}function CU(e){for(var t=[];e;)e=e.parentNode,e&&t.push(e);return t.reverse()}function cM(e,t){var r=CU(e);return pe(r,t)>=0}function n0(e,t){for(var r=[];e;){var n=e.dataIndex;r.push({name:e.name,dataIndex:n,value:t.getRawValue(n)}),e=e.parentNode}return r.reverse(),r}var oq=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.hasSymbolVisual=!0,r.ignoreStyleOnData=!0,r}return t.prototype.getInitialData=function(r){var n={name:r.name,children:r.data},i=r.leaves||{},a=new Ie(i,this,this.ecModel),o=fM.createTree(n,this,s);function s(f){f.wrapMethod("getItemModel",function(c,d){var v=o.getNodeByDataIndex(d);return v&&v.children.length&&v.isExpand||(c.parentModel=a),c})}var l=0;o.eachNode("preorder",function(f){f.depth>l&&(l=f.depth)});var u=r.expandAndCollapse,h=u&&r.initialTreeDepth>=0?r.initialTreeDepth:l;return o.root.eachNode("preorder",function(f){var c=f.hostTree.data.getRawDataItem(f.dataIndex);f.isExpand=c&&c.collapsed!=null?!c.collapsed:f.depth<=h}),o.data},t.prototype.getOrient=function(){var r=this.get("orient");return r==="horizontal"?r="LR":r==="vertical"&&(r="TB"),r},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.formatTooltip=function(r,n,i){for(var a=this.getData().tree,o=a.root.children[0],s=a.getNodeByDataIndex(r),l=s.getValue(),u=s.name;s&&s!==o;)u=s.parentNode.name+"."+u,s=s.parentNode;return on("nameValue",{name:u,value:l,noValue:isNaN(l)||l==null})},t.prototype.getDataParams=function(r){var n=e.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(r);return n.treeAncestors=n0(i,this),n.collapsed=!i.isExpand,n},t.type="series.tree",t.layoutMode="box",t.defaultOption={z:2,coordinateSystem:"view",left:"12%",top:"12%",right:"12%",bottom:"12%",layout:"orthogonal",edgeShape:"curve",edgeForkPosition:"50%",roam:!1,nodeScaleRatio:.4,center:null,zoom:1,orient:"LR",symbol:"emptyCircle",symbolSize:7,expandAndCollapse:!0,initialTreeDepth:2,lineStyle:{color:"#ccc",width:1.5,curveness:.5},itemStyle:{color:"lightsteelblue",borderWidth:1.5},label:{show:!0},animationEasing:"linear",animationDuration:700,animationDurationUpdate:500},t}(Ue);function sq(e,t,r){for(var n=[e],i=[],a;a=n.pop();)if(i.push(a),a.isExpand){var o=a.children;if(o.length)for(var s=0;s<o.length;s++)n.push(o[s])}for(;a=i.pop();)t(a,r)}function Rc(e,t){for(var r=[e],n;n=r.pop();)if(t(n),n.isExpand){var i=n.children;if(i.length)for(var a=i.length-1;a>=0;a--)r.push(i[a])}}function lq(e,t){e.eachSeriesByType("tree",function(r){uq(r,t)})}function uq(e,t){var r=VZ(e,t);e.layoutInfo=r;var n=e.get("layout"),i=0,a=0,o=null;n==="radial"?(i=2*Math.PI,a=Math.min(r.height,r.width)/2,o=ND(function(y,x){return(y.parentNode===x.parentNode?1:2)/y.depth})):(i=r.width,a=r.height,o=ND());var s=e.getData().tree.root,l=s.children[0];if(l){zZ(s),sq(l,kZ,o),s.hierNode.modifier=-l.hierNode.prelim,Rc(l,GZ);var u=l,h=l,f=l;Rc(l,function(y){var x=y.getLayout().x;x<u.getLayout().x&&(u=y),x>h.getLayout().x&&(h=y),y.depth>f.depth&&(f=y)});var c=u===h?1:o(u,h)/2,d=c-u.getLayout().x,v=0,p=0,g=0,m=0;if(n==="radial")v=i/(h.getLayout().x+c+d),p=a/(f.depth-1||1),Rc(l,function(y){g=(y.getLayout().x+d)*v,m=(y.depth-1)*p;var x=od(g,m);y.setLayout({x:x.x,y:x.y,rawX:g,rawY:m},!0)});else{var _=e.getOrient();_==="RL"||_==="LR"?(p=a/(h.getLayout().x+c+d),v=i/(f.depth-1||1),Rc(l,function(y){m=(y.getLayout().x+d)*p,g=_==="LR"?(y.depth-1)*v:i-(y.depth-1)*v,y.setLayout({x:g,y:m},!0)})):(_==="TB"||_==="BT")&&(v=i/(h.getLayout().x+c+d),p=a/(f.depth-1||1),Rc(l,function(y){g=(y.getLayout().x+d)*v,m=_==="TB"?(y.depth-1)*p:a-(y.depth-1)*p,y.setLayout({x:g,y:m},!0)}))}}}function hq(e){e.eachSeriesByType("tree",function(t){var r=t.getData(),n=r.tree;n.eachNode(function(i){var a=i.getModel(),o=a.getModel("itemStyle").getItemStyle(),s=r.ensureUniqueItemVisual(i.dataIndex,"style");rt(s,o)})})}function fq(e){e.registerAction({type:"treeExpandAndCollapse",event:"treeExpandAndCollapse",update:"update"},function(t,r){r.eachComponent({mainType:"series",subType:"tree",query:t},function(n){var i=t.dataIndex,a=n.getData().tree,o=a.getNodeByDataIndex(i);o.isExpand=!o.isExpand})}),e.registerAction({type:"treeRoam",event:"treeRoam",update:"none"},function(t,r,n){r.eachComponent({mainType:"series",subType:"tree",query:t},function(i){var a=i.coordinateSystem,o=lM(a,t,void 0,n);i.setCenter&&i.setCenter(o.center),i.setZoom&&i.setZoom(o.zoom)})})}function cq(e){e.registerChartView(KZ),e.registerSeriesModel(oq),e.registerLayout(lq),e.registerVisual(hq),fq(e)}var zD=["treemapZoomToNode","treemapRender","treemapMove"];function dq(e){for(var t=0;t<zD.length;t++)e.registerAction({type:zD[t],update:"updateView"},Rr);e.registerAction({type:"treemapRootToNode",update:"updateView"},function(r,n){n.eachComponent({mainType:"series",subType:"treemap",query:r},i);function i(a,o){var s=["treemapZoomToNode","treemapRootToNode"],l=Qd(r,s,a);if(l){var u=a.getViewRoot();u&&(r.direction=cM(u,l.node)?"rollUp":"drillDown"),a.resetViewRoot(l.node)}}})}function DU(e){var t=e.getData(),r=t.tree,n={};r.eachNode(function(i){for(var a=i;a&&a.depth>1;)a=a.parentNode;var o=OS(e.ecModel,a.name||a.dataIndex+"",n);i.setVisual("decal",o)})}var vq=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.preventUsingHoverLayer=!0,r}return t.prototype.getInitialData=function(r,n){var i={name:r.name,children:r.data};LU(i);var a=r.levels||[],o=this.designatedVisualItemStyle={},s=new Ie({itemStyle:o},this,n);a=r.levels=pq(a,n);var l=ft(a||[],function(f){return new Ie(f,s,n)},this),u=fM.createTree(i,this,h);function h(f){f.wrapMethod("getItemModel",function(c,d){var v=u.getNodeByDataIndex(d),p=v?l[v.depth]:null;return c.parentModel=p||s,c})}return u.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.formatTooltip=function(r,n,i){var a=this.getData(),o=this.getRawValue(r),s=a.getName(r);return on("nameValue",{name:s,value:o})},t.prototype.getDataParams=function(r){var n=e.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(r);return n.treeAncestors=n0(i,this),n.treePathInfo=n.treeAncestors,n},t.prototype.setLayoutInfo=function(r){this.layoutInfo=this.layoutInfo||{},rt(this.layoutInfo,r)},t.prototype.mapIdToIndex=function(r){var n=this._idIndexMap;n||(n=this._idIndexMap=Ut(),this._idIndexMapCount=0);var i=n.get(r);return i==null&&n.set(r,i=this._idIndexMapCount++),i},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(r){r?this._viewRoot=r:r=this._viewRoot;var n=this.getRawData().tree.root;(!r||r!==n&&!n.contains(r))&&(this._viewRoot=n)},t.prototype.enableAriaDecal=function(){DU(this)},t.type="series.treemap",t.layoutMode="box",t.defaultOption={progressive:0,left:"center",top:"middle",width:"80%",height:"80%",sort:!0,clipWindow:"origin",squareRatio:.5*(1+Math.sqrt(5)),leafDepth:null,drillDownIcon:"▶",zoomToNodeRatio:.32*.32,scaleLimit:null,roam:!0,nodeClick:"zoomToNode",animation:!0,animationDurationUpdate:900,animationEasing:"quinticInOut",breadcrumb:{show:!0,height:22,left:"center",top:"bottom",emptyItemWidth:25,itemStyle:{color:"rgba(0,0,0,0.7)",textStyle:{color:"#fff"}},emphasis:{itemStyle:{color:"rgba(0,0,0,0.9)"}}},label:{show:!0,distance:0,padding:5,position:"inside",color:"#fff",overflow:"truncate"},upperLabel:{show:!1,position:[0,"50%"],height:20,overflow:"truncate",verticalAlign:"middle"},itemStyle:{color:null,colorAlpha:null,colorSaturation:null,borderWidth:0,gapWidth:0,borderColor:"#fff",borderColorSaturation:null},emphasis:{upperLabel:{show:!0,position:[0,"50%"],overflow:"truncate",verticalAlign:"middle"}},visualDimension:0,visualMin:null,visualMax:null,color:[],colorAlpha:null,colorSaturation:null,colorMappingBy:"index",visibleMin:10,childrenVisibleMin:null,levels:[]},t}(Ue);function LU(e){var t=0;R(e.children,function(n){LU(n);var i=n.value;at(i)&&(i=i[0]),t+=i});var r=e.value;at(r)&&(r=r[0]),(r==null||isNaN(r))&&(r=t),r<0&&(r=0),at(e.value)?e.value[0]=r:e.value=r}function pq(e,t){var r=er(t.get("color")),n=er(t.get(["aria","decal","decals"]));if(r){e=e||[];var i,a;R(e,function(s){var l=new Ie(s),u=l.get("color"),h=l.get("decal");(l.get(["itemStyle","color"])||u&&u!=="none")&&(i=!0),(l.get(["itemStyle","decal"])||h&&h!=="none")&&(a=!0)});var o=e[0]||(e[0]={});return i||(o.color=r.slice()),!a&&n&&(o.decal=n.slice()),e}}var gq=8,kD=8,Ky=5,mq=function(){function e(t){this.group=new re,t.add(this.group)}return e.prototype.render=function(t,r,n,i){var a=t.getModel("breadcrumb"),o=this.group;if(o.removeAll(),!(!a.get("show")||!n)){var s=a.getModel("itemStyle"),l=a.getModel("emphasis"),u=s.getModel("textStyle"),h=l.getModel(["itemStyle","textStyle"]),f={pos:{left:a.get("left"),right:a.get("right"),top:a.get("top"),bottom:a.get("bottom")},box:{width:r.getWidth(),height:r.getHeight()},emptyItemWidth:a.get("emptyItemWidth"),totalWidth:0,renderList:[]};this._prepare(n,f,u),this._renderContent(t,f,s,l,u,h,i),W_(o,f.pos,f.box)}},e.prototype._prepare=function(t,r,n){for(var i=t;i;i=i.parentNode){var a=Xr(i.getModel().get("name"),""),o=n.getTextRect(a),s=Math.max(o.width+gq*2,r.emptyItemWidth);r.totalWidth+=s+kD,r.renderList.push({node:i,text:a,width:s})}},e.prototype._renderContent=function(t,r,n,i,a,o,s){for(var l=0,u=r.emptyItemWidth,h=t.get(["breadcrumb","height"]),f=PW(r.pos,r.box),c=r.totalWidth,d=r.renderList,v=i.getModel("itemStyle").getItemStyle(),p=d.length-1;p>=0;p--){var g=d[p],m=g.node,_=g.width,y=g.text;c>f.width&&(c-=_-u,_=u,y=null);var x=new Yn({shape:{points:_q(l,0,_,h,p===d.length-1,p===0)},style:Vt(n.getItemStyle(),{lineJoin:"bevel"}),textContent:new we({style:je(a,{text:y})}),textConfig:{position:"inside"},z2:zf*1e4,onclick:ue(s,m)});x.disableLabelAnimation=!0,x.getTextContent().ensureState("emphasis").style=je(o,{text:y}),x.ensureState("emphasis").style=v,Sr(x,i.get("focus"),i.get("blurScope"),i.get("disabled")),this.group.add(x),yq(x,t,m),l+=_+kD}},e.prototype.remove=function(){this.group.removeAll()},e}();function _q(e,t,r,n,i,a){var o=[[i?e:e-Ky,t],[e+r,t],[e+r,t+n],[i?e:e-Ky,t+n]];return!a&&o.splice(2,0,[e+r+Ky,t+n/2]),!i&&o.push([e,t+n/2]),o}function yq(e,t,r){oe(e).eventData={componentType:"series",componentSubType:"treemap",componentIndex:t.componentIndex,seriesIndex:t.seriesIndex,seriesName:t.name,seriesType:"treemap",selfType:"breadcrumb",nodeData:{dataIndex:r&&r.dataIndex,name:r&&r.name},treePathInfo:r&&n0(r,t)}}var xq=function(){function e(){this._storage=[],this._elExistsMap={}}return e.prototype.add=function(t,r,n,i,a){return this._elExistsMap[t.id]?!1:(this._elExistsMap[t.id]=!0,this._storage.push({el:t,target:r,duration:n,delay:i,easing:a}),!0)},e.prototype.finished=function(t){return this._finishedCallback=t,this},e.prototype.start=function(){for(var t=this,r=this._storage.length,n=function(){r--,r<=0&&(t._storage.length=0,t._elExistsMap={},t._finishedCallback&&t._finishedCallback())},i=0,a=this._storage.length;i<a;i++){var o=this._storage[i];o.el.animateTo(o.target,{duration:o.duration,delay:o.delay,easing:o.easing,setToFinal:!0,done:n,aborted:n})}return this},e}();function Sq(){return new xq}var lT=re,GD=Ae,VD=3,HD="label",WD="upperLabel",Tq=zf*10,bq=zf*2,wq=zf*3,Bl=bu([["fill","color"],["stroke","strokeColor"],["lineWidth","strokeWidth"],["shadowBlur"],["shadowOffsetX"],["shadowOffsetY"],["shadowColor"]]),XD=function(e){var t=Bl(e);return t.stroke=t.fill=t.lineWidth=null,t},Hm=Le(),Mq=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._state="ready",r._storage=Pc(),r}return t.prototype.render=function(r,n,i,a){var o=n.findComponents({mainType:"series",subType:"treemap",query:a});if(!(pe(o,r)<0)){this.seriesModel=r,this.api=i,this.ecModel=n;var s=["treemapZoomToNode","treemapRootToNode"],l=Qd(a,s,r),u=a&&a.type,h=r.layoutInfo,f=!this._oldTree,c=this._storage,d=u==="treemapRootToNode"&&l&&c?{rootNodeGroup:c.nodeGroup[l.node.getRawIndex()],direction:a.direction}:null,v=this._giveContainerGroup(h),p=r.get("animation"),g=this._doRender(v,r,d);p&&!f&&(!u||u==="treemapZoomToNode"||u==="treemapRootToNode")?this._doAnimation(v,g,r,d):g.renderFinally(),this._resetController(i),this._renderBreadcrumb(r,i,l)}},t.prototype._giveContainerGroup=function(r){var n=this._containerGroup;return n||(n=this._containerGroup=new lT,this._initEvents(n),this.group.add(n)),n.x=r.x,n.y=r.y,n},t.prototype._doRender=function(r,n,i){var a=n.getData().tree,o=this._oldTree,s=Pc(),l=Pc(),u=this._storage,h=[];function f(_,y,x,T){return Aq(n,l,u,i,s,h,_,y,x,T)}p(a.root?[a.root]:[],o&&o.root?[o.root]:[],r,a===o||!o,0);var c=g(u);if(this._oldTree=a,this._storage=l,this._controllerHost){var d=this.seriesModel.layoutInfo,v=a.root.getLayout();v.width===d.width&&v.height===d.height&&(this._controllerHost.zoom=1)}return{lastsForAnimation:s,willDeleteEls:c,renderFinally:m};function p(_,y,x,T,S){T?(y=_,R(_,function(b,A){!b.isRemoved()&&w(A,A)})):new No(y,_,M,M).add(w).update(w).remove(ue(w,null)).execute();function M(b){return b.getId()}function w(b,A){var E=b!=null?_[b]:null,C=A!=null?y[A]:null,D=f(E,C,x,S);D&&p(E&&E.viewChildren||[],C&&C.viewChildren||[],D,T,S+1)}}function g(_){var y=Pc();return _&&R(_,function(x,T){var S=y[T];R(x,function(M){M&&(S.push(M),Hm(M).willDelete=!0)})}),y}function m(){R(c,function(_){R(_,function(y){y.parent&&y.parent.remove(y)})}),R(h,function(_){_.invisible=!0,_.dirty()})}},t.prototype._doAnimation=function(r,n,i,a){var o=i.get("animationDurationUpdate"),s=i.get("animationEasing"),l=(Yt(o)?0:o)||0,u=(Yt(s)?null:s)||"cubicOut",h=Sq();R(n.willDeleteEls,function(f,c){R(f,function(d,v){if(!d.invisible){var p=d.parent,g,m=Hm(p);if(a&&a.direction==="drillDown")g=p===a.rootNodeGroup?{shape:{x:0,y:0,width:m.nodeWidth,height:m.nodeHeight},style:{opacity:0}}:{style:{opacity:0}};else{var _=0,y=0;m.willDelete||(_=m.nodeWidth/2,y=m.nodeHeight/2),g=c==="nodeGroup"?{x:_,y,style:{opacity:0}}:{shape:{x:_,y,width:0,height:0},style:{opacity:0}}}g&&h.add(d,g,l,0,u)}})}),R(this._storage,function(f,c){R(f,function(d,v){var p=n.lastsForAnimation[c][v],g={};p&&(d instanceof re?p.oldX!=null&&(g.x=d.x,g.y=d.y,d.x=p.oldX,d.y=p.oldY):(p.oldShape&&(g.shape=rt({},d.shape),d.setShape(p.oldShape)),p.fadein?(d.setStyle("opacity",0),g.style={opacity:1}):d.style.opacity!==1&&(g.style={opacity:1})),h.add(d,g,l,0,u))})},this),this._state="animating",h.finished(It(function(){this._state="ready",n.renderFinally()},this)).start()},t.prototype._resetController=function(r){var n=this._controller,i=this._controllerHost;i||(this._controllerHost={target:this.group},i=this._controllerHost),n||(n=this._controller=new Ov(r.getZr()),n.enable(this.seriesModel.get("roam")),i.zoomLimit=this.seriesModel.get("scaleLimit"),i.zoom=this.seriesModel.get("zoom"),n.on("pan",It(this._onPan,this)),n.on("zoom",It(this._onZoom,this)));var a=new fe(0,0,r.getWidth(),r.getHeight());n.setPointerChecker(function(o,s,l){return a.contain(s,l)})},t.prototype._clearController=function(){var r=this._controller;this._controllerHost=null,r&&(r.dispose(),r=null)},t.prototype._onPan=function(r){if(this._state!=="animating"&&(Math.abs(r.dx)>VD||Math.abs(r.dy)>VD)){var n=this.seriesModel.getData().tree.root;if(!n)return;var i=n.getLayout();if(!i)return;this.api.dispatchAction({type:"treemapMove",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:i.x+r.dx,y:i.y+r.dy,width:i.width,height:i.height}})}},t.prototype._onZoom=function(r){var n=r.originX,i=r.originY,a=r.scale;if(this._state!=="animating"){var o=this.seriesModel.getData().tree.root;if(!o)return;var s=o.getLayout();if(!s)return;var l=new fe(s.x,s.y,s.width,s.height),u=null,h=this._controllerHost;u=h.zoomLimit;var f=h.zoom=h.zoom||1;if(f*=a,u){var c=u.min||0,d=u.max||1/0;f=Math.max(Math.min(d,f),c)}var v=f/h.zoom;h.zoom=f;var p=this.seriesModel.layoutInfo;n-=p.x,i-=p.y;var g=oi();qa(g,g,[-n,-i]),$b(g,g,[v,v]),qa(g,g,[n,i]),l.applyTransform(g),this.api.dispatchAction({type:"treemapRender",from:this.uid,seriesId:this.seriesModel.id,rootRect:{x:l.x,y:l.y,width:l.width,height:l.height}})}},t.prototype._initEvents=function(r){var n=this;r.on("click",function(i){if(n._state==="ready"){var a=n.seriesModel.get("nodeClick",!0);if(a){var o=n.findTarget(i.offsetX,i.offsetY);if(o){var s=o.node;if(s.getLayout().isLeafRoot)n._rootToNode(o);else if(a==="zoomToNode")n._zoomToNode(o);else if(a==="link"){var l=s.hostTree.data.getItemModel(s.dataIndex),u=l.get("link",!0),h=l.get("target",!0)||"blank";u&&Am(u,h)}}}}},this)},t.prototype._renderBreadcrumb=function(r,n,i){var a=this;i||(i=r.get("leafDepth",!0)!=null?{node:r.getViewRoot()}:this.findTarget(n.getWidth()/2,n.getHeight()/2),i||(i={node:r.getData().tree.root})),(this._breadcrumb||(this._breadcrumb=new mq(this.group))).render(r,n,i.node,function(o){a._state!=="animating"&&(cM(r.getViewRoot(),o)?a._rootToNode({node:o}):a._zoomToNode({node:o}))})},t.prototype.remove=function(){this._clearController(),this._containerGroup&&this._containerGroup.removeAll(),this._storage=Pc(),this._state="ready",this._breadcrumb&&this._breadcrumb.remove()},t.prototype.dispose=function(){this._clearController()},t.prototype._zoomToNode=function(r){this.api.dispatchAction({type:"treemapZoomToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:r.node})},t.prototype._rootToNode=function(r){this.api.dispatchAction({type:"treemapRootToNode",from:this.uid,seriesId:this.seriesModel.id,targetNode:r.node})},t.prototype.findTarget=function(r,n){var i,a=this.seriesModel.getViewRoot();return a.eachNode({attr:"viewChildren",order:"preorder"},function(o){var s=this._storage.background[o.getRawIndex()];if(s){var l=s.transformCoordToLocal(r,n),u=s.shape;if(u.x<=l[0]&&l[0]<=u.x+u.width&&u.y<=l[1]&&l[1]<=u.y+u.height)i={node:o,offsetX:l[0],offsetY:l[1]};else return!1}},this),i},t.type="treemap",t}(De);function Pc(){return{nodeGroup:[],background:[],content:[]}}function Aq(e,t,r,n,i,a,o,s,l,u){if(!o)return;var h=o.getLayout(),f=e.getData(),c=o.getModel();if(f.setItemGraphicEl(o.dataIndex,null),!h||!h.isInView)return;var d=h.width,v=h.height,p=h.borderWidth,g=h.invisible,m=o.getRawIndex(),_=s&&s.getRawIndex(),y=o.viewChildren,x=h.upperHeight,T=y&&y.length,S=c.getModel("itemStyle"),M=c.getModel(["emphasis","itemStyle"]),w=c.getModel(["blur","itemStyle"]),b=c.getModel(["select","itemStyle"]),A=S.get("borderRadius")||0,E=Z("nodeGroup",lT);if(!E)return;if(l.add(E),E.x=h.x||0,E.y=h.y||0,E.markRedraw(),Hm(E).nodeWidth=d,Hm(E).nodeHeight=v,h.isAboveViewRoot)return E;var C=Z("background",GD,u,bq);C&&z(E,C,T&&h.upperLabelHeight);var D=c.getModel("emphasis"),L=D.get("focus"),P=D.get("blurScope"),N=D.get("disabled"),O=L==="ancestor"?o.getAncestorsIndices():L==="descendant"?o.getDescendantIndices():L;if(T)kd(E)&&jl(E,!1),C&&(jl(C,!N),f.setItemGraphicEl(o.dataIndex,C),ES(C,O,P));else{var I=Z("content",GD,u,wq);I&&X(E,I),C.disableMorphing=!0,C&&kd(C)&&jl(C,!1),jl(E,!N),f.setItemGraphicEl(o.dataIndex,E);var k=c.getShallow("cursor");k&&I.attr("cursor",k),ES(E,O,P)}return E;function z(tt,et,st){var nt=oe(et);if(nt.dataIndex=o.dataIndex,nt.seriesIndex=e.seriesIndex,et.setShape({x:0,y:0,width:d,height:v,r:A}),g)Y(et);else{et.invisible=!1;var dt=o.getVisual("style"),At=dt.stroke,G=XD(S);G.fill=At;var Dt=Bl(M);Dt.fill=M.get("borderColor");var Pt=Bl(w);Pt.fill=w.get("borderColor");var Lt=Bl(b);if(Lt.fill=b.get("borderColor"),st){var zt=d-2*p;$(et,At,dt.opacity,{x:p,y:0,width:zt,height:x})}else et.removeTextContent();et.setStyle(G),et.ensureState("emphasis").style=Dt,et.ensureState("blur").style=Pt,et.ensureState("select").style=Lt,wu(et)}tt.add(et)}function X(tt,et){var st=oe(et);st.dataIndex=o.dataIndex,st.seriesIndex=e.seriesIndex;var nt=Math.max(d-2*p,0),dt=Math.max(v-2*p,0);if(et.culling=!0,et.setShape({x:p,y:p,width:nt,height:dt,r:A}),g)Y(et);else{et.invisible=!1;var At=o.getVisual("style"),G=At.fill,Dt=XD(S);Dt.fill=G,Dt.decal=At.decal;var Pt=Bl(M),Lt=Bl(w),zt=Bl(b);$(et,G,At.opacity,null),et.setStyle(Dt),et.ensureState("emphasis").style=Pt,et.ensureState("blur").style=Lt,et.ensureState("select").style=zt,wu(et)}tt.add(et)}function Y(tt){!tt.invisible&&a.push(tt)}function $(tt,et,st,nt){var dt=c.getModel(nt?WD:HD),At=Xr(c.get("name"),null),G=dt.getShallow("show");Sn(tt,an(c,nt?WD:HD),{defaultText:G?At:null,inheritColor:et,defaultOpacity:st,labelFetcher:e,labelDataIndex:o.dataIndex});var Dt=tt.getTextContent();if(Dt){var Pt=Dt.style,Lt=Yb(Pt.padding||0);nt&&(tt.setTextConfig({layoutRect:nt}),Dt.disableLabelLayout=!0),Dt.beforeUpdate=function(){var ne=Math.max((nt?nt.width:tt.shape.width)-Lt[1]-Lt[3],0),kt=Math.max((nt?nt.height:tt.shape.height)-Lt[0]-Lt[2],0);(Pt.width!==ne||Pt.height!==kt)&&Dt.setStyle({width:ne,height:kt})},Pt.truncateMinChar=2,Pt.lineOverflow="truncate",H(Pt,nt,h);var zt=Dt.getState("emphasis");H(zt?zt.style:null,nt,h)}}function H(tt,et,st){var nt=tt?tt.text:null;if(!et&&st.isLeafRoot&&nt!=null){var dt=e.get("drillDownIcon",!0);tt.text=dt?dt+" "+nt:nt}}function Z(tt,et,st,nt){var dt=_!=null&&r[tt][_],At=i[tt];return dt?(r[tt][_]=null,ct(At,dt)):g||(dt=new et,dt instanceof Yi&&(dt.z2=Eq(st,nt)),ut(At,dt)),t[tt][m]=dt}function ct(tt,et){var st=tt[m]={};et instanceof lT?(st.oldX=et.x,st.oldY=et.y):st.oldShape=rt({},et.shape)}function ut(tt,et){var st=tt[m]={},nt=o.parentNode,dt=et instanceof re;if(nt&&(!n||n.direction==="drillDown")){var At=0,G=0,Dt=i.background[nt.getRawIndex()];!n&&Dt&&Dt.oldShape&&(At=Dt.oldShape.width,G=Dt.oldShape.height),dt?(st.oldX=0,st.oldY=G):st.oldShape={x:At,y:G,width:0,height:0}}st.fadein=!dt}}function Eq(e,t){return e*Tq+t}var tv=R,Cq=Kt,Wm=-1,rn=function(){function e(t){var r=t.mappingMethod,n=t.type,i=this.option=Qt(t);this.type=n,this.mappingMethod=r,this._normalizeData=Rq[r];var a=e.visualHandlers[n];this.applyVisual=a.applyVisual,this.getColorMapper=a.getColorMapper,this._normalizedToVisual=a._normalizedToVisual[r],r==="piecewise"?(jy(i),Dq(i)):r==="category"?i.categories?Lq(i):jy(i,!0):(Hn(r!=="linear"||i.dataExtent),jy(i))}return e.prototype.mapValueToVisual=function(t){var r=this._normalizeData(t);return this._normalizedToVisual(r,t)},e.prototype.getNormalizer=function(){return It(this._normalizeData,this)},e.listVisualTypes=function(){return be(e.visualHandlers)},e.isValidType=function(t){return e.visualHandlers.hasOwnProperty(t)},e.eachVisual=function(t,r,n){Kt(t)?R(t,r,n):r.call(n,t)},e.mapVisual=function(t,r,n){var i,a=at(t)?[]:Kt(t)?{}:(i=!0,null);return e.eachVisual(t,function(o,s){var l=r.call(n,o,s);i?a=l:a[s]=l}),a},e.retrieveVisuals=function(t){var r={},n;return t&&tv(e.visualHandlers,function(i,a){t.hasOwnProperty(a)&&(r[a]=t[a],n=!0)}),n?r:null},e.prepareVisualTypes=function(t){if(at(t))t=t.slice();else if(Cq(t)){var r=[];tv(t,function(n,i){r.push(i)}),t=r}else return[];return t.sort(function(n,i){return i==="color"&&n!=="color"&&n.indexOf("color")===0?1:-1}),t},e.dependsOn=function(t,r){return r==="color"?!!(t&&t.indexOf(r)===0):t===r},e.findPieceIndex=function(t,r,n){for(var i,a=1/0,o=0,s=r.length;o<s;o++){var l=r[o].value;if(l!=null){if(l===t||Ct(l)&&l===t+"")return o;n&&c(l,o)}}for(var o=0,s=r.length;o<s;o++){var u=r[o],h=u.interval,f=u.close;if(h){if(h[0]===-1/0){if(Bp(f[1],t,h[1]))return o}else if(h[1]===1/0){if(Bp(f[0],h[0],t))return o}else if(Bp(f[0],h[0],t)&&Bp(f[1],t,h[1]))return o;n&&c(h[0],o),n&&c(h[1],o)}}if(n)return t===1/0?r.length-1:t===-1/0?0:i;function c(d,v){var p=Math.abs(d-t);p<a&&(a=p,i=v)}},e.visualHandlers={color:{applyVisual:Ic("color"),getColorMapper:function(){var t=this.option;return It(t.mappingMethod==="category"?function(r,n){return!n&&(r=this._normalizeData(r)),sd.call(this,r)}:function(r,n,i){var a=!!i;return!n&&(r=this._normalizeData(r)),i=R0(r,t.parsedVisual,i),a?i:Mo(i,"rgba")},this)},_normalizedToVisual:{linear:function(t){return Mo(R0(t,this.option.parsedVisual),"rgba")},category:sd,piecewise:function(t,r){var n=hT.call(this,r);return n==null&&(n=Mo(R0(t,this.option.parsedVisual),"rgba")),n},fixed:Ul}},colorHue:Fp(function(t,r){return md(t,r)}),colorSaturation:Fp(function(t,r){return md(t,null,r)}),colorLightness:Fp(function(t,r){return md(t,null,null,r)}),colorAlpha:Fp(function(t,r){return dm(t,r)}),decal:{applyVisual:Ic("decal"),_normalizedToVisual:{linear:null,category:sd,piecewise:null,fixed:null}},opacity:{applyVisual:Ic("opacity"),_normalizedToVisual:uT([0,1])},liftZ:{applyVisual:Ic("liftZ"),_normalizedToVisual:{linear:Ul,category:Ul,piecewise:Ul,fixed:Ul}},symbol:{applyVisual:function(t,r,n){var i=this.mapValueToVisual(t);n("symbol",i)},_normalizedToVisual:{linear:YD,category:sd,piecewise:function(t,r){var n=hT.call(this,r);return n==null&&(n=YD.call(this,t)),n},fixed:Ul}},symbolSize:{applyVisual:Ic("symbolSize"),_normalizedToVisual:uT([0,1])}},e}();function Dq(e){var t=e.pieceList;e.hasSpecialVisual=!1,R(t,function(r,n){r.originIndex=n,r.visual!=null&&(e.hasSpecialVisual=!0)})}function Lq(e){var t=e.categories,r=e.categoryMap={},n=e.visual;if(tv(t,function(o,s){r[o]=s}),!at(n)){var i=[];Kt(n)?tv(n,function(o,s){var l=r[s];i[l??Wm]=o}):i[Wm]=n,n=RU(e,i)}for(var a=t.length-1;a>=0;a--)n[a]==null&&(delete r[t[a]],t.pop())}function jy(e,t){var r=e.visual,n=[];Kt(r)?tv(r,function(a){n.push(a)}):r!=null&&n.push(r);var i={color:1,symbol:1};!t&&n.length===1&&!i.hasOwnProperty(e.type)&&(n[1]=n[0]),RU(e,n)}function Fp(e){return{applyVisual:function(t,r,n){var i=this.mapValueToVisual(t);n("color",e(r("color"),i))},_normalizedToVisual:uT([0,1])}}function YD(e){var t=this.option.visual;return t[Math.round(He(e,[0,1],[0,t.length-1],!0))]||{}}function Ic(e){return function(t,r,n){n(e,this.mapValueToVisual(t))}}function sd(e){var t=this.option.visual;return t[this.option.loop&&e!==Wm?e%t.length:e]}function Ul(){return this.option.visual[0]}function uT(e){return{linear:function(t){return He(t,e,this.option.visual,!0)},category:sd,piecewise:function(t,r){var n=hT.call(this,r);return n==null&&(n=He(t,e,this.option.visual,!0)),n},fixed:Ul}}function hT(e){var t=this.option,r=t.pieceList;if(t.hasSpecialVisual){var n=rn.findPieceIndex(e,r),i=r[n];if(i&&i.visual)return i.visual[this.type]}}function RU(e,t){return e.visual=t,e.type==="color"&&(e.parsedVisual=ft(t,function(r){var n=kn(r);return n||[0,0,0,1]})),t}var Rq={linear:function(e){return He(e,this.option.dataExtent,[0,1],!0)},piecewise:function(e){var t=this.option.pieceList,r=rn.findPieceIndex(e,t,!0);if(r!=null)return He(r,[0,t.length-1],[0,1],!0)},category:function(e){var t=this.option.categories?this.option.categoryMap[e]:e;return t??Wm},fixed:Rr};function Bp(e,t,r){return e?t<=r:t<r}var Pq="itemStyle",PU=Le();const Iq={seriesType:"treemap",reset:function(e){var t=e.getData().tree,r=t.root;r.isRemoved()||IU(r,{},e.getViewRoot().getAncestors(),e)}};function IU(e,t,r,n){var i=e.getModel(),a=e.getLayout(),o=e.hostTree.data;if(!(!a||a.invisible||!a.isInView)){var s=i.getModel(Pq),l=Nq(s,t,n),u=o.ensureUniqueItemVisual(e.dataIndex,"style"),h=s.get("borderColor"),f=s.get("borderColorSaturation"),c;f!=null&&(c=ZD(l),h=Oq(f,c)),u.stroke=h;var d=e.viewChildren;if(!d||!d.length)c=ZD(l),u.fill=c;else{var v=Fq(e,i,a,s,l,d);R(d,function(p,g){if(p.depth>=r.length||p===r[p.depth]){var m=Bq(i,l,p,g,v,n);IU(p,m,r,n)}})}}}function Nq(e,t,r){var n=rt({},t),i=r.designatedVisualItemStyle;return R(["color","colorAlpha","colorSaturation"],function(a){i[a]=t[a];var o=e.get(a);i[a]=null,o!=null&&(n[a]=o)}),n}function ZD(e){var t=Jy(e,"color");if(t){var r=Jy(e,"colorAlpha"),n=Jy(e,"colorSaturation");return n&&(t=md(t,null,null,n)),r&&(t=dm(t,r)),t}}function Oq(e,t){return t!=null?md(t,null,null,e):null}function Jy(e,t){var r=e[t];if(r!=null&&r!=="none")return r}function Fq(e,t,r,n,i,a){if(!(!a||!a.length)){var o=Qy(t,"color")||i.color!=null&&i.color!=="none"&&(Qy(t,"colorAlpha")||Qy(t,"colorSaturation"));if(o){var s=t.get("visualMin"),l=t.get("visualMax"),u=r.dataExtent.slice();s!=null&&s<u[0]&&(u[0]=s),l!=null&&l>u[1]&&(u[1]=l);var h=t.get("colorMappingBy"),f={type:o.name,dataExtent:u,visual:o.range};f.type==="color"&&(h==="index"||h==="id")?(f.mappingMethod="category",f.loop=!0):f.mappingMethod="linear";var c=new rn(f);return PU(c).drColorMappingBy=h,c}}}function Qy(e,t){var r=e.get(t);return at(r)&&r.length?{name:t,range:r}:null}function Bq(e,t,r,n,i,a){var o=rt({},t);if(i){var s=i.type,l=s==="color"&&PU(i).drColorMappingBy,u=l==="index"?n:l==="id"?a.mapIdToIndex(r.getId()):r.getValue(e.get("visualDimension"));o[s]=i.mapValueToVisual(u)}return o}var ev=Math.max,Xm=Math.min,qD=pn,dM=R,NU=["itemStyle","borderWidth"],Uq=["itemStyle","gapWidth"],zq=["upperLabel","show"],kq=["upperLabel","height"];const Gq={seriesType:"treemap",reset:function(e,t,r,n){var i=r.getWidth(),a=r.getHeight(),o=e.option,s=Mr(e.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()}),l=o.size||[],u=Tt(qD(s.width,l[0]),i),h=Tt(qD(s.height,l[1]),a),f=n&&n.type,c=["treemapZoomToNode","treemapRootToNode"],d=Qd(n,c,e),v=f==="treemapRender"||f==="treemapMove"?n.rootRect:null,p=e.getViewRoot(),g=CU(p);if(f!=="treemapMove"){var m=f==="treemapZoomToNode"?Zq(e,d,p,u,h):v?[v.width,v.height]:[u,h],_=o.sort;_&&_!=="asc"&&_!=="desc"&&(_="desc");var y={squareRatio:o.squareRatio,sort:_,leafDepth:o.leafDepth};p.hostTree.clearLayouts();var x={x:0,y:0,width:m[0],height:m[1],area:m[0]*m[1]};p.setLayout(x),OU(p,y,!1,0),x=p.getLayout(),dM(g,function(S,M){var w=(g[M+1]||p).getValue();S.setLayout(rt({dataExtent:[w,w],borderWidth:0,upperHeight:0},x))})}var T=e.getData().tree.root;T.setLayout(qq(s,v,d),!0),e.setLayoutInfo(s),FU(T,new fe(-s.x,-s.y,i,a),g,p,0)}};function OU(e,t,r,n){var i,a;if(!e.isRemoved()){var o=e.getLayout();i=o.width,a=o.height;var s=e.getModel(),l=s.get(NU),u=s.get(Uq)/2,h=BU(s),f=Math.max(l,h),c=l-u,d=f-u;e.setLayout({borderWidth:l,upperHeight:f,upperLabelHeight:h},!0),i=ev(i-2*c,0),a=ev(a-c-d,0);var v=i*a,p=Vq(e,s,v,t,r,n);if(p.length){var g={x:c,y:d,width:i,height:a},m=Xm(i,a),_=1/0,y=[];y.area=0;for(var x=0,T=p.length;x<T;){var S=p[x];y.push(S),y.area+=S.getLayout().area;var M=Yq(y,m,t.squareRatio);M<=_?(x++,_=M):(y.area-=y.pop().getLayout().area,$D(y,m,g,u,!1),m=Xm(g.width,g.height),y.length=y.area=0,_=1/0)}if(y.length&&$D(y,m,g,u,!0),!r){var w=s.get("childrenVisibleMin");w!=null&&v<w&&(r=!0)}for(var x=0,T=p.length;x<T;x++)OU(p[x],t,r,n+1)}}}function Vq(e,t,r,n,i,a){var o=e.children||[],s=n.sort;s!=="asc"&&s!=="desc"&&(s=null);var l=n.leafDepth!=null&&n.leafDepth<=a;if(i&&!l)return e.viewChildren=[];o=Xe(o,function(d){return!d.isRemoved()}),Wq(o,s);var u=Xq(t,o,s);if(u.sum===0)return e.viewChildren=[];if(u.sum=Hq(t,r,u.sum,s,o),u.sum===0)return e.viewChildren=[];for(var h=0,f=o.length;h<f;h++){var c=o[h].getValue()/u.sum*r;o[h].setLayout({area:c})}return l&&(o.length&&e.setLayout({isLeafRoot:!0},!0),o.length=0),e.viewChildren=o,e.setLayout({dataExtent:u.dataExtent},!0),o}function Hq(e,t,r,n,i){if(!n)return r;for(var a=e.get("visibleMin"),o=i.length,s=o,l=o-1;l>=0;l--){var u=i[n==="asc"?o-l-1:l].getValue();u/r*t<a&&(s=l,r-=u)}return n==="asc"?i.splice(0,o-s):i.splice(s,o-s),r}function Wq(e,t){return t&&e.sort(function(r,n){var i=t==="asc"?r.getValue()-n.getValue():n.getValue()-r.getValue();return i===0?t==="asc"?r.dataIndex-n.dataIndex:n.dataIndex-r.dataIndex:i}),e}function Xq(e,t,r){for(var n=0,i=0,a=t.length;i<a;i++)n+=t[i].getValue();var o=e.get("visualDimension"),s;return!t||!t.length?s=[NaN,NaN]:o==="value"&&r?(s=[t[t.length-1].getValue(),t[0].getValue()],r==="asc"&&s.reverse()):(s=[1/0,-1/0],dM(t,function(l){var u=l.getValue(o);u<s[0]&&(s[0]=u),u>s[1]&&(s[1]=u)})),{sum:n,dataExtent:s}}function Yq(e,t,r){for(var n=0,i=1/0,a=0,o=void 0,s=e.length;a<s;a++)o=e[a].getLayout().area,o&&(o<i&&(i=o),o>n&&(n=o));var l=e.area*e.area,u=t*t*r;return l?ev(u*n/l,l/(u*i)):1/0}function $D(e,t,r,n,i){var a=t===r.width?0:1,o=1-a,s=["x","y"],l=["width","height"],u=r[s[a]],h=t?e.area/t:0;(i||h>r[l[o]])&&(h=r[l[o]]);for(var f=0,c=e.length;f<c;f++){var d=e[f],v={},p=h?d.getLayout().area/h:0,g=v[l[o]]=ev(h-2*n,0),m=r[s[a]]+r[l[a]]-u,_=f===c-1||m<p?m:p,y=v[l[a]]=ev(_-2*n,0);v[s[o]]=r[s[o]]+Xm(n,g/2),v[s[a]]=u+Xm(n,y/2),u+=_,d.setLayout(v,!0)}r[s[o]]+=h,r[l[o]]-=h}function Zq(e,t,r,n,i){var a=(t||{}).node,o=[n,i];if(!a||a===r)return o;for(var s,l=n*i,u=l*e.option.zoomToNodeRatio;s=a.parentNode;){for(var h=0,f=s.children,c=0,d=f.length;c<d;c++)h+=f[c].getValue();var v=a.getValue();if(v===0)return o;u*=h/v;var p=s.getModel(),g=p.get(NU),m=Math.max(g,BU(p));u+=4*g*g+(3*g+m)*Math.pow(u,.5),u>lE&&(u=lE),a=s}u<l&&(u=l);var _=Math.pow(u/l,.5);return[n*_,i*_]}function qq(e,t,r){if(t)return{x:t.x,y:t.y};var n={x:0,y:0};if(!r)return n;var i=r.node,a=i.getLayout();if(!a)return n;for(var o=[a.width/2,a.height/2],s=i;s;){var l=s.getLayout();o[0]+=l.x,o[1]+=l.y,s=s.parentNode}return{x:e.width/2-o[0],y:e.height/2-o[1]}}function FU(e,t,r,n,i){var a=e.getLayout(),o=r[i],s=o&&o===e;if(!(o&&!s||i===r.length&&e!==n)){e.setLayout({isInView:!0,invisible:!s&&!t.intersect(a),isAboveViewRoot:s},!0);var l=new fe(t.x-a.x,t.y-a.y,t.width,t.height);dM(e.viewChildren||[],function(u){FU(u,l,r,n,i+1)})}}function BU(e){return e.get(zq)?e.get(kq):0}function $q(e){e.registerSeriesModel(vq),e.registerChartView(Mq),e.registerVisual(Iq),e.registerLayout(Gq),dq(e)}function Kq(e){var t=e.findComponents({mainType:"legend"});!t||!t.length||e.eachSeriesByType("graph",function(r){var n=r.getCategoriesData(),i=r.getGraph(),a=i.data,o=n.mapArray(n.getName);a.filterSelf(function(s){var l=a.getItemModel(s),u=l.getShallow("category");if(u!=null){Be(u)&&(u=o[u]);for(var h=0;h<t.length;h++)if(!t[h].isSelected(u))return!1}return!0})})}function jq(e){var t={};e.eachSeriesByType("graph",function(r){var n=r.getCategoriesData(),i=r.getData(),a={};n.each(function(o){var s=n.getName(o);a["ec-"+s]=o;var l=n.getItemModel(o),u=l.getModel("itemStyle").getItemStyle();u.fill||(u.fill=r.getColorFromPalette(s,t)),n.setItemVisual(o,"style",u);for(var h=["symbol","symbolSize","symbolKeepAspect"],f=0;f<h.length;f++){var c=l.getShallow(h[f],!0);c!=null&&n.setItemVisual(o,h[f],c)}}),n.count()&&i.each(function(o){var s=i.getItemModel(o),l=s.getShallow("category");if(l!=null){Ct(l)&&(l=a["ec-"+l]);var u=n.getItemVisual(l,"style"),h=i.ensureUniqueItemVisual(o,"style");rt(h,u);for(var f=["symbol","symbolSize","symbolKeepAspect"],c=0;c<f.length;c++)i.setItemVisual(o,f[c],n.getItemVisual(l,f[c]))}})})}function Up(e){return e instanceof Array||(e=[e,e]),e}function Jq(e){e.eachSeriesByType("graph",function(t){var r=t.getGraph(),n=t.getEdgeData(),i=Up(t.get("edgeSymbol")),a=Up(t.get("edgeSymbolSize"));n.setVisual("fromSymbol",i&&i[0]),n.setVisual("toSymbol",i&&i[1]),n.setVisual("fromSymbolSize",a&&a[0]),n.setVisual("toSymbolSize",a&&a[1]),n.setVisual("style",t.getModel("lineStyle").getLineStyle()),n.each(function(o){var s=n.getItemModel(o),l=r.getEdgeByIndex(o),u=Up(s.getShallow("symbol",!0)),h=Up(s.getShallow("symbolSize",!0)),f=s.getModel("lineStyle").getLineStyle(),c=n.ensureUniqueItemVisual(o,"style");switch(rt(c,f),c.stroke){case"source":{var d=l.node1.getVisual("style");c.stroke=d&&d.fill;break}case"target":{var d=l.node2.getVisual("style");c.stroke=d&&d.fill;break}}u[0]&&l.setVisual("fromSymbol",u[0]),u[1]&&l.setVisual("toSymbol",u[1]),h[0]&&l.setVisual("fromSymbolSize",h[0]),h[1]&&l.setVisual("toSymbolSize",h[1])})})}var fT="-->",i0=function(e){return e.get("autoCurveness")||null},UU=function(e,t){var r=i0(e),n=20,i=[];if(Be(r))n=r;else if(at(r)){e.__curvenessList=r;return}t>n&&(n=t);var a=n%2?n+2:n+3;i=[];for(var o=0;o<a;o++)i.push((o%2?o+1:o)/10*(o%2?-1:1));e.__curvenessList=i},rv=function(e,t,r){var n=[e.id,e.dataIndex].join("."),i=[t.id,t.dataIndex].join(".");return[r.uid,n,i].join(fT)},zU=function(e){var t=e.split(fT);return[t[0],t[2],t[1]].join(fT)},Qq=function(e,t){var r=rv(e.node1,e.node2,t);return t.__edgeMap[r]},t$=function(e,t){var r=cT(rv(e.node1,e.node2,t),t),n=cT(rv(e.node2,e.node1,t),t);return r+n},cT=function(e,t){var r=t.__edgeMap;return r[e]?r[e].length:0};function e$(e){i0(e)&&(e.__curvenessList=[],e.__edgeMap={},UU(e))}function r$(e,t,r,n){if(i0(r)){var i=rv(e,t,r),a=r.__edgeMap,o=a[zU(i)];a[i]&&!o?a[i].isForward=!0:o&&a[i]&&(o.isForward=!0,a[i].isForward=!1),a[i]=a[i]||[],a[i].push(n)}}function vM(e,t,r,n){var i=i0(t),a=at(i);if(!i)return null;var o=Qq(e,t);if(!o)return null;for(var s=-1,l=0;l<o.length;l++)if(o[l]===r){s=l;break}var u=t$(e,t);UU(t,u),e.lineStyle=e.lineStyle||{};var h=rv(e.node1,e.node2,t),f=t.__curvenessList,c=a||u%2?0:1;if(o.isForward)return f[c+s];var d=zU(h),v=cT(d,t),p=f[s+v+c];return n?a?i&&i[0]===0?(v+c)%2?p:-p:((v%2?0:1)+c)%2?p:-p:(v+c)%2?p:-p:f[s+v+c]}function kU(e){var t=e.coordinateSystem;if(!(t&&t.type!=="view")){var r=e.getGraph();r.eachNode(function(n){var i=n.getModel();n.setLayout([+i.get("x"),+i.get("y")])}),pM(r,e)}}function pM(e,t){e.eachEdge(function(r,n){var i=Ga(r.getModel().get(["lineStyle","curveness"]),-vM(r,t,n,!0),0),a=bo(r.node1.getLayout()),o=bo(r.node2.getLayout()),s=[a,o];+i&&s.push([(a[0]+o[0])/2-(a[1]-o[1])*i,(a[1]+o[1])/2-(o[0]-a[0])*i]),r.setLayout(s)})}function n$(e,t){e.eachSeriesByType("graph",function(r){var n=r.get("layout"),i=r.coordinateSystem;if(i&&i.type!=="view"){var a=r.getData(),o=[];R(i.dimensions,function(c){o=o.concat(a.mapDimensionsAll(c))});for(var s=0;s<a.count();s++){for(var l=[],u=!1,h=0;h<o.length;h++){var f=a.get(o[h],s);isNaN(f)||(u=!0),l.push(f)}u?a.setItemLayout(s,i.dataToPoint(l)):a.setItemLayout(s,[NaN,NaN])}pM(a.graph,r)}else(!n||n==="none")&&kU(r)})}function ld(e){var t=e.coordinateSystem;if(t.type!=="view")return 1;var r=e.option.nodeScaleRatio,n=t.scaleX,i=t.getZoom(),a=(i-1)*r+1;return a/n}function ud(e){var t=e.getVisual("symbolSize");return t instanceof Array&&(t=(t[0]+t[1])/2),+t}var KD=Math.PI,tx=[];function gM(e,t,r,n){var i=e.coordinateSystem;if(!(i&&i.type!=="view")){var a=i.getBoundingRect(),o=e.getData(),s=o.graph,l=a.width/2+a.x,u=a.height/2+a.y,h=Math.min(a.width,a.height)/2,f=o.count();if(o.setLayout({cx:l,cy:u}),!!f){if(r){var c=i.pointToData(n),d=c[0],v=c[1],p=[d-l,v-u];Ff(p,p),Fg(p,p,h),r.setLayout([l+p[0],u+p[1]],!0);var g=e.get(["circular","rotateLabel"]);GU(r,g,l,u)}i$[t](e,s,o,h,l,u,f),s.eachEdge(function(m,_){var y=Ga(m.getModel().get(["lineStyle","curveness"]),vM(m,e,_),0),x=bo(m.node1.getLayout()),T=bo(m.node2.getLayout()),S,M=(x[0]+T[0])/2,w=(x[1]+T[1])/2;+y&&(y*=3,S=[l*y+M*(1-y),u*y+w*(1-y)]),m.setLayout([x,T,S])})}}}var i$={value:function(e,t,r,n,i,a,o){var s=0,l=r.getSum("value"),u=Math.PI*2/(l||o);t.eachNode(function(h){var f=h.getValue("value"),c=u*(l?f:1)/2;s+=c,h.setLayout([n*Math.cos(s)+i,n*Math.sin(s)+a]),s+=c})},symbolSize:function(e,t,r,n,i,a,o){var s=0;tx.length=o;var l=ld(e);t.eachNode(function(f){var c=ud(f);isNaN(c)&&(c=2),c<0&&(c=0),c*=l;var d=Math.asin(c/2/n);isNaN(d)&&(d=KD/2),tx[f.dataIndex]=d,s+=d*2});var u=(2*KD-s)/o/2,h=0;t.eachNode(function(f){var c=u+tx[f.dataIndex];h+=c,(!f.getLayout()||!f.getLayout().fixed)&&f.setLayout([n*Math.cos(h)+i,n*Math.sin(h)+a]),h+=c})}};function GU(e,t,r,n){var i=e.getGraphicEl();if(i){var a=e.getModel(),o=a.get(["label","rotate"])||0,s=i.getSymbolPath();if(t){var l=e.getLayout(),u=Math.atan2(l[1]-n,l[0]-r);u<0&&(u=Math.PI*2+u);var h=l[0]<r;h&&(u=u-Math.PI);var f=h?"left":"right";s.setTextConfig({rotation:-u,position:f,origin:"center"});var c=s.ensureState("emphasis");rt(c.textConfig||(c.textConfig={}),{position:f})}else s.setTextConfig({rotation:o*=Math.PI/180})}}function a$(e){e.eachSeriesByType("graph",function(t){t.get("layout")==="circular"&&gM(t,"symbolSize")})}var lh=J1;function o$(e,t,r){for(var n=e,i=t,a=r.rect,o=a.width,s=a.height,l=[a.x+o/2,a.y+s/2],u=r.gravity==null?.1:r.gravity,h=0;h<n.length;h++){var f=n[h];f.p||(f.p=Ou(o*(Math.random()-.5)+l[0],s*(Math.random()-.5)+l[1])),f.pp=bo(f.p),f.edges=null}var c=r.friction==null?.6:r.friction,d=c,v,p;return{warmUp:function(){d=c*.8},setFixed:function(g){n[g].fixed=!0},setUnfixed:function(g){n[g].fixed=!1},beforeStep:function(g){v=g},afterStep:function(g){p=g},step:function(g){v&&v(n,i);for(var m=[],_=n.length,y=0;y<i.length;y++){var x=i[y];if(!x.ignoreForceLayout){var T=x.n1,S=x.n2;$l(m,S.p,T.p);var M=Q1(m)-x.d,w=S.w/(T.w+S.w);isNaN(w)&&(w=0),Ff(m,m),!T.fixed&&lh(T.p,T.p,m,w*M*d),!S.fixed&&lh(S.p,S.p,m,-(1-w)*M*d)}}for(var y=0;y<_;y++){var b=n[y];b.fixed||($l(m,l,b.p),lh(b.p,b.p,m,u*d))}for(var y=0;y<_;y++)for(var T=n[y],A=y+1;A<_;A++){var S=n[A];$l(m,S.p,T.p);var M=Q1(m);M===0&&(z4(m,Math.random()-.5,Math.random()-.5),M=1);var E=(T.rep+S.rep)/M/M;!T.fixed&&lh(T.pp,T.pp,m,E),!S.fixed&&lh(S.pp,S.pp,m,-E)}for(var C=[],y=0;y<_;y++){var b=n[y];b.fixed||($l(C,b.p,b.pp),lh(b.p,b.p,C,d),On(b.pp,b.p))}d=d*.992;var D=d<.01;p&&p(n,i,D),g&&g(D)}}}function s$(e){e.eachSeriesByType("graph",function(t){var r=t.coordinateSystem;if(!(r&&r.type!=="view"))if(t.get("layout")==="force"){var n=t.preservedPoints||{},i=t.getGraph(),a=i.data,o=i.edgeData,s=t.getModel("force"),l=s.get("initLayout");t.preservedPoints?a.each(function(y){var x=a.getId(y);a.setItemLayout(y,n[x]||[NaN,NaN])}):!l||l==="none"?kU(t):l==="circular"&&gM(t,"value");var u=a.getDataExtent("value"),h=o.getDataExtent("value"),f=s.get("repulsion"),c=s.get("edgeLength"),d=at(f)?f:[f,f],v=at(c)?c:[c,c];v=[v[1],v[0]];var p=a.mapArray("value",function(y,x){var T=a.getItemLayout(x),S=He(y,u,d);return isNaN(S)&&(S=(d[0]+d[1])/2),{w:S,rep:S,fixed:a.getItemModel(x).get("fixed"),p:!T||isNaN(T[0])||isNaN(T[1])?null:T}}),g=o.mapArray("value",function(y,x){var T=i.getEdgeByIndex(x),S=He(y,h,v);isNaN(S)&&(S=(v[0]+v[1])/2);var M=T.getModel(),w=Ga(T.getModel().get(["lineStyle","curveness"]),-vM(T,t,x,!0),0);return{n1:p[T.node1.dataIndex],n2:p[T.node2.dataIndex],d:S,curveness:w,ignoreForceLayout:M.get("ignoreForceLayout")}}),m=r.getBoundingRect(),_=o$(p,g,{rect:m,gravity:s.get("gravity"),friction:s.get("friction")});_.beforeStep(function(y,x){for(var T=0,S=y.length;T<S;T++)y[T].fixed&&On(y[T].p,i.getNodeByIndex(T).getLayout())}),_.afterStep(function(y,x,T){for(var S=0,M=y.length;S<M;S++)y[S].fixed||i.getNodeByIndex(S).setLayout(y[S].p),n[a.getId(S)]=y[S].p;for(var S=0,M=x.length;S<M;S++){var w=x[S],b=i.getEdgeByIndex(S),A=w.n1.p,E=w.n2.p,C=b.getLayout();C=C?C.slice():[],C[0]=C[0]||[],C[1]=C[1]||[],On(C[0],A),On(C[1],E),+w.curveness&&(C[2]=[(A[0]+E[0])/2-(A[1]-E[1])*w.curveness,(A[1]+E[1])/2-(E[0]-A[0])*w.curveness]),b.setLayout(C)}}),t.forceLayout=_,t.preservedPoints=n,_.step()}else t.forceLayout=null})}function l$(e,t,r){var n=rt(e.getBoxLayoutParams(),{aspect:r});return Mr(n,{width:t.getWidth(),height:t.getHeight()})}function u$(e,t){var r=[];return e.eachSeriesByType("graph",function(n){var i=n.get("coordinateSystem");if(!i||i==="view"){var a=n.getData(),o=a.mapArray(function(g){var m=a.getItemModel(g);return[+m.get("x"),+m.get("y")]}),s=[],l=[];R_(o,s,l),l[0]-s[0]===0&&(l[0]+=1,s[0]-=1),l[1]-s[1]===0&&(l[1]+=1,s[1]-=1);var u=(l[0]-s[0])/(l[1]-s[1]),h=l$(n,t,u);isNaN(u)&&(s=[h.x,h.y],l=[h.x+h.width,h.y+h.height]);var f=l[0]-s[0],c=l[1]-s[1],d=h.width,v=h.height,p=n.coordinateSystem=new Fv;p.zoomLimit=n.get("scaleLimit"),p.setBoundingRect(s[0],s[1],f,c),p.setViewRect(h.x,h.y,d,v),p.setCenter(n.get("center"),t),p.setZoom(n.get("zoom")),r.push(p)}}),r}var jD=jr.prototype,ex=Tv.prototype,VU=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.percent=1}return e}();(function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t})(VU);function rx(e){return isNaN(+e.cpx1)||isNaN(+e.cpy1)}var h$=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="ec-line",n}return t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new VU},t.prototype.buildPath=function(r,n){rx(n)?jD.buildPath.call(this,r,n):ex.buildPath.call(this,r,n)},t.prototype.pointAt=function(r){return rx(this.shape)?jD.pointAt.call(this,r):ex.pointAt.call(this,r)},t.prototype.tangentAt=function(r){var n=this.shape,i=rx(n)?[n.x2-n.x1,n.y2-n.y1]:ex.tangentAt.call(this,r);return Ff(i,i)},t}(_e),nx=["fromSymbol","toSymbol"];function JD(e){return"_"+e+"Type"}function QD(e,t,r){var n=t.getItemVisual(r,e);if(!n||n==="none")return n;var i=t.getItemVisual(r,e+"Size"),a=t.getItemVisual(r,e+"Rotate"),o=t.getItemVisual(r,e+"Offset"),s=t.getItemVisual(r,e+"KeepAspect"),l=$f(i),u=ku(o||0,l);return n+l+u+(a||"")+(s||"")}function tL(e,t,r){var n=t.getItemVisual(r,e);if(!(!n||n==="none")){var i=t.getItemVisual(r,e+"Size"),a=t.getItemVisual(r,e+"Rotate"),o=t.getItemVisual(r,e+"Offset"),s=t.getItemVisual(r,e+"KeepAspect"),l=$f(i),u=ku(o||0,l),h=Pr(n,-l[0]/2+u[0],-l[1]/2+u[1],l[0],l[1],null,s);return h.__specifiedRotation=a==null||isNaN(a)?void 0:+a*Math.PI/180||0,h.name=e,h}}function f$(e){var t=new h$({name:"line",subPixelOptimize:!0});return dT(t.shape,e),t}function dT(e,t){e.x1=t[0][0],e.y1=t[0][1],e.x2=t[1][0],e.y2=t[1][1],e.percent=1;var r=t[2];r?(e.cpx1=r[0],e.cpy1=r[1]):(e.cpx1=NaN,e.cpy1=NaN)}var mM=function(e){q(t,e);function t(r,n,i){var a=e.call(this)||this;return a._createLine(r,n,i),a}return t.prototype._createLine=function(r,n,i){var a=r.hostModel,o=r.getItemLayout(n),s=f$(o);s.shape.percent=0,vr(s,{shape:{percent:1}},a,n),this.add(s),R(nx,function(l){var u=tL(l,r,n);this.add(u),this[JD(l)]=QD(l,r,n)},this),this._updateCommonStl(r,n,i)},t.prototype.updateData=function(r,n,i){var a=r.hostModel,o=this.childOfName("line"),s=r.getItemLayout(n),l={shape:{}};dT(l.shape,s),ke(o,l,a,n),R(nx,function(u){var h=QD(u,r,n),f=JD(u);if(this[f]!==h){this.remove(this.childOfName(u));var c=tL(u,r,n);this.add(c)}this[f]=h},this),this._updateCommonStl(r,n,i)},t.prototype.getLinePath=function(){return this.childAt(0)},t.prototype._updateCommonStl=function(r,n,i){var a=r.hostModel,o=this.childOfName("line"),s=i&&i.emphasisLineStyle,l=i&&i.blurLineStyle,u=i&&i.selectLineStyle,h=i&&i.labelStatesModels,f=i&&i.emphasisDisabled,c=i&&i.focus,d=i&&i.blurScope;if(!i||r.hasItemOption){var v=r.getItemModel(n),p=v.getModel("emphasis");s=p.getModel("lineStyle").getLineStyle(),l=v.getModel(["blur","lineStyle"]).getLineStyle(),u=v.getModel(["select","lineStyle"]).getLineStyle(),f=p.get("disabled"),c=p.get("focus"),d=p.get("blurScope"),h=an(v)}var g=r.getItemVisual(n,"style"),m=g.stroke;o.useStyle(g),o.style.fill=null,o.style.strokeNoScale=!0,o.ensureState("emphasis").style=s,o.ensureState("blur").style=l,o.ensureState("select").style=u,R(nx,function(S){var M=this.childOfName(S);if(M){M.setColor(m),M.style.opacity=g.opacity;for(var w=0;w<Wn.length;w++){var b=Wn[w],A=o.getState(b);if(A){var E=A.style||{},C=M.ensureState(b),D=C.style||(C.style={});E.stroke!=null&&(D[M.__isEmptyBrush?"stroke":"fill"]=E.stroke),E.opacity!=null&&(D.opacity=E.opacity)}}M.markRedraw()}},this);var _=a.getRawValue(n);Sn(this,h,{labelDataIndex:n,labelFetcher:{getFormattedLabel:function(S,M){return a.getFormattedLabel(S,M,r.dataType)}},inheritColor:m||"#000",defaultOpacity:g.opacity,defaultText:(_==null?r.getName(n):isFinite(_)?dr(_):_)+""});var y=this.getTextContent();if(y){var x=h.normal;y.__align=y.style.align,y.__verticalAlign=y.style.verticalAlign,y.__position=x.get("position")||"middle";var T=x.get("distance");at(T)||(T=[T,T]),y.__labelDistance=T}this.setTextConfig({position:null,local:!0,inside:!1}),Sr(this,c,d,f)},t.prototype.highlight=function(){Po(this)},t.prototype.downplay=function(){Io(this)},t.prototype.updateLayout=function(r,n){this.setLinePoints(r.getItemLayout(n))},t.prototype.setLinePoints=function(r){var n=this.childOfName("line");dT(n.shape,r),n.dirty()},t.prototype.beforeUpdate=function(){var r=this,n=r.childOfName("fromSymbol"),i=r.childOfName("toSymbol"),a=r.getTextContent();if(!n&&!i&&(!a||a.ignore))return;for(var o=1,s=this.parent;s;)s.scaleX&&(o/=s.scaleX),s=s.parent;var l=r.childOfName("line");if(!this.__dirty&&!l.__dirty)return;var u=l.shape.percent,h=l.pointAt(0),f=l.pointAt(u),c=$l([],f,h);Ff(c,c);function d(A,E){var C=A.__specifiedRotation;if(C==null){var D=l.tangentAt(E);A.attr("rotation",(E===1?-1:1)*Math.PI/2-Math.atan2(D[1],D[0]))}else A.attr("rotation",C)}if(n&&(n.setPosition(h),d(n,0),n.scaleX=n.scaleY=o*u,n.markRedraw()),i&&(i.setPosition(f),d(i,1),i.scaleX=i.scaleY=o*u,i.markRedraw()),a&&!a.ignore){a.x=a.y=0,a.originX=a.originY=0;var v=void 0,p=void 0,g=a.__labelDistance,m=g[0]*o,_=g[1]*o,y=u/2,x=l.tangentAt(y),T=[x[1],-x[0]],S=l.pointAt(y);T[1]>0&&(T[0]=-T[0],T[1]=-T[1]);var M=x[0]<0?-1:1;if(a.__position!=="start"&&a.__position!=="end"){var w=-Math.atan2(x[1],x[0]);f[0]<h[0]&&(w=Math.PI+w),a.rotation=w}var b=void 0;switch(a.__position){case"insideStartTop":case"insideMiddleTop":case"insideEndTop":case"middle":b=-_,p="bottom";break;case"insideStartBottom":case"insideMiddleBottom":case"insideEndBottom":b=_,p="top";break;default:b=0,p="middle"}switch(a.__position){case"end":a.x=c[0]*m+f[0],a.y=c[1]*_+f[1],v=c[0]>.8?"left":c[0]<-.8?"right":"center",p=c[1]>.8?"top":c[1]<-.8?"bottom":"middle";break;case"start":a.x=-c[0]*m+h[0],a.y=-c[1]*_+h[1],v=c[0]>.8?"right":c[0]<-.8?"left":"center",p=c[1]>.8?"bottom":c[1]<-.8?"top":"middle";break;case"insideStartTop":case"insideStart":case"insideStartBottom":a.x=m*M+h[0],a.y=h[1]+b,v=x[0]<0?"right":"left",a.originX=-m*M,a.originY=-b;break;case"insideMiddleTop":case"insideMiddle":case"insideMiddleBottom":case"middle":a.x=S[0],a.y=S[1]+b,v="center",a.originY=-b;break;case"insideEndTop":case"insideEnd":case"insideEndBottom":a.x=-m*M+f[0],a.y=f[1]+b,v=x[0]>=0?"right":"left",a.originX=m*M,a.originY=-b;break}a.scaleX=a.scaleY=o,a.setStyle({verticalAlign:a.__verticalAlign||p,align:a.__align||v})}},t}(re),_M=function(){function e(t){this.group=new re,this._LineCtor=t||mM}return e.prototype.updateData=function(t){var r=this;this._progressiveEls=null;var n=this,i=n.group,a=n._lineData;n._lineData=t,a||i.removeAll();var o=eL(t);t.diff(a).add(function(s){r._doAdd(t,s,o)}).update(function(s,l){r._doUpdate(a,t,l,s,o)}).remove(function(s){i.remove(a.getItemGraphicEl(s))}).execute()},e.prototype.updateLayout=function(){var t=this._lineData;t&&t.eachItemGraphicEl(function(r,n){r.updateLayout(t,n)},this)},e.prototype.incrementalPrepareUpdate=function(t){this._seriesScope=eL(t),this._lineData=null,this.group.removeAll()},e.prototype.incrementalUpdate=function(t,r){this._progressiveEls=[];function n(s){!s.isGroup&&!c$(s)&&(s.incremental=!0,s.ensureState("emphasis").hoverLayer=!0)}for(var i=t.start;i<t.end;i++){var a=r.getItemLayout(i);if(ix(a)){var o=new this._LineCtor(r,i,this._seriesScope);o.traverse(n),this.group.add(o),r.setItemGraphicEl(i,o),this._progressiveEls.push(o)}}},e.prototype.remove=function(){this.group.removeAll()},e.prototype.eachRendered=function(t){Hs(this._progressiveEls||this.group,t)},e.prototype._doAdd=function(t,r,n){var i=t.getItemLayout(r);if(ix(i)){var a=new this._LineCtor(t,r,n);t.setItemGraphicEl(r,a),this.group.add(a)}},e.prototype._doUpdate=function(t,r,n,i,a){var o=t.getItemGraphicEl(n);if(!ix(r.getItemLayout(i))){this.group.remove(o);return}o?o.updateData(r,i,a):o=new this._LineCtor(r,i,a),r.setItemGraphicEl(i,o),this.group.add(o)},e}();function c$(e){return e.animators&&e.animators.length>0}function eL(e){var t=e.hostModel,r=t.getModel("emphasis");return{lineStyle:t.getModel("lineStyle").getLineStyle(),emphasisLineStyle:r.getModel(["lineStyle"]).getLineStyle(),blurLineStyle:t.getModel(["blur","lineStyle"]).getLineStyle(),selectLineStyle:t.getModel(["select","lineStyle"]).getLineStyle(),emphasisDisabled:r.get("disabled"),blurScope:r.get("blurScope"),focus:r.get("focus"),labelStatesModels:an(t)}}function rL(e){return isNaN(e[0])||isNaN(e[1])}function ix(e){return e&&!rL(e[0])&&!rL(e[1])}var ax=[],ox=[],sx=[],uh=dn,lx=lu,nL=Math.abs;function iL(e,t,r){for(var n=e[0],i=e[1],a=e[2],o=1/0,s,l=r*r,u=.1,h=.1;h<=.9;h+=.1){ax[0]=uh(n[0],i[0],a[0],h),ax[1]=uh(n[1],i[1],a[1],h);var f=nL(lx(ax,t)-l);f<o&&(o=f,s=h)}for(var c=0;c<32;c++){var d=s+u;ox[0]=uh(n[0],i[0],a[0],s),ox[1]=uh(n[1],i[1],a[1],s),sx[0]=uh(n[0],i[0],a[0],d),sx[1]=uh(n[1],i[1],a[1],d);var f=lx(ox,t)-l;if(nL(f)<.01)break;var v=lx(sx,t)-l;u/=2,f<0?v>=0?s=s+u:s=s-u:v>=0?s=s-u:s=s+u}return s}function ux(e,t){var r=[],n=Nd,i=[[],[],[]],a=[[],[]],o=[];t/=2,e.eachEdge(function(s,l){var u=s.getLayout(),h=s.getVisual("fromSymbol"),f=s.getVisual("toSymbol");u.__original||(u.__original=[bo(u[0]),bo(u[1])],u[2]&&u.__original.push(bo(u[2])));var c=u.__original;if(u[2]!=null){if(On(i[0],c[0]),On(i[1],c[2]),On(i[2],c[1]),h&&h!=="none"){var d=ud(s.node1),v=iL(i,c[0],d*t);n(i[0][0],i[1][0],i[2][0],v,r),i[0][0]=r[3],i[1][0]=r[4],n(i[0][1],i[1][1],i[2][1],v,r),i[0][1]=r[3],i[1][1]=r[4]}if(f&&f!=="none"){var d=ud(s.node2),v=iL(i,c[1],d*t);n(i[0][0],i[1][0],i[2][0],v,r),i[1][0]=r[1],i[2][0]=r[2],n(i[0][1],i[1][1],i[2][1],v,r),i[1][1]=r[1],i[2][1]=r[2]}On(u[0],i[0]),On(u[1],i[2]),On(u[2],i[1])}else{if(On(a[0],c[0]),On(a[1],c[1]),$l(o,a[1],a[0]),Ff(o,o),h&&h!=="none"){var d=ud(s.node1);J1(a[0],a[0],o,d*t)}if(f&&f!=="none"){var d=ud(s.node2);J1(a[1],a[1],o,-d*t)}On(u[0],a[0]),On(u[1],a[1])}})}function aL(e){return e.type==="view"}var d$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){var i=new Lv,a=new _M,o=this.group;this._controller=new Ov(n.getZr()),this._controllerHost={target:o},o.add(i.group),o.add(a.group),this._symbolDraw=i,this._lineDraw=a,this._firstRender=!0},t.prototype.render=function(r,n,i){var a=this,o=r.coordinateSystem;this._model=r;var s=this._symbolDraw,l=this._lineDraw,u=this.group;if(aL(o)){var h={x:o.x,y:o.y,scaleX:o.scaleX,scaleY:o.scaleY};this._firstRender?u.attr(h):ke(u,h,r)}ux(r.getGraph(),ld(r));var f=r.getData();s.updateData(f);var c=r.getEdgeData();l.updateData(c),this._updateNodeAndLinkScale(),this._updateController(r,n,i),clearTimeout(this._layoutTimeout);var d=r.forceLayout,v=r.get(["force","layoutAnimation"]);d&&this._startForceLayoutIteration(d,v);var p=r.get("layout");f.graph.eachNode(function(y){var x=y.dataIndex,T=y.getGraphicEl(),S=y.getModel();if(T){T.off("drag").off("dragend");var M=S.get("draggable");M&&T.on("drag",function(b){switch(p){case"force":d.warmUp(),!a._layouting&&a._startForceLayoutIteration(d,v),d.setFixed(x),f.setItemLayout(x,[T.x,T.y]);break;case"circular":f.setItemLayout(x,[T.x,T.y]),y.setLayout({fixed:!0},!0),gM(r,"symbolSize",y,[b.offsetX,b.offsetY]),a.updateLayout(r);break;case"none":default:f.setItemLayout(x,[T.x,T.y]),pM(r.getGraph(),r),a.updateLayout(r);break}}).on("dragend",function(){d&&d.setUnfixed(x)}),T.setDraggable(M,!!S.get("cursor"));var w=S.get(["emphasis","focus"]);w==="adjacency"&&(oe(T).focus=y.getAdjacentDataIndices())}}),f.graph.eachEdge(function(y){var x=y.getGraphicEl(),T=y.getModel().get(["emphasis","focus"]);x&&T==="adjacency"&&(oe(x).focus={edge:[y.dataIndex],node:[y.node1.dataIndex,y.node2.dataIndex]})});var g=r.get("layout")==="circular"&&r.get(["circular","rotateLabel"]),m=f.getLayout("cx"),_=f.getLayout("cy");f.graph.eachNode(function(y){GU(y,g,m,_)}),this._firstRender=!1},t.prototype.dispose=function(){this.remove(),this._controller&&this._controller.dispose(),this._controllerHost=null},t.prototype._startForceLayoutIteration=function(r,n){var i=this;(function a(){r.step(function(o){i.updateLayout(i._model),(i._layouting=!o)&&(n?i._layoutTimeout=setTimeout(a,16):a())})})()},t.prototype._updateController=function(r,n,i){var a=this,o=this._controller,s=this._controllerHost,l=this.group;if(o.setPointerChecker(function(u,h,f){var c=l.getBoundingRect();return c.applyTransform(l.transform),c.contain(h,f)&&!e0(u,i,r)}),!aL(r.coordinateSystem)){o.disable();return}o.enable(r.get("roam")),s.zoomLimit=r.get("scaleLimit"),s.zoom=r.coordinateSystem.getZoom(),o.off("pan").off("zoom").on("pan",function(u){aM(s,u.dx,u.dy),i.dispatchAction({seriesId:r.id,type:"graphRoam",dx:u.dx,dy:u.dy})}).on("zoom",function(u){oM(s,u.scale,u.originX,u.originY),i.dispatchAction({seriesId:r.id,type:"graphRoam",zoom:u.scale,originX:u.originX,originY:u.originY}),a._updateNodeAndLinkScale(),ux(r.getGraph(),ld(r)),a._lineDraw.updateLayout(),i.updateLabelLayout()})},t.prototype._updateNodeAndLinkScale=function(){var r=this._model,n=r.getData(),i=ld(r);n.eachItemGraphicEl(function(a,o){a&&a.setSymbolScale(i)})},t.prototype.updateLayout=function(r){ux(r.getGraph(),ld(r)),this._symbolDraw.updateLayout(),this._lineDraw.updateLayout()},t.prototype.remove=function(){clearTimeout(this._layoutTimeout),this._layouting=!1,this._layoutTimeout=null,this._symbolDraw&&this._symbolDraw.remove(),this._lineDraw&&this._lineDraw.remove()},t.type="graph",t}(De);function hh(e){return"_EC_"+e}var HU=function(){function e(t){this.type="graph",this.nodes=[],this.edges=[],this._nodesMap={},this._edgesMap={},this._directed=t||!1}return e.prototype.isDirected=function(){return this._directed},e.prototype.addNode=function(t,r){t=t==null?""+r:""+t;var n=this._nodesMap;if(!n[hh(t)]){var i=new zl(t,r);return i.hostGraph=this,this.nodes.push(i),n[hh(t)]=i,i}},e.prototype.getNodeByIndex=function(t){var r=this.data.getRawIndex(t);return this.nodes[r]},e.prototype.getNodeById=function(t){return this._nodesMap[hh(t)]},e.prototype.addEdge=function(t,r,n){var i=this._nodesMap,a=this._edgesMap;if(Be(t)&&(t=this.nodes[t]),Be(r)&&(r=this.nodes[r]),t instanceof zl||(t=i[hh(t)]),r instanceof zl||(r=i[hh(r)]),!(!t||!r)){var o=t.id+"-"+r.id,s=new WU(t,r,n);return s.hostGraph=this,this._directed&&(t.outEdges.push(s),r.inEdges.push(s)),t.edges.push(s),t!==r&&r.edges.push(s),this.edges.push(s),a[o]=s,s}},e.prototype.getEdgeByIndex=function(t){var r=this.edgeData.getRawIndex(t);return this.edges[r]},e.prototype.getEdge=function(t,r){t instanceof zl&&(t=t.id),r instanceof zl&&(r=r.id);var n=this._edgesMap;return this._directed?n[t+"-"+r]:n[t+"-"+r]||n[r+"-"+t]},e.prototype.eachNode=function(t,r){for(var n=this.nodes,i=n.length,a=0;a<i;a++)n[a].dataIndex>=0&&t.call(r,n[a],a)},e.prototype.eachEdge=function(t,r){for(var n=this.edges,i=n.length,a=0;a<i;a++)n[a].dataIndex>=0&&n[a].node1.dataIndex>=0&&n[a].node2.dataIndex>=0&&t.call(r,n[a],a)},e.prototype.breadthFirstTraverse=function(t,r,n,i){if(r instanceof zl||(r=this._nodesMap[hh(r)]),!!r){for(var a=n==="out"?"outEdges":n==="in"?"inEdges":"edges",o=0;o<this.nodes.length;o++)this.nodes[o].__visited=!1;if(!t.call(i,r,null))for(var s=[r];s.length;)for(var l=s.shift(),u=l[a],o=0;o<u.length;o++){var h=u[o],f=h.node1===l?h.node2:h.node1;if(!f.__visited){if(t.call(i,f,l))return;s.push(f),f.__visited=!0}}}},e.prototype.update=function(){for(var t=this.data,r=this.edgeData,n=this.nodes,i=this.edges,a=0,o=n.length;a<o;a++)n[a].dataIndex=-1;for(var a=0,o=t.count();a<o;a++)n[t.getRawIndex(a)].dataIndex=a;r.filterSelf(function(s){var l=i[r.getRawIndex(s)];return l.node1.dataIndex>=0&&l.node2.dataIndex>=0});for(var a=0,o=i.length;a<o;a++)i[a].dataIndex=-1;for(var a=0,o=r.count();a<o;a++)i[r.getRawIndex(a)].dataIndex=a},e.prototype.clone=function(){for(var t=new e(this._directed),r=this.nodes,n=this.edges,i=0;i<r.length;i++)t.addNode(r[i].id,r[i].dataIndex);for(var i=0;i<n.length;i++){var a=n[i];t.addEdge(a.node1.id,a.node2.id,a.dataIndex)}return t},e}(),zl=function(){function e(t,r){this.inEdges=[],this.outEdges=[],this.edges=[],this.dataIndex=-1,this.id=t??"",this.dataIndex=r??-1}return e.prototype.degree=function(){return this.edges.length},e.prototype.inDegree=function(){return this.inEdges.length},e.prototype.outDegree=function(){return this.outEdges.length},e.prototype.getModel=function(t){if(!(this.dataIndex<0)){var r=this.hostGraph,n=r.data.getItemModel(this.dataIndex);return n.getModel(t)}},e.prototype.getAdjacentDataIndices=function(){for(var t={edge:[],node:[]},r=0;r<this.edges.length;r++){var n=this.edges[r];n.dataIndex<0||(t.edge.push(n.dataIndex),t.node.push(n.node1.dataIndex,n.node2.dataIndex))}return t},e.prototype.getTrajectoryDataIndices=function(){for(var t=Ut(),r=Ut(),n=0;n<this.edges.length;n++){var i=this.edges[n];if(!(i.dataIndex<0)){t.set(i.dataIndex,!0);for(var a=[i.node1],o=[i.node2],s=0;s<a.length;){var l=a[s];s++,r.set(l.dataIndex,!0);for(var u=0;u<l.inEdges.length;u++)t.set(l.inEdges[u].dataIndex,!0),a.push(l.inEdges[u].node1)}for(s=0;s<o.length;){var h=o[s];s++,r.set(h.dataIndex,!0);for(var u=0;u<h.outEdges.length;u++)t.set(h.outEdges[u].dataIndex,!0),o.push(h.outEdges[u].node2)}}}return{edge:t.keys(),node:r.keys()}},e}(),WU=function(){function e(t,r,n){this.dataIndex=-1,this.node1=t,this.node2=r,this.dataIndex=n??-1}return e.prototype.getModel=function(t){if(!(this.dataIndex<0)){var r=this.hostGraph,n=r.edgeData.getItemModel(this.dataIndex);return n.getModel(t)}},e.prototype.getAdjacentDataIndices=function(){return{edge:[this.dataIndex],node:[this.node1.dataIndex,this.node2.dataIndex]}},e.prototype.getTrajectoryDataIndices=function(){var t=Ut(),r=Ut();t.set(this.dataIndex,!0);for(var n=[this.node1],i=[this.node2],a=0;a<n.length;){var o=n[a];a++,r.set(o.dataIndex,!0);for(var s=0;s<o.inEdges.length;s++)t.set(o.inEdges[s].dataIndex,!0),n.push(o.inEdges[s].node1)}for(a=0;a<i.length;){var l=i[a];a++,r.set(l.dataIndex,!0);for(var s=0;s<l.outEdges.length;s++)t.set(l.outEdges[s].dataIndex,!0),i.push(l.outEdges[s].node2)}return{edge:t.keys(),node:r.keys()}},e}();function XU(e,t){return{getValue:function(r){var n=this[e][t];return n.getStore().get(n.getDimensionIndex(r||"value"),this.dataIndex)},setVisual:function(r,n){this.dataIndex>=0&&this[e][t].setItemVisual(this.dataIndex,r,n)},getVisual:function(r){return this[e][t].getItemVisual(this.dataIndex,r)},setLayout:function(r,n){this.dataIndex>=0&&this[e][t].setItemLayout(this.dataIndex,r,n)},getLayout:function(){return this[e][t].getItemLayout(this.dataIndex)},getGraphicEl:function(){return this[e][t].getItemGraphicEl(this.dataIndex)},getRawIndex:function(){return this[e][t].getRawIndex(this.dataIndex)}}}Nr(zl,XU("hostGraph","data"));Nr(WU,XU("hostGraph","edgeData"));function YU(e,t,r,n,i){for(var a=new HU(n),o=0;o<e.length;o++)a.addNode(pn(e[o].id,e[o].name,o),o);for(var s=[],l=[],u=0,o=0;o<t.length;o++){var h=t[o],f=h.source,c=h.target;a.addEdge(f,c,u)&&(l.push(h),s.push(pn(Xr(h.id,null),f+" > "+c)),u++)}var d=r.get("coordinateSystem"),v;if(d==="cartesian2d"||d==="polar")v=Qa(e,r);else{var p=Yf.get(d),g=p?p.dimensions||[]:[];pe(g,"value")<0&&g.concat(["value"]);var m=Kf(e,{coordDimensions:g,encodeDefine:r.getEncode()}).dimensions;v=new xr(m,r),v.initData(e)}var _=new xr(["value"],r);return _.initData(l,s),i&&i(v,_),uM({mainData:v,struct:a,structAttr:"graph",datas:{node:v,edge:_},datasAttr:{node:"data",edge:"edgeData"}}),a.update(),a}var v$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments);var n=this;function i(){return n._categoriesData}this.legendVisualProvider=new Nv(i,i),this.fillDataTextStyle(r.edges||r.links),this._updateCategoriesData()},t.prototype.mergeOption=function(r){e.prototype.mergeOption.apply(this,arguments),this.fillDataTextStyle(r.edges||r.links),this._updateCategoriesData()},t.prototype.mergeDefaultAndTheme=function(r){e.prototype.mergeDefaultAndTheme.apply(this,arguments),Su(r,"edgeLabel",["show"])},t.prototype.getInitialData=function(r,n){var i=r.edges||r.links||[],a=r.data||r.nodes||[],o=this;{e$(this);var s=YU(a,i,this,!0,l);return R(s.edges,function(u){r$(u.node1,u.node2,this,u.dataIndex)},this),s.data}function l(u,h){u.wrapMethod("getItemModel",function(v){var p=o._categoriesModels,g=v.getShallow("category"),m=p[g];return m&&(m.parentModel=v.parentModel,v.parentModel=m),v});var f=Ie.prototype.getModel;function c(v,p){var g=f.call(this,v,p);return g.resolveParentPath=d,g}h.wrapMethod("getItemModel",function(v){return v.resolveParentPath=d,v.getModel=c,v});function d(v){if(v&&(v[0]==="label"||v[1]==="label")){var p=v.slice();return v[0]==="label"?p[0]="edgeLabel":v[1]==="label"&&(p[1]="edgeLabel"),p}return v}}},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.getCategoriesData=function(){return this._categoriesData},t.prototype.formatTooltip=function(r,n,i){if(i==="edge"){var a=this.getData(),o=this.getDataParams(r,i),s=a.graph.getEdgeByIndex(r),l=a.getName(s.node1.dataIndex),u=a.getName(s.node2.dataIndex),h=[];return l!=null&&h.push(l),u!=null&&h.push(u),on("nameValue",{name:h.join(" > "),value:o.value,noValue:o.value==null})}var f=hF({series:this,dataIndex:r,multipleSeries:n});return f},t.prototype._updateCategoriesData=function(){var r=ft(this.option.categories||[],function(i){return i.value!=null?i:rt({value:0},i)}),n=new xr(["value"],this);n.initData(r),this._categoriesData=n,this._categoriesModels=n.mapArray(function(i){return n.getItemModel(i)})},t.prototype.setZoom=function(r){this.option.zoom=r},t.prototype.setCenter=function(r){this.option.center=r},t.prototype.isAnimationEnabled=function(){return e.prototype.isAnimationEnabled.call(this)&&!(this.get("layout")==="force"&&this.get(["force","layoutAnimation"]))},t.type="series.graph",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={z:2,coordinateSystem:"view",legendHoverLink:!0,layout:null,circular:{rotateLabel:!1},force:{initLayout:null,repulsion:[0,50],gravity:.1,friction:.6,edgeLength:30,layoutAnimation:!0},left:"center",top:"center",symbol:"circle",symbolSize:10,edgeSymbol:["none","none"],edgeSymbolSize:10,edgeLabel:{position:"middle",distance:5},draggable:!1,roam:!1,center:null,zoom:1,nodeScaleRatio:.6,label:{show:!1,formatter:"{b}"},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{scale:!0,label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},t}(Ue),p$={type:"graphRoam",event:"graphRoam",update:"none"};function g$(e){e.registerChartView(d$),e.registerSeriesModel(v$),e.registerProcessor(Kq),e.registerVisual(jq),e.registerVisual(Jq),e.registerLayout(n$),e.registerLayout(e.PRIORITY.VISUAL.POST_CHART_LAYOUT,a$),e.registerLayout(s$),e.registerCoordinateSystem("graphView",{dimensions:Fv.dimensions,create:u$}),e.registerAction({type:"focusNodeAdjacency",event:"focusNodeAdjacency",update:"series:focusNodeAdjacency"},Rr),e.registerAction({type:"unfocusNodeAdjacency",event:"unfocusNodeAdjacency",update:"series:unfocusNodeAdjacency"},Rr),e.registerAction(p$,function(t,r,n){r.eachComponent({mainType:"series",query:t},function(i){var a=i.coordinateSystem,o=lM(a,t,void 0,n);i.setCenter&&i.setCenter(o.center),i.setZoom&&i.setZoom(o.zoom)})})}var m$=function(){function e(){this.angle=0,this.width=10,this.r=10,this.x=0,this.y=0}return e}(),_$=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="pointer",n}return t.prototype.getDefaultShape=function(){return new m$},t.prototype.buildPath=function(r,n){var i=Math.cos,a=Math.sin,o=n.r,s=n.width,l=n.angle,u=n.x-i(l)*s*(s>=o/3?1:2),h=n.y-a(l)*s*(s>=o/3?1:2);l=n.angle-Math.PI/2,r.moveTo(u,h),r.lineTo(n.x+i(l)*s,n.y+a(l)*s),r.lineTo(n.x+i(n.angle)*o,n.y+a(n.angle)*o),r.lineTo(n.x-i(l)*s,n.y-a(l)*s),r.lineTo(u,h)},t}(_e);function y$(e,t){var r=e.get("center"),n=t.getWidth(),i=t.getHeight(),a=Math.min(n,i),o=Tt(r[0],t.getWidth()),s=Tt(r[1],t.getHeight()),l=Tt(e.get("radius"),a/2);return{cx:o,cy:s,r:l}}function zp(e,t){var r=e==null?"":e+"";return t&&(Ct(t)?r=t.replace("{value}",r):Yt(t)&&(r=t(e))),r}var x$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){this.group.removeAll();var a=r.get(["axisLine","lineStyle","color"]),o=y$(r,i);this._renderMain(r,n,i,a,o),this._data=r.getData()},t.prototype.dispose=function(){},t.prototype._renderMain=function(r,n,i,a,o){var s=this.group,l=r.get("clockwise"),u=-r.get("startAngle")/180*Math.PI,h=-r.get("endAngle")/180*Math.PI,f=r.getModel("axisLine"),c=f.get("roundCap"),d=c?km:Xn,v=f.get("show"),p=f.getModel("lineStyle"),g=p.get("width"),m=[u,h];iw(m,!l),u=m[0],h=m[1];for(var _=h-u,y=u,x=[],T=0;v&&T<a.length;T++){var S=Math.min(Math.max(a[T][0],0),1);h=u+_*S;var M=new d({shape:{startAngle:y,endAngle:h,cx:o.cx,cy:o.cy,clockwise:l,r0:o.r-g,r:o.r},silent:!0});M.setStyle({fill:a[T][1]}),M.setStyle(p.getLineStyle(["color","width"])),x.push(M),y=h}x.reverse(),R(x,function(b){return s.add(b)});var w=function(b){if(b<=0)return a[0][1];var A;for(A=0;A<a.length;A++)if(a[A][0]>=b&&(A===0?0:a[A-1][0])<b)return a[A][1];return a[A-1][1]};this._renderTicks(r,n,i,w,o,u,h,l,g),this._renderTitleAndDetail(r,n,i,w,o),this._renderAnchor(r,o),this._renderPointer(r,n,i,w,o,u,h,l,g)},t.prototype._renderTicks=function(r,n,i,a,o,s,l,u,h){for(var f=this.group,c=o.cx,d=o.cy,v=o.r,p=+r.get("min"),g=+r.get("max"),m=r.getModel("splitLine"),_=r.getModel("axisTick"),y=r.getModel("axisLabel"),x=r.get("splitNumber"),T=_.get("splitNumber"),S=Tt(m.get("length"),v),M=Tt(_.get("length"),v),w=s,b=(l-s)/x,A=b/T,E=m.getModel("lineStyle").getLineStyle(),C=_.getModel("lineStyle").getLineStyle(),D=m.get("distance"),L,P,N=0;N<=x;N++){if(L=Math.cos(w),P=Math.sin(w),m.get("show")){var O=D?D+h:h,I=new jr({shape:{x1:L*(v-O)+c,y1:P*(v-O)+d,x2:L*(v-S-O)+c,y2:P*(v-S-O)+d},style:E,silent:!0});E.stroke==="auto"&&I.setStyle({stroke:a(N/x)}),f.add(I)}if(y.get("show")){var O=y.get("distance")+D,k=zp(dr(N/x*(g-p)+p),y.get("formatter")),z=a(N/x),X=L*(v-S-O)+c,Y=P*(v-S-O)+d,$=y.get("rotate"),H=0;$==="radial"?(H=-w+2*Math.PI,H>Math.PI/2&&(H+=Math.PI)):$==="tangential"?H=-w-Math.PI/2:Be($)&&(H=$*Math.PI/180),H===0?f.add(new we({style:je(y,{text:k,x:X,y:Y,verticalAlign:P<-.8?"top":P>.8?"bottom":"middle",align:L<-.4?"left":L>.4?"right":"center"},{inheritColor:z}),silent:!0})):f.add(new we({style:je(y,{text:k,x:X,y:Y,verticalAlign:"middle",align:"center"},{inheritColor:z}),silent:!0,originX:X,originY:Y,rotation:H}))}if(_.get("show")&&N!==x){var O=_.get("distance");O=O?O+h:h;for(var Z=0;Z<=T;Z++){L=Math.cos(w),P=Math.sin(w);var ct=new jr({shape:{x1:L*(v-O)+c,y1:P*(v-O)+d,x2:L*(v-M-O)+c,y2:P*(v-M-O)+d},silent:!0,style:C});C.stroke==="auto"&&ct.setStyle({stroke:a((N+Z/T)/x)}),f.add(ct),w+=A}w-=A}else w+=b}},t.prototype._renderPointer=function(r,n,i,a,o,s,l,u,h){var f=this.group,c=this._data,d=this._progressEls,v=[],p=r.get(["pointer","show"]),g=r.getModel("progress"),m=g.get("show"),_=r.getData(),y=_.mapDimension("value"),x=+r.get("min"),T=+r.get("max"),S=[x,T],M=[s,l];function w(A,E){var C=_.getItemModel(A),D=C.getModel("pointer"),L=Tt(D.get("width"),o.r),P=Tt(D.get("length"),o.r),N=r.get(["pointer","icon"]),O=D.get("offsetCenter"),I=Tt(O[0],o.r),k=Tt(O[1],o.r),z=D.get("keepAspect"),X;return N?X=Pr(N,I-L/2,k-P,L,P,null,z):X=new _$({shape:{angle:-Math.PI/2,width:L,r:P,x:I,y:k}}),X.rotation=-(E+Math.PI/2),X.x=o.cx,X.y=o.cy,X}function b(A,E){var C=g.get("roundCap"),D=C?km:Xn,L=g.get("overlap"),P=L?g.get("width"):h/_.count(),N=L?o.r-P:o.r-(A+1)*P,O=L?o.r:o.r-A*P,I=new D({shape:{startAngle:s,endAngle:E,cx:o.cx,cy:o.cy,clockwise:u,r0:N,r:O}});return L&&(I.z2=He(_.get(y,A),[x,T],[100,0],!0)),I}(m||p)&&(_.diff(c).add(function(A){var E=_.get(y,A);if(p){var C=w(A,s);vr(C,{rotation:-((isNaN(+E)?M[0]:He(E,S,M,!0))+Math.PI/2)},r),f.add(C),_.setItemGraphicEl(A,C)}if(m){var D=b(A,s),L=g.get("clip");vr(D,{shape:{endAngle:He(E,S,M,L)}},r),f.add(D),wS(r.seriesIndex,_.dataType,A,D),v[A]=D}}).update(function(A,E){var C=_.get(y,A);if(p){var D=c.getItemGraphicEl(E),L=D?D.rotation:s,P=w(A,L);P.rotation=L,ke(P,{rotation:-((isNaN(+C)?M[0]:He(C,S,M,!0))+Math.PI/2)},r),f.add(P),_.setItemGraphicEl(A,P)}if(m){var N=d[E],O=N?N.shape.endAngle:s,I=b(A,O),k=g.get("clip");ke(I,{shape:{endAngle:He(C,S,M,k)}},r),f.add(I),wS(r.seriesIndex,_.dataType,A,I),v[A]=I}}).execute(),_.each(function(A){var E=_.getItemModel(A),C=E.getModel("emphasis"),D=C.get("focus"),L=C.get("blurScope"),P=C.get("disabled");if(p){var N=_.getItemGraphicEl(A),O=_.getItemVisual(A,"style"),I=O.fill;if(N instanceof hn){var k=N.style;N.useStyle(rt({image:k.image,x:k.x,y:k.y,width:k.width,height:k.height},O))}else N.useStyle(O),N.type!=="pointer"&&N.setColor(I);N.setStyle(E.getModel(["pointer","itemStyle"]).getItemStyle()),N.style.fill==="auto"&&N.setStyle("fill",a(He(_.get(y,A),S,[0,1],!0))),N.z2EmphasisLift=0,xn(N,E),Sr(N,D,L,P)}if(m){var z=v[A];z.useStyle(_.getItemVisual(A,"style")),z.setStyle(E.getModel(["progress","itemStyle"]).getItemStyle()),z.z2EmphasisLift=0,xn(z,E),Sr(z,D,L,P)}}),this._progressEls=v)},t.prototype._renderAnchor=function(r,n){var i=r.getModel("anchor"),a=i.get("show");if(a){var o=i.get("size"),s=i.get("icon"),l=i.get("offsetCenter"),u=i.get("keepAspect"),h=Pr(s,n.cx-o/2+Tt(l[0],n.r),n.cy-o/2+Tt(l[1],n.r),o,o,null,u);h.z2=i.get("showAbove")?1:0,h.setStyle(i.getModel("itemStyle").getItemStyle()),this.group.add(h)}},t.prototype._renderTitleAndDetail=function(r,n,i,a,o){var s=this,l=r.getData(),u=l.mapDimension("value"),h=+r.get("min"),f=+r.get("max"),c=new re,d=[],v=[],p=r.isAnimationEnabled(),g=r.get(["pointer","showAbove"]);l.diff(this._data).add(function(m){d[m]=new we({silent:!0}),v[m]=new we({silent:!0})}).update(function(m,_){d[m]=s._titleEls[_],v[m]=s._detailEls[_]}).execute(),l.each(function(m){var _=l.getItemModel(m),y=l.get(u,m),x=new re,T=a(He(y,[h,f],[0,1],!0)),S=_.getModel("title");if(S.get("show")){var M=S.get("offsetCenter"),w=o.cx+Tt(M[0],o.r),b=o.cy+Tt(M[1],o.r),A=d[m];A.attr({z2:g?0:2,style:je(S,{x:w,y:b,text:l.getName(m),align:"center",verticalAlign:"middle"},{inheritColor:T})}),x.add(A)}var E=_.getModel("detail");if(E.get("show")){var C=E.get("offsetCenter"),D=o.cx+Tt(C[0],o.r),L=o.cy+Tt(C[1],o.r),P=Tt(E.get("width"),o.r),N=Tt(E.get("height"),o.r),O=r.get(["progress","show"])?l.getItemVisual(m,"style").fill:T,A=v[m],I=E.get("formatter");A.attr({z2:g?0:2,style:je(E,{x:D,y:L,text:zp(y,I),width:isNaN(P)?null:P,height:isNaN(N)?null:N,align:"center",verticalAlign:"middle"},{inheritColor:O})}),p3(A,{normal:E},y,function(z){return zp(z,I)}),p&&g3(A,m,l,r,{getFormattedLabel:function(z,X,Y,$,H,Z){return zp(Z?Z.interpolatedValue:y,I)}}),x.add(A)}c.add(x)}),this.group.add(c),this._titleEls=d,this._detailEls=v},t.type="gauge",t}(De),S$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.visualStyleAccessPath="itemStyle",r}return t.prototype.getInitialData=function(r,n){return Qf(this,["value"])},t.type="series.gauge",t.defaultOption={z:2,colorBy:"data",center:["50%","50%"],legendHoverLink:!0,radius:"75%",startAngle:225,endAngle:-45,clockwise:!0,min:0,max:100,splitNumber:10,axisLine:{show:!0,roundCap:!1,lineStyle:{color:[[1,"#E6EBF8"]],width:10}},progress:{show:!1,overlap:!0,width:10,roundCap:!1,clip:!0},splitLine:{show:!0,length:10,distance:10,lineStyle:{color:"#63677A",width:3,type:"solid"}},axisTick:{show:!0,splitNumber:5,length:6,distance:10,lineStyle:{color:"#63677A",width:1,type:"solid"}},axisLabel:{show:!0,distance:15,color:"#464646",fontSize:12,rotate:0},pointer:{icon:null,offsetCenter:[0,0],show:!0,showAbove:!0,length:"60%",width:6,keepAspect:!1},anchor:{show:!1,showAbove:!1,size:6,icon:"circle",offsetCenter:[0,0],keepAspect:!1,itemStyle:{color:"#fff",borderWidth:0,borderColor:"#5470c6"}},title:{show:!0,offsetCenter:[0,"20%"],color:"#464646",fontSize:16,valueAnimation:!1},detail:{show:!0,backgroundColor:"rgba(0,0,0,0)",borderWidth:0,borderColor:"#ccc",width:100,height:null,padding:[5,10],offsetCenter:[0,"40%"],color:"#464646",fontSize:30,fontWeight:"bold",lineHeight:30,valueAnimation:!1}},t}(Ue);function T$(e){e.registerChartView(x$),e.registerSeriesModel(S$)}var b$=["itemStyle","opacity"],w$=function(e){q(t,e);function t(r,n){var i=e.call(this)||this,a=i,o=new $n,s=new we;return a.setTextContent(s),i.setTextGuideLine(o),i.updateData(r,n,!0),i}return t.prototype.updateData=function(r,n,i){var a=this,o=r.hostModel,s=r.getItemModel(n),l=r.getItemLayout(n),u=s.getModel("emphasis"),h=s.get(b$);h=h??1,i||ya(a),a.useStyle(r.getItemVisual(n,"style")),a.style.lineJoin="round",i?(a.setShape({points:l.points}),a.style.opacity=0,vr(a,{style:{opacity:h}},o,n)):ke(a,{style:{opacity:h},shape:{points:l.points}},o,n),xn(a,s),this._updateLabel(r,n),Sr(this,u.get("focus"),u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(r,n){var i=this,a=this.getTextGuideLine(),o=i.getTextContent(),s=r.hostModel,l=r.getItemModel(n),u=r.getItemLayout(n),h=u.label,f=r.getItemVisual(n,"style"),c=f.fill;Sn(o,an(l),{labelFetcher:r.hostModel,labelDataIndex:n,defaultOpacity:f.opacity,defaultText:r.getName(n)},{normal:{align:h.textAlign,verticalAlign:h.verticalAlign}}),i.setTextConfig({local:!0,inside:!!h.inside,insideStroke:c,outsideFill:c});var d=h.linePoints;a.setShape({points:d}),i.textGuideLineConfig={anchor:d?new he(d[0][0],d[0][1]):null},ke(o,{style:{x:h.x,y:h.y}},s,n),o.attr({rotation:h.rotation,originX:h.x,originY:h.y,z2:10}),Zw(i,qw(l),{stroke:c})},t}(Yn),M$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.ignoreLabelLineUpdate=!0,r}return t.prototype.render=function(r,n,i){var a=r.getData(),o=this._data,s=this.group;a.diff(o).add(function(l){var u=new w$(a,l);a.setItemGraphicEl(l,u),s.add(u)}).update(function(l,u){var h=o.getItemGraphicEl(u);h.updateData(a,l),s.add(h),a.setItemGraphicEl(l,h)}).remove(function(l){var u=o.getItemGraphicEl(l);Gd(u,r,l)}).execute(),this._data=a},t.prototype.remove=function(){this.group.removeAll(),this._data=null},t.prototype.dispose=function(){},t.type="funnel",t}(De),A$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new Nv(It(this.getData,this),It(this.getRawData,this)),this._defaultLabelLine(r)},t.prototype.getInitialData=function(r,n){return Qf(this,{coordDimensions:["value"],encodeDefaulter:ue(Tw,this)})},t.prototype._defaultLabelLine=function(r){Su(r,"labelLine",["show"]);var n=r.labelLine,i=r.emphasis.labelLine;n.show=n.show&&r.label.show,i.show=i.show&&r.emphasis.label.show},t.prototype.getDataParams=function(r){var n=this.getData(),i=e.prototype.getDataParams.call(this,r),a=n.mapDimension("value"),o=n.getSum(a);return i.percent=o?+(n.get(a,r)/o*100).toFixed(2):0,i.$vars.push("percent"),i},t.type="series.funnel",t.defaultOption={z:2,legendHoverLink:!0,colorBy:"data",left:80,top:60,right:80,bottom:60,minSize:"0%",maxSize:"100%",sort:"descending",orient:"vertical",gap:0,funnelAlign:"center",label:{show:!0,position:"outer"},labelLine:{show:!0,length:20,lineStyle:{width:1}},itemStyle:{borderColor:"#fff",borderWidth:1},emphasis:{label:{show:!0}},select:{itemStyle:{borderColor:"#212121"}}},t}(Ue);function E$(e,t){return Mr(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function C$(e,t){for(var r=e.mapDimension("value"),n=e.mapArray(r,function(l){return l}),i=[],a=t==="ascending",o=0,s=e.count();o<s;o++)i[o]=o;return Yt(t)?i.sort(t):t!=="none"&&i.sort(function(l,u){return a?n[l]-n[u]:n[u]-n[l]}),i}function D$(e){var t=e.hostModel,r=t.get("orient");e.each(function(n){var i=e.getItemModel(n),a=i.getModel("label"),o=a.get("position"),s=i.getModel("labelLine"),l=e.getItemLayout(n),u=l.points,h=o==="inner"||o==="inside"||o==="center"||o==="insideLeft"||o==="insideRight",f,c,d,v;if(h)o==="insideLeft"?(c=(u[0][0]+u[3][0])/2+5,d=(u[0][1]+u[3][1])/2,f="left"):o==="insideRight"?(c=(u[1][0]+u[2][0])/2-5,d=(u[1][1]+u[2][1])/2,f="right"):(c=(u[0][0]+u[1][0]+u[2][0]+u[3][0])/4,d=(u[0][1]+u[1][1]+u[2][1]+u[3][1])/4,f="center"),v=[[c,d],[c,d]];else{var p=void 0,g=void 0,m=void 0,_=void 0,y=s.get("length");o==="left"?(p=(u[3][0]+u[0][0])/2,g=(u[3][1]+u[0][1])/2,m=p-y,c=m-5,f="right"):o==="right"?(p=(u[1][0]+u[2][0])/2,g=(u[1][1]+u[2][1])/2,m=p+y,c=m+5,f="left"):o==="top"?(p=(u[3][0]+u[0][0])/2,g=(u[3][1]+u[0][1])/2,_=g-y,d=_-5,f="center"):o==="bottom"?(p=(u[1][0]+u[2][0])/2,g=(u[1][1]+u[2][1])/2,_=g+y,d=_+5,f="center"):o==="rightTop"?(p=r==="horizontal"?u[3][0]:u[1][0],g=r==="horizontal"?u[3][1]:u[1][1],r==="horizontal"?(_=g-y,d=_-5,f="center"):(m=p+y,c=m+5,f="top")):o==="rightBottom"?(p=u[2][0],g=u[2][1],r==="horizontal"?(_=g+y,d=_+5,f="center"):(m=p+y,c=m+5,f="bottom")):o==="leftTop"?(p=u[0][0],g=r==="horizontal"?u[0][1]:u[1][1],r==="horizontal"?(_=g-y,d=_-5,f="center"):(m=p-y,c=m-5,f="right")):o==="leftBottom"?(p=r==="horizontal"?u[1][0]:u[3][0],g=r==="horizontal"?u[1][1]:u[2][1],r==="horizontal"?(_=g+y,d=_+5,f="center"):(m=p-y,c=m-5,f="right")):(p=(u[1][0]+u[2][0])/2,g=(u[1][1]+u[2][1])/2,r==="horizontal"?(_=g+y,d=_+5,f="center"):(m=p+y,c=m+5,f="left")),r==="horizontal"?(m=p,c=m):(_=g,d=_),v=[[p,g],[m,_]]}l.label={linePoints:v,x:c,y:d,verticalAlign:"middle",textAlign:f,inside:h}})}function L$(e,t){e.eachSeriesByType("funnel",function(r){var n=r.getData(),i=n.mapDimension("value"),a=r.get("sort"),o=E$(r,t),s=r.get("orient"),l=o.width,u=o.height,h=C$(n,a),f=o.x,c=o.y,d=s==="horizontal"?[Tt(r.get("minSize"),u),Tt(r.get("maxSize"),u)]:[Tt(r.get("minSize"),l),Tt(r.get("maxSize"),l)],v=n.getDataExtent(i),p=r.get("min"),g=r.get("max");p==null&&(p=Math.min(v[0],0)),g==null&&(g=v[1]);var m=r.get("funnelAlign"),_=r.get("gap"),y=s==="horizontal"?l:u,x=(y-_*(n.count()-1))/n.count(),T=function(L,P){if(s==="horizontal"){var N=n.get(i,L)||0,O=He(N,[p,g],d,!0),I=void 0;switch(m){case"top":I=c;break;case"center":I=c+(u-O)/2;break;case"bottom":I=c+(u-O);break}return[[P,I],[P,I+O]]}var k=n.get(i,L)||0,z=He(k,[p,g],d,!0),X;switch(m){case"left":X=f;break;case"center":X=f+(l-z)/2;break;case"right":X=f+l-z;break}return[[X,P],[X+z,P]]};a==="ascending"&&(x=-x,_=-_,s==="horizontal"?f+=l:c+=u,h=h.reverse());for(var S=0;S<h.length;S++){var M=h[S],w=h[S+1],b=n.getItemModel(M);if(s==="horizontal"){var A=b.get(["itemStyle","width"]);A==null?A=x:(A=Tt(A,l),a==="ascending"&&(A=-A));var E=T(M,f),C=T(w,f+A);f+=A+_,n.setItemLayout(M,{points:E.concat(C.slice().reverse())})}else{var D=b.get(["itemStyle","height"]);D==null?D=x:(D=Tt(D,u),a==="ascending"&&(D=-D));var E=T(M,c),C=T(w,c+D);c+=D+_,n.setItemLayout(M,{points:E.concat(C.slice().reverse())})}}D$(n)})}function R$(e){e.registerChartView(M$),e.registerSeriesModel(A$),e.registerLayout(L$),e.registerProcessor(Iv("funnel"))}var P$=.3,I$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._dataGroup=new re,r._initialized=!1,r}return t.prototype.init=function(){this.group.add(this._dataGroup)},t.prototype.render=function(r,n,i,a){this._progressiveEls=null;var o=this._dataGroup,s=r.getData(),l=this._data,u=r.coordinateSystem,h=u.dimensions,f=sL(r);s.diff(l).add(c).update(d).remove(v).execute();function c(g){var m=oL(s,o,g,h,u);hx(m,s,g,f)}function d(g,m){var _=l.getItemGraphicEl(m),y=ZU(s,g,h,u);s.setItemGraphicEl(g,_),ke(_,{shape:{points:y}},r,g),ya(_),hx(_,s,g,f)}function v(g){var m=l.getItemGraphicEl(g);o.remove(m)}if(!this._initialized){this._initialized=!0;var p=N$(u,r,function(){setTimeout(function(){o.removeClipPath()})});o.setClipPath(p)}this._data=s},t.prototype.incrementalPrepareRender=function(r,n,i){this._initialized=!0,this._data=null,this._dataGroup.removeAll()},t.prototype.incrementalRender=function(r,n,i){for(var a=n.getData(),o=n.coordinateSystem,s=o.dimensions,l=sL(n),u=this._progressiveEls=[],h=r.start;h<r.end;h++){var f=oL(a,this._dataGroup,h,s,o);f.incremental=!0,hx(f,a,h,l),u.push(f)}},t.prototype.remove=function(){this._dataGroup&&this._dataGroup.removeAll(),this._data=null},t.type="parallel",t}(De);function N$(e,t,r){var n=e.model,i=e.getRect(),a=new Ae({shape:{x:i.x,y:i.y,width:i.width,height:i.height}}),o=n.get("layout")==="horizontal"?"width":"height";return a.setShape(o,0),vr(a,{shape:{width:i.width,height:i.height}},t,r),a}function ZU(e,t,r,n){for(var i=[],a=0;a<r.length;a++){var o=r[a],s=e.get(e.mapDimension(o),t);O$(s,n.getAxis(o).type)||i.push(n.dataToPoint(s,o))}return i}function oL(e,t,r,n,i){var a=ZU(e,r,n,i),o=new $n({shape:{points:a},z2:10});return t.add(o),e.setItemGraphicEl(r,o),o}function sL(e){var t=e.get("smooth",!0);return t===!0&&(t=P$),t=Ro(t),Id(t)&&(t=0),{smooth:t}}function hx(e,t,r,n){e.useStyle(t.getItemVisual(r,"style")),e.style.fill=null,e.setShape("smooth",n.smooth);var i=t.getItemModel(r),a=i.getModel("emphasis");xn(e,i,"lineStyle"),Sr(e,a.get("focus"),a.get("blurScope"),a.get("disabled"))}function O$(e,t){return t==="category"?e==null:e==null||isNaN(e)}var F$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.visualStyleAccessPath="lineStyle",r.visualDrawType="stroke",r}return t.prototype.getInitialData=function(r,n){return Qa(null,this,{useEncodeDefaulter:It(B$,null,this)})},t.prototype.getRawIndicesByActiveState=function(r){var n=this.coordinateSystem,i=this.getData(),a=[];return n.eachActiveState(i,function(o,s){r===o&&a.push(i.getRawIndex(s))}),a},t.type="series.parallel",t.dependencies=["parallel"],t.defaultOption={z:2,coordinateSystem:"parallel",parallelIndex:0,label:{show:!1},inactiveOpacity:.05,activeOpacity:1,lineStyle:{width:1,opacity:.45,type:"solid"},emphasis:{label:{show:!1}},progressive:500,smooth:!1,animationEasing:"linear"},t}(Ue);function B$(e){var t=e.ecModel.getComponent("parallel",e.get("parallelIndex"));if(t){var r={};return R(t.dimensions,function(n){var i=U$(n);r[n]=i}),r}}function U$(e){return+e.replace("dim","")}var z$=["lineStyle","opacity"],k$={seriesType:"parallel",reset:function(e,t){var r=e.coordinateSystem,n={normal:e.get(["lineStyle","opacity"]),active:e.get("activeOpacity"),inactive:e.get("inactiveOpacity")};return{progress:function(i,a){r.eachActiveState(a,function(o,s){var l=n[o];if(o==="normal"&&a.hasItemOption){var u=a.getItemModel(s).get(z$,!0);u!=null&&(l=u)}var h=a.ensureUniqueItemVisual(s,"style");h.opacity=l},i.start,i.end)}}}};function G$(e){V$(e),H$(e)}function V$(e){if(!e.parallel){var t=!1;R(e.series,function(r){r&&r.type==="parallel"&&(t=!0)}),t&&(e.parallel=[{}])}}function H$(e){var t=er(e.parallelAxis);R(t,function(r){if(Kt(r)){var n=r.parallelIndex||0,i=er(e.parallel)[n];i&&i.parallelAxisDefault&&Ot(r,i.parallelAxisDefault,!1)}})}var W$=5,X$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){this._model=r,this._api=i,this._handlers||(this._handlers={},R(Y$,function(a,o){i.getZr().on(o,this._handlers[o]=It(a,this))},this)),qf(this,"_throttledDispatchExpand",r.get("axisExpandRate"),"fixRate")},t.prototype.dispose=function(r,n){Xd(this,"_throttledDispatchExpand"),R(this._handlers,function(i,a){n.getZr().off(a,i)}),this._handlers=null},t.prototype._throttledDispatchExpand=function(r){this._dispatchExpand(r)},t.prototype._dispatchExpand=function(r){r&&this._api.dispatchAction(rt({type:"parallelAxisExpand"},r))},t.type="parallel",t}(nr),Y$={mousedown:function(e){fx(this,"click")&&(this._mouseDownPoint=[e.offsetX,e.offsetY])},mouseup:function(e){var t=this._mouseDownPoint;if(fx(this,"click")&&t){var r=[e.offsetX,e.offsetY],n=Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2);if(n>W$)return;var i=this._model.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]);i.behavior!=="none"&&this._dispatchExpand({axisExpandWindow:i.axisExpandWindow})}this._mouseDownPoint=null},mousemove:function(e){if(!(this._mouseDownPoint||!fx(this,"mousemove"))){var t=this._model,r=t.coordinateSystem.getSlidedAxisExpandWindow([e.offsetX,e.offsetY]),n=r.behavior;n==="jump"&&this._throttledDispatchExpand.debounceNextCall(t.get("axisExpandDebounce")),this._throttledDispatchExpand(n==="none"?null:{axisExpandWindow:r.axisExpandWindow,animation:n==="jump"?null:{duration:0}})}}};function fx(e,t){var r=e._model;return r.get("axisExpandable")&&r.get("axisExpandTriggerOn")===t}var Z$=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){e.prototype.init.apply(this,arguments),this.mergeOption({})},t.prototype.mergeOption=function(r){var n=this.option;r&&Ot(n,r,!0),this._initDimensions()},t.prototype.contains=function(r,n){var i=r.get("parallelIndex");return i!=null&&n.getComponent("parallel",i)===this},t.prototype.setAxisExpand=function(r){R(["axisExpandable","axisExpandCenter","axisExpandCount","axisExpandWidth","axisExpandWindow"],function(n){r.hasOwnProperty(n)&&(this.option[n]=r[n])},this)},t.prototype._initDimensions=function(){var r=this.dimensions=[],n=this.parallelAxisIndex=[],i=Xe(this.ecModel.queryComponents({mainType:"parallelAxis"}),function(a){return(a.get("parallelIndex")||0)===this.componentIndex},this);R(i,function(a){r.push("dim"+a.get("dim")),n.push(a.componentIndex)})},t.type="parallel",t.dependencies=["parallelAxis"],t.layoutMode="box",t.defaultOption={z:0,left:80,top:60,right:80,bottom:60,layout:"horizontal",axisExpandable:!1,axisExpandCenter:null,axisExpandCount:0,axisExpandWidth:50,axisExpandRate:17,axisExpandDebounce:50,axisExpandSlideTriggerArea:[-.15,.05,.4],axisExpandTriggerOn:"click",parallelAxisDefault:null},t}(me),q$=function(e){q(t,e);function t(r,n,i,a,o){var s=e.call(this,r,n,i)||this;return s.type=a||"value",s.axisIndex=o,s}return t.prototype.isHorizontal=function(){return this.coordinateSystem.getModel().get("layout")!=="horizontal"},t}(Kn);function Wu(e,t,r,n,i,a){e=e||0;var o=r[1]-r[0];if(i!=null&&(i=fh(i,[0,o])),a!=null&&(a=Math.max(a,i??0)),n==="all"){var s=Math.abs(t[1]-t[0]);s=fh(s,[0,o]),i=a=fh(s,[i,a]),n=0}t[0]=fh(t[0],r),t[1]=fh(t[1],r);var l=cx(t,n);t[n]+=e;var u=i||0,h=r.slice();l.sign<0?h[0]+=u:h[1]-=u,t[n]=fh(t[n],h);var f;return f=cx(t,n),i!=null&&(f.sign!==l.sign||f.span<i)&&(t[1-n]=t[n]+l.sign*i),f=cx(t,n),a!=null&&f.span>a&&(t[1-n]=t[n]+f.sign*a),t}function cx(e,t){var r=e[t]-e[1-t];return{span:Math.abs(r),sign:r>0?-1:r<0?1:t?-1:1}}function fh(e,t){return Math.min(t[1]!=null?t[1]:1/0,Math.max(t[0]!=null?t[0]:-1/0,e))}var dx=R,qU=Math.min,$U=Math.max,lL=Math.floor,$$=Math.ceil,uL=dr,K$=Math.PI,j$=function(){function e(t,r,n){this.type="parallel",this._axesMap=Ut(),this._axesLayout={},this.dimensions=t.dimensions,this._model=t,this._init(t,r,n)}return e.prototype._init=function(t,r,n){var i=t.dimensions,a=t.parallelAxisIndex;dx(i,function(o,s){var l=a[s],u=r.getComponent("parallelAxis",l),h=this._axesMap.set(o,new q$(o,Cv(u),[0,0],u.get("type"),l)),f=h.type==="category";h.onBand=f&&u.get("boundaryGap"),h.inverse=u.get("inverse"),u.axis=h,h.model=u,h.coordinateSystem=u.coordinateSystem=this},this)},e.prototype.update=function(t,r){this._updateAxesFromSeries(this._model,t)},e.prototype.containPoint=function(t){var r=this._makeLayoutInfo(),n=r.axisBase,i=r.layoutBase,a=r.pixelDimIndex,o=t[1-a],s=t[a];return o>=n&&o<=n+r.axisLength&&s>=i&&s<=i+r.layoutLength},e.prototype.getModel=function(){return this._model},e.prototype._updateAxesFromSeries=function(t,r){r.eachSeries(function(n){if(t.contains(n,r)){var i=n.getData();dx(this.dimensions,function(a){var o=this._axesMap.get(a);o.scale.unionExtentFromData(i,i.mapDimension(a)),Au(o.scale,o.model)},this)}},this)},e.prototype.resize=function(t,r){this._rect=Mr(t.getBoxLayoutParams(),{width:r.getWidth(),height:r.getHeight()}),this._layoutAxes()},e.prototype.getRect=function(){return this._rect},e.prototype._makeLayoutInfo=function(){var t=this._model,r=this._rect,n=["x","y"],i=["width","height"],a=t.get("layout"),o=a==="horizontal"?0:1,s=r[i[o]],l=[0,s],u=this.dimensions.length,h=kp(t.get("axisExpandWidth"),l),f=kp(t.get("axisExpandCount")||0,[0,u]),c=t.get("axisExpandable")&&u>3&&u>f&&f>1&&h>0&&s>0,d=t.get("axisExpandWindow"),v;if(d)v=kp(d[1]-d[0],l),d[1]=d[0]+v;else{v=kp(h*(f-1),l);var p=t.get("axisExpandCenter")||lL(u/2);d=[h*p-v/2],d[1]=d[0]+v}var g=(s-v)/(u-f);g<3&&(g=0);var m=[lL(uL(d[0]/h,1))+1,$$(uL(d[1]/h,1))-1],_=g/h*d[0];return{layout:a,pixelDimIndex:o,layoutBase:r[n[o]],layoutLength:s,axisBase:r[n[1-o]],axisLength:r[i[1-o]],axisExpandable:c,axisExpandWidth:h,axisCollapseWidth:g,axisExpandWindow:d,axisCount:u,winInnerIndices:m,axisExpandWindow0Pos:_}},e.prototype._layoutAxes=function(){var t=this._rect,r=this._axesMap,n=this.dimensions,i=this._makeLayoutInfo(),a=i.layout;r.each(function(o){var s=[0,i.axisLength],l=o.inverse?1:0;o.setExtent(s[l],s[1-l])}),dx(n,function(o,s){var l=(i.axisExpandable?Q$:J$)(s,i),u={horizontal:{x:l.position,y:i.axisLength},vertical:{x:0,y:l.position}},h={horizontal:K$/2,vertical:0},f=[u[a].x+t.x,u[a].y+t.y],c=h[a],d=oi();Fu(d,d,c),qa(d,d,f),this._axesLayout[o]={position:f,rotation:c,transform:d,axisNameAvailableWidth:l.axisNameAvailableWidth,axisLabelShow:l.axisLabelShow,nameTruncateMaxWidth:l.nameTruncateMaxWidth,tickDirection:1,labelDirection:1}},this)},e.prototype.getAxis=function(t){return this._axesMap.get(t)},e.prototype.dataToPoint=function(t,r){return this.axisCoordToPoint(this._axesMap.get(r).dataToCoord(t),r)},e.prototype.eachActiveState=function(t,r,n,i){n==null&&(n=0),i==null&&(i=t.count());var a=this._axesMap,o=this.dimensions,s=[],l=[];R(o,function(g){s.push(t.mapDimension(g)),l.push(a.get(g).model)});for(var u=this.hasAxisBrushed(),h=n;h<i;h++){var f=void 0;if(!u)f="normal";else{f="active";for(var c=t.getValues(s,h),d=0,v=o.length;d<v;d++){var p=l[d].getActiveState(c[d]);if(p==="inactive"){f="inactive";break}}}r(f,h)}},e.prototype.hasAxisBrushed=function(){for(var t=this.dimensions,r=this._axesMap,n=!1,i=0,a=t.length;i<a;i++)r.get(t[i]).model.getActiveState()!=="normal"&&(n=!0);return n},e.prototype.axisCoordToPoint=function(t,r){var n=this._axesLayout[r];return va([t,0],n.transform)},e.prototype.getAxisLayout=function(t){return Qt(this._axesLayout[t])},e.prototype.getSlidedAxisExpandWindow=function(t){var r=this._makeLayoutInfo(),n=r.pixelDimIndex,i=r.axisExpandWindow.slice(),a=i[1]-i[0],o=[0,r.axisExpandWidth*(r.axisCount-1)];if(!this.containPoint(t))return{behavior:"none",axisExpandWindow:i};var s=t[n]-r.layoutBase-r.axisExpandWindow0Pos,l,u="slide",h=r.axisCollapseWidth,f=this._model.get("axisExpandSlideTriggerArea"),c=f[0]!=null;if(h)c&&h&&s<a*f[0]?(u="jump",l=s-a*f[2]):c&&h&&s>a*(1-f[0])?(u="jump",l=s-a*(1-f[2])):(l=s-a*f[1])>=0&&(l=s-a*(1-f[1]))<=0&&(l=0),l*=r.axisExpandWidth/h,l?Wu(l,i,o,"all"):u="none";else{var d=i[1]-i[0],v=o[1]*s/d;i=[$U(0,v-d/2)],i[1]=qU(o[1],i[0]+d),i[0]=i[1]-d}return{axisExpandWindow:i,behavior:u}},e}();function kp(e,t){return qU($U(e,t[0]),t[1])}function J$(e,t){var r=t.layoutLength/(t.axisCount-1);return{position:r*e,axisNameAvailableWidth:r,axisLabelShow:!0}}function Q$(e,t){var r=t.layoutLength,n=t.axisExpandWidth,i=t.axisCount,a=t.axisCollapseWidth,o=t.winInnerIndices,s,l=a,u=!1,h;return e<o[0]?(s=e*a,h=a):e<=o[1]?(s=t.axisExpandWindow0Pos+e*n-t.axisExpandWindow[0],l=n,u=!0):(s=r-(i-1-e)*a,h=a),{position:s,axisNameAvailableWidth:l,axisLabelShow:u,nameTruncateMaxWidth:h}}function tK(e,t){var r=[];return e.eachComponent("parallel",function(n,i){var a=new j$(n,e,t);a.name="parallel_"+i,a.resize(n,t),n.coordinateSystem=a,a.model=n,r.push(a)}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="parallel"){var i=n.getReferringComponents("parallel",zr).models[0];n.coordinateSystem=i.coordinateSystem}}),r}var eK={create:tK},vT=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.activeIntervals=[],r}return t.prototype.getAreaSelectStyle=function(){return bu([["fill","color"],["lineWidth","borderWidth"],["stroke","borderColor"],["width","width"],["opacity","opacity"]])(this.getModel("areaSelectStyle"))},t.prototype.setActiveIntervals=function(r){var n=this.activeIntervals=Qt(r);if(n)for(var i=n.length-1;i>=0;i--)ki(n[i])},t.prototype.getActiveState=function(r){var n=this.activeIntervals;if(!n.length)return"normal";if(r==null||isNaN(+r))return"inactive";if(n.length===1){var i=n[0];if(i[0]<=r&&r<=i[1])return"active"}else for(var a=0,o=n.length;a<o;a++)if(n[a][0]<=r&&r<=n[a][1])return"active";return"inactive"},t}(me);Nr(vT,Jf);var Eu=!0,nv=Math.min,gf=Math.max,rK=Math.pow,nK=1e4,iK=6,aK=6,hL="globalPan",oK={w:[0,0],e:[0,1],n:[1,0],s:[1,1]},sK={w:"ew",e:"ew",n:"ns",s:"ns",ne:"nesw",sw:"nesw",nw:"nwse",se:"nwse"},fL={brushStyle:{lineWidth:2,stroke:"rgba(210,219,238,0.3)",fill:"#D2DBEE"},transformable:!0,brushMode:"single",removeOnClick:!1},lK=0,yM=function(e){q(t,e);function t(r){var n=e.call(this)||this;return n._track=[],n._covers=[],n._handlers={},n._zr=r,n.group=new re,n._uid="brushController_"+lK++,R(pK,function(i,a){this._handlers[a]=It(i,this)},n),n}return t.prototype.enableBrush=function(r){return this._brushType&&this._doDisableBrush(),r.brushType&&this._doEnableBrush(r),this},t.prototype._doEnableBrush=function(r){var n=this._zr;this._enableGlobalPan||tZ(n,hL,this._uid),R(this._handlers,function(i,a){n.on(a,i)}),this._brushType=r.brushType,this._brushOption=Ot(Qt(fL),r,!0)},t.prototype._doDisableBrush=function(){var r=this._zr;eZ(r,hL,this._uid),R(this._handlers,function(n,i){r.off(i,n)}),this._brushType=this._brushOption=null},t.prototype.setPanels=function(r){if(r&&r.length){var n=this._panels={};R(r,function(i){n[i.panelId]=Qt(i)})}else this._panels=null;return this},t.prototype.mount=function(r){r=r||{},this._enableGlobalPan=r.enableGlobalPan;var n=this.group;return this._zr.add(n),n.attr({x:r.x||0,y:r.y||0,rotation:r.rotation||0,scaleX:r.scaleX||1,scaleY:r.scaleY||1}),this._transform=n.getLocalTransform(),this},t.prototype.updateCovers=function(r){r=ft(r,function(c){return Ot(Qt(fL),c,!0)});var n="\0-brush-index-",i=this._covers,a=this._covers=[],o=this,s=this._creatingCover;return new No(i,r,u,l).add(h).update(h).remove(f).execute(),this;function l(c,d){return(c.id!=null?c.id:n+d)+"-"+c.brushType}function u(c,d){return l(c.__brushOption,d)}function h(c,d){var v=r[c];if(d!=null&&i[d]===s)a[c]=i[d];else{var p=a[c]=d!=null?(i[d].__brushOption=v,i[d]):jU(o,KU(o,v));xM(o,p)}}function f(c){i[c]!==s&&o.group.remove(i[c])}},t.prototype.unmount=function(){return this.enableBrush(!1),pT(this),this._zr.remove(this.group),this},t.prototype.dispose=function(){this.unmount(),this.off()},t}(Zi);function KU(e,t){var r=a0[t.brushType].createCover(e,t);return r.__brushOption=t,QU(r,t),e.group.add(r),r}function jU(e,t){var r=SM(t);return r.endCreating&&(r.endCreating(e,t),QU(t,t.__brushOption)),t}function JU(e,t){var r=t.__brushOption;SM(t).updateCoverShape(e,t,r.range,r)}function QU(e,t){var r=t.z;r==null&&(r=nK),e.traverse(function(n){n.z=r,n.z2=r})}function xM(e,t){SM(t).updateCommon(e,t),JU(e,t)}function SM(e){return a0[e.__brushOption.brushType]}function TM(e,t,r){var n=e._panels;if(!n)return Eu;var i,a=e._transform;return R(n,function(o){o.isTargetByCursor(t,r,a)&&(i=o)}),i}function tz(e,t){var r=e._panels;if(!r)return Eu;var n=t.__brushOption.panelId;return n!=null?r[n]:Eu}function pT(e){var t=e._covers,r=t.length;return R(t,function(n){e.group.remove(n)},e),t.length=0,!!r}function Cu(e,t){var r=ft(e._covers,function(n){var i=n.__brushOption,a=Qt(i.range);return{brushType:i.brushType,panelId:i.panelId,range:a}});e.trigger("brush",{areas:r,isEnd:!!t.isEnd,removeOnClick:!!t.removeOnClick})}function uK(e){var t=e._track;if(!t.length)return!1;var r=t[t.length-1],n=t[0],i=r[0]-n[0],a=r[1]-n[1],o=rK(i*i+a*a,.5);return o>iK}function ez(e){var t=e.length-1;return t<0&&(t=0),[e[0],e[t]]}function rz(e,t,r,n){var i=new re;return i.add(new Ae({name:"main",style:bM(r),silent:!0,draggable:!0,cursor:"move",drift:ue(cL,e,t,i,["n","s","w","e"]),ondragend:ue(Cu,t,{isEnd:!0})})),R(n,function(a){i.add(new Ae({name:a.join(""),style:{opacity:0},draggable:!0,silent:!0,invisible:!0,drift:ue(cL,e,t,i,a),ondragend:ue(Cu,t,{isEnd:!0})}))}),i}function nz(e,t,r,n){var i=n.brushStyle.lineWidth||0,a=gf(i,aK),o=r[0][0],s=r[1][0],l=o-i/2,u=s-i/2,h=r[0][1],f=r[1][1],c=h-a+i/2,d=f-a+i/2,v=h-o,p=f-s,g=v+i,m=p+i;io(e,t,"main",o,s,v,p),n.transformable&&(io(e,t,"w",l,u,a,m),io(e,t,"e",c,u,a,m),io(e,t,"n",l,u,g,a),io(e,t,"s",l,d,g,a),io(e,t,"nw",l,u,a,a),io(e,t,"ne",c,u,a,a),io(e,t,"sw",l,d,a,a),io(e,t,"se",c,d,a,a))}function gT(e,t){var r=t.__brushOption,n=r.transformable,i=t.childAt(0);i.useStyle(bM(r)),i.attr({silent:!n,cursor:n?"move":"default"}),R([["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]],function(a){var o=t.childOfName(a.join("")),s=a.length===1?mT(e,a[0]):fK(e,a);o&&o.attr({silent:!n,invisible:!n,cursor:n?sK[s]+"-resize":null})})}function io(e,t,r,n,i,a,o){var s=t.childOfName(r);s&&s.setShape(dK(wM(e,t,[[n,i],[n+a,i+o]])))}function bM(e){return Vt({strokeNoScale:!0},e.brushStyle)}function iz(e,t,r,n){var i=[nv(e,r),nv(t,n)],a=[gf(e,r),gf(t,n)];return[[i[0],a[0]],[i[1],a[1]]]}function hK(e){return du(e.group)}function mT(e,t){var r={w:"left",e:"right",n:"top",s:"bottom"},n={left:"w",right:"e",top:"n",bottom:"s"},i=B_(r[t],hK(e));return n[i]}function fK(e,t){var r=[mT(e,t[0]),mT(e,t[1])];return(r[0]==="e"||r[0]==="w")&&r.reverse(),r.join("")}function cL(e,t,r,n,i,a){var o=r.__brushOption,s=e.toRectRange(o.range),l=az(t,i,a);R(n,function(u){var h=oK[u];s[h[0]][h[1]]+=l[h[0]]}),o.range=e.fromRectRange(iz(s[0][0],s[1][0],s[0][1],s[1][1])),xM(t,r),Cu(t,{isEnd:!1})}function cK(e,t,r,n){var i=t.__brushOption.range,a=az(e,r,n);R(i,function(o){o[0]+=a[0],o[1]+=a[1]}),xM(e,t),Cu(e,{isEnd:!1})}function az(e,t,r){var n=e.group,i=n.transformCoordToLocal(t,r),a=n.transformCoordToLocal(0,0);return[i[0]-a[0],i[1]-a[1]]}function wM(e,t,r){var n=tz(e,t);return n&&n!==Eu?n.clipPath(r,e._transform):Qt(r)}function dK(e){var t=nv(e[0][0],e[1][0]),r=nv(e[0][1],e[1][1]),n=gf(e[0][0],e[1][0]),i=gf(e[0][1],e[1][1]);return{x:t,y:r,width:n-t,height:i-r}}function vK(e,t,r){if(!(!e._brushType||gK(e,t.offsetX,t.offsetY))){var n=e._zr,i=e._covers,a=TM(e,t,r);if(!e._dragging)for(var o=0;o<i.length;o++){var s=i[o].__brushOption;if(a&&(a===Eu||s.panelId===a.panelId)&&a0[s.brushType].contain(i[o],r[0],r[1]))return}a&&n.setCursorStyle("crosshair")}}function _T(e){var t=e.event;t.preventDefault&&t.preventDefault()}function yT(e,t,r){return e.childOfName("main").contain(t,r)}function oz(e,t,r,n){var i=e._creatingCover,a=e._creatingPanel,o=e._brushOption,s;if(e._track.push(r.slice()),uK(e)||i){if(a&&!i){o.brushMode==="single"&&pT(e);var l=Qt(o);l.brushType=dL(l.brushType,a),l.panelId=a===Eu?null:a.panelId,i=e._creatingCover=KU(e,l),e._covers.push(i)}if(i){var u=a0[dL(e._brushType,a)],h=i.__brushOption;h.range=u.getCreatingRange(wM(e,i,e._track)),n&&(jU(e,i),u.updateCommon(e,i)),JU(e,i),s={isEnd:n}}}else n&&o.brushMode==="single"&&o.removeOnClick&&TM(e,t,r)&&pT(e)&&(s={isEnd:n,removeOnClick:!0});return s}function dL(e,t){return e==="auto"?t.defaultBrushType:e}var pK={mousedown:function(e){if(this._dragging)vL(this,e);else if(!e.target||!e.target.draggable){_T(e);var t=this.group.transformCoordToLocal(e.offsetX,e.offsetY);this._creatingCover=null;var r=this._creatingPanel=TM(this,e,t);r&&(this._dragging=!0,this._track=[t.slice()])}},mousemove:function(e){var t=e.offsetX,r=e.offsetY,n=this.group.transformCoordToLocal(t,r);if(vK(this,e,n),this._dragging){_T(e);var i=oz(this,e,n,!1);i&&Cu(this,i)}},mouseup:function(e){vL(this,e)}};function vL(e,t){if(e._dragging){_T(t);var r=t.offsetX,n=t.offsetY,i=e.group.transformCoordToLocal(r,n),a=oz(e,t,i,!0);e._dragging=!1,e._track=[],e._creatingCover=null,a&&Cu(e,a)}}function gK(e,t,r){var n=e._zr;return t<0||t>n.getWidth()||r<0||r>n.getHeight()}var a0={lineX:pL(0),lineY:pL(1),rect:{createCover:function(e,t){function r(n){return n}return rz({toRectRange:r,fromRectRange:r},e,t,[["w"],["e"],["n"],["s"],["s","e"],["s","w"],["n","e"],["n","w"]])},getCreatingRange:function(e){var t=ez(e);return iz(t[1][0],t[1][1],t[0][0],t[0][1])},updateCoverShape:function(e,t,r,n){nz(e,t,r,n)},updateCommon:gT,contain:yT},polygon:{createCover:function(e,t){var r=new re;return r.add(new $n({name:"main",style:bM(t),silent:!0})),r},getCreatingRange:function(e){return e},endCreating:function(e,t){t.remove(t.childAt(0)),t.add(new Yn({name:"main",draggable:!0,drift:ue(cK,e,t),ondragend:ue(Cu,e,{isEnd:!0})}))},updateCoverShape:function(e,t,r,n){t.childAt(0).setShape({points:wM(e,t,r)})},updateCommon:gT,contain:yT}};function pL(e){return{createCover:function(t,r){return rz({toRectRange:function(n){var i=[n,[0,100]];return e&&i.reverse(),i},fromRectRange:function(n){return n[e]}},t,r,[[["w"],["e"]],[["n"],["s"]]][e])},getCreatingRange:function(t){var r=ez(t),n=nv(r[0][e],r[1][e]),i=gf(r[0][e],r[1][e]);return[n,i]},updateCoverShape:function(t,r,n,i){var a,o=tz(t,r);if(o!==Eu&&o.getLinearBrushOtherExtent)a=o.getLinearBrushOtherExtent(e);else{var s=t._zr;a=[0,[s.getWidth(),s.getHeight()][1-e]]}var l=[n,a];e&&l.reverse(),nz(t,r,l,i)},updateCommon:gT,contain:yT}}function sz(e){return e=MM(e),function(t){return c3(t,e)}}function lz(e,t){return e=MM(e),function(r){var n=t??r,i=n?e.width:e.height,a=n?e.x:e.y;return[a,a+(i||0)]}}function uz(e,t,r){var n=MM(e);return function(i,a){return n.contain(a[0],a[1])&&!e0(i,t,r)}}function MM(e){return fe.create(e)}var mK=["axisLine","axisTickLabel","axisName"],_K=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){e.prototype.init.apply(this,arguments),(this._brushController=new yM(n.getZr())).on("brush",It(this._onBrush,this))},t.prototype.render=function(r,n,i,a){if(!yK(r,n,a)){this.axisModel=r,this.api=i,this.group.removeAll();var o=this._axisGroup;if(this._axisGroup=new re,this.group.add(this._axisGroup),!!r.get("show")){var s=SK(r,n),l=s.coordinateSystem,u=r.getAreaSelectStyle(),h=u.width,f=r.axis.dim,c=l.getAxisLayout(f),d=rt({strokeContainThreshold:h},c),v=new Gn(r,d);R(mK,v.add,v),this._axisGroup.add(v.getGroup()),this._refreshBrushController(d,u,r,s,h,i),wv(o,this._axisGroup,r)}}},t.prototype._refreshBrushController=function(r,n,i,a,o,s){var l=i.axis.getExtent(),u=l[1]-l[0],h=Math.min(30,Math.abs(u)*.1),f=fe.create({x:l[0],y:-o/2,width:u,height:o});f.x-=h,f.width+=2*h,this._brushController.mount({enableGlobalPan:!0,rotation:r.rotation,x:r.position[0],y:r.position[1]}).setPanels([{panelId:"pl",clipPath:sz(f),isTargetByCursor:uz(f,s,a),getLinearBrushOtherExtent:lz(f,0)}]).enableBrush({brushType:"lineX",brushStyle:n,removeOnClick:!0}).updateCovers(xK(i))},t.prototype._onBrush=function(r){var n=r.areas,i=this.axisModel,a=i.axis,o=ft(n,function(s){return[a.coordToData(s.range[0],!0),a.coordToData(s.range[1],!0)]});(!i.option.realtime===r.isEnd||r.removeOnClick)&&this.api.dispatchAction({type:"axisAreaSelect",parallelAxisId:i.id,intervals:o})},t.prototype.dispose=function(){this._brushController.dispose()},t.type="parallelAxis",t}(nr);function yK(e,t,r){return r&&r.type==="axisAreaSelect"&&t.findComponents({mainType:"parallelAxis",query:r})[0]===e}function xK(e){var t=e.axis;return ft(e.activeIntervals,function(r){return{brushType:"lineX",panelId:"pl",range:[t.dataToCoord(r[0],!0),t.dataToCoord(r[1],!0)]}})}function SK(e,t){return t.getComponent("parallel",e.get("parallelIndex"))}var TK={type:"axisAreaSelect",event:"axisAreaSelected"};function bK(e){e.registerAction(TK,function(t,r){r.eachComponent({mainType:"parallelAxis",query:t},function(n){n.axis.model.setActiveIntervals(t.intervals)})}),e.registerAction("parallelAxisExpand",function(t,r){r.eachComponent({mainType:"parallel",query:t},function(n){n.setAxisExpand(t)})})}var wK={type:"value",areaSelectStyle:{width:20,borderWidth:1,borderColor:"rgba(160,197,232)",color:"rgba(160,197,232)",opacity:.3},realtime:!0,z:10};function hz(e){e.registerComponentView(X$),e.registerComponentModel(Z$),e.registerCoordinateSystem("parallel",eK),e.registerPreprocessor(G$),e.registerComponentModel(vT),e.registerComponentView(_K),pf(e,"parallel",vT,wK),bK(e)}function MK(e){te(hz),e.registerChartView(I$),e.registerSeriesModel(F$),e.registerVisual(e.PRIORITY.VISUAL.BRUSH,k$)}var AK=function(){function e(){this.x1=0,this.y1=0,this.x2=0,this.y2=0,this.cpx1=0,this.cpy1=0,this.cpx2=0,this.cpy2=0,this.extent=0}return e}(),EK=function(e){q(t,e);function t(r){return e.call(this,r)||this}return t.prototype.getDefaultShape=function(){return new AK},t.prototype.buildPath=function(r,n){var i=n.extent;r.moveTo(n.x1,n.y1),r.bezierCurveTo(n.cpx1,n.cpy1,n.cpx2,n.cpy2,n.x2,n.y2),n.orient==="vertical"?(r.lineTo(n.x2+i,n.y2),r.bezierCurveTo(n.cpx2+i,n.cpy2,n.cpx1+i,n.cpy1,n.x1+i,n.y1)):(r.lineTo(n.x2,n.y2+i),r.bezierCurveTo(n.cpx2,n.cpy2+i,n.cpx1,n.cpy1+i,n.x1,n.y1+i)),r.closePath()},t.prototype.highlight=function(){Po(this)},t.prototype.downplay=function(){Io(this)},t}(_e),CK=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._focusAdjacencyDisabled=!1,r}return t.prototype.render=function(r,n,i){var a=this,o=r.getGraph(),s=this.group,l=r.layoutInfo,u=l.width,h=l.height,f=r.getData(),c=r.getData("edge"),d=r.get("orient");this._model=r,s.removeAll(),s.x=l.x,s.y=l.y,o.eachEdge(function(v){var p=new EK,g=oe(p);g.dataIndex=v.dataIndex,g.seriesIndex=r.seriesIndex,g.dataType="edge";var m=v.getModel(),_=m.getModel("lineStyle"),y=_.get("curveness"),x=v.node1.getLayout(),T=v.node1.getModel(),S=T.get("localX"),M=T.get("localY"),w=v.node2.getLayout(),b=v.node2.getModel(),A=b.get("localX"),E=b.get("localY"),C=v.getLayout(),D,L,P,N,O,I,k,z;p.shape.extent=Math.max(1,C.dy),p.shape.orient=d,d==="vertical"?(D=(S!=null?S*u:x.x)+C.sy,L=(M!=null?M*h:x.y)+x.dy,P=(A!=null?A*u:w.x)+C.ty,N=E!=null?E*h:w.y,O=D,I=L*(1-y)+N*y,k=P,z=L*y+N*(1-y)):(D=(S!=null?S*u:x.x)+x.dx,L=(M!=null?M*h:x.y)+C.sy,P=A!=null?A*u:w.x,N=(E!=null?E*h:w.y)+C.ty,O=D*(1-y)+P*y,I=L,k=D*y+P*(1-y),z=N),p.setShape({x1:D,y1:L,x2:P,y2:N,cpx1:O,cpy1:I,cpx2:k,cpy2:z}),p.useStyle(_.getItemStyle()),gL(p.style,d,v);var X=""+m.get("value"),Y=an(m,"edgeLabel");Sn(p,Y,{labelFetcher:{getFormattedLabel:function(Z,ct,ut,tt,et,st){return r.getFormattedLabel(Z,ct,"edge",tt,Ga(et,Y.normal&&Y.normal.get("formatter"),X),st)}},labelDataIndex:v.dataIndex,defaultText:X}),p.setTextConfig({position:"inside"});var $=m.getModel("emphasis");xn(p,m,"lineStyle",function(Z){var ct=Z.getItemStyle();return gL(ct,d,v),ct}),s.add(p),c.setItemGraphicEl(v.dataIndex,p);var H=$.get("focus");Sr(p,H==="adjacency"?v.getAdjacentDataIndices():H==="trajectory"?v.getTrajectoryDataIndices():H,$.get("blurScope"),$.get("disabled"))}),o.eachNode(function(v){var p=v.getLayout(),g=v.getModel(),m=g.get("localX"),_=g.get("localY"),y=g.getModel("emphasis"),x=g.get(["itemStyle","borderRadius"])||0,T=new Ae({shape:{x:m!=null?m*u:p.x,y:_!=null?_*h:p.y,width:p.dx,height:p.dy,r:x},style:g.getModel("itemStyle").getItemStyle(),z2:10});Sn(T,an(g),{labelFetcher:{getFormattedLabel:function(M,w){return r.getFormattedLabel(M,w,"node")}},labelDataIndex:v.dataIndex,defaultText:v.id}),T.disableLabelAnimation=!0,T.setStyle("fill",v.getVisual("color")),T.setStyle("decal",v.getVisual("style").decal),xn(T,g),s.add(T),f.setItemGraphicEl(v.dataIndex,T),oe(T).dataType="node";var S=y.get("focus");Sr(T,S==="adjacency"?v.getAdjacentDataIndices():S==="trajectory"?v.getTrajectoryDataIndices():S,y.get("blurScope"),y.get("disabled"))}),f.eachItemGraphicEl(function(v,p){var g=f.getItemModel(p);g.get("draggable")&&(v.drift=function(m,_){a._focusAdjacencyDisabled=!0,this.shape.x+=m,this.shape.y+=_,this.dirty(),i.dispatchAction({type:"dragNode",seriesId:r.id,dataIndex:f.getRawIndex(p),localX:this.shape.x/u,localY:this.shape.y/h})},v.ondragend=function(){a._focusAdjacencyDisabled=!1},v.draggable=!0,v.cursor="move")}),!this._data&&r.isAnimationEnabled()&&s.setClipPath(DK(s.getBoundingRect(),r,function(){s.removeClipPath()})),this._data=r.getData()},t.prototype.dispose=function(){},t.type="sankey",t}(De);function gL(e,t,r){switch(e.fill){case"source":e.fill=r.node1.getVisual("color"),e.decal=r.node1.getVisual("style").decal;break;case"target":e.fill=r.node2.getVisual("color"),e.decal=r.node2.getVisual("style").decal;break;case"gradient":var n=r.node1.getVisual("color"),i=r.node2.getVisual("color");Ct(n)&&Ct(i)&&(e.fill=new bv(0,0,+(t==="horizontal"),+(t==="vertical"),[{color:n,offset:0},{color:i,offset:1}]))}}function DK(e,t,r){var n=new Ae({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return vr(n,{shape:{width:e.width+20}},t,r),n}var LK=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,n){var i=r.edges||r.links||[],a=r.data||r.nodes||[],o=r.levels||[];this.levelModels=[];for(var s=this.levelModels,l=0;l<o.length;l++)o[l].depth!=null&&o[l].depth>=0&&(s[o[l].depth]=new Ie(o[l],this,n));var u=YU(a,i,this,!0,h);return u.data;function h(f,c){f.wrapMethod("getItemModel",function(d,v){var p=d.parentModel,g=p.getData().getItemLayout(v);if(g){var m=g.depth,_=p.levelModels[m];_&&(d.parentModel=_)}return d}),c.wrapMethod("getItemModel",function(d,v){var p=d.parentModel,g=p.getGraph().getEdgeByIndex(v),m=g.node1.getLayout();if(m){var _=m.depth,y=p.levelModels[_];y&&(d.parentModel=y)}return d})}},t.prototype.setNodePosition=function(r,n){var i=this.option.data||this.option.nodes,a=i[r];a.localX=n[0],a.localY=n[1]},t.prototype.getGraph=function(){return this.getData().graph},t.prototype.getEdgeData=function(){return this.getGraph().edgeData},t.prototype.formatTooltip=function(r,n,i){function a(d){return isNaN(d)||d==null}if(i==="edge"){var o=this.getDataParams(r,i),s=o.data,l=o.value,u=s.source+" -- "+s.target;return on("nameValue",{name:u,value:l,noValue:a(l)})}else{var h=this.getGraph().getNodeByIndex(r),f=h.getLayout().value,c=this.getDataParams(r,i).data.name;return on("nameValue",{name:c!=null?c+"":null,value:f,noValue:a(f)})}},t.prototype.optionUpdated=function(){},t.prototype.getDataParams=function(r,n){var i=e.prototype.getDataParams.call(this,r,n);if(i.value==null&&n==="node"){var a=this.getGraph().getNodeByIndex(r),o=a.getLayout().value;i.value=o}return i},t.type="series.sankey",t.defaultOption={z:2,coordinateSystem:"view",left:"5%",top:"5%",right:"20%",bottom:"5%",orient:"horizontal",nodeWidth:20,nodeGap:8,draggable:!0,layoutIterations:32,label:{show:!0,position:"right",fontSize:12},edgeLabel:{show:!1,fontSize:12},levels:[],nodeAlign:"justify",lineStyle:{color:"#314656",opacity:.2,curveness:.5},emphasis:{label:{show:!0},lineStyle:{opacity:.5}},select:{itemStyle:{borderColor:"#212121"}},animationEasing:"linear",animationDuration:1e3},t}(Ue);function RK(e,t){e.eachSeriesByType("sankey",function(r){var n=r.get("nodeWidth"),i=r.get("nodeGap"),a=PK(r,t);r.layoutInfo=a;var o=a.width,s=a.height,l=r.getGraph(),u=l.nodes,h=l.edges;NK(u);var f=Xe(u,function(p){return p.getLayout().value===0}),c=f.length!==0?0:r.get("layoutIterations"),d=r.get("orient"),v=r.get("nodeAlign");IK(u,h,n,i,o,s,c,d,v)})}function PK(e,t){return Mr(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()})}function IK(e,t,r,n,i,a,o,s,l){OK(e,t,r,i,a,s,l),zK(e,t,a,i,n,o,s),qK(e,s)}function NK(e){R(e,function(t){var r=Ls(t.outEdges,Ym),n=Ls(t.inEdges,Ym),i=t.getValue()||0,a=Math.max(r,n,i);t.setLayout({value:a},!0)})}function OK(e,t,r,n,i,a,o){for(var s=[],l=[],u=[],h=[],f=0,c=0;c<t.length;c++)s[c]=1;for(var c=0;c<e.length;c++)l[c]=e[c].inEdges.length,l[c]===0&&u.push(e[c]);for(var d=-1;u.length;){for(var v=0;v<u.length;v++){var p=u[v],g=p.hostGraph.data.getRawDataItem(p.dataIndex),m=g.depth!=null&&g.depth>=0;m&&g.depth>d&&(d=g.depth),p.setLayout({depth:m?g.depth:f},!0),a==="vertical"?p.setLayout({dy:r},!0):p.setLayout({dx:r},!0);for(var _=0;_<p.outEdges.length;_++){var y=p.outEdges[_],x=t.indexOf(y);s[x]=0;var T=y.node2,S=e.indexOf(T);--l[S]===0&&h.indexOf(T)<0&&h.push(T)}}++f,u=h,h=[]}for(var c=0;c<s.length;c++)if(s[c]===1)throw new Error("Sankey is a DAG, the original data has cycle!");var M=d>f-1?d:f-1;o&&o!=="left"&&FK(e,o,a,M);var w=a==="vertical"?(i-r)/M:(n-r)/M;UK(e,w,a)}function fz(e){var t=e.hostGraph.data.getRawDataItem(e.dataIndex);return t.depth!=null&&t.depth>=0}function FK(e,t,r,n){if(t==="right"){for(var i=[],a=e,o=0;a.length;){for(var s=0;s<a.length;s++){var l=a[s];l.setLayout({skNodeHeight:o},!0);for(var u=0;u<l.inEdges.length;u++){var h=l.inEdges[u];i.indexOf(h.node1)<0&&i.push(h.node1)}}a=i,i=[],++o}R(e,function(f){fz(f)||f.setLayout({depth:Math.max(0,n-f.getLayout().skNodeHeight)},!0)})}else t==="justify"&&BK(e,n)}function BK(e,t){R(e,function(r){!fz(r)&&!r.outEdges.length&&r.setLayout({depth:t},!0)})}function UK(e,t,r){R(e,function(n){var i=n.getLayout().depth*t;r==="vertical"?n.setLayout({y:i},!0):n.setLayout({x:i},!0)})}function zK(e,t,r,n,i,a,o){var s=kK(e,o);GK(s,t,r,n,i,o),vx(s,i,r,n,o);for(var l=1;a>0;a--)l*=.99,VK(s,l,o),vx(s,i,r,n,o),ZK(s,l,o),vx(s,i,r,n,o)}function kK(e,t){var r=[],n=t==="vertical"?"y":"x",i=xS(e,function(a){return a.getLayout()[n]});return i.keys.sort(function(a,o){return a-o}),R(i.keys,function(a){r.push(i.buckets.get(a))}),r}function GK(e,t,r,n,i,a){var o=1/0;R(e,function(s){var l=s.length,u=0;R(s,function(f){u+=f.getLayout().value});var h=a==="vertical"?(n-(l-1)*i)/u:(r-(l-1)*i)/u;h<o&&(o=h)}),R(e,function(s){R(s,function(l,u){var h=l.getLayout().value*o;a==="vertical"?(l.setLayout({x:u},!0),l.setLayout({dx:h},!0)):(l.setLayout({y:u},!0),l.setLayout({dy:h},!0))})}),R(t,function(s){var l=+s.getValue()*o;s.setLayout({dy:l},!0)})}function vx(e,t,r,n,i){var a=i==="vertical"?"x":"y";R(e,function(o){o.sort(function(p,g){return p.getLayout()[a]-g.getLayout()[a]});for(var s,l,u,h=0,f=o.length,c=i==="vertical"?"dx":"dy",d=0;d<f;d++)l=o[d],u=h-l.getLayout()[a],u>0&&(s=l.getLayout()[a]+u,i==="vertical"?l.setLayout({x:s},!0):l.setLayout({y:s},!0)),h=l.getLayout()[a]+l.getLayout()[c]+t;var v=i==="vertical"?n:r;if(u=h-t-v,u>0){s=l.getLayout()[a]-u,i==="vertical"?l.setLayout({x:s},!0):l.setLayout({y:s},!0),h=s;for(var d=f-2;d>=0;--d)l=o[d],u=l.getLayout()[a]+l.getLayout()[c]+t-h,u>0&&(s=l.getLayout()[a]-u,i==="vertical"?l.setLayout({x:s},!0):l.setLayout({y:s},!0)),h=l.getLayout()[a]}})}function VK(e,t,r){R(e.slice().reverse(),function(n){R(n,function(i){if(i.outEdges.length){var a=Ls(i.outEdges,HK,r)/Ls(i.outEdges,Ym);if(isNaN(a)){var o=i.outEdges.length;a=o?Ls(i.outEdges,WK,r)/o:0}if(r==="vertical"){var s=i.getLayout().x+(a-Us(i,r))*t;i.setLayout({x:s},!0)}else{var l=i.getLayout().y+(a-Us(i,r))*t;i.setLayout({y:l},!0)}}})})}function HK(e,t){return Us(e.node2,t)*e.getValue()}function WK(e,t){return Us(e.node2,t)}function XK(e,t){return Us(e.node1,t)*e.getValue()}function YK(e,t){return Us(e.node1,t)}function Us(e,t){return t==="vertical"?e.getLayout().x+e.getLayout().dx/2:e.getLayout().y+e.getLayout().dy/2}function Ym(e){return e.getValue()}function Ls(e,t,r){for(var n=0,i=e.length,a=-1;++a<i;){var o=+t(e[a],r);isNaN(o)||(n+=o)}return n}function ZK(e,t,r){R(e,function(n){R(n,function(i){if(i.inEdges.length){var a=Ls(i.inEdges,XK,r)/Ls(i.inEdges,Ym);if(isNaN(a)){var o=i.inEdges.length;a=o?Ls(i.inEdges,YK,r)/o:0}if(r==="vertical"){var s=i.getLayout().x+(a-Us(i,r))*t;i.setLayout({x:s},!0)}else{var l=i.getLayout().y+(a-Us(i,r))*t;i.setLayout({y:l},!0)}}})})}function qK(e,t){var r=t==="vertical"?"x":"y";R(e,function(n){n.outEdges.sort(function(i,a){return i.node2.getLayout()[r]-a.node2.getLayout()[r]}),n.inEdges.sort(function(i,a){return i.node1.getLayout()[r]-a.node1.getLayout()[r]})}),R(e,function(n){var i=0,a=0;R(n.outEdges,function(o){o.setLayout({sy:i},!0),i+=o.getLayout().dy}),R(n.inEdges,function(o){o.setLayout({ty:a},!0),a+=o.getLayout().dy})})}function $K(e){e.eachSeriesByType("sankey",function(t){var r=t.getGraph(),n=r.nodes,i=r.edges;if(n.length){var a=1/0,o=-1/0;R(n,function(s){var l=s.getLayout().value;l<a&&(a=l),l>o&&(o=l)}),R(n,function(s){var l=new rn({type:"color",mappingMethod:"linear",dataExtent:[a,o],visual:t.get("color")}),u=l.mapValueToVisual(s.getLayout().value),h=s.getModel().get(["itemStyle","color"]);h!=null?(s.setVisual("color",h),s.setVisual("style",{fill:h})):(s.setVisual("color",u),s.setVisual("style",{fill:u}))})}i.length&&R(i,function(s){var l=s.getModel().get("lineStyle");s.setVisual("style",l)})})}function KK(e){e.registerChartView(CK),e.registerSeriesModel(LK),e.registerLayout(RK),e.registerVisual($K),e.registerAction({type:"dragNode",event:"dragnode",update:"update"},function(t,r){r.eachComponent({mainType:"series",subType:"sankey",query:t},function(n){n.setNodePosition(t.dataIndex,[t.localX,t.localY])})})}var cz=function(){function e(){}return e.prototype._hasEncodeRule=function(t){var r=this.getEncode();return r&&r.get(t)!=null},e.prototype.getInitialData=function(t,r){var n,i=r.getComponent("xAxis",this.get("xAxisIndex")),a=r.getComponent("yAxis",this.get("yAxisIndex")),o=i.get("type"),s=a.get("type"),l;o==="category"?(t.layout="horizontal",n=i.getOrdinalMeta(),l=!this._hasEncodeRule("x")):s==="category"?(t.layout="vertical",n=a.getOrdinalMeta(),l=!this._hasEncodeRule("y")):t.layout=t.layout||"horizontal";var u=["x","y"],h=t.layout==="horizontal"?0:1,f=this._baseAxisDim=u[h],c=u[1-h],d=[i,a],v=d[h].get("type"),p=d[1-h].get("type"),g=t.data;if(g&&l){var m=[];R(g,function(x,T){var S;at(x)?(S=x.slice(),x.unshift(T)):at(x.value)?(S=rt({},x),S.value=S.value.slice(),x.value.unshift(T)):S=x,m.push(S)}),t.data=m}var _=this.defaultValueDimensions,y=[{name:f,type:Nm(v),ordinalMeta:n,otherDims:{tooltip:!1,itemName:0},dimsDef:["base"]},{name:c,type:Nm(p),dimsDef:_.slice()}];return Qf(this,{coordDimensions:y,dimensionsCount:_.length+1,encodeDefaulter:ue(B3,y,this)})},e.prototype.getBaseAxis=function(){var t=this._baseAxisDim;return this.ecModel.getComponent(t+"Axis",this.get(t+"AxisIndex")).axis},e}(),dz=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.defaultValueDimensions=[{name:"min",defaultTooltip:!0},{name:"Q1",defaultTooltip:!0},{name:"median",defaultTooltip:!0},{name:"Q3",defaultTooltip:!0},{name:"max",defaultTooltip:!0}],r.visualDrawType="stroke",r}return t.type="series.boxplot",t.dependencies=["xAxis","yAxis","grid"],t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,boxWidth:[7,50],itemStyle:{color:"#fff",borderWidth:1},emphasis:{scale:!0,itemStyle:{borderWidth:2,shadowBlur:5,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}},animationDuration:800},t}(Ue);Nr(dz,cz,!0);var jK=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=r.getData(),o=this.group,s=this._data;this._data||o.removeAll();var l=r.get("layout")==="horizontal"?1:0;a.diff(s).add(function(u){if(a.hasValue(u)){var h=a.getItemLayout(u),f=mL(h,a,u,l,!0);a.setItemGraphicEl(u,f),o.add(f)}}).update(function(u,h){var f=s.getItemGraphicEl(h);if(!a.hasValue(u)){o.remove(f);return}var c=a.getItemLayout(u);f?(ya(f),vz(c,f,a,u)):f=mL(c,a,u,l),o.add(f),a.setItemGraphicEl(u,f)}).remove(function(u){var h=s.getItemGraphicEl(u);h&&o.remove(h)}).execute(),this._data=a},t.prototype.remove=function(r){var n=this.group,i=this._data;this._data=null,i&&i.eachItemGraphicEl(function(a){a&&n.remove(a)})},t.type="boxplot",t}(De),JK=function(){function e(){}return e}(),QK=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="boxplotBoxPath",n}return t.prototype.getDefaultShape=function(){return new JK},t.prototype.buildPath=function(r,n){var i=n.points,a=0;for(r.moveTo(i[a][0],i[a][1]),a++;a<4;a++)r.lineTo(i[a][0],i[a][1]);for(r.closePath();a<i.length;a++)r.moveTo(i[a][0],i[a][1]),a++,r.lineTo(i[a][0],i[a][1])},t}(_e);function mL(e,t,r,n,i){var a=e.ends,o=new QK({shape:{points:i?tj(a,n,e):a}});return vz(e,o,t,r,i),o}function vz(e,t,r,n,i){var a=r.hostModel,o=zu[i?"initProps":"updateProps"];o(t,{shape:{points:e.ends}},a,n),t.useStyle(r.getItemVisual(n,"style")),t.style.strokeNoScale=!0,t.z2=100;var s=r.getItemModel(n),l=s.getModel("emphasis");xn(t,s),Sr(t,l.get("focus"),l.get("blurScope"),l.get("disabled"))}function tj(e,t,r){return ft(e,function(n){return n=n.slice(),n[t]=r.initBaseline,n})}var Dd=R;function ej(e){var t=rj(e);Dd(t,function(r){var n=r.seriesModels;n.length&&(nj(r),Dd(n,function(i,a){ij(i,r.boxOffsetList[a],r.boxWidthList[a])}))})}function rj(e){var t=[],r=[];return e.eachSeriesByType("boxplot",function(n){var i=n.getBaseAxis(),a=pe(r,i);a<0&&(a=r.length,r[a]=i,t[a]={axis:i,seriesModels:[]}),t[a].seriesModels.push(n)}),t}function nj(e){var t=e.axis,r=e.seriesModels,n=r.length,i=e.boxWidthList=[],a=e.boxOffsetList=[],o=[],s;if(t.type==="category")s=t.getBandWidth();else{var l=0;Dd(r,function(v){l=Math.max(l,v.getData().count())});var u=t.getExtent();s=Math.abs(u[1]-u[0])/l}Dd(r,function(v){var p=v.get("boxWidth");at(p)||(p=[p,p]),o.push([Tt(p[0],s)||0,Tt(p[1],s)||0])});var h=s*.8-2,f=h/n*.3,c=(h-f*(n-1))/n,d=c/2-h/2;Dd(r,function(v,p){a.push(d),d+=f+c,i.push(Math.min(Math.max(c,o[p][0]),o[p][1]))})}function ij(e,t,r){var n=e.coordinateSystem,i=e.getData(),a=r/2,o=e.get("layout")==="horizontal"?0:1,s=1-o,l=["x","y"],u=i.mapDimension(l[o]),h=i.mapDimensionsAll(l[s]);if(u==null||h.length<5)return;for(var f=0;f<i.count();f++){var c=i.get(u,f),d=y(c,h[2],f),v=y(c,h[0],f),p=y(c,h[1],f),g=y(c,h[3],f),m=y(c,h[4],f),_=[];x(_,p,!1),x(_,g,!0),_.push(v,p,m,g),T(_,v),T(_,m),T(_,d),i.setItemLayout(f,{initBaseline:d[s],ends:_})}function y(S,M,w){var b=i.get(M,w),A=[];A[o]=S,A[s]=b;var E;return isNaN(S)||isNaN(b)?E=[NaN,NaN]:(E=n.dataToPoint(A),E[o]+=t),E}function x(S,M,w){var b=M.slice(),A=M.slice();b[o]+=a,A[o]-=a,w?S.push(b,A):S.push(A,b)}function T(S,M){var w=M.slice(),b=M.slice();w[o]-=a,b[o]+=a,S.push(w,b)}}function aj(e,t){t=t||{};for(var r=[],n=[],i=t.boundIQR,a=i==="none"||i===0,o=0;o<e.length;o++){var s=ki(e[o].slice()),l=H0(s,.25),u=H0(s,.5),h=H0(s,.75),f=s[0],c=s[s.length-1],d=(i??1.5)*(h-l),v=a?f:Math.max(f,l-d),p=a?c:Math.min(c,h+d),g=t.itemNameFormatter,m=Yt(g)?g({value:o}):Ct(g)?g.replace("{value}",o+""):o+"";r.push([m,v,l,u,h,p]);for(var _=0;_<s.length;_++){var y=s[_];if(y<v||y>p){var x=[m,y];n.push(x)}}}return{boxData:r,outliers:n}}var oj={type:"echarts:boxplot",transform:function(t){var r=t.upstream;if(r.sourceFormat!==Ln){var n="";We(n)}var i=aj(r.getRawData(),t.config);return[{dimensions:["ItemName","Low","Q1","Q2","Q3","High"],data:i.boxData},{data:i.outliers}]}};function sj(e){e.registerSeriesModel(dz),e.registerChartView(jK),e.registerLayout(ej),e.registerTransform(oj)}var lj=["itemStyle","borderColor"],uj=["itemStyle","borderColor0"],hj=["itemStyle","borderColorDoji"],fj=["itemStyle","color"],cj=["itemStyle","color0"];function AM(e,t){return t.get(e>0?fj:cj)}function EM(e,t){return t.get(e===0?hj:e>0?lj:uj)}var dj={seriesType:"candlestick",plan:Zf(),performRawSeries:!0,reset:function(e,t){if(!t.isSeriesFiltered(e)){var r=e.pipelineContext.large;return!r&&{progress:function(n,i){for(var a;(a=n.next())!=null;){var o=i.getItemModel(a),s=i.getItemLayout(a).sign,l=o.getItemStyle();l.fill=AM(s,o),l.stroke=EM(s,o)||l.fill;var u=i.ensureUniqueItemVisual(a,"style");rt(u,l)}}}}}},vj=["color","borderColor"],pj=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){this.group.removeClipPath(),this._progressiveEls=null,this._updateDrawMode(r),this._isLargeDraw?this._renderLarge(r):this._renderNormal(r)},t.prototype.incrementalPrepareRender=function(r,n,i){this._clear(),this._updateDrawMode(r)},t.prototype.incrementalRender=function(r,n,i,a){this._progressiveEls=[],this._isLargeDraw?this._incrementalRenderLarge(r,n):this._incrementalRenderNormal(r,n)},t.prototype.eachRendered=function(r){Hs(this._progressiveEls||this.group,r)},t.prototype._updateDrawMode=function(r){var n=r.pipelineContext.large;(this._isLargeDraw==null||n!==this._isLargeDraw)&&(this._isLargeDraw=n,this._clear())},t.prototype._renderNormal=function(r){var n=r.getData(),i=this._data,a=this.group,o=n.getLayout("isSimpleBox"),s=r.get("clip",!0),l=r.coordinateSystem,u=l.getArea&&l.getArea();this._data||a.removeAll(),n.diff(i).add(function(h){if(n.hasValue(h)){var f=n.getItemLayout(h);if(s&&_L(u,f))return;var c=px(f,h,!0);vr(c,{shape:{points:f.ends}},r,h),gx(c,n,h,o),a.add(c),n.setItemGraphicEl(h,c)}}).update(function(h,f){var c=i.getItemGraphicEl(f);if(!n.hasValue(h)){a.remove(c);return}var d=n.getItemLayout(h);if(s&&_L(u,d)){a.remove(c);return}c?(ke(c,{shape:{points:d.ends}},r,h),ya(c)):c=px(d),gx(c,n,h,o),a.add(c),n.setItemGraphicEl(h,c)}).remove(function(h){var f=i.getItemGraphicEl(h);f&&a.remove(f)}).execute(),this._data=n},t.prototype._renderLarge=function(r){this._clear(),yL(r,this.group);var n=r.get("clip",!0)?Rv(r.coordinateSystem,!1,r):null;n?this.group.setClipPath(n):this.group.removeClipPath()},t.prototype._incrementalRenderNormal=function(r,n){for(var i=n.getData(),a=i.getLayout("isSimpleBox"),o;(o=r.next())!=null;){var s=i.getItemLayout(o),l=px(s);gx(l,i,o,a),l.incremental=!0,this.group.add(l),this._progressiveEls.push(l)}},t.prototype._incrementalRenderLarge=function(r,n){yL(n,this.group,this._progressiveEls,!0)},t.prototype.remove=function(r){this._clear()},t.prototype._clear=function(){this.group.removeAll(),this._data=null},t.type="candlestick",t}(De),gj=function(){function e(){}return e}(),mj=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="normalCandlestickBox",n}return t.prototype.getDefaultShape=function(){return new gj},t.prototype.buildPath=function(r,n){var i=n.points;this.__simpleBox?(r.moveTo(i[4][0],i[4][1]),r.lineTo(i[6][0],i[6][1])):(r.moveTo(i[0][0],i[0][1]),r.lineTo(i[1][0],i[1][1]),r.lineTo(i[2][0],i[2][1]),r.lineTo(i[3][0],i[3][1]),r.closePath(),r.moveTo(i[4][0],i[4][1]),r.lineTo(i[5][0],i[5][1]),r.moveTo(i[6][0],i[6][1]),r.lineTo(i[7][0],i[7][1]))},t}(_e);function px(e,t,r){var n=e.ends;return new mj({shape:{points:r?_j(n,e):n},z2:100})}function _L(e,t){for(var r=!0,n=0;n<t.ends.length;n++)if(e.contain(t.ends[n][0],t.ends[n][1])){r=!1;break}return r}function gx(e,t,r,n){var i=t.getItemModel(r);e.useStyle(t.getItemVisual(r,"style")),e.style.strokeNoScale=!0,e.__simpleBox=n,xn(e,i);var a=t.getItemLayout(r).sign;R(e.states,function(s,l){var u=i.getModel(l),h=AM(a,u),f=EM(a,u)||h,c=s.style||(s.style={});h&&(c.fill=h),f&&(c.stroke=f)});var o=i.getModel("emphasis");Sr(e,o.get("focus"),o.get("blurScope"),o.get("disabled"))}function _j(e,t){return ft(e,function(r){return r=r.slice(),r[1]=t.initBaseline,r})}var yj=function(){function e(){}return e}(),mx=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n.type="largeCandlestickBox",n}return t.prototype.getDefaultShape=function(){return new yj},t.prototype.buildPath=function(r,n){for(var i=n.points,a=0;a<i.length;)if(this.__sign===i[a++]){var o=i[a++];r.moveTo(o,i[a++]),r.lineTo(o,i[a++])}else a+=3},t}(_e);function yL(e,t,r,n){var i=e.getData(),a=i.getLayout("largePoints"),o=new mx({shape:{points:a},__sign:1,ignoreCoarsePointer:!0});t.add(o);var s=new mx({shape:{points:a},__sign:-1,ignoreCoarsePointer:!0});t.add(s);var l=new mx({shape:{points:a},__sign:0,ignoreCoarsePointer:!0});t.add(l),_x(1,o,e),_x(-1,s,e),_x(0,l,e),n&&(o.incremental=!0,s.incremental=!0),r&&r.push(o,s)}function _x(e,t,r,n){var i=EM(e,r)||AM(e,r),a=r.getModel("itemStyle").getItemStyle(vj);t.useStyle(a),t.style.fill=null,t.style.stroke=i}var pz=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.defaultValueDimensions=[{name:"open",defaultTooltip:!0},{name:"close",defaultTooltip:!0},{name:"lowest",defaultTooltip:!0},{name:"highest",defaultTooltip:!0}],r}return t.prototype.getShadowDim=function(){return"open"},t.prototype.brushSelector=function(r,n,i){var a=n.getItemLayout(r);return a&&i.rect(a.brushRect)},t.type="series.candlestick",t.dependencies=["xAxis","yAxis","grid"],t.defaultOption={z:2,coordinateSystem:"cartesian2d",legendHoverLink:!0,layout:null,clip:!0,itemStyle:{color:"#eb5454",color0:"#47b262",borderColor:"#eb5454",borderColor0:"#47b262",borderColorDoji:null,borderWidth:1},emphasis:{itemStyle:{borderWidth:2}},barMaxWidth:null,barMinWidth:null,barWidth:null,large:!0,largeThreshold:600,progressive:3e3,progressiveThreshold:1e4,progressiveChunkMode:"mod",animationEasing:"linear",animationDuration:300},t}(Ue);Nr(pz,cz,!0);function xj(e){!e||!at(e.series)||R(e.series,function(t){Kt(t)&&t.type==="k"&&(t.type="candlestick")})}var Sj={seriesType:"candlestick",plan:Zf(),reset:function(e){var t=e.coordinateSystem,r=e.getData(),n=Tj(e,r),i=0,a=1,o=["x","y"],s=r.getDimensionIndex(r.mapDimension(o[i])),l=ft(r.mapDimensionsAll(o[a]),r.getDimensionIndex,r),u=l[0],h=l[1],f=l[2],c=l[3];if(r.setLayout({candleWidth:n,isSimpleBox:n<=1.3}),s<0||l.length<4)return;return{progress:e.pipelineContext.large?v:d};function d(p,g){for(var m,_=g.getStore();(m=p.next())!=null;){var y=_.get(s,m),x=_.get(u,m),T=_.get(h,m),S=_.get(f,m),M=_.get(c,m),w=Math.min(x,T),b=Math.max(x,T),A=O(w,y),E=O(b,y),C=O(S,y),D=O(M,y),L=[];I(L,E,0),I(L,A,1),L.push(z(D),z(E),z(C),z(A));var P=g.getItemModel(m),N=!!P.get(["itemStyle","borderColorDoji"]);g.setItemLayout(m,{sign:xL(_,m,x,T,h,N),initBaseline:x>T?E[a]:A[a],ends:L,brushRect:k(S,M,y)})}function O(X,Y){var $=[];return $[i]=Y,$[a]=X,isNaN(Y)||isNaN(X)?[NaN,NaN]:t.dataToPoint($)}function I(X,Y,$){var H=Y.slice(),Z=Y.slice();H[i]=Yg(H[i]+n/2,1,!1),Z[i]=Yg(Z[i]-n/2,1,!0),$?X.push(H,Z):X.push(Z,H)}function k(X,Y,$){var H=O(X,$),Z=O(Y,$);return H[i]-=n/2,Z[i]-=n/2,{x:H[0],y:H[1],width:n,height:Z[1]-H[1]}}function z(X){return X[i]=Yg(X[i],1),X}}function v(p,g){for(var m=Ba(p.count*4),_=0,y,x=[],T=[],S,M=g.getStore(),w=!!e.get(["itemStyle","borderColorDoji"]);(S=p.next())!=null;){var b=M.get(s,S),A=M.get(u,S),E=M.get(h,S),C=M.get(f,S),D=M.get(c,S);if(isNaN(b)||isNaN(C)||isNaN(D)){m[_++]=NaN,_+=3;continue}m[_++]=xL(M,S,A,E,h,w),x[i]=b,x[a]=C,y=t.dataToPoint(x,null,T),m[_++]=y?y[0]:NaN,m[_++]=y?y[1]:NaN,x[a]=D,y=t.dataToPoint(x,null,T),m[_++]=y?y[1]:NaN}g.setLayout("largePoints",m)}}};function xL(e,t,r,n,i,a){var o;return r>n?o=-1:r<n?o=1:o=a?0:t>0?e.get(i,t-1)<=n?1:-1:1,o}function Tj(e,t){var r=e.getBaseAxis(),n,i=r.type==="category"?r.getBandWidth():(n=r.getExtent(),Math.abs(n[1]-n[0])/t.count()),a=Tt(se(e.get("barMaxWidth"),i),i),o=Tt(se(e.get("barMinWidth"),1),i),s=e.get("barWidth");return s!=null?Tt(s,i):Math.max(Math.min(i/2,a),o)}function bj(e){e.registerChartView(pj),e.registerSeriesModel(pz),e.registerPreprocessor(xj),e.registerVisual(dj),e.registerLayout(Sj)}function SL(e,t){var r=t.rippleEffectColor||t.color;e.eachChild(function(n){n.attr({z:t.z,zlevel:t.zlevel,style:{stroke:t.brushType==="stroke"?r:null,fill:t.brushType==="fill"?r:null}})})}var wj=function(e){q(t,e);function t(r,n){var i=e.call(this)||this,a=new Dv(r,n),o=new re;return i.add(a),i.add(o),i.updateData(r,n),i}return t.prototype.stopEffectAnimation=function(){this.childAt(1).removeAll()},t.prototype.startEffectAnimation=function(r){for(var n=r.symbolType,i=r.color,a=r.rippleNumber,o=this.childAt(1),s=0;s<a;s++){var l=Pr(n,-1,-1,2,2,i);l.attr({style:{strokeNoScale:!0},z2:99,silent:!0,scaleX:.5,scaleY:.5});var u=-s/a*r.period+r.effectOffset;l.animate("",!0).when(r.period,{scaleX:r.rippleScale/2,scaleY:r.rippleScale/2}).delay(u).start(),l.animateStyle(!0).when(r.period,{opacity:0}).delay(u).start(),o.add(l)}SL(o,r)},t.prototype.updateEffectAnimation=function(r){for(var n=this._effectCfg,i=this.childAt(1),a=["symbolType","period","rippleScale","rippleNumber"],o=0;o<a.length;o++){var s=a[o];if(n[s]!==r[s]){this.stopEffectAnimation(),this.startEffectAnimation(r);return}}SL(i,r)},t.prototype.highlight=function(){Po(this)},t.prototype.downplay=function(){Io(this)},t.prototype.getSymbolType=function(){var r=this.childAt(0);return r&&r.getSymbolType()},t.prototype.updateData=function(r,n){var i=this,a=r.hostModel;this.childAt(0).updateData(r,n);var o=this.childAt(1),s=r.getItemModel(n),l=r.getItemVisual(n,"symbol"),u=$f(r.getItemVisual(n,"symbolSize")),h=r.getItemVisual(n,"style"),f=h&&h.fill,c=s.getModel("emphasis");o.setScale(u),o.traverse(function(g){g.setStyle("fill",f)});var d=ku(r.getItemVisual(n,"symbolOffset"),u);d&&(o.x=d[0],o.y=d[1]);var v=r.getItemVisual(n,"symbolRotate");o.rotation=(v||0)*Math.PI/180||0;var p={};p.showEffectOn=a.get("showEffectOn"),p.rippleScale=s.get(["rippleEffect","scale"]),p.brushType=s.get(["rippleEffect","brushType"]),p.period=s.get(["rippleEffect","period"])*1e3,p.effectOffset=n/r.count(),p.z=a.getShallow("z")||0,p.zlevel=a.getShallow("zlevel")||0,p.symbolType=l,p.color=f,p.rippleEffectColor=s.get(["rippleEffect","color"]),p.rippleNumber=s.get(["rippleEffect","number"]),p.showEffectOn==="render"?(this._effectCfg?this.updateEffectAnimation(p):this.startEffectAnimation(p),this._effectCfg=p):(this._effectCfg=null,this.stopEffectAnimation(),this.onHoverStateChange=function(g){g==="emphasis"?p.showEffectOn!=="render"&&i.startEffectAnimation(p):g==="normal"&&p.showEffectOn!=="render"&&i.stopEffectAnimation()}),this._effectCfg=p,Sr(this,c.get("focus"),c.get("blurScope"),c.get("disabled"))},t.prototype.fadeOut=function(r){r&&r()},t}(re),Mj=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){this._symbolDraw=new Lv(wj)},t.prototype.render=function(r,n,i){var a=r.getData(),o=this._symbolDraw;o.updateData(a,{clipShape:this._getClipShape(r)}),this.group.add(o.group)},t.prototype._getClipShape=function(r){var n=r.coordinateSystem,i=n&&n.getArea&&n.getArea();return r.get("clip",!0)?i:null},t.prototype.updateTransform=function(r,n,i){var a=r.getData();this.group.dirty();var o=Pv("").reset(r,n,i);o.progress&&o.progress({start:0,end:a.count(),count:a.count()},a),this._symbolDraw.updateLayout()},t.prototype._updateGroupTransform=function(r){var n=r.coordinateSystem;n&&n.getRoamTransform&&(this.group.transform=eV(n.getRoamTransform()),this.group.decomposeTransform())},t.prototype.remove=function(r,n){this._symbolDraw&&this._symbolDraw.remove(!0)},t.type="effectScatter",t}(De),Aj=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r}return t.prototype.getInitialData=function(r,n){return Qa(null,this,{useEncodeDefaulter:!0})},t.prototype.brushSelector=function(r,n,i){return i.point(n.getItemLayout(r))},t.type="series.effectScatter",t.dependencies=["grid","polar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,effectType:"ripple",progressive:0,showEffectOn:"render",clip:!0,rippleEffect:{period:4,scale:2.5,brushType:"fill",number:3},universalTransition:{divideShape:"clone"},symbolSize:10},t}(Ue);function Ej(e){e.registerChartView(Mj),e.registerSeriesModel(Aj),e.registerLayout(Pv("effectScatter"))}var gz=function(e){q(t,e);function t(r,n,i){var a=e.call(this)||this;return a.add(a.createLine(r,n,i)),a._updateEffectSymbol(r,n),a}return t.prototype.createLine=function(r,n,i){return new mM(r,n,i)},t.prototype._updateEffectSymbol=function(r,n){var i=r.getItemModel(n),a=i.getModel("effect"),o=a.get("symbolSize"),s=a.get("symbol");at(o)||(o=[o,o]);var l=r.getItemVisual(n,"style"),u=a.get("color")||l&&l.stroke,h=this.childAt(1);this._symbolType!==s&&(this.remove(h),h=Pr(s,-.5,-.5,1,1,u),h.z2=100,h.culling=!0,this.add(h)),h&&(h.setStyle("shadowColor",u),h.setStyle(a.getItemStyle(["color"])),h.scaleX=o[0],h.scaleY=o[1],h.setColor(u),this._symbolType=s,this._symbolScale=o,this._updateEffectAnimation(r,a,n))},t.prototype._updateEffectAnimation=function(r,n,i){var a=this.childAt(1);if(a){var o=r.getItemLayout(i),s=n.get("period")*1e3,l=n.get("loop"),u=n.get("roundTrip"),h=n.get("constantSpeed"),f=pn(n.get("delay"),function(d){return d/r.count()*s/3});if(a.ignore=!0,this._updateAnimationPoints(a,o),h>0&&(s=this._getLineLength(a)/h*1e3),s!==this._period||l!==this._loop||u!==this._roundTrip){a.stopAnimation();var c=void 0;Yt(f)?c=f(i):c=f,a.__t>0&&(c=-s*a.__t),this._animateSymbol(a,s,c,l,u)}this._period=s,this._loop=l,this._roundTrip=u}},t.prototype._animateSymbol=function(r,n,i,a,o){if(n>0){r.__t=0;var s=this,l=r.animate("",a).when(o?n*2:n,{__t:o?2:1}).delay(i).during(function(){s._updateSymbolPosition(r)});a||l.done(function(){s.remove(r)}),l.start()}},t.prototype._getLineLength=function(r){return gs(r.__p1,r.__cp1)+gs(r.__cp1,r.__p2)},t.prototype._updateAnimationPoints=function(r,n){r.__p1=n[0],r.__p2=n[1],r.__cp1=n[2]||[(n[0][0]+n[1][0])/2,(n[0][1]+n[1][1])/2]},t.prototype.updateData=function(r,n,i){this.childAt(0).updateData(r,n,i),this._updateEffectSymbol(r,n)},t.prototype._updateSymbolPosition=function(r){var n=r.__p1,i=r.__p2,a=r.__cp1,o=r.__t<1?r.__t:2-r.__t,s=[r.x,r.y],l=s.slice(),u=dn,h=aS;s[0]=u(n[0],a[0],i[0],o),s[1]=u(n[1],a[1],i[1],o);var f=r.__t<1?h(n[0],a[0],i[0],o):h(i[0],a[0],n[0],1-o),c=r.__t<1?h(n[1],a[1],i[1],o):h(i[1],a[1],n[1],1-o);r.rotation=-Math.atan2(c,f)-Math.PI/2,(this._symbolType==="line"||this._symbolType==="rect"||this._symbolType==="roundRect")&&(r.__lastT!==void 0&&r.__lastT<r.__t?(r.scaleY=gs(l,s)*1.05,o===1&&(s[0]=l[0]+(s[0]-l[0])/2,s[1]=l[1]+(s[1]-l[1])/2)):r.__lastT===1?r.scaleY=2*gs(n,s):r.scaleY=this._symbolScale[1]),r.__lastT=r.__t,r.ignore=!1,r.x=s[0],r.y=s[1]},t.prototype.updateLayout=function(r,n){this.childAt(0).updateLayout(r,n);var i=r.getItemModel(n).getModel("effect");this._updateEffectAnimation(r,i,n)},t}(re),mz=function(e){q(t,e);function t(r,n,i){var a=e.call(this)||this;return a._createPolyline(r,n,i),a}return t.prototype._createPolyline=function(r,n,i){var a=r.getItemLayout(n),o=new $n({shape:{points:a}});this.add(o),this._updateCommonStl(r,n,i)},t.prototype.updateData=function(r,n,i){var a=r.hostModel,o=this.childAt(0),s={shape:{points:r.getItemLayout(n)}};ke(o,s,a,n),this._updateCommonStl(r,n,i)},t.prototype._updateCommonStl=function(r,n,i){var a=this.childAt(0),o=r.getItemModel(n),s=i&&i.emphasisLineStyle,l=i&&i.focus,u=i&&i.blurScope,h=i&&i.emphasisDisabled;if(!i||r.hasItemOption){var f=o.getModel("emphasis");s=f.getModel("lineStyle").getLineStyle(),h=f.get("disabled"),l=f.get("focus"),u=f.get("blurScope")}a.useStyle(r.getItemVisual(n,"style")),a.style.fill=null,a.style.strokeNoScale=!0;var c=a.ensureState("emphasis");c.style=s,Sr(this,l,u,h)},t.prototype.updateLayout=function(r,n){var i=this.childAt(0);i.setShape("points",r.getItemLayout(n))},t}(re),Cj=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r._lastFrame=0,r._lastFramePercent=0,r}return t.prototype.createLine=function(r,n,i){return new mz(r,n,i)},t.prototype._updateAnimationPoints=function(r,n){this._points=n;for(var i=[0],a=0,o=1;o<n.length;o++){var s=n[o-1],l=n[o];a+=gs(s,l),i.push(a)}if(a===0){this._length=0;return}for(var o=0;o<i.length;o++)i[o]/=a;this._offsets=i,this._length=a},t.prototype._getLineLength=function(){return this._length},t.prototype._updateSymbolPosition=function(r){var n=r.__t<1?r.__t:2-r.__t,i=this._points,a=this._offsets,o=i.length;if(a){var s=this._lastFrame,l;if(n<this._lastFramePercent){var u=Math.min(s+1,o-1);for(l=u;l>=0&&!(a[l]<=n);l--);l=Math.min(l,o-2)}else{for(l=s;l<o&&!(a[l]>n);l++);l=Math.min(l-1,o-2)}var h=(n-a[l])/(a[l+1]-a[l]),f=i[l],c=i[l+1];r.x=f[0]*(1-h)+h*c[0],r.y=f[1]*(1-h)+h*c[1];var d=r.__t<1?c[0]-f[0]:f[0]-c[0],v=r.__t<1?c[1]-f[1]:f[1]-c[1];r.rotation=-Math.atan2(v,d)-Math.PI/2,this._lastFrame=l,this._lastFramePercent=n,r.ignore=!1}},t}(gz),Dj=function(){function e(){this.polyline=!1,this.curveness=0,this.segs=[]}return e}(),Lj=function(e){q(t,e);function t(r){var n=e.call(this,r)||this;return n._off=0,n.hoverDataIdx=-1,n}return t.prototype.reset=function(){this.notClear=!1,this._off=0},t.prototype.getDefaultStyle=function(){return{stroke:"#000",fill:null}},t.prototype.getDefaultShape=function(){return new Dj},t.prototype.buildPath=function(r,n){var i=n.segs,a=n.curveness,o;if(n.polyline)for(o=this._off;o<i.length;){var s=i[o++];if(s>0){r.moveTo(i[o++],i[o++]);for(var l=1;l<s;l++)r.lineTo(i[o++],i[o++])}}else for(o=this._off;o<i.length;){var u=i[o++],h=i[o++],f=i[o++],c=i[o++];if(r.moveTo(u,h),a>0){var d=(u+f)/2-(h-c)*a,v=(h+c)/2-(f-u)*a;r.quadraticCurveTo(d,v,f,c)}else r.lineTo(f,c)}this.incremental&&(this._off=o,this.notClear=!0)},t.prototype.findDataIndex=function(r,n){var i=this.shape,a=i.segs,o=i.curveness,s=this.style.lineWidth;if(i.polyline)for(var l=0,u=0;u<a.length;){var h=a[u++];if(h>0)for(var f=a[u++],c=a[u++],d=1;d<h;d++){var v=a[u++],p=a[u++];if(go(f,c,v,p,s,r,n))return l}l++}else for(var l=0,u=0;u<a.length;){var f=a[u++],c=a[u++],v=a[u++],p=a[u++];if(o>0){var g=(f+v)/2-(c-p)*o,m=(c+p)/2-(v-f)*o;if(UO(f,c,g,m,v,p,s,r,n))return l}else if(go(f,c,v,p,s,r,n))return l;l++}return-1},t.prototype.contain=function(r,n){var i=this.transformCoordToLocal(r,n),a=this.getBoundingRect();if(r=i[0],n=i[1],a.contain(r,n)){var o=this.hoverDataIdx=this.findDataIndex(r,n);return o>=0}return this.hoverDataIdx=-1,!1},t.prototype.getBoundingRect=function(){var r=this._rect;if(!r){for(var n=this.shape,i=n.segs,a=1/0,o=1/0,s=-1/0,l=-1/0,u=0;u<i.length;){var h=i[u++],f=i[u++];a=Math.min(h,a),s=Math.max(h,s),o=Math.min(f,o),l=Math.max(f,l)}r=this._rect=new fe(a,o,s,l)}return r},t}(_e),Rj=function(){function e(){this.group=new re}return e.prototype.updateData=function(t){this._clear();var r=this._create();r.setShape({segs:t.getLayout("linesPoints")}),this._setCommon(r,t)},e.prototype.incrementalPrepareUpdate=function(t){this.group.removeAll(),this._clear()},e.prototype.incrementalUpdate=function(t,r){var n=this._newAdded[0],i=r.getLayout("linesPoints"),a=n&&n.shape.segs;if(a&&a.length<2e4){var o=a.length,s=new Float32Array(o+i.length);s.set(a),s.set(i,o),n.setShape({segs:s})}else{this._newAdded=[];var l=this._create();l.incremental=!0,l.setShape({segs:i}),this._setCommon(l,r),l.__startIndex=t.start}},e.prototype.remove=function(){this._clear()},e.prototype.eachRendered=function(t){this._newAdded[0]&&t(this._newAdded[0])},e.prototype._create=function(){var t=new Lj({cursor:"default",ignoreCoarsePointer:!0});return this._newAdded.push(t),this.group.add(t),t},e.prototype._setCommon=function(t,r,n){var i=r.hostModel;t.setShape({polyline:i.get("polyline"),curveness:i.get(["lineStyle","curveness"])}),t.useStyle(i.getModel("lineStyle").getLineStyle()),t.style.strokeNoScale=!0;var a=r.getVisual("style");a&&a.stroke&&t.setStyle("stroke",a.stroke),t.setStyle("fill",null);var o=oe(t);o.seriesIndex=i.seriesIndex,t.on("mousemove",function(s){o.dataIndex=null;var l=t.hoverDataIdx;l>0&&(o.dataIndex=l+t.__startIndex)})},e.prototype._clear=function(){this._newAdded=[],this.group.removeAll()},e}(),_z={seriesType:"lines",plan:Zf(),reset:function(e){var t=e.coordinateSystem;if(t){var r=e.get("polyline"),n=e.pipelineContext.large;return{progress:function(i,a){var o=[];if(n){var s=void 0,l=i.end-i.start;if(r){for(var u=0,h=i.start;h<i.end;h++)u+=e.getLineCoordsCount(h);s=new Float32Array(l+u*2)}else s=new Float32Array(l*4);for(var f=0,c=[],h=i.start;h<i.end;h++){var d=e.getLineCoords(h,o);r&&(s[f++]=d);for(var v=0;v<d;v++)c=t.dataToPoint(o[v],!1,c),s[f++]=c[0],s[f++]=c[1]}a.setLayout("linesPoints",s)}else for(var h=i.start;h<i.end;h++){var p=a.getItemModel(h),d=e.getLineCoords(h,o),g=[];if(r)for(var m=0;m<d;m++)g.push(t.dataToPoint(o[m]));else{g[0]=t.dataToPoint(o[0]),g[1]=t.dataToPoint(o[1]);var _=p.get(["lineStyle","curveness"]);+_&&(g[2]=[(g[0][0]+g[1][0])/2-(g[0][1]-g[1][1])*_,(g[0][1]+g[1][1])/2-(g[1][0]-g[0][0])*_])}a.setItemLayout(h,g)}}}}}},Pj=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=r.getData(),o=this._updateLineDraw(a,r),s=r.get("zlevel"),l=r.get(["effect","trailLength"]),u=i.getZr(),h=u.painter.getType()==="svg";h||u.painter.getLayer(s).clear(!0),this._lastZlevel!=null&&!h&&u.configLayer(this._lastZlevel,{motionBlur:!1}),this._showEffect(r)&&l>0&&(h||u.configLayer(s,{motionBlur:!0,lastFrameAlpha:Math.max(Math.min(l/10+.9,1),0)})),o.updateData(a);var f=r.get("clip",!0)&&Rv(r.coordinateSystem,!1,r);f?this.group.setClipPath(f):this.group.removeClipPath(),this._lastZlevel=s,this._finished=!0},t.prototype.incrementalPrepareRender=function(r,n,i){var a=r.getData(),o=this._updateLineDraw(a,r);o.incrementalPrepareUpdate(a),this._clearLayer(i),this._finished=!1},t.prototype.incrementalRender=function(r,n,i){this._lineDraw.incrementalUpdate(r,n.getData()),this._finished=r.end===n.getData().count()},t.prototype.eachRendered=function(r){this._lineDraw&&this._lineDraw.eachRendered(r)},t.prototype.updateTransform=function(r,n,i){var a=r.getData(),o=r.pipelineContext;if(!this._finished||o.large||o.progressiveRender)return{update:!0};var s=_z.reset(r,n,i);s.progress&&s.progress({start:0,end:a.count(),count:a.count()},a),this._lineDraw.updateLayout(),this._clearLayer(i)},t.prototype._updateLineDraw=function(r,n){var i=this._lineDraw,a=this._showEffect(n),o=!!n.get("polyline"),s=n.pipelineContext,l=s.large;return(!i||a!==this._hasEffet||o!==this._isPolyline||l!==this._isLargeDraw)&&(i&&i.remove(),i=this._lineDraw=l?new Rj:new _M(o?a?Cj:mz:a?gz:mM),this._hasEffet=a,this._isPolyline=o,this._isLargeDraw=l),this.group.add(i.group),i},t.prototype._showEffect=function(r){return!!r.get(["effect","show"])},t.prototype._clearLayer=function(r){var n=r.getZr(),i=n.painter.getType()==="svg";!i&&this._lastZlevel!=null&&n.painter.getLayer(this._lastZlevel).clear(!0)},t.prototype.remove=function(r,n){this._lineDraw&&this._lineDraw.remove(),this._lineDraw=null,this._clearLayer(n)},t.prototype.dispose=function(r,n){this.remove(r,n)},t.type="lines",t}(De),Ij=typeof Uint32Array>"u"?Array:Uint32Array,Nj=typeof Float64Array>"u"?Array:Float64Array;function TL(e){var t=e.data;t&&t[0]&&t[0][0]&&t[0][0].coord&&(e.data=ft(t,function(r){var n=[r[0].coord,r[1].coord],i={coords:n};return r[0].name&&(i.fromName=r[0].name),r[1].name&&(i.toName=r[1].name),Hb([i,r[0],r[1]])}))}var Oj=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.visualStyleAccessPath="lineStyle",r.visualDrawType="stroke",r}return t.prototype.init=function(r){r.data=r.data||[],TL(r);var n=this._processFlatCoordsArray(r.data);this._flatCoords=n.flatCoords,this._flatCoordsOffset=n.flatCoordsOffset,n.flatCoords&&(r.data=new Float32Array(n.count)),e.prototype.init.apply(this,arguments)},t.prototype.mergeOption=function(r){if(TL(r),r.data){var n=this._processFlatCoordsArray(r.data);this._flatCoords=n.flatCoords,this._flatCoordsOffset=n.flatCoordsOffset,n.flatCoords&&(r.data=new Float32Array(n.count))}e.prototype.mergeOption.apply(this,arguments)},t.prototype.appendData=function(r){var n=this._processFlatCoordsArray(r.data);n.flatCoords&&(this._flatCoords?(this._flatCoords=yu(this._flatCoords,n.flatCoords),this._flatCoordsOffset=yu(this._flatCoordsOffset,n.flatCoordsOffset)):(this._flatCoords=n.flatCoords,this._flatCoordsOffset=n.flatCoordsOffset),r.data=new Float32Array(n.count)),this.getRawData().appendData(r.data)},t.prototype._getCoordsFromItemModel=function(r){var n=this.getData().getItemModel(r),i=n.option instanceof Array?n.option:n.getShallow("coords");return i},t.prototype.getLineCoordsCount=function(r){return this._flatCoordsOffset?this._flatCoordsOffset[r*2+1]:this._getCoordsFromItemModel(r).length},t.prototype.getLineCoords=function(r,n){if(this._flatCoordsOffset){for(var i=this._flatCoordsOffset[r*2],a=this._flatCoordsOffset[r*2+1],o=0;o<a;o++)n[o]=n[o]||[],n[o][0]=this._flatCoords[i+o*2],n[o][1]=this._flatCoords[i+o*2+1];return a}else{for(var s=this._getCoordsFromItemModel(r),o=0;o<s.length;o++)n[o]=n[o]||[],n[o][0]=s[o][0],n[o][1]=s[o][1];return s.length}},t.prototype._processFlatCoordsArray=function(r){var n=0;if(this._flatCoords&&(n=this._flatCoords.length),Be(r[0])){for(var i=r.length,a=new Ij(i),o=new Nj(i),s=0,l=0,u=0,h=0;h<i;){u++;var f=r[h++];a[l++]=s+n,a[l++]=f;for(var c=0;c<f;c++){var d=r[h++],v=r[h++];o[s++]=d,o[s++]=v}}return{flatCoordsOffset:new Uint32Array(a.buffer,0,l),flatCoords:o,count:u}}return{flatCoordsOffset:null,flatCoords:null,count:r.length}},t.prototype.getInitialData=function(r,n){var i=new xr(["value"],this);return i.hasItemOption=!1,i.initData(r.data,[],function(a,o,s,l){if(a instanceof Array)return NaN;i.hasItemOption=!0;var u=a.value;if(u!=null)return u instanceof Array?u[l]:u}),i},t.prototype.formatTooltip=function(r,n,i){var a=this.getData(),o=a.getItemModel(r),s=o.get("name");if(s)return s;var l=o.get("fromName"),u=o.get("toName"),h=[];return l!=null&&h.push(l),u!=null&&h.push(u),on("nameValue",{name:h.join(" > ")})},t.prototype.preventIncremental=function(){return!!this.get(["effect","show"])},t.prototype.getProgressive=function(){var r=this.option.progressive;return r??(this.option.large?1e4:this.get("progressive"))},t.prototype.getProgressiveThreshold=function(){var r=this.option.progressiveThreshold;return r??(this.option.large?2e4:this.get("progressiveThreshold"))},t.prototype.getZLevelKey=function(){var r=this.getModel("effect"),n=r.get("trailLength");return this.getData().count()>this.getProgressiveThreshold()?this.id:r.get("show")&&n>0?n+"":""},t.type="series.lines",t.dependencies=["grid","polar","geo","calendar"],t.defaultOption={coordinateSystem:"geo",z:2,legendHoverLink:!0,xAxisIndex:0,yAxisIndex:0,symbol:["none","none"],symbolSize:[10,10],geoIndex:0,effect:{show:!1,period:4,constantSpeed:0,symbol:"circle",symbolSize:3,loop:!0,trailLength:.2},large:!1,largeThreshold:2e3,polyline:!1,clip:!0,label:{show:!1,position:"end"},lineStyle:{opacity:.5}},t}(Ue);function Gp(e){return e instanceof Array||(e=[e,e]),e}var Fj={seriesType:"lines",reset:function(e){var t=Gp(e.get("symbol")),r=Gp(e.get("symbolSize")),n=e.getData();n.setVisual("fromSymbol",t&&t[0]),n.setVisual("toSymbol",t&&t[1]),n.setVisual("fromSymbolSize",r&&r[0]),n.setVisual("toSymbolSize",r&&r[1]);function i(a,o){var s=a.getItemModel(o),l=Gp(s.getShallow("symbol",!0)),u=Gp(s.getShallow("symbolSize",!0));l[0]&&a.setItemVisual(o,"fromSymbol",l[0]),l[1]&&a.setItemVisual(o,"toSymbol",l[1]),u[0]&&a.setItemVisual(o,"fromSymbolSize",u[0]),u[1]&&a.setItemVisual(o,"toSymbolSize",u[1])}return{dataEach:n.hasItemOption?i:null}}};function Bj(e){e.registerChartView(Pj),e.registerSeriesModel(Oj),e.registerLayout(_z),e.registerVisual(Fj)}var Uj=256,zj=function(){function e(){this.blurSize=30,this.pointSize=20,this.maxOpacity=1,this.minOpacity=0,this._gradientPixels={inRange:null,outOfRange:null};var t=Ns.createCanvas();this.canvas=t}return e.prototype.update=function(t,r,n,i,a,o){var s=this._getBrush(),l=this._getGradient(a,"inRange"),u=this._getGradient(a,"outOfRange"),h=this.pointSize+this.blurSize,f=this.canvas,c=f.getContext("2d"),d=t.length;f.width=r,f.height=n;for(var v=0;v<d;++v){var p=t[v],g=p[0],m=p[1],_=p[2],y=i(_);c.globalAlpha=y,c.drawImage(s,g-h,m-h)}if(!f.width||!f.height)return f;for(var x=c.getImageData(0,0,f.width,f.height),T=x.data,S=0,M=T.length,w=this.minOpacity,b=this.maxOpacity,A=b-w;S<M;){var y=T[S+3]/256,E=Math.floor(y*(Uj-1))*4;if(y>0){var C=o(y)?l:u;y>0&&(y=y*A+w),T[S++]=C[E],T[S++]=C[E+1],T[S++]=C[E+2],T[S++]=C[E+3]*y*256}else S+=4}return c.putImageData(x,0,0),f},e.prototype._getBrush=function(){var t=this._brushCanvas||(this._brushCanvas=Ns.createCanvas()),r=this.pointSize+this.blurSize,n=r*2;t.width=n,t.height=n;var i=t.getContext("2d");return i.clearRect(0,0,n,n),i.shadowOffsetX=n,i.shadowBlur=this.blurSize,i.shadowColor="#000",i.beginPath(),i.arc(-r,r,this.pointSize,0,Math.PI*2,!0),i.closePath(),i.fill(),t},e.prototype._getGradient=function(t,r){for(var n=this._gradientPixels,i=n[r]||(n[r]=new Uint8ClampedArray(256*4)),a=[0,0,0,0],o=0,s=0;s<256;s++)t[r](s/255,!0,a),i[o++]=a[0],i[o++]=a[1],i[o++]=a[2],i[o++]=a[3];return i},e}();function kj(e,t,r){var n=e[1]-e[0];t=ft(t,function(o){return{interval:[(o.interval[0]-e[0])/n,(o.interval[1]-e[0])/n]}});var i=t.length,a=0;return function(o){var s;for(s=a;s<i;s++){var l=t[s].interval;if(l[0]<=o&&o<=l[1]){a=s;break}}if(s===i)for(s=a-1;s>=0;s--){var l=t[s].interval;if(l[0]<=o&&o<=l[1]){a=s;break}}return s>=0&&s<i&&r[s]}}function Gj(e,t){var r=e[1]-e[0];return t=[(t[0]-e[0])/r,(t[1]-e[0])/r],function(n){return n>=t[0]&&n<=t[1]}}function bL(e){var t=e.dimensions;return t[0]==="lng"&&t[1]==="lat"}var Vj=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a;n.eachComponent("visualMap",function(s){s.eachTargetSeries(function(l){l===r&&(a=s)})}),this._progressiveEls=null,this.group.removeAll();var o=r.coordinateSystem;o.type==="cartesian2d"||o.type==="calendar"?this._renderOnCartesianAndCalendar(r,i,0,r.getData().count()):bL(o)&&this._renderOnGeo(o,r,a,i)},t.prototype.incrementalPrepareRender=function(r,n,i){this.group.removeAll()},t.prototype.incrementalRender=function(r,n,i,a){var o=n.coordinateSystem;o&&(bL(o)?this.render(n,i,a):(this._progressiveEls=[],this._renderOnCartesianAndCalendar(n,a,r.start,r.end,!0)))},t.prototype.eachRendered=function(r){Hs(this._progressiveEls||this.group,r)},t.prototype._renderOnCartesianAndCalendar=function(r,n,i,a,o){var s=r.coordinateSystem,l=Vu(s,"cartesian2d"),u,h,f,c;if(l){var d=s.getAxis("x"),v=s.getAxis("y");u=d.getBandWidth()+.5,h=v.getBandWidth()+.5,f=d.scale.getExtent(),c=v.scale.getExtent()}for(var p=this.group,g=r.getData(),m=r.getModel(["emphasis","itemStyle"]).getItemStyle(),_=r.getModel(["blur","itemStyle"]).getItemStyle(),y=r.getModel(["select","itemStyle"]).getItemStyle(),x=r.get(["itemStyle","borderRadius"]),T=an(r),S=r.getModel("emphasis"),M=S.get("focus"),w=S.get("blurScope"),b=S.get("disabled"),A=l?[g.mapDimension("x"),g.mapDimension("y"),g.mapDimension("value")]:[g.mapDimension("time"),g.mapDimension("value")],E=i;E<a;E++){var C=void 0,D=g.getItemVisual(E,"style");if(l){var L=g.get(A[0],E),P=g.get(A[1],E);if(isNaN(g.get(A[2],E))||isNaN(L)||isNaN(P)||L<f[0]||L>f[1]||P<c[0]||P>c[1])continue;var N=s.dataToPoint([L,P]);C=new Ae({shape:{x:N[0]-u/2,y:N[1]-h/2,width:u,height:h},style:D})}else{if(isNaN(g.get(A[1],E)))continue;C=new Ae({z2:1,shape:s.dataToRect([g.get(A[0],E)]).contentShape,style:D})}if(g.hasItemOption){var O=g.getItemModel(E),I=O.getModel("emphasis");m=I.getModel("itemStyle").getItemStyle(),_=O.getModel(["blur","itemStyle"]).getItemStyle(),y=O.getModel(["select","itemStyle"]).getItemStyle(),x=O.get(["itemStyle","borderRadius"]),M=I.get("focus"),w=I.get("blurScope"),b=I.get("disabled"),T=an(O)}C.shape.r=x;var k=r.getRawValue(E),z="-";k&&k[2]!=null&&(z=k[2]+""),Sn(C,T,{labelFetcher:r,labelDataIndex:E,defaultOpacity:D.opacity,defaultText:z}),C.ensureState("emphasis").style=m,C.ensureState("blur").style=_,C.ensureState("select").style=y,Sr(C,M,w,b),C.incremental=o,o&&(C.states.emphasis.hoverLayer=!0),p.add(C),g.setItemGraphicEl(E,C),this._progressiveEls&&this._progressiveEls.push(C)}},t.prototype._renderOnGeo=function(r,n,i,a){var o=i.targetVisuals.inRange,s=i.targetVisuals.outOfRange,l=n.getData(),u=this._hmLayer||this._hmLayer||new zj;u.blurSize=n.get("blurSize"),u.pointSize=n.get("pointSize"),u.minOpacity=n.get("minOpacity"),u.maxOpacity=n.get("maxOpacity");var h=r.getViewRect().clone(),f=r.getRoamTransform();h.applyTransform(f);var c=Math.max(h.x,0),d=Math.max(h.y,0),v=Math.min(h.width+h.x,a.getWidth()),p=Math.min(h.height+h.y,a.getHeight()),g=v-c,m=p-d,_=[l.mapDimension("lng"),l.mapDimension("lat"),l.mapDimension("value")],y=l.mapArray(_,function(M,w,b){var A=r.dataToPoint([M,w]);return A[0]-=c,A[1]-=d,A.push(b),A}),x=i.getExtent(),T=i.type==="visualMap.continuous"?Gj(x,i.option.range):kj(x,i.getPieceList(),i.option.selected);u.update(y,g,m,o.color.getNormalizer(),{inRange:o.color.getColorMapper(),outOfRange:s.color.getColorMapper()},T);var S=new hn({style:{width:g,height:m,x:c,y:d,image:u.canvas},silent:!0});this.group.add(S)},t.type="heatmap",t}(De),Hj=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getInitialData=function(r,n){return Qa(null,this,{generateCoord:"value"})},t.prototype.preventIncremental=function(){var r=Yf.get(this.get("coordinateSystem"));if(r&&r.dimensions)return r.dimensions[0]==="lng"&&r.dimensions[1]==="lat"},t.type="series.heatmap",t.dependencies=["grid","geo","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,geoIndex:0,blurSize:30,pointSize:20,maxOpacity:1,minOpacity:0,select:{itemStyle:{borderColor:"#212121"}}},t}(Ue);function Wj(e){e.registerChartView(Vj),e.registerSeriesModel(Hj)}var Xj=["itemStyle","borderWidth"],wL=[{xy:"x",wh:"width",index:0,posDesc:["left","right"]},{xy:"y",wh:"height",index:1,posDesc:["top","bottom"]}],yx=new Vo,Yj=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=this.group,o=r.getData(),s=this._data,l=r.coordinateSystem,u=l.getBaseAxis(),h=u.isHorizontal(),f=l.master.getRect(),c={ecSize:{width:i.getWidth(),height:i.getHeight()},seriesModel:r,coordSys:l,coordSysExtent:[[f.x,f.x+f.width],[f.y,f.y+f.height]],isHorizontal:h,valueDim:wL[+h],categoryDim:wL[1-+h]};o.diff(s).add(function(v){if(o.hasValue(v)){var p=AL(o,v),g=ML(o,v,p,c),m=EL(o,c,g);o.setItemGraphicEl(v,m),a.add(m),DL(m,c,g)}}).update(function(v,p){var g=s.getItemGraphicEl(p);if(!o.hasValue(v)){a.remove(g);return}var m=AL(o,v),_=ML(o,v,m,c),y=wz(o,_);g&&y!==g.__pictorialShapeStr&&(a.remove(g),o.setItemGraphicEl(v,null),g=null),g?Qj(g,c,_):g=EL(o,c,_,!0),o.setItemGraphicEl(v,g),g.__pictorialSymbolMeta=_,a.add(g),DL(g,c,_)}).remove(function(v){var p=s.getItemGraphicEl(v);p&&CL(s,v,p.__pictorialSymbolMeta.animationModel,p)}).execute();var d=r.get("clip",!0)?Rv(r.coordinateSystem,!1,r):null;return d?a.setClipPath(d):a.removeClipPath(),this._data=o,this.group},t.prototype.remove=function(r,n){var i=this.group,a=this._data;r.get("animation")?a&&a.eachItemGraphicEl(function(o){CL(a,oe(o).dataIndex,r,o)}):i.removeAll()},t.type="pictorialBar",t}(De);function ML(e,t,r,n){var i=e.getItemLayout(t),a=r.get("symbolRepeat"),o=r.get("symbolClip"),s=r.get("symbolPosition")||"start",l=r.get("symbolRotate"),u=(l||0)*Math.PI/180||0,h=r.get("symbolPatternSize")||2,f=r.isAnimationEnabled(),c={dataIndex:t,layout:i,itemModel:r,symbolType:e.getItemVisual(t,"symbol")||"circle",style:e.getItemVisual(t,"style"),symbolClip:o,symbolRepeat:a,symbolRepeatDirection:r.get("symbolRepeatDirection"),symbolPatternSize:h,rotation:u,animationModel:f?r:null,hoverScale:f&&r.get(["emphasis","scale"]),z2:r.getShallow("z",!0)||0};Zj(r,a,i,n,c),qj(e,t,i,a,o,c.boundingLength,c.pxSign,h,n,c),$j(r,c.symbolScale,u,n,c);var d=c.symbolSize,v=ku(r.get("symbolOffset"),d);return Kj(r,d,i,a,o,v,s,c.valueLineWidth,c.boundingLength,c.repeatCutLength,n,c),c}function Zj(e,t,r,n,i){var a=n.valueDim,o=e.get("symbolBoundingData"),s=n.coordSys.getOtherAxis(n.coordSys.getBaseAxis()),l=s.toGlobalCoord(s.dataToCoord(0)),u=1-+(r[a.wh]<=0),h;if(at(o)){var f=[xx(s,o[0])-l,xx(s,o[1])-l];f[1]<f[0]&&f.reverse(),h=f[u]}else o!=null?h=xx(s,o)-l:t?h=n.coordSysExtent[a.index][u]-l:h=r[a.wh];i.boundingLength=h,t&&(i.repeatCutLength=r[a.wh]);var c=a.xy==="x",d=s.inverse;i.pxSign=c&&!d||!c&&d?h>=0?1:-1:h>0?1:-1}function xx(e,t){return e.toGlobalCoord(e.dataToCoord(e.scale.parse(t)))}function qj(e,t,r,n,i,a,o,s,l,u){var h=l.valueDim,f=l.categoryDim,c=Math.abs(r[f.wh]),d=e.getItemVisual(t,"symbolSize"),v;at(d)?v=d.slice():d==null?v=["100%","100%"]:v=[d,d],v[f.index]=Tt(v[f.index],c),v[h.index]=Tt(v[h.index],n?c:Math.abs(a)),u.symbolSize=v;var p=u.symbolScale=[v[0]/s,v[1]/s];p[h.index]*=(l.isHorizontal?-1:1)*o}function $j(e,t,r,n,i){var a=e.get(Xj)||0;a&&(yx.attr({scaleX:t[0],scaleY:t[1],rotation:r}),yx.updateTransform(),a/=yx.getLineScale(),a*=t[n.valueDim.index]),i.valueLineWidth=a||0}function Kj(e,t,r,n,i,a,o,s,l,u,h,f){var c=h.categoryDim,d=h.valueDim,v=f.pxSign,p=Math.max(t[d.index]+s,0),g=p;if(n){var m=Math.abs(l),_=pn(e.get("symbolMargin"),"15%")+"",y=!1;_.lastIndexOf("!")===_.length-1&&(y=!0,_=_.slice(0,_.length-1));var x=Tt(_,t[d.index]),T=Math.max(p+x*2,0),S=y?0:x*2,M=wO(n),w=M?n:LL((m+S)/T),b=m-w*p;x=b/2/(y?w:Math.max(w-1,1)),T=p+x*2,S=y?0:x*2,!M&&n!=="fixed"&&(w=u?LL((Math.abs(u)+S)/T):0),g=w*T-S,f.repeatTimes=w,f.symbolMargin=x}var A=v*(g/2),E=f.pathPosition=[];E[c.index]=r[c.wh]/2,E[d.index]=o==="start"?A:o==="end"?l-A:l/2,a&&(E[0]+=a[0],E[1]+=a[1]);var C=f.bundlePosition=[];C[c.index]=r[c.xy],C[d.index]=r[d.xy];var D=f.barRectShape=rt({},r);D[d.wh]=v*Math.max(Math.abs(r[d.wh]),Math.abs(E[d.index]+A)),D[c.wh]=r[c.wh];var L=f.clipShape={};L[c.xy]=-r[c.xy],L[c.wh]=h.ecSize[c.wh],L[d.xy]=0,L[d.wh]=r[d.wh]}function yz(e){var t=e.symbolPatternSize,r=Pr(e.symbolType,-t/2,-t/2,t,t);return r.attr({culling:!0}),r.type!=="image"&&r.setStyle({strokeNoScale:!0}),r}function xz(e,t,r,n){var i=e.__pictorialBundle,a=r.symbolSize,o=r.valueLineWidth,s=r.pathPosition,l=t.valueDim,u=r.repeatTimes||0,h=0,f=a[t.valueDim.index]+o+r.symbolMargin*2;for(CM(e,function(p){p.__pictorialAnimationIndex=h,p.__pictorialRepeatTimes=u,h<u?rf(p,null,v(h),r,n):rf(p,null,{scaleX:0,scaleY:0},r,n,function(){i.remove(p)}),h++});h<u;h++){var c=yz(r);c.__pictorialAnimationIndex=h,c.__pictorialRepeatTimes=u,i.add(c);var d=v(h);rf(c,{x:d.x,y:d.y,scaleX:0,scaleY:0},{scaleX:d.scaleX,scaleY:d.scaleY,rotation:d.rotation},r,n)}function v(p){var g=s.slice(),m=r.pxSign,_=p;return(r.symbolRepeatDirection==="start"?m>0:m<0)&&(_=u-1-p),g[l.index]=f*(_-u/2+.5)+s[l.index],{x:g[0],y:g[1],scaleX:r.symbolScale[0],scaleY:r.symbolScale[1],rotation:r.rotation}}}function Sz(e,t,r,n){var i=e.__pictorialBundle,a=e.__pictorialMainPath;a?rf(a,null,{x:r.pathPosition[0],y:r.pathPosition[1],scaleX:r.symbolScale[0],scaleY:r.symbolScale[1],rotation:r.rotation},r,n):(a=e.__pictorialMainPath=yz(r),i.add(a),rf(a,{x:r.pathPosition[0],y:r.pathPosition[1],scaleX:0,scaleY:0,rotation:r.rotation},{scaleX:r.symbolScale[0],scaleY:r.symbolScale[1]},r,n))}function Tz(e,t,r){var n=rt({},t.barRectShape),i=e.__pictorialBarRect;i?rf(i,null,{shape:n},t,r):(i=e.__pictorialBarRect=new Ae({z2:2,shape:n,silent:!0,style:{stroke:"transparent",fill:"transparent",lineWidth:0}}),i.disableMorphing=!0,e.add(i))}function bz(e,t,r,n){if(r.symbolClip){var i=e.__pictorialClipPath,a=rt({},r.clipShape),o=t.valueDim,s=r.animationModel,l=r.dataIndex;if(i)ke(i,{shape:a},s,l);else{a[o.wh]=0,i=new Ae({shape:a}),e.__pictorialBundle.setClipPath(i),e.__pictorialClipPath=i;var u={};u[o.wh]=r.clipShape[o.wh],zu[n?"updateProps":"initProps"](i,{shape:u},s,l)}}}function AL(e,t){var r=e.getItemModel(t);return r.getAnimationDelayParams=jj,r.isAnimationEnabled=Jj,r}function jj(e){return{index:e.__pictorialAnimationIndex,count:e.__pictorialRepeatTimes}}function Jj(){return this.parentModel.isAnimationEnabled()&&!!this.getShallow("animation")}function EL(e,t,r,n){var i=new re,a=new re;return i.add(a),i.__pictorialBundle=a,a.x=r.bundlePosition[0],a.y=r.bundlePosition[1],r.symbolRepeat?xz(i,t,r):Sz(i,t,r),Tz(i,r,n),bz(i,t,r,n),i.__pictorialShapeStr=wz(e,r),i.__pictorialSymbolMeta=r,i}function Qj(e,t,r){var n=r.animationModel,i=r.dataIndex,a=e.__pictorialBundle;ke(a,{x:r.bundlePosition[0],y:r.bundlePosition[1]},n,i),r.symbolRepeat?xz(e,t,r,!0):Sz(e,t,r,!0),Tz(e,r,!0),bz(e,t,r,!0)}function CL(e,t,r,n){var i=n.__pictorialBarRect;i&&i.removeTextContent();var a=[];CM(n,function(o){a.push(o)}),n.__pictorialMainPath&&a.push(n.__pictorialMainPath),n.__pictorialClipPath&&(r=null),R(a,function(o){Fs(o,{scaleX:0,scaleY:0},r,t,function(){n.parent&&n.parent.remove(n)})}),e.setItemGraphicEl(t,null)}function wz(e,t){return[e.getItemVisual(t.dataIndex,"symbol")||"none",!!t.symbolRepeat,!!t.symbolClip].join(":")}function CM(e,t,r){R(e.__pictorialBundle.children(),function(n){n!==e.__pictorialBarRect&&t.call(r,n)})}function rf(e,t,r,n,i,a){t&&e.attr(t),n.symbolClip&&!i?r&&e.attr(r):r&&zu[i?"updateProps":"initProps"](e,r,n.animationModel,n.dataIndex,a)}function DL(e,t,r){var n=r.dataIndex,i=r.itemModel,a=i.getModel("emphasis"),o=a.getModel("itemStyle").getItemStyle(),s=i.getModel(["blur","itemStyle"]).getItemStyle(),l=i.getModel(["select","itemStyle"]).getItemStyle(),u=i.getShallow("cursor"),h=a.get("focus"),f=a.get("blurScope"),c=a.get("scale");CM(e,function(p){if(p instanceof hn){var g=p.style;p.useStyle(rt({image:g.image,x:g.x,y:g.y,width:g.width,height:g.height},r.style))}else p.useStyle(r.style);var m=p.ensureState("emphasis");m.style=o,c&&(m.scaleX=p.scaleX*1.1,m.scaleY=p.scaleY*1.1),p.ensureState("blur").style=s,p.ensureState("select").style=l,u&&(p.cursor=u),p.z2=r.z2});var d=t.valueDim.posDesc[+(r.boundingLength>0)],v=e.__pictorialBarRect;v.ignoreClip=!0,Sn(v,an(i),{labelFetcher:t.seriesModel,labelDataIndex:n,defaultText:vf(t.seriesModel.getData(),n),inheritColor:r.style.fill,defaultOpacity:r.style.opacity,defaultOutsidePosition:d}),Sr(e,h,f,a.get("disabled"))}function LL(e){var t=Math.round(e);return Math.abs(e-t)<1e-4?t:Math.ceil(e)}var tJ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.hasSymbolVisual=!0,r.defaultSymbol="roundRect",r}return t.prototype.getInitialData=function(r){return r.stack=null,e.prototype.getInitialData.apply(this,arguments)},t.type="series.pictorialBar",t.dependencies=["grid"],t.defaultOption=Ws(jd.defaultOption,{symbol:"circle",symbolSize:null,symbolRotate:null,symbolPosition:null,symbolOffset:null,symbolMargin:null,symbolRepeat:!1,symbolRepeatDirection:"end",symbolClip:!1,symbolBoundingData:null,symbolPatternSize:400,barGap:"-100%",clip:!1,progressive:0,emphasis:{scale:!1},select:{itemStyle:{borderColor:"#212121"}}}),t}(jd);function eJ(e){e.registerChartView(Yj),e.registerSeriesModel(tJ),e.registerLayout(e.PRIORITY.VISUAL.LAYOUT,ue(nB,"pictorialBar")),e.registerLayout(e.PRIORITY.VISUAL.PROGRESSIVE_LAYOUT,iB("pictorialBar"))}var rJ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._layers=[],r}return t.prototype.render=function(r,n,i){var a=r.getData(),o=this,s=this.group,l=r.getLayerSeries(),u=a.getLayout("layoutInfo"),h=u.rect,f=u.boundaryGap;s.x=0,s.y=h.y+f[0];function c(g){return g.name}var d=new No(this._layersSeries||[],l,c,c),v=[];d.add(It(p,this,"add")).update(It(p,this,"update")).remove(It(p,this,"remove")).execute();function p(g,m,_){var y=o._layers;if(g==="remove"){s.remove(y[m]);return}for(var x=[],T=[],S,M=l[m].indices,w=0;w<M.length;w++){var b=a.getItemLayout(M[w]),A=b.x,E=b.y0,C=b.y;x.push(A,E),T.push(A,E+C),S=a.getItemVisual(M[w],"style")}var D,L=a.getItemLayout(M[0]),P=r.getModel("label"),N=P.get("margin"),O=r.getModel("emphasis");if(g==="add"){var I=v[m]=new re;D=new $B({shape:{points:x,stackedOnPoints:T,smooth:.4,stackedOnSmooth:.4,smoothConstraint:!1},z2:0}),I.add(D),s.add(I),r.isAnimationEnabled()&&D.setClipPath(nJ(D.getBoundingRect(),r,function(){D.removeClipPath()}))}else{var I=y[_];D=I.childAt(0),s.add(I),v[m]=I,ke(D,{shape:{points:x,stackedOnPoints:T}},r),ya(D)}Sn(D,an(r),{labelDataIndex:M[w-1],defaultText:a.getName(M[w-1]),inheritColor:S.fill},{normal:{verticalAlign:"middle"}}),D.setTextConfig({position:null,local:!0});var k=D.getTextContent();k&&(k.x=L.x-N,k.y=L.y0+L.y/2),D.useStyle(S),a.setItemGraphicEl(m,D),xn(D,r),Sr(D,O.get("focus"),O.get("blurScope"),O.get("disabled"))}this._layersSeries=l,this._layers=v},t.type="themeRiver",t}(De);function nJ(e,t,r){var n=new Ae({shape:{x:e.x-10,y:e.y-10,width:0,height:e.height+20}});return vr(n,{shape:{x:e.x-50,width:e.width+100,height:e.height+20}},t,r),n}var Sx=2,iJ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r){e.prototype.init.apply(this,arguments),this.legendVisualProvider=new Nv(It(this.getData,this),It(this.getRawData,this))},t.prototype.fixData=function(r){var n=r.length,i={},a=xS(r,function(c){return i.hasOwnProperty(c[0]+"")||(i[c[0]+""]=-1),c[2]}),o=[];a.buckets.each(function(c,d){o.push({name:d,dataList:c})});for(var s=o.length,l=0;l<s;++l){for(var u=o[l].name,h=0;h<o[l].dataList.length;++h){var f=o[l].dataList[h][0]+"";i[f]=l}for(var f in i)i.hasOwnProperty(f)&&i[f]!==l&&(i[f]=l,r[n]=[f,0,u],n++)}return r},t.prototype.getInitialData=function(r,n){for(var i=this.getReferringComponents("singleAxis",zr).models[0],a=i.get("type"),o=Xe(r.data,function(v){return v[2]!==void 0}),s=this.fixData(o||[]),l=[],u=this.nameMap=Ut(),h=0,f=0;f<s.length;++f)l.push(s[f][Sx]),u.get(s[f][Sx])||(u.set(s[f][Sx],h),h++);var c=Kf(s,{coordDimensions:["single"],dimensionsDefine:[{name:"time",type:Nm(a)},{name:"value",type:"float"},{name:"name",type:"ordinal"}],encodeDefine:{single:0,value:1,itemName:2}}).dimensions,d=new xr(c,this);return d.initData(s),d},t.prototype.getLayerSeries=function(){for(var r=this.getData(),n=r.count(),i=[],a=0;a<n;++a)i[a]=a;var o=r.mapDimension("single"),s=xS(i,function(u){return r.get("name",u)}),l=[];return s.buckets.each(function(u,h){u.sort(function(f,c){return r.get(o,f)-r.get(o,c)}),l.push({name:h,indices:u})}),l},t.prototype.getAxisTooltipData=function(r,n,i){at(r)||(r=r?[r]:[]);for(var a=this.getData(),o=this.getLayerSeries(),s=[],l=o.length,u,h=0;h<l;++h){for(var f=Number.MAX_VALUE,c=-1,d=o[h].indices.length,v=0;v<d;++v){var p=a.get(r[0],o[h].indices[v]),g=Math.abs(p-n);g<=f&&(u=p,f=g,c=o[h].indices[v])}s.push(c)}return{dataIndices:s,nestestValue:u}},t.prototype.formatTooltip=function(r,n,i){var a=this.getData(),o=a.getName(r),s=a.get(a.mapDimension("value"),r);return on("nameValue",{name:o,value:s})},t.type="series.themeRiver",t.dependencies=["singleAxis"],t.defaultOption={z:2,colorBy:"data",coordinateSystem:"singleAxis",boundaryGap:["10%","10%"],singleAxisIndex:0,animationEasing:"linear",label:{margin:4,show:!0,position:"left",fontSize:11},emphasis:{label:{show:!0}}},t}(Ue);function aJ(e,t){e.eachSeriesByType("themeRiver",function(r){var n=r.getData(),i=r.coordinateSystem,a={},o=i.getRect();a.rect=o;var s=r.get("boundaryGap"),l=i.getAxis();if(a.boundaryGap=s,l.orient==="horizontal"){s[0]=Tt(s[0],o.height),s[1]=Tt(s[1],o.height);var u=o.height-s[0]-s[1];RL(n,r,u)}else{s[0]=Tt(s[0],o.width),s[1]=Tt(s[1],o.width);var h=o.width-s[0]-s[1];RL(n,r,h)}n.setLayout("layoutInfo",a)})}function RL(e,t,r){if(e.count())for(var n=t.coordinateSystem,i=t.getLayerSeries(),a=e.mapDimension("single"),o=e.mapDimension("value"),s=ft(i,function(g){return ft(g.indices,function(m){var _=n.dataToPoint(e.get(a,m));return _[1]=e.get(o,m),_})}),l=oJ(s),u=l.y0,h=r/l.max,f=i.length,c=i[0].indices.length,d,v=0;v<c;++v){d=u[v]*h,e.setItemLayout(i[0].indices[v],{layerIndex:0,x:s[0][v][0],y0:d,y:s[0][v][1]*h});for(var p=1;p<f;++p)d+=s[p-1][v][1]*h,e.setItemLayout(i[p].indices[v],{layerIndex:p,x:s[p][v][0],y0:d,y:s[p][v][1]*h})}}function oJ(e){for(var t=e.length,r=e[0].length,n=[],i=[],a=0,o=0;o<r;++o){for(var s=0,l=0;l<t;++l)s+=e[l][o][1];s>a&&(a=s),n.push(s)}for(var u=0;u<r;++u)i[u]=(a-n[u])/2;a=0;for(var h=0;h<r;++h){var f=n[h]+i[h];f>a&&(a=f)}return{y0:i,max:a}}function sJ(e){e.registerChartView(rJ),e.registerSeriesModel(iJ),e.registerLayout(aJ),e.registerProcessor(Iv("themeRiver"))}var lJ=2,uJ=4,PL=function(e){q(t,e);function t(r,n,i,a){var o=e.call(this)||this;o.z2=lJ,o.textConfig={inside:!0},oe(o).seriesIndex=n.seriesIndex;var s=new we({z2:uJ,silent:r.getModel().get(["label","silent"])});return o.setTextContent(s),o.updateData(!0,r,n,i,a),o}return t.prototype.updateData=function(r,n,i,a,o){this.node=n,n.piece=this,i=i||this._seriesModel,a=a||this._ecModel;var s=this;oe(s).dataIndex=n.dataIndex;var l=n.getModel(),u=l.getModel("emphasis"),h=n.getLayout(),f=rt({},h);f.label=null;var c=n.getVisual("style");c.lineJoin="bevel";var d=n.getVisual("decal");d&&(c.decal=df(d,o));var v=ru(l.getModel("itemStyle"),f,!0);rt(f,v),R(Wn,function(_){var y=s.ensureState(_),x=l.getModel([_,"itemStyle"]);y.style=x.getItemStyle();var T=ru(x,f);T&&(y.shape=T)}),r?(s.setShape(f),s.shape.r=h.r0,vr(s,{shape:{r:h.r}},i,n.dataIndex)):(ke(s,{shape:f},i),ya(s)),s.useStyle(c),this._updateLabel(i);var p=l.getShallow("cursor");p&&s.attr("cursor",p),this._seriesModel=i||this._seriesModel,this._ecModel=a||this._ecModel;var g=u.get("focus"),m=g==="relative"?yu(n.getAncestorsIndices(),n.getDescendantIndices()):g==="ancestor"?n.getAncestorsIndices():g==="descendant"?n.getDescendantIndices():g;Sr(this,m,u.get("blurScope"),u.get("disabled"))},t.prototype._updateLabel=function(r){var n=this,i=this.node.getModel(),a=i.getModel("label"),o=this.node.getLayout(),s=o.endAngle-o.startAngle,l=(o.startAngle+o.endAngle)/2,u=Math.cos(l),h=Math.sin(l),f=this,c=f.getTextContent(),d=this.node.dataIndex,v=a.get("minAngle")/180*Math.PI,p=a.get("show")&&!(v!=null&&Math.abs(s)<v);c.ignore=!p,R(zd,function(m){var _=m==="normal"?i.getModel("label"):i.getModel([m,"label"]),y=m==="normal",x=y?c:c.ensureState(m),T=r.getFormattedLabel(d,m);y&&(T=T||n.node.name),x.style=je(_,{},null,m!=="normal",!0),T&&(x.style.text=T);var S=_.get("show");S!=null&&!y&&(x.ignore=!S);var M=g(_,"position"),w=y?f:f.states[m],b=w.style.fill;w.textConfig={outsideFill:_.get("color")==="inherit"?b:null,inside:M!=="outside"};var A,E=g(_,"distance")||0,C=g(_,"align"),D=g(_,"rotate"),L=Math.PI*.5,P=Math.PI*1.5,N=mi(D==="tangential"?Math.PI/2-l:l),O=N>L&&!Bd(N-L)&&N<P;M==="outside"?(A=o.r+E,C=O?"right":"left"):!C||C==="center"?(s===2*Math.PI&&o.r0===0?A=0:A=(o.r+o.r0)/2,C="center"):C==="left"?(A=o.r0+E,C=O?"right":"left"):C==="right"&&(A=o.r-E,C=O?"left":"right"),x.style.align=C,x.style.verticalAlign=g(_,"verticalAlign")||"middle",x.x=A*u+o.cx,x.y=A*h+o.cy;var I=0;D==="radial"?I=mi(-l)+(O?Math.PI:0):D==="tangential"?I=mi(Math.PI/2-l)+(O?Math.PI:0):Be(D)&&(I=D*Math.PI/180),x.rotation=mi(I)});function g(m,_){var y=m.get(_);return y??a.get(_)}c.dirtyStyle()},t}(Xn),xT="sunburstRootToNode",IL="sunburstHighlight",hJ="sunburstUnhighlight";function fJ(e){e.registerAction({type:xT,update:"updateView"},function(t,r){r.eachComponent({mainType:"series",subType:"sunburst",query:t},n);function n(i,a){var o=Qd(t,[xT],i);if(o){var s=i.getViewRoot();s&&(t.direction=cM(s,o.node)?"rollUp":"drillDown"),i.resetViewRoot(o.node)}}}),e.registerAction({type:IL,update:"none"},function(t,r,n){t=rt({},t),r.eachComponent({mainType:"series",subType:"sunburst",query:t},i);function i(a){var o=Qd(t,[IL],a);o&&(t.dataIndex=o.node.dataIndex)}n.dispatchAction(rt(t,{type:"highlight"}))}),e.registerAction({type:hJ,update:"updateView"},function(t,r,n){t=rt({},t),n.dispatchAction(rt(t,{type:"downplay"}))})}var cJ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i,a){var o=this;this.seriesModel=r,this.api=i,this.ecModel=n;var s=r.getData(),l=s.tree.root,u=r.getViewRoot(),h=this.group,f=r.get("renderLabelForZeroData"),c=[];u.eachNode(function(_){c.push(_)});var d=this._oldChildren||[];v(c,d),m(l,u),this._initEvents(),this._oldChildren=c;function v(_,y){if(_.length===0&&y.length===0)return;new No(y,_,x,x).add(T).update(T).remove(ue(T,null)).execute();function x(S){return S.getId()}function T(S,M){var w=S==null?null:_[S],b=M==null?null:y[M];p(w,b)}}function p(_,y){if(!f&&_&&!_.getValue()&&(_=null),_!==l&&y!==l){if(y&&y.piece)_?(y.piece.updateData(!1,_,r,n,i),s.setItemGraphicEl(_.dataIndex,y.piece)):g(y);else if(_){var x=new PL(_,r,n,i);h.add(x),s.setItemGraphicEl(_.dataIndex,x)}}}function g(_){_&&_.piece&&(h.remove(_.piece),_.piece=null)}function m(_,y){y.depth>0?(o.virtualPiece?o.virtualPiece.updateData(!1,_,r,n,i):(o.virtualPiece=new PL(_,r,n,i),h.add(o.virtualPiece)),y.piece.off("click"),o.virtualPiece.on("click",function(x){o._rootToNode(y.parentNode)})):o.virtualPiece&&(h.remove(o.virtualPiece),o.virtualPiece=null)}},t.prototype._initEvents=function(){var r=this;this.group.off("click"),this.group.on("click",function(n){var i=!1,a=r.seriesModel.getViewRoot();a.eachNode(function(o){if(!i&&o.piece&&o.piece===n.target){var s=o.getModel().get("nodeClick");if(s==="rootToNode")r._rootToNode(o);else if(s==="link"){var l=o.getModel(),u=l.get("link");if(u){var h=l.get("target",!0)||"_blank";Am(u,h)}}i=!0}})})},t.prototype._rootToNode=function(r){r!==this.seriesModel.getViewRoot()&&this.api.dispatchAction({type:xT,from:this.uid,seriesId:this.seriesModel.id,targetNode:r})},t.prototype.containPoint=function(r,n){var i=n.getData(),a=i.getItemLayout(0);if(a){var o=r[0]-a.cx,s=r[1]-a.cy,l=Math.sqrt(o*o+s*s);return l<=a.r&&l>=a.r0}},t.type="sunburst",t}(De),dJ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.ignoreStyleOnData=!0,r}return t.prototype.getInitialData=function(r,n){var i={name:r.name,children:r.data};Mz(i);var a=this._levelModels=ft(r.levels||[],function(l){return new Ie(l,this,n)},this),o=fM.createTree(i,this,s);function s(l){l.wrapMethod("getItemModel",function(u,h){var f=o.getNodeByDataIndex(h),c=a[f.depth];return c&&(u.parentModel=c),u})}return o.data},t.prototype.optionUpdated=function(){this.resetViewRoot()},t.prototype.getDataParams=function(r){var n=e.prototype.getDataParams.apply(this,arguments),i=this.getData().tree.getNodeByDataIndex(r);return n.treePathInfo=n0(i,this),n},t.prototype.getLevelModel=function(r){return this._levelModels&&this._levelModels[r.depth]},t.prototype.getViewRoot=function(){return this._viewRoot},t.prototype.resetViewRoot=function(r){r?this._viewRoot=r:r=this._viewRoot;var n=this.getRawData().tree.root;(!r||r!==n&&!n.contains(r))&&(this._viewRoot=n)},t.prototype.enableAriaDecal=function(){DU(this)},t.type="series.sunburst",t.defaultOption={z:2,center:["50%","50%"],radius:[0,"75%"],clockwise:!0,startAngle:90,minAngle:0,stillShowZeroSum:!0,nodeClick:"rootToNode",renderLabelForZeroData:!1,label:{rotate:"radial",show:!0,opacity:1,align:"center",position:"inside",distance:5,silent:!0},itemStyle:{borderWidth:1,borderColor:"white",borderType:"solid",shadowBlur:0,shadowColor:"rgba(0, 0, 0, 0.2)",shadowOffsetX:0,shadowOffsetY:0,opacity:1},emphasis:{focus:"descendant"},blur:{itemStyle:{opacity:.2},label:{opacity:.1}},animationType:"expansion",animationDuration:1e3,animationDurationUpdate:500,data:[],sort:"desc"},t}(Ue);function Mz(e){var t=0;R(e.children,function(n){Mz(n);var i=n.value;at(i)&&(i=i[0]),t+=i});var r=e.value;at(r)&&(r=r[0]),(r==null||isNaN(r))&&(r=t),r<0&&(r=0),at(e.value)?e.value[0]=r:e.value=r}var NL=Math.PI/180;function vJ(e,t,r){t.eachSeriesByType(e,function(n){var i=n.get("center"),a=n.get("radius");at(a)||(a=[0,a]),at(i)||(i=[i,i]);var o=r.getWidth(),s=r.getHeight(),l=Math.min(o,s),u=Tt(i[0],o),h=Tt(i[1],s),f=Tt(a[0],l/2),c=Tt(a[1],l/2),d=-n.get("startAngle")*NL,v=n.get("minAngle")*NL,p=n.getData().tree.root,g=n.getViewRoot(),m=g.depth,_=n.get("sort");_!=null&&Az(g,_);var y=0;R(g.children,function(N){!isNaN(N.getValue())&&y++});var x=g.getValue(),T=Math.PI/(x||y)*2,S=g.depth>0,M=g.height-(S?-1:1),w=(c-f)/(M||1),b=n.get("clockwise"),A=n.get("stillShowZeroSum"),E=b?1:-1,C=function(N,O){if(N){var I=O;if(N!==p){var k=N.getValue(),z=x===0&&A?T:k*T;z<v&&(z=v),I=O+E*z;var X=N.depth-m-(S?-1:1),Y=f+w*X,$=f+w*(X+1),H=n.getLevelModel(N);if(H){var Z=H.get("r0",!0),ct=H.get("r",!0),ut=H.get("radius",!0);ut!=null&&(Z=ut[0],ct=ut[1]),Z!=null&&(Y=Tt(Z,l/2)),ct!=null&&($=Tt(ct,l/2))}N.setLayout({angle:z,startAngle:O,endAngle:I,clockwise:b,cx:u,cy:h,r0:Y,r:$})}if(N.children&&N.children.length){var tt=0;R(N.children,function(et){tt+=C(et,O+tt)})}return I-O}};if(S){var D=f,L=f+w,P=Math.PI*2;p.setLayout({angle:P,startAngle:d,endAngle:d+P,clockwise:b,cx:u,cy:h,r0:D,r:L})}C(g,d)})}function Az(e,t){var r=e.children||[];e.children=pJ(r,t),r.length&&R(e.children,function(n){Az(n,t)})}function pJ(e,t){if(Yt(t)){var r=ft(e,function(i,a){var o=i.getValue();return{params:{depth:i.depth,height:i.height,dataIndex:i.dataIndex,getValue:function(){return o}},index:a}});return r.sort(function(i,a){return t(i.params,a.params)}),ft(r,function(i){return e[i.index]})}else{var n=t==="asc";return e.sort(function(i,a){var o=(i.getValue()-a.getValue())*(n?1:-1);return o===0?(i.dataIndex-a.dataIndex)*(n?-1:1):o})}}function gJ(e){var t={};function r(n,i,a){for(var o=n;o&&o.depth>1;)o=o.parentNode;var s=i.getColorFromPalette(o.name||o.dataIndex+"",t);return n.depth>1&&Ct(s)&&(s=uf(s,(n.depth-1)/(a-1)*.5)),s}e.eachSeriesByType("sunburst",function(n){var i=n.getData(),a=i.tree;a.eachNode(function(o){var s=o.getModel(),l=s.getModel("itemStyle").getItemStyle();l.fill||(l.fill=r(o,n,a.root.height));var u=i.ensureUniqueItemVisual(o.dataIndex,"style");rt(u,l)})})}function mJ(e){e.registerChartView(cJ),e.registerSeriesModel(dJ),e.registerLayout(ue(vJ,"sunburst")),e.registerProcessor(ue(Iv,"sunburst")),e.registerVisual(gJ),fJ(e)}var OL={color:"fill",borderColor:"stroke"},_J={symbol:1,symbolSize:1,symbolKeepAspect:1,legendIcon:1,visualMeta:1,liftZ:1,decal:1},Ao=Le(),yJ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(){this.currentZLevel=this.get("zlevel",!0),this.currentZ=this.get("z",!0)},t.prototype.getInitialData=function(r,n){return Qa(null,this)},t.prototype.getDataParams=function(r,n,i){var a=e.prototype.getDataParams.call(this,r,n);return i&&(a.info=Ao(i).info),a},t.type="series.custom",t.dependencies=["grid","polar","geo","singleAxis","calendar"],t.defaultOption={coordinateSystem:"cartesian2d",z:2,legendHoverLink:!0,clip:!1},t}(Ue);function xJ(e,t){return t=t||[0,0],ft(["x","y"],function(r,n){var i=this.getAxis(r),a=t[n],o=e[n]/2;return i.type==="category"?i.getBandWidth():Math.abs(i.dataToCoord(a-o)-i.dataToCoord(a+o))},this)}function SJ(e){var t=e.master.getRect();return{coordSys:{type:"cartesian2d",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(r){return e.dataToPoint(r)},size:It(xJ,e)}}}function TJ(e,t){return t=t||[0,0],ft([0,1],function(r){var n=t[r],i=e[r]/2,a=[],o=[];return a[r]=n-i,o[r]=n+i,a[1-r]=o[1-r]=t[1-r],Math.abs(this.dataToPoint(a)[r]-this.dataToPoint(o)[r])},this)}function bJ(e){var t=e.getBoundingRect();return{coordSys:{type:"geo",x:t.x,y:t.y,width:t.width,height:t.height,zoom:e.getZoom()},api:{coord:function(r){return e.dataToPoint(r)},size:It(TJ,e)}}}function wJ(e,t){var r=this.getAxis(),n=t instanceof Array?t[0]:t,i=(e instanceof Array?e[0]:e)/2;return r.type==="category"?r.getBandWidth():Math.abs(r.dataToCoord(n-i)-r.dataToCoord(n+i))}function MJ(e){var t=e.getRect();return{coordSys:{type:"singleAxis",x:t.x,y:t.y,width:t.width,height:t.height},api:{coord:function(r){return e.dataToPoint(r)},size:It(wJ,e)}}}function AJ(e,t){return t=t||[0,0],ft(["Radius","Angle"],function(r,n){var i="get"+r+"Axis",a=this[i](),o=t[n],s=e[n]/2,l=a.type==="category"?a.getBandWidth():Math.abs(a.dataToCoord(o-s)-a.dataToCoord(o+s));return r==="Angle"&&(l=l*Math.PI/180),l},this)}function EJ(e){var t=e.getRadiusAxis(),r=e.getAngleAxis(),n=t.getExtent();return n[0]>n[1]&&n.reverse(),{coordSys:{type:"polar",cx:e.cx,cy:e.cy,r:n[1],r0:n[0]},api:{coord:function(i){var a=t.dataToRadius(i[0]),o=r.dataToAngle(i[1]),s=e.coordToPoint([a,o]);return s.push(a,o*Math.PI/180),s},size:It(AJ,e)}}}function CJ(e){var t=e.getRect(),r=e.getRangeInfo();return{coordSys:{type:"calendar",x:t.x,y:t.y,width:t.width,height:t.height,cellWidth:e.getCellWidth(),cellHeight:e.getCellHeight(),rangeInfo:{start:r.start,end:r.end,weeks:r.weeks,dayCount:r.allDay}},api:{coord:function(n,i){return e.dataToPoint(n,i)}}}}function Ez(e,t,r,n){return e&&(e.legacy||e.legacy!==!1&&!r&&!n&&t!=="tspan"&&(t==="text"||Ft(e,"text")))}function Cz(e,t,r){var n=e,i,a,o;if(t==="text")o=n;else{o={},Ft(n,"text")&&(o.text=n.text),Ft(n,"rich")&&(o.rich=n.rich),Ft(n,"textFill")&&(o.fill=n.textFill),Ft(n,"textStroke")&&(o.stroke=n.textStroke),Ft(n,"fontFamily")&&(o.fontFamily=n.fontFamily),Ft(n,"fontSize")&&(o.fontSize=n.fontSize),Ft(n,"fontStyle")&&(o.fontStyle=n.fontStyle),Ft(n,"fontWeight")&&(o.fontWeight=n.fontWeight),a={type:"text",style:o,silent:!0},i={};var s=Ft(n,"textPosition");r?i.position=s?n.textPosition:"inside":s&&(i.position=n.textPosition),Ft(n,"textPosition")&&(i.position=n.textPosition),Ft(n,"textOffset")&&(i.offset=n.textOffset),Ft(n,"textRotation")&&(i.rotation=n.textRotation),Ft(n,"textDistance")&&(i.distance=n.textDistance)}return FL(o,e),R(o.rich,function(l){FL(l,l)}),{textConfig:i,textContent:a}}function FL(e,t){t&&(t.font=t.textFont||t.font,Ft(t,"textStrokeWidth")&&(e.lineWidth=t.textStrokeWidth),Ft(t,"textAlign")&&(e.align=t.textAlign),Ft(t,"textVerticalAlign")&&(e.verticalAlign=t.textVerticalAlign),Ft(t,"textLineHeight")&&(e.lineHeight=t.textLineHeight),Ft(t,"textWidth")&&(e.width=t.textWidth),Ft(t,"textHeight")&&(e.height=t.textHeight),Ft(t,"textBackgroundColor")&&(e.backgroundColor=t.textBackgroundColor),Ft(t,"textPadding")&&(e.padding=t.textPadding),Ft(t,"textBorderColor")&&(e.borderColor=t.textBorderColor),Ft(t,"textBorderWidth")&&(e.borderWidth=t.textBorderWidth),Ft(t,"textBorderRadius")&&(e.borderRadius=t.textBorderRadius),Ft(t,"textBoxShadowColor")&&(e.shadowColor=t.textBoxShadowColor),Ft(t,"textBoxShadowBlur")&&(e.shadowBlur=t.textBoxShadowBlur),Ft(t,"textBoxShadowOffsetX")&&(e.shadowOffsetX=t.textBoxShadowOffsetX),Ft(t,"textBoxShadowOffsetY")&&(e.shadowOffsetY=t.textBoxShadowOffsetY))}function BL(e,t,r){var n=e;n.textPosition=n.textPosition||r.position||"inside",r.offset!=null&&(n.textOffset=r.offset),r.rotation!=null&&(n.textRotation=r.rotation),r.distance!=null&&(n.textDistance=r.distance);var i=n.textPosition.indexOf("inside")>=0,a=e.fill||"#000";UL(n,t);var o=n.textFill==null;return i?o&&(n.textFill=r.insideFill||"#fff",!n.textStroke&&r.insideStroke&&(n.textStroke=r.insideStroke),!n.textStroke&&(n.textStroke=a),n.textStrokeWidth==null&&(n.textStrokeWidth=2)):(o&&(n.textFill=e.fill||r.outsideFill||"#000"),!n.textStroke&&r.outsideStroke&&(n.textStroke=r.outsideStroke)),n.text=t.text,n.rich=t.rich,R(t.rich,function(s){UL(s,s)}),n}function UL(e,t){t&&(Ft(t,"fill")&&(e.textFill=t.fill),Ft(t,"stroke")&&(e.textStroke=t.fill),Ft(t,"lineWidth")&&(e.textStrokeWidth=t.lineWidth),Ft(t,"font")&&(e.font=t.font),Ft(t,"fontStyle")&&(e.fontStyle=t.fontStyle),Ft(t,"fontWeight")&&(e.fontWeight=t.fontWeight),Ft(t,"fontSize")&&(e.fontSize=t.fontSize),Ft(t,"fontFamily")&&(e.fontFamily=t.fontFamily),Ft(t,"align")&&(e.textAlign=t.align),Ft(t,"verticalAlign")&&(e.textVerticalAlign=t.verticalAlign),Ft(t,"lineHeight")&&(e.textLineHeight=t.lineHeight),Ft(t,"width")&&(e.textWidth=t.width),Ft(t,"height")&&(e.textHeight=t.height),Ft(t,"backgroundColor")&&(e.textBackgroundColor=t.backgroundColor),Ft(t,"padding")&&(e.textPadding=t.padding),Ft(t,"borderColor")&&(e.textBorderColor=t.borderColor),Ft(t,"borderWidth")&&(e.textBorderWidth=t.borderWidth),Ft(t,"borderRadius")&&(e.textBorderRadius=t.borderRadius),Ft(t,"shadowColor")&&(e.textBoxShadowColor=t.shadowColor),Ft(t,"shadowBlur")&&(e.textBoxShadowBlur=t.shadowBlur),Ft(t,"shadowOffsetX")&&(e.textBoxShadowOffsetX=t.shadowOffsetX),Ft(t,"shadowOffsetY")&&(e.textBoxShadowOffsetY=t.shadowOffsetY),Ft(t,"textShadowColor")&&(e.textShadowColor=t.textShadowColor),Ft(t,"textShadowBlur")&&(e.textShadowBlur=t.textShadowBlur),Ft(t,"textShadowOffsetX")&&(e.textShadowOffsetX=t.textShadowOffsetX),Ft(t,"textShadowOffsetY")&&(e.textShadowOffsetY=t.textShadowOffsetY))}var Dz={position:["x","y"],scale:["scaleX","scaleY"],origin:["originX","originY"]},zL=be(Dz);ma($a,function(e,t){return e[t]=1,e},{});$a.join(", ");var Zm=["","style","shape","extra"],mf=Le();function DM(e,t,r,n,i){var a=e+"Animation",o=kf(e,n,i)||{},s=mf(t).userDuring;return o.duration>0&&(o.during=s?It(IJ,{el:t,userDuring:s}):null,o.setToFinal=!0,o.scope=e),rt(o,r[a]),o}function Jg(e,t,r,n){n=n||{};var i=n.dataIndex,a=n.isInit,o=n.clearStyle,s=r.isAnimationEnabled(),l=mf(e),u=t.style;l.userDuring=t.during;var h={},f={};if(OJ(e,t,f),GL("shape",t,f),GL("extra",t,f),!a&&s&&(NJ(e,t,h),kL("shape",e,t,h),kL("extra",e,t,h),FJ(e,t,u,h)),f.style=u,DJ(e,f,o),RJ(e,t),s)if(a){var c={};R(Zm,function(v){var p=v?t[v]:t;p&&p.enterFrom&&(v&&(c[v]=c[v]||{}),rt(v?c[v]:c,p.enterFrom))});var d=DM("enter",e,t,r,i);d.duration>0&&e.animateFrom(c,d)}else LJ(e,t,i||0,r,h);Lz(e,t),u?e.dirty():e.markRedraw()}function Lz(e,t){for(var r=mf(e).leaveToProps,n=0;n<Zm.length;n++){var i=Zm[n],a=i?t[i]:t;a&&a.leaveTo&&(r||(r=mf(e).leaveToProps={}),i&&(r[i]=r[i]||{}),rt(i?r[i]:r,a.leaveTo))}}function o0(e,t,r,n){if(e){var i=e.parent,a=mf(e).leaveToProps;if(a){var o=DM("update",e,t,r,0);o.done=function(){i.remove(e)},e.animateTo(a,o)}else i.remove(e)}}function gu(e){return e==="all"}function DJ(e,t,r){var n=t.style;if(!e.isGroup&&n){if(r){e.useStyle({});for(var i=e.animators,a=0;a<i.length;a++){var o=i[a];o.targetName==="style"&&o.changeTarget(e.style)}}e.setStyle(n)}t.style=null,e.attr(t),t.style=n}function LJ(e,t,r,n,i){{var a=DM("update",e,t,n,r);a.duration>0&&e.animateFrom(i,a)}}function RJ(e,t){Ft(t,"silent")&&(e.silent=t.silent),Ft(t,"ignore")&&(e.ignore=t.ignore),e instanceof Yi&&Ft(t,"invisible")&&(e.invisible=t.invisible),e instanceof _e&&Ft(t,"autoBatch")&&(e.autoBatch=t.autoBatch)}var Ea={},PJ={setTransform:function(e,t){return Ea.el[e]=t,this},getTransform:function(e){return Ea.el[e]},setShape:function(e,t){var r=Ea.el,n=r.shape||(r.shape={});return n[e]=t,r.dirtyShape&&r.dirtyShape(),this},getShape:function(e){var t=Ea.el.shape;if(t)return t[e]},setStyle:function(e,t){var r=Ea.el,n=r.style;return n&&(n[e]=t,r.dirtyStyle&&r.dirtyStyle()),this},getStyle:function(e){var t=Ea.el.style;if(t)return t[e]},setExtra:function(e,t){var r=Ea.el.extra||(Ea.el.extra={});return r[e]=t,this},getExtra:function(e){var t=Ea.el.extra;if(t)return t[e]}};function IJ(){var e=this,t=e.el;if(t){var r=mf(t).userDuring,n=e.userDuring;if(r!==n){e.el=e.userDuring=null;return}Ea.el=t,n(PJ)}}function kL(e,t,r,n){var i=r[e];if(i){var a=t[e],o;if(a){var s=r.transition,l=i.transition;if(l)if(!o&&(o=n[e]={}),gu(l))rt(o,a);else for(var u=er(l),h=0;h<u.length;h++){var f=u[h],c=a[f];o[f]=c}else if(gu(s)||pe(s,e)>=0){!o&&(o=n[e]={});for(var d=be(a),h=0;h<d.length;h++){var f=d[h],c=a[f];BJ(i[f],c)&&(o[f]=c)}}}}}function GL(e,t,r){var n=t[e];if(n)for(var i=r[e]={},a=be(n),o=0;o<a.length;o++){var s=a[o];i[s]=_d(n[s])}}function NJ(e,t,r){for(var n=t.transition,i=gu(n)?$a:er(n||[]),a=0;a<i.length;a++){var o=i[a];if(!(o==="style"||o==="shape"||o==="extra")){var s=e[o];r[o]=s}}}function OJ(e,t,r){for(var n=0;n<zL.length;n++){var i=zL[n],a=Dz[i],o=t[i];o&&(r[a[0]]=o[0],r[a[1]]=o[1])}for(var n=0;n<$a.length;n++){var s=$a[n];t[s]!=null&&(r[s]=t[s])}}function FJ(e,t,r,n){if(r){var i=e.style,a;if(i){var o=r.transition,s=t.transition;if(o&&!gu(o)){var l=er(o);!a&&(a=n.style={});for(var u=0;u<l.length;u++){var h=l[u],f=i[h];a[h]=f}}else if(e.getAnimationStyleProps&&(gu(s)||gu(o)||pe(s,"style")>=0)){var c=e.getAnimationStyleProps(),d=c?c.style:null;if(d){!a&&(a=n.style={});for(var v=be(r),u=0;u<v.length;u++){var h=v[u];if(d[h]){var f=i[h];a[h]=f}}}}}}}function BJ(e,t){return Dn(e)?e!==t:e!=null&&isFinite(e)}var Rz=Le(),UJ=["percent","easing","shape","style","extra"];function Pz(e){e.stopAnimation("keyframe"),e.attr(Rz(e))}function qm(e,t,r){if(!(!r.isAnimationEnabled()||!t)){if(at(t)){R(t,function(s){qm(e,s,r)});return}var n=t.keyframes,i=t.duration;if(r&&i==null){var a=kf("enter",r,0);i=a&&a.duration}if(!(!n||!i)){var o=Rz(e);R(Zm,function(s){if(!(s&&!e[s])){var l;n.sort(function(u,h){return u.percent-h.percent}),R(n,function(u){var h=e.animators,f=s?u[s]:u;if(f){var c=be(f);if(s||(c=Xe(c,function(p){return pe(UJ,p)<0})),!!c.length){l||(l=e.animate(s,t.loop,!0),l.scope="keyframe");for(var d=0;d<h.length;d++)h[d]!==l&&h[d].targetName===l.targetName&&h[d].stopTracks(c);s&&(o[s]=o[s]||{});var v=s?o[s]:o;R(c,function(p){v[p]=((s?e[s]:e)||{})[p]}),l.whenWithKeys(i*u.percent,f,c,u.easing)}}}),l&&l.delay(t.delay||0).duration(i).start(t.easing)}})}}}var Eo="emphasis",bs="normal",LM="blur",RM="select",zs=[bs,Eo,LM,RM],Tx={normal:["itemStyle"],emphasis:[Eo,"itemStyle"],blur:[LM,"itemStyle"],select:[RM,"itemStyle"]},bx={normal:["label"],emphasis:[Eo,"label"],blur:[LM,"label"],select:[RM,"label"]},zJ=["x","y"],kJ="e\0\0",wi={normal:{},emphasis:{},blur:{},select:{}},GJ={cartesian2d:SJ,geo:bJ,single:MJ,polar:EJ,calendar:CJ};function ST(e){return e instanceof _e}function TT(e){return e instanceof Yi}function VJ(e,t){t.copyTransform(e),TT(t)&&TT(e)&&(t.setStyle(e.style),t.z=e.z,t.z2=e.z2,t.zlevel=e.zlevel,t.invisible=e.invisible,t.ignore=e.ignore,ST(t)&&ST(e)&&t.setShape(e.shape))}var HJ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i,a){this._progressiveEls=null;var o=this._data,s=r.getData(),l=this.group,u=VL(r,s,n,i);o||l.removeAll(),s.diff(o).add(function(f){Mx(i,null,f,u(f,a),r,l,s)}).remove(function(f){var c=o.getItemGraphicEl(f);c&&o0(c,Ao(c).option,r)}).update(function(f,c){var d=o.getItemGraphicEl(c);Mx(i,d,f,u(f,a),r,l,s)}).execute();var h=r.get("clip",!0)?Rv(r.coordinateSystem,!1,r):null;h?l.setClipPath(h):l.removeClipPath(),this._data=s},t.prototype.incrementalPrepareRender=function(r,n,i){this.group.removeAll(),this._data=null},t.prototype.incrementalRender=function(r,n,i,a,o){var s=n.getData(),l=VL(n,s,i,a),u=this._progressiveEls=[];function h(d){d.isGroup||(d.incremental=!0,d.ensureState("emphasis").hoverLayer=!0)}for(var f=r.start;f<r.end;f++){var c=Mx(null,null,f,l(f,o),n,this.group,s);c&&(c.traverse(h),u.push(c))}},t.prototype.eachRendered=function(r){Hs(this._progressiveEls||this.group,r)},t.prototype.filterForExposedEvent=function(r,n,i,a){var o=n.element;if(o==null||i.name===o)return!0;for(;(i=i.__hostTarget||i.parent)&&i!==this.group;)if(i.name===o)return!0;return!1},t.type="custom",t}(De);function PM(e){var t=e.type,r;if(t==="path"){var n=e.shape,i=n.width!=null&&n.height!=null?{x:n.x||0,y:n.y||0,width:n.width,height:n.height}:null,a=Oz(n);r=F_(a,null,i,n.layout||"center"),Ao(r).customPathData=a}else if(t==="image")r=new hn({}),Ao(r).customImagePath=e.style.image;else if(t==="text")r=new we({});else if(t==="group")r=new re;else{if(t==="compoundPath")throw new Error('"compoundPath" is not supported yet.');var o=dw(t);if(!o){var s="";We(s)}r=new o}return Ao(r).customGraphicType=t,r.name=e.name,r.z2EmphasisLift=1,r.z2SelectLift=1,r}function IM(e,t,r,n,i,a,o){Pz(t);var s=i&&i.normal.cfg;s&&t.setTextConfig(s),n&&n.transition==null&&(n.transition=zJ);var l=n&&n.style;if(l){if(t.type==="text"){var u=l;Ft(u,"textFill")&&(u.fill=u.textFill),Ft(u,"textStroke")&&(u.stroke=u.textStroke)}var h=void 0,f=ST(t)?l.decal:null;e&&f&&(f.dirty=!0,h=df(f,e)),l.__decalPattern=h}if(TT(t)&&l){var h=l.__decalPattern;h&&(l.decal=h)}Jg(t,n,a,{dataIndex:r,isInit:o,clearStyle:!0}),qm(t,n.keyframeAnimation,a)}function Iz(e,t,r,n,i){var a=t.isGroup?null:t,o=i&&i[e].cfg;if(a){var s=a.ensureState(e);if(n===!1){var l=a.getState(e);l&&(l.style=null)}else s.style=n||null;o&&(s.textConfig=o),wu(a)}}function WJ(e,t,r){if(!e.isGroup){var n=e,i=r.currentZ,a=r.currentZLevel;n.z=i,n.zlevel=a;var o=t.z2;o!=null&&(n.z2=o||0);for(var s=0;s<zs.length;s++)XJ(n,t,zs[s])}}function XJ(e,t,r){var n=r===bs,i=n?t:$m(t,r),a=i?i.z2:null,o;a!=null&&(o=n?e:e.ensureState(r),o.z2=a||0)}function VL(e,t,r,n){var i=e.get("renderItem"),a=e.coordinateSystem,o={};a&&(o=a.prepareCustoms?a.prepareCustoms(a):GJ[a.type](a));for(var s=Vt({getWidth:n.getWidth,getHeight:n.getHeight,getZr:n.getZr,getDevicePixelRatio:n.getDevicePixelRatio,value:x,style:S,ordinalRawValue:T,styleEmphasis:M,visual:A,barLayout:E,currentSeriesIndices:C,font:D},o.api||{}),l={context:{},seriesId:e.id,seriesName:e.name,seriesIndex:e.seriesIndex,coordSys:o.coordSys,dataInsideLength:t.count(),encode:YJ(e.getData())},u,h,f={},c={},d={},v={},p=0;p<zs.length;p++){var g=zs[p];d[g]=e.getModel(Tx[g]),v[g]=e.getModel(bx[g])}function m(L){return L===u?h||(h=t.getItemModel(L)):t.getItemModel(L)}function _(L,P){return t.hasItemOption?L===u?f[P]||(f[P]=m(L).getModel(Tx[P])):m(L).getModel(Tx[P]):d[P]}function y(L,P){return t.hasItemOption?L===u?c[P]||(c[P]=m(L).getModel(bx[P])):m(L).getModel(bx[P]):v[P]}return function(L,P){return u=L,h=null,f={},c={},i&&i(Vt({dataIndexInside:L,dataIndex:t.getRawIndex(L),actionType:P?P.type:null},l),s)};function x(L,P){return P==null&&(P=u),t.getStore().get(t.getDimensionIndex(L||0),P)}function T(L,P){P==null&&(P=u),L=L||0;var N=t.getDimensionInfo(L);if(!N){var O=t.getDimensionIndex(L);return O>=0?t.getStore().get(O,P):void 0}var I=t.get(N.name,P),k=N&&N.ordinalMeta;return k?k.categories[I]:I}function S(L,P){P==null&&(P=u);var N=t.getItemVisual(P,"style"),O=N&&N.fill,I=N&&N.opacity,k=_(P,bs).getItemStyle();O!=null&&(k.fill=O),I!=null&&(k.opacity=I);var z={inheritColor:Ct(O)?O:"#000"},X=y(P,bs),Y=je(X,null,z,!1,!0);Y.text=X.getShallow("show")?se(e.getFormattedLabel(P,bs),vf(t,P)):null;var $=bm(X,z,!1);return b(L,k),k=BL(k,Y,$),L&&w(k,L),k.legacy=!0,k}function M(L,P){P==null&&(P=u);var N=_(P,Eo).getItemStyle(),O=y(P,Eo),I=je(O,null,null,!0,!0);I.text=O.getShallow("show")?Ga(e.getFormattedLabel(P,Eo),e.getFormattedLabel(P,bs),vf(t,P)):null;var k=bm(O,null,!0);return b(L,N),N=BL(N,I,k),L&&w(N,L),N.legacy=!0,N}function w(L,P){for(var N in P)Ft(P,N)&&(L[N]=P[N])}function b(L,P){L&&(L.textFill&&(P.textFill=L.textFill),L.textPosition&&(P.textPosition=L.textPosition))}function A(L,P){if(P==null&&(P=u),Ft(OL,L)){var N=t.getItemVisual(P,"style");return N?N[OL[L]]:null}if(Ft(_J,L))return t.getItemVisual(P,L)}function E(L){if(a.type==="cartesian2d"){var P=a.getBaseAxis();return zX(Vt({axis:P},L))}}function C(){return r.getCurrentSeriesIndices()}function D(L){return vw(L,r)}}function YJ(e){var t={};return R(e.dimensions,function(r){var n=e.getDimensionInfo(r);if(!n.isExtraCoord){var i=n.coordDim,a=t[i]=t[i]||[];a[n.coordDimIndex]=e.getDimensionIndex(r)}}),t}function Mx(e,t,r,n,i,a,o){if(!n){a.remove(t);return}var s=NM(e,t,r,n,i,a);return s&&o.setItemGraphicEl(r,s),s&&Sr(s,n.focus,n.blurScope,n.emphasisDisabled),s}function NM(e,t,r,n,i,a){var o=-1,s=t;t&&Nz(t,n,i)&&(o=pe(a.childrenRef(),t),t=null);var l=!t,u=t;u?u.clearStates():(u=PM(n),s&&VJ(s,u)),n.morph===!1?u.disableMorphing=!0:u.disableMorphing&&(u.disableMorphing=!1),wi.normal.cfg=wi.normal.conOpt=wi.emphasis.cfg=wi.emphasis.conOpt=wi.blur.cfg=wi.blur.conOpt=wi.select.cfg=wi.select.conOpt=null,wi.isLegacy=!1,qJ(u,r,n,i,l,wi),ZJ(u,r,n,i,l),IM(e,u,r,n,wi,i,l),Ft(n,"info")&&(Ao(u).info=n.info);for(var h=0;h<zs.length;h++){var f=zs[h];if(f!==bs){var c=$m(n,f),d=OM(n,c,f);Iz(f,u,c,d,wi)}}return WJ(u,n,i),n.type==="group"&&$J(e,u,r,n,i),o>=0?a.replaceAt(u,o):a.add(u),u}function Nz(e,t,r){var n=Ao(e),i=t.type,a=t.shape,o=t.style;return r.isUniversalTransitionEnabled()||i!=null&&i!==n.customGraphicType||i==="path"&&QJ(a)&&Oz(a)!==n.customPathData||i==="image"&&Ft(o,"image")&&o.image!==n.customImagePath}function ZJ(e,t,r,n,i){var a=r.clipPath;if(a===!1)e&&e.getClipPath()&&e.removeClipPath();else if(a){var o=e.getClipPath();o&&Nz(o,a,n)&&(o=null),o||(o=PM(a),e.setClipPath(o)),IM(null,o,t,a,null,n,i)}}function qJ(e,t,r,n,i,a){if(!e.isGroup){HL(r,null,a),HL(r,Eo,a);var o=a.normal.conOpt,s=a.emphasis.conOpt,l=a.blur.conOpt,u=a.select.conOpt;if(o!=null||s!=null||u!=null||l!=null){var h=e.getTextContent();if(o===!1)h&&e.removeTextContent();else{o=a.normal.conOpt=o||{type:"text"},h?h.clearStates():(h=PM(o),e.setTextContent(h)),IM(null,h,t,o,null,n,i);for(var f=o&&o.style,c=0;c<zs.length;c++){var d=zs[c];if(d!==bs){var v=a[d].conOpt;Iz(d,h,v,OM(o,v,d),null)}}f?h.dirty():h.markRedraw()}}}}function HL(e,t,r){var n=t?$m(e,t):e,i=t?OM(e,n,Eo):e.style,a=e.type,o=n?n.textConfig:null,s=e.textContent,l=s?t?$m(s,t):s:null;if(i&&(r.isLegacy||Ez(i,a,!!o,!!l))){r.isLegacy=!0;var u=Cz(i,a,!t);!o&&u.textConfig&&(o=u.textConfig),!l&&u.textContent&&(l=u.textContent)}if(!t&&l){var h=l;!h.type&&(h.type="text")}var f=t?r[t]:r.normal;f.cfg=o,f.conOpt=l}function $m(e,t){return t?e?e[t]:null:e}function OM(e,t,r){var n=t&&t.style;return n==null&&r===Eo&&e&&(n=e.styleEmphasis),n}function $J(e,t,r,n,i){var a=n.children,o=a?a.length:0,s=n.$mergeChildren,l=s==="byName"||n.diffChildrenByName,u=s===!1;if(!(!o&&!l&&!u)){if(l){jJ({api:e,oldChildren:t.children()||[],newChildren:a||[],dataIndex:r,seriesModel:i,group:t});return}u&&t.removeAll();for(var h=0;h<o;h++){var f=a[h],c=t.childAt(h);f?(f.ignore==null&&(f.ignore=!1),NM(e,c,r,f,i,t)):c.ignore=!0}for(var d=t.childCount()-1;d>=h;d--){var v=t.childAt(d);KJ(t,v,i)}}}function KJ(e,t,r){t&&o0(t,Ao(e).option,r)}function jJ(e){new No(e.oldChildren,e.newChildren,WL,WL,e).add(XL).update(XL).remove(JJ).execute()}function WL(e,t){var r=e&&e.name;return r??kJ+t}function XL(e,t){var r=this.context,n=e!=null?r.newChildren[e]:null,i=t!=null?r.oldChildren[t]:null;NM(r.api,i,r.dataIndex,n,r.seriesModel,r.group)}function JJ(e){var t=this.context,r=t.oldChildren[e];r&&o0(r,Ao(r).option,t.seriesModel)}function Oz(e){return e&&(e.pathData||e.d)}function QJ(e){return e&&(Ft(e,"pathData")||Ft(e,"d"))}function tQ(e){e.registerChartView(HJ),e.registerSeriesModel(yJ)}var Xl=Le(),YL=Qt,Ax=It,FM=function(){function e(){this._dragging=!1,this.animationThreshold=15}return e.prototype.render=function(t,r,n,i){var a=r.get("value"),o=r.get("status");if(this._axisModel=t,this._axisPointerModel=r,this._api=n,!(!i&&this._lastValue===a&&this._lastStatus===o)){this._lastValue=a,this._lastStatus=o;var s=this._group,l=this._handle;if(!o||o==="hide"){s&&s.hide(),l&&l.hide();return}s&&s.show(),l&&l.show();var u={};this.makeElOption(u,a,t,r,n);var h=u.graphicKey;h!==this._lastGraphicKey&&this.clear(n),this._lastGraphicKey=h;var f=this._moveAnimation=this.determineAnimation(t,r);if(!s)s=this._group=new re,this.createPointerEl(s,u,t,r),this.createLabelEl(s,u,t,r),n.getZr().add(s);else{var c=ue(ZL,r,f);this.updatePointerEl(s,u,c),this.updateLabelEl(s,u,c,r)}$L(s,r,!0),this._renderHandle(a)}},e.prototype.remove=function(t){this.clear(t)},e.prototype.dispose=function(t){this.clear(t)},e.prototype.determineAnimation=function(t,r){var n=r.get("animation"),i=t.axis,a=i.type==="category",o=r.get("snap");if(!o&&!a)return!1;if(n==="auto"||n==null){var s=this.animationThreshold;if(a&&i.getBandWidth()>s)return!0;if(o){var l=nM(t).seriesDataCount,u=i.getExtent();return Math.abs(u[0]-u[1])/l>s}return!1}return n===!0},e.prototype.makeElOption=function(t,r,n,i,a){},e.prototype.createPointerEl=function(t,r,n,i){var a=r.pointer;if(a){var o=Xl(t).pointerEl=new zu[a.type](YL(r.pointer));t.add(o)}},e.prototype.createLabelEl=function(t,r,n,i){if(r.label){var a=Xl(t).labelEl=new we(YL(r.label));t.add(a),qL(a,i)}},e.prototype.updatePointerEl=function(t,r,n){var i=Xl(t).pointerEl;i&&r.pointer&&(i.setStyle(r.pointer.style),n(i,{shape:r.pointer.shape}))},e.prototype.updateLabelEl=function(t,r,n,i){var a=Xl(t).labelEl;a&&(a.setStyle(r.label.style),n(a,{x:r.label.x,y:r.label.y}),qL(a,i))},e.prototype._renderHandle=function(t){if(!(this._dragging||!this.updateHandleTransform)){var r=this._axisPointerModel,n=this._api.getZr(),i=this._handle,a=r.getModel("handle"),o=r.get("status");if(!a.get("show")||!o||o==="hide"){i&&n.remove(i),this._handle=null;return}var s;this._handle||(s=!0,i=this._handle=Mv(a.get("icon"),{cursor:"move",draggable:!0,onmousemove:function(u){Lo(u.event)},onmousedown:Ax(this._onHandleDragMove,this,0,0),drift:Ax(this._onHandleDragMove,this),ondragend:Ax(this._onHandleDragEnd,this)}),n.add(i)),$L(i,r,!1),i.setStyle(a.getItemStyle(null,["color","borderColor","borderWidth","opacity","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"]));var l=a.get("size");at(l)||(l=[l,l]),i.scaleX=l[0]/2,i.scaleY=l[1]/2,qf(this,"_doDispatchAxisPointer",a.get("throttle")||0,"fixRate"),this._moveHandleToValue(t,s)}},e.prototype._moveHandleToValue=function(t,r){ZL(this._axisPointerModel,!r&&this._moveAnimation,this._handle,Ex(this.getHandleTransform(t,this._axisModel,this._axisPointerModel)))},e.prototype._onHandleDragMove=function(t,r){var n=this._handle;if(n){this._dragging=!0;var i=this.updateHandleTransform(Ex(n),[t,r],this._axisModel,this._axisPointerModel);this._payloadInfo=i,n.stopAnimation(),n.attr(Ex(i)),Xl(n).lastProp=null,this._doDispatchAxisPointer()}},e.prototype._doDispatchAxisPointer=function(){var t=this._handle;if(t){var r=this._payloadInfo,n=this._axisModel;this._api.dispatchAction({type:"updateAxisPointer",x:r.cursorPoint[0],y:r.cursorPoint[1],tooltipOption:r.tooltipOption,axesInfo:[{axisDim:n.axis.dim,axisIndex:n.componentIndex}]})}},e.prototype._onHandleDragEnd=function(){this._dragging=!1;var t=this._handle;if(t){var r=this._axisPointerModel.get("value");this._moveHandleToValue(r),this._api.dispatchAction({type:"hideTip"})}},e.prototype.clear=function(t){this._lastValue=null,this._lastStatus=null;var r=t.getZr(),n=this._group,i=this._handle;r&&n&&(this._lastGraphicKey=null,n&&r.remove(n),i&&r.remove(i),this._group=null,this._handle=null,this._payloadInfo=null),Xd(this,"_doDispatchAxisPointer")},e.prototype.doClear=function(){},e.prototype.buildLabel=function(t,r,n){return n=n||0,{x:t[n],y:t[1-n],width:r[n],height:r[1-n]}},e}();function ZL(e,t,r,n){Fz(Xl(r).lastProp,n)||(Xl(r).lastProp=n,t?ke(r,n,e):(r.stopAnimation(),r.attr(n)))}function Fz(e,t){if(Kt(e)&&Kt(t)){var r=!0;return R(t,function(n,i){r=r&&Fz(e[i],n)}),!!r}else return e===t}function qL(e,t){e[t.get(["label","show"])?"show":"hide"]()}function Ex(e){return{x:e.x||0,y:e.y||0,rotation:e.rotation||0}}function $L(e,t,r){var n=t.get("z"),i=t.get("zlevel");e&&e.traverse(function(a){a.type!=="group"&&(n!=null&&(a.z=n),i!=null&&(a.zlevel=i),a.silent=r)})}function BM(e){var t=e.get("type"),r=e.getModel(t+"Style"),n;return t==="line"?(n=r.getLineStyle(),n.fill=null):t==="shadow"&&(n=r.getAreaStyle(),n.stroke=null),n}function Bz(e,t,r,n,i){var a=r.get("value"),o=Uz(a,t.axis,t.ecModel,r.get("seriesDataIndices"),{precision:r.get(["label","precision"]),formatter:r.get(["label","formatter"])}),s=r.getModel("label"),l=Hf(s.get("padding")||0),u=s.getFont(),h=_v(o,u),f=i.position,c=h.width+l[1]+l[3],d=h.height+l[0]+l[2],v=i.align;v==="right"&&(f[0]-=c),v==="center"&&(f[0]-=c/2);var p=i.verticalAlign;p==="bottom"&&(f[1]-=d),p==="middle"&&(f[1]-=d/2),eQ(f,c,d,n);var g=s.get("backgroundColor");(!g||g==="auto")&&(g=t.get(["axisLine","lineStyle","color"])),e.label={x:f[0],y:f[1],style:je(s,{text:o,font:u,fill:s.getTextColor(),padding:l,backgroundColor:g}),z2:10}}function eQ(e,t,r,n){var i=n.getWidth(),a=n.getHeight();e[0]=Math.min(e[0]+t,i)-t,e[1]=Math.min(e[1]+r,a)-r,e[0]=Math.max(e[0],0),e[1]=Math.max(e[1],0)}function Uz(e,t,r,n,i){e=t.scale.parse(e);var a=t.scale.getLabel({value:e},{precision:i.precision}),o=i.formatter;if(o){var s={value:Hw(t,{value:e}),axisDimension:t.dim,axisIndex:t.index,seriesData:[]};R(n,function(l){var u=r.getSeriesByIndex(l.seriesIndex),h=l.dataIndexInside,f=u&&u.getDataParams(h);f&&s.seriesData.push(f)}),Ct(o)?a=o.replace("{value}",a):Yt(o)&&(a=o(s))}return a}function UM(e,t,r){var n=oi();return Fu(n,n,r.rotation),qa(n,n,r.position),va([e.dataToCoord(t),(r.labelOffset||0)+(r.labelDirection||1)*(r.labelMargin||0)],n)}function zz(e,t,r,n,i,a){var o=Gn.innerTextLayout(r.rotation,0,r.labelDirection);r.labelMargin=i.get(["label","margin"]),Bz(t,n,i,a,{position:UM(n.axis,e,r),align:o.textAlign,verticalAlign:o.textVerticalAlign})}function zM(e,t,r){return r=r||0,{x1:e[r],y1:e[1-r],x2:t[r],y2:t[1-r]}}function kz(e,t,r){return r=r||0,{x:e[r],y:e[1-r],width:t[r],height:t[1-r]}}function KL(e,t,r,n,i,a){return{cx:e,cy:t,r0:r,r:n,startAngle:i,endAngle:a,clockwise:!0}}var rQ=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,n,i,a,o){var s=i.axis,l=s.grid,u=a.get("type"),h=jL(l,s).getOtherAxis(s).getGlobalExtent(),f=s.toGlobalCoord(s.dataToCoord(n,!0));if(u&&u!=="none"){var c=BM(a),d=nQ[u](s,f,h);d.style=c,r.graphicKey=d.type,r.pointer=d}var v=rT(l.model,i);zz(n,r,v,i,a,o)},t.prototype.getHandleTransform=function(r,n,i){var a=rT(n.axis.grid.model,n,{labelInside:!1});a.labelMargin=i.get(["handle","margin"]);var o=UM(n.axis,r,a);return{x:o[0],y:o[1],rotation:a.rotation+(a.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(r,n,i,a){var o=i.axis,s=o.grid,l=o.getGlobalExtent(!0),u=jL(s,o).getOtherAxis(o).getGlobalExtent(),h=o.dim==="x"?0:1,f=[r.x,r.y];f[h]+=n[h],f[h]=Math.min(l[1],f[h]),f[h]=Math.max(l[0],f[h]);var c=(u[1]+u[0])/2,d=[c,c];d[h]=f[h];var v=[{verticalAlign:"middle"},{align:"center"}];return{x:f[0],y:f[1],rotation:r.rotation,cursorPoint:d,tooltipOption:v[h]}},t}(FM);function jL(e,t){var r={};return r[t.dim+"AxisIndex"]=t.index,e.getCartesian(r)}var nQ={line:function(e,t,r){var n=zM([t,r[0]],[t,r[1]],JL(e));return{type:"Line",subPixelOptimize:!0,shape:n}},shadow:function(e,t,r){var n=Math.max(1,e.getBandWidth()),i=r[1]-r[0];return{type:"Rect",shape:kz([t-n/2,r[0]],[n,i],JL(e))}}};function JL(e){return e.dim==="x"?0:1}var iQ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="axisPointer",t.defaultOption={show:"auto",z:50,type:"line",snap:!1,triggerTooltip:!0,triggerEmphasis:!0,value:null,status:null,link:[],animation:null,animationDurationUpdate:200,lineStyle:{color:"#B9BEC9",width:1,type:"dashed"},shadowStyle:{color:"rgba(210,219,238,0.2)"},label:{show:!0,formatter:null,precision:"auto",margin:3,color:"#fff",padding:[5,7,5,7],backgroundColor:"auto",borderColor:null,borderWidth:0,borderRadius:3},handle:{show:!1,icon:"M10.7,11.9v-1.3H9.3v1.3c-4.9,0.3-8.8,4.4-8.8,9.4c0,5,3.9,9.1,8.8,9.4h1.3c4.9-0.3,8.8-4.4,8.8-9.4C19.5,16.3,15.6,12.2,10.7,11.9z M13.3,24.4H6.7v-1.2h6.6z M13.3,22H6.7v-1.2h6.6z M13.3,19.6H6.7v-1.2h6.6z",size:45,margin:50,color:"#333",shadowBlur:3,shadowColor:"#aaa",shadowOffsetX:0,shadowOffsetY:2,throttle:40}},t}(me),xo=Le(),aQ=R;function Gz(e,t,r){if(!ye.node){var n=t.getZr();xo(n).records||(xo(n).records={}),oQ(n,t);var i=xo(n).records[e]||(xo(n).records[e]={});i.handler=r}}function oQ(e,t){if(xo(e).initialized)return;xo(e).initialized=!0,r("click",ue(QL,"click")),r("mousemove",ue(QL,"mousemove")),r("globalout",lQ);function r(n,i){e.on(n,function(a){var o=uQ(t);aQ(xo(e).records,function(s){s&&i(s,a,o.dispatchAction)}),sQ(o.pendings,t)})}}function sQ(e,t){var r=e.showTip.length,n=e.hideTip.length,i;r?i=e.showTip[r-1]:n&&(i=e.hideTip[n-1]),i&&(i.dispatchAction=null,t.dispatchAction(i))}function lQ(e,t,r){e.handler("leave",null,r)}function QL(e,t,r,n){t.handler(e,r,n)}function uQ(e){var t={showTip:[],hideTip:[]},r=function(n){var i=t[n.type];i?i.push(n):(n.dispatchAction=r,e.dispatchAction(n))};return{dispatchAction:r,pendings:t}}function bT(e,t){if(!ye.node){var r=t.getZr(),n=(xo(r).records||{})[e];n&&(xo(r).records[e]=null)}}var hQ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=n.getComponent("tooltip"),o=r.get("triggerOn")||a&&a.get("triggerOn")||"mousemove|click";Gz("axisPointer",i,function(s,l,u){o!=="none"&&(s==="leave"||o.indexOf(s)>=0)&&u({type:"updateAxisPointer",currTrigger:s,x:l&&l.offsetX,y:l&&l.offsetY})})},t.prototype.remove=function(r,n){bT("axisPointer",n)},t.prototype.dispose=function(r,n){bT("axisPointer",n)},t.type="axisPointer",t}(nr);function Vz(e,t){var r=[],n=e.seriesIndex,i;if(n==null||!(i=t.getSeriesByIndex(n)))return{point:[]};var a=i.getData(),o=Tu(a,e);if(o==null||o<0||at(o))return{point:[]};var s=a.getItemGraphicEl(o),l=i.coordinateSystem;if(i.getTooltipPosition)r=i.getTooltipPosition(o)||[];else if(l&&l.dataToPoint)if(e.isStacked){var u=l.getBaseAxis(),h=l.getOtherAxis(u),f=h.dim,c=u.dim,d=f==="x"||f==="radius"?1:0,v=a.mapDimension(c),p=[];p[d]=a.get(v,o),p[1-d]=a.get(a.getCalculationInfo("stackResultDimension"),o),r=l.dataToPoint(p)||[]}else r=l.dataToPoint(a.getValues(ft(l.dimensions,function(m){return a.mapDimension(m)}),o))||[];else if(s){var g=s.getBoundingRect().clone();g.applyTransform(s.transform),r=[g.x+g.width/2,g.y+g.height/2]}return{point:r,el:s}}var tR=Le();function fQ(e,t,r){var n=e.currTrigger,i=[e.x,e.y],a=e,o=e.dispatchAction||It(r.dispatchAction,r),s=t.getComponent("axisPointer").coordSysAxesInfo;if(s){Qg(i)&&(i=Vz({seriesIndex:a.seriesIndex,dataIndex:a.dataIndex},t).point);var l=Qg(i),u=a.axesInfo,h=s.axesInfo,f=n==="leave"||Qg(i),c={},d={},v={list:[],map:{}},p={showPointer:ue(dQ,d),showTooltip:ue(vQ,v)};R(s.coordSysMap,function(m,_){var y=l||m.containPoint(i);R(s.coordSysAxesInfo[_],function(x,T){var S=x.axis,M=_Q(u,x);if(!f&&y&&(!u||M)){var w=M&&M.value;w==null&&!l&&(w=S.pointToData(i)),w!=null&&eR(x,w,p,!1,c)}})});var g={};return R(h,function(m,_){var y=m.linkGroup;y&&!d[_]&&R(y.axesInfo,function(x,T){var S=d[T];if(x!==m&&S){var M=S.value;y.mapper&&(M=m.axis.scale.parse(y.mapper(M,rR(x),rR(m)))),g[m.key]=M}})}),R(g,function(m,_){eR(h[_],m,p,!0,c)}),pQ(d,h,c),gQ(v,i,e,o),mQ(h,o,r),c}}function eR(e,t,r,n,i){var a=e.axis;if(!(a.scale.isBlank()||!a.containData(t))){if(!e.involveSeries){r.showPointer(e,t);return}var o=cQ(t,e),s=o.payloadBatch,l=o.snapToValue;s[0]&&i.seriesIndex==null&&rt(i,s[0]),!n&&e.snap&&a.containData(l)&&l!=null&&(t=l),r.showPointer(e,t,s),r.showTooltip(e,o,l)}}function cQ(e,t){var r=t.axis,n=r.dim,i=e,a=[],o=Number.MAX_VALUE,s=-1;return R(t.seriesModels,function(l,u){var h=l.getData().mapDimensionsAll(n),f,c;if(l.getAxisTooltipData){var d=l.getAxisTooltipData(h,e,r);c=d.dataIndices,f=d.nestestValue}else{if(c=l.getData().indicesOfNearest(h[0],e,r.type==="category"?.5:null),!c.length)return;f=l.getData().get(h[0],c[0])}if(!(f==null||!isFinite(f))){var v=e-f,p=Math.abs(v);p<=o&&((p<o||v>=0&&s<0)&&(o=p,s=v,i=f,a.length=0),R(c,function(g){a.push({seriesIndex:l.seriesIndex,dataIndexInside:g,dataIndex:l.getData().getRawIndex(g)})}))}}),{payloadBatch:a,snapToValue:i}}function dQ(e,t,r,n){e[t.key]={value:r,payloadBatch:n}}function vQ(e,t,r,n){var i=r.payloadBatch,a=t.axis,o=a.model,s=t.axisPointerModel;if(!(!t.triggerTooltip||!i.length)){var l=t.coordSys.model,u=Jd(l),h=e.map[u];h||(h=e.map[u]={coordSysId:l.id,coordSysIndex:l.componentIndex,coordSysType:l.type,coordSysMainType:l.mainType,dataByAxis:[]},e.list.push(h)),h.dataByAxis.push({axisDim:a.dim,axisIndex:o.componentIndex,axisType:o.type,axisId:o.id,value:n,valueLabelOpt:{precision:s.get(["label","precision"]),formatter:s.get(["label","formatter"])},seriesDataIndices:i.slice()})}}function pQ(e,t,r){var n=r.axesInfo=[];R(t,function(i,a){var o=i.axisPointerModel.option,s=e[a];s?(!i.useHandle&&(o.status="show"),o.value=s.value,o.seriesDataIndices=(s.payloadBatch||[]).slice()):!i.useHandle&&(o.status="hide"),o.status==="show"&&n.push({axisDim:i.axis.dim,axisIndex:i.axis.model.componentIndex,value:o.value})})}function gQ(e,t,r,n){if(Qg(t)||!e.list.length){n({type:"hideTip"});return}var i=((e.list[0].dataByAxis[0]||{}).seriesDataIndices||[])[0]||{};n({type:"showTip",escapeConnect:!0,x:t[0],y:t[1],tooltipOption:r.tooltipOption,position:r.position,dataIndexInside:i.dataIndexInside,dataIndex:i.dataIndex,seriesIndex:i.seriesIndex,dataByCoordSys:e.list})}function mQ(e,t,r){var n=r.getZr(),i="axisPointerLastHighlights",a=tR(n)[i]||{},o=tR(n)[i]={};R(e,function(u,h){var f=u.axisPointerModel.option;f.status==="show"&&u.triggerEmphasis&&R(f.seriesDataIndices,function(c){var d=c.seriesIndex+" | "+c.dataIndex;o[d]=c})});var s=[],l=[];R(a,function(u,h){!o[h]&&l.push(u)}),R(o,function(u,h){!a[h]&&s.push(u)}),l.length&&r.dispatchAction({type:"downplay",escapeConnect:!0,notBlur:!0,batch:l}),s.length&&r.dispatchAction({type:"highlight",escapeConnect:!0,notBlur:!0,batch:s})}function _Q(e,t){for(var r=0;r<(e||[]).length;r++){var n=e[r];if(t.axis.dim===n.axisDim&&t.axis.model.componentIndex===n.axisIndex)return n}}function rR(e){var t=e.axis.model,r={},n=r.axisDim=e.axis.dim;return r.axisIndex=r[n+"AxisIndex"]=t.componentIndex,r.axisName=r[n+"AxisName"]=t.name,r.axisId=r[n+"AxisId"]=t.id,r}function Qg(e){return!e||e[0]==null||isNaN(e[0])||e[1]==null||isNaN(e[1])}function Bv(e){Hu.registerAxisPointerClass("CartesianAxisPointer",rQ),e.registerComponentModel(iQ),e.registerComponentView(hQ),e.registerPreprocessor(function(t){if(t){(!t.axisPointer||t.axisPointer.length===0)&&(t.axisPointer={});var r=t.axisPointer.link;r&&!at(r)&&(t.axisPointer.link=[r])}}),e.registerProcessor(e.PRIORITY.PROCESSOR.STATISTIC,function(t,r){t.getComponent("axisPointer").coordSysAxesInfo=LY(t,r)}),e.registerAction({type:"updateAxisPointer",event:"updateAxisPointer",update:":updateAxisPointer"},fQ)}function yQ(e){te(pU),te(Bv)}var xQ=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,n,i,a,o){var s=i.axis;s.dim==="angle"&&(this.animationThreshold=Math.PI/18);var l=s.polar,u=l.getOtherAxis(s),h=u.getExtent(),f=s.dataToCoord(n),c=a.get("type");if(c&&c!=="none"){var d=BM(a),v=TQ[c](s,l,f,h);v.style=d,r.graphicKey=v.type,r.pointer=v}var p=a.get(["label","margin"]),g=SQ(n,i,a,l,p);Bz(r,i,a,o,g)},t}(FM);function SQ(e,t,r,n,i){var a=t.axis,o=a.dataToCoord(e),s=n.getAngleAxis().getExtent()[0];s=s/180*Math.PI;var l=n.getRadiusAxis().getExtent(),u,h,f;if(a.dim==="radius"){var c=oi();Fu(c,c,s),qa(c,c,[n.cx,n.cy]),u=va([o,-i],c);var d=t.getModel("axisLabel").get("rotate")||0,v=Gn.innerTextLayout(s,d*Math.PI/180,-1);h=v.textAlign,f=v.textVerticalAlign}else{var p=l[1];u=n.coordToPoint([p+i,o]);var g=n.cx,m=n.cy;h=Math.abs(u[0]-g)/p<.3?"center":u[0]>g?"left":"right",f=Math.abs(u[1]-m)/p<.3?"middle":u[1]>m?"top":"bottom"}return{position:u,align:h,verticalAlign:f}}var TQ={line:function(e,t,r,n){return e.dim==="angle"?{type:"Line",shape:zM(t.coordToPoint([n[0],r]),t.coordToPoint([n[1],r]))}:{type:"Circle",shape:{cx:t.cx,cy:t.cy,r}}},shadow:function(e,t,r,n){var i=Math.max(1,e.getBandWidth()),a=Math.PI/180;return e.dim==="angle"?{type:"Sector",shape:KL(t.cx,t.cy,n[0],n[1],(-r-i/2)*a,(-r+i/2)*a)}:{type:"Sector",shape:KL(t.cx,t.cy,r-i/2,r+i/2,0,Math.PI*2)}}},bQ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.findAxisModel=function(r){var n,i=this.ecModel;return i.eachComponent(r,function(a){a.getCoordSysModel()===this&&(n=a)},this),n},t.type="polar",t.dependencies=["radiusAxis","angleAxis"],t.defaultOption={z:0,center:["50%","50%"],radius:"80%"},t}(me),kM=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getCoordSysModel=function(){return this.getReferringComponents("polar",zr).models[0]},t.type="polarAxis",t}(me);Nr(kM,Jf);var wQ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="angleAxis",t}(kM),MQ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="radiusAxis",t}(kM),GM=function(e){q(t,e);function t(r,n){return e.call(this,"radius",r,n)||this}return t.prototype.pointToData=function(r,n){return this.polar.pointToData(r,n)[this.dim==="radius"?0:1]},t}(Kn);GM.prototype.dataToRadius=Kn.prototype.dataToCoord;GM.prototype.radiusToData=Kn.prototype.coordToData;var AQ=Le(),VM=function(e){q(t,e);function t(r,n){return e.call(this,"angle",r,n||[0,360])||this}return t.prototype.pointToData=function(r,n){return this.polar.pointToData(r,n)[this.dim==="radius"?0:1]},t.prototype.calculateCategoryInterval=function(){var r=this,n=r.getLabelModel(),i=r.scale,a=i.getExtent(),o=i.count();if(a[1]-a[0]<1)return 0;var s=a[0],l=r.dataToCoord(s+1)-r.dataToCoord(s),u=Math.abs(l),h=_v(s==null?"":s+"",n.getFont(),"center","top"),f=Math.max(h.height,7),c=f/u;isNaN(c)&&(c=1/0);var d=Math.max(0,Math.floor(c)),v=AQ(r.model),p=v.lastAutoInterval,g=v.lastTickCount;return p!=null&&g!=null&&Math.abs(p-d)<=1&&Math.abs(g-o)<=1&&p>d?d=p:(v.lastTickCount=o,v.lastAutoInterval=d),d},t}(Kn);VM.prototype.dataToAngle=Kn.prototype.dataToCoord;VM.prototype.angleToData=Kn.prototype.coordToData;var Hz=["radius","angle"],EQ=function(){function e(t){this.dimensions=Hz,this.type="polar",this.cx=0,this.cy=0,this._radiusAxis=new GM,this._angleAxis=new VM,this.axisPointerEnabled=!0,this.name=t||"",this._radiusAxis.polar=this._angleAxis.polar=this}return e.prototype.containPoint=function(t){var r=this.pointToCoord(t);return this._radiusAxis.contain(r[0])&&this._angleAxis.contain(r[1])},e.prototype.containData=function(t){return this._radiusAxis.containData(t[0])&&this._angleAxis.containData(t[1])},e.prototype.getAxis=function(t){var r="_"+t+"Axis";return this[r]},e.prototype.getAxes=function(){return[this._radiusAxis,this._angleAxis]},e.prototype.getAxesByScale=function(t){var r=[],n=this._angleAxis,i=this._radiusAxis;return n.scale.type===t&&r.push(n),i.scale.type===t&&r.push(i),r},e.prototype.getAngleAxis=function(){return this._angleAxis},e.prototype.getRadiusAxis=function(){return this._radiusAxis},e.prototype.getOtherAxis=function(t){var r=this._angleAxis;return t===r?this._radiusAxis:r},e.prototype.getBaseAxis=function(){return this.getAxesByScale("ordinal")[0]||this.getAxesByScale("time")[0]||this.getAngleAxis()},e.prototype.getTooltipAxes=function(t){var r=t!=null&&t!=="auto"?this.getAxis(t):this.getBaseAxis();return{baseAxes:[r],otherAxes:[this.getOtherAxis(r)]}},e.prototype.dataToPoint=function(t,r){return this.coordToPoint([this._radiusAxis.dataToRadius(t[0],r),this._angleAxis.dataToAngle(t[1],r)])},e.prototype.pointToData=function(t,r){var n=this.pointToCoord(t);return[this._radiusAxis.radiusToData(n[0],r),this._angleAxis.angleToData(n[1],r)]},e.prototype.pointToCoord=function(t){var r=t[0]-this.cx,n=t[1]-this.cy,i=this.getAngleAxis(),a=i.getExtent(),o=Math.min(a[0],a[1]),s=Math.max(a[0],a[1]);i.inverse?o=s-360:s=o+360;var l=Math.sqrt(r*r+n*n);r/=l,n/=l;for(var u=Math.atan2(-n,r)/Math.PI*180,h=u<o?1:-1;u<o||u>s;)u+=h*360;return[l,u]},e.prototype.coordToPoint=function(t){var r=t[0],n=t[1]/180*Math.PI,i=Math.cos(n)*r+this.cx,a=-Math.sin(n)*r+this.cy;return[i,a]},e.prototype.getArea=function(){var t=this.getAngleAxis(),r=this.getRadiusAxis(),n=r.getExtent().slice();n[0]>n[1]&&n.reverse();var i=t.getExtent(),a=Math.PI/180,o=1e-4;return{cx:this.cx,cy:this.cy,r0:n[0],r:n[1],startAngle:-i[0]*a,endAngle:-i[1]*a,clockwise:t.inverse,contain:function(s,l){var u=s-this.cx,h=l-this.cy,f=u*u+h*h,c=this.r,d=this.r0;return c!==d&&f-o<=c*c&&f+o>=d*d}}},e.prototype.convertToPixel=function(t,r,n){var i=nR(r);return i===this?this.dataToPoint(n):null},e.prototype.convertFromPixel=function(t,r,n){var i=nR(r);return i===this?this.pointToData(n):null},e}();function nR(e){var t=e.seriesModel,r=e.polarModel;return r&&r.coordinateSystem||t&&t.coordinateSystem}function CQ(e,t,r){var n=t.get("center"),i=r.getWidth(),a=r.getHeight();e.cx=Tt(n[0],i),e.cy=Tt(n[1],a);var o=e.getRadiusAxis(),s=Math.min(i,a)/2,l=t.get("radius");l==null?l=[0,"100%"]:at(l)||(l=[0,l]);var u=[Tt(l[0],s),Tt(l[1],s)];o.inverse?o.setExtent(u[1],u[0]):o.setExtent(u[0],u[1])}function DQ(e,t){var r=this,n=r.getAngleAxis(),i=r.getRadiusAxis();if(n.scale.setExtent(1/0,-1/0),i.scale.setExtent(1/0,-1/0),e.eachSeries(function(s){if(s.coordinateSystem===r){var l=s.getData();R(Fm(l,"radius"),function(u){i.scale.unionExtentFromData(l,u)}),R(Fm(l,"angle"),function(u){n.scale.unionExtentFromData(l,u)})}}),Au(n.scale,n.model),Au(i.scale,i.model),n.type==="category"&&!n.onBand){var a=n.getExtent(),o=360/n.scale.count();n.inverse?a[1]+=o:a[1]-=o,n.setExtent(a[0],a[1])}}function LQ(e){return e.mainType==="angleAxis"}function iR(e,t){var r;if(e.type=t.get("type"),e.scale=Cv(t),e.onBand=t.get("boundaryGap")&&e.type==="category",e.inverse=t.get("inverse"),LQ(t)){e.inverse=e.inverse!==t.get("clockwise");var n=t.get("startAngle"),i=(r=t.get("endAngle"))!==null&&r!==void 0?r:n+(e.inverse?-360:360);e.setExtent(n,i)}t.axis=e,e.model=t}var RQ={dimensions:Hz,create:function(e,t){var r=[];return e.eachComponent("polar",function(n,i){var a=new EQ(i+"");a.update=DQ;var o=a.getRadiusAxis(),s=a.getAngleAxis(),l=n.findAxisModel("radiusAxis"),u=n.findAxisModel("angleAxis");iR(o,l),iR(s,u),CQ(a,n,t),r.push(a),n.coordinateSystem=a,a.model=n}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="polar"){var i=n.getReferringComponents("polar",zr).models[0];n.coordinateSystem=i.coordinateSystem}}),r}},PQ=["axisLine","axisLabel","axisTick","minorTick","splitLine","minorSplitLine","splitArea"];function Vp(e,t,r){t[1]>t[0]&&(t=t.slice().reverse());var n=e.coordToPoint([t[0],r]),i=e.coordToPoint([t[1],r]);return{x1:n[0],y1:n[1],x2:i[0],y2:i[1]}}function Hp(e){var t=e.getRadiusAxis();return t.inverse?0:1}function aR(e){var t=e[0],r=e[e.length-1];t&&r&&Math.abs(Math.abs(t.coord-r.coord)-360)<1e-4&&e.pop()}var IQ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="PolarAxisPointer",r}return t.prototype.render=function(r,n){if(this.group.removeAll(),!!r.get("show")){var i=r.axis,a=i.polar,o=a.getRadiusAxis().getExtent(),s=i.getTicksCoords(),l=i.getMinorTicksCoords(),u=ft(i.getViewLabels(),function(h){h=Qt(h);var f=i.scale,c=f.type==="ordinal"?f.getRawOrdinalNumber(h.tickValue):h.tickValue;return h.coord=i.dataToCoord(c),h});aR(u),aR(s),R(PQ,function(h){r.get([h,"show"])&&(!i.scale.isBlank()||h==="axisLine")&&NQ[h](this.group,r,a,s,l,o,u)},this)}},t.type="angleAxis",t}(Hu),NQ={axisLine:function(e,t,r,n,i,a){var o=t.getModel(["axisLine","lineStyle"]),s=r.getAngleAxis(),l=Math.PI/180,u=s.getExtent(),h=Hp(r),f=h?0:1,c,d=Math.abs(u[1]-u[0])===360?"Circle":"Arc";a[f]===0?c=new zu[d]({shape:{cx:r.cx,cy:r.cy,r:a[h],startAngle:-u[0]*l,endAngle:-u[1]*l,clockwise:s.inverse},style:o.getLineStyle(),z2:1,silent:!0}):c=new Sv({shape:{cx:r.cx,cy:r.cy,r:a[h],r0:a[f]},style:o.getLineStyle(),z2:1,silent:!0}),c.style.fill=null,e.add(c)},axisTick:function(e,t,r,n,i,a){var o=t.getModel("axisTick"),s=(o.get("inside")?-1:1)*o.get("length"),l=a[Hp(r)],u=ft(n,function(h){return new jr({shape:Vp(r,[l,l+s],h.coord)})});e.add(Ui(u,{style:Vt(o.getModel("lineStyle").getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])})}))},minorTick:function(e,t,r,n,i,a){if(i.length){for(var o=t.getModel("axisTick"),s=t.getModel("minorTick"),l=(o.get("inside")?-1:1)*s.get("length"),u=a[Hp(r)],h=[],f=0;f<i.length;f++)for(var c=0;c<i[f].length;c++)h.push(new jr({shape:Vp(r,[u,u+l],i[f][c].coord)}));e.add(Ui(h,{style:Vt(s.getModel("lineStyle").getLineStyle(),Vt(o.getLineStyle(),{stroke:t.get(["axisLine","lineStyle","color"])}))}))}},axisLabel:function(e,t,r,n,i,a,o){var s=t.getCategories(!0),l=t.getModel("axisLabel"),u=l.get("margin"),h=t.get("triggerEvent");R(o,function(f,c){var d=l,v=f.tickValue,p=a[Hp(r)],g=r.coordToPoint([p+u,f.coord]),m=r.cx,_=r.cy,y=Math.abs(g[0]-m)/p<.3?"center":g[0]>m?"left":"right",x=Math.abs(g[1]-_)/p<.3?"middle":g[1]>_?"top":"bottom";if(s&&s[v]){var T=s[v];Kt(T)&&T.textStyle&&(d=new Ie(T.textStyle,l,l.ecModel))}var S=new we({silent:Gn.isLabelSilent(t),style:je(d,{x:g[0],y:g[1],fill:d.getTextColor()||t.get(["axisLine","lineStyle","color"]),text:f.formattedLabel,align:y,verticalAlign:x})});if(e.add(S),h){var M=Gn.makeAxisEventDataBase(t);M.targetType="axisLabel",M.value=f.rawLabel,oe(S).eventData=M}},this)},splitLine:function(e,t,r,n,i,a){var o=t.getModel("splitLine"),s=o.getModel("lineStyle"),l=s.get("color"),u=0;l=l instanceof Array?l:[l];for(var h=[],f=0;f<n.length;f++){var c=u++%l.length;h[c]=h[c]||[],h[c].push(new jr({shape:Vp(r,a,n[f].coord)}))}for(var f=0;f<h.length;f++)e.add(Ui(h[f],{style:Vt({stroke:l[f%l.length]},s.getLineStyle()),silent:!0,z:t.get("z")}))},minorSplitLine:function(e,t,r,n,i,a){if(i.length){for(var o=t.getModel("minorSplitLine"),s=o.getModel("lineStyle"),l=[],u=0;u<i.length;u++)for(var h=0;h<i[u].length;h++)l.push(new jr({shape:Vp(r,a,i[u][h].coord)}));e.add(Ui(l,{style:s.getLineStyle(),silent:!0,z:t.get("z")}))}},splitArea:function(e,t,r,n,i,a){if(n.length){var o=t.getModel("splitArea"),s=o.getModel("areaStyle"),l=s.get("color"),u=0;l=l instanceof Array?l:[l];for(var h=[],f=Math.PI/180,c=-n[0].coord*f,d=Math.min(a[0],a[1]),v=Math.max(a[0],a[1]),p=t.get("clockwise"),g=1,m=n.length;g<=m;g++){var _=g===m?n[0].coord:n[g].coord,y=u++%l.length;h[y]=h[y]||[],h[y].push(new Xn({shape:{cx:r.cx,cy:r.cy,r0:d,r:v,startAngle:c,endAngle:-_*f,clockwise:p},silent:!0})),c=-_*f}for(var g=0;g<h.length;g++)e.add(Ui(h[g],{style:Vt({fill:l[g%l.length]},s.getAreaStyle()),silent:!0}))}}},OQ=["axisLine","axisTickLabel","axisName"],FQ=["splitLine","splitArea","minorSplitLine"],BQ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="PolarAxisPointer",r}return t.prototype.render=function(r,n){if(this.group.removeAll(),!!r.get("show")){var i=this._axisGroup,a=this._axisGroup=new re;this.group.add(a);var o=r.axis,s=o.polar,l=s.getAngleAxis(),u=o.getTicksCoords(),h=o.getMinorTicksCoords(),f=l.getExtent()[0],c=o.getExtent(),d=zQ(s,r,f),v=new Gn(r,d);R(OQ,v.add,v),a.add(v.getGroup()),wv(i,a,r),R(FQ,function(p){r.get([p,"show"])&&!o.scale.isBlank()&&UQ[p](this.group,r,s,f,c,u,h)},this)}},t.type="radiusAxis",t}(Hu),UQ={splitLine:function(e,t,r,n,i,a){var o=t.getModel("splitLine"),s=o.getModel("lineStyle"),l=s.get("color"),u=0,h=r.getAngleAxis(),f=Math.PI/180,c=h.getExtent(),d=Math.abs(c[1]-c[0])===360?"Circle":"Arc";l=l instanceof Array?l:[l];for(var v=[],p=0;p<a.length;p++){var g=u++%l.length;v[g]=v[g]||[],v[g].push(new zu[d]({shape:{cx:r.cx,cy:r.cy,r:Math.max(a[p].coord,0),startAngle:-c[0]*f,endAngle:-c[1]*f,clockwise:h.inverse}}))}for(var p=0;p<v.length;p++)e.add(Ui(v[p],{style:Vt({stroke:l[p%l.length],fill:null},s.getLineStyle()),silent:!0}))},minorSplitLine:function(e,t,r,n,i,a,o){if(o.length){for(var s=t.getModel("minorSplitLine"),l=s.getModel("lineStyle"),u=[],h=0;h<o.length;h++)for(var f=0;f<o[h].length;f++)u.push(new Vo({shape:{cx:r.cx,cy:r.cy,r:o[h][f].coord}}));e.add(Ui(u,{style:Vt({fill:null},l.getLineStyle()),silent:!0}))}},splitArea:function(e,t,r,n,i,a){if(a.length){var o=t.getModel("splitArea"),s=o.getModel("areaStyle"),l=s.get("color"),u=0;l=l instanceof Array?l:[l];for(var h=[],f=a[0].coord,c=1;c<a.length;c++){var d=u++%l.length;h[d]=h[d]||[],h[d].push(new Xn({shape:{cx:r.cx,cy:r.cy,r0:f,r:a[c].coord,startAngle:0,endAngle:Math.PI*2},silent:!0})),f=a[c].coord}for(var c=0;c<h.length;c++)e.add(Ui(h[c],{style:Vt({fill:l[c%l.length]},s.getAreaStyle()),silent:!0}))}}};function zQ(e,t,r){return{position:[e.cx,e.cy],rotation:r/180*Math.PI,labelDirection:-1,tickDirection:-1,nameDirection:1,labelRotate:t.getModel("axisLabel").get("rotate"),z2:1}}function Wz(e){return e.get("stack")||"__ec_stack_"+e.seriesIndex}function Xz(e,t){return t.dim+e.model.componentIndex}function kQ(e,t,r){var n={},i=GQ(Xe(t.getSeriesByType(e),function(a){return!t.isSeriesFiltered(a)&&a.coordinateSystem&&a.coordinateSystem.type==="polar"}));t.eachSeriesByType(e,function(a){if(a.coordinateSystem.type==="polar"){var o=a.getData(),s=a.coordinateSystem,l=s.getBaseAxis(),u=Xz(s,l),h=Wz(a),f=i[u][h],c=f.offset,d=f.width,v=s.getOtherAxis(l),p=a.coordinateSystem.cx,g=a.coordinateSystem.cy,m=a.get("barMinHeight")||0,_=a.get("barMinAngle")||0;n[h]=n[h]||[];for(var y=o.mapDimension(v.dim),x=o.mapDimension(l.dim),T=Oo(o,y),S=l.dim!=="radius"||!a.get("roundCap",!0),M=v.model,w=M.get("startValue"),b=v.dataToCoord(w||0),A=0,E=o.count();A<E;A++){var C=o.get(y,A),D=o.get(x,A),L=C>=0?"p":"n",P=b;T&&(n[h][D]||(n[h][D]={p:b,n:b}),P=n[h][D][L]);var N=void 0,O=void 0,I=void 0,k=void 0;if(v.dim==="radius"){var z=v.dataToCoord(C)-b,X=l.dataToCoord(D);Math.abs(z)<m&&(z=(z<0?-1:1)*m),N=P,O=P+z,I=X-c,k=I-d,T&&(n[h][D][L]=O)}else{var Y=v.dataToCoord(C,S)-b,$=l.dataToCoord(D);Math.abs(Y)<_&&(Y=(Y<0?-1:1)*_),N=$+c,O=N+d,I=P,k=P+Y,T&&(n[h][D][L]=k)}o.setItemLayout(A,{cx:p,cy:g,r0:N,r:O,startAngle:-I*Math.PI/180,endAngle:-k*Math.PI/180,clockwise:I>=k})}}})}function GQ(e){var t={};R(e,function(n,i){var a=n.getData(),o=n.coordinateSystem,s=o.getBaseAxis(),l=Xz(o,s),u=s.getExtent(),h=s.type==="category"?s.getBandWidth():Math.abs(u[1]-u[0])/a.count(),f=t[l]||{bandWidth:h,remainedWidth:h,autoWidthCount:0,categoryGap:"20%",gap:"30%",stacks:{}},c=f.stacks;t[l]=f;var d=Wz(n);c[d]||f.autoWidthCount++,c[d]=c[d]||{width:0,maxWidth:0};var v=Tt(n.get("barWidth"),h),p=Tt(n.get("barMaxWidth"),h),g=n.get("barGap"),m=n.get("barCategoryGap");v&&!c[d].width&&(v=Math.min(f.remainedWidth,v),c[d].width=v,f.remainedWidth-=v),p&&(c[d].maxWidth=p),g!=null&&(f.gap=g),m!=null&&(f.categoryGap=m)});var r={};return R(t,function(n,i){r[i]={};var a=n.stacks,o=n.bandWidth,s=Tt(n.categoryGap,o),l=Tt(n.gap,1),u=n.remainedWidth,h=n.autoWidthCount,f=(u-s)/(h+(h-1)*l);f=Math.max(f,0),R(a,function(p,g){var m=p.maxWidth;m&&m<f&&(m=Math.min(m,u),p.width&&(m=Math.min(m,p.width)),u-=m,p.width=m,h--)}),f=(u-s)/(h+(h-1)*l),f=Math.max(f,0);var c=0,d;R(a,function(p,g){p.width||(p.width=f),d=p,c+=p.width*(1+l)}),d&&(c-=d.width*l);var v=-c/2;R(a,function(p,g){r[i][g]=r[i][g]||{offset:v,width:p.width},v+=p.width*(1+l)})}),r}var VQ={startAngle:90,clockwise:!0,splitNumber:12,axisLabel:{rotate:0}},HQ={splitNumber:5},WQ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="polar",t}(nr);function XQ(e){te(Bv),Hu.registerAxisPointerClass("PolarAxisPointer",xQ),e.registerCoordinateSystem("polar",RQ),e.registerComponentModel(bQ),e.registerComponentView(WQ),pf(e,"angle",wQ,VQ),pf(e,"radius",MQ,HQ),e.registerComponentView(IQ),e.registerComponentView(BQ),e.registerLayout(ue(kQ,"bar"))}function wT(e,t){t=t||{};var r=e.coordinateSystem,n=e.axis,i={},a=n.position,o=n.orient,s=r.getRect(),l=[s.x,s.x+s.width,s.y,s.y+s.height],u={horizontal:{top:l[2],bottom:l[3]},vertical:{left:l[0],right:l[1]}};i.position=[o==="vertical"?u.vertical[a]:l[0],o==="horizontal"?u.horizontal[a]:l[3]];var h={horizontal:0,vertical:1};i.rotation=Math.PI/2*h[o];var f={top:-1,bottom:1,right:1,left:-1};i.labelDirection=i.tickDirection=i.nameDirection=f[a],e.get(["axisTick","inside"])&&(i.tickDirection=-i.tickDirection),pn(t.labelInside,e.get(["axisLabel","inside"]))&&(i.labelDirection=-i.labelDirection);var c=t.rotate;return c==null&&(c=e.get(["axisLabel","rotate"])),i.labelRotation=a==="top"?-c:c,i.z2=1,i}var YQ=["axisLine","axisTickLabel","axisName"],ZQ=["splitArea","splitLine"],qQ=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.axisPointerClass="SingleAxisPointer",r}return t.prototype.render=function(r,n,i,a){var o=this.group;o.removeAll();var s=this._axisGroup;this._axisGroup=new re;var l=wT(r),u=new Gn(r,l);R(YQ,u.add,u),o.add(this._axisGroup),o.add(u.getGroup()),R(ZQ,function(h){r.get([h,"show"])&&$Q[h](this,this.group,this._axisGroup,r)},this),wv(s,this._axisGroup,r),e.prototype.render.call(this,r,n,i,a)},t.prototype.remove=function(){cU(this)},t.type="singleAxis",t}(Hu),$Q={splitLine:function(e,t,r,n){var i=n.axis;if(!i.scale.isBlank()){var a=n.getModel("splitLine"),o=a.getModel("lineStyle"),s=o.get("color");s=s instanceof Array?s:[s];for(var l=o.get("width"),u=n.coordinateSystem.getRect(),h=i.isHorizontal(),f=[],c=0,d=i.getTicksCoords({tickModel:a}),v=[],p=[],g=0;g<d.length;++g){var m=i.toGlobalCoord(d[g].coord);h?(v[0]=m,v[1]=u.y,p[0]=m,p[1]=u.y+u.height):(v[0]=u.x,v[1]=m,p[0]=u.x+u.width,p[1]=m);var _=new jr({shape:{x1:v[0],y1:v[1],x2:p[0],y2:p[1]},silent:!0});ff(_.shape,l);var y=c++%s.length;f[y]=f[y]||[],f[y].push(_)}for(var x=o.getLineStyle(["color"]),g=0;g<f.length;++g)t.add(Ui(f[g],{style:Vt({stroke:s[g%s.length]},x),silent:!0}))}},splitArea:function(e,t,r,n){fU(e,r,n,n)}},tm=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.getCoordSysModel=function(){return this},t.type="singleAxis",t.layoutMode="box",t.defaultOption={left:"5%",top:"5%",right:"5%",bottom:"5%",type:"value",position:"bottom",orient:"horizontal",axisLine:{show:!0,lineStyle:{width:1,type:"solid"}},tooltip:{show:!0},axisTick:{show:!0,length:6,lineStyle:{width:1}},axisLabel:{show:!0,interval:"auto"},splitLine:{show:!0,lineStyle:{type:"dashed",opacity:.2}}},t}(me);Nr(tm,Jf.prototype);var KQ=function(e){q(t,e);function t(r,n,i,a,o){var s=e.call(this,r,n,i)||this;return s.type=a||"value",s.position=o||"bottom",s}return t.prototype.isHorizontal=function(){var r=this.position;return r==="top"||r==="bottom"},t.prototype.pointToData=function(r,n){return this.coordinateSystem.pointToData(r)[0]},t}(Kn),Yz=["single"],jQ=function(){function e(t,r,n){this.type="single",this.dimension="single",this.dimensions=Yz,this.axisPointerEnabled=!0,this.model=t,this._init(t,r,n)}return e.prototype._init=function(t,r,n){var i=this.dimension,a=new KQ(i,Cv(t),[0,0],t.get("type"),t.get("position")),o=a.type==="category";a.onBand=o&&t.get("boundaryGap"),a.inverse=t.get("inverse"),a.orient=t.get("orient"),t.axis=a,a.model=t,a.coordinateSystem=this,this._axis=a},e.prototype.update=function(t,r){t.eachSeries(function(n){if(n.coordinateSystem===this){var i=n.getData();R(i.mapDimensionsAll(this.dimension),function(a){this._axis.scale.unionExtentFromData(i,a)},this),Au(this._axis.scale,this._axis.model)}},this)},e.prototype.resize=function(t,r){this._rect=Mr({left:t.get("left"),top:t.get("top"),right:t.get("right"),bottom:t.get("bottom"),width:t.get("width"),height:t.get("height")},{width:r.getWidth(),height:r.getHeight()}),this._adjustAxis()},e.prototype.getRect=function(){return this._rect},e.prototype._adjustAxis=function(){var t=this._rect,r=this._axis,n=r.isHorizontal(),i=n?[0,t.width]:[0,t.height],a=r.inverse?1:0;r.setExtent(i[a],i[1-a]),this._updateAxisTransform(r,n?t.x:t.y)},e.prototype._updateAxisTransform=function(t,r){var n=t.getExtent(),i=n[0]+n[1],a=t.isHorizontal();t.toGlobalCoord=a?function(o){return o+r}:function(o){return i-o+r},t.toLocalCoord=a?function(o){return o-r}:function(o){return i-o+r}},e.prototype.getAxis=function(){return this._axis},e.prototype.getBaseAxis=function(){return this._axis},e.prototype.getAxes=function(){return[this._axis]},e.prototype.getTooltipAxes=function(){return{baseAxes:[this.getAxis()],otherAxes:[]}},e.prototype.containPoint=function(t){var r=this.getRect(),n=this.getAxis(),i=n.orient;return i==="horizontal"?n.contain(n.toLocalCoord(t[0]))&&t[1]>=r.y&&t[1]<=r.y+r.height:n.contain(n.toLocalCoord(t[1]))&&t[0]>=r.y&&t[0]<=r.y+r.height},e.prototype.pointToData=function(t){var r=this.getAxis();return[r.coordToData(r.toLocalCoord(t[r.orient==="horizontal"?0:1]))]},e.prototype.dataToPoint=function(t){var r=this.getAxis(),n=this.getRect(),i=[],a=r.orient==="horizontal"?0:1;return t instanceof Array&&(t=t[0]),i[a]=r.toGlobalCoord(r.dataToCoord(+t)),i[1-a]=a===0?n.y+n.height/2:n.x+n.width/2,i},e.prototype.convertToPixel=function(t,r,n){var i=oR(r);return i===this?this.dataToPoint(n):null},e.prototype.convertFromPixel=function(t,r,n){var i=oR(r);return i===this?this.pointToData(n):null},e}();function oR(e){var t=e.seriesModel,r=e.singleAxisModel;return r&&r.coordinateSystem||t&&t.coordinateSystem}function JQ(e,t){var r=[];return e.eachComponent("singleAxis",function(n,i){var a=new jQ(n,e,t);a.name="single_"+i,a.resize(n,t),n.coordinateSystem=a,r.push(a)}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="singleAxis"){var i=n.getReferringComponents("singleAxis",zr).models[0];n.coordinateSystem=i&&i.coordinateSystem}}),r}var QQ={create:JQ,dimensions:Yz},sR=["x","y"],ttt=["width","height"],ett=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.makeElOption=function(r,n,i,a,o){var s=i.axis,l=s.coordinateSystem,u=Cx(l,1-Km(s)),h=l.dataToPoint(n)[0],f=a.get("type");if(f&&f!=="none"){var c=BM(a),d=rtt[f](s,h,u);d.style=c,r.graphicKey=d.type,r.pointer=d}var v=wT(i);zz(n,r,v,i,a,o)},t.prototype.getHandleTransform=function(r,n,i){var a=wT(n,{labelInside:!1});a.labelMargin=i.get(["handle","margin"]);var o=UM(n.axis,r,a);return{x:o[0],y:o[1],rotation:a.rotation+(a.labelDirection<0?Math.PI:0)}},t.prototype.updateHandleTransform=function(r,n,i,a){var o=i.axis,s=o.coordinateSystem,l=Km(o),u=Cx(s,l),h=[r.x,r.y];h[l]+=n[l],h[l]=Math.min(u[1],h[l]),h[l]=Math.max(u[0],h[l]);var f=Cx(s,1-l),c=(f[1]+f[0])/2,d=[c,c];return d[l]=h[l],{x:h[0],y:h[1],rotation:r.rotation,cursorPoint:d,tooltipOption:{verticalAlign:"middle"}}},t}(FM),rtt={line:function(e,t,r){var n=zM([t,r[0]],[t,r[1]],Km(e));return{type:"Line",subPixelOptimize:!0,shape:n}},shadow:function(e,t,r){var n=e.getBandWidth(),i=r[1]-r[0];return{type:"Rect",shape:kz([t-n/2,r[0]],[n,i],Km(e))}}};function Km(e){return e.isHorizontal()?0:1}function Cx(e,t){var r=e.getRect();return[r[sR[t]],r[sR[t]]+r[ttt[t]]]}var ntt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="single",t}(nr);function itt(e){te(Bv),Hu.registerAxisPointerClass("SingleAxisPointer",ett),e.registerComponentView(ntt),e.registerComponentView(qQ),e.registerComponentModel(tm),pf(e,"single",tm,tm.defaultOption),e.registerCoordinateSystem("single",QQ)}var att=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n,i){var a=Wf(r);e.prototype.init.apply(this,arguments),lR(r,a)},t.prototype.mergeOption=function(r){e.prototype.mergeOption.apply(this,arguments),lR(this.option,r)},t.prototype.getCellSize=function(){return this.option.cellSize},t.type="calendar",t.defaultOption={z:2,left:80,top:60,cellSize:20,orient:"horizontal",splitLine:{show:!0,lineStyle:{color:"#000",width:1,type:"solid"}},itemStyle:{color:"#fff",borderWidth:1,borderColor:"#ccc"},dayLabel:{show:!0,firstDay:0,position:"start",margin:"50%",color:"#000"},monthLabel:{show:!0,position:"start",margin:5,align:"center",formatter:null,color:"#000"},yearLabel:{show:!0,position:null,margin:30,formatter:null,color:"#ccc",fontFamily:"sans-serif",fontWeight:"bolder",fontSize:20}},t}(me);function lR(e,t){var r=e.cellSize,n;at(r)?n=r:n=e.cellSize=[r,r],n.length===1&&(n[1]=n[0]);var i=ft([0,1],function(a){return IW(t,a)&&(n[a]="auto"),n[a]!=null&&n[a]!=="auto"});Bs(e,t,{type:"box",ignoreSize:i})}var ott=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){var a=this.group;a.removeAll();var o=r.coordinateSystem,s=o.getRangeInfo(),l=o.getOrient(),u=n.getLocaleModel();this._renderDayRect(r,s,a),this._renderLines(r,s,l,a),this._renderYearText(r,s,l,a),this._renderMonthText(r,u,l,a),this._renderWeekText(r,u,s,l,a)},t.prototype._renderDayRect=function(r,n,i){for(var a=r.coordinateSystem,o=r.getModel("itemStyle").getItemStyle(),s=a.getCellWidth(),l=a.getCellHeight(),u=n.start.time;u<=n.end.time;u=a.getNextNDay(u,1).time){var h=a.dataToRect([u],!1).tl,f=new Ae({shape:{x:h[0],y:h[1],width:s,height:l},cursor:"default",style:o});i.add(f)}},t.prototype._renderLines=function(r,n,i,a){var o=this,s=r.coordinateSystem,l=r.getModel(["splitLine","lineStyle"]).getLineStyle(),u=r.get(["splitLine","show"]),h=l.lineWidth;this._tlpoints=[],this._blpoints=[],this._firstDayOfMonth=[],this._firstDayPoints=[];for(var f=n.start,c=0;f.time<=n.end.time;c++){v(f.formatedDate),c===0&&(f=s.getDateInfo(n.start.y+"-"+n.start.m));var d=f.date;d.setMonth(d.getMonth()+1),f=s.getDateInfo(d)}v(s.getNextNDay(n.end.time,1).formatedDate);function v(p){o._firstDayOfMonth.push(s.getDateInfo(p)),o._firstDayPoints.push(s.dataToRect([p],!1).tl);var g=o._getLinePointsOfOneWeek(r,p,i);o._tlpoints.push(g[0]),o._blpoints.push(g[g.length-1]),u&&o._drawSplitline(g,l,a)}u&&this._drawSplitline(o._getEdgesPoints(o._tlpoints,h,i),l,a),u&&this._drawSplitline(o._getEdgesPoints(o._blpoints,h,i),l,a)},t.prototype._getEdgesPoints=function(r,n,i){var a=[r[0].slice(),r[r.length-1].slice()],o=i==="horizontal"?0:1;return a[0][o]=a[0][o]-n/2,a[1][o]=a[1][o]+n/2,a},t.prototype._drawSplitline=function(r,n,i){var a=new $n({z2:20,shape:{points:r},style:n});i.add(a)},t.prototype._getLinePointsOfOneWeek=function(r,n,i){for(var a=r.coordinateSystem,o=a.getDateInfo(n),s=[],l=0;l<7;l++){var u=a.getNextNDay(o.time,l),h=a.dataToRect([u.time],!1);s[2*u.day]=h.tl,s[2*u.day+1]=h[i==="horizontal"?"bl":"tr"]}return s},t.prototype._formatterLabel=function(r,n){return Ct(r)&&r?LW(r,n):Yt(r)?r(n):n.nameMap},t.prototype._yearTextPositionControl=function(r,n,i,a,o){var s=n[0],l=n[1],u=["center","bottom"];a==="bottom"?(l+=o,u=["center","top"]):a==="left"?s-=o:a==="right"?(s+=o,u=["center","top"]):l-=o;var h=0;return(a==="left"||a==="right")&&(h=Math.PI/2),{rotation:h,x:s,y:l,style:{align:u[0],verticalAlign:u[1]}}},t.prototype._renderYearText=function(r,n,i,a){var o=r.getModel("yearLabel");if(o.get("show")){var s=o.get("margin"),l=o.get("position");l||(l=i!=="horizontal"?"top":"left");var u=[this._tlpoints[this._tlpoints.length-1],this._blpoints[0]],h=(u[0][0]+u[1][0])/2,f=(u[0][1]+u[1][1])/2,c=i==="horizontal"?0:1,d={top:[h,u[c][1]],bottom:[h,u[1-c][1]],left:[u[1-c][0],f],right:[u[c][0],f]},v=n.start.y;+n.end.y>+n.start.y&&(v=v+"-"+n.end.y);var p=o.get("formatter"),g={start:n.start.y,end:n.end.y,nameMap:v},m=this._formatterLabel(p,g),_=new we({z2:30,style:je(o,{text:m}),silent:o.get("silent")});_.attr(this._yearTextPositionControl(_,d[l],i,l,s)),a.add(_)}},t.prototype._monthTextPositionControl=function(r,n,i,a,o){var s="left",l="top",u=r[0],h=r[1];return i==="horizontal"?(h=h+o,n&&(s="center"),a==="start"&&(l="bottom")):(u=u+o,n&&(l="middle"),a==="start"&&(s="right")),{x:u,y:h,align:s,verticalAlign:l}},t.prototype._renderMonthText=function(r,n,i,a){var o=r.getModel("monthLabel");if(o.get("show")){var s=o.get("nameMap"),l=o.get("margin"),u=o.get("position"),h=o.get("align"),f=[this._tlpoints,this._blpoints];(!s||Ct(s))&&(s&&(n=PS(s)||n),s=n.get(["time","monthAbbr"])||[]);var c=u==="start"?0:1,d=i==="horizontal"?0:1;l=u==="start"?-l:l;for(var v=h==="center",p=o.get("silent"),g=0;g<f[c].length-1;g++){var m=f[c][g].slice(),_=this._firstDayOfMonth[g];if(v){var y=this._firstDayPoints[g];m[d]=(y[d]+f[0][g+1][d])/2}var x=o.get("formatter"),T=s[+_.m-1],S={yyyy:_.y,yy:(_.y+"").slice(2),MM:_.m,M:+_.m,nameMap:T},M=this._formatterLabel(x,S),w=new we({z2:30,style:rt(je(o,{text:M}),this._monthTextPositionControl(m,v,i,u,l)),silent:p});a.add(w)}}},t.prototype._weekTextPositionControl=function(r,n,i,a,o){var s="center",l="middle",u=r[0],h=r[1],f=i==="start";return n==="horizontal"?(u=u+a+(f?1:-1)*o[0]/2,s=f?"right":"left"):(h=h+a+(f?1:-1)*o[1]/2,l=f?"bottom":"top"),{x:u,y:h,align:s,verticalAlign:l}},t.prototype._renderWeekText=function(r,n,i,a,o){var s=r.getModel("dayLabel");if(s.get("show")){var l=r.coordinateSystem,u=s.get("position"),h=s.get("nameMap"),f=s.get("margin"),c=l.getFirstDayOfWeek();if(!h||Ct(h)){h&&(n=PS(h)||n);var d=n.get(["time","dayOfWeekShort"]);h=d||ft(n.get(["time","dayOfWeekAbbr"]),function(S){return S[0]})}var v=l.getNextNDay(i.end.time,7-i.lweek).time,p=[l.getCellWidth(),l.getCellHeight()];f=Tt(f,Math.min(p[1],p[0])),u==="start"&&(v=l.getNextNDay(i.start.time,-(7+i.fweek)).time,f=-f);for(var g=s.get("silent"),m=0;m<7;m++){var _=l.getNextNDay(v,m),y=l.dataToRect([_.time],!1).center,x=m;x=Math.abs((m+c)%7);var T=new we({z2:30,style:rt(je(s,{text:h[x]}),this._weekTextPositionControl(y,a,u,f,p)),silent:g});o.add(T)}}},t.type="calendar",t}(nr),Dx=864e5,stt=function(){function e(t,r,n){this.type="calendar",this.dimensions=e.dimensions,this.getDimensionsInfo=e.getDimensionsInfo,this._model=t}return e.getDimensionsInfo=function(){return[{name:"time",type:"time"},"value"]},e.prototype.getRangeInfo=function(){return this._rangeInfo},e.prototype.getModel=function(){return this._model},e.prototype.getRect=function(){return this._rect},e.prototype.getCellWidth=function(){return this._sw},e.prototype.getCellHeight=function(){return this._sh},e.prototype.getOrient=function(){return this._orient},e.prototype.getFirstDayOfWeek=function(){return this._firstDayOfWeek},e.prototype.getDateInfo=function(t){t=Xi(t);var r=t.getFullYear(),n=t.getMonth()+1,i=n<10?"0"+n:""+n,a=t.getDate(),o=a<10?"0"+a:""+a,s=t.getDay();return s=Math.abs((s+7-this.getFirstDayOfWeek())%7),{y:r+"",m:i,d:o,day:s,time:t.getTime(),formatedDate:r+"-"+i+"-"+o,date:t}},e.prototype.getNextNDay=function(t,r){return r=r||0,r===0?this.getDateInfo(t):(t=new Date(this.getDateInfo(t).time),t.setDate(t.getDate()+r),this.getDateInfo(t))},e.prototype.update=function(t,r){this._firstDayOfWeek=+this._model.getModel("dayLabel").get("firstDay"),this._orient=this._model.get("orient"),this._lineWidth=this._model.getModel("itemStyle").getItemStyle().lineWidth||0,this._rangeInfo=this._getRangeInfo(this._initRangeOption());var n=this._rangeInfo.weeks||1,i=["width","height"],a=this._model.getCellSize().slice(),o=this._model.getBoxLayoutParams(),s=this._orient==="horizontal"?[n,7]:[7,n];R([0,1],function(f){h(a,f)&&(o[i[f]]=a[f]*s[f])});var l={width:r.getWidth(),height:r.getHeight()},u=this._rect=Mr(o,l);R([0,1],function(f){h(a,f)||(a[f]=u[i[f]]/s[f])});function h(f,c){return f[c]!=null&&f[c]!=="auto"}this._sw=a[0],this._sh=a[1]},e.prototype.dataToPoint=function(t,r){at(t)&&(t=t[0]),r==null&&(r=!0);var n=this.getDateInfo(t),i=this._rangeInfo,a=n.formatedDate;if(r&&!(n.time>=i.start.time&&n.time<i.end.time+Dx))return[NaN,NaN];var o=n.day,s=this._getRangeInfo([i.start.time,a]).nthWeek;return this._orient==="vertical"?[this._rect.x+o*this._sw+this._sw/2,this._rect.y+s*this._sh+this._sh/2]:[this._rect.x+s*this._sw+this._sw/2,this._rect.y+o*this._sh+this._sh/2]},e.prototype.pointToData=function(t){var r=this.pointToDate(t);return r&&r.time},e.prototype.dataToRect=function(t,r){var n=this.dataToPoint(t,r);return{contentShape:{x:n[0]-(this._sw-this._lineWidth)/2,y:n[1]-(this._sh-this._lineWidth)/2,width:this._sw-this._lineWidth,height:this._sh-this._lineWidth},center:n,tl:[n[0]-this._sw/2,n[1]-this._sh/2],tr:[n[0]+this._sw/2,n[1]-this._sh/2],br:[n[0]+this._sw/2,n[1]+this._sh/2],bl:[n[0]-this._sw/2,n[1]+this._sh/2]}},e.prototype.pointToDate=function(t){var r=Math.floor((t[0]-this._rect.x)/this._sw)+1,n=Math.floor((t[1]-this._rect.y)/this._sh)+1,i=this._rangeInfo.range;return this._orient==="vertical"?this._getDateByWeeksAndDay(n,r-1,i):this._getDateByWeeksAndDay(r,n-1,i)},e.prototype.convertToPixel=function(t,r,n){var i=uR(r);return i===this?i.dataToPoint(n):null},e.prototype.convertFromPixel=function(t,r,n){var i=uR(r);return i===this?i.pointToData(n):null},e.prototype.containPoint=function(t){return console.warn("Not implemented."),!1},e.prototype._initRangeOption=function(){var t=this._model.get("range"),r;if(at(t)&&t.length===1&&(t=t[0]),at(t))r=t;else{var n=t.toString();if(/^\d{4}$/.test(n)&&(r=[n+"-01-01",n+"-12-31"]),/^\d{4}[\/|-]\d{1,2}$/.test(n)){var i=this.getDateInfo(n),a=i.date;a.setMonth(a.getMonth()+1);var o=this.getNextNDay(a,-1);r=[i.formatedDate,o.formatedDate]}/^\d{4}[\/|-]\d{1,2}[\/|-]\d{1,2}$/.test(n)&&(r=[n,n])}if(!r)return t;var s=this._getRangeInfo(r);return s.start.time>s.end.time&&r.reverse(),r},e.prototype._getRangeInfo=function(t){var r=[this.getDateInfo(t[0]),this.getDateInfo(t[1])],n;r[0].time>r[1].time&&(n=!0,r.reverse());var i=Math.floor(r[1].time/Dx)-Math.floor(r[0].time/Dx)+1,a=new Date(r[0].time),o=a.getDate(),s=r[1].date.getDate();a.setDate(o+i-1);var l=a.getDate();if(l!==s)for(var u=a.getTime()-r[1].time>0?1:-1;(l=a.getDate())!==s&&(a.getTime()-r[1].time)*u>0;)i-=u,a.setDate(l-u);var h=Math.floor((i+r[0].day+6)/7),f=n?-h+1:h-1;return n&&r.reverse(),{range:[r[0].formatedDate,r[1].formatedDate],start:r[0],end:r[1],allDay:i,weeks:h,nthWeek:f,fweek:r[0].day,lweek:r[1].day}},e.prototype._getDateByWeeksAndDay=function(t,r,n){var i=this._getRangeInfo(n);if(t>i.weeks||t===0&&r<i.fweek||t===i.weeks&&r>i.lweek)return null;var a=(t-1)*7-i.fweek+r,o=new Date(i.start.time);return o.setDate(+i.start.d+a),this.getDateInfo(o)},e.create=function(t,r){var n=[];return t.eachComponent("calendar",function(i){var a=new e(i);n.push(a),i.coordinateSystem=a}),t.eachSeries(function(i){i.get("coordinateSystem")==="calendar"&&(i.coordinateSystem=n[i.get("calendarIndex")||0])}),n},e.dimensions=["time","value"],e}();function uR(e){var t=e.calendarModel,r=e.seriesModel,n=t?t.coordinateSystem:r?r.coordinateSystem:null;return n}function ltt(e){e.registerComponentModel(att),e.registerComponentView(ott),e.registerCoordinateSystem("calendar",stt)}function utt(e,t){var r=e.existing;if(t.id=e.keyInfo.id,!t.type&&r&&(t.type=r.type),t.parentId==null){var n=t.parentOption;n?t.parentId=n.id:r&&(t.parentId=r.parentId)}t.parentOption=null}function hR(e,t){var r;return R(t,function(n){e[n]!=null&&e[n]!=="auto"&&(r=!0)}),r}function htt(e,t,r){var n=rt({},r),i=e[t],a=r.$action||"merge";a==="merge"?i?(Ot(i,n,!0),Bs(i,n,{ignoreSize:!0}),P3(r,i),Wp(r,i),Wp(r,i,"shape"),Wp(r,i,"style"),Wp(r,i,"extra"),r.clipPath=i.clipPath):e[t]=n:a==="replace"?e[t]=n:a==="remove"&&i&&(e[t]=null)}var Zz=["transition","enterFrom","leaveTo"],ftt=Zz.concat(["enterAnimation","updateAnimation","leaveAnimation"]);function Wp(e,t,r){if(r&&(!e[r]&&t[r]&&(e[r]={}),e=e[r],t=t[r]),!(!e||!t))for(var n=r?Zz:ftt,i=0;i<n.length;i++){var a=n[i];e[a]==null&&t[a]!=null&&(e[a]=t[a])}}function ctt(e,t){if(e&&(e.hv=t.hv=[hR(t,["left","right"]),hR(t,["top","bottom"])],e.type==="group")){var r=e,n=t;r.width==null&&(r.width=n.width=0),r.height==null&&(r.height=n.height=0)}}var dtt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.preventAutoZ=!0,r}return t.prototype.mergeOption=function(r,n){var i=this.option.elements;this.option.elements=null,e.prototype.mergeOption.call(this,r,n),this.option.elements=i},t.prototype.optionUpdated=function(r,n){var i=this.option,a=(n?i:r).elements,o=i.elements=n?[]:i.elements,s=[];this._flatten(a,s,null);var l=DO(o,s,"normalMerge"),u=this._elOptionsToUpdate=[];R(l,function(h,f){var c=h.newOption;c&&(u.push(c),utt(h,c),htt(o,f,c),ctt(o[f],c))},this),i.elements=Xe(o,function(h){return h&&delete h.$action,h!=null})},t.prototype._flatten=function(r,n,i){R(r,function(a){if(a){i&&(a.parentOption=i),n.push(a);var o=a.children;o&&o.length&&this._flatten(o,n,a),delete a.children}},this)},t.prototype.useElOptionsToUpdate=function(){var r=this._elOptionsToUpdate;return this._elOptionsToUpdate=null,r},t.type="graphic",t.defaultOption={elements:[]},t}(me),fR={path:null,compoundPath:null,group:re,image:hn,text:we},Ri=Le(),vtt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){this._elMap=Ut()},t.prototype.render=function(r,n,i){r!==this._lastGraphicModel&&this._clear(),this._lastGraphicModel=r,this._updateElements(r),this._relocate(r,i)},t.prototype._updateElements=function(r){var n=r.useElOptionsToUpdate();if(n){var i=this._elMap,a=this.group,o=r.get("z"),s=r.get("zlevel");R(n,function(l){var u=Xr(l.id,null),h=u!=null?i.get(u):null,f=Xr(l.parentId,null),c=f!=null?i.get(f):a,d=l.type,v=l.style;d==="text"&&v&&l.hv&&l.hv[1]&&(v.textVerticalAlign=v.textBaseline=v.verticalAlign=v.align=null);var p=l.textContent,g=l.textConfig;if(v&&Ez(v,d,!!g,!!p)){var m=Cz(v,d,!0);!g&&m.textConfig&&(g=l.textConfig=m.textConfig),!p&&m.textContent&&(p=m.textContent)}var _=ptt(l),y=l.$action||"merge",x=y==="merge",T=y==="replace";if(x){var S=!h,M=h;S?M=cR(u,c,l.type,i):(M&&(Ri(M).isNew=!1),Pz(M)),M&&(Jg(M,_,r,{isInit:S}),dR(M,l,o,s))}else if(T){em(h,l,i,r);var w=cR(u,c,l.type,i);w&&(Jg(w,_,r,{isInit:!0}),dR(w,l,o,s))}else y==="remove"&&(Lz(h,l),em(h,l,i,r));var b=i.get(u);if(b&&p)if(x){var A=b.getTextContent();A?A.attr(p):b.setTextContent(new we(p))}else T&&b.setTextContent(new we(p));if(b){var E=l.clipPath;if(E){var C=E.type,D=void 0,S=!1;if(x){var L=b.getClipPath();S=!L||Ri(L).type!==C,D=S?MT(C):L}else T&&(S=!0,D=MT(C));b.setClipPath(D),Jg(D,E,r,{isInit:S}),qm(D,E.keyframeAnimation,r)}var P=Ri(b);b.setTextConfig(g),P.option=l,gtt(b,r,l),Uu({el:b,componentModel:r,itemName:b.name,itemTooltipOption:l.tooltip}),qm(b,l.keyframeAnimation,r)}})}},t.prototype._relocate=function(r,n){for(var i=r.option.elements,a=this.group,o=this._elMap,s=n.getWidth(),l=n.getHeight(),u=["x","y"],h=0;h<i.length;h++){var f=i[h],c=Xr(f.id,null),d=c!=null?o.get(c):null;if(!(!d||!d.isGroup)){var v=d.parent,p=v===a,g=Ri(d),m=Ri(v);g.width=Tt(g.option.width,p?s:m.width)||0,g.height=Tt(g.option.height,p?l:m.height)||0}}for(var h=i.length-1;h>=0;h--){var f=i[h],c=Xr(f.id,null),d=c!=null?o.get(c):null;if(d){var v=d.parent,m=Ri(v),_=v===a?{width:s,height:l}:{width:m.width,height:m.height},y={},x=W_(d,f,_,null,{hv:f.hv,boundingMode:f.bounding},y);if(!Ri(d).isNew&&x){for(var T=f.transition,S={},M=0;M<u.length;M++){var w=u[M],b=y[w];T&&(gu(T)||pe(T,w)>=0)?S[w]=b:d[w]=b}ke(d,S,r,0)}else d.attr(y)}}},t.prototype._clear=function(){var r=this,n=this._elMap;n.each(function(i){em(i,Ri(i).option,n,r._lastGraphicModel)}),this._elMap=Ut()},t.prototype.dispose=function(){this._clear()},t.type="graphic",t}(nr);function MT(e){var t=Ft(fR,e)?fR[e]:dw(e),r=new t({});return Ri(r).type=e,r}function cR(e,t,r,n){var i=MT(r);return t.add(i),n.set(e,i),Ri(i).id=e,Ri(i).isNew=!0,i}function em(e,t,r,n){var i=e&&e.parent;i&&(e.type==="group"&&e.traverse(function(a){em(a,t,r,n)}),o0(e,t,n),r.removeKey(Ri(e).id))}function dR(e,t,r,n){e.isGroup||R([["cursor",Yi.prototype.cursor],["zlevel",n||0],["z",r||0],["z2",0]],function(i){var a=i[0];Ft(t,a)?e[a]=se(t[a],i[1]):e[a]==null&&(e[a]=i[1])}),R(be(t),function(i){if(i.indexOf("on")===0){var a=t[i];e[i]=Yt(a)?a:null}}),Ft(t,"draggable")&&(e.draggable=t.draggable),t.name!=null&&(e.name=t.name),t.id!=null&&(e.id=t.id)}function ptt(e){return e=rt({},e),R(["id","parentId","$action","hv","bounding","textContent","clipPath"].concat(R3),function(t){delete e[t]}),e}function gtt(e,t,r){var n=oe(e).eventData;!e.silent&&!e.ignore&&!n&&(n=oe(e).eventData={componentType:"graphic",componentIndex:t.componentIndex,name:e.name}),n&&(n.info=r.info)}function mtt(e){e.registerComponentModel(dtt),e.registerComponentView(vtt),e.registerPreprocessor(function(t){var r=t.graphic;at(r)?!r[0]||!r[0].elements?t.graphic=[{elements:r}]:t.graphic=[t.graphic[0]]:r&&!r.elements&&(t.graphic=[{elements:[r]}])})}var vR=["x","y","radius","angle","single"],_tt=["cartesian2d","polar","singleAxis"];function ytt(e){var t=e.get("coordinateSystem");return pe(_tt,t)>=0}function ws(e){return e+"Axis"}function xtt(e,t){var r=Ut(),n=[],i=Ut();e.eachComponent({mainType:"dataZoom",query:t},function(h){i.get(h.uid)||s(h)});var a;do a=!1,e.eachComponent("dataZoom",o);while(a);function o(h){!i.get(h.uid)&&l(h)&&(s(h),a=!0)}function s(h){i.set(h.uid,!0),n.push(h),u(h)}function l(h){var f=!1;return h.eachTargetAxis(function(c,d){var v=r.get(c);v&&v[d]&&(f=!0)}),f}function u(h){h.eachTargetAxis(function(f,c){(r.get(f)||r.set(f,[]))[c]=!0})}return n}function qz(e){var t=e.ecModel,r={infoList:[],infoMap:Ut()};return e.eachTargetAxis(function(n,i){var a=t.getComponent(ws(n),i);if(a){var o=a.getCoordSysModel();if(o){var s=o.uid,l=r.infoMap.get(s);l||(l={model:o,axisModels:[]},r.infoList.push(l),r.infoMap.set(s,l)),l.axisModels.push(a)}}}),r}var Lx=function(){function e(){this.indexList=[],this.indexMap=[]}return e.prototype.add=function(t){this.indexMap[t]||(this.indexList.push(t),this.indexMap[t]=!0)},e}(),iv=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._autoThrottle=!0,r._noTarget=!0,r._rangePropMode=["percent","percent"],r}return t.prototype.init=function(r,n,i){var a=pR(r);this.settledOption=a,this.mergeDefaultAndTheme(r,i),this._doInit(a)},t.prototype.mergeOption=function(r){var n=pR(r);Ot(this.option,r,!0),Ot(this.settledOption,n,!0),this._doInit(n)},t.prototype._doInit=function(r){var n=this.option;this._setDefaultThrottle(r),this._updateRangeUse(r);var i=this.settledOption;R([["start","startValue"],["end","endValue"]],function(a,o){this._rangePropMode[o]==="value"&&(n[a[0]]=i[a[0]]=null)},this),this._resetTarget()},t.prototype._resetTarget=function(){var r=this.get("orient",!0),n=this._targetAxisInfoMap=Ut(),i=this._fillSpecifiedTargetAxis(n);i?this._orient=r||this._makeAutoOrientByTargetAxis():(this._orient=r||"horizontal",this._fillAutoTargetAxisByOrient(n,this._orient)),this._noTarget=!0,n.each(function(a){a.indexList.length&&(this._noTarget=!1)},this)},t.prototype._fillSpecifiedTargetAxis=function(r){var n=!1;return R(vR,function(i){var a=this.getReferringComponents(ws(i),y5);if(a.specified){n=!0;var o=new Lx;R(a.models,function(s){o.add(s.componentIndex)}),r.set(i,o)}},this),n},t.prototype._fillAutoTargetAxisByOrient=function(r,n){var i=this.ecModel,a=!0;if(a){var o=n==="vertical"?"y":"x",s=i.findComponents({mainType:o+"Axis"});l(s,o)}if(a){var s=i.findComponents({mainType:"singleAxis",filter:function(h){return h.get("orient",!0)===n}});l(s,"single")}function l(u,h){var f=u[0];if(f){var c=new Lx;if(c.add(f.componentIndex),r.set(h,c),a=!1,h==="x"||h==="y"){var d=f.getReferringComponents("grid",zr).models[0];d&&R(u,function(v){f.componentIndex!==v.componentIndex&&d===v.getReferringComponents("grid",zr).models[0]&&c.add(v.componentIndex)})}}}a&&R(vR,function(u){if(a){var h=i.findComponents({mainType:ws(u),filter:function(c){return c.get("type",!0)==="category"}});if(h[0]){var f=new Lx;f.add(h[0].componentIndex),r.set(u,f),a=!1}}},this)},t.prototype._makeAutoOrientByTargetAxis=function(){var r;return this.eachTargetAxis(function(n){!r&&(r=n)},this),r==="y"?"vertical":"horizontal"},t.prototype._setDefaultThrottle=function(r){if(r.hasOwnProperty("throttle")&&(this._autoThrottle=!1),this._autoThrottle){var n=this.ecModel.option;this.option.throttle=n.animation&&n.animationDurationUpdate>0?100:20}},t.prototype._updateRangeUse=function(r){var n=this._rangePropMode,i=this.get("rangeMode");R([["start","startValue"],["end","endValue"]],function(a,o){var s=r[a[0]]!=null,l=r[a[1]]!=null;s&&!l?n[o]="percent":!s&&l?n[o]="value":i?n[o]=i[o]:s&&(n[o]="percent")})},t.prototype.noTarget=function(){return this._noTarget},t.prototype.getFirstTargetAxisModel=function(){var r;return this.eachTargetAxis(function(n,i){r==null&&(r=this.ecModel.getComponent(ws(n),i))},this),r},t.prototype.eachTargetAxis=function(r,n){this._targetAxisInfoMap.each(function(i,a){R(i.indexList,function(o){r.call(n,a,o)})})},t.prototype.getAxisProxy=function(r,n){var i=this.getAxisModel(r,n);if(i)return i.__dzAxisProxy},t.prototype.getAxisModel=function(r,n){var i=this._targetAxisInfoMap.get(r);if(i&&i.indexMap[n])return this.ecModel.getComponent(ws(r),n)},t.prototype.setRawRange=function(r){var n=this.option,i=this.settledOption;R([["start","startValue"],["end","endValue"]],function(a){(r[a[0]]!=null||r[a[1]]!=null)&&(n[a[0]]=i[a[0]]=r[a[0]],n[a[1]]=i[a[1]]=r[a[1]])},this),this._updateRangeUse(r)},t.prototype.setCalculatedRange=function(r){var n=this.option;R(["start","startValue","end","endValue"],function(i){n[i]=r[i]})},t.prototype.getPercentRange=function(){var r=this.findRepresentativeAxisProxy();if(r)return r.getDataPercentWindow()},t.prototype.getValueRange=function(r,n){if(r==null&&n==null){var i=this.findRepresentativeAxisProxy();if(i)return i.getDataValueWindow()}else return this.getAxisProxy(r,n).getDataValueWindow()},t.prototype.findRepresentativeAxisProxy=function(r){if(r)return r.__dzAxisProxy;for(var n,i=this._targetAxisInfoMap.keys(),a=0;a<i.length;a++)for(var o=i[a],s=this._targetAxisInfoMap.get(o),l=0;l<s.indexList.length;l++){var u=this.getAxisProxy(o,s.indexList[l]);if(u.hostedBy(this))return u;n||(n=u)}return n},t.prototype.getRangePropMode=function(){return this._rangePropMode.slice()},t.prototype.getOrient=function(){return this._orient},t.type="dataZoom",t.dependencies=["xAxis","yAxis","radiusAxis","angleAxis","singleAxis","series","toolbox"],t.defaultOption={z:4,filterMode:"filter",start:0,end:100},t}(me);function pR(e){var t={};return R(["start","end","startValue","endValue","throttle"],function(r){e.hasOwnProperty(r)&&(t[r]=e[r])}),t}var Stt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.select",t}(iv),HM=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i,a){this.dataZoomModel=r,this.ecModel=n,this.api=i},t.type="dataZoom",t}(nr),Ttt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.select",t}(HM),Gh=R,gR=ki,btt=function(){function e(t,r,n,i){this._dimName=t,this._axisIndex=r,this.ecModel=i,this._dataZoomModel=n}return e.prototype.hostedBy=function(t){return this._dataZoomModel===t},e.prototype.getDataValueWindow=function(){return this._valueWindow.slice()},e.prototype.getDataPercentWindow=function(){return this._percentWindow.slice()},e.prototype.getTargetSeriesModels=function(){var t=[];return this.ecModel.eachSeries(function(r){if(ytt(r)){var n=ws(this._dimName),i=r.getReferringComponents(n,zr).models[0];i&&this._axisIndex===i.componentIndex&&t.push(r)}},this),t},e.prototype.getAxisModel=function(){return this.ecModel.getComponent(this._dimName+"Axis",this._axisIndex)},e.prototype.getMinMaxSpan=function(){return Qt(this._minMaxSpan)},e.prototype.calculateDataWindow=function(t){var r=this._dataExtent,n=this.getAxisModel(),i=n.axis.scale,a=this._dataZoomModel.getRangePropMode(),o=[0,100],s=[],l=[],u;Gh(["start","end"],function(c,d){var v=t[c],p=t[c+"Value"];a[d]==="percent"?(v==null&&(v=o[d]),p=i.parse(He(v,o,r))):(u=!0,p=p==null?r[d]:i.parse(p),v=He(p,r,o)),l[d]=p==null||isNaN(p)?r[d]:p,s[d]=v==null||isNaN(v)?o[d]:v}),gR(l),gR(s);var h=this._minMaxSpan;u?f(l,s,r,o,!1):f(s,l,o,r,!0);function f(c,d,v,p,g){var m=g?"Span":"ValueSpan";Wu(0,c,v,"all",h["min"+m],h["max"+m]);for(var _=0;_<2;_++)d[_]=He(c[_],v,p,!0),g&&(d[_]=i.parse(d[_]))}return{valueWindow:l,percentWindow:s}},e.prototype.reset=function(t){if(t===this._dataZoomModel){var r=this.getTargetSeriesModels();this._dataExtent=wtt(this,this._dimName,r),this._updateMinMaxSpan();var n=this.calculateDataWindow(t.settledOption);this._valueWindow=n.valueWindow,this._percentWindow=n.percentWindow,this._setAxisModel()}},e.prototype.filterData=function(t,r){if(t!==this._dataZoomModel)return;var n=this._dimName,i=this.getTargetSeriesModels(),a=t.get("filterMode"),o=this._valueWindow;if(a==="none")return;Gh(i,function(l){var u=l.getData(),h=u.mapDimensionsAll(n);if(h.length){if(a==="weakFilter"){var f=u.getStore(),c=ft(h,function(d){return u.getDimensionIndex(d)},u);u.filterSelf(function(d){for(var v,p,g,m=0;m<h.length;m++){var _=f.get(c[m],d),y=!isNaN(_),x=_<o[0],T=_>o[1];if(y&&!x&&!T)return!0;y&&(g=!0),x&&(v=!0),T&&(p=!0)}return g&&v&&p})}else Gh(h,function(d){if(a==="empty")l.setData(u=u.map(d,function(p){return s(p)?p:NaN}));else{var v={};v[d]=o,u.selectRange(v)}});Gh(h,function(d){u.setApproximateExtent(o,d)})}});function s(l){return l>=o[0]&&l<=o[1]}},e.prototype._updateMinMaxSpan=function(){var t=this._minMaxSpan={},r=this._dataZoomModel,n=this._dataExtent;Gh(["min","max"],function(i){var a=r.get(i+"Span"),o=r.get(i+"ValueSpan");o!=null&&(o=this.getAxisModel().axis.scale.parse(o)),o!=null?a=He(n[0]+o,n,[0,100],!0):a!=null&&(o=He(a,[0,100],n,!0)-n[0]),t[i+"Span"]=a,t[i+"ValueSpan"]=o},this)},e.prototype._setAxisModel=function(){var t=this.getAxisModel(),r=this._percentWindow,n=this._valueWindow;if(r){var i=SO(n,[0,500]);i=Math.min(i,20);var a=t.axis.scale.rawExtentInfo;r[0]!==0&&a.setDeterminedMinMax("min",+n[0].toFixed(i)),r[1]!==100&&a.setDeterminedMinMax("max",+n[1].toFixed(i)),a.freeze()}},e}();function wtt(e,t,r){var n=[1/0,-1/0];Gh(r,function(o){s9(n,o.getData(),t)});var i=e.getAxisModel(),a=lB(i.axis.scale,i,n).calculate();return[a.min,a.max]}var Mtt={getTargetSeries:function(e){function t(i){e.eachComponent("dataZoom",function(a){a.eachTargetAxis(function(o,s){var l=e.getComponent(ws(o),s);i(o,s,l,a)})})}t(function(i,a,o,s){o.__dzAxisProxy=null});var r=[];t(function(i,a,o,s){o.__dzAxisProxy||(o.__dzAxisProxy=new btt(i,a,s,e),r.push(o.__dzAxisProxy))});var n=Ut();return R(r,function(i){R(i.getTargetSeriesModels(),function(a){n.set(a.uid,a)})}),n},overallReset:function(e,t){e.eachComponent("dataZoom",function(r){r.eachTargetAxis(function(n,i){r.getAxisProxy(n,i).reset(r)}),r.eachTargetAxis(function(n,i){r.getAxisProxy(n,i).filterData(r,t)})}),e.eachComponent("dataZoom",function(r){var n=r.findRepresentativeAxisProxy();if(n){var i=n.getDataPercentWindow(),a=n.getDataValueWindow();r.setCalculatedRange({start:i[0],end:i[1],startValue:a[0],endValue:a[1]})}})}};function Att(e){e.registerAction("dataZoom",function(t,r){var n=xtt(r,t);R(n,function(i){i.setRawRange({start:t.start,end:t.end,startValue:t.startValue,endValue:t.endValue})})})}var mR=!1;function WM(e){mR||(mR=!0,e.registerProcessor(e.PRIORITY.PROCESSOR.FILTER,Mtt),Att(e),e.registerSubTypeDefaulter("dataZoom",function(){return"slider"}))}function Ett(e){e.registerComponentModel(Stt),e.registerComponentView(Ttt),WM(e)}var Ni=function(){function e(){}return e}(),$z={};function Vh(e,t){$z[e]=t}function Kz(e){return $z[e]}var Ctt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(){e.prototype.optionUpdated.apply(this,arguments);var r=this.ecModel;R(this.option.feature,function(n,i){var a=Kz(i);a&&(a.getDefaultOption&&(a.defaultOption=a.getDefaultOption(r)),Ot(n,a.defaultOption))})},t.type="toolbox",t.layoutMode={type:"box",ignoreSize:!0},t.defaultOption={show:!0,z:6,orient:"horizontal",left:"right",top:"top",backgroundColor:"transparent",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemSize:15,itemGap:8,showTitle:!0,iconStyle:{borderColor:"#666",color:"none"},emphasis:{iconStyle:{borderColor:"#3E98C5"}},tooltip:{show:!1,position:"bottom"}},t}(me);function Dtt(e,t,r){var n=t.getBoxLayoutParams(),i=t.get("padding"),a={width:r.getWidth(),height:r.getHeight()},o=Mr(n,a,i);vu(t.get("orient"),e,t.get("itemGap"),o.width,o.height),W_(e,n,a,i)}function jz(e,t){var r=Hf(t.get("padding")),n=t.getItemStyle(["color","opacity"]);return n.fill=t.get("backgroundColor"),e=new Ae({shape:{x:e.x-r[3],y:e.y-r[0],width:e.width+r[1]+r[3],height:e.height+r[0]+r[2],r:t.get("borderRadius")},style:n,silent:!0,z2:-1}),e}var Ltt=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(r,n,i,a){var o=this.group;if(o.removeAll(),!r.get("show"))return;var s=+r.get("itemSize"),l=r.get("orient")==="vertical",u=r.get("feature")||{},h=this._features||(this._features={}),f=[];R(u,function(v,p){f.push(p)}),new No(this._featureNames||[],f).add(c).update(c).remove(ue(c,null)).execute(),this._featureNames=f;function c(v,p){var g=f[v],m=f[p],_=u[g],y=new Ie(_,r,r.ecModel),x;if(a&&a.newTitle!=null&&a.featureName===g&&(_.title=a.newTitle),g&&!m){if(Rtt(g))x={onclick:y.option.onclick,featureName:g};else{var T=Kz(g);if(!T)return;x=new T}h[g]=x}else if(x=h[m],!x)return;x.uid=Vf("toolbox-feature"),x.model=y,x.ecModel=n,x.api=i;var S=x instanceof Ni;if(!g&&m){S&&x.dispose&&x.dispose(n,i);return}if(!y.get("show")||S&&x.unusable){S&&x.remove&&x.remove(n,i);return}d(y,x,g),y.setIconStatus=function(M,w){var b=this.option,A=this.iconPaths;b.iconStatus=b.iconStatus||{},b.iconStatus[M]=w,A[M]&&(w==="emphasis"?Po:Io)(A[M])},x instanceof Ni&&x.render&&x.render(y,n,i,a)}function d(v,p,g){var m=v.getModel("iconStyle"),_=v.getModel(["emphasis","iconStyle"]),y=p instanceof Ni&&p.getIcons?p.getIcons():v.get("icon"),x=v.get("title")||{},T,S;Ct(y)?(T={},T[g]=y):T=y,Ct(x)?(S={},S[g]=x):S=x;var M=v.iconPaths={};R(T,function(w,b){var A=Mv(w,{},{x:-s/2,y:-s/2,width:s,height:s});A.setStyle(m.getItemStyle());var E=A.ensureState("emphasis");E.style=_.getItemStyle();var C=new we({style:{text:S[b],align:_.get("textAlign"),borderRadius:_.get("textBorderRadius"),padding:_.get("textPadding"),fill:null,font:vw({fontStyle:_.get("textFontStyle"),fontFamily:_.get("textFontFamily"),fontSize:_.get("textFontSize"),fontWeight:_.get("textFontWeight")},n)},ignore:!0});A.setTextContent(C),Uu({el:A,componentModel:r,itemName:b,formatterParamsExtra:{title:S[b]}}),A.__title=S[b],A.on("mouseover",function(){var D=_.getItemStyle(),L=l?r.get("right")==null&&r.get("left")!=="right"?"right":"left":r.get("bottom")==null&&r.get("top")!=="bottom"?"bottom":"top";C.setStyle({fill:_.get("textFill")||D.fill||D.stroke||"#000",backgroundColor:_.get("textBackgroundColor")}),A.setTextConfig({position:_.get("textPosition")||L}),C.ignore=!r.get("showTitle"),i.enterEmphasis(this)}).on("mouseout",function(){v.get(["iconStatus",b])!=="emphasis"&&i.leaveEmphasis(this),C.hide()}),(v.get(["iconStatus",b])==="emphasis"?Po:Io)(A),o.add(A),A.on("click",It(p.onclick,p,n,i,b)),M[b]=A})}Dtt(o,r,i),o.add(jz(o.getBoundingRect(),r)),l||o.eachChild(function(v){var p=v.__title,g=v.ensureState("emphasis"),m=g.textConfig||(g.textConfig={}),_=v.getTextContent(),y=_&&_.ensureState("emphasis");if(y&&!Yt(y)&&p){var x=y.style||(y.style={}),T=_v(p,we.makeFont(x)),S=v.x+o.x,M=v.y+o.y+s,w=!1;M+T.height>i.getHeight()&&(m.position="top",w=!0);var b=w?-5-T.height:s+10;S+T.width/2>i.getWidth()?(m.position=["100%",b],x.align="right"):S-T.width/2<0&&(m.position=[0,b],x.align="left")}})},t.prototype.updateView=function(r,n,i,a){R(this._features,function(o){o instanceof Ni&&o.updateView&&o.updateView(o.model,n,i,a)})},t.prototype.remove=function(r,n){R(this._features,function(i){i instanceof Ni&&i.remove&&i.remove(r,n)}),this.group.removeAll()},t.prototype.dispose=function(r,n){R(this._features,function(i){i instanceof Ni&&i.dispose&&i.dispose(r,n)})},t.type="toolbox",t}(nr);function Rtt(e){return e.indexOf("my")===0}var Ptt=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.onclick=function(r,n){var i=this.model,a=i.get("name")||r.get("title.0.text")||"echarts",o=n.getZr().painter.getType()==="svg",s=o?"svg":i.get("type",!0)||"png",l=n.getConnectedDataURL({type:s,backgroundColor:i.get("backgroundColor",!0)||r.get("backgroundColor")||"#fff",connectedBackgroundColor:i.get("connectedBackgroundColor"),excludeComponents:i.get("excludeComponents"),pixelRatio:i.get("pixelRatio")}),u=ye.browser;if(typeof MouseEvent=="function"&&(u.newEdge||!u.ie&&!u.edge)){var h=document.createElement("a");h.download=a+"."+s,h.target="_blank",h.href=l;var f=new MouseEvent("click",{view:document.defaultView,bubbles:!0,cancelable:!1});h.dispatchEvent(f)}else if(window.navigator.msSaveOrOpenBlob||o){var c=l.split(","),d=c[0].indexOf("base64")>-1,v=o?decodeURIComponent(c[1]):c[1];d&&(v=window.atob(v));var p=a+"."+s;if(window.navigator.msSaveOrOpenBlob){for(var g=v.length,m=new Uint8Array(g);g--;)m[g]=v.charCodeAt(g);var _=new Blob([m]);window.navigator.msSaveOrOpenBlob(_,p)}else{var y=document.createElement("iframe");document.body.appendChild(y);var x=y.contentWindow,T=x.document;T.open("image/svg+xml","replace"),T.write(v),T.close(),x.focus(),T.execCommand("SaveAs",!0,p),document.body.removeChild(y)}}else{var S=i.get("lang"),M='<body style="margin:0;"><img src="'+l+'" style="max-width:100%;" title="'+(S&&S[0]||"")+'" /></body>',w=window.open();w.document.write(M),w.document.title=a}},t.getDefaultOption=function(r){var n={show:!0,icon:"M4.7,22.9L29.3,45.5L54.7,23.4M4.6,43.6L4.6,58L53.8,58L53.8,43.6M29.2,45.1L29.2,0",title:r.getLocaleModel().get(["toolbox","saveAsImage","title"]),type:"png",connectedBackgroundColor:"#fff",name:"",excludeComponents:["toolbox"],lang:r.getLocaleModel().get(["toolbox","saveAsImage","lang"])};return n},t}(Ni),_R="__ec_magicType_stack__",Itt=[["line","bar"],["stack"]],Ntt=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.getIcons=function(){var r=this.model,n=r.get("icon"),i={};return R(r.get("type"),function(a){n[a]&&(i[a]=n[a])}),i},t.getDefaultOption=function(r){var n={show:!0,type:[],icon:{line:"M4.1,28.9h7.1l9.3-22l7.4,38l9.7-19.7l3,12.8h14.9M4.1,58h51.4",bar:"M6.7,22.9h10V48h-10V22.9zM24.9,13h10v35h-10V13zM43.2,2h10v46h-10V2zM3.1,58h53.7",stack:"M8.2,38.4l-8.4,4.1l30.6,15.3L60,42.5l-8.1-4.1l-21.5,11L8.2,38.4z M51.9,30l-8.1,4.2l-13.4,6.9l-13.9-6.9L8.2,30l-8.4,4.2l8.4,4.2l22.2,11l21.5-11l8.1-4.2L51.9,30z M51.9,21.7l-8.1,4.2L35.7,30l-5.3,2.8L24.9,30l-8.4-4.1l-8.3-4.2l-8.4,4.2L8.2,30l8.3,4.2l13.9,6.9l13.4-6.9l8.1-4.2l8.1-4.1L51.9,21.7zM30.4,2.2L-0.2,17.5l8.4,4.1l8.3,4.2l8.4,4.2l5.5,2.7l5.3-2.7l8.1-4.2l8.1-4.2l8.1-4.1L30.4,2.2z"},title:r.getLocaleModel().get(["toolbox","magicType","title"]),option:{},seriesIndex:{}};return n},t.prototype.onclick=function(r,n,i){var a=this.model,o=a.get(["seriesIndex",i]);if(yR[i]){var s={series:[]},l=function(f){var c=f.subType,d=f.id,v=yR[i](c,d,f,a);v&&(Vt(v,f.option),s.series.push(v));var p=f.coordinateSystem;if(p&&p.type==="cartesian2d"&&(i==="line"||i==="bar")){var g=p.getAxesByScale("ordinal")[0];if(g){var m=g.dim,_=m+"Axis",y=f.getReferringComponents(_,zr).models[0],x=y.componentIndex;s[_]=s[_]||[];for(var T=0;T<=x;T++)s[_][x]=s[_][x]||{};s[_][x].boundaryGap=i==="bar"}}};R(Itt,function(f){pe(f,i)>=0&&R(f,function(c){a.setIconStatus(c,"normal")})}),a.setIconStatus(i,"emphasis"),r.eachComponent({mainType:"series",query:o==null?null:{seriesIndex:o}},l);var u,h=i;i==="stack"&&(u=Ot({stack:a.option.title.tiled,tiled:a.option.title.stack},a.option.title),a.get(["iconStatus",i])!=="emphasis"&&(h="tiled")),n.dispatchAction({type:"changeMagicType",currentType:h,newOption:s,newTitle:u,featureName:"magicType"})}},t}(Ni),yR={line:function(e,t,r,n){if(e==="bar")return Ot({id:t,type:"line",data:r.get("data"),stack:r.get("stack"),markPoint:r.get("markPoint"),markLine:r.get("markLine")},n.get(["option","line"])||{},!0)},bar:function(e,t,r,n){if(e==="line")return Ot({id:t,type:"bar",data:r.get("data"),stack:r.get("stack"),markPoint:r.get("markPoint"),markLine:r.get("markLine")},n.get(["option","bar"])||{},!0)},stack:function(e,t,r,n){var i=r.get("stack")===_R;if(e==="line"||e==="bar")return n.setIconStatus("stack",i?"normal":"emphasis"),Ot({id:t,stack:i?"":_R},n.get(["option","stack"])||{},!0)}};Ja({type:"changeMagicType",event:"magicTypeChanged",update:"prepareAndUpdate"},function(e,t){t.mergeOption(e.newOption)});var s0=new Array(60).join("-"),_f="	";function Ott(e){var t={},r=[],n=[];return e.eachRawSeries(function(i){var a=i.coordinateSystem;if(a&&(a.type==="cartesian2d"||a.type==="polar")){var o=a.getBaseAxis();if(o.type==="category"){var s=o.dim+"_"+o.index;t[s]||(t[s]={categoryAxis:o,valueAxis:a.getOtherAxis(o),series:[]},n.push({axisDim:o.dim,axisIndex:o.index})),t[s].series.push(i)}else r.push(i)}else r.push(i)}),{seriesGroupByCategoryAxis:t,other:r,meta:n}}function Ftt(e){var t=[];return R(e,function(r,n){var i=r.categoryAxis,a=r.valueAxis,o=a.dim,s=[" "].concat(ft(r.series,function(d){return d.name})),l=[i.model.getCategories()];R(r.series,function(d){var v=d.getRawData();l.push(d.getRawData().mapArray(v.mapDimension(o),function(p){return p}))});for(var u=[s.join(_f)],h=0;h<l[0].length;h++){for(var f=[],c=0;c<l.length;c++)f.push(l[c][h]);u.push(f.join(_f))}t.push(u.join(`
`))}),t.join(`

`+s0+`

`)}function Btt(e){return ft(e,function(t){var r=t.getRawData(),n=[t.name],i=[];return r.each(r.dimensions,function(){for(var a=arguments.length,o=arguments[a-1],s=r.getName(o),l=0;l<a-1;l++)i[l]=arguments[l];n.push((s?s+_f:"")+i.join(_f))}),n.join(`
`)}).join(`

`+s0+`

`)}function Utt(e){var t=Ott(e);return{value:Xe([Ftt(t.seriesGroupByCategoryAxis),Btt(t.other)],function(r){return!!r.replace(/[\n\t\s]/g,"")}).join(`

`+s0+`

`),meta:t.meta}}function jm(e){return e.replace(/^\s\s*/,"").replace(/\s\s*$/,"")}function ztt(e){var t=e.slice(0,e.indexOf(`
`));if(t.indexOf(_f)>=0)return!0}var AT=new RegExp("["+_f+"]+","g");function ktt(e){for(var t=e.split(/\n+/g),r=jm(t.shift()).split(AT),n=[],i=ft(r,function(l){return{name:l,data:[]}}),a=0;a<t.length;a++){var o=jm(t[a]).split(AT);n.push(o.shift());for(var s=0;s<o.length;s++)i[s]&&(i[s].data[a]=o[s])}return{series:i,categories:n}}function Gtt(e){for(var t=e.split(/\n+/g),r=jm(t.shift()),n=[],i=0;i<t.length;i++){var a=jm(t[i]);if(a){var o=a.split(AT),s="",l=void 0,u=!1;isNaN(o[0])?(u=!0,s=o[0],o=o.slice(1),n[i]={name:s,value:[]},l=n[i].value):l=n[i]=[];for(var h=0;h<o.length;h++)l.push(+o[h]);l.length===1&&(u?n[i].value=l[0]:n[i]=l[0])}}return{name:r,data:n}}function Vtt(e,t){var r=e.split(new RegExp(`
*`+s0+`
*`,"g")),n={series:[]};return R(r,function(i,a){if(ztt(i)){var o=ktt(i),s=t[a],l=s.axisDim+"Axis";s&&(n[l]=n[l]||[],n[l][s.axisIndex]={data:o.categories},n.series=n.series.concat(o.series))}else{var o=Gtt(i);n.series.push(o)}}),n}var Htt=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.onclick=function(r,n){setTimeout(function(){n.dispatchAction({type:"hideTip"})});var i=n.getDom(),a=this.model;this._dom&&i.removeChild(this._dom);var o=document.createElement("div");o.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;padding:5px",o.style.backgroundColor=a.get("backgroundColor")||"#fff";var s=document.createElement("h4"),l=a.get("lang")||[];s.innerHTML=l[0]||a.get("title"),s.style.cssText="margin:10px 20px",s.style.color=a.get("textColor");var u=document.createElement("div"),h=document.createElement("textarea");u.style.cssText="overflow:auto";var f=a.get("optionToContent"),c=a.get("contentToOption"),d=Utt(r);if(Yt(f)){var v=f(n.getOption());Ct(v)?u.innerHTML=v:lf(v)&&u.appendChild(v)}else{h.readOnly=a.get("readOnly");var p=h.style;p.cssText="display:block;width:100%;height:100%;font-family:monospace;font-size:14px;line-height:1.6rem;resize:none;box-sizing:border-box;outline:none",p.color=a.get("textColor"),p.borderColor=a.get("textareaBorderColor"),p.backgroundColor=a.get("textareaColor"),h.value=d.value,u.appendChild(h)}var g=d.meta,m=document.createElement("div");m.style.cssText="position:absolute;bottom:5px;left:0;right:0";var _="float:right;margin-right:20px;border:none;cursor:pointer;padding:2px 5px;font-size:12px;border-radius:3px",y=document.createElement("div"),x=document.createElement("div");_+=";background-color:"+a.get("buttonColor"),_+=";color:"+a.get("buttonTextColor");var T=this;function S(){i.removeChild(o),T._dom=null}iS(y,"click",S),iS(x,"click",function(){if(c==null&&f!=null||c!=null&&f==null){S();return}var M;try{Yt(c)?M=c(u,n.getOption()):M=Vtt(h.value,g)}catch(w){throw S(),new Error("Data view format error "+w)}M&&n.dispatchAction({type:"changeDataView",newOption:M}),S()}),y.innerHTML=l[1],x.innerHTML=l[2],x.style.cssText=y.style.cssText=_,!a.get("readOnly")&&m.appendChild(x),m.appendChild(y),o.appendChild(s),o.appendChild(u),o.appendChild(m),u.style.height=i.clientHeight-80+"px",i.appendChild(o),this._dom=o},t.prototype.remove=function(r,n){this._dom&&n.getDom().removeChild(this._dom)},t.prototype.dispose=function(r,n){this.remove(r,n)},t.getDefaultOption=function(r){var n={show:!0,readOnly:!1,optionToContent:null,contentToOption:null,icon:"M17.5,17.3H33 M17.5,17.3H33 M45.4,29.5h-28 M11.5,2v56H51V14.8L38.4,2H11.5z M38.4,2.2v12.7H51 M45.4,41.7h-28",title:r.getLocaleModel().get(["toolbox","dataView","title"]),lang:r.getLocaleModel().get(["toolbox","dataView","lang"]),backgroundColor:"#fff",textColor:"#000",textareaColor:"#fff",textareaBorderColor:"#333",buttonColor:"#c23531",buttonTextColor:"#fff"};return n},t}(Ni);function Wtt(e,t){return ft(e,function(r,n){var i=t&&t[n];if(Kt(i)&&!at(i)){var a=Kt(r)&&!at(r);a||(r={value:r});var o=i.name!=null&&r.name==null;return r=Vt(r,i),o&&delete r.name,r}else return r})}Ja({type:"changeDataView",event:"dataViewChanged",update:"prepareAndUpdate"},function(e,t){var r=[];R(e.newOption.series,function(n){var i=t.getSeriesByName(n.name)[0];if(!i)r.push(rt({type:"scatter"},n));else{var a=i.get("data");r.push({name:n.name,data:Wtt(n.data,a)})}}),t.mergeOption(Vt({series:r},e.newOption))});var Jz=R,Qz=Le();function Xtt(e,t){var r=XM(e);Jz(t,function(n,i){for(var a=r.length-1;a>=0;a--){var o=r[a];if(o[i])break}if(a<0){var s=e.queryComponents({mainType:"dataZoom",subType:"select",id:i})[0];if(s){var l=s.getPercentRange();r[0][i]={dataZoomId:i,start:l[0],end:l[1]}}}}),r.push(t)}function Ytt(e){var t=XM(e),r=t[t.length-1];t.length>1&&t.pop();var n={};return Jz(r,function(i,a){for(var o=t.length-1;o>=0;o--)if(i=t[o][a],i){n[a]=i;break}}),n}function Ztt(e){Qz(e).snapshots=null}function qtt(e){return XM(e).length}function XM(e){var t=Qz(e);return t.snapshots||(t.snapshots=[{}]),t.snapshots}var $tt=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.onclick=function(r,n){Ztt(r),n.dispatchAction({type:"restore",from:this.uid})},t.getDefaultOption=function(r){var n={show:!0,icon:"M3.8,33.4 M47,18.9h9.8V8.7 M56.3,20.1 C52.1,9,40.5,0.6,26.8,2.1C12.6,3.7,1.6,16.2,2.1,30.6 M13,41.1H3.1v10.2 M3.7,39.9c4.2,11.1,15.8,19.5,29.5,18 c14.2-1.6,25.2-14.1,24.7-28.5",title:r.getLocaleModel().get(["toolbox","restore","title"])};return n},t}(Ni);Ja({type:"restore",event:"restore",update:"prepareAndUpdate"},function(e,t){t.resetOption("recreate")});var Ktt=["grid","xAxis","yAxis","geo","graph","polar","radiusAxis","angleAxis","bmap"],YM=function(){function e(t,r,n){var i=this;this._targetInfoList=[];var a=xR(r,t);R(jtt,function(o,s){(!n||!n.include||pe(n.include,s)>=0)&&o(a,i._targetInfoList)})}return e.prototype.setOutputRanges=function(t,r){return this.matchOutputRanges(t,r,function(n,i,a){if((n.coordRanges||(n.coordRanges=[])).push(i),!n.coordRange){n.coordRange=i;var o=Rx[n.brushType](0,a,i);n.__rangeOffset={offset:wR[n.brushType](o.values,n.range,[1,1]),xyMinMax:o.xyMinMax}}}),t},e.prototype.matchOutputRanges=function(t,r,n){R(t,function(i){var a=this.findTargetInfo(i,r);a&&a!==!0&&R(a.coordSyses,function(o){var s=Rx[i.brushType](1,o,i.range,!0);n(i,s.values,o,r)})},this)},e.prototype.setInputRanges=function(t,r){R(t,function(n){var i=this.findTargetInfo(n,r);if(n.range=n.range||[],i&&i!==!0){n.panelId=i.panelId;var a=Rx[n.brushType](0,i.coordSys,n.coordRange),o=n.__rangeOffset;n.range=o?wR[n.brushType](a.values,o.offset,Jtt(a.xyMinMax,o.xyMinMax)):a.values}},this)},e.prototype.makePanelOpts=function(t,r){return ft(this._targetInfoList,function(n){var i=n.getPanelRect();return{panelId:n.panelId,defaultBrushType:r?r(n):null,clipPath:sz(i),isTargetByCursor:uz(i,t,n.coordSysModel),getLinearBrushOtherExtent:lz(i)}})},e.prototype.controlSeries=function(t,r,n){var i=this.findTargetInfo(t,n);return i===!0||i&&pe(i.coordSyses,r.coordinateSystem)>=0},e.prototype.findTargetInfo=function(t,r){for(var n=this._targetInfoList,i=xR(r,t),a=0;a<n.length;a++){var o=n[a],s=t.panelId;if(s){if(o.panelId===s)return o}else for(var l=0;l<SR.length;l++)if(SR[l](i,o))return o}return!0},e}();function ET(e){return e[0]>e[1]&&e.reverse(),e}function xR(e,t){return xd(e,t,{includeMainTypes:Ktt})}var jtt={grid:function(e,t){var r=e.xAxisModels,n=e.yAxisModels,i=e.gridModels,a=Ut(),o={},s={};!r&&!n&&!i||(R(r,function(l){var u=l.axis.grid.model;a.set(u.id,u),o[u.id]=!0}),R(n,function(l){var u=l.axis.grid.model;a.set(u.id,u),s[u.id]=!0}),R(i,function(l){a.set(l.id,l),o[l.id]=!0,s[l.id]=!0}),a.each(function(l){var u=l.coordinateSystem,h=[];R(u.getCartesians(),function(f,c){(pe(r,f.getAxis("x").model)>=0||pe(n,f.getAxis("y").model)>=0)&&h.push(f)}),t.push({panelId:"grid--"+l.id,gridModel:l,coordSysModel:l,coordSys:h[0],coordSyses:h,getPanelRect:TR.grid,xAxisDeclared:o[l.id],yAxisDeclared:s[l.id]})}))},geo:function(e,t){R(e.geoModels,function(r){var n=r.coordinateSystem;t.push({panelId:"geo--"+r.id,geoModel:r,coordSysModel:r,coordSys:n,coordSyses:[n],getPanelRect:TR.geo})})}},SR=[function(e,t){var r=e.xAxisModel,n=e.yAxisModel,i=e.gridModel;return!i&&r&&(i=r.axis.grid.model),!i&&n&&(i=n.axis.grid.model),i&&i===t.gridModel},function(e,t){var r=e.geoModel;return r&&r===t.geoModel}],TR={grid:function(){return this.coordSys.master.getRect().clone()},geo:function(){var e=this.coordSys,t=e.getBoundingRect().clone();return t.applyTransform(du(e)),t}},Rx={lineX:ue(bR,0),lineY:ue(bR,1),rect:function(e,t,r,n){var i=e?t.pointToData([r[0][0],r[1][0]],n):t.dataToPoint([r[0][0],r[1][0]],n),a=e?t.pointToData([r[0][1],r[1][1]],n):t.dataToPoint([r[0][1],r[1][1]],n),o=[ET([i[0],a[0]]),ET([i[1],a[1]])];return{values:o,xyMinMax:o}},polygon:function(e,t,r,n){var i=[[1/0,-1/0],[1/0,-1/0]],a=ft(r,function(o){var s=e?t.pointToData(o,n):t.dataToPoint(o,n);return i[0][0]=Math.min(i[0][0],s[0]),i[1][0]=Math.min(i[1][0],s[1]),i[0][1]=Math.max(i[0][1],s[0]),i[1][1]=Math.max(i[1][1],s[1]),s});return{values:a,xyMinMax:i}}};function bR(e,t,r,n){var i=r.getAxis(["x","y"][e]),a=ET(ft([0,1],function(s){return t?i.coordToData(i.toLocalCoord(n[s]),!0):i.toGlobalCoord(i.dataToCoord(n[s]))})),o=[];return o[e]=a,o[1-e]=[NaN,NaN],{values:a,xyMinMax:o}}var wR={lineX:ue(MR,0),lineY:ue(MR,1),rect:function(e,t,r){return[[e[0][0]-r[0]*t[0][0],e[0][1]-r[0]*t[0][1]],[e[1][0]-r[1]*t[1][0],e[1][1]-r[1]*t[1][1]]]},polygon:function(e,t,r){return ft(e,function(n,i){return[n[0]-r[0]*t[i][0],n[1]-r[1]*t[i][1]]})}};function MR(e,t,r,n){return[t[0]-n[e]*r[0],t[1]-n[e]*r[1]]}function Jtt(e,t){var r=AR(e),n=AR(t),i=[r[0]/n[0],r[1]/n[1]];return isNaN(i[0])&&(i[0]=1),isNaN(i[1])&&(i[1]=1),i}function AR(e){return e?[e[0][1]-e[0][0],e[1][1]-e[1][0]]:[NaN,NaN]}var CT=R,Qtt=v5("toolbox-dataZoom_"),tet=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(r,n,i,a){this._brushController||(this._brushController=new yM(i.getZr()),this._brushController.on("brush",It(this._onBrush,this)).mount()),net(r,n,this,a,i),ret(r,n)},t.prototype.onclick=function(r,n,i){eet[i].call(this)},t.prototype.remove=function(r,n){this._brushController&&this._brushController.unmount()},t.prototype.dispose=function(r,n){this._brushController&&this._brushController.dispose()},t.prototype._onBrush=function(r){var n=r.areas;if(!r.isEnd||!n.length)return;var i={},a=this.ecModel;this._brushController.updateCovers([]);var o=new YM(ZM(this.model),a,{include:["grid"]});o.matchOutputRanges(n,a,function(u,h,f){if(f.type==="cartesian2d"){var c=u.brushType;c==="rect"?(s("x",f,h[0]),s("y",f,h[1])):s({lineX:"x",lineY:"y"}[c],f,h)}}),Xtt(a,i),this._dispatchZoomAction(i);function s(u,h,f){var c=h.getAxis(u),d=c.model,v=l(u,d,a),p=v.findRepresentativeAxisProxy(d).getMinMaxSpan();(p.minValueSpan!=null||p.maxValueSpan!=null)&&(f=Wu(0,f.slice(),c.scale.getExtent(),0,p.minValueSpan,p.maxValueSpan)),v&&(i[v.id]={dataZoomId:v.id,startValue:f[0],endValue:f[1]})}function l(u,h,f){var c;return f.eachComponent({mainType:"dataZoom",subType:"select"},function(d){var v=d.getAxisModel(u,h.componentIndex);v&&(c=d)}),c}},t.prototype._dispatchZoomAction=function(r){var n=[];CT(r,function(i,a){n.push(Qt(i))}),n.length&&this.api.dispatchAction({type:"dataZoom",from:this.uid,batch:n})},t.getDefaultOption=function(r){var n={show:!0,filterMode:"filter",icon:{zoom:"M0,13.5h26.9 M13.5,26.9V0 M32.1,13.5H58V58H13.5 V32.1",back:"M22,1.4L9.9,13.5l12.3,12.3 M10.3,13.5H54.9v44.6 H10.3v-26"},title:r.getLocaleModel().get(["toolbox","dataZoom","title"]),brushStyle:{borderWidth:0,color:"rgba(210,219,238,0.2)"}};return n},t}(Ni),eet={zoom:function(){var e=!this._isZoomActive;this.api.dispatchAction({type:"takeGlobalCursor",key:"dataZoomSelect",dataZoomSelectActive:e})},back:function(){this._dispatchZoomAction(Ytt(this.ecModel))}};function ZM(e){var t={xAxisIndex:e.get("xAxisIndex",!0),yAxisIndex:e.get("yAxisIndex",!0),xAxisId:e.get("xAxisId",!0),yAxisId:e.get("yAxisId",!0)};return t.xAxisIndex==null&&t.xAxisId==null&&(t.xAxisIndex="all"),t.yAxisIndex==null&&t.yAxisId==null&&(t.yAxisIndex="all"),t}function ret(e,t){e.setIconStatus("back",qtt(t)>1?"emphasis":"normal")}function net(e,t,r,n,i){var a=r._isZoomActive;n&&n.type==="takeGlobalCursor"&&(a=n.key==="dataZoomSelect"?n.dataZoomSelectActive:!1),r._isZoomActive=a,e.setIconStatus("zoom",a?"emphasis":"normal");var o=new YM(ZM(e),t,{include:["grid"]}),s=o.makePanelOpts(i,function(l){return l.xAxisDeclared&&!l.yAxisDeclared?"lineX":!l.xAxisDeclared&&l.yAxisDeclared?"lineY":"rect"});r._brushController.setPanels(s).enableBrush(a&&s.length?{brushType:"auto",brushStyle:e.getModel("brushStyle").getItemStyle()}:!1)}zW("dataZoom",function(e){var t=e.getComponent("toolbox",0),r=["feature","dataZoom"];if(!t||t.get(r)==null)return;var n=t.getModel(r),i=[],a=ZM(n),o=xd(e,a);CT(o.xAxisModels,function(l){return s(l,"xAxis","xAxisIndex")}),CT(o.yAxisModels,function(l){return s(l,"yAxis","yAxisIndex")});function s(l,u,h){var f=l.componentIndex,c={type:"select",$fromToolbox:!0,filterMode:n.get("filterMode",!0)||"filter",id:Qtt+u+f};c[h]=f,i.push(c)}return i});function iet(e){e.registerComponentModel(Ctt),e.registerComponentView(Ltt),Vh("saveAsImage",Ptt),Vh("magicType",Ntt),Vh("dataView",Htt),Vh("dataZoom",tet),Vh("restore",$tt),te(Ett)}var aet=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="tooltip",t.dependencies=["axisPointer"],t.defaultOption={z:60,show:!0,showContent:!0,trigger:"item",triggerOn:"mousemove|click",alwaysShowContent:!1,displayMode:"single",renderMode:"auto",confine:null,showDelay:0,hideDelay:100,transitionDuration:.4,enterable:!1,backgroundColor:"#fff",shadowBlur:10,shadowColor:"rgba(0, 0, 0, .2)",shadowOffsetX:1,shadowOffsetY:2,borderRadius:4,borderWidth:1,padding:null,extraCssText:"",axisPointer:{type:"line",axis:"auto",animation:"auto",animationDurationUpdate:200,animationEasingUpdate:"exponentialOut",crossStyle:{color:"#999",width:1,type:"dashed",textStyle:{}}},textStyle:{color:"#666",fontSize:14}},t}(me);function tk(e){var t=e.get("confine");return t!=null?!!t:e.get("renderMode")==="richText"}function ek(e){if(ye.domSupported){for(var t=document.documentElement.style,r=0,n=e.length;r<n;r++)if(e[r]in t)return e[r]}}var rk=ek(["transform","webkitTransform","OTransform","MozTransform","msTransform"]),oet=ek(["webkitTransition","transition","OTransition","MozTransition","msTransition"]);function nk(e,t){if(!e)return t;t=D3(t,!0);var r=e.indexOf(t);return e=r===-1?t:"-"+e.slice(0,r)+"-"+t,e.toLowerCase()}function set(e,t){var r=e.currentStyle||document.defaultView&&document.defaultView.getComputedStyle(e);return r?r[t]:null}var uet=nk(oet,"transition"),qM=nk(rk,"transform"),het="position:absolute;display:block;border-style:solid;white-space:nowrap;z-index:9999999;"+(ye.transform3dSupported?"will-change:transform;":"");function fet(e){return e=e==="left"?"right":e==="right"?"left":e==="top"?"bottom":"top",e}function cet(e,t,r){if(!Ct(r)||r==="inside")return"";var n=e.get("backgroundColor"),i=e.get("borderWidth");t=Mu(t);var a=fet(r),o=Math.max(Math.round(i)*1.5,6),s="",l=qM+":",u;pe(["left","right"],a)>-1?(s+="top:50%",l+="translateY(-50%) rotate("+(u=a==="left"?-225:-45)+"deg)"):(s+="left:50%",l+="translateX(-50%) rotate("+(u=a==="top"?225:45)+"deg)");var h=u*Math.PI/180,f=o+i,c=f*Math.abs(Math.cos(h))+f*Math.abs(Math.sin(h)),d=Math.round(((c-Math.SQRT2*i)/2+Math.SQRT2*i-(c-f)/2)*100)/100;s+=";"+a+":-"+d+"px";var v=t+" solid "+i+"px;",p=["position:absolute;width:"+o+"px;height:"+o+"px;z-index:-1;",s+";"+l+";","border-bottom:"+v,"border-right:"+v,"background-color:"+n+";"];return'<div style="'+p.join("")+'"></div>'}function det(e,t){var r="cubic-bezier(0.23,1,0.32,1)",n=" "+e/2+"s "+r,i="opacity"+n+",visibility"+n;return t||(n=" "+e+"s "+r,i+=ye.transformSupported?","+qM+n:",left"+n+",top"+n),uet+":"+i}function ER(e,t,r){var n=e.toFixed(0)+"px",i=t.toFixed(0)+"px";if(!ye.transformSupported)return r?"top:"+i+";left:"+n+";":[["top",i],["left",n]];var a=ye.transform3dSupported,o="translate"+(a?"3d":"")+"("+n+","+i+(a?",0":"")+")";return r?"top:0;left:0;"+qM+":"+o+";":[["top",0],["left",0],[rk,o]]}function vet(e){var t=[],r=e.get("fontSize"),n=e.getTextColor();n&&t.push("color:"+n),t.push("font:"+e.getFont());var i=se(e.get("lineHeight"),Math.round(r*3/2));r&&t.push("line-height:"+i+"px");var a=e.get("textShadowColor"),o=e.get("textShadowBlur")||0,s=e.get("textShadowOffsetX")||0,l=e.get("textShadowOffsetY")||0;return a&&o&&t.push("text-shadow:"+s+"px "+l+"px "+o+"px "+a),R(["decoration","align"],function(u){var h=e.get(u);h&&t.push("text-"+u+":"+h)}),t.join(";")}function pet(e,t,r){var n=[],i=e.get("transitionDuration"),a=e.get("backgroundColor"),o=e.get("shadowBlur"),s=e.get("shadowColor"),l=e.get("shadowOffsetX"),u=e.get("shadowOffsetY"),h=e.getModel("textStyle"),f=uF(e,"html"),c=l+"px "+u+"px "+o+"px "+s;return n.push("box-shadow:"+c),t&&i&&n.push(det(i,r)),a&&n.push("background-color:"+a),R(["width","color","radius"],function(d){var v="border-"+d,p=D3(v),g=e.get(p);g!=null&&n.push(v+":"+g+(d==="color"?"":"px"))}),n.push(vet(h)),f!=null&&n.push("padding:"+Hf(f).join("px ")+"px"),n.join(";")+";"}function CR(e,t,r,n,i){var a=t&&t.painter;if(r){var o=a&&a.getViewportRoot();o&&W4(e,o,r,n,i)}else{e[0]=n,e[1]=i;var s=a&&a.getViewportRootOffset();s&&(e[0]+=s.offsetLeft,e[1]+=s.offsetTop)}e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var get=function(){function e(t,r){if(this._show=!1,this._styleCoord=[0,0,0,0],this._enterable=!0,this._alwaysShowContent=!1,this._firstShow=!0,this._longHide=!0,ye.wxa)return null;var n=document.createElement("div");n.domBelongToZr=!0,this.el=n;var i=this._zr=t.getZr(),a=r.appendTo,o=a&&(Ct(a)?document.querySelector(a):lf(a)?a:Yt(a)&&a(t.getDom()));CR(this._styleCoord,i,o,t.getWidth()/2,t.getHeight()/2),(o||t.getDom()).appendChild(n),this._api=t,this._container=o;var s=this;n.onmouseenter=function(){s._enterable&&(clearTimeout(s._hideTimeout),s._show=!0),s._inContent=!0},n.onmousemove=function(l){if(l=l||window.event,!s._enterable){var u=i.handler,h=i.painter.getViewportRoot();Ci(h,l,!0),u.dispatch("mousemove",l)}},n.onmouseleave=function(){s._inContent=!1,s._enterable&&s._show&&s.hideLater(s._hideDelay)}}return e.prototype.update=function(t){if(!this._container){var r=this._api.getDom(),n=set(r,"position"),i=r.style;i.position!=="absolute"&&n!=="absolute"&&(i.position="relative")}var a=t.get("alwaysShowContent");a&&this._moveIfResized(),this._alwaysShowContent=a,this.el.className=t.get("className")||""},e.prototype.show=function(t,r){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var n=this.el,i=n.style,a=this._styleCoord;n.innerHTML?i.cssText=het+pet(t,!this._firstShow,this._longHide)+ER(a[0],a[1],!0)+("border-color:"+Mu(r)+";")+(t.get("extraCssText")||"")+(";pointer-events:"+(this._enterable?"auto":"none")):i.display="none",this._show=!0,this._firstShow=!1,this._longHide=!1},e.prototype.setContent=function(t,r,n,i,a){var o=this.el;if(t==null){o.innerHTML="";return}var s="";if(Ct(a)&&n.get("trigger")==="item"&&!tk(n)&&(s=cet(n,i,a)),Ct(t))o.innerHTML=t+s;else if(t){o.innerHTML="",at(t)||(t=[t]);for(var l=0;l<t.length;l++)lf(t[l])&&t[l].parentNode!==o&&o.appendChild(t[l]);if(s&&o.childNodes.length){var u=document.createElement("div");u.innerHTML=s,o.appendChild(u)}}},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el;return t?[t.offsetWidth,t.offsetHeight]:[0,0]},e.prototype.moveTo=function(t,r){if(this.el){var n=this._styleCoord;if(CR(n,this._zr,this._container,t,r),n[0]!=null&&n[1]!=null){var i=this.el.style,a=ER(n[0],n[1]);R(a,function(o){i[o[0]]=o[1]})}}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){var t=this,r=this.el.style;r.visibility="hidden",r.opacity="0",ye.transform3dSupported&&(r.willChange=""),this._show=!1,this._longHideTimeout=setTimeout(function(){return t._longHide=!0},500)},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(It(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){clearTimeout(this._hideTimeout),clearTimeout(this._longHideTimeout);var t=this.el.parentNode;t&&t.removeChild(this.el),this.el=this._container=null},e}(),met=function(){function e(t){this._show=!1,this._styleCoord=[0,0,0,0],this._alwaysShowContent=!1,this._enterable=!0,this._zr=t.getZr(),LR(this._styleCoord,this._zr,t.getWidth()/2,t.getHeight()/2)}return e.prototype.update=function(t){var r=t.get("alwaysShowContent");r&&this._moveIfResized(),this._alwaysShowContent=r},e.prototype.show=function(){this._hideTimeout&&clearTimeout(this._hideTimeout),this.el.show(),this._show=!0},e.prototype.setContent=function(t,r,n,i,a){var o=this;Kt(t)&&We(""),this.el&&this._zr.remove(this.el);var s=n.getModel("textStyle");this.el=new we({style:{rich:r.richTextStyles,text:t,lineHeight:22,borderWidth:1,borderColor:i,textShadowColor:s.get("textShadowColor"),fill:n.get(["textStyle","color"]),padding:uF(n,"richText"),verticalAlign:"top",align:"left"},z:n.get("z")}),R(["backgroundColor","borderRadius","shadowColor","shadowBlur","shadowOffsetX","shadowOffsetY"],function(u){o.el.style[u]=n.get(u)}),R(["textShadowBlur","textShadowOffsetX","textShadowOffsetY"],function(u){o.el.style[u]=s.get(u)||0}),this._zr.add(this.el);var l=this;this.el.on("mouseover",function(){l._enterable&&(clearTimeout(l._hideTimeout),l._show=!0),l._inContent=!0}),this.el.on("mouseout",function(){l._enterable&&l._show&&l.hideLater(l._hideDelay),l._inContent=!1})},e.prototype.setEnterable=function(t){this._enterable=t},e.prototype.getSize=function(){var t=this.el,r=this.el.getBoundingRect(),n=DR(t.style);return[r.width+n.left+n.right,r.height+n.top+n.bottom]},e.prototype.moveTo=function(t,r){var n=this.el;if(n){var i=this._styleCoord;LR(i,this._zr,t,r),t=i[0],r=i[1];var a=n.style,o=ds(a.borderWidth||0),s=DR(a);n.x=t+o+s.left,n.y=r+o+s.top,n.markRedraw()}},e.prototype._moveIfResized=function(){var t=this._styleCoord[2],r=this._styleCoord[3];this.moveTo(t*this._zr.getWidth(),r*this._zr.getHeight())},e.prototype.hide=function(){this.el&&this.el.hide(),this._show=!1},e.prototype.hideLater=function(t){this._show&&!(this._inContent&&this._enterable)&&!this._alwaysShowContent&&(t?(this._hideDelay=t,this._show=!1,this._hideTimeout=setTimeout(It(this.hide,this),t)):this.hide())},e.prototype.isShow=function(){return this._show},e.prototype.dispose=function(){this._zr.remove(this.el)},e}();function ds(e){return Math.max(0,e)}function DR(e){var t=ds(e.shadowBlur||0),r=ds(e.shadowOffsetX||0),n=ds(e.shadowOffsetY||0);return{left:ds(t-r),right:ds(t+r),top:ds(t-n),bottom:ds(t+n)}}function LR(e,t,r,n){e[0]=r,e[1]=n,e[2]=e[0]/t.getWidth(),e[3]=e[1]/t.getHeight()}var _et=new Ae({shape:{x:-1,y:-1,width:2,height:2}}),yet=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){if(!(ye.node||!n.getDom())){var i=r.getComponent("tooltip"),a=this._renderMode=S5(i.get("renderMode"));this._tooltipContent=a==="richText"?new met(n):new get(n,{appendTo:i.get("appendToBody",!0)?"body":i.get("appendTo",!0)})}},t.prototype.render=function(r,n,i){if(!(ye.node||!i.getDom())){this.group.removeAll(),this._tooltipModel=r,this._ecModel=n,this._api=i;var a=this._tooltipContent;a.update(r),a.setEnterable(r.get("enterable")),this._initGlobalListener(),this._keepShow(),this._renderMode!=="richText"&&r.get("transitionDuration")?qf(this,"_updatePosition",50,"fixRate"):Xd(this,"_updatePosition")}},t.prototype._initGlobalListener=function(){var r=this._tooltipModel,n=r.get("triggerOn");Gz("itemTooltip",this._api,It(function(i,a,o){n!=="none"&&(n.indexOf(i)>=0?this._tryShow(a,o):i==="leave"&&this._hide(o))},this))},t.prototype._keepShow=function(){var r=this._tooltipModel,n=this._ecModel,i=this._api,a=r.get("triggerOn");if(this._lastX!=null&&this._lastY!=null&&a!=="none"&&a!=="click"){var o=this;clearTimeout(this._refreshUpdateTimeout),this._refreshUpdateTimeout=setTimeout(function(){!i.isDisposed()&&o.manuallyShowTip(r,n,i,{x:o._lastX,y:o._lastY,dataByCoordSys:o._lastDataByCoordSys})})}},t.prototype.manuallyShowTip=function(r,n,i,a){if(!(a.from===this.uid||ye.node||!i.getDom())){var o=RR(a,i);this._ticket="";var s=a.dataByCoordSys,l=wet(a,n,i);if(l){var u=l.el.getBoundingRect().clone();u.applyTransform(l.el.transform),this._tryShow({offsetX:u.x+u.width/2,offsetY:u.y+u.height/2,target:l.el,position:a.position,positionDefault:"bottom"},o)}else if(a.tooltip&&a.x!=null&&a.y!=null){var h=_et;h.x=a.x,h.y=a.y,h.update(),oe(h).tooltipConfig={name:null,option:a.tooltip},this._tryShow({offsetX:a.x,offsetY:a.y,target:h},o)}else if(s)this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,dataByCoordSys:s,tooltipOption:a.tooltipOption},o);else if(a.seriesIndex!=null){if(this._manuallyAxisShowTip(r,n,i,a))return;var f=Vz(a,n),c=f.point[0],d=f.point[1];c!=null&&d!=null&&this._tryShow({offsetX:c,offsetY:d,target:f.el,position:a.position,positionDefault:"bottom"},o)}else a.x!=null&&a.y!=null&&(i.dispatchAction({type:"updateAxisPointer",x:a.x,y:a.y}),this._tryShow({offsetX:a.x,offsetY:a.y,position:a.position,target:i.getZr().findHover(a.x,a.y).target},o))}},t.prototype.manuallyHideTip=function(r,n,i,a){var o=this._tooltipContent;this._tooltipModel&&o.hideLater(this._tooltipModel.get("hideDelay")),this._lastX=this._lastY=this._lastDataByCoordSys=null,a.from!==this.uid&&this._hide(RR(a,i))},t.prototype._manuallyAxisShowTip=function(r,n,i,a){var o=a.seriesIndex,s=a.dataIndex,l=n.getComponent("axisPointer").coordSysAxesInfo;if(!(o==null||s==null||l==null)){var u=n.getSeriesByIndex(o);if(u){var h=u.getData(),f=Nc([h.getItemModel(s),u,(u.coordinateSystem||{}).model],this._tooltipModel);if(f.get("trigger")==="axis")return i.dispatchAction({type:"updateAxisPointer",seriesIndex:o,dataIndex:s,position:a.position}),!0}}},t.prototype._tryShow=function(r,n){var i=r.target,a=this._tooltipModel;if(a){this._lastX=r.offsetX,this._lastY=r.offsetY;var o=r.dataByCoordSys;if(o&&o.length)this._showAxisTooltip(o,r);else if(i){var s=oe(i);if(s.ssrType==="legend")return;this._lastDataByCoordSys=null;var l,u;Ql(i,function(h){if(oe(h).dataIndex!=null)return l=h,!0;if(oe(h).tooltipConfig!=null)return u=h,!0},!0),l?this._showSeriesItemTooltip(r,l,n):u?this._showComponentItemTooltip(r,u,n):this._hide(n)}else this._lastDataByCoordSys=null,this._hide(n)}},t.prototype._showOrMove=function(r,n){var i=r.get("showDelay");n=It(n,this),clearTimeout(this._showTimout),i>0?this._showTimout=setTimeout(n,i):n()},t.prototype._showAxisTooltip=function(r,n){var i=this._ecModel,a=this._tooltipModel,o=[n.offsetX,n.offsetY],s=Nc([n.tooltipOption],a),l=this._renderMode,u=[],h=on("section",{blocks:[],noHeader:!0}),f=[],c=new py;R(r,function(_){R(_.dataByAxis,function(y){var x=i.getComponent(y.axisDim+"Axis",y.axisIndex),T=y.value;if(!(!x||T==null)){var S=Uz(T,x.axis,i,y.seriesDataIndices,y.valueLabelOpt),M=on("section",{header:S,noHeader:!ha(S),sortBlocks:!0,blocks:[]});h.blocks.push(M),R(y.seriesDataIndices,function(w){var b=i.getSeriesByIndex(w.seriesIndex),A=w.dataIndexInside,E=b.getDataParams(A);if(!(E.dataIndex<0)){E.axisDim=y.axisDim,E.axisIndex=y.axisIndex,E.axisType=y.axisType,E.axisId=y.axisId,E.axisValue=Hw(x.axis,{value:T}),E.axisValueLabel=S,E.marker=c.makeTooltipMarker("item",Mu(E.color),l);var C=m2(b.formatTooltip(A,!0,null)),D=C.frag;if(D){var L=Nc([b],a).get("valueFormatter");M.blocks.push(L?rt({valueFormatter:L},D):D)}C.text&&f.push(C.text),u.push(E)}})}})}),h.blocks.reverse(),f.reverse();var d=n.position,v=s.get("order"),p=b2(h,c,l,v,i.get("useUTC"),s.get("textStyle"));p&&f.unshift(p);var g=l==="richText"?`

`:"<br/>",m=f.join(g);this._showOrMove(s,function(){this._updateContentNotChangedOnAxis(r,u)?this._updatePosition(s,d,o[0],o[1],this._tooltipContent,u):this._showTooltipContent(s,m,u,Math.random()+"",o[0],o[1],d,null,c)})},t.prototype._showSeriesItemTooltip=function(r,n,i){var a=this._ecModel,o=oe(n),s=o.seriesIndex,l=a.getSeriesByIndex(s),u=o.dataModel||l,h=o.dataIndex,f=o.dataType,c=u.getData(f),d=this._renderMode,v=r.positionDefault,p=Nc([c.getItemModel(h),u,l&&(l.coordinateSystem||{}).model],this._tooltipModel,v?{position:v}:null),g=p.get("trigger");if(!(g!=null&&g!=="item")){var m=u.getDataParams(h,f),_=new py;m.marker=_.makeTooltipMarker("item",Mu(m.color),d);var y=m2(u.formatTooltip(h,!1,f)),x=p.get("order"),T=p.get("valueFormatter"),S=y.frag,M=S?b2(T?rt({valueFormatter:T},S):S,_,d,x,a.get("useUTC"),p.get("textStyle")):y.text,w="item_"+u.name+"_"+h;this._showOrMove(p,function(){this._showTooltipContent(p,M,m,w,r.offsetX,r.offsetY,r.position,r.target,_)}),i({type:"showTip",dataIndexInside:h,dataIndex:c.getRawIndex(h),seriesIndex:s,from:this.uid})}},t.prototype._showComponentItemTooltip=function(r,n,i){var a=this._renderMode==="html",o=oe(n),s=o.tooltipConfig,l=s.option||{},u=l.encodeHTMLContent;if(Ct(l)){var h=l;l={content:h,formatter:h},u=!0}u&&a&&l.content&&(l=Qt(l),l.content=Br(l.content));var f=[l],c=this._ecModel.getComponent(o.componentMainType,o.componentIndex);c&&f.push(c),f.push({formatter:l.content});var d=r.positionDefault,v=Nc(f,this._tooltipModel,d?{position:d}:null),p=v.get("content"),g=Math.random()+"",m=new py;this._showOrMove(v,function(){var _=Qt(v.get("formatterParams")||{});this._showTooltipContent(v,p,_,g,r.offsetX,r.offsetY,r.position,n,m)}),i({type:"showTip",from:this.uid})},t.prototype._showTooltipContent=function(r,n,i,a,o,s,l,u,h){if(this._ticket="",!(!r.get("showContent")||!r.get("show"))){var f=this._tooltipContent;f.setEnterable(r.get("enterable"));var c=r.get("formatter");l=l||r.get("position");var d=n,v=this._getNearestPoint([o,s],i,r.get("trigger"),r.get("borderColor")),p=v.color;if(c)if(Ct(c)){var g=r.ecModel.get("useUTC"),m=at(i)?i[0]:i,_=m&&m.axisType&&m.axisType.indexOf("time")>=0;d=c,_&&(d=z_(m.axisValue,d,g)),d=xw(d,i,!0)}else if(Yt(c)){var y=It(function(x,T){x===this._ticket&&(f.setContent(T,h,r,p,l),this._updatePosition(r,l,o,s,f,i,u))},this);this._ticket=a,d=c(i,a,y)}else d=c;f.setContent(d,h,r,p,l),f.show(r,p),this._updatePosition(r,l,o,s,f,i,u)}},t.prototype._getNearestPoint=function(r,n,i,a){if(i==="axis"||at(n))return{color:a||(this._renderMode==="html"?"#fff":"none")};if(!at(n))return{color:a||n.color||n.borderColor}},t.prototype._updatePosition=function(r,n,i,a,o,s,l){var u=this._api.getWidth(),h=this._api.getHeight();n=n||r.get("position");var f=o.getSize(),c=r.get("align"),d=r.get("verticalAlign"),v=l&&l.getBoundingRect().clone();if(l&&v.applyTransform(l.transform),Yt(n)&&(n=n([i,a],s,o.el,v,{viewSize:[u,h],contentSize:f.slice()})),at(n))i=Tt(n[0],u),a=Tt(n[1],h);else if(Kt(n)){var p=n;p.width=f[0],p.height=f[1];var g=Mr(p,{width:u,height:h});i=g.x,a=g.y,c=null,d=null}else if(Ct(n)&&l){var m=bet(n,v,f,r.get("borderWidth"));i=m[0],a=m[1]}else{var m=xet(i,a,o,u,h,c?null:20,d?null:20);i=m[0],a=m[1]}if(c&&(i-=PR(c)?f[0]/2:c==="right"?f[0]:0),d&&(a-=PR(d)?f[1]/2:d==="bottom"?f[1]:0),tk(r)){var m=Tet(i,a,o,u,h);i=m[0],a=m[1]}o.moveTo(i,a)},t.prototype._updateContentNotChangedOnAxis=function(r,n){var i=this._lastDataByCoordSys,a=this._cbParamsList,o=!!i&&i.length===r.length;return o&&R(i,function(s,l){var u=s.dataByAxis||[],h=r[l]||{},f=h.dataByAxis||[];o=o&&u.length===f.length,o&&R(u,function(c,d){var v=f[d]||{},p=c.seriesDataIndices||[],g=v.seriesDataIndices||[];o=o&&c.value===v.value&&c.axisType===v.axisType&&c.axisId===v.axisId&&p.length===g.length,o&&R(p,function(m,_){var y=g[_];o=o&&m.seriesIndex===y.seriesIndex&&m.dataIndex===y.dataIndex}),a&&R(c.seriesDataIndices,function(m){var _=m.seriesIndex,y=n[_],x=a[_];y&&x&&x.data!==y.data&&(o=!1)})})}),this._lastDataByCoordSys=r,this._cbParamsList=n,!!o},t.prototype._hide=function(r){this._lastDataByCoordSys=null,r({type:"hideTip",from:this.uid})},t.prototype.dispose=function(r,n){ye.node||!n.getDom()||(Xd(this,"_updatePosition"),this._tooltipContent.dispose(),bT("itemTooltip",n))},t.type="tooltip",t}(nr);function Nc(e,t,r){var n=t.ecModel,i;r?(i=new Ie(r,n,n),i=new Ie(t.option,i,n)):i=t;for(var a=e.length-1;a>=0;a--){var o=e[a];o&&(o instanceof Ie&&(o=o.get("tooltip",!0)),Ct(o)&&(o={formatter:o}),o&&(i=new Ie(o,i,n)))}return i}function RR(e,t){return e.dispatchAction||It(t.dispatchAction,t)}function xet(e,t,r,n,i,a,o){var s=r.getSize(),l=s[0],u=s[1];return a!=null&&(e+l+a+2>n?e-=l+a:e+=a),o!=null&&(t+u+o>i?t-=u+o:t+=o),[e,t]}function Tet(e,t,r,n,i){var a=r.getSize(),o=a[0],s=a[1];return e=Math.min(e+o,n)-o,t=Math.min(t+s,i)-s,e=Math.max(e,0),t=Math.max(t,0),[e,t]}function bet(e,t,r,n){var i=r[0],a=r[1],o=Math.ceil(Math.SQRT2*n)+8,s=0,l=0,u=t.width,h=t.height;switch(e){case"inside":s=t.x+u/2-i/2,l=t.y+h/2-a/2;break;case"top":s=t.x+u/2-i/2,l=t.y-a-o;break;case"bottom":s=t.x+u/2-i/2,l=t.y+h+o;break;case"left":s=t.x-i-o,l=t.y+h/2-a/2;break;case"right":s=t.x+u+o,l=t.y+h/2-a/2}return[s,l]}function PR(e){return e==="center"||e==="middle"}function wet(e,t,r){var n=ew(e).queryOptionMap,i=n.keys()[0];if(!(!i||i==="series")){var a=yv(t,i,n.get(i),{useDefault:!1,enableAll:!1,enableNone:!1}),o=a.models[0];if(o){var s=r.getViewOfComponentModel(o),l;if(s.group.traverse(function(u){var h=oe(u).tooltipConfig;if(h&&h.name===e.name)return l=u,!0}),l)return{componentMainType:i,componentIndex:o.componentIndex,el:l}}}}function Met(e){te(Bv),e.registerComponentModel(aet),e.registerComponentView(yet),e.registerAction({type:"showTip",event:"showTip",update:"tooltip:manuallyShowTip"},Rr),e.registerAction({type:"hideTip",event:"hideTip",update:"tooltip:manuallyHideTip"},Rr)}var Aet=["rect","polygon","keep","clear"];function Eet(e,t){var r=er(e?e.brush:[]);if(r.length){var n=[];R(r,function(l){var u=l.hasOwnProperty("toolbox")?l.toolbox:[];u instanceof Array&&(n=n.concat(u))});var i=e&&e.toolbox;at(i)&&(i=i[0]),i||(i={feature:{}},e.toolbox=[i]);var a=i.feature||(i.feature={}),o=a.brush||(a.brush={}),s=o.type||(o.type=[]);s.push.apply(s,n),Cet(s),t&&!s.length&&s.push.apply(s,Aet)}}function Cet(e){var t={};R(e,function(r){t[r]=1}),e.length=0,R(t,function(r,n){e.push(n)})}var IR=R;function NR(e){if(e){for(var t in e)if(e.hasOwnProperty(t))return!0}}function DT(e,t,r){var n={};return IR(t,function(a){var o=n[a]=i();IR(e[a],function(s,l){if(rn.isValidType(l)){var u={type:l,visual:s};r&&r(u,a),o[l]=new rn(u),l==="opacity"&&(u=Qt(u),u.type="colorAlpha",o.__hidden.__alphaForOpacity=new rn(u))}})}),n;function i(){var a=function(){};a.prototype.__hidden=a.prototype;var o=new a;return o}}function ik(e,t,r){var n;R(r,function(i){t.hasOwnProperty(i)&&NR(t[i])&&(n=!0)}),n&&R(r,function(i){t.hasOwnProperty(i)&&NR(t[i])?e[i]=Qt(t[i]):delete e[i]})}function Det(e,t,r,n,i,a){var o={};R(e,function(f){var c=rn.prepareVisualTypes(t[f]);o[f]=c});var s;function l(f){return Rw(r,s,f)}function u(f,c){yF(r,s,f,c)}r.each(h);function h(f,c){s=f;var d=r.getRawDataItem(s);if(!(d&&d.visualMap===!1))for(var v=n.call(i,f),p=t[v],g=o[v],m=0,_=g.length;m<_;m++){var y=g[m];p[y]&&p[y].applyVisual(f,l,u)}}}function Let(e,t,r,n){var i={};return R(e,function(a){var o=rn.prepareVisualTypes(t[a]);i[a]=o}),{progress:function(o,s){var l;n!=null&&(l=s.getDimensionIndex(n));function u(T){return Rw(s,f,T)}function h(T,S){yF(s,f,T,S)}for(var f,c=s.getStore();(f=o.next())!=null;){var d=s.getRawDataItem(f);if(!(d&&d.visualMap===!1))for(var v=n!=null?c.get(l,f):f,p=r(v),g=t[p],m=i[p],_=0,y=m.length;_<y;_++){var x=m[_];g[x]&&g[x].applyVisual(v,u,h)}}}}}function Ret(e){var t=e.brushType,r={point:function(n){return OR[t].point(n,r,e)},rect:function(n){return OR[t].rect(n,r,e)}};return r}var OR={lineX:FR(0),lineY:FR(1),rect:{point:function(e,t,r){return e&&r.boundingRect.contain(e[0],e[1])},rect:function(e,t,r){return e&&r.boundingRect.intersect(e)}},polygon:{point:function(e,t,r){return e&&r.boundingRect.contain(e[0],e[1])&&Hl(r.range,e[0],e[1])},rect:function(e,t,r){var n=r.range;if(!e||n.length<=1)return!1;var i=e.x,a=e.y,o=e.width,s=e.height,l=n[0];if(Hl(n,i,a)||Hl(n,i+o,a)||Hl(n,i,a+s)||Hl(n,i+o,a+s)||fe.create(e).contain(l[0],l[1])||rd(i,a,i+o,a,n)||rd(i,a,i,a+s,n)||rd(i+o,a,i+o,a+s,n)||rd(i,a+s,i+o,a+s,n))return!0}}};function FR(e){var t=["x","y"],r=["width","height"];return{point:function(n,i,a){if(n){var o=a.range,s=n[e];return Oc(s,o)}},rect:function(n,i,a){if(n){var o=a.range,s=[n[t[e]],n[t[e]]+n[r[e]]];return s[1]<s[0]&&s.reverse(),Oc(s[0],o)||Oc(s[1],o)||Oc(o[0],s)||Oc(o[1],s)}}}}function Oc(e,t){return t[0]<=e&&e<=t[1]}var BR=["inBrush","outOfBrush"],Px="__ecBrushSelect",LT="__ecInBrushSelectEvent";function ak(e){e.eachComponent({mainType:"brush"},function(t){var r=t.brushTargetManager=new YM(t.option,e);r.setInputRanges(t.areas,e)})}function Pet(e,t,r){var n=[],i,a;e.eachComponent({mainType:"brush"},function(o){r&&r.type==="takeGlobalCursor"&&o.setBrushOption(r.key==="brush"?r.brushOption:{brushType:!1})}),ak(e),e.eachComponent({mainType:"brush"},function(o,s){var l={brushId:o.id,brushIndex:s,brushName:o.name,areas:Qt(o.areas),selected:[]};n.push(l);var u=o.option,h=u.brushLink,f=[],c=[],d=[],v=!1;s||(i=u.throttleType,a=u.throttleDelay);var p=ft(o.areas,function(T){var S=Fet[T.brushType],M=Vt({boundingRect:S?S(T):void 0},T);return M.selectors=Ret(M),M}),g=DT(o.option,BR,function(T){T.mappingMethod="fixed"});at(h)&&R(h,function(T){f[T]=1});function m(T){return h==="all"||!!f[T]}function _(T){return!!T.length}e.eachSeries(function(T,S){var M=d[S]=[];T.subType==="parallel"?y(T,S):x(T,S,M)});function y(T,S){var M=T.coordinateSystem;v=v||M.hasAxisBrushed(),m(S)&&M.eachActiveState(T.getData(),function(w,b){w==="active"&&(c[b]=1)})}function x(T,S,M){if(!(!T.brushSelector||Oet(o,S))&&(R(p,function(b){o.brushTargetManager.controlSeries(b,T,e)&&M.push(b),v=v||_(M)}),m(S)&&_(M))){var w=T.getData();w.each(function(b){UR(T,M,w,b)&&(c[b]=1)})}}e.eachSeries(function(T,S){var M={seriesId:T.id,seriesIndex:S,seriesName:T.name,dataIndex:[]};l.selected.push(M);var w=d[S],b=T.getData(),A=m(S)?function(E){return c[E]?(M.dataIndex.push(b.getRawIndex(E)),"inBrush"):"outOfBrush"}:function(E){return UR(T,w,b,E)?(M.dataIndex.push(b.getRawIndex(E)),"inBrush"):"outOfBrush"};(m(S)?v:_(w))&&Det(BR,g,b,A)})}),Iet(t,i,a,n,r)}function Iet(e,t,r,n,i){if(i){var a=e.getZr();if(!a[LT]){a[Px]||(a[Px]=Net);var o=qf(a,Px,r,t);o(e,n)}}}function Net(e,t){if(!e.isDisposed()){var r=e.getZr();r[LT]=!0,e.dispatchAction({type:"brushSelect",batch:t}),r[LT]=!1}}function UR(e,t,r,n){for(var i=0,a=t.length;i<a;i++){var o=t[i];if(e.brushSelector(n,r,o.selectors,o))return!0}}function Oet(e,t){var r=e.option.seriesIndex;return r!=null&&r!=="all"&&(at(r)?pe(r,t)<0:t!==r)}var Fet={rect:function(e){return zR(e.range)},polygon:function(e){for(var t,r=e.range,n=0,i=r.length;n<i;n++){t=t||[[1/0,-1/0],[1/0,-1/0]];var a=r[n];a[0]<t[0][0]&&(t[0][0]=a[0]),a[0]>t[0][1]&&(t[0][1]=a[0]),a[1]<t[1][0]&&(t[1][0]=a[1]),a[1]>t[1][1]&&(t[1][1]=a[1])}return t&&zR(t)}};function zR(e){return new fe(e[0][0],e[1][0],e[0][1]-e[0][0],e[1][1]-e[1][0])}var Bet=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){this.ecModel=r,this.api=n,this.model,(this._brushController=new yM(n.getZr())).on("brush",It(this._onBrush,this)).mount()},t.prototype.render=function(r,n,i,a){this.model=r,this._updateController(r,n,i,a)},t.prototype.updateTransform=function(r,n,i,a){ak(n),this._updateController(r,n,i,a)},t.prototype.updateVisual=function(r,n,i,a){this.updateTransform(r,n,i,a)},t.prototype.updateView=function(r,n,i,a){this._updateController(r,n,i,a)},t.prototype._updateController=function(r,n,i,a){(!a||a.$from!==r.id)&&this._brushController.setPanels(r.brushTargetManager.makePanelOpts(i)).enableBrush(r.brushOption).updateCovers(r.areas.slice())},t.prototype.dispose=function(){this._brushController.dispose()},t.prototype._onBrush=function(r){var n=this.model.id,i=this.model.brushTargetManager.setOutputRanges(r.areas,this.ecModel);(!r.isEnd||r.removeOnClick)&&this.api.dispatchAction({type:"brush",brushId:n,areas:Qt(i),$from:n}),r.isEnd&&this.api.dispatchAction({type:"brushEnd",brushId:n,areas:Qt(i),$from:n})},t.type="brush",t}(nr),Uet="#ddd",zet=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.areas=[],r.brushOption={},r}return t.prototype.optionUpdated=function(r,n){var i=this.option;!n&&ik(i,r,["inBrush","outOfBrush"]);var a=i.inBrush=i.inBrush||{};i.outOfBrush=i.outOfBrush||{color:Uet},a.hasOwnProperty("liftZ")||(a.liftZ=5)},t.prototype.setAreas=function(r){r&&(this.areas=ft(r,function(n){return kR(this.option,n)},this))},t.prototype.setBrushOption=function(r){this.brushOption=kR(this.option,r),this.brushType=this.brushOption.brushType},t.type="brush",t.dependencies=["geo","grid","xAxis","yAxis","parallel","series"],t.defaultOption={seriesIndex:"all",brushType:"rect",brushMode:"single",transformable:!0,brushStyle:{borderWidth:1,color:"rgba(210,219,238,0.3)",borderColor:"#D2DBEE"},throttleType:"fixRate",throttleDelay:0,removeOnClick:!0,z:1e4},t}(me);function kR(e,t){return Ot({brushType:e.brushType,brushMode:e.brushMode,transformable:e.transformable,brushStyle:new Ie(e.brushStyle).getItemStyle(),removeOnClick:e.removeOnClick,z:e.z},t,!0)}var ket=["rect","polygon","lineX","lineY","keep","clear"],Get=function(e){q(t,e);function t(){return e!==null&&e.apply(this,arguments)||this}return t.prototype.render=function(r,n,i){var a,o,s;n.eachComponent({mainType:"brush"},function(l){a=l.brushType,o=l.brushOption.brushMode||"single",s=s||!!l.areas.length}),this._brushType=a,this._brushMode=o,R(r.get("type",!0),function(l){r.setIconStatus(l,(l==="keep"?o==="multiple":l==="clear"?s:l===a)?"emphasis":"normal")})},t.prototype.updateView=function(r,n,i){this.render(r,n,i)},t.prototype.getIcons=function(){var r=this.model,n=r.get("icon",!0),i={};return R(r.get("type",!0),function(a){n[a]&&(i[a]=n[a])}),i},t.prototype.onclick=function(r,n,i){var a=this._brushType,o=this._brushMode;i==="clear"?(n.dispatchAction({type:"axisAreaSelect",intervals:[]}),n.dispatchAction({type:"brush",command:"clear",areas:[]})):n.dispatchAction({type:"takeGlobalCursor",key:"brush",brushOption:{brushType:i==="keep"?a:a===i?!1:i,brushMode:i==="keep"?o==="multiple"?"single":"multiple":o}})},t.getDefaultOption=function(r){var n={show:!0,type:ket.slice(),icon:{rect:"M7.3,34.7 M0.4,10V-0.2h9.8 M89.6,10V-0.2h-9.8 M0.4,60v10.2h9.8 M89.6,60v10.2h-9.8 M12.3,22.4V10.5h13.1 M33.6,10.5h7.8 M49.1,10.5h7.8 M77.5,22.4V10.5h-13 M12.3,31.1v8.2 M77.7,31.1v8.2 M12.3,47.6v11.9h13.1 M33.6,59.5h7.6 M49.1,59.5 h7.7 M77.5,47.6v11.9h-13",polygon:"M55.2,34.9c1.7,0,3.1,1.4,3.1,3.1s-1.4,3.1-3.1,3.1 s-3.1-1.4-3.1-3.1S53.5,34.9,55.2,34.9z M50.4,51c1.7,0,3.1,1.4,3.1,3.1c0,1.7-1.4,3.1-3.1,3.1c-1.7,0-3.1-1.4-3.1-3.1 C47.3,52.4,48.7,51,50.4,51z M55.6,37.1l1.5-7.8 M60.1,13.5l1.6-8.7l-7.8,4 M59,19l-1,5.3 M24,16.1l6.4,4.9l6.4-3.3 M48.5,11.6 l-5.9,3.1 M19.1,12.8L9.7,5.1l1.1,7.7 M13.4,29.8l1,7.3l6.6,1.6 M11.6,18.4l1,6.1 M32.8,41.9 M26.6,40.4 M27.3,40.2l6.1,1.6 M49.9,52.1l-5.6-7.6l-4.9-1.2",lineX:"M15.2,30 M19.7,15.6V1.9H29 M34.8,1.9H40.4 M55.3,15.6V1.9H45.9 M19.7,44.4V58.1H29 M34.8,58.1H40.4 M55.3,44.4 V58.1H45.9 M12.5,20.3l-9.4,9.6l9.6,9.8 M3.1,29.9h16.5 M62.5,20.3l9.4,9.6L62.3,39.7 M71.9,29.9H55.4",lineY:"M38.8,7.7 M52.7,12h13.2v9 M65.9,26.6V32 M52.7,46.3h13.2v-9 M24.9,12H11.8v9 M11.8,26.6V32 M24.9,46.3H11.8v-9 M48.2,5.1l-9.3-9l-9.4,9.2 M38.9-3.9V12 M48.2,53.3l-9.3,9l-9.4-9.2 M38.9,62.3V46.4",keep:"M4,10.5V1h10.3 M20.7,1h6.1 M33,1h6.1 M55.4,10.5V1H45.2 M4,17.3v6.6 M55.6,17.3v6.6 M4,30.5V40h10.3 M20.7,40 h6.1 M33,40h6.1 M55.4,30.5V40H45.2 M21,18.9h62.9v48.6H21V18.9z",clear:"M22,14.7l30.9,31 M52.9,14.7L22,45.7 M4.7,16.8V4.2h13.1 M26,4.2h7.8 M41.6,4.2h7.8 M70.3,16.8V4.2H57.2 M4.7,25.9v8.6 M70.3,25.9v8.6 M4.7,43.2v12.6h13.1 M26,55.8h7.8 M41.6,55.8h7.8 M70.3,43.2v12.6H57.2"},title:r.getLocaleModel().get(["toolbox","brush","title"])};return n},t}(Ni);function Vet(e){e.registerComponentView(Bet),e.registerComponentModel(zet),e.registerPreprocessor(Eet),e.registerVisual(e.PRIORITY.VISUAL.BRUSH,Pet),e.registerAction({type:"brush",event:"brush",update:"updateVisual"},function(t,r){r.eachComponent({mainType:"brush",query:t},function(n){n.setAreas(t.areas)})}),e.registerAction({type:"brushSelect",event:"brushSelected",update:"none"},Rr),e.registerAction({type:"brushEnd",event:"brushEnd",update:"none"},Rr),Vh("brush",Get)}var Het=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.type="title",t.defaultOption={z:6,show:!0,text:"",target:"blank",subtext:"",subtarget:"blank",left:0,top:0,backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,padding:5,itemGap:10,textStyle:{fontSize:18,fontWeight:"bold",color:"#464646"},subtextStyle:{fontSize:12,color:"#6E7079"}},t}(me),Wet=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.render=function(r,n,i){if(this.group.removeAll(),!!r.get("show")){var a=this.group,o=r.getModel("textStyle"),s=r.getModel("subtextStyle"),l=r.get("textAlign"),u=se(r.get("textBaseline"),r.get("textVerticalAlign")),h=new we({style:je(o,{text:r.get("text"),fill:o.getTextColor()},{disableBox:!0}),z2:10}),f=h.getBoundingRect(),c=r.get("subtext"),d=new we({style:je(s,{text:c,fill:s.getTextColor(),y:f.height+r.get("itemGap"),verticalAlign:"top"},{disableBox:!0}),z2:10}),v=r.get("link"),p=r.get("sublink"),g=r.get("triggerEvent",!0);h.silent=!v&&!g,d.silent=!p&&!g,v&&h.on("click",function(){Am(v,"_"+r.get("target"))}),p&&d.on("click",function(){Am(p,"_"+r.get("subtarget"))}),oe(h).eventData=oe(d).eventData=g?{componentType:"title",componentIndex:r.componentIndex}:null,a.add(h),c&&a.add(d);var m=a.getBoundingRect(),_=r.getBoxLayoutParams();_.width=m.width,_.height=m.height;var y=Mr(_,{width:i.getWidth(),height:i.getHeight()},r.get("padding"));l||(l=r.get("left")||r.get("right"),l==="middle"&&(l="center"),l==="right"?y.x+=y.width:l==="center"&&(y.x+=y.width/2)),u||(u=r.get("top")||r.get("bottom"),u==="center"&&(u="middle"),u==="bottom"?y.y+=y.height:u==="middle"&&(y.y+=y.height/2),u=u||"top"),a.x=y.x,a.y=y.y,a.markRedraw();var x={align:l,verticalAlign:u};h.setStyle(x),d.setStyle(x),m=a.getBoundingRect();var T=y.margin,S=r.getItemStyle(["color","opacity"]);S.fill=r.get("backgroundColor");var M=new Ae({shape:{x:m.x-T[3],y:m.y-T[0],width:m.width+T[1]+T[3],height:m.height+T[0]+T[2],r:r.get("borderRadius")},style:S,subPixelOptimize:!0,silent:!0});a.add(M)}},t.type="title",t}(nr);function Xet(e){e.registerComponentModel(Het),e.registerComponentView(Wet)}var GR=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode="box",r}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),this._initData()},t.prototype.mergeOption=function(r){e.prototype.mergeOption.apply(this,arguments),this._initData()},t.prototype.setCurrentIndex=function(r){r==null&&(r=this.option.currentIndex);var n=this._data.count();this.option.loop?r=(r%n+n)%n:(r>=n&&(r=n-1),r<0&&(r=0)),this.option.currentIndex=r},t.prototype.getCurrentIndex=function(){return this.option.currentIndex},t.prototype.isIndexMax=function(){return this.getCurrentIndex()>=this._data.count()-1},t.prototype.setPlayState=function(r){this.option.autoPlay=!!r},t.prototype.getPlayState=function(){return!!this.option.autoPlay},t.prototype._initData=function(){var r=this.option,n=r.data||[],i=r.axisType,a=this._names=[],o;i==="category"?(o=[],R(n,function(u,h){var f=Xr(Uf(u),""),c;Kt(u)?(c=Qt(u),c.value=h):c=h,o.push(c),a.push(f)})):o=n;var s={category:"ordinal",time:"time",value:"number"}[i]||"number",l=this._data=new xr([{name:"value",type:s}],this);l.initData(o,a)},t.prototype.getData=function(){return this._data},t.prototype.getCategories=function(){if(this.get("axisType")==="category")return this._names.slice()},t.type="timeline",t.defaultOption={z:4,show:!0,axisType:"time",realtime:!0,left:"20%",top:null,right:"20%",bottom:0,width:null,height:40,padding:5,controlPosition:"left",autoPlay:!1,rewind:!1,loop:!0,playInterval:2e3,currentIndex:0,itemStyle:{},label:{color:"#000"},data:[]},t}(me),ok=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="timeline.slider",t.defaultOption=Ws(GR.defaultOption,{backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderWidth:0,orient:"horizontal",inverse:!1,tooltip:{trigger:"item"},symbol:"circle",symbolSize:12,lineStyle:{show:!0,width:2,color:"#DAE1F5"},label:{position:"auto",show:!0,interval:"auto",rotate:0,color:"#A4B1D7"},itemStyle:{color:"#A4B1D7",borderWidth:1},checkpointStyle:{symbol:"circle",symbolSize:15,color:"#316bf3",borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0, 0, 0, 0.3)",animation:!0,animationDuration:300,animationEasing:"quinticInOut"},controlStyle:{show:!0,showPlayBtn:!0,showPrevBtn:!0,showNextBtn:!0,itemSize:24,itemGap:12,position:"left",playIcon:"path://M31.6,53C17.5,53,6,41.5,6,27.4S17.5,1.8,31.6,1.8C45.7,1.8,57.2,13.3,57.2,27.4S45.7,53,31.6,53z M31.6,3.3 C18.4,3.3,7.5,14.1,7.5,27.4c0,13.3,10.8,24.1,24.1,24.1C44.9,51.5,55.7,40.7,55.7,27.4C55.7,14.1,44.9,3.3,31.6,3.3z M24.9,21.3 c0-2.2,1.6-3.1,3.5-2l10.5,6.1c1.899,1.1,1.899,2.9,0,4l-10.5,6.1c-1.9,1.1-3.5,0.2-3.5-2V21.3z",stopIcon:"path://M30.9,53.2C16.8,53.2,5.3,41.7,5.3,27.6S16.8,2,30.9,2C45,2,56.4,13.5,56.4,27.6S45,53.2,30.9,53.2z M30.9,3.5C17.6,3.5,6.8,14.4,6.8,27.6c0,13.3,10.8,24.1,24.101,24.1C44.2,51.7,55,40.9,55,27.6C54.9,14.4,44.1,3.5,30.9,3.5z M36.9,35.8c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H36c0.5,0,0.9,0.4,0.9,1V35.8z M27.8,35.8 c0,0.601-0.4,1-0.9,1h-1.3c-0.5,0-0.9-0.399-0.9-1V19.5c0-0.6,0.4-1,0.9-1H27c0.5,0,0.9,0.4,0.9,1L27.8,35.8L27.8,35.8z",nextIcon:"M2,18.5A1.52,1.52,0,0,1,.92,18a1.49,1.49,0,0,1,0-2.12L7.81,9.36,1,3.11A1.5,1.5,0,1,1,3,.89l8,7.34a1.48,1.48,0,0,1,.49,1.09,1.51,1.51,0,0,1-.46,1.1L3,18.08A1.5,1.5,0,0,1,2,18.5Z",prevIcon:"M10,.5A1.52,1.52,0,0,1,11.08,1a1.49,1.49,0,0,1,0,2.12L4.19,9.64,11,15.89a1.5,1.5,0,1,1-2,2.22L1,10.77A1.48,1.48,0,0,1,.5,9.68,1.51,1.51,0,0,1,1,8.58L9,.92A1.5,1.5,0,0,1,10,.5Z",prevBtnSize:18,nextBtnSize:18,color:"#A4B1D7",borderColor:"#A4B1D7",borderWidth:1},emphasis:{label:{show:!0,color:"#6f778d"},itemStyle:{color:"#316BF3"},controlStyle:{color:"#316BF3",borderColor:"#316BF3",borderWidth:2}},progress:{lineStyle:{color:"#316BF3"},itemStyle:{color:"#316BF3"},label:{color:"#6f778d"}},data:[]}),t}(GR);Nr(ok,Y_.prototype);var Yet=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="timeline",t}(nr),Zet=function(e){q(t,e);function t(r,n,i,a){var o=e.call(this,r,n,i)||this;return o.type=a||"value",o}return t.prototype.getLabelModel=function(){return this.model.getModel("label")},t.prototype.isHorizontal=function(){return this.model.get("orient")==="horizontal"},t}(Kn),Ix=Math.PI,VR=Le(),qet=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(r,n){this.api=n},t.prototype.render=function(r,n,i){if(this.model=r,this.api=i,this.ecModel=n,this.group.removeAll(),r.get("show",!0)){var a=this._layout(r,i),o=this._createGroup("_mainGroup"),s=this._createGroup("_labelGroup"),l=this._axis=this._createAxis(a,r);r.formatTooltip=function(u){var h=l.scale.getLabel({value:u});return on("nameValue",{noName:!0,value:h})},R(["AxisLine","AxisTick","Control","CurrentPointer"],function(u){this["_render"+u](a,o,l,r)},this),this._renderAxisLabel(a,s,l,r),this._position(a,r)}this._doPlayStop(),this._updateTicksStatus()},t.prototype.remove=function(){this._clearTimer(),this.group.removeAll()},t.prototype.dispose=function(){this._clearTimer()},t.prototype._layout=function(r,n){var i=r.get(["label","position"]),a=r.get("orient"),o=Ket(r,n),s;i==null||i==="auto"?s=a==="horizontal"?o.y+o.height/2<n.getHeight()/2?"-":"+":o.x+o.width/2<n.getWidth()/2?"+":"-":Ct(i)?s={horizontal:{top:"-",bottom:"+"},vertical:{left:"-",right:"+"}}[a][i]:s=i;var l={horizontal:"center",vertical:s>=0||s==="+"?"left":"right"},u={horizontal:s>=0||s==="+"?"top":"bottom",vertical:"middle"},h={horizontal:0,vertical:Ix/2},f=a==="vertical"?o.height:o.width,c=r.getModel("controlStyle"),d=c.get("show",!0),v=d?c.get("itemSize"):0,p=d?c.get("itemGap"):0,g=v+p,m=r.get(["label","rotate"])||0;m=m*Ix/180;var _,y,x,T=c.get("position",!0),S=d&&c.get("showPlayBtn",!0),M=d&&c.get("showPrevBtn",!0),w=d&&c.get("showNextBtn",!0),b=0,A=f;T==="left"||T==="bottom"?(S&&(_=[0,0],b+=g),M&&(y=[b,0],b+=g),w&&(x=[A-v,0],A-=g)):(S&&(_=[A-v,0],A-=g),M&&(y=[0,0],b+=g),w&&(x=[A-v,0],A-=g));var E=[b,A];return r.get("inverse")&&E.reverse(),{viewRect:o,mainLength:f,orient:a,rotation:h[a],labelRotation:m,labelPosOpt:s,labelAlign:r.get(["label","align"])||l[a],labelBaseline:r.get(["label","verticalAlign"])||r.get(["label","baseline"])||u[a],playPosition:_,prevBtnPosition:y,nextBtnPosition:x,axisExtent:E,controlSize:v,controlGap:p}},t.prototype._position=function(r,n){var i=this._mainGroup,a=this._labelGroup,o=r.viewRect;if(r.orient==="vertical"){var s=oi(),l=o.x,u=o.y+o.height;qa(s,s,[-l,-u]),Fu(s,s,-Ix/2),qa(s,s,[l,u]),o=o.clone(),o.applyTransform(s)}var h=_(o),f=_(i.getBoundingRect()),c=_(a.getBoundingRect()),d=[i.x,i.y],v=[a.x,a.y];v[0]=d[0]=h[0][0];var p=r.labelPosOpt;if(p==null||Ct(p)){var g=p==="+"?0:1;y(d,f,h,1,g),y(v,c,h,1,1-g)}else{var g=p>=0?0:1;y(d,f,h,1,g),v[1]=d[1]+p}i.setPosition(d),a.setPosition(v),i.rotation=a.rotation=r.rotation,m(i),m(a);function m(x){x.originX=h[0][0]-x.x,x.originY=h[1][0]-x.y}function _(x){return[[x.x,x.x+x.width],[x.y,x.y+x.height]]}function y(x,T,S,M,w){x[M]+=S[M][w]-T[M][w]}},t.prototype._createAxis=function(r,n){var i=n.getData(),a=n.get("axisType"),o=$et(n,a);o.getTicks=function(){return i.mapArray(["value"],function(u){return{value:u}})};var s=i.getDataExtent("value");o.setExtent(s[0],s[1]),o.calcNiceTicks();var l=new Zet("value",o,r.axisExtent,a);return l.model=n,l},t.prototype._createGroup=function(r){var n=this[r]=new re;return this.group.add(n),n},t.prototype._renderAxisLine=function(r,n,i,a){var o=i.getExtent();if(a.get(["lineStyle","show"])){var s=new jr({shape:{x1:o[0],y1:0,x2:o[1],y2:0},style:rt({lineCap:"round"},a.getModel("lineStyle").getLineStyle()),silent:!0,z2:1});n.add(s);var l=this._progressLine=new jr({shape:{x1:o[0],x2:this._currentPointer?this._currentPointer.x:o[0],y1:0,y2:0},style:Vt({lineCap:"round",lineWidth:s.style.lineWidth},a.getModel(["progress","lineStyle"]).getLineStyle()),silent:!0,z2:1});n.add(l)}},t.prototype._renderAxisTick=function(r,n,i,a){var o=this,s=a.getData(),l=i.scale.getTicks();this._tickSymbols=[],R(l,function(u){var h=i.dataToCoord(u.value),f=s.getItemModel(u.value),c=f.getModel("itemStyle"),d=f.getModel(["emphasis","itemStyle"]),v=f.getModel(["progress","itemStyle"]),p={x:h,y:0,onclick:It(o._changeTimeline,o,u.value)},g=HR(f,c,n,p);g.ensureState("emphasis").style=d.getItemStyle(),g.ensureState("progress").style=v.getItemStyle(),cu(g);var m=oe(g);f.get("tooltip")?(m.dataIndex=u.value,m.dataModel=a):m.dataIndex=m.dataModel=null,o._tickSymbols.push(g)})},t.prototype._renderAxisLabel=function(r,n,i,a){var o=this,s=i.getLabelModel();if(s.get("show")){var l=a.getData(),u=i.getViewLabels();this._tickLabels=[],R(u,function(h){var f=h.tickValue,c=l.getItemModel(f),d=c.getModel("label"),v=c.getModel(["emphasis","label"]),p=c.getModel(["progress","label"]),g=i.dataToCoord(h.tickValue),m=new we({x:g,y:0,rotation:r.labelRotation-r.rotation,onclick:It(o._changeTimeline,o,f),silent:!1,style:je(d,{text:h.formattedLabel,align:r.labelAlign,verticalAlign:r.labelBaseline})});m.ensureState("emphasis").style=je(v),m.ensureState("progress").style=je(p),n.add(m),cu(m),VR(m).dataIndex=f,o._tickLabels.push(m)})}},t.prototype._renderControl=function(r,n,i,a){var o=r.controlSize,s=r.rotation,l=a.getModel("controlStyle").getItemStyle(),u=a.getModel(["emphasis","controlStyle"]).getItemStyle(),h=a.getPlayState(),f=a.get("inverse",!0);c(r.nextBtnPosition,"next",It(this._changeTimeline,this,f?"-":"+")),c(r.prevBtnPosition,"prev",It(this._changeTimeline,this,f?"+":"-")),c(r.playPosition,h?"stop":"play",It(this._handlePlayClick,this,!h),!0);function c(d,v,p,g){if(d){var m=_a(se(a.get(["controlStyle",v+"BtnSize"]),o),o),_=[0,-m/2,m,m],y=jet(a,v+"Icon",_,{x:d[0],y:d[1],originX:o/2,originY:0,rotation:g?-s:0,rectHover:!0,style:l,onclick:p});y.ensureState("emphasis").style=u,n.add(y),cu(y)}}},t.prototype._renderCurrentPointer=function(r,n,i,a){var o=a.getData(),s=a.getCurrentIndex(),l=o.getItemModel(s).getModel("checkpointStyle"),u=this,h={onCreate:function(f){f.draggable=!0,f.drift=It(u._handlePointerDrag,u),f.ondragend=It(u._handlePointerDragend,u),WR(f,u._progressLine,s,i,a,!0)},onUpdate:function(f){WR(f,u._progressLine,s,i,a)}};this._currentPointer=HR(l,l,this._mainGroup,{},this._currentPointer,h)},t.prototype._handlePlayClick=function(r){this._clearTimer(),this.api.dispatchAction({type:"timelinePlayChange",playState:r,from:this.uid})},t.prototype._handlePointerDrag=function(r,n,i){this._clearTimer(),this._pointerChangeTimeline([i.offsetX,i.offsetY])},t.prototype._handlePointerDragend=function(r){this._pointerChangeTimeline([r.offsetX,r.offsetY],!0)},t.prototype._pointerChangeTimeline=function(r,n){var i=this._toAxisCoord(r)[0],a=this._axis,o=ki(a.getExtent().slice());i>o[1]&&(i=o[1]),i<o[0]&&(i=o[0]),this._currentPointer.x=i,this._currentPointer.markRedraw();var s=this._progressLine;s&&(s.shape.x2=i,s.dirty());var l=this._findNearestTick(i),u=this.model;(n||l!==u.getCurrentIndex()&&u.get("realtime"))&&this._changeTimeline(l)},t.prototype._doPlayStop=function(){var r=this;this._clearTimer(),this.model.getPlayState()&&(this._timer=setTimeout(function(){var n=r.model;r._changeTimeline(n.getCurrentIndex()+(n.get("rewind",!0)?-1:1))},this.model.get("playInterval")))},t.prototype._toAxisCoord=function(r){var n=this._mainGroup.getLocalTransform();return va(r,n,!0)},t.prototype._findNearestTick=function(r){var n=this.model.getData(),i=1/0,a,o=this._axis;return n.each(["value"],function(s,l){var u=o.dataToCoord(s),h=Math.abs(u-r);h<i&&(i=h,a=l)}),a},t.prototype._clearTimer=function(){this._timer&&(clearTimeout(this._timer),this._timer=null)},t.prototype._changeTimeline=function(r){var n=this.model.getCurrentIndex();r==="+"?r=n+1:r==="-"&&(r=n-1),this.api.dispatchAction({type:"timelineChange",currentIndex:r,from:this.uid})},t.prototype._updateTicksStatus=function(){var r=this.model.getCurrentIndex(),n=this._tickSymbols,i=this._tickLabels;if(n)for(var a=0;a<n.length;a++)n&&n[a]&&n[a].toggleState("progress",a<r);if(i)for(var a=0;a<i.length;a++)i&&i[a]&&i[a].toggleState("progress",VR(i[a]).dataIndex<=r)},t.type="timeline.slider",t}(Yet);function $et(e,t){if(t=t||e.get("type"),t)switch(t){case"category":return new Q_({ordinalMeta:e.getCategories(),extent:[1/0,-1/0]});case"time":return new Gw({locale:e.ecModel.getLocaleModel(),useUTC:e.ecModel.get("useUTC")});default:return new Fo}}function Ket(e,t){return Mr(e.getBoxLayoutParams(),{width:t.getWidth(),height:t.getHeight()},e.get("padding"))}function jet(e,t,r,n){var i=n.style,a=Mv(e.get(["controlStyle",t]),n,new fe(r[0],r[1],r[2],r[3]));return i&&a.setStyle(i),a}function HR(e,t,r,n,i,a){var o=t.get("color");if(i)i.setColor(o),r.add(i),a&&a.onUpdate(i);else{var s=e.get("symbol");i=Pr(s,-1,-1,2,2,o),i.setStyle("strokeNoScale",!0),r.add(i),a&&a.onCreate(i)}var l=t.getItemStyle(["color"]);i.setStyle(l),n=Ot({rectHover:!0,z2:100},n,!0);var u=$f(e.get("symbolSize"));n.scaleX=u[0]/2,n.scaleY=u[1]/2;var h=ku(e.get("symbolOffset"),u);h&&(n.x=(n.x||0)+h[0],n.y=(n.y||0)+h[1]);var f=e.get("symbolRotate");return n.rotation=(f||0)*Math.PI/180||0,i.attr(n),i.updateTransform(),i}function WR(e,t,r,n,i,a){if(!e.dragging){var o=i.getModel("checkpointStyle"),s=n.dataToCoord(i.getData().get("value",r));if(a||!o.get("animation",!0))e.attr({x:s,y:0}),t&&t.attr({shape:{x2:s}});else{var l={duration:o.get("animationDuration",!0),easing:o.get("animationEasing",!0)};e.stopAnimation(null,!0),e.animateTo({x:s,y:0},l),t&&t.animateTo({shape:{x2:s}},l)}}}function Jet(e){e.registerAction({type:"timelineChange",event:"timelineChanged",update:"prepareAndUpdate"},function(t,r,n){var i=r.getComponent("timeline");return i&&t.currentIndex!=null&&(i.setCurrentIndex(t.currentIndex),!i.get("loop",!0)&&i.isIndexMax()&&i.getPlayState()&&(i.setPlayState(!1),n.dispatchAction({type:"timelinePlayChange",playState:!1,from:t.from}))),r.resetOption("timeline",{replaceMerge:i.get("replaceMerge",!0)}),Vt({currentIndex:i.option.currentIndex},t)}),e.registerAction({type:"timelinePlayChange",event:"timelinePlayChanged",update:"update"},function(t,r){var n=r.getComponent("timeline");n&&t.playState!=null&&n.setPlayState(t.playState)})}function Qet(e){var t=e&&e.timeline;at(t)||(t=t?[t]:[]),R(t,function(r){r&&trt(r)})}function trt(e){var t=e.type,r={number:"value",time:"time"};if(r[t]&&(e.axisType=r[t],delete e.type),XR(e),Yl(e,"controlPosition")){var n=e.controlStyle||(e.controlStyle={});Yl(n,"position")||(n.position=e.controlPosition),n.position==="none"&&!Yl(n,"show")&&(n.show=!1,delete n.position),delete e.controlPosition}R(e.data||[],function(i){Kt(i)&&!at(i)&&(!Yl(i,"value")&&Yl(i,"name")&&(i.value=i.name),XR(i))})}function XR(e){var t=e.itemStyle||(e.itemStyle={}),r=t.emphasis||(t.emphasis={}),n=e.label||e.label||{},i=n.normal||(n.normal={}),a={normal:1,emphasis:1};R(n,function(o,s){!a[s]&&!Yl(i,s)&&(i[s]=o)}),r.label&&!Yl(n,"emphasis")&&(n.emphasis=r.label,delete r.label)}function Yl(e,t){return e.hasOwnProperty(t)}function ert(e){e.registerComponentModel(ok),e.registerComponentView(qet),e.registerSubTypeDefaulter("timeline",function(){return"slider"}),Jet(e),e.registerPreprocessor(Qet)}function $M(e,t){if(!e)return!1;for(var r=at(e)?e:[e],n=0;n<r.length;n++)if(r[n]&&r[n][t])return!0;return!1}function Xp(e){Su(e,"label",["show"])}var Yp=Le(),Uo=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.createdBySelf=!1,r}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),this._mergeOption(r,i,!1,!0)},t.prototype.isAnimationEnabled=function(){if(ye.node)return!1;var r=this.__hostSeries;return this.getShallow("animation")&&r&&r.isAnimationEnabled()},t.prototype.mergeOption=function(r,n){this._mergeOption(r,n,!1,!1)},t.prototype._mergeOption=function(r,n,i,a){var o=this.mainType;i||n.eachSeries(function(s){var l=s.get(this.mainType,!0),u=Yp(s)[o];if(!l||!l.data){Yp(s)[o]=null;return}u?u._mergeOption(l,n,!0):(a&&Xp(l),R(l.data,function(h){h instanceof Array?(Xp(h[0]),Xp(h[1])):Xp(h)}),u=this.createMarkerModelFromSeries(l,this,n),rt(u,{mainType:this.mainType,seriesIndex:s.seriesIndex,name:s.name,createdBySelf:!0}),u.__hostSeries=s),Yp(s)[o]=u},this)},t.prototype.formatTooltip=function(r,n,i){var a=this.getData(),o=this.getRawValue(r),s=a.getName(r);return on("section",{header:this.name,blocks:[on("nameValue",{name:s,value:o,noName:!s,noValue:o==null})]})},t.prototype.getData=function(){return this._data},t.prototype.setData=function(r){this._data=r},t.prototype.getDataParams=function(r,n){var i=Y_.prototype.getDataParams.call(this,r,n),a=this.__hostSeries;return a&&(i.seriesId=a.id,i.seriesName=a.name,i.seriesType=a.subType),i},t.getMarkerModelFromSeries=function(r,n){return Yp(r)[n]},t.type="marker",t.dependencies=["series","grid","polar","geo"],t}(me);Nr(Uo,Y_.prototype);var rrt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,n,i){return new t(r,n,i)},t.type="markPoint",t.defaultOption={z:5,symbol:"pin",symbolSize:50,tooltip:{trigger:"item"},label:{show:!0,position:"inside"},itemStyle:{borderWidth:2},emphasis:{label:{show:!0}}},t}(Uo);function RT(e){return!(isNaN(parseFloat(e.x))&&isNaN(parseFloat(e.y)))}function nrt(e){return!isNaN(parseFloat(e.x))&&!isNaN(parseFloat(e.y))}function Zp(e,t,r,n,i,a){var o=[],s=Oo(t,n),l=s?t.getCalculationInfo("stackResultDimension"):n,u=KM(t,l,e),h=t.indicesOfNearest(l,u)[0];o[i]=t.get(r,h),o[a]=t.get(l,h);var f=t.get(n,h),c=Oa(t.get(n,h));return c=Math.min(c,20),c>=0&&(o[a]=+o[a].toFixed(c)),[o,f]}var Nx={min:ue(Zp,"min"),max:ue(Zp,"max"),average:ue(Zp,"average"),median:ue(Zp,"median")};function av(e,t){if(t){var r=e.getData(),n=e.coordinateSystem,i=n&&n.dimensions;if(!nrt(t)&&!at(t.coord)&&at(i)){var a=sk(t,r,n,e);if(t=Qt(t),t.type&&Nx[t.type]&&a.baseAxis&&a.valueAxis){var o=pe(i,a.baseAxis.dim),s=pe(i,a.valueAxis.dim),l=Nx[t.type](r,a.baseDataDim,a.valueDataDim,o,s);t.coord=l[0],t.value=l[1]}else t.coord=[t.xAxis!=null?t.xAxis:t.radiusAxis,t.yAxis!=null?t.yAxis:t.angleAxis]}if(t.coord==null||!at(i))t.coord=[];else for(var u=t.coord,h=0;h<2;h++)Nx[u[h]]&&(u[h]=KM(r,r.mapDimension(i[h]),u[h]));return t}}function sk(e,t,r,n){var i={};return e.valueIndex!=null||e.valueDim!=null?(i.valueDataDim=e.valueIndex!=null?t.getDimension(e.valueIndex):e.valueDim,i.valueAxis=r.getAxis(irt(n,i.valueDataDim)),i.baseAxis=r.getOtherAxis(i.valueAxis),i.baseDataDim=t.mapDimension(i.baseAxis.dim)):(i.baseAxis=n.getBaseAxis(),i.valueAxis=r.getOtherAxis(i.baseAxis),i.baseDataDim=t.mapDimension(i.baseAxis.dim),i.valueDataDim=t.mapDimension(i.valueAxis.dim)),i}function irt(e,t){var r=e.getData().getDimensionInfo(t);return r&&r.coordDim}function ov(e,t){return e&&e.containData&&t.coord&&!RT(t)?e.containData(t.coord):!0}function art(e,t,r){return e&&e.containZone&&t.coord&&r.coord&&!RT(t)&&!RT(r)?e.containZone(t.coord,r.coord):!0}function lk(e,t){return e?function(r,n,i,a){var o=a<2?r.coord&&r.coord[a]:r.value;return Ds(o,t[a])}:function(r,n,i,a){return Ds(r.value,t[a])}}function KM(e,t,r){if(r==="average"){var n=0,i=0;return e.each(t,function(a,o){isNaN(a)||(n+=a,i++)}),n/i}else return r==="median"?e.getMedian(t):e.getDataExtent(t)[r==="max"?1:0]}var Ox=Le(),jM=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.init=function(){this.markerGroupMap=Ut()},t.prototype.render=function(r,n,i){var a=this,o=this.markerGroupMap;o.each(function(s){Ox(s).keep=!1}),n.eachSeries(function(s){var l=Uo.getMarkerModelFromSeries(s,a.type);l&&a.renderSeries(s,l,n,i)}),o.each(function(s){!Ox(s).keep&&a.group.remove(s.group)})},t.prototype.markKeep=function(r){Ox(r).keep=!0},t.prototype.toggleBlurSeries=function(r,n){var i=this;R(r,function(a){var o=Uo.getMarkerModelFromSeries(a,i.type);if(o){var s=o.getData();s.eachItemGraphicEl(function(l){l&&(n?qO(l):lw(l))})}})},t.type="marker",t}(nr);function YR(e,t,r){var n=t.coordinateSystem;e.each(function(i){var a=e.getItemModel(i),o,s=Tt(a.get("x"),r.getWidth()),l=Tt(a.get("y"),r.getHeight());if(!isNaN(s)&&!isNaN(l))o=[s,l];else if(t.getMarkerPosition)o=t.getMarkerPosition(e.getValues(e.dimensions,i));else if(n){var u=e.get(n.dimensions[0],i),h=e.get(n.dimensions[1],i);o=n.dataToPoint([u,h])}isNaN(s)||(o[0]=s),isNaN(l)||(o[1]=l),e.setItemLayout(i,o)})}var ort=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,n,i){n.eachSeries(function(a){var o=Uo.getMarkerModelFromSeries(a,"markPoint");o&&(YR(o.getData(),a,i),this.markerGroupMap.get(a.id).updateLayout())},this)},t.prototype.renderSeries=function(r,n,i,a){var o=r.coordinateSystem,s=r.id,l=r.getData(),u=this.markerGroupMap,h=u.get(s)||u.set(s,new Lv),f=srt(o,r,n);n.setData(f),YR(n.getData(),r,a),f.each(function(c){var d=f.getItemModel(c),v=d.getShallow("symbol"),p=d.getShallow("symbolSize"),g=d.getShallow("symbolRotate"),m=d.getShallow("symbolOffset"),_=d.getShallow("symbolKeepAspect");if(Yt(v)||Yt(p)||Yt(g)||Yt(m)){var y=n.getRawValue(c),x=n.getDataParams(c);Yt(v)&&(v=v(y,x)),Yt(p)&&(p=p(y,x)),Yt(g)&&(g=g(y,x)),Yt(m)&&(m=m(y,x))}var T=d.getModel("itemStyle").getItemStyle(),S=Av(l,"color");T.fill||(T.fill=S),f.setItemVisual(c,{symbol:v,symbolSize:p,symbolRotate:g,symbolOffset:m,symbolKeepAspect:_,style:T})}),h.updateData(f),this.group.add(h.group),f.eachItemGraphicEl(function(c){c.traverse(function(d){oe(d).dataModel=n})}),this.markKeep(h),h.group.silent=n.get("silent")||r.get("silent")},t.type="markPoint",t}(jM);function srt(e,t,r){var n;e?n=ft(e&&e.dimensions,function(s){var l=t.getData().getDimensionInfo(t.getData().mapDimension(s))||{};return rt(rt({},l),{name:s,ordinalMeta:null})}):n=[{name:"value",type:"float"}];var i=new xr(n,r),a=ft(r.get("data"),ue(av,t));e&&(a=Xe(a,ue(ov,e)));var o=lk(!!e,n);return i.initData(a,null,o),i}function lrt(e){e.registerComponentModel(rrt),e.registerComponentView(ort),e.registerPreprocessor(function(t){$M(t.series,"markPoint")&&(t.markPoint=t.markPoint||{})})}var urt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,n,i){return new t(r,n,i)},t.type="markLine",t.defaultOption={z:5,symbol:["circle","arrow"],symbolSize:[8,16],symbolOffset:0,precision:2,tooltip:{trigger:"item"},label:{show:!0,position:"end",distance:5},lineStyle:{type:"dashed"},emphasis:{label:{show:!0},lineStyle:{width:3}},animationEasing:"linear"},t}(Uo),qp=Le(),hrt=function(e,t,r,n){var i=e.getData(),a;if(at(n))a=n;else{var o=n.type;if(o==="min"||o==="max"||o==="average"||o==="median"||n.xAxis!=null||n.yAxis!=null){var s=void 0,l=void 0;if(n.yAxis!=null||n.xAxis!=null)s=t.getAxis(n.yAxis!=null?"y":"x"),l=pn(n.yAxis,n.xAxis);else{var u=sk(n,i,t,e);s=u.valueAxis;var h=zw(i,u.valueDataDim);l=KM(i,h,o)}var f=s.dim==="x"?0:1,c=1-f,d=Qt(n),v={coord:[]};d.type=null,d.coord=[],d.coord[c]=-1/0,v.coord[c]=1/0;var p=r.get("precision");p>=0&&Be(l)&&(l=+l.toFixed(Math.min(p,20))),d.coord[f]=v.coord[f]=l,a=[d,v,{type:o,valueIndex:n.valueIndex,value:l}]}else a=[]}var g=[av(e,a[0]),av(e,a[1]),rt({},a[2])];return g[2].type=g[2].type||null,Ot(g[2],g[0]),Ot(g[2],g[1]),g};function Jm(e){return!isNaN(e)&&!isFinite(e)}function ZR(e,t,r,n){var i=1-e,a=n.dimensions[e];return Jm(t[i])&&Jm(r[i])&&t[e]===r[e]&&n.getAxis(a).containData(t[e])}function frt(e,t){if(e.type==="cartesian2d"){var r=t[0].coord,n=t[1].coord;if(r&&n&&(ZR(1,r,n,e)||ZR(0,r,n,e)))return!0}return ov(e,t[0])&&ov(e,t[1])}function Fx(e,t,r,n,i){var a=n.coordinateSystem,o=e.getItemModel(t),s,l=Tt(o.get("x"),i.getWidth()),u=Tt(o.get("y"),i.getHeight());if(!isNaN(l)&&!isNaN(u))s=[l,u];else{if(n.getMarkerPosition)s=n.getMarkerPosition(e.getValues(e.dimensions,t));else{var h=a.dimensions,f=e.get(h[0],t),c=e.get(h[1],t);s=a.dataToPoint([f,c])}if(Vu(a,"cartesian2d")){var d=a.getAxis("x"),v=a.getAxis("y"),h=a.dimensions;Jm(e.get(h[0],t))?s[0]=d.toGlobalCoord(d.getExtent()[r?0:1]):Jm(e.get(h[1],t))&&(s[1]=v.toGlobalCoord(v.getExtent()[r?0:1]))}isNaN(l)||(s[0]=l),isNaN(u)||(s[1]=u)}e.setItemLayout(t,s)}var crt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,n,i){n.eachSeries(function(a){var o=Uo.getMarkerModelFromSeries(a,"markLine");if(o){var s=o.getData(),l=qp(o).from,u=qp(o).to;l.each(function(h){Fx(l,h,!0,a,i),Fx(u,h,!1,a,i)}),s.each(function(h){s.setItemLayout(h,[l.getItemLayout(h),u.getItemLayout(h)])}),this.markerGroupMap.get(a.id).updateLayout()}},this)},t.prototype.renderSeries=function(r,n,i,a){var o=r.coordinateSystem,s=r.id,l=r.getData(),u=this.markerGroupMap,h=u.get(s)||u.set(s,new _M);this.group.add(h.group);var f=drt(o,r,n),c=f.from,d=f.to,v=f.line;qp(n).from=c,qp(n).to=d,n.setData(v);var p=n.get("symbol"),g=n.get("symbolSize"),m=n.get("symbolRotate"),_=n.get("symbolOffset");at(p)||(p=[p,p]),at(g)||(g=[g,g]),at(m)||(m=[m,m]),at(_)||(_=[_,_]),f.from.each(function(x){y(c,x,!0),y(d,x,!1)}),v.each(function(x){var T=v.getItemModel(x).getModel("lineStyle").getLineStyle();v.setItemLayout(x,[c.getItemLayout(x),d.getItemLayout(x)]),T.stroke==null&&(T.stroke=c.getItemVisual(x,"style").fill),v.setItemVisual(x,{fromSymbolKeepAspect:c.getItemVisual(x,"symbolKeepAspect"),fromSymbolOffset:c.getItemVisual(x,"symbolOffset"),fromSymbolRotate:c.getItemVisual(x,"symbolRotate"),fromSymbolSize:c.getItemVisual(x,"symbolSize"),fromSymbol:c.getItemVisual(x,"symbol"),toSymbolKeepAspect:d.getItemVisual(x,"symbolKeepAspect"),toSymbolOffset:d.getItemVisual(x,"symbolOffset"),toSymbolRotate:d.getItemVisual(x,"symbolRotate"),toSymbolSize:d.getItemVisual(x,"symbolSize"),toSymbol:d.getItemVisual(x,"symbol"),style:T})}),h.updateData(v),f.line.eachItemGraphicEl(function(x){oe(x).dataModel=n,x.traverse(function(T){oe(T).dataModel=n})});function y(x,T,S){var M=x.getItemModel(T);Fx(x,T,S,r,a);var w=M.getModel("itemStyle").getItemStyle();w.fill==null&&(w.fill=Av(l,"color")),x.setItemVisual(T,{symbolKeepAspect:M.get("symbolKeepAspect"),symbolOffset:se(M.get("symbolOffset",!0),_[S?0:1]),symbolRotate:se(M.get("symbolRotate",!0),m[S?0:1]),symbolSize:se(M.get("symbolSize"),g[S?0:1]),symbol:se(M.get("symbol",!0),p[S?0:1]),style:w})}this.markKeep(h),h.group.silent=n.get("silent")||r.get("silent")},t.type="markLine",t}(jM);function drt(e,t,r){var n;e?n=ft(e&&e.dimensions,function(u){var h=t.getData().getDimensionInfo(t.getData().mapDimension(u))||{};return rt(rt({},h),{name:u,ordinalMeta:null})}):n=[{name:"value",type:"float"}];var i=new xr(n,r),a=new xr(n,r),o=new xr([],r),s=ft(r.get("data"),ue(hrt,t,e,r));e&&(s=Xe(s,ue(frt,e)));var l=lk(!!e,n);return i.initData(ft(s,function(u){return u[0]}),null,l),a.initData(ft(s,function(u){return u[1]}),null,l),o.initData(ft(s,function(u){return u[2]})),o.hasItemOption=!0,{from:i,to:a,line:o}}function vrt(e){e.registerComponentModel(urt),e.registerComponentView(crt),e.registerPreprocessor(function(t){$M(t.series,"markLine")&&(t.markLine=t.markLine||{})})}var prt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.createMarkerModelFromSeries=function(r,n,i){return new t(r,n,i)},t.type="markArea",t.defaultOption={z:1,tooltip:{trigger:"item"},animation:!1,label:{show:!0,position:"top"},itemStyle:{borderWidth:0},emphasis:{label:{show:!0,position:"top"}}},t}(Uo),$p=Le(),grt=function(e,t,r,n){var i=n[0],a=n[1];if(!(!i||!a)){var o=av(e,i),s=av(e,a),l=o.coord,u=s.coord;l[0]=pn(l[0],-1/0),l[1]=pn(l[1],-1/0),u[0]=pn(u[0],1/0),u[1]=pn(u[1],1/0);var h=Hb([{},o,s]);return h.coord=[o.coord,s.coord],h.x0=o.x,h.y0=o.y,h.x1=s.x,h.y1=s.y,h}};function Qm(e){return!isNaN(e)&&!isFinite(e)}function qR(e,t,r,n){var i=1-e;return Qm(t[i])&&Qm(r[i])}function mrt(e,t){var r=t.coord[0],n=t.coord[1],i={coord:r,x:t.x0,y:t.y0},a={coord:n,x:t.x1,y:t.y1};return Vu(e,"cartesian2d")?r&&n&&(qR(1,r,n)||qR(0,r,n))?!0:art(e,i,a):ov(e,i)||ov(e,a)}function $R(e,t,r,n,i){var a=n.coordinateSystem,o=e.getItemModel(t),s,l=Tt(o.get(r[0]),i.getWidth()),u=Tt(o.get(r[1]),i.getHeight());if(!isNaN(l)&&!isNaN(u))s=[l,u];else{if(n.getMarkerPosition){var h=e.getValues(["x0","y0"],t),f=e.getValues(["x1","y1"],t),c=a.clampData(h),d=a.clampData(f),v=[];r[0]==="x0"?v[0]=c[0]>d[0]?f[0]:h[0]:v[0]=c[0]>d[0]?h[0]:f[0],r[1]==="y0"?v[1]=c[1]>d[1]?f[1]:h[1]:v[1]=c[1]>d[1]?h[1]:f[1],s=n.getMarkerPosition(v,r,!0)}else{var p=e.get(r[0],t),g=e.get(r[1],t),m=[p,g];a.clampData&&a.clampData(m,m),s=a.dataToPoint(m,!0)}if(Vu(a,"cartesian2d")){var _=a.getAxis("x"),y=a.getAxis("y"),p=e.get(r[0],t),g=e.get(r[1],t);Qm(p)?s[0]=_.toGlobalCoord(_.getExtent()[r[0]==="x0"?0:1]):Qm(g)&&(s[1]=y.toGlobalCoord(y.getExtent()[r[1]==="y0"?0:1]))}isNaN(l)||(s[0]=l),isNaN(u)||(s[1]=u)}return s}var KR=[["x0","y0"],["x1","y0"],["x1","y1"],["x0","y1"]],_rt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.updateTransform=function(r,n,i){n.eachSeries(function(a){var o=Uo.getMarkerModelFromSeries(a,"markArea");if(o){var s=o.getData();s.each(function(l){var u=ft(KR,function(f){return $R(s,l,f,a,i)});s.setItemLayout(l,u);var h=s.getItemGraphicEl(l);h.setShape("points",u)})}},this)},t.prototype.renderSeries=function(r,n,i,a){var o=r.coordinateSystem,s=r.id,l=r.getData(),u=this.markerGroupMap,h=u.get(s)||u.set(s,{group:new re});this.group.add(h.group),this.markKeep(h);var f=yrt(o,r,n);n.setData(f),f.each(function(c){var d=ft(KR,function(w){return $R(f,c,w,r,a)}),v=o.getAxis("x").scale,p=o.getAxis("y").scale,g=v.getExtent(),m=p.getExtent(),_=[v.parse(f.get("x0",c)),v.parse(f.get("x1",c))],y=[p.parse(f.get("y0",c)),p.parse(f.get("y1",c))];ki(_),ki(y);var x=!(g[0]>_[1]||g[1]<_[0]||m[0]>y[1]||m[1]<y[0]),T=!x;f.setItemLayout(c,{points:d,allClipped:T});var S=f.getItemModel(c).getModel("itemStyle").getItemStyle(),M=Av(l,"color");S.fill||(S.fill=M,Ct(S.fill)&&(S.fill=dm(S.fill,.4))),S.stroke||(S.stroke=M),f.setItemVisual(c,"style",S)}),f.diff($p(h).data).add(function(c){var d=f.getItemLayout(c);if(!d.allClipped){var v=new Yn({shape:{points:d.points}});f.setItemGraphicEl(c,v),h.group.add(v)}}).update(function(c,d){var v=$p(h).data.getItemGraphicEl(d),p=f.getItemLayout(c);p.allClipped?v&&h.group.remove(v):(v?ke(v,{shape:{points:p.points}},n,c):v=new Yn({shape:{points:p.points}}),f.setItemGraphicEl(c,v),h.group.add(v))}).remove(function(c){var d=$p(h).data.getItemGraphicEl(c);h.group.remove(d)}).execute(),f.eachItemGraphicEl(function(c,d){var v=f.getItemModel(d),p=f.getItemVisual(d,"style");c.useStyle(f.getItemVisual(d,"style")),Sn(c,an(v),{labelFetcher:n,labelDataIndex:d,defaultText:f.getName(d)||"",inheritColor:Ct(p.fill)?dm(p.fill,1):"#000"}),xn(c,v),Sr(c,null,null,v.get(["emphasis","disabled"])),oe(c).dataModel=n}),$p(h).data=f,h.group.silent=n.get("silent")||r.get("silent")},t.type="markArea",t}(jM);function yrt(e,t,r){var n,i,a=["x0","y0","x1","y1"];if(e){var o=ft(e&&e.dimensions,function(u){var h=t.getData(),f=h.getDimensionInfo(h.mapDimension(u))||{};return rt(rt({},f),{name:u,ordinalMeta:null})});i=ft(a,function(u,h){return{name:u,type:o[h%2].type}}),n=new xr(i,r)}else i=[{name:"value",type:"float"}],n=new xr(i,r);var s=ft(r.get("data"),ue(grt,t,e,r));e&&(s=Xe(s,ue(mrt,e)));var l=e?function(u,h,f,c){var d=u.coord[Math.floor(c/2)][c%2];return Ds(d,i[c])}:function(u,h,f,c){return Ds(u.value,i[c])};return n.initData(s,null,l),n.hasItemOption=!0,n}function xrt(e){e.registerComponentModel(prt),e.registerComponentView(_rt),e.registerPreprocessor(function(t){$M(t.series,"markArea")&&(t.markArea=t.markArea||{})})}var Srt=function(e,t){if(t==="all")return{type:"all",title:e.getLocaleModel().get(["legend","selector","all"])};if(t==="inverse")return{type:"inverse",title:e.getLocaleModel().get(["legend","selector","inverse"])}},PT=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.layoutMode={type:"box",ignoreSize:!0},r}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i),r.selected=r.selected||{},this._updateSelector(r)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),this._updateSelector(r)},t.prototype._updateSelector=function(r){var n=r.selector,i=this.ecModel;n===!0&&(n=r.selector=["all","inverse"]),at(n)&&R(n,function(a,o){Ct(a)&&(a={type:a}),n[o]=Ot(a,Srt(i,a.type))})},t.prototype.optionUpdated=function(){this._updateData(this.ecModel);var r=this._data;if(r[0]&&this.get("selectedMode")==="single"){for(var n=!1,i=0;i<r.length;i++){var a=r[i].get("name");if(this.isSelected(a)){this.select(a),n=!0;break}}!n&&this.select(r[0].get("name"))}},t.prototype._updateData=function(r){var n=[],i=[];r.eachRawSeries(function(l){var u=l.name;i.push(u);var h;if(l.legendVisualProvider){var f=l.legendVisualProvider,c=f.getAllNames();r.isSeriesFiltered(l)||(i=i.concat(c)),c.length?n=n.concat(c):h=!0}else h=!0;h&&tw(l)&&n.push(l.name)}),this._availableNames=i;var a=this.get("data")||n,o=Ut(),s=ft(a,function(l){return(Ct(l)||Be(l))&&(l={name:l}),o.get(l.name)?null:(o.set(l.name,!0),new Ie(l,this,this.ecModel))},this);this._data=Xe(s,function(l){return!!l})},t.prototype.getData=function(){return this._data},t.prototype.select=function(r){var n=this.option.selected,i=this.get("selectedMode");if(i==="single"){var a=this._data;R(a,function(o){n[o.get("name")]=!1})}n[r]=!0},t.prototype.unSelect=function(r){this.get("selectedMode")!=="single"&&(this.option.selected[r]=!1)},t.prototype.toggleSelected=function(r){var n=this.option.selected;n.hasOwnProperty(r)||(n[r]=!0),this[n[r]?"unSelect":"select"](r)},t.prototype.allSelect=function(){var r=this._data,n=this.option.selected;R(r,function(i){n[i.get("name",!0)]=!0})},t.prototype.inverseSelect=function(){var r=this._data,n=this.option.selected;R(r,function(i){var a=i.get("name",!0);n.hasOwnProperty(a)||(n[a]=!0),n[a]=!n[a]})},t.prototype.isSelected=function(r){var n=this.option.selected;return!(n.hasOwnProperty(r)&&!n[r])&&pe(this._availableNames,r)>=0},t.prototype.getOrient=function(){return this.get("orient")==="vertical"?{index:1,name:"vertical"}:{index:0,name:"horizontal"}},t.type="legend.plain",t.dependencies=["series"],t.defaultOption={z:4,show:!0,orient:"horizontal",left:"center",top:0,align:"auto",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",borderRadius:0,borderWidth:0,padding:5,itemGap:10,itemWidth:25,itemHeight:14,symbolRotate:"inherit",symbolKeepAspect:!0,inactiveColor:"#ccc",inactiveBorderColor:"#ccc",inactiveBorderWidth:"auto",itemStyle:{color:"inherit",opacity:"inherit",borderColor:"inherit",borderWidth:"auto",borderCap:"inherit",borderJoin:"inherit",borderDashOffset:"inherit",borderMiterLimit:"inherit"},lineStyle:{width:"auto",color:"inherit",inactiveColor:"#ccc",inactiveWidth:2,opacity:"inherit",type:"inherit",cap:"inherit",join:"inherit",dashOffset:"inherit",miterLimit:"inherit"},textStyle:{color:"#333"},selectedMode:!0,selector:!1,selectorLabel:{show:!0,borderRadius:10,padding:[3,5,3,5],fontSize:12,fontFamily:"sans-serif",color:"#666",borderWidth:1,borderColor:"#666"},emphasis:{selectorLabel:{show:!0,color:"#eee",backgroundColor:"#666"}},selectorPosition:"auto",selectorItemGap:7,selectorButtonGap:10,tooltip:{show:!1}},t}(me),ch=ue,IT=R,Kp=re,uk=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!1,r}return t.prototype.init=function(){this.group.add(this._contentGroup=new Kp),this.group.add(this._selectorGroup=new Kp),this._isFirstRender=!0},t.prototype.getContentGroup=function(){return this._contentGroup},t.prototype.getSelectorGroup=function(){return this._selectorGroup},t.prototype.render=function(r,n,i){var a=this._isFirstRender;if(this._isFirstRender=!1,this.resetInner(),!!r.get("show",!0)){var o=r.get("align"),s=r.get("orient");(!o||o==="auto")&&(o=r.get("left")==="right"&&s==="vertical"?"right":"left");var l=r.get("selector",!0),u=r.get("selectorPosition",!0);l&&(!u||u==="auto")&&(u=s==="horizontal"?"end":"start"),this.renderInner(o,r,n,i,l,s,u);var h=r.getBoxLayoutParams(),f={width:i.getWidth(),height:i.getHeight()},c=r.get("padding"),d=Mr(h,f,c),v=this.layoutInner(r,o,d,a,l,u),p=Mr(Vt({width:v.width,height:v.height},h),f,c);this.group.x=p.x-v.x,this.group.y=p.y-v.y,this.group.markRedraw(),this.group.add(this._backgroundEl=jz(v,r))}},t.prototype.resetInner=function(){this.getContentGroup().removeAll(),this._backgroundEl&&this.group.remove(this._backgroundEl),this.getSelectorGroup().removeAll()},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this.getContentGroup(),h=Ut(),f=n.get("selectedMode"),c=[];i.eachRawSeries(function(d){!d.get("legendHoverLink")&&c.push(d.id)}),IT(n.getData(),function(d,v){var p=d.get("name");if(!this.newlineDisabled&&(p===""||p===`
`)){var g=new Kp;g.newline=!0,u.add(g);return}var m=i.getSeriesByName(p)[0];if(!h.get(p))if(m){var _=m.getData(),y=_.getVisual("legendLineStyle")||{},x=_.getVisual("legendIcon"),T=_.getVisual("style"),S=this._createItem(m,p,v,d,n,r,y,T,x,f,a);S.on("click",ch(jR,p,null,a,c)).on("mouseover",ch(NT,m.name,null,a,c)).on("mouseout",ch(OT,m.name,null,a,c)),i.ssr&&S.eachChild(function(M){var w=oe(M);w.seriesIndex=m.seriesIndex,w.dataIndex=v,w.ssrType="legend"}),h.set(p,!0)}else i.eachRawSeries(function(M){if(!h.get(p)&&M.legendVisualProvider){var w=M.legendVisualProvider;if(!w.containName(p))return;var b=w.indexOfName(p),A=w.getItemVisual(b,"style"),E=w.getItemVisual(b,"legendIcon"),C=kn(A.fill);C&&C[3]===0&&(C[3]=.2,A=rt(rt({},A),{fill:Mo(C,"rgba")}));var D=this._createItem(M,p,v,d,n,r,{},A,E,f,a);D.on("click",ch(jR,null,p,a,c)).on("mouseover",ch(NT,null,p,a,c)).on("mouseout",ch(OT,null,p,a,c)),i.ssr&&D.eachChild(function(L){var P=oe(L);P.seriesIndex=M.seriesIndex,P.dataIndex=v,P.ssrType="legend"}),h.set(p,!0)}},this)},this),o&&this._createSelector(o,n,a,s,l)},t.prototype._createSelector=function(r,n,i,a,o){var s=this.getSelectorGroup();IT(r,function(u){var h=u.type,f=new we({style:{x:0,y:0,align:"center",verticalAlign:"middle"},onclick:function(){i.dispatchAction({type:h==="all"?"legendAllSelect":"legendInverseSelect",legendId:n.id})}});s.add(f);var c=n.getModel("selectorLabel"),d=n.getModel(["emphasis","selectorLabel"]);Sn(f,{normal:c,emphasis:d},{defaultText:u.title}),cu(f)})},t.prototype._createItem=function(r,n,i,a,o,s,l,u,h,f,c){var d=r.visualDrawType,v=o.get("itemWidth"),p=o.get("itemHeight"),g=o.isSelected(n),m=a.get("symbolRotate"),_=a.get("symbolKeepAspect"),y=a.get("icon");h=y||h||"roundRect";var x=Trt(h,a,l,u,d,g,c),T=new Kp,S=a.getModel("textStyle");if(Yt(r.getLegendIcon)&&(!y||y==="inherit"))T.add(r.getLegendIcon({itemWidth:v,itemHeight:p,icon:h,iconRotate:m,itemStyle:x.itemStyle,lineStyle:x.lineStyle,symbolKeepAspect:_}));else{var M=y==="inherit"&&r.getData().getVisual("symbol")?m==="inherit"?r.getData().getVisual("symbolRotate"):m:0;T.add(brt({itemWidth:v,itemHeight:p,icon:h,iconRotate:M,itemStyle:x.itemStyle,lineStyle:x.lineStyle,symbolKeepAspect:_}))}var w=s==="left"?v+5:-5,b=s,A=o.get("formatter"),E=n;Ct(A)&&A?E=A.replace("{name}",n??""):Yt(A)&&(E=A(n));var C=g?S.getTextColor():a.get("inactiveColor");T.add(new we({style:je(S,{text:E,x:w,y:p/2,fill:C,align:b,verticalAlign:"middle"},{inheritColor:C})}));var D=new Ae({shape:T.getBoundingRect(),style:{fill:"transparent"}}),L=a.getModel("tooltip");return L.get("show")&&Uu({el:D,componentModel:o,itemName:n,itemTooltipOption:L.option}),T.add(D),T.eachChild(function(P){P.silent=!0}),D.silent=!f,this.getContentGroup().add(T),cu(T),T.__legendDataIndex=i,T},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getContentGroup(),u=this.getSelectorGroup();vu(r.get("orient"),l,r.get("itemGap"),i.width,i.height);var h=l.getBoundingRect(),f=[-h.x,-h.y];if(u.markRedraw(),l.markRedraw(),o){vu("horizontal",u,r.get("selectorItemGap",!0));var c=u.getBoundingRect(),d=[-c.x,-c.y],v=r.get("selectorButtonGap",!0),p=r.getOrient().index,g=p===0?"width":"height",m=p===0?"height":"width",_=p===0?"y":"x";s==="end"?d[p]+=h[g]+v:f[p]+=c[g]+v,d[1-p]+=h[m]/2-c[m]/2,u.x=d[0],u.y=d[1],l.x=f[0],l.y=f[1];var y={x:0,y:0};return y[g]=h[g]+v+c[g],y[m]=Math.max(h[m],c[m]),y[_]=Math.min(0,c[_]+d[1-p]),y}else return l.x=f[0],l.y=f[1],this.group.getBoundingRect()},t.prototype.remove=function(){this.getContentGroup().removeAll(),this._isFirstRender=!0},t.type="legend.plain",t}(nr);function Trt(e,t,r,n,i,a,o){function s(g,m){g.lineWidth==="auto"&&(g.lineWidth=m.lineWidth>0?2:0),IT(g,function(_,y){g[y]==="inherit"&&(g[y]=m[y])})}var l=t.getModel("itemStyle"),u=l.getItemStyle(),h=e.lastIndexOf("empty",0)===0?"fill":"stroke",f=l.getShallow("decal");u.decal=!f||f==="inherit"?n.decal:df(f,o),u.fill==="inherit"&&(u.fill=n[i]),u.stroke==="inherit"&&(u.stroke=n[h]),u.opacity==="inherit"&&(u.opacity=(i==="fill"?n:r).opacity),s(u,n);var c=t.getModel("lineStyle"),d=c.getLineStyle();if(s(d,r),u.fill==="auto"&&(u.fill=n.fill),u.stroke==="auto"&&(u.stroke=n.fill),d.stroke==="auto"&&(d.stroke=n.fill),!a){var v=t.get("inactiveBorderWidth"),p=u[h];u.lineWidth=v==="auto"?n.lineWidth>0&&p?2:0:u.lineWidth,u.fill=t.get("inactiveColor"),u.stroke=t.get("inactiveBorderColor"),d.stroke=c.get("inactiveColor"),d.lineWidth=c.get("inactiveWidth")}return{itemStyle:u,lineStyle:d}}function brt(e){var t=e.icon||"roundRect",r=Pr(t,0,0,e.itemWidth,e.itemHeight,e.itemStyle.fill,e.symbolKeepAspect);return r.setStyle(e.itemStyle),r.rotation=(e.iconRotate||0)*Math.PI/180,r.setOrigin([e.itemWidth/2,e.itemHeight/2]),t.indexOf("empty")>-1&&(r.style.stroke=r.style.fill,r.style.fill="#fff",r.style.lineWidth=2),r}function jR(e,t,r,n){OT(e,t,r,n),r.dispatchAction({type:"legendToggleSelect",name:e??t}),NT(e,t,r,n)}function hk(e){for(var t=e.getZr().storage.getDisplayList(),r,n=0,i=t.length;n<i&&!(r=t[n].states.emphasis);)n++;return r&&r.hoverLayer}function NT(e,t,r,n){hk(r)||r.dispatchAction({type:"highlight",seriesName:e,name:t,excludeSeriesId:n})}function OT(e,t,r,n){hk(r)||r.dispatchAction({type:"downplay",seriesName:e,name:t,excludeSeriesId:n})}function wrt(e){var t=e.findComponents({mainType:"legend"});t&&t.length&&e.filterSeries(function(r){for(var n=0;n<t.length;n++)if(!t[n].isSelected(r.name))return!1;return!0})}function Fc(e,t,r){var n=e==="allSelect"||e==="inverseSelect",i={},a=[];r.eachComponent({mainType:"legend",query:t},function(s){n?s[e]():s[e](t.name),JR(s,i),a.push(s.componentIndex)});var o={};return r.eachComponent("legend",function(s){R(i,function(l,u){s[l?"select":"unSelect"](u)}),JR(s,o)}),n?{selected:o,legendIndex:a}:{name:t.name,selected:o}}function JR(e,t){var r=t||{};return R(e.getData(),function(n){var i=n.get("name");if(!(i===`
`||i==="")){var a=e.isSelected(i);Ft(r,i)?r[i]=r[i]&&a:r[i]=a}}),r}function Mrt(e){e.registerAction("legendToggleSelect","legendselectchanged",ue(Fc,"toggleSelected")),e.registerAction("legendAllSelect","legendselectall",ue(Fc,"allSelect")),e.registerAction("legendInverseSelect","legendinverseselect",ue(Fc,"inverseSelect")),e.registerAction("legendSelect","legendselected",ue(Fc,"select")),e.registerAction("legendUnSelect","legendunselected",ue(Fc,"unSelect"))}function fk(e){e.registerComponentModel(PT),e.registerComponentView(uk),e.registerProcessor(e.PRIORITY.PROCESSOR.SERIES_FILTER,wrt),e.registerSubTypeDefaulter("legend",function(){return"plain"}),Mrt(e)}var Art=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.setScrollDataIndex=function(r){this.option.scrollDataIndex=r},t.prototype.init=function(r,n,i){var a=Wf(r);e.prototype.init.call(this,r,n,i),QR(this,r,a)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),QR(this,this.option,r)},t.type="legend.scroll",t.defaultOption=Ws(PT.defaultOption,{scrollDataIndex:0,pageButtonItemGap:5,pageButtonGap:null,pageButtonPosition:"end",pageFormatter:"{current}/{total}",pageIcons:{horizontal:["M0,0L12,-10L12,10z","M0,0L-12,-10L-12,10z"],vertical:["M0,0L20,0L10,-20z","M0,0L20,0L10,20z"]},pageIconColor:"#2f4554",pageIconInactiveColor:"#aaa",pageIconSize:15,pageTextStyle:{color:"#333"},animationDurationUpdate:800}),t}(PT);function QR(e,t,r){var n=e.getOrient(),i=[1,1];i[n.index]=0,Bs(t,r,{type:"box",ignoreSize:!!i})}var tP=re,Bx=["width","height"],Ux=["x","y"],Ert=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.newlineDisabled=!0,r._currentIndex=0,r}return t.prototype.init=function(){e.prototype.init.call(this),this.group.add(this._containerGroup=new tP),this._containerGroup.add(this.getContentGroup()),this.group.add(this._controllerGroup=new tP)},t.prototype.resetInner=function(){e.prototype.resetInner.call(this),this._controllerGroup.removeAll(),this._containerGroup.removeClipPath(),this._containerGroup.__rectSize=null},t.prototype.renderInner=function(r,n,i,a,o,s,l){var u=this;e.prototype.renderInner.call(this,r,n,i,a,o,s,l);var h=this._controllerGroup,f=n.get("pageIconSize",!0),c=at(f)?f:[f,f];v("pagePrev",0);var d=n.getModel("pageTextStyle");h.add(new we({name:"pageText",style:{text:"xx/xx",fill:d.getTextColor(),font:d.getFont(),verticalAlign:"middle",align:"center"},silent:!0})),v("pageNext",1);function v(p,g){var m=p+"DataIndex",_=Mv(n.get("pageIcons",!0)[n.getOrient().name][g],{onclick:It(u._pageGo,u,m,n,a)},{x:-c[0]/2,y:-c[1]/2,width:c[0],height:c[1]});_.name=p,h.add(_)}},t.prototype.layoutInner=function(r,n,i,a,o,s){var l=this.getSelectorGroup(),u=r.getOrient().index,h=Bx[u],f=Ux[u],c=Bx[1-u],d=Ux[1-u];o&&vu("horizontal",l,r.get("selectorItemGap",!0));var v=r.get("selectorButtonGap",!0),p=l.getBoundingRect(),g=[-p.x,-p.y],m=Qt(i);o&&(m[h]=i[h]-p[h]-v);var _=this._layoutContentAndController(r,a,m,u,h,c,d,f);if(o){if(s==="end")g[u]+=_[h]+v;else{var y=p[h]+v;g[u]-=y,_[f]-=y}_[h]+=p[h]+v,g[1-u]+=_[d]+_[c]/2-p[c]/2,_[c]=Math.max(_[c],p[c]),_[d]=Math.min(_[d],p[d]+g[1-u]),l.x=g[0],l.y=g[1],l.markRedraw()}return _},t.prototype._layoutContentAndController=function(r,n,i,a,o,s,l,u){var h=this.getContentGroup(),f=this._containerGroup,c=this._controllerGroup;vu(r.get("orient"),h,r.get("itemGap"),a?i.width:null,a?null:i.height),vu("horizontal",c,r.get("pageButtonItemGap",!0));var d=h.getBoundingRect(),v=c.getBoundingRect(),p=this._showController=d[o]>i[o],g=[-d.x,-d.y];n||(g[a]=h[u]);var m=[0,0],_=[-v.x,-v.y],y=se(r.get("pageButtonGap",!0),r.get("itemGap",!0));if(p){var x=r.get("pageButtonPosition",!0);x==="end"?_[a]+=i[o]-v[o]:m[a]+=v[o]+y}_[1-a]+=d[s]/2-v[s]/2,h.setPosition(g),f.setPosition(m),c.setPosition(_);var T={x:0,y:0};if(T[o]=p?i[o]:d[o],T[s]=Math.max(d[s],v[s]),T[l]=Math.min(0,v[l]+_[1-a]),f.__rectSize=i[o],p){var S={x:0,y:0};S[o]=Math.max(i[o]-v[o]-y,0),S[s]=T[s],f.setClipPath(new Ae({shape:S})),f.__rectSize=S[o]}else c.eachChild(function(w){w.attr({invisible:!0,silent:!0})});var M=this._getPageInfo(r);return M.pageIndex!=null&&ke(h,{x:M.contentPosition[0],y:M.contentPosition[1]},p?r:null),this._updatePageInfoView(r,M),T},t.prototype._pageGo=function(r,n,i){var a=this._getPageInfo(n)[r];a!=null&&i.dispatchAction({type:"legendScroll",scrollDataIndex:a,legendId:n.id})},t.prototype._updatePageInfoView=function(r,n){var i=this._controllerGroup;R(["pagePrev","pageNext"],function(h){var f=h+"DataIndex",c=n[f]!=null,d=i.childOfName(h);d&&(d.setStyle("fill",c?r.get("pageIconColor",!0):r.get("pageIconInactiveColor",!0)),d.cursor=c?"pointer":"default")});var a=i.childOfName("pageText"),o=r.get("pageFormatter"),s=n.pageIndex,l=s!=null?s+1:0,u=n.pageCount;a&&o&&a.setStyle("text",Ct(o)?o.replace("{current}",l==null?"":l+"").replace("{total}",u==null?"":u+""):o({current:l,total:u}))},t.prototype._getPageInfo=function(r){var n=r.get("scrollDataIndex",!0),i=this.getContentGroup(),a=this._containerGroup.__rectSize,o=r.getOrient().index,s=Bx[o],l=Ux[o],u=this._findTargetItemIndex(n),h=i.children(),f=h[u],c=h.length,d=c?1:0,v={contentPosition:[i.x,i.y],pageCount:d,pageIndex:d-1,pagePrevDataIndex:null,pageNextDataIndex:null};if(!f)return v;var p=x(f);v.contentPosition[o]=-p.s;for(var g=u+1,m=p,_=p,y=null;g<=c;++g)y=x(h[g]),(!y&&_.e>m.s+a||y&&!T(y,m.s))&&(_.i>m.i?m=_:m=y,m&&(v.pageNextDataIndex==null&&(v.pageNextDataIndex=m.i),++v.pageCount)),_=y;for(var g=u-1,m=p,_=p,y=null;g>=-1;--g)y=x(h[g]),(!y||!T(_,y.s))&&m.i<_.i&&(_=m,v.pagePrevDataIndex==null&&(v.pagePrevDataIndex=m.i),++v.pageCount,++v.pageIndex),m=y;return v;function x(S){if(S){var M=S.getBoundingRect(),w=M[l]+S[l];return{s:w,e:w+M[s],i:S.__legendDataIndex}}}function T(S,M){return S.e>=M&&S.s<=M+a}},t.prototype._findTargetItemIndex=function(r){if(!this._showController)return 0;var n,i=this.getContentGroup(),a;return i.eachChild(function(o,s){var l=o.__legendDataIndex;a==null&&l!=null&&(a=s),l===r&&(n=s)}),n??a},t.type="legend.scroll",t}(uk);function Crt(e){e.registerAction("legendScroll","legendscroll",function(t,r){var n=t.scrollDataIndex;n!=null&&r.eachComponent({mainType:"legend",subType:"scroll",query:t},function(i){i.setScrollDataIndex(n)})})}function Drt(e){te(fk),e.registerComponentModel(Art),e.registerComponentView(Ert),Crt(e)}function Lrt(e){te(fk),te(Drt)}var Rrt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.inside",t.defaultOption=Ws(iv.defaultOption,{disabled:!1,zoomLock:!1,zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!1,preventDefaultMouseMove:!0}),t}(iv),JM=Le();function Prt(e,t,r){JM(e).coordSysRecordMap.each(function(n){var i=n.dataZoomInfoMap.get(t.uid);i&&(i.getRange=r)})}function Irt(e,t){for(var r=JM(e).coordSysRecordMap,n=r.keys(),i=0;i<n.length;i++){var a=n[i],o=r.get(a),s=o.dataZoomInfoMap;if(s){var l=t.uid,u=s.get(l);u&&(s.removeKey(l),s.keys().length||ck(r,o))}}}function ck(e,t){if(t){e.removeKey(t.model.uid);var r=t.controller;r&&r.dispose()}}function Nrt(e,t){var r={model:t,containsPoint:ue(Frt,t),dispatchAction:ue(Ort,e),dataZoomInfoMap:null,controller:null},n=r.controller=new Ov(e.getZr());return R(["pan","zoom","scrollMove"],function(i){n.on(i,function(a){var o=[];r.dataZoomInfoMap.each(function(s){if(a.isAvailableBehavior(s.model.option)){var l=(s.getRange||{})[i],u=l&&l(s.dzReferCoordSysInfo,r.model.mainType,r.controller,a);!s.model.get("disabled",!0)&&u&&o.push({dataZoomId:s.model.id,start:u[0],end:u[1]})}}),o.length&&r.dispatchAction(o)})}),r}function Ort(e,t){e.isDisposed()||e.dispatchAction({type:"dataZoom",animation:{easing:"cubicOut",duration:100},batch:t})}function Frt(e,t,r,n){return e.coordinateSystem.containPoint([r,n])}function Brt(e){var t,r="type_",n={type_true:2,type_move:1,type_false:0,type_undefined:-1},i=!0;return e.each(function(a){var o=a.model,s=o.get("disabled",!0)?!1:o.get("zoomLock",!0)?"move":!0;n[r+s]>n[r+t]&&(t=s),i=i&&o.get("preventDefaultMouseMove",!0)}),{controlType:t,opt:{zoomOnMouseWheel:!0,moveOnMouseMove:!0,moveOnMouseWheel:!0,preventDefaultMouseMove:!!i}}}function Urt(e){e.registerProcessor(e.PRIORITY.PROCESSOR.FILTER,function(t,r){var n=JM(r),i=n.coordSysRecordMap||(n.coordSysRecordMap=Ut());i.each(function(a){a.dataZoomInfoMap=null}),t.eachComponent({mainType:"dataZoom",subType:"inside"},function(a){var o=qz(a);R(o.infoList,function(s){var l=s.model.uid,u=i.get(l)||i.set(l,Nrt(r,s.model)),h=u.dataZoomInfoMap||(u.dataZoomInfoMap=Ut());h.set(a.uid,{dzReferCoordSysInfo:s,model:a,getRange:null})})}),i.each(function(a){var o=a.controller,s,l=a.dataZoomInfoMap;if(l){var u=l.keys()[0];u!=null&&(s=l.get(u))}if(!s){ck(i,a);return}var h=Brt(l);o.enable(h.controlType,h.opt),o.setPointerChecker(a.containsPoint),qf(a,"dispatchAction",s.model.get("throttle",!0),"fixRate")})})}var zrt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="dataZoom.inside",r}return t.prototype.render=function(r,n,i){if(e.prototype.render.apply(this,arguments),r.noTarget()){this._clear();return}this.range=r.getPercentRange(),Prt(i,r,{pan:It(zx.pan,this),zoom:It(zx.zoom,this),scrollMove:It(zx.scrollMove,this)})},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){Irt(this.api,this.dataZoomModel),this.range=null},t.type="dataZoom.inside",t}(HM),zx={zoom:function(e,t,r,n){var i=this.range,a=i.slice(),o=e.axisModels[0];if(o){var s=kx[t](null,[n.originX,n.originY],o,r,e),l=(s.signal>0?s.pixelStart+s.pixelLength-s.pixel:s.pixel-s.pixelStart)/s.pixelLength*(a[1]-a[0])+a[0],u=Math.max(1/n.scale,0);a[0]=(a[0]-l)*u+l,a[1]=(a[1]-l)*u+l;var h=this.dataZoomModel.findRepresentativeAxisProxy().getMinMaxSpan();if(Wu(0,a,[0,100],0,h.minSpan,h.maxSpan),this.range=a,i[0]!==a[0]||i[1]!==a[1])return a}},pan:eP(function(e,t,r,n,i,a){var o=kx[n]([a.oldX,a.oldY],[a.newX,a.newY],t,i,r);return o.signal*(e[1]-e[0])*o.pixel/o.pixelLength}),scrollMove:eP(function(e,t,r,n,i,a){var o=kx[n]([0,0],[a.scrollDelta,a.scrollDelta],t,i,r);return o.signal*(e[1]-e[0])*a.scrollDelta})};function eP(e){return function(t,r,n,i){var a=this.range,o=a.slice(),s=t.axisModels[0];if(s){var l=e(o,s,t,r,n,i);if(Wu(l,o,[0,100],"all"),this.range=o,a[0]!==o[0]||a[1]!==o[1])return o}}}var kx={grid:function(e,t,r,n,i){var a=r.axis,o={},s=i.model.coordinateSystem.getRect();return e=e||[0,0],a.dim==="x"?(o.pixel=t[0]-e[0],o.pixelLength=s.width,o.pixelStart=s.x,o.signal=a.inverse?1:-1):(o.pixel=t[1]-e[1],o.pixelLength=s.height,o.pixelStart=s.y,o.signal=a.inverse?-1:1),o},polar:function(e,t,r,n,i){var a=r.axis,o={},s=i.model.coordinateSystem,l=s.getRadiusAxis().getExtent(),u=s.getAngleAxis().getExtent();return e=e?s.pointToCoord(e):[0,0],t=s.pointToCoord(t),r.mainType==="radiusAxis"?(o.pixel=t[0]-e[0],o.pixelLength=l[1]-l[0],o.pixelStart=l[0],o.signal=a.inverse?1:-1):(o.pixel=t[1]-e[1],o.pixelLength=u[1]-u[0],o.pixelStart=u[0],o.signal=a.inverse?-1:1),o},singleAxis:function(e,t,r,n,i){var a=r.axis,o=i.model.coordinateSystem.getRect(),s={};return e=e||[0,0],a.orient==="horizontal"?(s.pixel=t[0]-e[0],s.pixelLength=o.width,s.pixelStart=o.x,s.signal=a.inverse?1:-1):(s.pixel=t[1]-e[1],s.pixelLength=o.height,s.pixelStart=o.y,s.signal=a.inverse?-1:1),s}};function dk(e){WM(e),e.registerComponentModel(Rrt),e.registerComponentView(zrt),Urt(e)}var krt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.type="dataZoom.slider",t.layoutMode="box",t.defaultOption=Ws(iv.defaultOption,{show:!0,right:"ph",top:"ph",width:"ph",height:"ph",left:null,bottom:null,borderColor:"#d2dbee",borderRadius:3,backgroundColor:"rgba(47,69,84,0)",dataBackground:{lineStyle:{color:"#d2dbee",width:.5},areaStyle:{color:"#d2dbee",opacity:.2}},selectedDataBackground:{lineStyle:{color:"#8fb0f7",width:.5},areaStyle:{color:"#8fb0f7",opacity:.2}},fillerColor:"rgba(135,175,274,0.2)",handleIcon:"path://M-9.35,34.56V42m0-40V9.5m-2,0h4a2,2,0,0,1,2,2v21a2,2,0,0,1-2,2h-4a2,2,0,0,1-2-2v-21A2,2,0,0,1-11.35,9.5Z",handleSize:"100%",handleStyle:{color:"#fff",borderColor:"#ACB8D1"},moveHandleSize:7,moveHandleIcon:"path://M-320.9-50L-320.9-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-348-41-339-50-320.9-50z M-212.3-50L-212.3-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-239.4-41-230.4-50-212.3-50z M-103.7-50L-103.7-50c18.1,0,27.1,9,27.1,27.1V85.7c0,18.1-9,27.1-27.1,27.1l0,0c-18.1,0-27.1-9-27.1-27.1V-22.9C-130.9-41-121.8-50-103.7-50z",moveHandleStyle:{color:"#D2DBEE",opacity:.7},showDetail:!0,showDataShadow:"auto",realtime:!0,zoomLock:!1,textStyle:{color:"#6E7079"},brushSelect:!0,brushStyle:{color:"rgba(135,175,274,0.15)"},emphasis:{handleLabel:{show:!0},handleStyle:{borderColor:"#8FB0F7"},moveHandleStyle:{color:"#8FB0F7"}}}),t}(iv),Bc=Ae,rP=7,Grt=1,Gx=30,Vrt=7,Uc="horizontal",nP="vertical",Hrt=5,Wrt=["line","bar","candlestick","scatter"],Xrt={easing:"cubicOut",duration:100,delay:0},Yrt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._displayables={},r}return t.prototype.init=function(r,n){this.api=n,this._onBrush=It(this._onBrush,this),this._onBrushEnd=It(this._onBrushEnd,this)},t.prototype.render=function(r,n,i,a){if(e.prototype.render.apply(this,arguments),qf(this,"_dispatchZoomAction",r.get("throttle"),"fixRate"),this._orient=r.getOrient(),r.get("show")===!1){this.group.removeAll();return}if(r.noTarget()){this._clear(),this.group.removeAll();return}(!a||a.type!=="dataZoom"||a.from!==this.uid)&&this._buildView(),this._updateView()},t.prototype.dispose=function(){this._clear(),e.prototype.dispose.apply(this,arguments)},t.prototype._clear=function(){Xd(this,"_dispatchZoomAction");var r=this.api.getZr();r.off("mousemove",this._onBrush),r.off("mouseup",this._onBrushEnd)},t.prototype._buildView=function(){var r=this.group;r.removeAll(),this._brushing=!1,this._displayables.brushRect=null,this._resetLocation(),this._resetInterval();var n=this._displayables.sliderGroup=new re;this._renderBackground(),this._renderHandle(),this._renderDataShadow(),r.add(n),this._positionGroup()},t.prototype._resetLocation=function(){var r=this.dataZoomModel,n=this.api,i=r.get("brushSelect"),a=i?Vrt:0,o=this._findCoordRect(),s={width:n.getWidth(),height:n.getHeight()},l=this._orient===Uc?{right:s.width-o.x-o.width,top:s.height-Gx-rP-a,width:o.width,height:Gx}:{right:rP,top:o.y,width:Gx,height:o.height},u=Wf(r.option);R(["right","top","width","height"],function(f){u[f]==="ph"&&(u[f]=l[f])});var h=Mr(u,s);this._location={x:h.x,y:h.y},this._size=[h.width,h.height],this._orient===nP&&this._size.reverse()},t.prototype._positionGroup=function(){var r=this.group,n=this._location,i=this._orient,a=this.dataZoomModel.getFirstTargetAxisModel(),o=a&&a.get("inverse"),s=this._displayables.sliderGroup,l=(this._dataShadowInfo||{}).otherAxisInverse;s.attr(i===Uc&&!o?{scaleY:l?1:-1,scaleX:1}:i===Uc&&o?{scaleY:l?1:-1,scaleX:-1}:i===nP&&!o?{scaleY:l?-1:1,scaleX:1,rotation:Math.PI/2}:{scaleY:l?-1:1,scaleX:-1,rotation:Math.PI/2});var u=r.getBoundingRect([s]);r.x=n.x-u.x,r.y=n.y-u.y,r.markRedraw()},t.prototype._getViewExtent=function(){return[0,this._size[0]]},t.prototype._renderBackground=function(){var r=this.dataZoomModel,n=this._size,i=this._displayables.sliderGroup,a=r.get("brushSelect");i.add(new Bc({silent:!0,shape:{x:0,y:0,width:n[0],height:n[1]},style:{fill:r.get("backgroundColor")},z2:-40}));var o=new Bc({shape:{x:0,y:0,width:n[0],height:n[1]},style:{fill:"transparent"},z2:0,onclick:It(this._onClickPanel,this)}),s=this.api.getZr();a?(o.on("mousedown",this._onBrushStart,this),o.cursor="crosshair",s.on("mousemove",this._onBrush),s.on("mouseup",this._onBrushEnd)):(s.off("mousemove",this._onBrush),s.off("mouseup",this._onBrushEnd)),i.add(o)},t.prototype._renderDataShadow=function(){var r=this._dataShadowInfo=this._prepareDataShadowInfo();if(this._displayables.dataShadowSegs=[],!r)return;var n=this._size,i=this._shadowSize||[],a=r.series,o=a.getRawData(),s=a.getShadowDim&&a.getShadowDim(),l=s&&o.getDimensionInfo(s)?a.getShadowDim():r.otherDim;if(l==null)return;var u=this._shadowPolygonPts,h=this._shadowPolylinePts;if(o!==this._shadowData||l!==this._shadowDim||n[0]!==i[0]||n[1]!==i[1]){var f=o.getDataExtent(l),c=(f[1]-f[0])*.3;f=[f[0]-c,f[1]+c];var d=[0,n[1]],v=[0,n[0]],p=[[n[0],0],[0,0]],g=[],m=v[1]/(o.count()-1),_=0,y=Math.round(o.count()/n[0]),x;o.each([l],function(b,A){if(y>0&&A%y){_+=m;return}var E=b==null||isNaN(b)||b==="",C=E?0:He(b,f,d,!0);E&&!x&&A?(p.push([p[p.length-1][0],0]),g.push([g[g.length-1][0],0])):!E&&x&&(p.push([_,0]),g.push([_,0])),p.push([_,C]),g.push([_,C]),_+=m,x=E}),u=this._shadowPolygonPts=p,h=this._shadowPolylinePts=g}this._shadowData=o,this._shadowDim=l,this._shadowSize=[n[0],n[1]];var T=this.dataZoomModel;function S(b){var A=T.getModel(b?"selectedDataBackground":"dataBackground"),E=new re,C=new Yn({shape:{points:u},segmentIgnoreThreshold:1,style:A.getModel("areaStyle").getAreaStyle(),silent:!0,z2:-20}),D=new $n({shape:{points:h},segmentIgnoreThreshold:1,style:A.getModel("lineStyle").getLineStyle(),silent:!0,z2:-19});return E.add(C),E.add(D),E}for(var M=0;M<3;M++){var w=S(M===1);this._displayables.sliderGroup.add(w),this._displayables.dataShadowSegs.push(w)}},t.prototype._prepareDataShadowInfo=function(){var r=this.dataZoomModel,n=r.get("showDataShadow");if(n!==!1){var i,a=this.ecModel;return r.eachTargetAxis(function(o,s){var l=r.getAxisProxy(o,s).getTargetSeriesModels();R(l,function(u){if(!i&&!(n!==!0&&pe(Wrt,u.get("type"))<0)){var h=a.getComponent(ws(o),s).axis,f=Zrt(o),c,d=u.coordinateSystem;f!=null&&d.getOtherAxis&&(c=d.getOtherAxis(h).inverse),f=u.getData().mapDimension(f),i={thisAxis:h,series:u,thisDim:o,otherDim:f,otherAxisInverse:c}}},this)},this),i}},t.prototype._renderHandle=function(){var r=this.group,n=this._displayables,i=n.handles=[null,null],a=n.handleLabels=[null,null],o=this._displayables.sliderGroup,s=this._size,l=this.dataZoomModel,u=this.api,h=l.get("borderRadius")||0,f=l.get("brushSelect"),c=n.filler=new Bc({silent:f,style:{fill:l.get("fillerColor")},textConfig:{position:"inside"}});o.add(c),o.add(new Bc({silent:!0,subPixelOptimize:!0,shape:{x:0,y:0,width:s[0],height:s[1],r:h},style:{stroke:l.get("dataBackgroundColor")||l.get("borderColor"),lineWidth:Grt,fill:"rgba(0,0,0,0)"}})),R([0,1],function(y){var x=l.get("handleIcon");!Dm[x]&&x.indexOf("path://")<0&&x.indexOf("image://")<0&&(x="path://"+x);var T=Pr(x,-1,0,2,2,null,!0);T.attr({cursor:iP(this._orient),draggable:!0,drift:It(this._onDragMove,this,y),ondragend:It(this._onDragEnd,this),onmouseover:It(this._showDataInfo,this,!0),onmouseout:It(this._showDataInfo,this,!1),z2:5});var S=T.getBoundingRect(),M=l.get("handleSize");this._handleHeight=Tt(M,this._size[1]),this._handleWidth=S.width/S.height*this._handleHeight,T.setStyle(l.getModel("handleStyle").getItemStyle()),T.style.strokeNoScale=!0,T.rectHover=!0,T.ensureState("emphasis").style=l.getModel(["emphasis","handleStyle"]).getItemStyle(),cu(T);var w=l.get("handleColor");w!=null&&(T.style.fill=w),o.add(i[y]=T);var b=l.getModel("textStyle"),A=l.get("handleLabel")||{},E=A.show||!1;r.add(a[y]=new we({silent:!0,invisible:!E,style:je(b,{x:0,y:0,text:"",verticalAlign:"middle",align:"center",fill:b.getTextColor(),font:b.getFont()}),z2:10}))},this);var d=c;if(f){var v=Tt(l.get("moveHandleSize"),s[1]),p=n.moveHandle=new Ae({style:l.getModel("moveHandleStyle").getItemStyle(),silent:!0,shape:{r:[0,0,2,2],y:s[1]-.5,height:v}}),g=v*.8,m=n.moveHandleIcon=Pr(l.get("moveHandleIcon"),-g/2,-g/2,g,g,"#fff",!0);m.silent=!0,m.y=s[1]+v/2-.5,p.ensureState("emphasis").style=l.getModel(["emphasis","moveHandleStyle"]).getItemStyle();var _=Math.min(s[1]/2,Math.max(v,10));d=n.moveZone=new Ae({invisible:!0,shape:{y:s[1]-_,height:v+_}}),d.on("mouseover",function(){u.enterEmphasis(p)}).on("mouseout",function(){u.leaveEmphasis(p)}),o.add(p),o.add(m),o.add(d)}d.attr({draggable:!0,cursor:iP(this._orient),drift:It(this._onDragMove,this,"all"),ondragstart:It(this._showDataInfo,this,!0),ondragend:It(this._onDragEnd,this),onmouseover:It(this._showDataInfo,this,!0),onmouseout:It(this._showDataInfo,this,!1)})},t.prototype._resetInterval=function(){var r=this._range=this.dataZoomModel.getPercentRange(),n=this._getViewExtent();this._handleEnds=[He(r[0],[0,100],n,!0),He(r[1],[0,100],n,!0)]},t.prototype._updateInterval=function(r,n){var i=this.dataZoomModel,a=this._handleEnds,o=this._getViewExtent(),s=i.findRepresentativeAxisProxy().getMinMaxSpan(),l=[0,100];Wu(n,a,o,i.get("zoomLock")?"all":r,s.minSpan!=null?He(s.minSpan,l,o,!0):null,s.maxSpan!=null?He(s.maxSpan,l,o,!0):null);var u=this._range,h=this._range=ki([He(a[0],o,l,!0),He(a[1],o,l,!0)]);return!u||u[0]!==h[0]||u[1]!==h[1]},t.prototype._updateView=function(r){var n=this._displayables,i=this._handleEnds,a=ki(i.slice()),o=this._size;R([0,1],function(d){var v=n.handles[d],p=this._handleHeight;v.attr({scaleX:p/2,scaleY:p/2,x:i[d]+(d?-1:1),y:o[1]/2-p/2})},this),n.filler.setShape({x:a[0],y:0,width:a[1]-a[0],height:o[1]});var s={x:a[0],width:a[1]-a[0]};n.moveHandle&&(n.moveHandle.setShape(s),n.moveZone.setShape(s),n.moveZone.getBoundingRect(),n.moveHandleIcon&&n.moveHandleIcon.attr("x",s.x+s.width/2));for(var l=n.dataShadowSegs,u=[0,a[0],a[1],o[0]],h=0;h<l.length;h++){var f=l[h],c=f.getClipPath();c||(c=new Ae,f.setClipPath(c)),c.setShape({x:u[h],y:0,width:u[h+1]-u[h],height:o[1]})}this._updateDataInfo(r)},t.prototype._updateDataInfo=function(r){var n=this.dataZoomModel,i=this._displayables,a=i.handleLabels,o=this._orient,s=["",""];if(n.get("showDetail")){var l=n.findRepresentativeAxisProxy();if(l){var u=l.getAxisModel().axis,h=this._range,f=r?l.calculateDataWindow({start:h[0],end:h[1]}).valueWindow:l.getDataValueWindow();s=[this._formatLabel(f[0],u),this._formatLabel(f[1],u)]}}var c=ki(this._handleEnds.slice());d.call(this,0),d.call(this,1);function d(v){var p=du(i.handles[v].parent,this.group),g=B_(v===0?"right":"left",p),m=this._handleWidth/2+Hrt,_=va([c[v]+(v===0?-m:m),this._size[1]/2],p);a[v].setStyle({x:_[0],y:_[1],verticalAlign:o===Uc?"middle":g,align:o===Uc?g:"center",text:s[v]})}},t.prototype._formatLabel=function(r,n){var i=this.dataZoomModel,a=i.get("labelFormatter"),o=i.get("labelPrecision");(o==null||o==="auto")&&(o=n.getPixelPrecision());var s=r==null||isNaN(r)?"":n.type==="category"||n.type==="time"?n.scale.getLabel({value:Math.round(r)}):r.toFixed(Math.min(o,20));return Yt(a)?a(r,s):Ct(a)?a.replace("{value}",s):s},t.prototype._showDataInfo=function(r){var n=this.dataZoomModel.get("handleLabel")||{},i=n.show||!1,a=this.dataZoomModel.getModel(["emphasis","handleLabel"]),o=a.get("show")||!1,s=r||this._dragging?o:i,l=this._displayables,u=l.handleLabels;u[0].attr("invisible",!s),u[1].attr("invisible",!s),l.moveHandle&&this.api[s?"enterEmphasis":"leaveEmphasis"](l.moveHandle,1)},t.prototype._onDragMove=function(r,n,i,a){this._dragging=!0,Lo(a.event);var o=this._displayables.sliderGroup.getLocalTransform(),s=va([n,i],o,!0),l=this._updateInterval(r,s[0]),u=this.dataZoomModel.get("realtime");this._updateView(!u),l&&u&&this._dispatchZoomAction(!0)},t.prototype._onDragEnd=function(){this._dragging=!1,this._showDataInfo(!1);var r=this.dataZoomModel.get("realtime");!r&&this._dispatchZoomAction(!1)},t.prototype._onClickPanel=function(r){var n=this._size,i=this._displayables.sliderGroup.transformCoordToLocal(r.offsetX,r.offsetY);if(!(i[0]<0||i[0]>n[0]||i[1]<0||i[1]>n[1])){var a=this._handleEnds,o=(a[0]+a[1])/2,s=this._updateInterval("all",i[0]-o);this._updateView(),s&&this._dispatchZoomAction(!1)}},t.prototype._onBrushStart=function(r){var n=r.offsetX,i=r.offsetY;this._brushStart=new he(n,i),this._brushing=!0,this._brushStartTime=+new Date},t.prototype._onBrushEnd=function(r){if(this._brushing){var n=this._displayables.brushRect;if(this._brushing=!1,!!n){n.attr("ignore",!0);var i=n.shape,a=+new Date;if(!(a-this._brushStartTime<200&&Math.abs(i.width)<5)){var o=this._getViewExtent(),s=[0,100];this._range=ki([He(i.x,o,s,!0),He(i.x+i.width,o,s,!0)]),this._handleEnds=[i.x,i.x+i.width],this._updateView(),this._dispatchZoomAction(!1)}}}},t.prototype._onBrush=function(r){this._brushing&&(Lo(r.event),this._updateBrushRect(r.offsetX,r.offsetY))},t.prototype._updateBrushRect=function(r,n){var i=this._displayables,a=this.dataZoomModel,o=i.brushRect;o||(o=i.brushRect=new Bc({silent:!0,style:a.getModel("brushStyle").getItemStyle()}),i.sliderGroup.add(o)),o.attr("ignore",!1);var s=this._brushStart,l=this._displayables.sliderGroup,u=l.transformCoordToLocal(r,n),h=l.transformCoordToLocal(s.x,s.y),f=this._size;u[0]=Math.max(Math.min(f[0],u[0]),0),o.setShape({x:h[0],y:0,width:u[0]-h[0],height:f[1]})},t.prototype._dispatchZoomAction=function(r){var n=this._range;this.api.dispatchAction({type:"dataZoom",from:this.uid,dataZoomId:this.dataZoomModel.id,animation:r?Xrt:null,start:n[0],end:n[1]})},t.prototype._findCoordRect=function(){var r,n=qz(this.dataZoomModel).infoList;if(!r&&n.length){var i=n[0].model.coordinateSystem;r=i.getRect&&i.getRect()}if(!r){var a=this.api.getWidth(),o=this.api.getHeight();r={x:a*.2,y:o*.2,width:a*.6,height:o*.6}}return r},t.type="dataZoom.slider",t}(HM);function Zrt(e){var t={x:"y",y:"x",radius:"angle",angle:"radius"};return t[e]}function iP(e){return e==="vertical"?"ns-resize":"ew-resize"}function vk(e){e.registerComponentModel(krt),e.registerComponentView(Yrt),WM(e)}function qrt(e){te(dk),te(vk)}var pk={get:function(e,t,r){var n=Qt(($rt[e]||{})[t]);return r&&at(n)?n[n.length-1]:n}},$rt={color:{active:["#006edd","#e0ffff"],inactive:["rgba(0,0,0,0)"]},colorHue:{active:[0,360],inactive:[0,0]},colorSaturation:{active:[.3,1],inactive:[0,0]},colorLightness:{active:[.9,.5],inactive:[0,0]},colorAlpha:{active:[.3,1],inactive:[0,0]},opacity:{active:[.3,1],inactive:[0,0]},symbol:{active:["circle","roundRect","diamond"],inactive:["none"]},symbolSize:{active:[10,50],inactive:[0,0]}},aP=rn.mapVisual,Krt=rn.eachVisual,jrt=at,oP=R,Jrt=ki,Qrt=He,t_=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.stateList=["inRange","outOfRange"],r.replacableOptionKeys=["inRange","outOfRange","target","controller","color"],r.layoutMode={type:"box",ignoreSize:!0},r.dataBound=[-1/0,1/0],r.targetVisuals={},r.controllerVisuals={},r}return t.prototype.init=function(r,n,i){this.mergeDefaultAndTheme(r,i)},t.prototype.optionUpdated=function(r,n){var i=this.option;!n&&ik(i,r,this.replacableOptionKeys),this.textStyleModel=this.getModel("textStyle"),this.resetItemSize(),this.completeVisualOption()},t.prototype.resetVisual=function(r){var n=this.stateList;r=It(r,this),this.controllerVisuals=DT(this.option.controller,n,r),this.targetVisuals=DT(this.option.target,n,r)},t.prototype.getItemSymbol=function(){return null},t.prototype.getTargetSeriesIndices=function(){var r=this.option.seriesIndex,n=[];return r==null||r==="all"?this.ecModel.eachSeries(function(i,a){n.push(a)}):n=er(r),n},t.prototype.eachTargetSeries=function(r,n){R(this.getTargetSeriesIndices(),function(i){var a=this.ecModel.getSeriesByIndex(i);a&&r.call(n,a)},this)},t.prototype.isTargetSeries=function(r){var n=!1;return this.eachTargetSeries(function(i){i===r&&(n=!0)}),n},t.prototype.formatValueText=function(r,n,i){var a=this.option,o=a.precision,s=this.dataBound,l=a.formatter,u;i=i||["<",">"],at(r)&&(r=r.slice(),u=!0);var h=n?r:u?[f(r[0]),f(r[1])]:f(r);if(Ct(l))return l.replace("{value}",u?h[0]:h).replace("{value2}",u?h[1]:h);if(Yt(l))return u?l(r[0],r[1]):l(r);if(u)return r[0]===s[0]?i[0]+" "+h[1]:r[1]===s[1]?i[1]+" "+h[0]:h[0]+" - "+h[1];return h;function f(c){return c===s[0]?"min":c===s[1]?"max":(+c).toFixed(Math.min(o,20))}},t.prototype.resetExtent=function(){var r=this.option,n=Jrt([r.min,r.max]);this._dataExtent=n},t.prototype.getDataDimensionIndex=function(r){var n=this.option.dimension;if(n!=null)return r.getDimensionIndex(n);for(var i=r.dimensions,a=i.length-1;a>=0;a--){var o=i[a],s=r.getDimensionInfo(o);if(!s.isCalculationCoord)return s.storeDimIndex}},t.prototype.getExtent=function(){return this._dataExtent.slice()},t.prototype.completeVisualOption=function(){var r=this.ecModel,n=this.option,i={inRange:n.inRange,outOfRange:n.outOfRange},a=n.target||(n.target={}),o=n.controller||(n.controller={});Ot(a,i),Ot(o,i);var s=this.isCategory();l.call(this,a),l.call(this,o),u.call(this,a,"inRange","outOfRange"),h.call(this,o);function l(f){jrt(n.color)&&!f.inRange&&(f.inRange={color:n.color.slice().reverse()}),f.inRange=f.inRange||{color:r.get("gradientColor")}}function u(f,c,d){var v=f[c],p=f[d];v&&!p&&(p=f[d]={},oP(v,function(g,m){if(rn.isValidType(m)){var _=pk.get(m,"inactive",s);_!=null&&(p[m]=_,m==="color"&&!p.hasOwnProperty("opacity")&&!p.hasOwnProperty("colorAlpha")&&(p.opacity=[0,0]))}}))}function h(f){var c=(f.inRange||{}).symbol||(f.outOfRange||{}).symbol,d=(f.inRange||{}).symbolSize||(f.outOfRange||{}).symbolSize,v=this.get("inactiveColor"),p=this.getItemSymbol(),g=p||"roundRect";oP(this.stateList,function(m){var _=this.itemSize,y=f[m];y||(y=f[m]={color:s?v:[v]}),y.symbol==null&&(y.symbol=c&&Qt(c)||(s?g:[g])),y.symbolSize==null&&(y.symbolSize=d&&Qt(d)||(s?_[0]:[_[0],_[0]])),y.symbol=aP(y.symbol,function(S){return S==="none"?g:S});var x=y.symbolSize;if(x!=null){var T=-1/0;Krt(x,function(S){S>T&&(T=S)}),y.symbolSize=aP(x,function(S){return Qrt(S,[0,T],[0,_[0]],!0)})}},this)}},t.prototype.resetItemSize=function(){this.itemSize=[parseFloat(this.get("itemWidth")),parseFloat(this.get("itemHeight"))]},t.prototype.isCategory=function(){return!!this.option.categories},t.prototype.setSelected=function(r){},t.prototype.getSelected=function(){return null},t.prototype.getValueState=function(r){return null},t.prototype.getVisualMeta=function(r){return null},t.type="visualMap",t.dependencies=["series"],t.defaultOption={show:!0,z:4,seriesIndex:"all",min:0,max:200,left:0,right:null,top:null,bottom:0,itemWidth:null,itemHeight:null,inverse:!1,orient:"vertical",backgroundColor:"rgba(0,0,0,0)",borderColor:"#ccc",contentColor:"#5793f3",inactiveColor:"#aaa",borderWidth:0,padding:5,textGap:10,precision:0,textStyle:{color:"#333"}},t}(me),sP=[20,140],tnt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.optionUpdated=function(r,n){e.prototype.optionUpdated.apply(this,arguments),this.resetExtent(),this.resetVisual(function(i){i.mappingMethod="linear",i.dataExtent=this.getExtent()}),this._resetRange()},t.prototype.resetItemSize=function(){e.prototype.resetItemSize.apply(this,arguments);var r=this.itemSize;(r[0]==null||isNaN(r[0]))&&(r[0]=sP[0]),(r[1]==null||isNaN(r[1]))&&(r[1]=sP[1])},t.prototype._resetRange=function(){var r=this.getExtent(),n=this.option.range;!n||n.auto?(r.auto=1,this.option.range=r):at(n)&&(n[0]>n[1]&&n.reverse(),n[0]=Math.max(n[0],r[0]),n[1]=Math.min(n[1],r[1]))},t.prototype.completeVisualOption=function(){e.prototype.completeVisualOption.apply(this,arguments),R(this.stateList,function(r){var n=this.option.controller[r].symbolSize;n&&n[0]!==n[1]&&(n[0]=n[1]/3)},this)},t.prototype.setSelected=function(r){this.option.range=r.slice(),this._resetRange()},t.prototype.getSelected=function(){var r=this.getExtent(),n=ki((this.get("range")||[]).slice());return n[0]>r[1]&&(n[0]=r[1]),n[1]>r[1]&&(n[1]=r[1]),n[0]<r[0]&&(n[0]=r[0]),n[1]<r[0]&&(n[1]=r[0]),n},t.prototype.getValueState=function(r){var n=this.option.range,i=this.getExtent();return(n[0]<=i[0]||n[0]<=r)&&(n[1]>=i[1]||r<=n[1])?"inRange":"outOfRange"},t.prototype.findTargetDataIndices=function(r){var n=[];return this.eachTargetSeries(function(i){var a=[],o=i.getData();o.each(this.getDataDimensionIndex(o),function(s,l){r[0]<=s&&s<=r[1]&&a.push(l)},this),n.push({seriesId:i.id,dataIndex:a})},this),n},t.prototype.getVisualMeta=function(r){var n=lP(this,"outOfRange",this.getExtent()),i=lP(this,"inRange",this.option.range.slice()),a=[];function o(d,v){a.push({value:d,color:r(d,v)})}for(var s=0,l=0,u=i.length,h=n.length;l<h&&(!i.length||n[l]<=i[0]);l++)n[l]<i[s]&&o(n[l],"outOfRange");for(var f=1;s<u;s++,f=0)f&&a.length&&o(i[s],"outOfRange"),o(i[s],"inRange");for(var f=1;l<h;l++)(!i.length||i[i.length-1]<n[l])&&(f&&(a.length&&o(a[a.length-1].value,"outOfRange"),f=0),o(n[l],"outOfRange"));var c=a.length;return{stops:a,outerColors:[c?a[0].color:"transparent",c?a[c-1].color:"transparent"]}},t.type="visualMap.continuous",t.defaultOption=Ws(t_.defaultOption,{align:"auto",calculable:!1,hoverLink:!0,realtime:!0,handleIcon:"path://M-11.39,9.77h0a3.5,3.5,0,0,1-3.5,3.5h-22a3.5,3.5,0,0,1-3.5-3.5h0a3.5,3.5,0,0,1,3.5-3.5h22A3.5,3.5,0,0,1-11.39,9.77Z",handleSize:"120%",handleStyle:{borderColor:"#fff",borderWidth:1},indicatorIcon:"circle",indicatorSize:"50%",indicatorStyle:{borderColor:"#fff",borderWidth:2,shadowBlur:2,shadowOffsetX:1,shadowOffsetY:1,shadowColor:"rgba(0,0,0,0.2)"}}),t}(t_);function lP(e,t,r){if(r[0]===r[1])return r.slice();for(var n=200,i=(r[1]-r[0])/n,a=r[0],o=[],s=0;s<=n&&a<r[1];s++)o.push(a),a+=i;return o.push(r[1]),o}var gk=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r.autoPositionValues={left:1,right:1,top:1,bottom:1},r}return t.prototype.init=function(r,n){this.ecModel=r,this.api=n},t.prototype.render=function(r,n,i,a){if(this.visualMapModel=r,r.get("show")===!1){this.group.removeAll();return}this.doRender(r,n,i,a)},t.prototype.renderBackground=function(r){var n=this.visualMapModel,i=Hf(n.get("padding")||0),a=r.getBoundingRect();r.add(new Ae({z2:-1,silent:!0,shape:{x:a.x-i[3],y:a.y-i[0],width:a.width+i[3]+i[1],height:a.height+i[0]+i[2]},style:{fill:n.get("backgroundColor"),stroke:n.get("borderColor"),lineWidth:n.get("borderWidth")}}))},t.prototype.getControllerVisual=function(r,n,i){i=i||{};var a=i.forceState,o=this.visualMapModel,s={};if(n==="color"){var l=o.get("contentColor");s.color=l}function u(d){return s[d]}function h(d,v){s[d]=v}var f=o.controllerVisuals[a||o.getValueState(r)],c=rn.prepareVisualTypes(f);return R(c,function(d){var v=f[d];i.convertOpacityToAlpha&&d==="opacity"&&(d="colorAlpha",v=f.__alphaForOpacity),rn.dependsOn(d,n)&&v&&v.applyVisual(r,u,h)}),s[n]},t.prototype.positionGroup=function(r){var n=this.visualMapModel,i=this.api;W_(r,n.getBoxLayoutParams(),{width:i.getWidth(),height:i.getHeight()})},t.prototype.doRender=function(r,n,i,a){},t.type="visualMap",t}(nr),uP=[["left","right","width"],["top","bottom","height"]];function mk(e,t,r){var n=e.option,i=n.align;if(i!=null&&i!=="auto")return i;for(var a={width:t.getWidth(),height:t.getHeight()},o=n.orient==="horizontal"?1:0,s=uP[o],l=[0,null,10],u={},h=0;h<3;h++)u[uP[1-o][h]]=l[h],u[s[h]]=h===2?r[0]:n[s[h]];var f=[["x","width",3],["y","height",0]][o],c=Mr(u,a,n.padding);return s[(c.margin[f[2]]||0)+c[f[0]]+c[f[1]]*.5<a[f[1]]*.5?0:1]}function rm(e,t){return R(e||[],function(r){r.dataIndex!=null&&(r.dataIndexInside=r.dataIndex,r.dataIndex=null),r.highlightKey="visualMap"+(t?t.componentIndex:"")}),e}var Ca=He,ent=R,hP=Math.min,Vx=Math.max,rnt=12,nnt=6,int=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._shapes={},r._dataInterval=[],r._handleEnds=[],r._hoverLinkDataIndices=[],r}return t.prototype.init=function(r,n){e.prototype.init.call(this,r,n),this._hoverLinkFromSeriesMouseOver=It(this._hoverLinkFromSeriesMouseOver,this),this._hideIndicator=It(this._hideIndicator,this)},t.prototype.doRender=function(r,n,i,a){(!a||a.type!=="selectDataRange"||a.from!==this.uid)&&this._buildView()},t.prototype._buildView=function(){this.group.removeAll();var r=this.visualMapModel,n=this.group;this._orient=r.get("orient"),this._useHandle=r.get("calculable"),this._resetInterval(),this._renderBar(n);var i=r.get("text");this._renderEndsText(n,i,0),this._renderEndsText(n,i,1),this._updateView(!0),this.renderBackground(n),this._updateView(),this._enableHoverLinkToSeries(),this._enableHoverLinkFromSeries(),this.positionGroup(n)},t.prototype._renderEndsText=function(r,n,i){if(n){var a=n[1-i];a=a!=null?a+"":"";var o=this.visualMapModel,s=o.get("textGap"),l=o.itemSize,u=this._shapes.mainGroup,h=this._applyTransform([l[0]/2,i===0?-s:l[1]+s],u),f=this._applyTransform(i===0?"bottom":"top",u),c=this._orient,d=this.visualMapModel.textStyleModel;this.group.add(new we({style:je(d,{x:h[0],y:h[1],verticalAlign:c==="horizontal"?"middle":f,align:c==="horizontal"?f:"center",text:a})}))}},t.prototype._renderBar=function(r){var n=this.visualMapModel,i=this._shapes,a=n.itemSize,o=this._orient,s=this._useHandle,l=mk(n,this.api,a),u=i.mainGroup=this._createBarGroup(l),h=new re;u.add(h),h.add(i.outOfRange=fP()),h.add(i.inRange=fP(null,s?dP(this._orient):null,It(this._dragHandle,this,"all",!1),It(this._dragHandle,this,"all",!0))),h.setClipPath(new Ae({shape:{x:0,y:0,width:a[0],height:a[1],r:3}}));var f=n.textStyleModel.getTextRect("国"),c=Vx(f.width,f.height);s&&(i.handleThumbs=[],i.handleLabels=[],i.handleLabelPoints=[],this._createHandle(n,u,0,a,c,o),this._createHandle(n,u,1,a,c,o)),this._createIndicator(n,u,a,c,o),r.add(u)},t.prototype._createHandle=function(r,n,i,a,o,s){var l=It(this._dragHandle,this,i,!1),u=It(this._dragHandle,this,i,!0),h=_a(r.get("handleSize"),a[0]),f=Pr(r.get("handleIcon"),-h/2,-h/2,h,h,null,!0),c=dP(this._orient);f.attr({cursor:c,draggable:!0,drift:l,ondragend:u,onmousemove:function(m){Lo(m.event)}}),f.x=a[0]/2,f.useStyle(r.getModel("handleStyle").getItemStyle()),f.setStyle({strokeNoScale:!0,strokeFirst:!0}),f.style.lineWidth*=2,f.ensureState("emphasis").style=r.getModel(["emphasis","handleStyle"]).getItemStyle(),jl(f,!0),n.add(f);var d=this.visualMapModel.textStyleModel,v=new we({cursor:c,draggable:!0,drift:l,onmousemove:function(m){Lo(m.event)},ondragend:u,style:je(d,{x:0,y:0,text:""})});v.ensureState("blur").style={opacity:.1},v.stateTransition={duration:200},this.group.add(v);var p=[h,0],g=this._shapes;g.handleThumbs[i]=f,g.handleLabelPoints[i]=p,g.handleLabels[i]=v},t.prototype._createIndicator=function(r,n,i,a,o){var s=_a(r.get("indicatorSize"),i[0]),l=Pr(r.get("indicatorIcon"),-s/2,-s/2,s,s,null,!0);l.attr({cursor:"move",invisible:!0,silent:!0,x:i[0]/2});var u=r.getModel("indicatorStyle").getItemStyle();if(l instanceof hn){var h=l.style;l.useStyle(rt({image:h.image,x:h.x,y:h.y,width:h.width,height:h.height},u))}else l.useStyle(u);n.add(l);var f=this.visualMapModel.textStyleModel,c=new we({silent:!0,invisible:!0,style:je(f,{x:0,y:0,text:""})});this.group.add(c);var d=[(o==="horizontal"?a/2:nnt)+i[0]/2,0],v=this._shapes;v.indicator=l,v.indicatorLabel=c,v.indicatorLabelPoint=d,this._firstShowIndicator=!0},t.prototype._dragHandle=function(r,n,i,a){if(this._useHandle){if(this._dragging=!n,!n){var o=this._applyTransform([i,a],this._shapes.mainGroup,!0);this._updateInterval(r,o[1]),this._hideIndicator(),this._updateView()}n===!this.visualMapModel.get("realtime")&&this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:this._dataInterval.slice()}),n?!this._hovering&&this._clearHoverLinkToSeries():cP(this.visualMapModel)&&this._doHoverLinkToSeries(this._handleEnds[r],!1)}},t.prototype._resetInterval=function(){var r=this.visualMapModel,n=this._dataInterval=r.getSelected(),i=r.getExtent(),a=[0,r.itemSize[1]];this._handleEnds=[Ca(n[0],i,a,!0),Ca(n[1],i,a,!0)]},t.prototype._updateInterval=function(r,n){n=n||0;var i=this.visualMapModel,a=this._handleEnds,o=[0,i.itemSize[1]];Wu(n,a,o,r,0);var s=i.getExtent();this._dataInterval=[Ca(a[0],o,s,!0),Ca(a[1],o,s,!0)]},t.prototype._updateView=function(r){var n=this.visualMapModel,i=n.getExtent(),a=this._shapes,o=[0,n.itemSize[1]],s=r?o:this._handleEnds,l=this._createBarVisual(this._dataInterval,i,s,"inRange"),u=this._createBarVisual(i,i,o,"outOfRange");a.inRange.setStyle({fill:l.barColor}).setShape("points",l.barPoints),a.outOfRange.setStyle({fill:u.barColor}).setShape("points",u.barPoints),this._updateHandle(s,l)},t.prototype._createBarVisual=function(r,n,i,a){var o={forceState:a,convertOpacityToAlpha:!0},s=this._makeColorGradient(r,o),l=[this.getControllerVisual(r[0],"symbolSize",o),this.getControllerVisual(r[1],"symbolSize",o)],u=this._createBarPoints(i,l);return{barColor:new bv(0,0,0,1,s),barPoints:u,handlesColor:[s[0].color,s[s.length-1].color]}},t.prototype._makeColorGradient=function(r,n){var i=100,a=[],o=(r[1]-r[0])/i;a.push({color:this.getControllerVisual(r[0],"color",n),offset:0});for(var s=1;s<i;s++){var l=r[0]+o*s;if(l>r[1])break;a.push({color:this.getControllerVisual(l,"color",n),offset:s/i})}return a.push({color:this.getControllerVisual(r[1],"color",n),offset:1}),a},t.prototype._createBarPoints=function(r,n){var i=this.visualMapModel.itemSize;return[[i[0]-n[0],r[0]],[i[0],r[0]],[i[0],r[1]],[i[0]-n[1],r[1]]]},t.prototype._createBarGroup=function(r){var n=this._orient,i=this.visualMapModel.get("inverse");return new re(n==="horizontal"&&!i?{scaleX:r==="bottom"?1:-1,rotation:Math.PI/2}:n==="horizontal"&&i?{scaleX:r==="bottom"?-1:1,rotation:-Math.PI/2}:n==="vertical"&&!i?{scaleX:r==="left"?1:-1,scaleY:-1}:{scaleX:r==="left"?1:-1})},t.prototype._updateHandle=function(r,n){if(this._useHandle){var i=this._shapes,a=this.visualMapModel,o=i.handleThumbs,s=i.handleLabels,l=a.itemSize,u=a.getExtent(),h=this._applyTransform("left",i.mainGroup);ent([0,1],function(f){var c=o[f];c.setStyle("fill",n.handlesColor[f]),c.y=r[f];var d=Ca(r[f],[0,l[1]],u,!0),v=this.getControllerVisual(d,"symbolSize");c.scaleX=c.scaleY=v/l[0],c.x=l[0]-v/2;var p=va(i.handleLabelPoints[f],du(c,this.group));if(this._orient==="horizontal"){var g=h==="left"||h==="top"?(l[0]-v)/2:(l[0]-v)/-2;p[1]+=g}s[f].setStyle({x:p[0],y:p[1],text:a.formatValueText(this._dataInterval[f]),verticalAlign:"middle",align:this._orient==="vertical"?this._applyTransform("left",i.mainGroup):"center"})},this)}},t.prototype._showIndicator=function(r,n,i,a){var o=this.visualMapModel,s=o.getExtent(),l=o.itemSize,u=[0,l[1]],h=this._shapes,f=h.indicator;if(f){f.attr("invisible",!1);var c={convertOpacityToAlpha:!0},d=this.getControllerVisual(r,"color",c),v=this.getControllerVisual(r,"symbolSize"),p=Ca(r,s,u,!0),g=l[0]-v/2,m={x:f.x,y:f.y};f.y=p,f.x=g;var _=va(h.indicatorLabelPoint,du(f,this.group)),y=h.indicatorLabel;y.attr("invisible",!1);var x=this._applyTransform("left",h.mainGroup),T=this._orient,S=T==="horizontal";y.setStyle({text:(i||"")+o.formatValueText(n),verticalAlign:S?x:"middle",align:S?"center":x});var M={x:g,y:p,style:{fill:d}},w={style:{x:_[0],y:_[1]}};if(o.ecModel.isAnimationEnabled()&&!this._firstShowIndicator){var b={duration:100,easing:"cubicInOut",additive:!0};f.x=m.x,f.y=m.y,f.animateTo(M,b),y.animateTo(w,b)}else f.attr(M),y.attr(w);this._firstShowIndicator=!1;var A=this._shapes.handleLabels;if(A)for(var E=0;E<A.length;E++)this.api.enterBlur(A[E])}},t.prototype._enableHoverLinkToSeries=function(){var r=this;this._shapes.mainGroup.on("mousemove",function(n){if(r._hovering=!0,!r._dragging){var i=r.visualMapModel.itemSize,a=r._applyTransform([n.offsetX,n.offsetY],r._shapes.mainGroup,!0,!0);a[1]=hP(Vx(0,a[1]),i[1]),r._doHoverLinkToSeries(a[1],0<=a[0]&&a[0]<=i[0])}}).on("mouseout",function(){r._hovering=!1,!r._dragging&&r._clearHoverLinkToSeries()})},t.prototype._enableHoverLinkFromSeries=function(){var r=this.api.getZr();this.visualMapModel.option.hoverLink?(r.on("mouseover",this._hoverLinkFromSeriesMouseOver,this),r.on("mouseout",this._hideIndicator,this)):this._clearHoverLinkFromSeries()},t.prototype._doHoverLinkToSeries=function(r,n){var i=this.visualMapModel,a=i.itemSize;if(i.option.hoverLink){var o=[0,a[1]],s=i.getExtent();r=hP(Vx(o[0],r),o[1]);var l=ant(i,s,o),u=[r-l,r+l],h=Ca(r,o,s,!0),f=[Ca(u[0],o,s,!0),Ca(u[1],o,s,!0)];u[0]<o[0]&&(f[0]=-1/0),u[1]>o[1]&&(f[1]=1/0),n&&(f[0]===-1/0?this._showIndicator(h,f[1],"< ",l):f[1]===1/0?this._showIndicator(h,f[0],"> ",l):this._showIndicator(h,h,"≈ ",l));var c=this._hoverLinkDataIndices,d=[];(n||cP(i))&&(d=this._hoverLinkDataIndices=i.findTargetDataIndices(f));var v=m5(c,d);this._dispatchHighDown("downplay",rm(v[0],i)),this._dispatchHighDown("highlight",rm(v[1],i))}},t.prototype._hoverLinkFromSeriesMouseOver=function(r){var n;if(Ql(r.target,function(l){var u=oe(l);if(u.dataIndex!=null)return n=u,!0},!0),!!n){var i=this.ecModel.getSeriesByIndex(n.seriesIndex),a=this.visualMapModel;if(a.isTargetSeries(i)){var o=i.getData(n.dataType),s=o.getStore().get(a.getDataDimensionIndex(o),n.dataIndex);isNaN(s)||this._showIndicator(s,s)}}},t.prototype._hideIndicator=function(){var r=this._shapes;r.indicator&&r.indicator.attr("invisible",!0),r.indicatorLabel&&r.indicatorLabel.attr("invisible",!0);var n=this._shapes.handleLabels;if(n)for(var i=0;i<n.length;i++)this.api.leaveBlur(n[i])},t.prototype._clearHoverLinkToSeries=function(){this._hideIndicator();var r=this._hoverLinkDataIndices;this._dispatchHighDown("downplay",rm(r,this.visualMapModel)),r.length=0},t.prototype._clearHoverLinkFromSeries=function(){this._hideIndicator();var r=this.api.getZr();r.off("mouseover",this._hoverLinkFromSeriesMouseOver),r.off("mouseout",this._hideIndicator)},t.prototype._applyTransform=function(r,n,i,a){var o=du(n,a?null:this.group);return at(r)?va(r,o,i):B_(r,o,i)},t.prototype._dispatchHighDown=function(r,n){n&&n.length&&this.api.dispatchAction({type:r,batch:n})},t.prototype.dispose=function(){this._clearHoverLinkFromSeries(),this._clearHoverLinkToSeries()},t.type="visualMap.continuous",t}(gk);function fP(e,t,r,n){return new Yn({shape:{points:e},draggable:!!r,cursor:t,drift:r,onmousemove:function(i){Lo(i.event)},ondragend:n})}function ant(e,t,r){var n=rnt/2,i=e.get("hoverLinkDataSize");return i&&(n=Ca(i,t,r,!0)/2),n}function cP(e){var t=e.get("hoverLinkOnHandle");return!!(t??e.get("realtime"))}function dP(e){return e==="vertical"?"ns-resize":"ew-resize"}var ont={type:"selectDataRange",event:"dataRangeSelected",update:"update"},snt=function(e,t){t.eachComponent({mainType:"visualMap",query:e},function(r){r.setSelected(e.selected)})},lnt=[{createOnAllSeries:!0,reset:function(e,t){var r=[];return t.eachComponent("visualMap",function(n){var i=e.pipelineContext;!n.isTargetSeries(e)||i&&i.large||r.push(Let(n.stateList,n.targetVisuals,It(n.getValueState,n),n.getDataDimensionIndex(e.getData())))}),r}},{createOnAllSeries:!0,reset:function(e,t){var r=e.getData(),n=[];t.eachComponent("visualMap",function(i){if(i.isTargetSeries(e)){var a=i.getVisualMeta(It(unt,null,e,i))||{stops:[],outerColors:[]},o=i.getDataDimensionIndex(r);o>=0&&(a.dimension=o,n.push(a))}}),e.getData().setVisual("visualMeta",n)}}];function unt(e,t,r,n){for(var i=t.targetVisuals[n],a=rn.prepareVisualTypes(i),o={color:Av(e.getData(),"color")},s=0,l=a.length;s<l;s++){var u=a[s],h=i[u==="opacity"?"__alphaForOpacity":u];h&&h.applyVisual(r,f,c)}return o.color;function f(d){return o[d]}function c(d,v){o[d]=v}}var vP=R;function hnt(e){var t=e&&e.visualMap;at(t)||(t=t?[t]:[]),vP(t,function(r){if(r){dh(r,"splitList")&&!dh(r,"pieces")&&(r.pieces=r.splitList,delete r.splitList);var n=r.pieces;n&&at(n)&&vP(n,function(i){Kt(i)&&(dh(i,"start")&&!dh(i,"min")&&(i.min=i.start),dh(i,"end")&&!dh(i,"max")&&(i.max=i.end))})}})}function dh(e,t){return e&&e.hasOwnProperty&&e.hasOwnProperty(t)}var pP=!1;function _k(e){pP||(pP=!0,e.registerSubTypeDefaulter("visualMap",function(t){return!t.categories&&(!(t.pieces?t.pieces.length>0:t.splitNumber>0)||t.calculable)?"continuous":"piecewise"}),e.registerAction(ont,snt),R(lnt,function(t){e.registerVisual(e.PRIORITY.VISUAL.COMPONENT,t)}),e.registerPreprocessor(hnt))}function yk(e){e.registerComponentModel(tnt),e.registerComponentView(int),_k(e)}var fnt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r._pieceList=[],r}return t.prototype.optionUpdated=function(r,n){e.prototype.optionUpdated.apply(this,arguments),this.resetExtent();var i=this._mode=this._determineMode();this._pieceList=[],cnt[this._mode].call(this,this._pieceList),this._resetSelected(r,n);var a=this.option.categories;this.resetVisual(function(o,s){i==="categories"?(o.mappingMethod="category",o.categories=Qt(a)):(o.dataExtent=this.getExtent(),o.mappingMethod="piecewise",o.pieceList=ft(this._pieceList,function(l){return l=Qt(l),s!=="inRange"&&(l.visual=null),l}))})},t.prototype.completeVisualOption=function(){var r=this.option,n={},i=rn.listVisualTypes(),a=this.isCategory();R(r.pieces,function(s){R(i,function(l){s.hasOwnProperty(l)&&(n[l]=1)})}),R(n,function(s,l){var u=!1;R(this.stateList,function(h){u=u||o(r,h,l)||o(r.target,h,l)},this),!u&&R(this.stateList,function(h){(r[h]||(r[h]={}))[l]=pk.get(l,h==="inRange"?"active":"inactive",a)})},this);function o(s,l,u){return s&&s[l]&&s[l].hasOwnProperty(u)}e.prototype.completeVisualOption.apply(this,arguments)},t.prototype._resetSelected=function(r,n){var i=this.option,a=this._pieceList,o=(n?i:r).selected||{};if(i.selected=o,R(a,function(l,u){var h=this.getSelectedMapKey(l);o.hasOwnProperty(h)||(o[h]=!0)},this),i.selectedMode==="single"){var s=!1;R(a,function(l,u){var h=this.getSelectedMapKey(l);o[h]&&(s?o[h]=!1:s=!0)},this)}},t.prototype.getItemSymbol=function(){return this.get("itemSymbol")},t.prototype.getSelectedMapKey=function(r){return this._mode==="categories"?r.value+"":r.index+""},t.prototype.getPieceList=function(){return this._pieceList},t.prototype._determineMode=function(){var r=this.option;return r.pieces&&r.pieces.length>0?"pieces":this.option.categories?"categories":"splitNumber"},t.prototype.setSelected=function(r){this.option.selected=Qt(r)},t.prototype.getValueState=function(r){var n=rn.findPieceIndex(r,this._pieceList);return n!=null&&this.option.selected[this.getSelectedMapKey(this._pieceList[n])]?"inRange":"outOfRange"},t.prototype.findTargetDataIndices=function(r){var n=[],i=this._pieceList;return this.eachTargetSeries(function(a){var o=[],s=a.getData();s.each(this.getDataDimensionIndex(s),function(l,u){var h=rn.findPieceIndex(l,i);h===r&&o.push(u)},this),n.push({seriesId:a.id,dataIndex:o})},this),n},t.prototype.getRepresentValue=function(r){var n;if(this.isCategory())n=r.value;else if(r.value!=null)n=r.value;else{var i=r.interval||[];n=i[0]===-1/0&&i[1]===1/0?0:(i[0]+i[1])/2}return n},t.prototype.getVisualMeta=function(r){if(this.isCategory())return;var n=[],i=["",""],a=this;function o(h,f){var c=a.getRepresentValue({interval:h});f||(f=a.getValueState(c));var d=r(c,f);h[0]===-1/0?i[0]=d:h[1]===1/0?i[1]=d:n.push({value:h[0],color:d},{value:h[1],color:d})}var s=this._pieceList.slice();if(!s.length)s.push({interval:[-1/0,1/0]});else{var l=s[0].interval[0];l!==-1/0&&s.unshift({interval:[-1/0,l]}),l=s[s.length-1].interval[1],l!==1/0&&s.push({interval:[l,1/0]})}var u=-1/0;return R(s,function(h){var f=h.interval;f&&(f[0]>u&&o([u,f[0]],"outOfRange"),o(f.slice()),u=f[1])},this),{stops:n,outerColors:i}},t.type="visualMap.piecewise",t.defaultOption=Ws(t_.defaultOption,{selected:null,minOpen:!1,maxOpen:!1,align:"auto",itemWidth:20,itemHeight:14,itemSymbol:"roundRect",pieces:null,categories:null,splitNumber:5,selectedMode:"multiple",itemGap:10,hoverLink:!0}),t}(t_),cnt={splitNumber:function(e){var t=this.option,r=Math.min(t.precision,20),n=this.getExtent(),i=t.splitNumber;i=Math.max(parseInt(i,10),1),t.splitNumber=i;for(var a=(n[1]-n[0])/i;+a.toFixed(r)!==a&&r<5;)r++;t.precision=r,a=+a.toFixed(r),t.minOpen&&e.push({interval:[-1/0,n[0]],close:[0,0]});for(var o=0,s=n[0];o<i;s+=a,o++){var l=o===i-1?n[1]:s+a;e.push({interval:[s,l],close:[1,1]})}t.maxOpen&&e.push({interval:[n[1],1/0],close:[0,0]}),uE(e),R(e,function(u,h){u.index=h,u.text=this.formatValueText(u.interval)},this)},categories:function(e){var t=this.option;R(t.categories,function(r){e.push({text:this.formatValueText(r,!0),value:r})},this),gP(t,e)},pieces:function(e){var t=this.option;R(t.pieces,function(r,n){Kt(r)||(r={value:r});var i={text:"",index:n};if(r.label!=null&&(i.text=r.label),r.hasOwnProperty("value")){var a=i.value=r.value;i.interval=[a,a],i.close=[1,1]}else{for(var o=i.interval=[],s=i.close=[0,0],l=[1,0,1],u=[-1/0,1/0],h=[],f=0;f<2;f++){for(var c=[["gte","gt","min"],["lte","lt","max"]][f],d=0;d<3&&o[f]==null;d++)o[f]=r[c[d]],s[f]=l[d],h[f]=d===2;o[f]==null&&(o[f]=u[f])}h[0]&&o[1]===1/0&&(s[0]=0),h[1]&&o[0]===-1/0&&(s[1]=0),o[0]===o[1]&&s[0]&&s[1]&&(i.value=o[0])}i.visual=rn.retrieveVisuals(r),e.push(i)},this),gP(t,e),uE(e),R(e,function(r){var n=r.close,i=[["<","≤"][n[1]],[">","≥"][n[0]]];r.text=r.text||this.formatValueText(r.value!=null?r.value:r.interval,!1,i)},this)}};function gP(e,t){var r=e.inverse;(e.orient==="vertical"?!r:r)&&t.reverse()}var dnt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type=t.type,r}return t.prototype.doRender=function(){var r=this.group;r.removeAll();var n=this.visualMapModel,i=n.get("textGap"),a=n.textStyleModel,o=a.getFont(),s=a.getTextColor(),l=this._getItemAlign(),u=n.itemSize,h=this._getViewData(),f=h.endsText,c=pn(n.get("showLabel",!0),!f),d=!n.get("selectedMode");f&&this._renderEndsText(r,f[0],u,c,l),R(h.viewPieceList,function(v){var p=v.piece,g=new re;g.onclick=It(this._onItemClick,this,p),this._enableHoverLink(g,v.indexInModelPieceList);var m=n.getRepresentValue(p);if(this._createItemSymbol(g,m,[0,0,u[0],u[1]],d),c){var _=this.visualMapModel.getValueState(m);g.add(new we({style:{x:l==="right"?-i:u[0]+i,y:u[1]/2,text:p.text,verticalAlign:"middle",align:l,font:o,fill:s,opacity:_==="outOfRange"?.5:1},silent:d}))}r.add(g)},this),f&&this._renderEndsText(r,f[1],u,c,l),vu(n.get("orient"),r,n.get("itemGap")),this.renderBackground(r),this.positionGroup(r)},t.prototype._enableHoverLink=function(r,n){var i=this;r.on("mouseover",function(){return a("highlight")}).on("mouseout",function(){return a("downplay")});var a=function(o){var s=i.visualMapModel;s.option.hoverLink&&i.api.dispatchAction({type:o,batch:rm(s.findTargetDataIndices(n),s)})}},t.prototype._getItemAlign=function(){var r=this.visualMapModel,n=r.option;if(n.orient==="vertical")return mk(r,this.api,r.itemSize);var i=n.align;return(!i||i==="auto")&&(i="left"),i},t.prototype._renderEndsText=function(r,n,i,a,o){if(n){var s=new re,l=this.visualMapModel.textStyleModel;s.add(new we({style:je(l,{x:a?o==="right"?i[0]:0:i[0]/2,y:i[1]/2,verticalAlign:"middle",align:a?o:"center",text:n})})),r.add(s)}},t.prototype._getViewData=function(){var r=this.visualMapModel,n=ft(r.getPieceList(),function(s,l){return{piece:s,indexInModelPieceList:l}}),i=r.get("text"),a=r.get("orient"),o=r.get("inverse");return(a==="horizontal"?o:!o)?n.reverse():i&&(i=i.slice().reverse()),{viewPieceList:n,endsText:i}},t.prototype._createItemSymbol=function(r,n,i,a){var o=Pr(this.getControllerVisual(n,"symbol"),i[0],i[1],i[2],i[3],this.getControllerVisual(n,"color"));o.silent=a,r.add(o)},t.prototype._onItemClick=function(r){var n=this.visualMapModel,i=n.option,a=i.selectedMode;if(a){var o=Qt(i.selected),s=n.getSelectedMapKey(r);a==="single"||a===!0?(o[s]=!0,R(o,function(l,u){o[u]=u===s})):o[s]=!o[s],this.api.dispatchAction({type:"selectDataRange",from:this.uid,visualMapId:this.visualMapModel.id,selected:o})}},t.type="visualMap.piecewise",t}(gk);function xk(e){e.registerComponentModel(fnt),e.registerComponentView(dnt),_k(e)}function vnt(e){te(yk),te(xk)}var pnt={label:{enabled:!0},decal:{show:!1}},mP=Le(),gnt={};function mnt(e,t){var r=e.getModel("aria");if(!r.get("enabled"))return;var n=Qt(pnt);Ot(n.label,e.getLocaleModel().get("aria"),!1),Ot(r.option,n,!1),i(),a();function i(){var u=r.getModel("decal"),h=u.get("show");if(h){var f=Ut();e.eachSeries(function(c){if(!c.isColorBySeries()){var d=f.get(c.type);d||(d={},f.set(c.type,d)),mP(c).scope=d}}),e.eachRawSeries(function(c){if(e.isSeriesFiltered(c))return;if(Yt(c.enableAriaDecal)){c.enableAriaDecal();return}var d=c.getData();if(c.isColorBySeries()){var _=OS(c.ecModel,c.name,gnt,e.getSeriesCount()),y=d.getVisual("decal");d.setVisual("decal",x(y,_))}else{var v=c.getRawData(),p={},g=mP(c).scope;d.each(function(T){var S=d.getRawIndex(T);p[S]=T});var m=v.count();v.each(function(T){var S=p[T],M=v.getName(T)||T+"",w=OS(c.ecModel,M,g,m),b=d.getItemVisual(S,"decal");d.setItemVisual(S,"decal",x(b,w))})}function x(T,S){var M=T?rt(rt({},S),T):S;return M.dirty=!0,M}})}}function a(){var u=t.getZr().dom;if(u){var h=e.getLocaleModel().get("aria"),f=r.getModel("label");if(f.option=Vt(f.option,h),!!f.get("enabled")){if(u.setAttribute("role","img"),f.get("description")){u.setAttribute("aria-label",f.get("description"));return}var c=e.getSeriesCount(),d=f.get(["data","maxCount"])||10,v=f.get(["series","maxCount"])||10,p=Math.min(c,v),g;if(!(c<1)){var m=s();if(m){var _=f.get(["general","withTitle"]);g=o(_,{title:m})}else g=f.get(["general","withoutTitle"]);var y=[],x=c>1?f.get(["series","multiple","prefix"]):f.get(["series","single","prefix"]);g+=o(x,{seriesCount:c}),e.eachSeries(function(w,b){if(b<p){var A=void 0,E=w.get("name"),C=E?"withName":"withoutName";A=c>1?f.get(["series","multiple",C]):f.get(["series","single",C]),A=o(A,{seriesId:w.seriesIndex,seriesName:w.get("name"),seriesType:l(w.subType)});var D=w.getData();if(D.count()>d){var L=f.get(["data","partialData"]);A+=o(L,{displayCnt:d})}else A+=f.get(["data","allData"]);for(var P=f.get(["data","separator","middle"]),N=f.get(["data","separator","end"]),O=f.get(["data","excludeDimensionId"]),I=[],k=0;k<D.count();k++)if(k<d){var z=D.getName(k),X=O?Xe(D.getValues(k),function($,H){return pe(O,H)===-1}):D.getValues(k),Y=f.get(["data",z?"withName":"withoutName"]);I.push(o(Y,{name:z,value:X.join(P)}))}A+=I.join(P)+N,y.push(A)}});var T=f.getModel(["series","multiple","separator"]),S=T.get("middle"),M=T.get("end");g+=y.join(S)+M,u.setAttribute("aria-label",g)}}}}function o(u,h){if(!Ct(u))return u;var f=u;return R(h,function(c,d){f=f.replace(new RegExp("\\{\\s*"+d+"\\s*\\}","g"),c)}),f}function s(){var u=e.get("title");return u&&u.length&&(u=u[0]),u&&u.text}function l(u){var h=e.getLocaleModel().get(["series","typeNames"]);return h[u]||h.chart}}function _nt(e){if(!(!e||!e.aria)){var t=e.aria;t.show!=null&&(t.enabled=t.show),t.label=t.label||{},R(["description","general","series","data"],function(r){t[r]!=null&&(t.label[r]=t[r])})}}function ynt(e){e.registerPreprocessor(_nt),e.registerVisual(e.PRIORITY.VISUAL.ARIA,mnt)}var _P={value:"eq","<":"lt","<=":"lte",">":"gt",">=":"gte","=":"eq","!=":"ne","<>":"ne"},xnt=function(){function e(t){var r=this._condVal=Ct(t)?new RegExp(t):O4(t)?t:null;if(r==null){var n="";We(n)}}return e.prototype.evaluate=function(t){var r=typeof t;return Ct(r)?this._condVal.test(t):Be(r)?this._condVal.test(t+""):!1},e}(),Snt=function(){function e(){}return e.prototype.evaluate=function(){return this.value},e}(),Tnt=function(){function e(){}return e.prototype.evaluate=function(){for(var t=this.children,r=0;r<t.length;r++)if(!t[r].evaluate())return!1;return!0},e}(),bnt=function(){function e(){}return e.prototype.evaluate=function(){for(var t=this.children,r=0;r<t.length;r++)if(t[r].evaluate())return!0;return!1},e}(),wnt=function(){function e(){}return e.prototype.evaluate=function(){return!this.child.evaluate()},e}(),Mnt=function(){function e(){}return e.prototype.evaluate=function(){for(var t=!!this.valueParser,r=this.getValue,n=r(this.valueGetterParam),i=t?this.valueParser(n):null,a=0;a<this.subCondList.length;a++)if(!this.subCondList[a].evaluate(t?i:n))return!1;return!0},e}();function QM(e,t){if(e===!0||e===!1){var r=new Snt;return r.value=e,r}var n="";return Sk(e)||We(n),e.and?yP("and",e,t):e.or?yP("or",e,t):e.not?Ant(e,t):Ent(e,t)}function yP(e,t,r){var n=t[e],i="";at(n)||We(i),n.length||We(i);var a=e==="and"?new Tnt:new bnt;return a.children=ft(n,function(o){return QM(o,r)}),a.children.length||We(i),a}function Ant(e,t){var r=e.not,n="";Sk(r)||We(n);var i=new wnt;return i.child=QM(r,t),i.child||We(n),i}function Ent(e,t){for(var r="",n=t.prepareGetValue(e),i=[],a=be(e),o=e.parser,s=o?K3(o):null,l=0;l<a.length;l++){var u=a[l];if(!(u==="parser"||t.valueGetterAttrMap.get(u))){var h=Ft(_P,u)?_P[u]:u,f=e[u],c=s?s(f):f,d=x8(h,c)||h==="reg"&&new xnt(c);d||We(r),i.push(d)}}i.length||We(r);var v=new Mnt;return v.valueGetterParam=n,v.valueParser=s,v.getValue=t.getValue,v.subCondList=i,v}function Sk(e){return Kt(e)&&!Dn(e)}var Cnt=function(){function e(t,r){this._cond=QM(t,r)}return e.prototype.evaluate=function(){return this._cond.evaluate()},e}();function Dnt(e,t){return new Cnt(e,t)}var Lnt={type:"echarts:filter",transform:function(e){for(var t=e.upstream,r,n=Dnt(e.config,{valueGetterAttrMap:Ut({dimension:!0}),prepareGetValue:function(s){var l="",u=s.dimension;Ft(s,"dimension")||We(l);var h=t.getDimensionInfo(u);return h||We(l),{dimIdx:h.index}},getValue:function(s){return t.retrieveValueFromItem(r,s.dimIdx)}}),i=[],a=0,o=t.count();a<o;a++)r=t.getRawDataItem(a),n.evaluate()&&i.push(r);return{data:i}}},Rnt={type:"echarts:sort",transform:function(e){var t=e.upstream,r=e.config,n="",i=er(r);i.length||We(n);var a=[];R(i,function(h){var f=h.dimension,c=h.order,d=h.parser,v=h.incomparable;if(f==null&&We(n),c!=="asc"&&c!=="desc"&&We(n),v&&v!=="min"&&v!=="max"){var p="";We(p)}if(c!=="asc"&&c!=="desc"){var g="";We(g)}var m=t.getDimensionInfo(f);m||We(n);var _=d?K3(d):null;d&&!_&&We(n),a.push({dimIdx:m.index,parser:_,comparator:new J3(c,v)})});var o=t.sourceFormat;o!==Ln&&o!==$i&&We(n);for(var s=[],l=0,u=t.count();l<u;l++)s.push(t.getRawDataItem(l));return s.sort(function(h,f){for(var c=0;c<a.length;c++){var d=a[c],v=t.retrieveValueFromItem(h,d.dimIdx),p=t.retrieveValueFromItem(f,d.dimIdx);d.parser&&(v=d.parser(v),p=d.parser(p));var g=d.comparator.evaluate(v,p);if(g!==0)return g}return 0}),{data:s}}};function Pnt(e){e.registerTransform(Lnt),e.registerTransform(Rnt)}var Int=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="dataset",r}return t.prototype.init=function(r,n,i){e.prototype.init.call(this,r,n,i),this._sourceManager=new rF(this),S2(this)},t.prototype.mergeOption=function(r,n){e.prototype.mergeOption.call(this,r,n),S2(this)},t.prototype.optionUpdated=function(){this._sourceManager.dirty()},t.prototype.getSourceManager=function(){return this._sourceManager},t.type="dataset",t.defaultOption={seriesLayoutBy:Ha},t}(me),Nnt=function(e){q(t,e);function t(){var r=e!==null&&e.apply(this,arguments)||this;return r.type="dataset",r}return t.type="dataset",t}(nr);function Tk(e){e.registerComponentModel(Int),e.registerComponentView(Nnt)}var Aa=Ka.CMD;function Zh(e,t){return Math.abs(e-t)<1e-5}function FT(e){var t=e.data,r=e.len(),n=[],i,a=0,o=0,s=0,l=0;function u(D,L){i&&i.length>2&&n.push(i),i=[D,L]}function h(D,L,P,N){Zh(D,P)&&Zh(L,N)||i.push(D,L,P,N,P,N)}function f(D,L,P,N,O,I){var k=Math.abs(L-D),z=Math.tan(k/4)*4/3,X=L<D?-1:1,Y=Math.cos(D),$=Math.sin(D),H=Math.cos(L),Z=Math.sin(L),ct=Y*O+P,ut=$*I+N,tt=H*O+P,et=Z*I+N,st=O*z*X,nt=I*z*X;i.push(ct-st*$,ut+nt*Y,tt+st*Z,et-nt*H,tt,et)}for(var c,d,v,p,g=0;g<r;){var m=t[g++],_=g===1;switch(_&&(a=t[g],o=t[g+1],s=a,l=o,(m===Aa.L||m===Aa.C||m===Aa.Q)&&(i=[s,l])),m){case Aa.M:a=s=t[g++],o=l=t[g++],u(s,l);break;case Aa.L:c=t[g++],d=t[g++],h(a,o,c,d),a=c,o=d;break;case Aa.C:i.push(t[g++],t[g++],t[g++],t[g++],a=t[g++],o=t[g++]);break;case Aa.Q:c=t[g++],d=t[g++],v=t[g++],p=t[g++],i.push(a+2/3*(c-a),o+2/3*(d-o),v+2/3*(c-v),p+2/3*(d-p),v,p),a=v,o=p;break;case Aa.A:var y=t[g++],x=t[g++],T=t[g++],S=t[g++],M=t[g++],w=t[g++]+M;g+=1;var b=!t[g++];c=Math.cos(M)*T+y,d=Math.sin(M)*S+x,_?(s=c,l=d,u(s,l)):h(a,o,c,d),a=Math.cos(w)*T+y,o=Math.sin(w)*S+x;for(var A=(b?-1:1)*Math.PI/2,E=M;b?E>w:E<w;E+=A){var C=b?Math.max(E+A,w):Math.min(E+A,w);f(E,C,y,x,T,S)}break;case Aa.R:s=a=t[g++],l=o=t[g++],c=s+t[g++],d=l+t[g++],u(c,l),h(c,l,c,d),h(c,d,s,d),h(s,d,s,l),h(s,l,c,l);break;case Aa.Z:i&&h(a,o,s,l),a=s,o=l;break}}return i&&i.length>2&&n.push(i),n}function BT(e,t,r,n,i,a,o,s,l,u){if(Zh(e,r)&&Zh(t,n)&&Zh(i,o)&&Zh(a,s)){l.push(o,s);return}var h=2/u,f=h*h,c=o-e,d=s-t,v=Math.sqrt(c*c+d*d);c/=v,d/=v;var p=r-e,g=n-t,m=i-o,_=a-s,y=p*p+g*g,x=m*m+_*_;if(y<f&&x<f){l.push(o,s);return}var T=c*p+d*g,S=-c*m-d*_,M=y-T*T,w=x-S*S;if(M<f&&T>=0&&w<f&&S>=0){l.push(o,s);return}var b=[],A=[];Os(e,r,i,o,.5,b),Os(t,n,a,s,.5,A),BT(b[0],A[0],b[1],A[1],b[2],A[2],b[3],A[3],l,u),BT(b[4],A[4],b[5],A[5],b[6],A[6],b[7],A[7],l,u)}function Ont(e,t){var r=FT(e),n=[];t=t||1;for(var i=0;i<r.length;i++){var a=r[i],o=[],s=a[0],l=a[1];o.push(s,l);for(var u=2;u<a.length;){var h=a[u++],f=a[u++],c=a[u++],d=a[u++],v=a[u++],p=a[u++];BT(s,l,h,f,c,d,v,p,o,t),s=v,l=p}n.push(o)}return n}function bk(e,t,r){var n=e[t],i=e[1-t],a=Math.abs(n/i),o=Math.ceil(Math.sqrt(a*r)),s=Math.floor(r/o);s===0&&(s=1,o=r);for(var l=[],u=0;u<o;u++)l.push(s);var h=o*s,f=r-h;if(f>0)for(var u=0;u<f;u++)l[u%o]+=1;return l}function xP(e,t,r){for(var n=e.r0,i=e.r,a=e.startAngle,o=e.endAngle,s=Math.abs(o-a),l=s*i,u=i-n,h=l>Math.abs(u),f=bk([l,u],h?0:1,t),c=(h?s:u)/f.length,d=0;d<f.length;d++)for(var v=(h?u:s)/f[d],p=0;p<f[d];p++){var g={};h?(g.startAngle=a+c*d,g.endAngle=a+c*(d+1),g.r0=n+v*p,g.r=n+v*(p+1)):(g.startAngle=a+v*p,g.endAngle=a+v*(p+1),g.r0=n+c*d,g.r=n+c*(d+1)),g.clockwise=e.clockwise,g.cx=e.cx,g.cy=e.cy,r.push(g)}}function Fnt(e,t,r){for(var n=e.width,i=e.height,a=n>i,o=bk([n,i],a?0:1,t),s=a?"width":"height",l=a?"height":"width",u=a?"x":"y",h=a?"y":"x",f=e[s]/o.length,c=0;c<o.length;c++)for(var d=e[l]/o[c],v=0;v<o[c];v++){var p={};p[u]=c*f,p[h]=v*d,p[s]=f,p[l]=d,p.x+=e.x,p.y+=e.y,r.push(p)}}function SP(e,t,r,n){return e*n-r*t}function Bnt(e,t,r,n,i,a,o,s){var l=r-e,u=n-t,h=o-i,f=s-a,c=SP(h,f,l,u);if(Math.abs(c)<1e-6)return null;var d=e-i,v=t-a,p=SP(d,v,h,f)/c;return p<0||p>1?null:new he(p*l+e,p*u+t)}function Unt(e,t,r){var n=new he;he.sub(n,r,t),n.normalize();var i=new he;he.sub(i,e,t);var a=i.dot(n);return a}function vh(e,t){var r=e[e.length-1];r&&r[0]===t[0]&&r[1]===t[1]||e.push(t)}function znt(e,t,r){for(var n=e.length,i=[],a=0;a<n;a++){var o=e[a],s=e[(a+1)%n],l=Bnt(o[0],o[1],s[0],s[1],t.x,t.y,r.x,r.y);l&&i.push({projPt:Unt(l,t,r),pt:l,idx:a})}if(i.length<2)return[{points:e},{points:e}];i.sort(function(g,m){return g.projPt-m.projPt});var u=i[0],h=i[i.length-1];if(h.idx<u.idx){var f=u;u=h,h=f}for(var c=[u.pt.x,u.pt.y],d=[h.pt.x,h.pt.y],v=[c],p=[d],a=u.idx+1;a<=h.idx;a++)vh(v,e[a].slice());vh(v,d),vh(v,c);for(var a=h.idx+1;a<=u.idx+n;a++)vh(p,e[a%n].slice());return vh(p,c),vh(p,d),[{points:v},{points:p}]}function TP(e){var t=e.points,r=[],n=[];R_(t,r,n);var i=new fe(r[0],r[1],n[0]-r[0],n[1]-r[1]),a=i.width,o=i.height,s=i.x,l=i.y,u=new he,h=new he;return a>o?(u.x=h.x=s+a/2,u.y=l,h.y=l+o):(u.y=h.y=l+o/2,u.x=s,h.x=s+a),znt(t,u,h)}function e_(e,t,r,n){if(r===1)n.push(t);else{var i=Math.floor(r/2),a=e(t);e_(e,a[0],i,n),e_(e,a[1],r-i,n)}return n}function knt(e,t){for(var r=[],n=0;n<t;n++)r.push(hw(e));return r}function Gnt(e,t){t.setStyle(e.style),t.z=e.z,t.z2=e.z2,t.zlevel=e.zlevel}function Vnt(e){for(var t=[],r=0;r<e.length;)t.push([e[r++],e[r++]]);return t}function Hnt(e,t){var r=[],n=e.shape,i;switch(e.type){case"rect":Fnt(n,t,r),i=Ae;break;case"sector":xP(n,t,r),i=Xn;break;case"circle":xP({r0:0,r:n.r,startAngle:0,endAngle:Math.PI*2,cx:n.cx,cy:n.cy},t,r),i=Xn;break;default:var a=e.getComputedTransform(),o=a?Math.sqrt(Math.max(a[0]*a[0]+a[1]*a[1],a[2]*a[2]+a[3]*a[3])):1,s=ft(Ont(e.getUpdatedPathProxy(),o),function(m){return Vnt(m)}),l=s.length;if(l===0)e_(TP,{points:s[0]},t,r);else if(l===t)for(var u=0;u<l;u++)r.push({points:s[u]});else{var h=0,f=ft(s,function(m){var _=[],y=[];R_(m,_,y);var x=(y[1]-_[1])*(y[0]-_[0]);return h+=x,{poly:m,area:x}});f.sort(function(m,_){return _.area-m.area});for(var c=t,u=0;u<l;u++){var d=f[u];if(c<=0)break;var v=u===l-1?c:Math.ceil(d.area/h*t);v<0||(e_(TP,{points:d.poly},v,r),c-=v)}}i=Yn;break}if(!i)return knt(e,t);for(var p=[],u=0;u<r.length;u++){var g=new i;g.setShape(r[u]),Gnt(e,g),p.push(g)}return p}function Wnt(e,t){var r=e.length,n=t.length;if(r===n)return[e,t];for(var i=[],a=[],o=r<n?e:t,s=Math.min(r,n),l=Math.abs(n-r)/6,u=(s-2)/6,h=Math.ceil(l/u)+1,f=[o[0],o[1]],c=l,d=2;d<s;){var v=o[d-2],p=o[d-1],g=o[d++],m=o[d++],_=o[d++],y=o[d++],x=o[d++],T=o[d++];if(c<=0){f.push(g,m,_,y,x,T);continue}for(var S=Math.min(c,h-1)+1,M=1;M<=S;M++){var w=M/S;Os(v,g,_,x,w,i),Os(p,m,y,T,w,a),v=i[3],p=a[3],f.push(i[1],a[1],i[2],a[2],v,p),g=i[5],m=a[5],_=i[6],y=a[6]}c-=S-1}return o===e?[f,t]:[e,f]}function bP(e,t){for(var r=e.length,n=e[r-2],i=e[r-1],a=[],o=0;o<t.length;)a[o++]=n,a[o++]=i;return a}function Xnt(e,t){for(var r,n,i,a=[],o=[],s=0;s<Math.max(e.length,t.length);s++){var l=e[s],u=t[s],h=void 0,f=void 0;l?u?(r=Wnt(l,u),h=r[0],f=r[1],n=h,i=f):(f=bP(i||l,l),h=l):(h=bP(n||u,u),f=u),a.push(h),o.push(f)}return[a,o]}function wP(e){for(var t=0,r=0,n=0,i=e.length,a=0,o=i-2;a<i;o=a,a+=2){var s=e[o],l=e[o+1],u=e[a],h=e[a+1],f=s*h-u*l;t+=f,r+=(s+u)*f,n+=(l+h)*f}return t===0?[e[0]||0,e[1]||0]:[r/t/3,n/t/3,t]}function Ynt(e,t,r,n){for(var i=(e.length-2)/6,a=1/0,o=0,s=e.length,l=s-2,u=0;u<i;u++){for(var h=u*6,f=0,c=0;c<s;c+=2){var d=c===0?h:(h+c-2)%l+2,v=e[d]-r[0],p=e[d+1]-r[1],g=t[c]-n[0],m=t[c+1]-n[1],_=g-v,y=m-p;f+=_*_+y*y}f<a&&(a=f,o=u)}return o}function Znt(e){for(var t=[],r=e.length,n=0;n<r;n+=2)t[n]=e[r-n-2],t[n+1]=e[r-n-1];return t}function qnt(e,t,r,n){for(var i=[],a,o=0;o<e.length;o++){var s=e[o],l=t[o],u=wP(s),h=wP(l);a==null&&(a=u[2]<0!=h[2]<0);var f=[],c=[],d=0,v=1/0,p=[],g=s.length;a&&(s=Znt(s));for(var m=Ynt(s,l,u,h)*6,_=g-2,y=0;y<_;y+=2){var x=(m+y)%_+2;f[y+2]=s[x]-u[0],f[y+3]=s[x+1]-u[1]}f[0]=s[m]-u[0],f[1]=s[m+1]-u[1];for(var T=n/r,S=-n/2;S<=n/2;S+=T){for(var M=Math.sin(S),w=Math.cos(S),b=0,y=0;y<s.length;y+=2){var A=f[y],E=f[y+1],C=l[y]-h[0],D=l[y+1]-h[1],L=C*w-D*M,P=C*M+D*w;p[y]=L,p[y+1]=P;var N=L-A,O=P-E;b+=N*N+O*O}if(b<v){v=b,d=S;for(var I=0;I<p.length;I++)c[I]=p[I]}}i.push({from:f,to:c,fromCp:u,toCp:h,rotation:-d})}return i}function r_(e){return e.__isCombineMorphing}var wk="__mOriginal_";function n_(e,t,r){var n=wk+t,i=e[n]||e[t];e[n]||(e[n]=e[t]);var a=r.replace,o=r.after,s=r.before;e[t]=function(){var l=arguments,u;return s&&s.apply(this,l),a?u=a.apply(this,l):u=i.apply(this,l),o&&o.apply(this,l),u}}function Ld(e,t){var r=wk+t;e[r]&&(e[t]=e[r],e[r]=null)}function MP(e,t){for(var r=0;r<e.length;r++)for(var n=e[r],i=0;i<n.length;){var a=n[i],o=n[i+1];n[i++]=t[0]*a+t[2]*o+t[4],n[i++]=t[1]*a+t[3]*o+t[5]}}function Mk(e,t){var r=e.getUpdatedPathProxy(),n=t.getUpdatedPathProxy(),i=Xnt(FT(r),FT(n)),a=i[0],o=i[1],s=e.getComputedTransform(),l=t.getComputedTransform();function u(){this.transform=null}s&&MP(a,s),l&&MP(o,l),n_(t,"updateTransform",{replace:u}),t.transform=null;var h=qnt(a,o,10,Math.PI),f=[];n_(t,"buildPath",{replace:function(c){for(var d=t.__morphT,v=1-d,p=[],g=0;g<h.length;g++){var m=h[g],_=m.from,y=m.to,x=m.rotation*d,T=m.fromCp,S=m.toCp,M=Math.sin(x),w=Math.cos(x);Bg(p,T,S,d);for(var b=0;b<_.length;b+=2){var A=_[b],E=_[b+1],C=y[b],D=y[b+1],L=A*v+C*d,P=E*v+D*d;f[b]=L*w-P*M+p[0],f[b+1]=L*M+P*w+p[1]}var N=f[0],O=f[1];c.moveTo(N,O);for(var b=2;b<_.length;){var C=f[b++],D=f[b++],I=f[b++],k=f[b++],z=f[b++],X=f[b++];N===C&&O===D&&I===z&&k===X?c.lineTo(z,X):c.bezierCurveTo(C,D,I,k,z,X),N=z,O=X}}}})}function tA(e,t,r){if(!e||!t)return t;var n=r.done,i=r.during;Mk(e,t),t.__morphT=0;function a(){Ld(t,"buildPath"),Ld(t,"updateTransform"),t.__morphT=-1,t.createPathProxy(),t.dirtyShape()}return t.animateTo({__morphT:1},Vt({during:function(o){t.dirtyShape(),i&&i(o)},done:function(){a(),n&&n()}},r)),t}function $nt(e,t,r,n,i,a){var o=16;e=i===r?0:Math.round(32767*(e-r)/(i-r)),t=a===n?0:Math.round(32767*(t-n)/(a-n));for(var s=0,l,u=(1<<o)/2;u>0;u/=2){var h=0,f=0;(e&u)>0&&(h=1),(t&u)>0&&(f=1),s+=u*u*(3*h^f),f===0&&(h===1&&(e=u-1-e,t=u-1-t),l=e,e=t,t=l)}return s}function i_(e){var t=1/0,r=1/0,n=-1/0,i=-1/0,a=ft(e,function(s){var l=s.getBoundingRect(),u=s.getComputedTransform(),h=l.x+l.width/2+(u?u[4]:0),f=l.y+l.height/2+(u?u[5]:0);return t=Math.min(h,t),r=Math.min(f,r),n=Math.max(h,n),i=Math.max(f,i),[h,f]}),o=ft(a,function(s,l){return{cp:s,z:$nt(s[0],s[1],t,r,n,i),path:e[l]}});return o.sort(function(s,l){return s.z-l.z}).map(function(s){return s.path})}function Ak(e){return Hnt(e.path,e.count)}function UT(){return{fromIndividuals:[],toIndividuals:[],count:0}}function Knt(e,t,r){var n=[];function i(T){for(var S=0;S<T.length;S++){var M=T[S];r_(M)?i(M.childrenRef()):M instanceof _e&&n.push(M)}}i(e);var a=n.length;if(!a)return UT();var o=r.dividePath||Ak,s=o({path:t,count:a});if(s.length!==a)return console.error("Invalid morphing: unmatched splitted path"),UT();n=i_(n),s=i_(s);for(var l=r.done,u=r.during,h=r.individualDelay,f=new yo,c=0;c<a;c++){var d=n[c],v=s[c];v.parent=t,v.copyTransform(f),h||Mk(d,v)}t.__isCombineMorphing=!0,t.childrenRef=function(){return s};function p(T){for(var S=0;S<s.length;S++)s[S].addSelfToZr(T)}n_(t,"addSelfToZr",{after:function(T){p(T)}}),n_(t,"removeSelfFromZr",{after:function(T){for(var S=0;S<s.length;S++)s[S].removeSelfFromZr(T)}});function g(){t.__isCombineMorphing=!1,t.__morphT=-1,t.childrenRef=null,Ld(t,"addSelfToZr"),Ld(t,"removeSelfFromZr")}var m=s.length;if(h)for(var _=m,y=function(){_--,_===0&&(g(),l&&l())},c=0;c<m;c++){var x=h?Vt({delay:(r.delay||0)+h(c,m,n[c],s[c]),done:y},r):r;tA(n[c],s[c],x)}else t.__morphT=0,t.animateTo({__morphT:1},Vt({during:function(T){for(var S=0;S<m;S++){var M=s[S];M.__morphT=t.__morphT,M.dirtyShape()}u&&u(T)},done:function(){g();for(var T=0;T<e.length;T++)Ld(e[T],"updateTransform");l&&l()}},r));return t.__zr&&p(t.__zr),{fromIndividuals:n,toIndividuals:s,count:m}}function jnt(e,t,r){var n=t.length,i=[],a=r.dividePath||Ak;function o(d){for(var v=0;v<d.length;v++){var p=d[v];r_(p)?o(p.childrenRef()):p instanceof _e&&i.push(p)}}if(r_(e)){o(e.childrenRef());var s=i.length;if(s<n)for(var l=0,u=s;u<n;u++)i.push(hw(i[l++%s]));i.length=n}else{i=a({path:e,count:n});for(var h=e.getComputedTransform(),u=0;u<i.length;u++)i[u].setLocalTransform(h);if(i.length!==n)return console.error("Invalid morphing: unmatched splitted path"),UT()}i=i_(i),t=i_(t);for(var f=r.individualDelay,u=0;u<n;u++){var c=f?Vt({delay:(r.delay||0)+f(u,n,i[u],t[u])},r):r;tA(i[u],t[u],c)}return{fromIndividuals:i,toIndividuals:t,count:t.length}}function AP(e){return at(e[0])}function EP(e,t){for(var r=[],n=e.length,i=0;i<n;i++)r.push({one:e[i],many:[]});for(var i=0;i<t.length;i++){var a=t[i].length,o=void 0;for(o=0;o<a;o++)r[o%n].many.push(t[i][o])}for(var s=0,i=n-1;i>=0;i--)if(!r[i].many.length){var l=r[s].many;if(l.length<=1)if(s)s=0;else return r;var a=l.length,u=Math.ceil(a/2);r[i].many=l.slice(u,a),r[s].many=l.slice(0,u),s++}return r}var Jnt={clone:function(e){for(var t=[],r=1-Math.pow(1-e.path.style.opacity,1/e.count),n=0;n<e.count;n++){var i=hw(e.path);i.setStyle("opacity",r),t.push(i)}return t},split:null};function Hx(e,t,r,n,i,a){if(!e.length||!t.length)return;var o=kf("update",n,i);if(!(o&&o.duration>0))return;var s=n.getModel("universalTransition").get("delay"),l=Object.assign({setToFinal:!0},o),u,h;AP(e)&&(u=e,h=t),AP(t)&&(u=t,h=e);function f(m,_,y,x,T){var S=m.many,M=m.one;if(S.length===1&&!T){var w=_?S[0]:M,b=_?M:S[0];if(r_(w))f({many:[w],one:b},!0,y,x,!0);else{var A=s?Vt({delay:s(y,x)},l):l;tA(w,b,A),a(w,b,w,b,A)}}else for(var E=Vt({dividePath:Jnt[r],individualDelay:s&&function(O,I,k,z){return s(O+y,x)}},l),C=_?Knt(S,M,E):jnt(M,S,E),D=C.fromIndividuals,L=C.toIndividuals,P=D.length,N=0;N<P;N++){var A=s?Vt({delay:s(N,P)},l):l;a(D[N],L[N],_?S[N]:m.one,_?m.one:S[N],A)}}for(var c=u?u===e:e.length>t.length,d=u?EP(h,u):EP(c?t:e,[c?e:t]),v=0,p=0;p<d.length;p++)v+=d[p].many.length;for(var g=0,p=0;p<d.length;p++)f(d[p],c,g,v),g+=d[p].many.length}function kl(e){if(!e)return[];if(at(e)){for(var t=[],r=0;r<e.length;r++)t.push(kl(e[r]));return t}var n=[];return e.traverse(function(i){i instanceof _e&&!i.disableMorphing&&!i.invisible&&!i.ignore&&n.push(i)}),n}var Ek=1e4,Qnt=0,CP=1,DP=2,tit=Le();function eit(e,t){for(var r=e.dimensions,n=0;n<r.length;n++){var i=e.getDimensionInfo(r[n]);if(i&&i.otherDims[t]===0)return r[n]}}function rit(e,t,r){var n=e.getDimensionInfo(r),i=n&&n.ordinalMeta;if(n){var a=e.get(n.name,t);return i&&i.categories[a]||a+""}}function LP(e,t,r,n){var i=n?"itemChildGroupId":"itemGroupId",a=eit(e,i);if(a){var o=rit(e,t,a);return o}var s=e.getRawDataItem(t),l=n?"childGroupId":"groupId";if(s&&s[l])return s[l]+"";if(!n)return r||e.getId(t)}function RP(e){var t=[];return R(e,function(r){var n=r.data,i=r.dataGroupId;if(!(n.count()>Ek))for(var a=n.getIndices(),o=0;o<a.length;o++)t.push({data:n,groupId:LP(n,o,i,!1),childGroupId:LP(n,o,i,!0),divide:r.divide,dataIndex:o})}),t}function Wx(e,t,r){e.traverse(function(n){n instanceof _e&&vr(n,{style:{opacity:0}},t,{dataIndex:r,isFrom:!0})})}function Xx(e){if(e.parent){var t=e.getComputedTransform();e.setLocalTransform(t),e.parent.remove(e)}}function ph(e){e.stopAnimation(),e.isGroup&&e.traverse(function(t){t.stopAnimation()})}function nit(e,t,r){var n=kf("update",r,t);n&&e.traverse(function(i){if(i instanceof Yi){var a=nW(i);a&&i.animateFrom({style:a},n)}})}function iit(e,t){var r=e.length;if(r!==t.length)return!1;for(var n=0;n<r;n++){var i=e[n],a=t[n];if(i.data.getId(i.dataIndex)!==a.data.getId(a.dataIndex))return!1}return!0}function Ck(e,t,r){var n=RP(e),i=RP(t);function a(y,x,T,S,M){(T||y)&&x.animateFrom({style:T&&T!==y?rt(rt({},T.style),y.style):y.style},M)}var o=!1,s=Qnt,l=Ut(),u=Ut();n.forEach(function(y){y.groupId&&l.set(y.groupId,!0),y.childGroupId&&u.set(y.childGroupId,!0)});for(var h=0;h<i.length;h++){var f=i[h].groupId;if(u.get(f)){s=CP;break}var c=i[h].childGroupId;if(c&&l.get(c)){s=DP;break}}function d(y,x){return function(T){var S=T.data,M=T.dataIndex;return x?S.getId(M):y?s===CP?T.childGroupId:T.groupId:s===DP?T.childGroupId:T.groupId}}var v=iit(n,i),p={};if(!v)for(var h=0;h<i.length;h++){var g=i[h],m=g.data.getItemGraphicEl(g.dataIndex);m&&(p[m.id]=!0)}function _(y,x){var T=n[x],S=i[y],M=S.data.hostModel,w=T.data.getItemGraphicEl(T.dataIndex),b=S.data.getItemGraphicEl(S.dataIndex);if(w===b){b&&nit(b,S.dataIndex,M);return}w&&p[w.id]||b&&(ph(b),w?(ph(w),Xx(w),o=!0,Hx(kl(w),kl(b),S.divide,M,y,a)):Wx(b,M,y))}new No(n,i,d(!0,v),d(!1,v),null,"multiple").update(_).updateManyToOne(function(y,x){var T=i[y],S=T.data,M=S.hostModel,w=S.getItemGraphicEl(T.dataIndex),b=Xe(ft(x,function(A){return n[A].data.getItemGraphicEl(n[A].dataIndex)}),function(A){return A&&A!==w&&!p[A.id]});w&&(ph(w),b.length?(R(b,function(A){ph(A),Xx(A)}),o=!0,Hx(kl(b),kl(w),T.divide,M,y,a)):Wx(w,M,T.dataIndex))}).updateOneToMany(function(y,x){var T=n[x],S=T.data.getItemGraphicEl(T.dataIndex);if(!(S&&p[S.id])){var M=Xe(ft(y,function(b){return i[b].data.getItemGraphicEl(i[b].dataIndex)}),function(b){return b&&b!==S}),w=i[y[0]].data.hostModel;M.length&&(R(M,function(b){return ph(b)}),S?(ph(S),Xx(S),o=!0,Hx(kl(S),kl(M),T.divide,w,y[0],a)):R(M,function(b){return Wx(b,w,y[0])}))}}).updateManyToMany(function(y,x){new No(x,y,function(T){return n[T].data.getId(n[T].dataIndex)},function(T){return i[T].data.getId(i[T].dataIndex)}).update(function(T,S){_(y[T],x[S])}).execute()}).execute(),o&&R(t,function(y){var x=y.data,T=x.hostModel,S=T&&r.getViewOfSeriesModel(T),M=kf("update",T,0);S&&T.isAnimationEnabled()&&M&&M.duration>0&&S.group.traverse(function(w){w instanceof _e&&!w.animators.length&&w.animateFrom({style:{opacity:0}},M)})})}function PP(e){var t=e.getModel("universalTransition").get("seriesKey");return t||e.id}function IP(e){return at(e)?e.sort().join(","):e}function vs(e){if(e.hostModel)return e.hostModel.getModel("universalTransition").get("divideShape")}function ait(e,t){var r=Ut(),n=Ut(),i=Ut();return R(e.oldSeries,function(a,o){var s=e.oldDataGroupIds[o],l=e.oldData[o],u=PP(a),h=IP(u);n.set(h,{dataGroupId:s,data:l}),at(u)&&R(u,function(f){i.set(f,{key:h,dataGroupId:s,data:l})})}),R(t.updatedSeries,function(a){if(a.isUniversalTransitionEnabled()&&a.isAnimationEnabled()){var o=a.get("dataGroupId"),s=a.getData(),l=PP(a),u=IP(l),h=n.get(u);if(h)r.set(u,{oldSeries:[{dataGroupId:h.dataGroupId,divide:vs(h.data),data:h.data}],newSeries:[{dataGroupId:o,divide:vs(s),data:s}]});else if(at(l)){var f=[];R(l,function(v){var p=n.get(v);p.data&&f.push({dataGroupId:p.dataGroupId,divide:vs(p.data),data:p.data})}),f.length&&r.set(u,{oldSeries:f,newSeries:[{dataGroupId:o,data:s,divide:vs(s)}]})}else{var c=i.get(l);if(c){var d=r.get(c.key);d||(d={oldSeries:[{dataGroupId:c.dataGroupId,data:c.data,divide:vs(c.data)}],newSeries:[]},r.set(c.key,d)),d.newSeries.push({dataGroupId:o,data:s,divide:vs(s)})}}}}),r}function NP(e,t){for(var r=0;r<e.length;r++){var n=t.seriesIndex!=null&&t.seriesIndex===e[r].seriesIndex||t.seriesId!=null&&t.seriesId===e[r].id;if(n)return r}}function oit(e,t,r,n){var i=[],a=[];R(er(e.from),function(o){var s=NP(t.oldSeries,o);s>=0&&i.push({dataGroupId:t.oldDataGroupIds[s],data:t.oldData[s],divide:vs(t.oldData[s]),groupIdDim:o.dimension})}),R(er(e.to),function(o){var s=NP(r.updatedSeries,o);if(s>=0){var l=r.updatedSeries[s].getData();a.push({dataGroupId:t.oldDataGroupIds[s],data:l,divide:vs(l),groupIdDim:o.dimension})}}),i.length>0&&a.length>0&&Ck(i,a,n)}function sit(e){e.registerUpdateLifecycle("series:beforeupdate",function(t,r,n){R(er(n.seriesTransition),function(i){R(er(i.to),function(a){for(var o=n.updatedSeries,s=0;s<o.length;s++)(a.seriesIndex!=null&&a.seriesIndex===o[s].seriesIndex||a.seriesId!=null&&a.seriesId===o[s].id)&&(o[s][$g]=!0)})})}),e.registerUpdateLifecycle("series:transition",function(t,r,n){var i=tit(r);if(i.oldSeries&&n.updatedSeries&&n.optionChanged){var a=n.seriesTransition;if(a)R(er(a),function(d){oit(d,i,n,r)});else{var o=ait(i,n);R(o.keys(),function(d){var v=o.get(d);Ck(v.oldSeries,v.newSeries,r)})}R(n.updatedSeries,function(d){d[$g]&&(d[$g]=!1)})}for(var s=t.getSeries(),l=i.oldSeries=[],u=i.oldDataGroupIds=[],h=i.oldData=[],f=0;f<s.length;f++){var c=s[f].getData();c.count()<Ek&&(l.push(s[f]),u.push(s[f].get("dataGroupId")),h.push(c))}})}te([WB]);te([p7]);te([z7,tY,hY,VY,QY,UZ,cq,$q,g$,T$,R$,MK,KK,sj,bj,Ej,Bj,Wj,eJ,sJ,mJ,tQ]);te(yQ);te(XQ);te(MU);te(itt);te(hz);te(ltt);te(mtt);te(iet);te(Met);te(Bv);te(Vet);te(Xet);te(ert);te(lrt);te(vrt);te(xrt);te(Lrt);te(qrt);te(dk);te(vk);te(vnt);te(yk);te(xk);te(ynt);te(Pnt);te(Tk);te(sit);te(CB);te([WB,Tk]);te(CB);function OP(e,t,r){typeof t=="object"&&(r=t,t=null);var n=this,i;if(!(e instanceof Function)){i=[];for(var a in e)e.hasOwnProperty(a)&&i.push(a)}var o=function(l){if(n.apply(this,arguments),e instanceof Function?FP(this,e.call(this,l)):lit(this,e,i),this.constructor===o)for(var u=o.__initializers__,h=0;h<u.length;h++)u[h].apply(this,arguments)};o.__super__=n,n.__initializers__?o.__initializers__=n.__initializers__.slice():o.__initializers__=[],t&&o.__initializers__.push(t);var s=function(){};return s.prototype=n.prototype,o.prototype=new s,o.prototype.constructor=o,FP(o.prototype,r),o.extend=n.extend,o.derive=n.extend,o}function FP(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])}function lit(e,t,r){for(var n=0;n<r.length;n++){var i=r[n];e[i]=t[i]}}const uit={extend:OP,derive:OP};function hit(e,t){this.action=e,this.context=t}var eA={trigger:function(e){if(this.hasOwnProperty("__handlers__")&&this.__handlers__.hasOwnProperty(e)){var t=this.__handlers__[e],r=t.length,n=-1,i=arguments;switch(i.length){case 1:for(;++n<r;)t[n].action.call(t[n].context);return;case 2:for(;++n<r;)t[n].action.call(t[n].context,i[1]);return;case 3:for(;++n<r;)t[n].action.call(t[n].context,i[1],i[2]);return;case 4:for(;++n<r;)t[n].action.call(t[n].context,i[1],i[2],i[3]);return;case 5:for(;++n<r;)t[n].action.call(t[n].context,i[1],i[2],i[3],i[4]);return;default:for(;++n<r;)t[n].action.apply(t[n].context,Array.prototype.slice.call(i,1));return}}},on:function(e,t,r){if(!(!e||!t)){var n=this.__handlers__||(this.__handlers__={});if(!n[e])n[e]=[];else if(this.has(e,t))return;var i=new hit(t,r||this);return n[e].push(i),this}},once:function(e,t,r){if(!e||!t)return;var n=this;function i(){n.off(e,i),t.apply(this,arguments)}return this.on(e,i,r)},before:function(e,t,r){if(!(!e||!t))return e="before"+e,this.on(e,t,r)},after:function(e,t,r){if(!(!e||!t))return e="after"+e,this.on(e,t,r)},success:function(e,t){return this.once("success",e,t)},error:function(e,t){return this.once("error",e,t)},off:function(e,t){var r=this.__handlers__||(this.__handlers__={});if(!t){r[e]=[];return}if(r[e]){for(var n=r[e],i=[],a=0;a<n.length;a++)t&&n[a].action!==t&&i.push(n[a]);r[e]=i}return this},has:function(e,t){var r=this.__handlers__;if(!r||!r[e])return!1;for(var n=r[e],i=0;i<n.length;i++)if(n[i].action===t)return!0}},fit=0,cit=Array.prototype,dit=cit.forEach,Lr={genGUID:function(){return++fit},relative2absolute:function(e,t){if(!t||e.match(/^\//))return e;for(var r=e.split("/"),n=t.split("/"),i=r[0];i==="."||i==="..";)i===".."&&n.pop(),r.shift(),i=r[0];return n.join("/")+"/"+r.join("/")},extend:function(e,t){if(t)for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);return e},defaults:function(e,t){if(t)for(var r in t)e[r]===void 0&&(e[r]=t[r]);return e},extendWithPropList:function(e,t,r){if(t)for(var n=0;n<r.length;n++){var i=r[n];e[i]=t[i]}return e},defaultsWithPropList:function(e,t,r){if(t)for(var n=0;n<r.length;n++){var i=r[n];e[i]==null&&(e[i]=t[i])}return e},each:function(e,t,r){if(e&&t)if(e.forEach&&e.forEach===dit)e.forEach(t,r);else if(e.length===+e.length)for(var n=0,i=e.length;n<i;n++)t.call(r,e[n],n,e);else for(var a in e)e.hasOwnProperty(a)&&t.call(r,e[a],a,e)},isObject:function(e){return e===Object(e)},isArray:function(e){return Array.isArray(e)},isArrayLike:function(e){return e?e.length===+e.length:!1},clone:function(e){if(Lr.isObject(e)){if(Lr.isArray(e))return e.slice();if(Lr.isArrayLike(e)){for(var t=new e.constructor(e.length),r=0;r<e.length;r++)t[r]=e[r];return t}else return Lr.extend({},e)}else return e}},gn=function(){this.__uid__=Lr.genGUID()};gn.__initializers__=[function(e){Lr.extend(this,e)}];Lr.extend(gn,uit);Lr.extend(gn.prototype,eA);var BP=["OES_texture_float","OES_texture_half_float","OES_texture_float_linear","OES_texture_half_float_linear","OES_standard_derivatives","OES_vertex_array_object","OES_element_index_uint","WEBGL_compressed_texture_s3tc","WEBGL_depth_texture","EXT_texture_filter_anisotropic","EXT_shader_texture_lod","WEBGL_draw_buffers","EXT_frag_depth","EXT_sRGB","ANGLE_instanced_arrays"],UP=["MAX_TEXTURE_SIZE","MAX_CUBE_MAP_TEXTURE_SIZE"];function vit(e){for(var t={},r={},n=0;n<BP.length;n++){var i=BP[n];o(i)}for(var n=0;n<UP.length;n++){var a=UP[n];r[a]=e.getParameter(e[a])}this.getExtension=function(s){return s in t||o(s),t[s]},this.getParameter=function(s){return r[s]};function o(s){if(e.getExtension){var l=e.getExtension(s);l||(l=e.getExtension("MOZ_"+s)),l||(l=e.getExtension("WEBKIT_"+s)),t[s]=l}}}const mt={DEPTH_BUFFER_BIT:256,STENCIL_BUFFER_BIT:1024,COLOR_BUFFER_BIT:16384,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,ZERO:0,ONE:1,SRC_COLOR:768,ONE_MINUS_SRC_COLOR:769,SRC_ALPHA:770,ONE_MINUS_SRC_ALPHA:771,DST_ALPHA:772,ONE_MINUS_DST_ALPHA:773,DST_COLOR:774,ONE_MINUS_DST_COLOR:775,SRC_ALPHA_SATURATE:776,FUNC_ADD:32774,BLEND_EQUATION:32777,BLEND_EQUATION_RGB:32777,BLEND_EQUATION_ALPHA:34877,FUNC_SUBTRACT:32778,FUNC_REVERSE_SUBTRACT:32779,BLEND_DST_RGB:32968,BLEND_SRC_RGB:32969,BLEND_DST_ALPHA:32970,BLEND_SRC_ALPHA:32971,CONSTANT_COLOR:32769,ONE_MINUS_CONSTANT_COLOR:32770,CONSTANT_ALPHA:32771,ONE_MINUS_CONSTANT_ALPHA:32772,BLEND_COLOR:32773,ARRAY_BUFFER:34962,ELEMENT_ARRAY_BUFFER:34963,ARRAY_BUFFER_BINDING:34964,ELEMENT_ARRAY_BUFFER_BINDING:34965,STREAM_DRAW:35040,STATIC_DRAW:35044,DYNAMIC_DRAW:35048,BUFFER_SIZE:34660,BUFFER_USAGE:34661,CURRENT_VERTEX_ATTRIB:34342,FRONT:1028,BACK:1029,FRONT_AND_BACK:1032,CULL_FACE:2884,BLEND:3042,DITHER:3024,STENCIL_TEST:2960,DEPTH_TEST:2929,SCISSOR_TEST:3089,POLYGON_OFFSET_FILL:32823,SAMPLE_ALPHA_TO_COVERAGE:32926,SAMPLE_COVERAGE:32928,NO_ERROR:0,INVALID_ENUM:1280,INVALID_VALUE:1281,INVALID_OPERATION:1282,OUT_OF_MEMORY:1285,CW:2304,CCW:2305,LINE_WIDTH:2849,ALIASED_POINT_SIZE_RANGE:33901,ALIASED_LINE_WIDTH_RANGE:33902,CULL_FACE_MODE:2885,FRONT_FACE:2886,DEPTH_RANGE:2928,DEPTH_WRITEMASK:2930,DEPTH_CLEAR_VALUE:2931,DEPTH_FUNC:2932,STENCIL_CLEAR_VALUE:2961,STENCIL_FUNC:2962,STENCIL_FAIL:2964,STENCIL_PASS_DEPTH_FAIL:2965,STENCIL_PASS_DEPTH_PASS:2966,STENCIL_REF:2967,STENCIL_VALUE_MASK:2963,STENCIL_WRITEMASK:2968,STENCIL_BACK_FUNC:34816,STENCIL_BACK_FAIL:34817,STENCIL_BACK_PASS_DEPTH_FAIL:34818,STENCIL_BACK_PASS_DEPTH_PASS:34819,STENCIL_BACK_REF:36003,STENCIL_BACK_VALUE_MASK:36004,STENCIL_BACK_WRITEMASK:36005,VIEWPORT:2978,SCISSOR_BOX:3088,COLOR_CLEAR_VALUE:3106,COLOR_WRITEMASK:3107,UNPACK_ALIGNMENT:3317,PACK_ALIGNMENT:3333,MAX_TEXTURE_SIZE:3379,MAX_VIEWPORT_DIMS:3386,SUBPIXEL_BITS:3408,RED_BITS:3410,GREEN_BITS:3411,BLUE_BITS:3412,ALPHA_BITS:3413,DEPTH_BITS:3414,STENCIL_BITS:3415,POLYGON_OFFSET_UNITS:10752,POLYGON_OFFSET_FACTOR:32824,TEXTURE_BINDING_2D:32873,SAMPLE_BUFFERS:32936,SAMPLES:32937,SAMPLE_COVERAGE_VALUE:32938,SAMPLE_COVERAGE_INVERT:32939,COMPRESSED_TEXTURE_FORMATS:34467,DONT_CARE:4352,FASTEST:4353,NICEST:4354,GENERATE_MIPMAP_HINT:33170,BYTE:5120,UNSIGNED_BYTE:5121,SHORT:5122,UNSIGNED_SHORT:5123,INT:5124,UNSIGNED_INT:5125,FLOAT:5126,DEPTH_COMPONENT:6402,ALPHA:6406,RGB:6407,RGBA:6408,LUMINANCE:6409,LUMINANCE_ALPHA:6410,UNSIGNED_SHORT_4_4_4_4:32819,UNSIGNED_SHORT_5_5_5_1:32820,UNSIGNED_SHORT_5_6_5:33635,FRAGMENT_SHADER:35632,VERTEX_SHADER:35633,MAX_VERTEX_ATTRIBS:34921,MAX_VERTEX_UNIFORM_VECTORS:36347,MAX_VARYING_VECTORS:36348,MAX_COMBINED_TEXTURE_IMAGE_UNITS:35661,MAX_VERTEX_TEXTURE_IMAGE_UNITS:35660,MAX_TEXTURE_IMAGE_UNITS:34930,MAX_FRAGMENT_UNIFORM_VECTORS:36349,SHADER_TYPE:35663,DELETE_STATUS:35712,LINK_STATUS:35714,VALIDATE_STATUS:35715,ATTACHED_SHADERS:35717,ACTIVE_UNIFORMS:35718,ACTIVE_ATTRIBUTES:35721,SHADING_LANGUAGE_VERSION:35724,CURRENT_PROGRAM:35725,NEVER:512,LESS:513,EQUAL:514,LEQUAL:515,GREATER:516,NOTEQUAL:517,GEQUAL:518,ALWAYS:519,KEEP:7680,REPLACE:7681,INCR:7682,DECR:7683,INVERT:5386,INCR_WRAP:34055,DECR_WRAP:34056,VENDOR:7936,RENDERER:7937,VERSION:7938,NEAREST:9728,LINEAR:9729,NEAREST_MIPMAP_NEAREST:9984,LINEAR_MIPMAP_NEAREST:9985,NEAREST_MIPMAP_LINEAR:9986,LINEAR_MIPMAP_LINEAR:9987,TEXTURE_MAG_FILTER:10240,TEXTURE_MIN_FILTER:10241,TEXTURE_WRAP_S:10242,TEXTURE_WRAP_T:10243,TEXTURE_2D:3553,TEXTURE:5890,TEXTURE_CUBE_MAP:34067,TEXTURE_BINDING_CUBE_MAP:34068,TEXTURE_CUBE_MAP_POSITIVE_X:34069,TEXTURE_CUBE_MAP_NEGATIVE_X:34070,TEXTURE_CUBE_MAP_POSITIVE_Y:34071,TEXTURE_CUBE_MAP_NEGATIVE_Y:34072,TEXTURE_CUBE_MAP_POSITIVE_Z:34073,TEXTURE_CUBE_MAP_NEGATIVE_Z:34074,MAX_CUBE_MAP_TEXTURE_SIZE:34076,TEXTURE0:33984,TEXTURE1:33985,TEXTURE2:33986,TEXTURE3:33987,TEXTURE4:33988,TEXTURE5:33989,TEXTURE6:33990,TEXTURE7:33991,TEXTURE8:33992,TEXTURE9:33993,TEXTURE10:33994,TEXTURE11:33995,TEXTURE12:33996,TEXTURE13:33997,TEXTURE14:33998,TEXTURE15:33999,TEXTURE16:34e3,TEXTURE17:34001,TEXTURE18:34002,TEXTURE19:34003,TEXTURE20:34004,TEXTURE21:34005,TEXTURE22:34006,TEXTURE23:34007,TEXTURE24:34008,TEXTURE25:34009,TEXTURE26:34010,TEXTURE27:34011,TEXTURE28:34012,TEXTURE29:34013,TEXTURE30:34014,TEXTURE31:34015,ACTIVE_TEXTURE:34016,REPEAT:10497,CLAMP_TO_EDGE:33071,MIRRORED_REPEAT:33648,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,INT_VEC2:35667,INT_VEC3:35668,INT_VEC4:35669,BOOL:35670,BOOL_VEC2:35671,BOOL_VEC3:35672,BOOL_VEC4:35673,FLOAT_MAT2:35674,FLOAT_MAT3:35675,FLOAT_MAT4:35676,SAMPLER_2D:35678,SAMPLER_CUBE:35680,VERTEX_ATTRIB_ARRAY_ENABLED:34338,VERTEX_ATTRIB_ARRAY_SIZE:34339,VERTEX_ATTRIB_ARRAY_STRIDE:34340,VERTEX_ATTRIB_ARRAY_TYPE:34341,VERTEX_ATTRIB_ARRAY_NORMALIZED:34922,VERTEX_ATTRIB_ARRAY_POINTER:34373,VERTEX_ATTRIB_ARRAY_BUFFER_BINDING:34975,COMPILE_STATUS:35713,LOW_FLOAT:36336,MEDIUM_FLOAT:36337,HIGH_FLOAT:36338,LOW_INT:36339,MEDIUM_INT:36340,HIGH_INT:36341,FRAMEBUFFER:36160,RENDERBUFFER:36161,RGBA4:32854,RGB5_A1:32855,RGB565:36194,DEPTH_COMPONENT16:33189,STENCIL_INDEX:6401,STENCIL_INDEX8:36168,DEPTH_STENCIL:34041,RENDERBUFFER_WIDTH:36162,RENDERBUFFER_HEIGHT:36163,RENDERBUFFER_INTERNAL_FORMAT:36164,RENDERBUFFER_RED_SIZE:36176,RENDERBUFFER_GREEN_SIZE:36177,RENDERBUFFER_BLUE_SIZE:36178,RENDERBUFFER_ALPHA_SIZE:36179,RENDERBUFFER_DEPTH_SIZE:36180,RENDERBUFFER_STENCIL_SIZE:36181,FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE:36048,FRAMEBUFFER_ATTACHMENT_OBJECT_NAME:36049,FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL:36050,FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE:36051,COLOR_ATTACHMENT0:36064,DEPTH_ATTACHMENT:36096,STENCIL_ATTACHMENT:36128,DEPTH_STENCIL_ATTACHMENT:33306,NONE:0,FRAMEBUFFER_COMPLETE:36053,FRAMEBUFFER_INCOMPLETE_ATTACHMENT:36054,FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:36055,FRAMEBUFFER_INCOMPLETE_DIMENSIONS:36057,FRAMEBUFFER_UNSUPPORTED:36061,FRAMEBUFFER_BINDING:36006,RENDERBUFFER_BINDING:36007,MAX_RENDERBUFFER_SIZE:34024,INVALID_FRAMEBUFFER_OPERATION:1286,UNPACK_FLIP_Y_WEBGL:37440,UNPACK_PREMULTIPLY_ALPHA_WEBGL:37441,CONTEXT_LOST_WEBGL:37442,UNPACK_COLORSPACE_CONVERSION_WEBGL:37443,BROWSER_DEFAULT_WEBGL:37444};function pit(e){var t=new XMLHttpRequest;t.open("get",e.url),t.responseType=e.responseType||"text",e.onprogress&&(t.onprogress=function(r){if(r.lengthComputable){var n=r.loaded/r.total;e.onprogress(n,r.loaded,r.total)}else e.onprogress(null)}),t.onload=function(r){t.status>=400?e.onerror&&e.onerror():e.onload&&e.onload(t.response)},e.onerror&&(t.onerror=e.onerror),t.send(null)}const git={get:pit};var Yx,Ze={};Ze.supportWebGL=function(){if(Yx==null)try{var e=document.createElement("canvas"),t=e.getContext("webgl")||e.getContext("experimental-webgl");if(!t)throw new Error}catch{Yx=!1}return Yx};Ze.Int8Array=typeof Int8Array>"u"?Array:Int8Array;Ze.Uint8Array=typeof Uint8Array>"u"?Array:Uint8Array;Ze.Uint16Array=typeof Uint16Array>"u"?Array:Uint16Array;Ze.Uint32Array=typeof Uint32Array>"u"?Array:Uint32Array;Ze.Int16Array=typeof Int16Array>"u"?Array:Int16Array;Ze.Float32Array=typeof Float32Array>"u"?Array:Float32Array;Ze.Float64Array=typeof Float64Array>"u"?Array:Float64Array;var nu={};typeof window<"u"?nu=window:typeof global<"u"&&(nu=global);Ze.requestAnimationFrame=nu.requestAnimationFrame||nu.msRequestAnimationFrame||nu.mozRequestAnimationFrame||nu.webkitRequestAnimationFrame||function(e){setTimeout(e,16)};Ze.createCanvas=function(){return document.createElement("canvas")};Ze.createImage=function(){return new nu.Image};Ze.request={get:git.get};Ze.addEventListener=function(e,t,r,n){e.addEventListener(t,r,n)};Ze.removeEventListener=function(e,t,r){e.removeEventListener(t,r)};var sn=function(){this.head=null,this.tail=null,this._length=0};sn.prototype.insert=function(e){var t=new sn.Entry(e);return this.insertEntry(t),t};sn.prototype.insertAt=function(e,t){if(!(e<0)){for(var r=this.head,n=0;r&&n!=e;)r=r.next,n++;if(r){var i=new sn.Entry(t),a=r.prev;a?(a.next=i,i.prev=a):this.head=i,i.next=r,r.prev=i}else this.insert(t)}};sn.prototype.insertBeforeEntry=function(e,t){var r=new sn.Entry(e),n=t.prev;n?(n.next=r,r.prev=n):this.head=r,r.next=t,t.prev=r,this._length++};sn.prototype.insertEntry=function(e){this.head?(this.tail.next=e,e.prev=this.tail,this.tail=e):this.head=this.tail=e,this._length++};sn.prototype.remove=function(e){var t=e.prev,r=e.next;t?t.next=r:this.head=r,r?r.prev=t:this.tail=t,e.next=e.prev=null,this._length--};sn.prototype.removeAt=function(e){if(!(e<0)){for(var t=this.head,r=0;t&&r!=e;)t=t.next,r++;if(t)return this.remove(t),t.value}};sn.prototype.getHead=function(){if(this.head)return this.head.value};sn.prototype.getTail=function(){if(this.tail)return this.tail.value};sn.prototype.getAt=function(e){if(!(e<0)){for(var t=this.head,r=0;t&&r!=e;)t=t.next,r++;return t.value}};sn.prototype.indexOf=function(e){for(var t=this.head,r=0;t;){if(t.value===e)return r;t=t.next,r++}};sn.prototype.length=function(){return this._length};sn.prototype.isEmpty=function(){return this._length===0};sn.prototype.forEach=function(e,t){for(var r=this.head,n=0,i=typeof t<"u";r;)i?e.call(t,r.value,n):e(r.value,n),r=r.next,n++};sn.prototype.clear=function(){this.tail=this.head=null,this._length=0};sn.Entry=function(e){this.value=e,this.next=null,this.prev=null};var Xu=function(e){this._list=new sn,this._map={},this._maxSize=e||10};Xu.prototype.setMaxSize=function(e){this._maxSize=e};Xu.prototype.put=function(e,t){if(!this._map.hasOwnProperty(e)){var r=this._list.length();if(r>=this._maxSize&&r>0){var n=this._list.head;this._list.remove(n),delete this._map[n.key]}var i=this._list.insert(t);i.key=e,this._map[e]=i}};Xu.prototype.get=function(e){var t=this._map[e];if(this._map.hasOwnProperty(e))return t!==this._list.tail&&(this._list.remove(t),this._list.insertEntry(t)),t.value};Xu.prototype.remove=function(e){var t=this._map[e];typeof t<"u"&&(delete this._map[e],this._list.remove(t))};Xu.prototype.clear=function(){this._list.clear(),this._map={}};var yr={},zP={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function pa(e){return e=Math.round(e),e<0?0:e>255?255:e}function mit(e){return e=Math.round(e),e<0?0:e>360?360:e}function sv(e){return e<0?0:e>1?1:e}function Zx(e){return e.length&&e.charAt(e.length-1)==="%"?pa(parseFloat(e)/100*255):pa(parseInt(e,10))}function yf(e){return e.length&&e.charAt(e.length-1)==="%"?sv(parseFloat(e)/100):sv(parseFloat(e))}function qx(e,t,r){return r<0?r+=1:r>1&&(r-=1),r*6<1?e+(t-e)*r*6:r*2<1?t:r*3<2?e+(t-e)*(2/3-r)*6:e}function Ms(e,t,r){return e+(t-e)*r}function aa(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e}function zT(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}var Dk=new Xu(20),jp=null;function gh(e,t){jp&&zT(jp,t),jp=Dk.put(e,jp||t.slice())}yr.parse=function(e,t){if(e){t=t||[];var r=Dk.get(e);if(r)return zT(t,r);e=e+"";var n=e.replace(/ /g,"").toLowerCase();if(n in zP)return zT(t,zP[n]),gh(e,t),t;if(n.charAt(0)==="#"){if(n.length===4){var i=parseInt(n.substr(1),16);if(!(i>=0&&i<=4095)){aa(t,0,0,0,1);return}return aa(t,(i&3840)>>4|(i&3840)>>8,i&240|(i&240)>>4,i&15|(i&15)<<4,1),gh(e,t),t}else if(n.length===7){var i=parseInt(n.substr(1),16);if(!(i>=0&&i<=16777215)){aa(t,0,0,0,1);return}return aa(t,(i&16711680)>>16,(i&65280)>>8,i&255,1),gh(e,t),t}return}var a=n.indexOf("("),o=n.indexOf(")");if(a!==-1&&o+1===n.length){var s=n.substr(0,a),l=n.substr(a+1,o-(a+1)).split(","),u=1;switch(s){case"rgba":if(l.length!==4){aa(t,0,0,0,1);return}u=yf(l.pop());case"rgb":if(l.length!==3){aa(t,0,0,0,1);return}return aa(t,Zx(l[0]),Zx(l[1]),Zx(l[2]),u),gh(e,t),t;case"hsla":if(l.length!==4){aa(t,0,0,0,1);return}return l[3]=yf(l[3]),kT(l,t),gh(e,t),t;case"hsl":if(l.length!==3){aa(t,0,0,0,1);return}return kT(l,t),gh(e,t),t;default:return}}aa(t,0,0,0,1)}};yr.parseToFloat=function(e,t){if(t=yr.parse(e,t),!!t)return t[0]/=255,t[1]/=255,t[2]/=255,t};function kT(e,t){var r=(parseFloat(e[0])%360+360)%360/360,n=yf(e[1]),i=yf(e[2]),a=i<=.5?i*(n+1):i+n-i*n,o=i*2-a;return t=t||[],aa(t,pa(qx(o,a,r+1/3)*255),pa(qx(o,a,r)*255),pa(qx(o,a,r-1/3)*255),1),e.length===4&&(t[3]=e[3]),t}function _it(e){if(e){var t=e[0]/255,r=e[1]/255,n=e[2]/255,i=Math.min(t,r,n),a=Math.max(t,r,n),o=a-i,s=(a+i)/2,l,u;if(o===0)l=0,u=0;else{s<.5?u=o/(a+i):u=o/(2-a-i);var h=((a-t)/6+o/2)/o,f=((a-r)/6+o/2)/o,c=((a-n)/6+o/2)/o;t===a?l=c-f:r===a?l=1/3+h-c:n===a&&(l=2/3+f-h),l<0&&(l+=1),l>1&&(l-=1)}var d=[l*360,u,s];return e[3]!=null&&d.push(e[3]),d}}yr.lift=function(e,t){var r=yr.parse(e);if(r){for(var n=0;n<3;n++)t<0?r[n]=r[n]*(1-t)|0:r[n]=(255-r[n])*t+r[n]|0;return yr.stringify(r,r.length===4?"rgba":"rgb")}};yr.toHex=function(e){var t=yr.parse(e);if(t)return((1<<24)+(t[0]<<16)+(t[1]<<8)+ +t[2]).toString(16).slice(1)};yr.fastLerp=function(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){r=r||[];var n=e*(t.length-1),i=Math.floor(n),a=Math.ceil(n),o=t[i],s=t[a],l=n-i;return r[0]=pa(Ms(o[0],s[0],l)),r[1]=pa(Ms(o[1],s[1],l)),r[2]=pa(Ms(o[2],s[2],l)),r[3]=sv(Ms(o[3],s[3],l)),r}};yr.fastMapToColor=yr.fastLerp;yr.lerp=function(e,t,r){if(!(!(t&&t.length)||!(e>=0&&e<=1))){var n=e*(t.length-1),i=Math.floor(n),a=Math.ceil(n),o=yr.parse(t[i]),s=yr.parse(t[a]),l=n-i,u=yr.stringify([pa(Ms(o[0],s[0],l)),pa(Ms(o[1],s[1],l)),pa(Ms(o[2],s[2],l)),sv(Ms(o[3],s[3],l))],"rgba");return r?{color:u,leftIndex:i,rightIndex:a,value:n}:u}};yr.mapToColor=yr.lerp;yr.modifyHSL=function(e,t,r,n){if(e=yr.parse(e),e)return e=_it(e),t!=null&&(e[0]=mit(t)),r!=null&&(e[1]=yf(r)),n!=null&&(e[2]=yf(n)),yr.stringify(kT(e),"rgba")};yr.modifyAlpha=function(e,t){if(e=yr.parse(e),e&&t!=null)return e[3]=sv(t),yr.stringify(e,"rgba")};yr.stringify=function(e,t){if(!(!e||!e.length)){var r=e[0]+","+e[1]+","+e[2];return(t==="rgba"||t==="hsva"||t==="hsla")&&(r+=","+e[3]),t+"("+r+")"}};var yit=yr.parseToFloat,$x={};function kP(e){var t=Object.keys(e);t.sort();for(var r=[],n=0;n<t.length;n++){var i=t[n],a=e[i];a===null?r.push(i):r.push(i+" "+a.toString())}return r.join(`
`)}function xit(e,t,r){r.sort();for(var n=[],i=0;i<r.length;i++){var a=r[i];n.push(a)}var o=kP(e)+`
`+kP(t)+`
`+n.join(`
`);if($x[o])return $x[o];var s=Lr.genGUID();return $x[o]=s,s}var Vi=gn.extend(function(){return{name:"",depthTest:!0,depthMask:!0,transparent:!1,blend:null,autoUpdateTextureStatus:!0,uniforms:{},vertexDefines:{},fragmentDefines:{},_textureStatus:{},_enabledUniforms:null}},function(){this.name||(this.name="MATERIAL_"+this.__uid__),this.shader&&this.attachShader(this.shader,!0)},{precision:"highp",setUniform:function(e,t){t===void 0&&console.warn('Uniform value "'+e+'" is undefined');var r=this.uniforms[e];r&&(typeof t=="string"&&(t=yit(t)||t),r.value=t,this.autoUpdateTextureStatus&&r.type==="t"&&(t?this.enableTexture(e):this.disableTexture(e)))},setUniforms:function(e){for(var t in e){var r=e[t];this.setUniform(t,r)}},isUniformEnabled:function(e){return this._enabledUniforms.indexOf(e)>=0},getEnabledUniforms:function(){return this._enabledUniforms},getTextureUniforms:function(){return this._textureUniforms},set:function(e,t){if(typeof e=="object")for(var r in e){var n=e[r];this.setUniform(r,n)}else this.setUniform(e,t)},get:function(e){var t=this.uniforms[e];if(t)return t.value},attachShader:function(e,t){var r=this.uniforms;this.uniforms=e.createUniforms(),this.shader=e;var n=this.uniforms;this._enabledUniforms=Object.keys(n),this._enabledUniforms.sort(),this._textureUniforms=this._enabledUniforms.filter(function(u){var h=this.uniforms[u].type;return h==="t"||h==="tv"},this);var i=this.vertexDefines,a=this.fragmentDefines;if(this.vertexDefines=Lr.clone(e.vertexDefines),this.fragmentDefines=Lr.clone(e.fragmentDefines),t){for(var o in r)n[o]&&(n[o].value=r[o].value);Lr.defaults(this.vertexDefines,i),Lr.defaults(this.fragmentDefines,a)}var s={};for(var l in e.textures)s[l]={shaderType:e.textures[l].shaderType,type:e.textures[l].type,enabled:t&&this._textureStatus[l]?this._textureStatus[l].enabled:!1};this._textureStatus=s,this._programKey=""},clone:function(){var e=new this.constructor({name:this.name,shader:this.shader});for(var t in this.uniforms)e.uniforms[t].value=this.uniforms[t].value;return e.depthTest=this.depthTest,e.depthMask=this.depthMask,e.transparent=this.transparent,e.blend=this.blend,e.vertexDefines=Lr.clone(this.vertexDefines),e.fragmentDefines=Lr.clone(this.fragmentDefines),e.enableTexture(this.getEnabledTextures()),e.precision=this.precision,e},define:function(e,t,r){var n=this.vertexDefines,i=this.fragmentDefines;e!=="vertex"&&e!=="fragment"&&e!=="both"&&arguments.length<3&&(r=t,t=e,e="both"),r=r??null,(e==="vertex"||e==="both")&&n[t]!==r&&(n[t]=r,this._programKey=""),(e==="fragment"||e==="both")&&i[t]!==r&&(i[t]=r,e!=="both"&&(this._programKey=""))},undefine:function(e,t){e!=="vertex"&&e!=="fragment"&&e!=="both"&&arguments.length<2&&(t=e,e="both"),(e==="vertex"||e==="both")&&this.isDefined("vertex",t)&&(delete this.vertexDefines[t],this._programKey=""),(e==="fragment"||e==="both")&&this.isDefined("fragment",t)&&(delete this.fragmentDefines[t],e!=="both"&&(this._programKey=""))},isDefined:function(e,t){switch(e){case"vertex":return this.vertexDefines[t]!==void 0;case"fragment":return this.fragmentDefines[t]!==void 0}},getDefine:function(e,t){switch(e){case"vertex":return this.vertexDefines[t];case"fragment":return this.fragmentDefines[t]}},enableTexture:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)this.enableTexture(e[t]);return}var r=this._textureStatus[e];if(r){var n=r.enabled;n||(r.enabled=!0,this._programKey="")}},enableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!0;this._programKey=""},disableTexture:function(e){if(Array.isArray(e)){for(var t=0;t<e.length;t++)this.disableTexture(e[t]);return}var r=this._textureStatus[e];if(r){var n=!r.enabled;n||(r.enabled=!1,this._programKey="")}},disableTexturesAll:function(){var e=this._textureStatus;for(var t in e)e[t].enabled=!1;this._programKey=""},isTextureEnabled:function(e){var t=this._textureStatus;return!!t[e]&&t[e].enabled},getEnabledTextures:function(){var e=[],t=this._textureStatus;for(var r in t)t[r].enabled&&e.push(r);return e},dirtyDefines:function(){this._programKey=""},getProgramKey:function(){return this._programKey||(this._programKey=xit(this.vertexDefines,this.fragmentDefines,this.getEnabledTextures())),this._programKey}}),nm=1e-6,mn=Array,qh=Math.random,bt={};bt.create=function(){var e=new mn(2);return e[0]=0,e[1]=0,e};bt.clone=function(e){var t=new mn(2);return t[0]=e[0],t[1]=e[1],t};bt.fromValues=function(e,t){var r=new mn(2);return r[0]=e,r[1]=t,r};bt.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e};bt.set=function(e,t,r){return e[0]=t,e[1]=r,e};bt.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e};bt.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e};bt.sub=bt.subtract;bt.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e};bt.mul=bt.multiply;bt.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e};bt.div=bt.divide;bt.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e};bt.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e};bt.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e};bt.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e};bt.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return Math.sqrt(r*r+n*n)};bt.dist=bt.distance;bt.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1];return r*r+n*n};bt.sqrDist=bt.squaredDistance;bt.length=function(e){var t=e[0],r=e[1];return Math.sqrt(t*t+r*r)};bt.len=bt.length;bt.squaredLength=function(e){var t=e[0],r=e[1];return t*t+r*r};bt.sqrLen=bt.squaredLength;bt.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e};bt.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e};bt.normalize=function(e,t){var r=t[0],n=t[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),e[0]=t[0]*i,e[1]=t[1]*i),e};bt.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]};bt.cross=function(e,t,r){var n=t[0]*r[1]-t[1]*r[0];return e[0]=e[1]=0,e[2]=n,e};bt.lerp=function(e,t,r,n){var i=t[0],a=t[1];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e};bt.random=function(e,t){t=t||1;var r=GLMAT_RANDOM()*2*Math.PI;return e[0]=Math.cos(r)*t,e[1]=Math.sin(r)*t,e};bt.transformMat2=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i,e[1]=r[1]*n+r[3]*i,e};bt.transformMat2d=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[2]*i+r[4],e[1]=r[1]*n+r[3]*i+r[5],e};bt.transformMat3=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[3]*i+r[6],e[1]=r[1]*n+r[4]*i+r[7],e};bt.transformMat4=function(e,t,r){var n=t[0],i=t[1];return e[0]=r[0]*n+r[4]*i+r[12],e[1]=r[1]*n+r[5]*i+r[13],e};bt.forEach=function(){var e=bt.create();return function(t,r,n,i,a,o){var s,l;for(r||(r=2),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],a(e,e,o),t[s]=e[0],t[s+1]=e[1];return t}}();var ce=function(e,t){e=e||0,t=t||0,this.array=bt.fromValues(e,t),this._dirty=!0};ce.prototype={constructor:ce,add:function(e){return bt.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t){return this.array[0]=e,this.array[1]=t,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this._dirty=!0,this},clone:function(){return new ce(this.x,this.y)},copy:function(e){return bt.copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return bt.cross(e.array,this.array,t.array),e._dirty=!0,this},dist:function(e){return bt.dist(this.array,e.array)},distance:function(e){return bt.distance(this.array,e.array)},div:function(e){return bt.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return bt.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return bt.dot(this.array,e.array)},len:function(){return bt.len(this.array)},length:function(){return bt.length(this.array)},lerp:function(e,t,r){return bt.lerp(this.array,e.array,t.array,r),this._dirty=!0,this},min:function(e){return bt.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return bt.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return bt.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return bt.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return bt.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return bt.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return bt.random(this.array,e),this._dirty=!0,this},scale:function(e){return bt.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return bt.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return bt.sqrDist(this.array,e.array)},squaredDistance:function(e){return bt.squaredDistance(this.array,e.array)},sqrLen:function(){return bt.sqrLen(this.array)},squaredLength:function(){return bt.squaredLength(this.array)},sub:function(e){return bt.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return bt.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat2:function(e){return bt.transformMat2(this.array,this.array,e.array),this._dirty=!0,this},transformMat2d:function(e){return bt.transformMat2d(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return bt.transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return bt.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};if(Object.defineProperty){var GP=ce.prototype;Object.defineProperty(GP,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Object.defineProperty(GP,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}})}ce.add=function(e,t,r){return bt.add(e.array,t.array,r.array),e._dirty=!0,e};ce.set=function(e,t,r){return bt.set(e.array,t,r),e._dirty=!0,e};ce.copy=function(e,t){return bt.copy(e.array,t.array),e._dirty=!0,e};ce.cross=function(e,t,r){return bt.cross(e.array,t.array,r.array),e._dirty=!0,e};ce.dist=function(e,t){return bt.distance(e.array,t.array)};ce.distance=ce.dist;ce.div=function(e,t,r){return bt.divide(e.array,t.array,r.array),e._dirty=!0,e};ce.divide=ce.div;ce.dot=function(e,t){return bt.dot(e.array,t.array)};ce.len=function(e){return bt.length(e.array)};ce.lerp=function(e,t,r,n){return bt.lerp(e.array,t.array,r.array,n),e._dirty=!0,e};ce.min=function(e,t,r){return bt.min(e.array,t.array,r.array),e._dirty=!0,e};ce.max=function(e,t,r){return bt.max(e.array,t.array,r.array),e._dirty=!0,e};ce.mul=function(e,t,r){return bt.multiply(e.array,t.array,r.array),e._dirty=!0,e};ce.multiply=ce.mul;ce.negate=function(e,t){return bt.negate(e.array,t.array),e._dirty=!0,e};ce.normalize=function(e,t){return bt.normalize(e.array,t.array),e._dirty=!0,e};ce.random=function(e,t){return bt.random(e.array,t),e._dirty=!0,e};ce.scale=function(e,t,r){return bt.scale(e.array,t.array,r),e._dirty=!0,e};ce.scaleAndAdd=function(e,t,r,n){return bt.scaleAndAdd(e.array,t.array,r.array,n),e._dirty=!0,e};ce.sqrDist=function(e,t){return bt.sqrDist(e.array,t.array)};ce.squaredDistance=ce.sqrDist;ce.sqrLen=function(e){return bt.sqrLen(e.array)};ce.squaredLength=ce.sqrLen;ce.sub=function(e,t,r){return bt.subtract(e.array,t.array,r.array),e._dirty=!0,e};ce.subtract=ce.sub;ce.transformMat2=function(e,t,r){return bt.transformMat2(e.array,t.array,r.array),e._dirty=!0,e};ce.transformMat2d=function(e,t,r){return bt.transformMat2d(e.array,t.array,r.array),e._dirty=!0,e};ce.transformMat3=function(e,t,r){return bt.transformMat3(e.array,t.array,r.array),e._dirty=!0,e};ce.transformMat4=function(e,t,r){return bt.transformMat4(e.array,t.array,r.array),e._dirty=!0,e};var VP=1,HP=2,Kx=3,WP={};function Sit(e){for(var t=e.split(`
`),r=0,n=t.length;r<n;r++)t[r]=r+1+": "+t[r];return t.join(`
`)}function XP(e,t,r){if(!e.getShaderParameter(t,e.COMPILE_STATUS))return[e.getShaderInfoLog(t),Sit(r)].join(`
`)}var YP=new Ze.Float32Array(16),Tit=gn.extend({uniformSemantics:{},attributes:{}},function(){this._locations={},this._textureSlot=0,this._program=null},{bind:function(e){this._textureSlot=0,e.gl.useProgram(this._program)},hasUniform:function(e){var t=this._locations[e];return t!=null},useTextureSlot:function(e,t,r){t&&(e.gl.activeTexture(e.gl.TEXTURE0+r),t.isRenderable()?t.bind(e):t.unbind(e))},currentTextureSlot:function(){return this._textureSlot},resetTextureSlot:function(e){this._textureSlot=e||0},takeCurrentTextureSlot:function(e,t){var r=this._textureSlot;return this.useTextureSlot(e,t,r),this._textureSlot++,r},setUniform:function(e,t,r,n){var i=this._locations,a=i[r];if(a==null)return!1;switch(t){case"m4":if(!(n instanceof Float32Array)){for(var o=0;o<n.length;o++)YP[o]=n[o];n=YP}e.uniformMatrix4fv(a,!1,n);break;case"2i":e.uniform2i(a,n[0],n[1]);break;case"2f":e.uniform2f(a,n[0],n[1]);break;case"3i":e.uniform3i(a,n[0],n[1],n[2]);break;case"3f":e.uniform3f(a,n[0],n[1],n[2]);break;case"4i":e.uniform4i(a,n[0],n[1],n[2],n[3]);break;case"4f":e.uniform4f(a,n[0],n[1],n[2],n[3]);break;case"1i":e.uniform1i(a,n);break;case"1f":e.uniform1f(a,n);break;case"1fv":e.uniform1fv(a,n);break;case"1iv":e.uniform1iv(a,n);break;case"2iv":e.uniform2iv(a,n);break;case"2fv":e.uniform2fv(a,n);break;case"3iv":e.uniform3iv(a,n);break;case"3fv":e.uniform3fv(a,n);break;case"4iv":e.uniform4iv(a,n);break;case"4fv":e.uniform4fv(a,n);break;case"m2":case"m2v":e.uniformMatrix2fv(a,!1,n);break;case"m3":case"m3v":e.uniformMatrix3fv(a,!1,n);break;case"m4v":if(Array.isArray(n)&&Array.isArray(n[0])){for(var s=new Ze.Float32Array(n.length*16),l=0,o=0;o<n.length;o++)for(var u=n[o],h=0;h<16;h++)s[l++]=u[h];e.uniformMatrix4fv(a,!1,s)}else e.uniformMatrix4fv(a,!1,n);break}return!0},setUniformOfSemantic:function(e,t,r){var n=this.uniformSemantics[t];return n?this.setUniform(e,n.type,n.symbol,r):!1},enableAttributes:function(e,t,r){var n=e.gl,i=this._program,a=this._locations,o;r?o=r.__enabledAttributeList:o=WP[e.__uid__],o||(r?o=r.__enabledAttributeList=[]:o=WP[e.__uid__]=[]);for(var s=[],l=0;l<t.length;l++){var u=t[l];if(!this.attributes[u]){s[l]=-1;continue}var h=a[u];if(h==null){if(h=n.getAttribLocation(i,u),h===-1){s[l]=-1;continue}a[u]=h}s[l]=h,o[h]?o[h]=HP:o[h]=VP}for(var l=0;l<o.length;l++)switch(o[l]){case VP:n.enableVertexAttribArray(l),o[l]=Kx;break;case HP:o[l]=Kx;break;case Kx:n.disableVertexAttribArray(l),o[l]=0;break}return s},getAttribLocation:function(e,t){var r=this._locations,n=r[t];return n==null&&(n=e.getAttribLocation(this._program,t),r[t]=n),n},buildProgram:function(e,t,r,n){var i=e.createShader(e.VERTEX_SHADER),a=e.createProgram();e.shaderSource(i,r),e.compileShader(i);var o=e.createShader(e.FRAGMENT_SHADER);e.shaderSource(o,n),e.compileShader(o);var s=XP(e,i,r);if(s||(s=XP(e,o,n),s))return s;if(e.attachShader(a,i),e.attachShader(a,o),t.attributeSemantics.POSITION)e.bindAttribLocation(a,0,t.attributeSemantics.POSITION.symbol);else{var l=Object.keys(this.attributes);e.bindAttribLocation(a,0,l[0])}if(e.linkProgram(a),e.deleteShader(i),e.deleteShader(o),this._program=a,this.vertexCode=r,this.fragmentCode=n,!e.getProgramParameter(a,e.LINK_STATUS))return`Could not link program
`+e.getProgramInfoLog(a);for(var u=0;u<t.uniforms.length;u++){var h=t.uniforms[u];this._locations[h]=e.getUniformLocation(a,h)}}}),bit=/for\s*?\(int\s*?_idx_\s*\=\s*([\w-]+)\;\s*_idx_\s*<\s*([\w-]+);\s*_idx_\s*\+\+\s*\)\s*\{\{([\s\S]+?)(?=\}\})\}\}/g;function ZP(e,t,r){function n(o,s,l,u){var h="";isNaN(s)&&(s in t?s=t[s]:s=i[s]),isNaN(l)&&(l in t?l=t[l]:l=i[l]);for(var f=parseInt(s);f<parseInt(l);f++)h+="{"+u.replace(/float\s*\(\s*_idx_\s*\)/g,f.toFixed(1)).replace(/_idx_/g,f)+"}";return h}var i={};for(var a in r)i[a+"_COUNT"]=r[a];return e.replace(bit,n)}function jx(e,t,r){var n=[];if(t)for(var i in t){var a=t[i];a>0&&n.push("#define "+i.toUpperCase()+"_COUNT "+a)}if(r)for(var o=0;o<r.length;o++){var s=r[o];n.push("#define "+s.toUpperCase()+"_ENABLED")}for(var s in e){var l=e[s];l===null?n.push("#define "+s):n.push("#define "+s+" "+l.toString())}return n.join(`
`)}function wit(e){for(var t=[],r=0;r<e.length;r++)t.push("#extension GL_"+e[r]+" : enable");return t.join(`
`)}function Mit(e){return["precision",e,"float"].join(" ")+`;
`+["precision",e,"int"].join(" ")+`;
`+["precision",e,"sampler2D"].join(" ")+`;
`}function Lk(e){this._renderer=e,this._cache={}}Lk.prototype.getProgram=function(e,t,r){var n=this._cache,i=e.isSkinnedMesh&&e.isSkinnedMesh(),a=e.isInstancedMesh&&e.isInstancedMesh(),o="s"+t.shader.shaderID+"m"+t.getProgramKey();r&&(o+="se"+r.getProgramKey(e.lightGroup)),i&&(o+=",sk"+e.joints.length),a&&(o+=",is");var x=n[o];if(x)return x;var s=r?r.getLightsNumbers(e.lightGroup):{},l=this._renderer,u=l.gl,h=t.getEnabledTextures(),f="";if(i){var c={SKINNING:null,JOINT_COUNT:e.joints.length};e.joints.length>l.getMaxJointNumber()&&(c.USE_SKIN_MATRICES_TEXTURE=null),f+=`
`+jx(c)+`
`}a&&(f+=`
#define INSTANCING
`);var d=f+jx(t.vertexDefines,s,h),v=f+jx(t.fragmentDefines,s,h),p=d+`
`+t.shader.vertex,g=["OES_standard_derivatives","EXT_shader_texture_lod"].filter(function(S){return l.getGLExtension(S)!=null});g.indexOf("EXT_shader_texture_lod")>=0&&(v+=`
#define SUPPORT_TEXTURE_LOD`),g.indexOf("OES_standard_derivatives")>=0&&(v+=`
#define SUPPORT_STANDARD_DERIVATIVES`);var m=wit(g)+`
`+Mit(t.precision)+`
`+v+`
`+t.shader.fragment,_=ZP(p,t.vertexDefines,s),y=ZP(m,t.fragmentDefines,s),x=new Tit;x.uniformSemantics=t.shader.uniformSemantics,x.attributes=t.shader.attributes;var T=x.buildProgram(u,t.shader,_,y);return x.__error=T,n[o]=x,x};var qP=/uniform\s+(bool|float|int|vec2|vec3|vec4|ivec2|ivec3|ivec4|mat2|mat3|mat4|sampler2D|samplerCube)\s+([\s\S]*?);/g,Ait=/attribute\s+(float|int|vec2|vec3|vec4)\s+([\s\S]*?);/g,$P=/#define\s+(\w+)?(\s+[\d-.]+)?\s*;?\s*\n/g,Eit={bool:"1i",int:"1i",sampler2D:"t",samplerCube:"t",float:"1f",vec2:"2f",vec3:"3f",vec4:"4f",ivec2:"2i",ivec3:"3i",ivec4:"4i",mat2:"m2",mat3:"m3",mat4:"m4"};function ao(e){for(var t=[],r=0;r<e;r++)t[r]=0;return t}var KP={bool:function(){return!0},int:function(){return 0},float:function(){return 0},sampler2D:function(){return null},samplerCube:function(){return null},vec2:function(){return ao(2)},vec3:function(){return ao(3)},vec4:function(){return ao(4)},ivec2:function(){return ao(2)},ivec3:function(){return ao(3)},ivec4:function(){return ao(4)},mat2:function(){return ao(4)},mat3:function(){return ao(9)},mat4:function(){return ao(16)},array:function(){return[]}},GT=["POSITION","NORMAL","BINORMAL","TANGENT","TEXCOORD","TEXCOORD_0","TEXCOORD_1","COLOR","JOINT","WEIGHT"],Rk=["SKIN_MATRIX","VIEWPORT_SIZE","VIEWPORT","DEVICEPIXELRATIO","WINDOW_SIZE","NEAR","FAR","TIME"],Pk=["WORLD","VIEW","PROJECTION","WORLDVIEW","VIEWPROJECTION","WORLDVIEWPROJECTION","WORLDINVERSE","VIEWINVERSE","PROJECTIONINVERSE","WORLDVIEWINVERSE","VIEWPROJECTIONINVERSE","WORLDVIEWPROJECTIONINVERSE","WORLDTRANSPOSE","VIEWTRANSPOSE","PROJECTIONTRANSPOSE","WORLDVIEWTRANSPOSE","VIEWPROJECTIONTRANSPOSE","WORLDVIEWPROJECTIONTRANSPOSE","WORLDINVERSETRANSPOSE","VIEWINVERSETRANSPOSE","PROJECTIONINVERSETRANSPOSE","WORLDVIEWINVERSETRANSPOSE","VIEWPROJECTIONINVERSETRANSPOSE","WORLDVIEWPROJECTIONINVERSETRANSPOSE"],Cit={vec4:4,vec3:3,vec2:2,float:1},Jx={},Ik={};function Dit(e,t){var r="vertex:"+e+"fragment:"+t;if(Jx[r])return Jx[r];var n=Lr.genGUID();return Jx[r]=n,Ik[n]={vertex:e,fragment:t},n}function jP(e){return e.replace(/[ \t]*\/\/.*\n/g,"").replace(/[ \t]*\/\*[\s\S]*?\*\//g,"")}function mh(){console.error("Wrong uniform/attributes syntax")}function JP(e,t){for(var r=/[,=\(\):]/,n=t.replace(/:\s*\[\s*(.*)\s*\]/g,"="+e+"($1)").replace(/\s+/g,"").split(/(?=[,=\(\):])/g),i=[],a=0;a<n.length;a++)n[a].match(r)?i.push(n[a].charAt(0),n[a].slice(1)):i.push(n[a]);n=i;var o=0,s=1,l=2,u=3,h=4,f=5,c=o,d={},v=null,p;g(n[0]);function g(y){y||mh();var x=y.match(/\[(.*?)\]/);p=y.replace(/\[(.*?)\]/,""),d[p]={},x&&(d[p].isArray=!0,d[p].arraySize=x[1])}for(var a=1;a<n.length;a++){var m=n[a];if(m){if(m==="="){if(c!==o&&c!==u){mh();break}c=s;continue}else if(m===":"){c=h;continue}else if(m===","){if(c===l){if(!(v instanceof Array)){mh();break}v.push(+n[++a])}else c=f;continue}else if(m===")"){d[p].value=new Ze.Float32Array(v),v=null,c=f;continue}else if(m==="("){if(c!==l){mh();break}if(!(v instanceof Array)){mh();break}v.push(+n[++a]);continue}else if(m.indexOf("vec")>=0){if(c!==s&&c!==h){mh();break}c=l,v=[];continue}else if(c===s){e==="bool"?d[p].value=m==="true":d[p].value=parseFloat(m),v=null;continue}else if(c===h){var _=m;GT.indexOf(_)>=0||Rk.indexOf(_)>=0||Pk.indexOf(_)>=0?d[p].semantic=_:_==="ignore"||_==="unconfigurable"?d[p].ignore=!0:e==="bool"?d[p].value=_==="true":d[p].value=parseFloat(_);continue}g(m),c=o}}return d}function Et(e,t){typeof e=="object"&&(t=e.fragment,e=e.vertex),e=jP(e),t=jP(t),this._shaderID=Dit(e,t),this._vertexCode=Et.parseImport(e),this._fragmentCode=Et.parseImport(t),this.attributeSemantics={},this.matrixSemantics={},this.uniformSemantics={},this.matrixSemanticKeys=[],this.uniformTemplates={},this.attributes={},this.textures={},this.vertexDefines={},this.fragmentDefines={},this._parseAttributes(),this._parseUniforms(),this._parseDefines()}Et.prototype={constructor:Et,createUniforms:function(){var e={};for(var t in this.uniformTemplates){var r=this.uniformTemplates[t];e[t]={type:r.type,value:r.value()}}return e},_parseImport:function(){this._vertexCode=Et.parseImport(this.vertex),this._fragmentCode=Et.parseImport(this.fragment)},_addSemanticUniform:function(e,t,r){if(GT.indexOf(r)>=0)this.attributeSemantics[r]={symbol:e,type:t};else if(Pk.indexOf(r)>=0){var n=!1,i=r;r.match(/TRANSPOSE$/)&&(n=!0,i=r.slice(0,-9)),this.matrixSemantics[r]={symbol:e,type:t,isTranspose:n,semanticNoTranspose:i}}else Rk.indexOf(r)>=0&&(this.uniformSemantics[r]={symbol:e,type:t})},_addMaterialUniform:function(e,t,r,n,i,a){a[e]={type:r,value:i?KP.array:n||KP[t],semantic:null}},_parseUniforms:function(){var e={},t=this,r="vertex";this._uniformList=[],this._vertexCode=this._vertexCode.replace(qP,i),r="fragment",this._fragmentCode=this._fragmentCode.replace(qP,i),t.matrixSemanticKeys=Object.keys(this.matrixSemantics);function n(a){return a!=null?function(){return a}:null}function i(a,o,s){var l=JP(o,s),u=[];for(var h in l){var f=l[h],c=f.semantic,d=h,v=Eit[o],p=n(l[h].value);l[h].isArray&&(d+="["+l[h].arraySize+"]",v+="v"),u.push(d),t._uniformList.push(h),f.ignore||((o==="sampler2D"||o==="samplerCube")&&(t.textures[h]={shaderType:r,type:o}),c?t._addSemanticUniform(h,v,c):t._addMaterialUniform(h,o,v,p,l[h].isArray,e))}return u.length>0?"uniform "+o+" "+u.join(",")+`;
`:""}this.uniformTemplates=e},_parseAttributes:function(){var e={},t=this;this._vertexCode=this._vertexCode.replace(Ait,r);function r(n,i,a){var o=JP(i,a),s=Cit[i]||1,l=[];for(var u in o){var h=o[u].semantic;if(e[u]={type:"float",size:s,semantic:h||null},h){if(GT.indexOf(h)<0)throw new Error('Unkown semantic "'+h+'"');t.attributeSemantics[h]={symbol:u,type:i}}l.push(u)}return"attribute "+i+" "+l.join(",")+`;
`}this.attributes=e},_parseDefines:function(){var e=this,t="vertex";this._vertexCode=this._vertexCode.replace($P,r),t="fragment",this._fragmentCode=this._fragmentCode.replace($P,r);function r(n,i,a){var o=t==="vertex"?e.vertexDefines:e.fragmentDefines;return o[i]||(a==="false"?o[i]=!1:a==="true"?o[i]=!0:o[i]=a?isNaN(parseFloat(a))?a.trim():parseFloat(a):null),""}},clone:function(){var e=Ik[this._shaderID],t=new Et(e.vertex,e.fragment);return t}};Object.defineProperty&&(Object.defineProperty(Et.prototype,"shaderID",{get:function(){return this._shaderID}}),Object.defineProperty(Et.prototype,"vertex",{get:function(){return this._vertexCode}}),Object.defineProperty(Et.prototype,"fragment",{get:function(){return this._fragmentCode}}),Object.defineProperty(Et.prototype,"uniforms",{get:function(){return this._uniformList}}));var Lit=/(@import)\s*([0-9a-zA-Z_\-\.]*)/g;Et.parseImport=function(e){return e=e.replace(Lit,function(i,r,n){var i=Et.source(n);return i?Et.parseImport(i):(console.error('Shader chunk "'+n+'" not existed in library'),"")}),e};var Rit=/(@export)\s*([0-9a-zA-Z_\-\.]*)\s*\n([\s\S]*?)@end/g;Et.import=function(e){e.replace(Rit,function(t,r,n,a){var a=a.replace(/(^[\s\t\xa0\u3000]+)|([\u3000\xa0\s\t]+\x24)/g,"");if(a){for(var o=n.split("."),s=Et.codes,l=0,u;l<o.length-1;)u=o[l++],s[u]||(s[u]={}),s=s[u];u=o[l],s[u]=a}return a})};Et.codes={};Et.source=function(e){for(var t=e.split("."),r=Et.codes,n=0;r&&n<t.length;){var i=t[n++];r=r[i]}return typeof r!="string"?(console.error('Shader "'+e+'" not existed in library'),""):r};const Nk=`@export clay.prez.vertex
uniform mat4 WVP : WORLDVIEWPROJECTION;
attribute vec3 pos : POSITION;
attribute vec2 uv : TEXCOORD_0;
uniform vec2 uvRepeat : [1.0, 1.0];
uniform vec2 uvOffset : [0.0, 0.0];
@import clay.chunk.skinning_header
@import clay.chunk.instancing_header
varying vec2 v_Texcoord;
void main()
{
 vec4 P = vec4(pos, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 gl_Position = WVP * P;
 v_Texcoord = uv * uvRepeat + uvOffset;
}
@end
@export clay.prez.fragment
uniform sampler2D alphaMap;
uniform float alphaCutoff: 0.0;
varying vec2 v_Texcoord;
void main()
{
 if (alphaCutoff > 0.0) {
 if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {
 discard;
 }
 }
 gl_FragColor = vec4(0.0,0.0,0.0,1.0);
}
@end`;var xt={};xt.create=function(){var e=new mn(16);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};xt.clone=function(e){var t=new mn(16);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t};xt.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e};xt.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};xt.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[3],a=t[6],o=t[7],s=t[11];e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=r,e[6]=t[9],e[7]=t[13],e[8]=n,e[9]=a,e[11]=t[14],e[12]=i,e[13]=o,e[14]=s}else e[0]=t[0],e[1]=t[4],e[2]=t[8],e[3]=t[12],e[4]=t[1],e[5]=t[5],e[6]=t[9],e[7]=t[13],e[8]=t[2],e[9]=t[6],e[10]=t[10],e[11]=t[14],e[12]=t[3],e[13]=t[7],e[14]=t[11],e[15]=t[15];return e};xt.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],h=t[8],f=t[9],c=t[10],d=t[11],v=t[12],p=t[13],g=t[14],m=t[15],_=r*s-n*o,y=r*l-i*o,x=r*u-a*o,T=n*l-i*s,S=n*u-a*s,M=i*u-a*l,w=h*p-f*v,b=h*g-c*v,A=h*m-d*v,E=f*g-c*p,C=f*m-d*p,D=c*m-d*g,L=_*D-y*C+x*E+T*A-S*b+M*w;return L?(L=1/L,e[0]=(s*D-l*C+u*E)*L,e[1]=(i*C-n*D-a*E)*L,e[2]=(p*M-g*S+m*T)*L,e[3]=(c*S-f*M-d*T)*L,e[4]=(l*A-o*D-u*b)*L,e[5]=(r*D-i*A+a*b)*L,e[6]=(g*x-v*M-m*y)*L,e[7]=(h*M-c*x+d*y)*L,e[8]=(o*C-s*A+u*w)*L,e[9]=(n*A-r*C-a*w)*L,e[10]=(v*S-p*x+m*_)*L,e[11]=(f*x-h*S-d*_)*L,e[12]=(s*b-o*E-l*w)*L,e[13]=(r*E-n*b+i*w)*L,e[14]=(p*y-v*T-g*_)*L,e[15]=(h*T-f*y+c*_)*L,e):null};xt.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],h=t[8],f=t[9],c=t[10],d=t[11],v=t[12],p=t[13],g=t[14],m=t[15];return e[0]=s*(c*m-d*g)-f*(l*m-u*g)+p*(l*d-u*c),e[1]=-(n*(c*m-d*g)-f*(i*m-a*g)+p*(i*d-a*c)),e[2]=n*(l*m-u*g)-s*(i*m-a*g)+p*(i*u-a*l),e[3]=-(n*(l*d-u*c)-s*(i*d-a*c)+f*(i*u-a*l)),e[4]=-(o*(c*m-d*g)-h*(l*m-u*g)+v*(l*d-u*c)),e[5]=r*(c*m-d*g)-h*(i*m-a*g)+v*(i*d-a*c),e[6]=-(r*(l*m-u*g)-o*(i*m-a*g)+v*(i*u-a*l)),e[7]=r*(l*d-u*c)-o*(i*d-a*c)+h*(i*u-a*l),e[8]=o*(f*m-d*p)-h*(s*m-u*p)+v*(s*d-u*f),e[9]=-(r*(f*m-d*p)-h*(n*m-a*p)+v*(n*d-a*f)),e[10]=r*(s*m-u*p)-o*(n*m-a*p)+v*(n*u-a*s),e[11]=-(r*(s*d-u*f)-o*(n*d-a*f)+h*(n*u-a*s)),e[12]=-(o*(f*g-c*p)-h*(s*g-l*p)+v*(s*c-l*f)),e[13]=r*(f*g-c*p)-h*(n*g-i*p)+v*(n*c-i*f),e[14]=-(r*(s*g-l*p)-o*(n*g-i*p)+v*(n*l-i*s)),e[15]=r*(s*c-l*f)-o*(n*c-i*f)+h*(n*l-i*s),e};xt.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],h=e[9],f=e[10],c=e[11],d=e[12],v=e[13],p=e[14],g=e[15],m=t*o-r*a,_=t*s-n*a,y=t*l-i*a,x=r*s-n*o,T=r*l-i*o,S=n*l-i*s,M=u*v-h*d,w=u*p-f*d,b=u*g-c*d,A=h*p-f*v,E=h*g-c*v,C=f*g-c*p;return m*C-_*E+y*A+x*b-T*w+S*M};xt.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],h=t[7],f=t[8],c=t[9],d=t[10],v=t[11],p=t[12],g=t[13],m=t[14],_=t[15],y=r[0],x=r[1],T=r[2],S=r[3];return e[0]=y*n+x*s+T*f+S*p,e[1]=y*i+x*l+T*c+S*g,e[2]=y*a+x*u+T*d+S*m,e[3]=y*o+x*h+T*v+S*_,y=r[4],x=r[5],T=r[6],S=r[7],e[4]=y*n+x*s+T*f+S*p,e[5]=y*i+x*l+T*c+S*g,e[6]=y*a+x*u+T*d+S*m,e[7]=y*o+x*h+T*v+S*_,y=r[8],x=r[9],T=r[10],S=r[11],e[8]=y*n+x*s+T*f+S*p,e[9]=y*i+x*l+T*c+S*g,e[10]=y*a+x*u+T*d+S*m,e[11]=y*o+x*h+T*v+S*_,y=r[12],x=r[13],T=r[14],S=r[15],e[12]=y*n+x*s+T*f+S*p,e[13]=y*i+x*l+T*c+S*g,e[14]=y*a+x*u+T*d+S*m,e[15]=y*o+x*h+T*v+S*_,e};xt.multiplyAffine=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[4],s=t[5],l=t[6],u=t[8],h=t[9],f=t[10],c=t[12],d=t[13],v=t[14],p=r[0],g=r[1],m=r[2];return e[0]=p*n+g*o+m*u,e[1]=p*i+g*s+m*h,e[2]=p*a+g*l+m*f,p=r[4],g=r[5],m=r[6],e[4]=p*n+g*o+m*u,e[5]=p*i+g*s+m*h,e[6]=p*a+g*l+m*f,p=r[8],g=r[9],m=r[10],e[8]=p*n+g*o+m*u,e[9]=p*i+g*s+m*h,e[10]=p*a+g*l+m*f,p=r[12],g=r[13],m=r[14],e[12]=p*n+g*o+m*u+c,e[13]=p*i+g*s+m*h+d,e[14]=p*a+g*l+m*f+v,e};xt.mul=xt.multiply;xt.mulAffine=xt.multiplyAffine;xt.translate=function(e,t,r){var n=r[0],i=r[1],a=r[2],o,s,l,u,h,f,c,d,v,p,g,m;return t===e?(e[12]=t[0]*n+t[4]*i+t[8]*a+t[12],e[13]=t[1]*n+t[5]*i+t[9]*a+t[13],e[14]=t[2]*n+t[6]*i+t[10]*a+t[14],e[15]=t[3]*n+t[7]*i+t[11]*a+t[15]):(o=t[0],s=t[1],l=t[2],u=t[3],h=t[4],f=t[5],c=t[6],d=t[7],v=t[8],p=t[9],g=t[10],m=t[11],e[0]=o,e[1]=s,e[2]=l,e[3]=u,e[4]=h,e[5]=f,e[6]=c,e[7]=d,e[8]=v,e[9]=p,e[10]=g,e[11]=m,e[12]=o*n+h*i+v*a+t[12],e[13]=s*n+f*i+p*a+t[13],e[14]=l*n+c*i+g*a+t[14],e[15]=u*n+d*i+m*a+t[15]),e};xt.scale=function(e,t,r){var n=r[0],i=r[1],a=r[2];return e[0]=t[0]*n,e[1]=t[1]*n,e[2]=t[2]*n,e[3]=t[3]*n,e[4]=t[4]*i,e[5]=t[5]*i,e[6]=t[6]*i,e[7]=t[7]*i,e[8]=t[8]*a,e[9]=t[9]*a,e[10]=t[10]*a,e[11]=t[11]*a,e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e};xt.rotate=function(e,t,r,n){var i=n[0],a=n[1],o=n[2],s=Math.sqrt(i*i+a*a+o*o),l,u,h,f,c,d,v,p,g,m,_,y,x,T,S,M,w,b,A,E,C,D,L,P;return Math.abs(s)<nm?null:(s=1/s,i*=s,a*=s,o*=s,l=Math.sin(r),u=Math.cos(r),h=1-u,f=t[0],c=t[1],d=t[2],v=t[3],p=t[4],g=t[5],m=t[6],_=t[7],y=t[8],x=t[9],T=t[10],S=t[11],M=i*i*h+u,w=a*i*h+o*l,b=o*i*h-a*l,A=i*a*h-o*l,E=a*a*h+u,C=o*a*h+i*l,D=i*o*h+a*l,L=a*o*h-i*l,P=o*o*h+u,e[0]=f*M+p*w+y*b,e[1]=c*M+g*w+x*b,e[2]=d*M+m*w+T*b,e[3]=v*M+_*w+S*b,e[4]=f*A+p*E+y*C,e[5]=c*A+g*E+x*C,e[6]=d*A+m*E+T*C,e[7]=v*A+_*E+S*C,e[8]=f*D+p*L+y*P,e[9]=c*D+g*L+x*P,e[10]=d*D+m*L+T*P,e[11]=v*D+_*L+S*P,t!==e&&(e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e)};xt.rotateX=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[4],o=t[5],s=t[6],l=t[7],u=t[8],h=t[9],f=t[10],c=t[11];return t!==e&&(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[4]=a*i+u*n,e[5]=o*i+h*n,e[6]=s*i+f*n,e[7]=l*i+c*n,e[8]=u*i-a*n,e[9]=h*i-o*n,e[10]=f*i-s*n,e[11]=c*i-l*n,e};xt.rotateY=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[8],h=t[9],f=t[10],c=t[11];return t!==e&&(e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i-u*n,e[1]=o*i-h*n,e[2]=s*i-f*n,e[3]=l*i-c*n,e[8]=a*n+u*i,e[9]=o*n+h*i,e[10]=s*n+f*i,e[11]=l*n+c*i,e};xt.rotateZ=function(e,t,r){var n=Math.sin(r),i=Math.cos(r),a=t[0],o=t[1],s=t[2],l=t[3],u=t[4],h=t[5],f=t[6],c=t[7];return t!==e&&(e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15]),e[0]=a*i+u*n,e[1]=o*i+h*n,e[2]=s*i+f*n,e[3]=l*i+c*n,e[4]=u*i-a*n,e[5]=h*i-o*n,e[6]=f*i-s*n,e[7]=c*i-l*n,e};xt.fromRotationTranslation=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=n+n,l=i+i,u=a+a,h=n*s,f=n*l,c=n*u,d=i*l,v=i*u,p=a*u,g=o*s,m=o*l,_=o*u;return e[0]=1-(d+p),e[1]=f+_,e[2]=c-m,e[3]=0,e[4]=f-_,e[5]=1-(h+p),e[6]=v+g,e[7]=0,e[8]=c+m,e[9]=v-g,e[10]=1-(h+d),e[11]=0,e[12]=r[0],e[13]=r[1],e[14]=r[2],e[15]=1,e};xt.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,l=i+i,u=r*o,h=n*o,f=n*s,c=i*o,d=i*s,v=i*l,p=a*o,g=a*s,m=a*l;return e[0]=1-f-v,e[1]=h+m,e[2]=c-g,e[3]=0,e[4]=h-m,e[5]=1-u-v,e[6]=d+p,e[7]=0,e[8]=c+g,e[9]=d-p,e[10]=1-u-f,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e};xt.frustum=function(e,t,r,n,i,a,o){var s=1/(r-t),l=1/(i-n),u=1/(a-o);return e[0]=a*2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a*2*l,e[6]=0,e[7]=0,e[8]=(r+t)*s,e[9]=(i+n)*l,e[10]=(o+a)*u,e[11]=-1,e[12]=0,e[13]=0,e[14]=o*a*2*u,e[15]=0,e};xt.perspective=function(e,t,r,n,i){var a=1/Math.tan(t/2),o=1/(n-i);return e[0]=a/r,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=a,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=(i+n)*o,e[11]=-1,e[12]=0,e[13]=0,e[14]=2*i*n*o,e[15]=0,e};xt.ortho=function(e,t,r,n,i,a,o){var s=1/(t-r),l=1/(n-i),u=1/(a-o);return e[0]=-2*s,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=-2*l,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=2*u,e[11]=0,e[12]=(t+r)*s,e[13]=(i+n)*l,e[14]=(o+a)*u,e[15]=1,e};xt.lookAt=function(e,t,r,n){var i,a,o,s,l,u,h,f,c,d,v=t[0],p=t[1],g=t[2],m=n[0],_=n[1],y=n[2],x=r[0],T=r[1],S=r[2];return Math.abs(v-x)<nm&&Math.abs(p-T)<nm&&Math.abs(g-S)<nm?xt.identity(e):(h=v-x,f=p-T,c=g-S,d=1/Math.sqrt(h*h+f*f+c*c),h*=d,f*=d,c*=d,i=_*c-y*f,a=y*h-m*c,o=m*f-_*h,d=Math.sqrt(i*i+a*a+o*o),d?(d=1/d,i*=d,a*=d,o*=d):(i=0,a=0,o=0),s=f*o-c*a,l=c*i-h*o,u=h*a-f*i,d=Math.sqrt(s*s+l*l+u*u),d?(d=1/d,s*=d,l*=d,u*=d):(s=0,l=0,u=0),e[0]=i,e[1]=s,e[2]=h,e[3]=0,e[4]=a,e[5]=l,e[6]=f,e[7]=0,e[8]=o,e[9]=u,e[10]=c,e[11]=0,e[12]=-(i*v+a*p+o*g),e[13]=-(s*v+l*p+u*g),e[14]=-(h*v+f*p+c*g),e[15]=1,e)};xt.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2)+Math.pow(e[9],2)+Math.pow(e[10],2)+Math.pow(e[11],2)+Math.pow(e[12],2)+Math.pow(e[13],2)+Math.pow(e[14],2)+Math.pow(e[15],2))};var W={};W.create=function(){var e=new mn(3);return e[0]=0,e[1]=0,e[2]=0,e};W.clone=function(e){var t=new mn(3);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t};W.fromValues=function(e,t,r){var n=new mn(3);return n[0]=e,n[1]=t,n[2]=r,n};W.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e};W.set=function(e,t,r,n){return e[0]=t,e[1]=r,e[2]=n,e};W.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e};W.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e};W.sub=W.subtract;W.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e};W.mul=W.multiply;W.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e};W.div=W.divide;W.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e};W.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e};W.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e};W.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e};W.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)};W.dist=W.distance;W.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i};W.sqrDist=W.squaredDistance;W.length=function(e){var t=e[0],r=e[1],n=e[2];return Math.sqrt(t*t+r*r+n*n)};W.len=W.length;W.squaredLength=function(e){var t=e[0],r=e[1],n=e[2];return t*t+r*r+n*n};W.sqrLen=W.squaredLength;W.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e};W.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e};W.normalize=function(e,t){var r=t[0],n=t[1],i=t[2],a=r*r+n*n+i*i;return a>0&&(a=1/Math.sqrt(a),e[0]=t[0]*a,e[1]=t[1]*a,e[2]=t[2]*a),e};W.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]};W.cross=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2];return e[0]=i*l-a*s,e[1]=a*o-n*l,e[2]=n*s-i*o,e};W.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e};W.random=function(e,t){t=t||1;var r=qh()*2*Math.PI,n=qh()*2-1,i=Math.sqrt(1-n*n)*t;return e[0]=Math.cos(r)*i,e[1]=Math.sin(r)*i,e[2]=n*t,e};W.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[3]*n+r[7]*i+r[11]*a+r[15];return o=o||1,e[0]=(r[0]*n+r[4]*i+r[8]*a+r[12])/o,e[1]=(r[1]*n+r[5]*i+r[9]*a+r[13])/o,e[2]=(r[2]*n+r[6]*i+r[10]*a+r[14])/o,e};W.transformMat3=function(e,t,r){var n=t[0],i=t[1],a=t[2];return e[0]=n*r[0]+i*r[3]+a*r[6],e[1]=n*r[1]+i*r[4]+a*r[7],e[2]=n*r[2]+i*r[5]+a*r[8],e};W.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2],u=r[3],h=u*n+s*a-l*i,f=u*i+l*n-o*a,c=u*a+o*i-s*n,d=-o*n-s*i-l*a;return e[0]=h*u+d*-o+f*-l-c*-s,e[1]=f*u+d*-s+c*-o-h*-l,e[2]=c*u+d*-l+h*-s-f*-o,e};W.rotateX=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0],a[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),a[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e};W.rotateY=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),a[1]=i[1],a[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e};W.rotateZ=function(e,t,r,n){var i=[],a=[];return i[0]=t[0]-r[0],i[1]=t[1]-r[1],i[2]=t[2]-r[2],a[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),a[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),a[2]=i[2],e[0]=a[0]+r[0],e[1]=a[1]+r[1],e[2]=a[2]+r[2],e};W.forEach=function(){var e=W.create();return function(t,r,n,i,a,o){var s,l;for(r||(r=3),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2];return t}}();W.angle=function(e,t){var r=W.fromValues(e[0],e[1],e[2]),n=W.fromValues(t[0],t[1],t[2]);W.normalize(r,r),W.normalize(n,n);var i=W.dot(r,n);return i>1?0:Math.acos(i)};Et.import(Nk);var _r=xt.create,QP={};function tI(e){return e.material}function Pit(e,t,r){return t.uniforms[r].value}function Iit(e,t,r,n){return r!==n}function Nit(e){return!0}function eI(){}var rI={float:mt.FLOAT,byte:mt.BYTE,ubyte:mt.UNSIGNED_BYTE,short:mt.SHORT,ushort:mt.UNSIGNED_SHORT};function Oit(e,t,r){this.availableAttributes=e,this.availableAttributeSymbols=t,this.indicesBuffer=r,this.vao=null}function Fit(e){var t,r;this.bind=function(n){t||(t=Ze.createCanvas(),t.width=t.height=1,t.getContext("2d"));var i=n.gl,a=!r;a&&(r=i.createTexture()),i.bindTexture(i.TEXTURE_2D,r),a&&i.texImage2D(i.TEXTURE_2D,0,i.RGBA,i.RGBA,i.UNSIGNED_BYTE,t)},this.unbind=function(n){n.gl.bindTexture(n.gl.TEXTURE_2D,null)},this.isRenderable=function(){return!0}}var Hi=gn.extend(function(){return{canvas:null,_width:100,_height:100,devicePixelRatio:typeof window<"u"&&window.devicePixelRatio||1,clearColor:[0,0,0,0],clearBit:17664,alpha:!0,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,throwError:!0,gl:null,viewport:{},maxJointNumber:20,__currentFrameBuffer:null,_viewportStack:[],_clearStack:[],_sceneRendering:null}},function(){this.canvas||(this.canvas=Ze.createCanvas());var e=this.canvas;try{var t={alpha:this.alpha,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,preserveDrawingBuffer:this.preserveDrawingBuffer};if(this.gl=e.getContext("webgl",t)||e.getContext("experimental-webgl",t),!this.gl)throw new Error;this._glinfo=new vit(this.gl),this.gl.targetRenderer&&console.error("Already created a renderer"),this.gl.targetRenderer=this,this.resize()}catch(r){throw"Error creating WebGL Context "+r}this._programMgr=new Lk(this),this._placeholderTexture=new Fit},{resize:function(e,t){var r=this.canvas,n=this.devicePixelRatio;e!=null?(r.style&&(r.style.width=e+"px",r.style.height=t+"px"),r.width=e*n,r.height=t*n,this._width=e,this._height=t):(this._width=r.width/n,this._height=r.height/n),this.setViewport(0,0,this._width,this._height)},getWidth:function(){return this._width},getHeight:function(){return this._height},getViewportAspect:function(){var e=this.viewport;return e.width/e.height},setDevicePixelRatio:function(e){this.devicePixelRatio=e,this.resize(this._width,this._height)},getDevicePixelRatio:function(){return this.devicePixelRatio},getGLExtension:function(e){return this._glinfo.getExtension(e)},getGLParameter:function(e){return this._glinfo.getParameter(e)},setViewport:function(e,t,r,n,i){if(typeof e=="object"){var a=e;e=a.x,t=a.y,r=a.width,n=a.height,i=a.devicePixelRatio}i=i||this.devicePixelRatio,this.gl.viewport(e*i,t*i,r*i,n*i),this.viewport={x:e,y:t,width:r,height:n,devicePixelRatio:i}},saveViewport:function(){this._viewportStack.push(this.viewport)},restoreViewport:function(){this._viewportStack.length>0&&this.setViewport(this._viewportStack.pop())},saveClear:function(){this._clearStack.push({clearBit:this.clearBit,clearColor:this.clearColor})},restoreClear:function(){if(this._clearStack.length>0){var e=this._clearStack.pop();this.clearColor=e.clearColor,this.clearBit=e.clearBit}},bindSceneRendering:function(e){this._sceneRendering=e},render:function(e,t,r,n){var i=this.gl,a=this.clearColor;if(this.clearBit){i.colorMask(!0,!0,!0,!0),i.depthMask(!0);var o=this.viewport,s=!1,l=o.devicePixelRatio;(o.width!==this._width||o.height!==this._height||l&&l!==this.devicePixelRatio||o.x||o.y)&&(s=!0,i.enable(i.SCISSOR_TEST),i.scissor(o.x*l,o.y*l,o.width*l,o.height*l)),i.clearColor(a[0],a[1],a[2],a[3]),i.clear(this.clearBit),s&&i.disable(i.SCISSOR_TEST)}if(r||e.update(!1),e.updateLights(),t=t||e.getMainCamera(),!t){console.error("Can't find camera in the scene.");return}t.update();var u=e.updateRenderList(t,!0);this._sceneRendering=e;var h=u.opaque,f=u.transparent,c=e.material;e.trigger("beforerender",this,e,t,u),n?(this.renderPreZ(h,e,t),i.depthFunc(i.LEQUAL)):i.depthFunc(i.LESS);for(var d=_r(),v=W.create(),p=0;p<f.length;p++){var g=f[p];xt.multiplyAffine(d,t.viewMatrix.array,g.worldTransform.array),W.transformMat4(v,g.position.array,d),g.__depth=v[2]}this.renderPass(h,t,{getMaterial:function(m){return c||m.material},sortCompare:this.opaqueSortCompare}),this.renderPass(f,t,{getMaterial:function(m){return c||m.material},sortCompare:this.transparentSortCompare}),e.trigger("afterrender",this,e,t,u),this._sceneRendering=null},getProgram:function(e,t,r){return t=t||e.material,this._programMgr.getProgram(e,t,r)},validateProgram:function(e){if(e.__error){var t=e.__error;if(QP[e.__uid__])return;if(QP[e.__uid__]=!0,this.throwError)throw new Error(t);this.trigger("error",t)}},updatePrograms:function(e,t,r){var n=r&&r.getMaterial||tI;t=t||null;for(var i=0;i<e.length;i++){var a=e[i],o=n.call(this,a);if(i>0){var s=e[i-1],l=s.joints?s.joints.length:0,u=a.joints?a.joints.length:0;if(u===l&&a.material===s.material&&a.lightGroup===s.lightGroup){a.__program=s.__program;continue}}var h=this._programMgr.getProgram(a,o,t);this.validateProgram(h),a.__program=h}},renderPass:function(e,t,r){this.trigger("beforerenderpass",this,e,t,r),r=r||{},r.getMaterial=r.getMaterial||tI,r.getUniform=r.getUniform||Pit,r.isMaterialChanged=r.isMaterialChanged||Iit,r.beforeRender=r.beforeRender||eI,r.afterRender=r.afterRender||eI;var n=r.ifRender||Nit;this.updatePrograms(e,this._sceneRendering,r),r.sortCompare&&e.sort(r.sortCompare);var i=this.viewport,a=i.devicePixelRatio,o=[i.x*a,i.y*a,i.width*a,i.height*a],s=this.devicePixelRatio,l=this.__currentFrameBuffer?[this.__currentFrameBuffer.getTextureWidth(),this.__currentFrameBuffer.getTextureHeight()]:[this._width*s,this._height*s],u=[o[2],o[3]],h=Date.now();t?(xt.copy(mr.VIEW,t.viewMatrix.array),xt.copy(mr.PROJECTION,t.projectionMatrix.array),xt.copy(mr.VIEWINVERSE,t.worldTransform.array)):(xt.identity(mr.VIEW),xt.identity(mr.PROJECTION),xt.identity(mr.VIEWINVERSE)),xt.multiply(mr.VIEWPROJECTION,mr.PROJECTION,mr.VIEW),xt.invert(mr.PROJECTIONINVERSE,mr.PROJECTION),xt.invert(mr.VIEWPROJECTIONINVERSE,mr.VIEWPROJECTION);for(var f=this.gl,c=this._sceneRendering,d,v,p,g,m,_,y,x,T,S,M,w,b=null,A=0;A<e.length;A++){var E=e[A],C=E.worldTransform!=null,D;if(n(E)){C&&(D=E.isSkinnedMesh&&E.isSkinnedMesh()?E.offsetMatrix?E.offsetMatrix.array:mr.IDENTITY:E.worldTransform.array);var L=E.geometry,P=r.getMaterial.call(this,E),N=E.__program,O=P.shader,I=L.__uid__+"-"+N.__uid__,k=I!==S;S=I,C&&(xt.copy(mr.WORLD,D),xt.multiply(mr.WORLDVIEWPROJECTION,mr.VIEWPROJECTION,D),xt.multiplyAffine(mr.WORLDVIEW,mr.VIEW,D),(O.matrixSemantics.WORLDINVERSE||O.matrixSemantics.WORLDINVERSETRANSPOSE)&&xt.invert(mr.WORLDINVERSE,D),(O.matrixSemantics.WORLDVIEWINVERSE||O.matrixSemantics.WORLDVIEWINVERSETRANSPOSE)&&xt.invert(mr.WORLDVIEWINVERSE,mr.WORLDVIEW),(O.matrixSemantics.WORLDVIEWPROJECTIONINVERSE||O.matrixSemantics.WORLDVIEWPROJECTIONINVERSETRANSPOSE)&&xt.invert(mr.WORLDVIEWPROJECTIONINVERSE,mr.WORLDVIEWPROJECTION)),E.beforeRender&&E.beforeRender(this),r.beforeRender.call(this,E,P,d);var z=N!==v;z?(N.bind(this),N.setUniformOfSemantic(f,"VIEWPORT",o),N.setUniformOfSemantic(f,"WINDOW_SIZE",l),t&&(N.setUniformOfSemantic(f,"NEAR",t.near),N.setUniformOfSemantic(f,"FAR",t.far)),N.setUniformOfSemantic(f,"DEVICEPIXELRATIO",a),N.setUniformOfSemantic(f,"TIME",h),N.setUniformOfSemantic(f,"VIEWPORT_SIZE",u),c&&c.setLightUniforms(N,E.lightGroup,this)):N=v,(z||r.isMaterialChanged(E,p,P,d))&&(P.depthTest!==g&&(P.depthTest?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),g=P.depthTest),P.depthMask!==m&&(f.depthMask(P.depthMask),m=P.depthMask),P.transparent!==T&&(P.transparent?f.enable(f.BLEND):f.disable(f.BLEND),T=P.transparent),P.transparent&&(P.blend?P.blend(f):(f.blendEquationSeparate(f.FUNC_ADD,f.FUNC_ADD),f.blendFuncSeparate(f.SRC_ALPHA,f.ONE_MINUS_SRC_ALPHA,f.ONE,f.ONE_MINUS_SRC_ALPHA))),w=this._bindMaterial(E,P,N,p||null,d||null,v||null,r.getUniform),d=P);var X=O.matrixSemanticKeys;if(C)for(var Y=0;Y<X.length;Y++){var $=X[Y],H=O.matrixSemantics[$],Z=mr[$];if(H.isTranspose){var ct=mr[H.semanticNoTranspose];xt.transpose(Z,ct)}N.setUniform(f,H.type,H.symbol,Z)}E.cullFace!==y&&(y=E.cullFace,f.cullFace(y)),E.frontFace!==x&&(x=E.frontFace,f.frontFace(x)),E.culling!==_&&(_=E.culling,_?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE)),this._updateSkeleton(E,N,w),k&&(M=this._bindVAO(b,O,L,N)),this._renderObject(E,M,N),r.afterRender(this,E),E.afterRender&&E.afterRender(this),v=N,p=E}}this.trigger("afterrenderpass",this,e,t,r)},getMaxJointNumber:function(){return this.maxJointNumber},_updateSkeleton:function(e,t,r){var n=this.gl,i=e.skeleton;if(i)if(i.update(),e.joints.length>this.getMaxJointNumber()){var a=i.getSubSkinMatricesTexture(e.__uid__,e.joints);t.useTextureSlot(this,a,r),t.setUniform(n,"1i","skinMatricesTexture",r),t.setUniform(n,"1f","skinMatricesTextureSize",a.width)}else{var o=i.getSubSkinMatrices(e.__uid__,e.joints);t.setUniformOfSemantic(n,"SKIN_MATRIX",o)}},_renderObject:function(e,t,r){var n=this.gl,i=e.geometry,a=e.mode;a==null&&(a=4);var o=null,s=e.isInstancedMesh&&e.isInstancedMesh();if(s&&(o=this.getGLExtension("ANGLE_instanced_arrays"),!o)){console.warn("Device not support ANGLE_instanced_arrays extension");return}var l;if(s&&(l=this._bindInstancedAttributes(e,r,o)),t.indicesBuffer){var u=this.getGLExtension("OES_element_index_uint"),h=u&&i.indices instanceof Uint32Array,f=h?n.UNSIGNED_INT:n.UNSIGNED_SHORT;s?o.drawElementsInstancedANGLE(a,t.indicesBuffer.count,f,0,e.getInstanceCount()):n.drawElements(a,t.indicesBuffer.count,f,0)}else s?o.drawArraysInstancedANGLE(a,0,i.vertexCount,e.getInstanceCount()):n.drawArrays(a,0,i.vertexCount);if(s)for(var c=0;c<l.length;c++)n.disableVertexAttribArray(l[c])},_bindInstancedAttributes:function(e,t,r){for(var n=this.gl,i=e.getInstancedAttributesBuffers(this),a=[],o=0;o<i.length;o++){var s=i[o],l=t.getAttribLocation(n,s.symbol);if(!(l<0)){var u=rI[s.type]||n.FLOAT;n.enableVertexAttribArray(l),n.bindBuffer(n.ARRAY_BUFFER,s.buffer),n.vertexAttribPointer(l,s.size,u,!1,0,0),r.vertexAttribDivisorANGLE(l,s.divisor),a.push(l)}}return a},_bindMaterial:function(e,t,r,n,i,a,o){for(var s=this.gl,l=a===r,u=r.currentTextureSlot(),h=t.getEnabledUniforms(),f=t.getTextureUniforms(),c=this._placeholderTexture,d=0;d<f.length;d++){var v=f[d],p=o(e,t,v),g=t.uniforms[v].type;if(g==="t"&&p)p.__slot=-1;else if(g==="tv")for(var m=0;m<p.length;m++)p[m]&&(p[m].__slot=-1)}c.__slot=-1;for(var d=0;d<h.length;d++){var v=h[d],_=t.uniforms[v],p=o(e,t,v),g=_.type,y=g==="t";if(y&&(!p||!p.isRenderable())&&(p=c),i&&l){var x=o(n,i,v);if(y&&(!x||!x.isRenderable())&&(x=c),x===p){if(y)r.takeCurrentTextureSlot(this,null);else if(g==="tv"&&p)for(var m=0;m<p.length;m++)r.takeCurrentTextureSlot(this,null);continue}}if(p!=null)if(y)if(p.__slot<0){var T=r.currentTextureSlot(),S=r.setUniform(s,"1i",v,T);S&&(r.takeCurrentTextureSlot(this,p),p.__slot=T)}else r.setUniform(s,"1i",v,p.__slot);else if(Array.isArray(p)){if(p.length===0)continue;if(g==="tv"){if(!r.hasUniform(v))continue;for(var M=[],m=0;m<p.length;m++){var w=p[m];if(w.__slot<0){var T=r.currentTextureSlot();M.push(T),r.takeCurrentTextureSlot(this,w),w.__slot=T}else M.push(w.__slot)}r.setUniform(s,"1iv",v,M)}else r.setUniform(s,_.type,v,p)}else r.setUniform(s,_.type,v,p)}var b=r.currentTextureSlot();return r.resetTextureSlot(u),b},_bindVAO:function(e,t,r,n){var i=!r.dynamic,a=this.gl,o=this.__uid__+"-"+n.__uid__,s=r.__vaoCache[o];if(!s){var l=r.getBufferChunks(this);if(!l||!l.length)return;for(var u=l[0],h=u.attributeBuffers,x=u.indicesBuffer,y=[],f=[],c=0;c<h.length;c++){var d=h[c],v=d.name,p=d.semantic,g;if(p){var m=t.attributeSemantics[p];g=m&&m.symbol}else g=v;g&&n.attributes[g]&&(y.push(d),f.push(g))}s=new Oit(y,f,x),i&&(r.__vaoCache[o]=s)}var _=!0;e&&i&&(s.vao==null?s.vao=e.createVertexArrayOES():_=!1,e.bindVertexArrayOES(s.vao));var y=s.availableAttributes,x=s.indicesBuffer;if(_){for(var T=n.enableAttributes(this,s.availableAttributeSymbols,e&&i&&s),c=0;c<y.length;c++){var S=T[c];if(S!==-1){var d=y[c],M=d.buffer,w=d.size,b=rI[d.type]||a.FLOAT;a.bindBuffer(a.ARRAY_BUFFER,M),a.vertexAttribPointer(S,w,b,!1,0,0)}}r.isUseIndices()&&a.bindBuffer(a.ELEMENT_ARRAY_BUFFER,x.buffer)}return s},renderPreZ:function(e,t,r){var n=this.gl,i=this._prezMaterial||new Vi({shader:new Et(Et.source("clay.prez.vertex"),Et.source("clay.prez.fragment"))});this._prezMaterial=i,n.colorMask(!1,!1,!1,!1),n.depthMask(!0),this.renderPass(e,r,{ifRender:function(a){return!a.ignorePreZ},isMaterialChanged:function(a,o){var s=a.material,l=o.material;return s.get("diffuseMap")!==l.get("diffuseMap")||(s.get("alphaCutoff")||0)!==(l.get("alphaCutoff")||0)},getUniform:function(a,o,s){if(s==="alphaMap")return a.material.get("diffuseMap");if(s==="alphaCutoff"){if(a.material.isDefined("fragment","ALPHA_TEST")&&a.material.get("diffuseMap")){var l=a.material.get("alphaCutoff");return l||0}return 0}else return s==="uvRepeat"?a.material.get("uvRepeat"):s==="uvOffset"?a.material.get("uvOffset"):o.get(s)},getMaterial:function(){return i},sort:this.opaqueSortCompare}),n.colorMask(!0,!0,!0,!0),n.depthMask(!0)},disposeScene:function(e){this.disposeNode(e,!0,!0),e.dispose()},disposeNode:function(e,t,r){e.getParent()&&e.getParent().remove(e);var n={};e.traverse(function(i){var a=i.material;if(i.geometry&&t&&i.geometry.dispose(this),r&&a&&!n[a.__uid__]){for(var o=a.getTextureUniforms(),s=0;s<o.length;s++){var l=o[s],u=a.uniforms[l].value,h=a.uniforms[l].type;if(u){if(h==="t")u.dispose&&u.dispose(this);else if(h==="tv")for(var f=0;f<u.length;f++)u[f]&&u[f].dispose&&u[f].dispose(this)}}n[a.__uid__]=!0}i.dispose&&i.dispose(this)},this)},disposeGeometry:function(e){e.dispose(this)},disposeTexture:function(e){e.dispose(this)},disposeFrameBuffer:function(e){e.dispose(this)},dispose:function(){},screenToNDC:function(e,t,r){r||(r=new ce),t=this._height-t;var n=this.viewport,i=r.array;return i[0]=(e-n.x)/n.width,i[0]=i[0]*2-1,i[1]=(t-n.y)/n.height,i[1]=i[1]*2-1,r}});Hi.opaqueSortCompare=Hi.prototype.opaqueSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.renderOrder-t.renderOrder};Hi.transparentSortCompare=Hi.prototype.transparentSortCompare=function(e,t){return e.renderOrder===t.renderOrder?e.__depth===t.__depth?e.__program===t.__program?e.material===t.material?e.geometry.__uid__-t.geometry.__uid__:e.material.__uid__-t.material.__uid__:e.__program&&t.__program?e.__program.__uid__-t.__program.__uid__:0:e.__depth-t.__depth:e.renderOrder-t.renderOrder};var mr={IDENTITY:_r(),WORLD:_r(),VIEW:_r(),PROJECTION:_r(),WORLDVIEW:_r(),VIEWPROJECTION:_r(),WORLDVIEWPROJECTION:_r(),WORLDINVERSE:_r(),VIEWINVERSE:_r(),PROJECTIONINVERSE:_r(),WORLDVIEWINVERSE:_r(),VIEWPROJECTIONINVERSE:_r(),WORLDVIEWPROJECTIONINVERSE:_r(),WORLDTRANSPOSE:_r(),VIEWTRANSPOSE:_r(),PROJECTIONTRANSPOSE:_r(),WORLDVIEWTRANSPOSE:_r(),VIEWPROJECTIONTRANSPOSE:_r(),WORLDVIEWPROJECTIONTRANSPOSE:_r(),WORLDINVERSETRANSPOSE:_r(),VIEWINVERSETRANSPOSE:_r(),PROJECTIONINVERSETRANSPOSE:_r(),WORLDVIEWINVERSETRANSPOSE:_r(),VIEWPROJECTIONINVERSETRANSPOSE:_r(),WORLDVIEWPROJECTIONINVERSETRANSPOSE:_r()};Hi.COLOR_BUFFER_BIT=mt.COLOR_BUFFER_BIT;Hi.DEPTH_BUFFER_BIT=mt.DEPTH_BUFFER_BIT;Hi.STENCIL_BUFFER_BIT=mt.STENCIL_BUFFER_BIT;var ht=function(e,t,r){e=e||0,t=t||0,r=r||0,this.array=W.fromValues(e,t,r),this._dirty=!0};ht.prototype={constructor:ht,add:function(e){return W.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,r){return this.array[0]=e,this.array[1]=t,this.array[2]=r,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this._dirty=!0,this},clone:function(){return new ht(this.x,this.y,this.z)},copy:function(e){return W.copy(this.array,e.array),this._dirty=!0,this},cross:function(e,t){return W.cross(this.array,e.array,t.array),this._dirty=!0,this},dist:function(e){return W.dist(this.array,e.array)},distance:function(e){return W.distance(this.array,e.array)},div:function(e){return W.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return W.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return W.dot(this.array,e.array)},len:function(){return W.len(this.array)},length:function(){return W.length(this.array)},lerp:function(e,t,r){return W.lerp(this.array,e.array,t.array,r),this._dirty=!0,this},min:function(e){return W.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return W.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return W.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return W.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return W.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return W.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return W.random(this.array,e),this._dirty=!0,this},scale:function(e){return W.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return W.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return W.sqrDist(this.array,e.array)},squaredDistance:function(e){return W.squaredDistance(this.array,e.array)},sqrLen:function(){return W.sqrLen(this.array)},squaredLength:function(){return W.squaredLength(this.array)},sub:function(e){return W.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return W.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat3:function(e){return W.transformMat3(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return W.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return W.transformQuat(this.array,this.array,e.array),this._dirty=!0,this},applyProjection:function(e){var t=this.array;if(e=e.array,e[15]===0){var r=-1/t[2];t[0]=e[0]*t[0]*r,t[1]=e[5]*t[1]*r,t[2]=(e[10]*t[2]+e[14])*r}else t[0]=e[0]*t[0]+e[12],t[1]=e[5]*t[1]+e[13],t[2]=e[10]*t[2]+e[14];return this._dirty=!0,this},eulerFromQuat:function(e,t){ht.eulerFromQuat(this,e,t)},eulerFromMat3:function(e,t){ht.eulerFromMat3(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var Jp=Object.defineProperty;if(Jp){var Qx=ht.prototype;Jp(Qx,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Jp(Qx,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),Jp(Qx,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}})}ht.add=function(e,t,r){return W.add(e.array,t.array,r.array),e._dirty=!0,e};ht.set=function(e,t,r,n){W.set(e.array,t,r,n),e._dirty=!0};ht.copy=function(e,t){return W.copy(e.array,t.array),e._dirty=!0,e};ht.cross=function(e,t,r){return W.cross(e.array,t.array,r.array),e._dirty=!0,e};ht.dist=function(e,t){return W.distance(e.array,t.array)};ht.distance=ht.dist;ht.div=function(e,t,r){return W.divide(e.array,t.array,r.array),e._dirty=!0,e};ht.divide=ht.div;ht.dot=function(e,t){return W.dot(e.array,t.array)};ht.len=function(e){return W.length(e.array)};ht.lerp=function(e,t,r,n){return W.lerp(e.array,t.array,r.array,n),e._dirty=!0,e};ht.min=function(e,t,r){return W.min(e.array,t.array,r.array),e._dirty=!0,e};ht.max=function(e,t,r){return W.max(e.array,t.array,r.array),e._dirty=!0,e};ht.mul=function(e,t,r){return W.multiply(e.array,t.array,r.array),e._dirty=!0,e};ht.multiply=ht.mul;ht.negate=function(e,t){return W.negate(e.array,t.array),e._dirty=!0,e};ht.normalize=function(e,t){return W.normalize(e.array,t.array),e._dirty=!0,e};ht.random=function(e,t){return W.random(e.array,t),e._dirty=!0,e};ht.scale=function(e,t,r){return W.scale(e.array,t.array,r),e._dirty=!0,e};ht.scaleAndAdd=function(e,t,r,n){return W.scaleAndAdd(e.array,t.array,r.array,n),e._dirty=!0,e};ht.sqrDist=function(e,t){return W.sqrDist(e.array,t.array)};ht.squaredDistance=ht.sqrDist;ht.sqrLen=function(e){return W.sqrLen(e.array)};ht.squaredLength=ht.sqrLen;ht.sub=function(e,t,r){return W.subtract(e.array,t.array,r.array),e._dirty=!0,e};ht.subtract=ht.sub;ht.transformMat3=function(e,t,r){return W.transformMat3(e.array,t.array,r.array),e._dirty=!0,e};ht.transformMat4=function(e,t,r){return W.transformMat4(e.array,t.array,r.array),e._dirty=!0,e};ht.transformQuat=function(e,t,r){return W.transformQuat(e.array,t.array,r.array),e._dirty=!0,e};function Oi(e,t,r){return e<t?t:e>r?r:e}var sr=Math.atan2,Fi=Math.asin,_h=Math.abs;ht.eulerFromQuat=function(e,t,c){e._dirty=!0,t=t.array;var n=e.array,i=t[0],a=t[1],o=t[2],s=t[3],l=i*i,u=a*a,h=o*o,f=s*s,c=(c||"XYZ").toUpperCase();switch(c){case"XYZ":n[0]=sr(2*(i*s-a*o),f-l-u+h),n[1]=Fi(Oi(2*(i*o+a*s),-1,1)),n[2]=sr(2*(o*s-i*a),f+l-u-h);break;case"YXZ":n[0]=Fi(Oi(2*(i*s-a*o),-1,1)),n[1]=sr(2*(i*o+a*s),f-l-u+h),n[2]=sr(2*(i*a+o*s),f-l+u-h);break;case"ZXY":n[0]=Fi(Oi(2*(i*s+a*o),-1,1)),n[1]=sr(2*(a*s-o*i),f-l-u+h),n[2]=sr(2*(o*s-i*a),f-l+u-h);break;case"ZYX":n[0]=sr(2*(i*s+o*a),f-l-u+h),n[1]=Fi(Oi(2*(a*s-i*o),-1,1)),n[2]=sr(2*(i*a+o*s),f+l-u-h);break;case"YZX":n[0]=sr(2*(i*s-o*a),f-l+u-h),n[1]=sr(2*(a*s-i*o),f+l-u-h),n[2]=Fi(Oi(2*(i*a+o*s),-1,1));break;case"XZY":n[0]=sr(2*(i*s+a*o),f-l+u-h),n[1]=sr(2*(i*o+a*s),f+l-u-h),n[2]=Fi(Oi(2*(o*s-i*a),-1,1));break;default:console.warn("Unkown order: "+c)}return e};ht.eulerFromMat3=function(e,t,v){var n=t.array,i=n[0],a=n[3],o=n[6],s=n[1],l=n[4],u=n[7],h=n[2],f=n[5],c=n[8],d=e.array,v=(v||"XYZ").toUpperCase();switch(v){case"XYZ":d[1]=Fi(Oi(o,-1,1)),_h(o)<.99999?(d[0]=sr(-u,c),d[2]=sr(-a,i)):(d[0]=sr(f,l),d[2]=0);break;case"YXZ":d[0]=Fi(-Oi(u,-1,1)),_h(u)<.99999?(d[1]=sr(o,c),d[2]=sr(s,l)):(d[1]=sr(-h,i),d[2]=0);break;case"ZXY":d[0]=Fi(Oi(f,-1,1)),_h(f)<.99999?(d[1]=sr(-h,c),d[2]=sr(-a,l)):(d[1]=0,d[2]=sr(s,i));break;case"ZYX":d[1]=Fi(-Oi(h,-1,1)),_h(h)<.99999?(d[0]=sr(f,c),d[2]=sr(s,i)):(d[0]=0,d[2]=sr(-a,l));break;case"YZX":d[2]=Fi(Oi(s,-1,1)),_h(s)<.99999?(d[0]=sr(-u,l),d[1]=sr(-h,i)):(d[0]=0,d[1]=sr(o,c));break;case"XZY":d[2]=Fi(-Oi(a,-1,1)),_h(a)<.99999?(d[0]=sr(f,l),d[1]=sr(o,i)):(d[0]=sr(-u,c),d[1]=0);break;default:console.warn("Unkown order: "+v)}return e._dirty=!0,e};Object.defineProperties(ht,{POSITIVE_X:{get:function(){return new ht(1,0,0)}},NEGATIVE_X:{get:function(){return new ht(-1,0,0)}},POSITIVE_Y:{get:function(){return new ht(0,1,0)}},NEGATIVE_Y:{get:function(){return new ht(0,-1,0)}},POSITIVE_Z:{get:function(){return new ht(0,0,1)}},NEGATIVE_Z:{get:function(){return new ht(0,0,-1)}},UP:{get:function(){return new ht(0,1,0)}},ZERO:{get:function(){return new ht}}});var Bit=1e-5,mu=function(e,t){this.origin=e||new ht,this.direction=t||new ht};mu.prototype={constructor:mu,intersectPlane:function(e,t){var r=e.normal.array,n=e.distance,i=this.origin.array,a=this.direction.array,o=W.dot(r,a);if(o===0)return null;t||(t=new ht);var s=(W.dot(r,i)-n)/o;return W.scaleAndAdd(t.array,i,a,-s),t._dirty=!0,t},mirrorAgainstPlane:function(e){var t=W.dot(e.normal.array,this.direction.array);W.scaleAndAdd(this.direction.array,this.direction.array,e.normal.array,-t*2),this.direction._dirty=!0},distanceToPoint:function(){var e=W.create();return function(t){W.sub(e,t,this.origin.array);var r=W.dot(e,this.direction.array);if(r<0)return W.distance(this.origin.array,t);var n=W.lenSquared(e);return Math.sqrt(n-r*r)}}(),intersectSphere:function(){var e=W.create();return function(t,r,n){var i=this.origin.array,a=this.direction.array;t=t.array,W.sub(e,t,i);var o=W.dot(e,a),s=W.squaredLength(e),l=s-o*o,u=r*r;if(!(l>u)){var h=Math.sqrt(u-l),f=o-h,c=o+h;return n||(n=new ht),f<0?c<0?null:(W.scaleAndAdd(n.array,i,a,c),n):(W.scaleAndAdd(n.array,i,a,f),n)}}}(),intersectBoundingBox:function(e,t){var r=this.direction.array,n=this.origin.array,i=e.min.array,a=e.max.array,o=1/r[0],s=1/r[1],l=1/r[2],u,h,f,c,d,v;if(o>=0?(u=(i[0]-n[0])*o,h=(a[0]-n[0])*o):(h=(i[0]-n[0])*o,u=(a[0]-n[0])*o),s>=0?(f=(i[1]-n[1])*s,c=(a[1]-n[1])*s):(c=(i[1]-n[1])*s,f=(a[1]-n[1])*s),u>c||f>h||((f>u||u!==u)&&(u=f),(c<h||h!==h)&&(h=c),l>=0?(d=(i[2]-n[2])*l,v=(a[2]-n[2])*l):(v=(i[2]-n[2])*l,d=(a[2]-n[2])*l),u>v||d>h)||((d>u||u!==u)&&(u=d),(v<h||h!==h)&&(h=v),h<0))return null;var p=u>=0?u:h;return t||(t=new ht),W.scaleAndAdd(t.array,n,r,p),t},intersectTriangle:function(){var e=W.create(),t=W.create(),r=W.create(),n=W.create();return function(i,a,o,s,l,u){var h=this.direction.array,f=this.origin.array;i=i.array,a=a.array,o=o.array,W.sub(e,a,i),W.sub(t,o,i),W.cross(n,t,h);var c=W.dot(e,n);if(s){if(c>-1e-5)return null}else if(c>-1e-5&&c<Bit)return null;W.sub(r,f,i);var d=W.dot(n,r)/c;if(d<0||d>1)return null;W.cross(n,e,r);var v=W.dot(h,n)/c;if(v<0||v>1||d+v>1)return null;W.cross(n,e,t);var p=-W.dot(r,n)/c;return p<0?null:(l||(l=new ht),u&&ht.set(u,1-d-v,d,v),W.scaleAndAdd(l.array,f,h,p),l)}}(),applyTransform:function(e){ht.add(this.direction,this.direction,this.origin),ht.transformMat4(this.origin,this.origin,e),ht.transformMat4(this.direction,this.direction,e),ht.sub(this.direction,this.direction,this.origin),ht.normalize(this.direction,this.direction)},copy:function(e){ht.copy(this.origin,e.origin),ht.copy(this.direction,e.direction)},clone:function(){var e=new mu;return e.copy(this),e}};var yt={};yt.create=function(){var e=new mn(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=0,e};yt.clone=function(e){var t=new mn(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t};yt.fromValues=function(e,t,r,n){var i=new mn(4);return i[0]=e,i[1]=t,i[2]=r,i[3]=n,i};yt.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e};yt.set=function(e,t,r,n,i){return e[0]=t,e[1]=r,e[2]=n,e[3]=i,e};yt.add=function(e,t,r){return e[0]=t[0]+r[0],e[1]=t[1]+r[1],e[2]=t[2]+r[2],e[3]=t[3]+r[3],e};yt.subtract=function(e,t,r){return e[0]=t[0]-r[0],e[1]=t[1]-r[1],e[2]=t[2]-r[2],e[3]=t[3]-r[3],e};yt.sub=yt.subtract;yt.multiply=function(e,t,r){return e[0]=t[0]*r[0],e[1]=t[1]*r[1],e[2]=t[2]*r[2],e[3]=t[3]*r[3],e};yt.mul=yt.multiply;yt.divide=function(e,t,r){return e[0]=t[0]/r[0],e[1]=t[1]/r[1],e[2]=t[2]/r[2],e[3]=t[3]/r[3],e};yt.div=yt.divide;yt.min=function(e,t,r){return e[0]=Math.min(t[0],r[0]),e[1]=Math.min(t[1],r[1]),e[2]=Math.min(t[2],r[2]),e[3]=Math.min(t[3],r[3]),e};yt.max=function(e,t,r){return e[0]=Math.max(t[0],r[0]),e[1]=Math.max(t[1],r[1]),e[2]=Math.max(t[2],r[2]),e[3]=Math.max(t[3],r[3]),e};yt.scale=function(e,t,r){return e[0]=t[0]*r,e[1]=t[1]*r,e[2]=t[2]*r,e[3]=t[3]*r,e};yt.scaleAndAdd=function(e,t,r,n){return e[0]=t[0]+r[0]*n,e[1]=t[1]+r[1]*n,e[2]=t[2]+r[2]*n,e[3]=t[3]+r[3]*n,e};yt.distance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return Math.sqrt(r*r+n*n+i*i+a*a)};yt.dist=yt.distance;yt.squaredDistance=function(e,t){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2],a=t[3]-e[3];return r*r+n*n+i*i+a*a};yt.sqrDist=yt.squaredDistance;yt.length=function(e){var t=e[0],r=e[1],n=e[2],i=e[3];return Math.sqrt(t*t+r*r+n*n+i*i)};yt.len=yt.length;yt.squaredLength=function(e){var t=e[0],r=e[1],n=e[2],i=e[3];return t*t+r*r+n*n+i*i};yt.sqrLen=yt.squaredLength;yt.negate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e};yt.inverse=function(e,t){return e[0]=1/t[0],e[1]=1/t[1],e[2]=1/t[2],e[3]=1/t[3],e};yt.normalize=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a;return o>0&&(o=1/Math.sqrt(o),e[0]=t[0]*o,e[1]=t[1]*o,e[2]=t[2]*o,e[3]=t[3]*o),e};yt.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]};yt.lerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3];return e[0]=i+n*(r[0]-i),e[1]=a+n*(r[1]-a),e[2]=o+n*(r[2]-o),e[3]=s+n*(r[3]-s),e};yt.random=function(e,t){return t=t||1,e[0]=qh(),e[1]=qh(),e[2]=qh(),e[3]=qh(),yt.normalize(e,e),yt.scale(e,e,t),e};yt.transformMat4=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3];return e[0]=r[0]*n+r[4]*i+r[8]*a+r[12]*o,e[1]=r[1]*n+r[5]*i+r[9]*a+r[13]*o,e[2]=r[2]*n+r[6]*i+r[10]*a+r[14]*o,e[3]=r[3]*n+r[7]*i+r[11]*a+r[15]*o,e};yt.transformQuat=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=r[0],s=r[1],l=r[2],u=r[3],h=u*n+s*a-l*i,f=u*i+l*n-o*a,c=u*a+o*i-s*n,d=-o*n-s*i-l*a;return e[0]=h*u+d*-o+f*-l-c*-s,e[1]=f*u+d*-s+c*-o-h*-l,e[2]=c*u+d*-l+h*-s-f*-o,e};yt.forEach=function(){var e=yt.create();return function(t,r,n,i,a,o){var s,l;for(r||(r=4),n||(n=0),i?l=Math.min(i*r+n,t.length):l=t.length,s=n;s<l;s+=r)e[0]=t[s],e[1]=t[s+1],e[2]=t[s+2],e[3]=t[s+3],a(e,e,o),t[s]=e[0],t[s+1]=e[1],t[s+2]=e[2],t[s+3]=e[3];return t}}();var le={};le.create=function(){var e=new mn(9);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e};le.fromMat4=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[4],e[4]=t[5],e[5]=t[6],e[6]=t[8],e[7]=t[9],e[8]=t[10],e};le.clone=function(e){var t=new mn(9);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t};le.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e};le.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e};le.transpose=function(e,t){if(e===t){var r=t[1],n=t[2],i=t[5];e[1]=t[3],e[2]=t[6],e[3]=r,e[5]=t[7],e[6]=n,e[7]=i}else e[0]=t[0],e[1]=t[3],e[2]=t[6],e[3]=t[1],e[4]=t[4],e[5]=t[7],e[6]=t[2],e[7]=t[5],e[8]=t[8];return e};le.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],h=t[8],f=h*o-s*u,c=-h*a+s*l,d=u*a-o*l,v=r*f+n*c+i*d;return v?(v=1/v,e[0]=f*v,e[1]=(-h*n+i*u)*v,e[2]=(s*n-i*o)*v,e[3]=c*v,e[4]=(h*r-i*l)*v,e[5]=(-s*r+i*a)*v,e[6]=d*v,e[7]=(-u*r+n*l)*v,e[8]=(o*r-n*a)*v,e):null};le.adjoint=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],h=t[8];return e[0]=o*h-s*u,e[1]=i*u-n*h,e[2]=n*s-i*o,e[3]=s*l-a*h,e[4]=r*h-i*l,e[5]=i*a-r*s,e[6]=a*u-o*l,e[7]=n*l-r*u,e[8]=r*o-n*a,e};le.determinant=function(e){var t=e[0],r=e[1],n=e[2],i=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*(u*a-o*l)+r*(-u*i+o*s)+n*(l*i-a*s)};le.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],h=t[7],f=t[8],c=r[0],d=r[1],v=r[2],p=r[3],g=r[4],m=r[5],_=r[6],y=r[7],x=r[8];return e[0]=c*n+d*o+v*u,e[1]=c*i+d*s+v*h,e[2]=c*a+d*l+v*f,e[3]=p*n+g*o+m*u,e[4]=p*i+g*s+m*h,e[5]=p*a+g*l+m*f,e[6]=_*n+y*o+x*u,e[7]=_*i+y*s+x*h,e[8]=_*a+y*l+x*f,e};le.mul=le.multiply;le.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],h=t[7],f=t[8],c=r[0],d=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=s,e[5]=l,e[6]=c*n+d*o+u,e[7]=c*i+d*s+h,e[8]=c*a+d*l+f,e};le.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=t[6],h=t[7],f=t[8],c=Math.sin(r),d=Math.cos(r);return e[0]=d*n+c*o,e[1]=d*i+c*s,e[2]=d*a+c*l,e[3]=d*o-c*n,e[4]=d*s-c*i,e[5]=d*l-c*a,e[6]=u,e[7]=h,e[8]=f,e};le.scale=function(e,t,r){var n=r[0],i=r[1];return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=i*t[3],e[4]=i*t[4],e[5]=i*t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e};le.fromMat2d=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=0,e[3]=t[2],e[4]=t[3],e[5]=0,e[6]=t[4],e[7]=t[5],e[8]=1,e};le.fromQuat=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r+r,s=n+n,l=i+i,u=r*o,h=n*o,f=n*s,c=i*o,d=i*s,v=i*l,p=a*o,g=a*s,m=a*l;return e[0]=1-f-v,e[3]=h-m,e[6]=c+g,e[1]=h+m,e[4]=1-u-v,e[7]=d-p,e[2]=c-g,e[5]=d+p,e[8]=1-u-f,e};le.normalFromMat4=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],h=t[8],f=t[9],c=t[10],d=t[11],v=t[12],p=t[13],g=t[14],m=t[15],_=r*s-n*o,y=r*l-i*o,x=r*u-a*o,T=n*l-i*s,S=n*u-a*s,M=i*u-a*l,w=h*p-f*v,b=h*g-c*v,A=h*m-d*v,E=f*g-c*p,C=f*m-d*p,D=c*m-d*g,L=_*D-y*C+x*E+T*A-S*b+M*w;return L?(L=1/L,e[0]=(s*D-l*C+u*E)*L,e[1]=(l*A-o*D-u*b)*L,e[2]=(o*C-s*A+u*w)*L,e[3]=(i*C-n*D-a*E)*L,e[4]=(r*D-i*A+a*b)*L,e[5]=(n*A-r*C-a*w)*L,e[6]=(p*M-g*S+m*T)*L,e[7]=(g*x-v*M-m*y)*L,e[8]=(v*S-p*x+m*_)*L,e):null};le.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+Math.pow(e[6],2)+Math.pow(e[7],2)+Math.pow(e[8],2))};var Bt={};Bt.create=function(){var e=new mn(4);return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};Bt.rotationTo=function(){var e=W.create(),t=W.fromValues(1,0,0),r=W.fromValues(0,1,0);return function(n,i,a){var o=W.dot(i,a);return o<-.999999?(W.cross(e,t,i),W.length(e)<1e-6&&W.cross(e,r,i),W.normalize(e,e),Bt.setAxisAngle(n,e,Math.PI),n):o>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(W.cross(e,i,a),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=1+o,Bt.normalize(n,n))}}();Bt.setAxes=function(){var e=le.create();return function(t,r,n,i){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=-r[0],e[5]=-r[1],e[8]=-r[2],Bt.normalize(t,Bt.fromMat3(t,e))}}();Bt.clone=yt.clone;Bt.fromValues=yt.fromValues;Bt.copy=yt.copy;Bt.set=yt.set;Bt.identity=function(e){return e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};Bt.setAxisAngle=function(e,t,r){r=r*.5;var n=Math.sin(r);return e[0]=n*t[0],e[1]=n*t[1],e[2]=n*t[2],e[3]=Math.cos(r),e};Bt.add=yt.add;Bt.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],l=r[1],u=r[2],h=r[3];return e[0]=n*h+o*s+i*u-a*l,e[1]=i*h+o*l+a*s-n*u,e[2]=a*h+o*u+n*l-i*s,e[3]=o*h-n*s-i*l-a*u,e};Bt.mul=Bt.multiply;Bt.scale=yt.scale;Bt.rotateX=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+o*s,e[1]=i*l+a*s,e[2]=a*l-i*s,e[3]=o*l-n*s,e};Bt.rotateY=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l-a*s,e[1]=i*l+o*s,e[2]=a*l+n*s,e[3]=o*l-i*s,e};Bt.rotateZ=function(e,t,r){r*=.5;var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+i*s,e[1]=i*l-n*s,e[2]=a*l+o*s,e[3]=o*l-a*s,e};Bt.calculateW=function(e,t){var r=t[0],n=t[1],i=t[2];return e[0]=r,e[1]=n,e[2]=i,e[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),e};Bt.dot=yt.dot;Bt.lerp=yt.lerp;Bt.slerp=function(e,t,r,n){var i=t[0],a=t[1],o=t[2],s=t[3],l=r[0],u=r[1],h=r[2],f=r[3],c,d,v,p,g;return d=i*l+a*u+o*h+s*f,d<0&&(d=-d,l=-l,u=-u,h=-h,f=-f),1-d>1e-6?(c=Math.acos(d),v=Math.sin(c),p=Math.sin((1-n)*c)/v,g=Math.sin(n*c)/v):(p=1-n,g=n),e[0]=p*i+g*l,e[1]=p*a+g*u,e[2]=p*o+g*h,e[3]=p*s+g*f,e};Bt.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*r+n*n+i*i+a*a,s=o?1/o:0;return e[0]=-r*s,e[1]=-n*s,e[2]=-i*s,e[3]=a*s,e};Bt.conjugate=function(e,t){return e[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=t[3],e};Bt.length=yt.length;Bt.len=Bt.length;Bt.squaredLength=yt.squaredLength;Bt.sqrLen=Bt.squaredLength;Bt.normalize=yt.normalize;Bt.fromMat3=function(e,t){var r=t[0]+t[4]+t[8],n;if(r>0)n=Math.sqrt(r+1),e[3]=.5*n,n=.5/n,e[0]=(t[5]-t[7])*n,e[1]=(t[6]-t[2])*n,e[2]=(t[1]-t[3])*n;else{var i=0;t[4]>t[0]&&(i=1),t[8]>t[i*3+i]&&(i=2);var a=(i+1)%3,o=(i+2)%3;n=Math.sqrt(t[i*3+i]-t[a*3+a]-t[o*3+o]+1),e[i]=.5*n,n=.5/n,e[3]=(t[a*3+o]-t[o*3+a])*n,e[a]=(t[a*3+i]+t[i*3+a])*n,e[o]=(t[o*3+i]+t[i*3+o])*n}return e};var Nt=function(){this._axisX=new ht,this._axisY=new ht,this._axisZ=new ht,this.array=xt.create(),this._dirty=!0};Nt.prototype={constructor:Nt,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return xt.adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return new Nt().copy(this)},copy:function(e){return xt.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return xt.determinant(this.array)},fromQuat:function(e){return xt.fromQuat(this.array,e.array),this._dirty=!0,this},fromRotationTranslation:function(e,t){return xt.fromRotationTranslation(this.array,e.array,t.array),this._dirty=!0,this},fromMat2d:function(e){return Nt.fromMat2d(this,e),this},frustum:function(e,t,r,n,i,a){return xt.frustum(this.array,e,t,r,n,i,a),this._dirty=!0,this},identity:function(){return xt.identity(this.array),this._dirty=!0,this},invert:function(){return xt.invert(this.array,this.array),this._dirty=!0,this},lookAt:function(e,t,r){return xt.lookAt(this.array,e.array,t.array,r.array),this._dirty=!0,this},mul:function(e){return xt.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return xt.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return xt.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return xt.multiply(this.array,e.array,this.array),this._dirty=!0,this},ortho:function(e,t,r,n,i,a){return xt.ortho(this.array,e,t,r,n,i,a),this._dirty=!0,this},perspective:function(e,t,r,n){return xt.perspective(this.array,e,t,r,n),this._dirty=!0,this},rotate:function(e,t){return xt.rotate(this.array,this.array,e,t.array),this._dirty=!0,this},rotateX:function(e){return xt.rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return xt.rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return xt.rotateZ(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return xt.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return xt.translate(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return xt.transpose(this.array,this.array),this._dirty=!0,this},decomposeMatrix:function(){var e=W.create(),t=W.create(),r=W.create(),n=le.create();return function(i,a,o){var s=this.array;W.set(e,s[0],s[1],s[2]),W.set(t,s[4],s[5],s[6]),W.set(r,s[8],s[9],s[10]);var l=W.length(e),u=W.length(t),h=W.length(r),f=this.determinant();f<0&&(l=-l),i&&i.set(l,u,h),o.set(s[12],s[13],s[14]),le.fromMat4(n,s),n[0]/=l,n[1]/=l,n[2]/=l,n[3]/=u,n[4]/=u,n[5]/=u,n[6]/=h,n[7]/=h,n[8]/=h,Bt.fromMat3(a.array,n),Bt.normalize(a.array,a.array),a._dirty=!0,o._dirty=!0}}(),toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var Qp=Object.defineProperty;if(Qp){var t1=Nt.prototype;Qp(t1,"z",{get:function(){var e=this.array;return this._axisZ.set(e[8],e[9],e[10]),this._axisZ},set:function(e){var t=this.array;e=e.array,t[8]=e[0],t[9]=e[1],t[10]=e[2],this._dirty=!0}}),Qp(t1,"y",{get:function(){var e=this.array;return this._axisY.set(e[4],e[5],e[6]),this._axisY},set:function(e){var t=this.array;e=e.array,t[4]=e[0],t[5]=e[1],t[6]=e[2],this._dirty=!0}}),Qp(t1,"x",{get:function(){var e=this.array;return this._axisX.set(e[0],e[1],e[2]),this._axisX},set:function(e){var t=this.array;e=e.array,t[0]=e[0],t[1]=e[1],t[2]=e[2],this._dirty=!0}})}Nt.adjoint=function(e,t){return xt.adjoint(e.array,t.array),e._dirty=!0,e};Nt.copy=function(e,t){return xt.copy(e.array,t.array),e._dirty=!0,e};Nt.determinant=function(e){return xt.determinant(e.array)};Nt.identity=function(e){return xt.identity(e.array),e._dirty=!0,e};Nt.ortho=function(e,t,r,n,i,a,o){return xt.ortho(e.array,t,r,n,i,a,o),e._dirty=!0,e};Nt.perspective=function(e,t,r,n,i){return xt.perspective(e.array,t,r,n,i),e._dirty=!0,e};Nt.lookAt=function(e,t,r,n){return xt.lookAt(e.array,t.array,r.array,n.array),e._dirty=!0,e};Nt.invert=function(e,t){return xt.invert(e.array,t.array),e._dirty=!0,e};Nt.mul=function(e,t,r){return xt.mul(e.array,t.array,r.array),e._dirty=!0,e};Nt.multiply=Nt.mul;Nt.fromQuat=function(e,t){return xt.fromQuat(e.array,t.array),e._dirty=!0,e};Nt.fromRotationTranslation=function(e,t,r){return xt.fromRotationTranslation(e.array,t.array,r.array),e._dirty=!0,e};Nt.fromMat2d=function(n,r){n._dirty=!0;var r=r.array,n=n.array;return n[0]=r[0],n[4]=r[2],n[12]=r[4],n[1]=r[1],n[5]=r[3],n[13]=r[5],n};Nt.rotate=function(e,t,r,n){return xt.rotate(e.array,t.array,r,n.array),e._dirty=!0,e};Nt.rotateX=function(e,t,r){return xt.rotateX(e.array,t.array,r),e._dirty=!0,e};Nt.rotateY=function(e,t,r){return xt.rotateY(e.array,t.array,r),e._dirty=!0,e};Nt.rotateZ=function(e,t,r){return xt.rotateZ(e.array,t.array,r),e._dirty=!0,e};Nt.scale=function(e,t,r){return xt.scale(e.array,t.array,r.array),e._dirty=!0,e};Nt.transpose=function(e,t){return xt.transpose(e.array,t.array),e._dirty=!0,e};Nt.translate=function(e,t,r){return xt.translate(e.array,t.array,r.array),e._dirty=!0,e};var Je=function(e,t,r,n){e=e||0,t=t||0,r=r||0,n=n===void 0?1:n,this.array=Bt.fromValues(e,t,r,n),this._dirty=!0};Je.prototype={constructor:Je,add:function(e){return Bt.add(this.array,this.array,e.array),this._dirty=!0,this},calculateW:function(){return Bt.calculateW(this.array,this.array),this._dirty=!0,this},set:function(e,t,r,n){return this.array[0]=e,this.array[1]=t,this.array[2]=r,this.array[3]=n,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new Je(this.x,this.y,this.z,this.w)},conjugate:function(){return Bt.conjugate(this.array,this.array),this._dirty=!0,this},copy:function(e){return Bt.copy(this.array,e.array),this._dirty=!0,this},dot:function(e){return Bt.dot(this.array,e.array)},fromMat3:function(e){return Bt.fromMat3(this.array,e.array),this._dirty=!0,this},fromMat4:function(){var e=le.create();return function(t){return le.fromMat4(e,t.array),le.transpose(e,e),Bt.fromMat3(this.array,e),this._dirty=!0,this}}(),identity:function(){return Bt.identity(this.array),this._dirty=!0,this},invert:function(){return Bt.invert(this.array,this.array),this._dirty=!0,this},len:function(){return Bt.len(this.array)},length:function(){return Bt.length(this.array)},lerp:function(e,t,r){return Bt.lerp(this.array,e.array,t.array,r),this._dirty=!0,this},mul:function(e){return Bt.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return Bt.multiply(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return Bt.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return Bt.multiply(this.array,e.array,this.array),this._dirty=!0,this},normalize:function(){return Bt.normalize(this.array,this.array),this._dirty=!0,this},rotateX:function(e){return Bt.rotateX(this.array,this.array,e),this._dirty=!0,this},rotateY:function(e){return Bt.rotateY(this.array,this.array,e),this._dirty=!0,this},rotateZ:function(e){return Bt.rotateZ(this.array,this.array,e),this._dirty=!0,this},rotationTo:function(e,t){return Bt.rotationTo(this.array,e.array,t.array),this._dirty=!0,this},setAxes:function(e,t,r){return Bt.setAxes(this.array,e.array,t.array,r.array),this._dirty=!0,this},setAxisAngle:function(e,t){return Bt.setAxisAngle(this.array,e.array,t),this._dirty=!0,this},slerp:function(e,t,r){return Bt.slerp(this.array,e.array,t.array,r),this._dirty=!0,this},sqrLen:function(){return Bt.sqrLen(this.array)},squaredLength:function(){return Bt.squaredLength(this.array)},fromEuler:function(e,t){return Je.fromEuler(this,e,t)},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var zc=Object.defineProperty;if(zc){var tg=Je.prototype;zc(tg,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),zc(tg,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),zc(tg,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),zc(tg,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}})}Je.add=function(e,t,r){return Bt.add(e.array,t.array,r.array),e._dirty=!0,e};Je.set=function(e,t,r,n,i){Bt.set(e.array,t,r,n,i),e._dirty=!0};Je.copy=function(e,t){return Bt.copy(e.array,t.array),e._dirty=!0,e};Je.calculateW=function(e,t){return Bt.calculateW(e.array,t.array),e._dirty=!0,e};Je.conjugate=function(e,t){return Bt.conjugate(e.array,t.array),e._dirty=!0,e};Je.identity=function(e){return Bt.identity(e.array),e._dirty=!0,e};Je.invert=function(e,t){return Bt.invert(e.array,t.array),e._dirty=!0,e};Je.dot=function(e,t){return Bt.dot(e.array,t.array)};Je.len=function(e){return Bt.length(e.array)};Je.lerp=function(e,t,r,n){return Bt.lerp(e.array,t.array,r.array,n),e._dirty=!0,e};Je.slerp=function(e,t,r,n){return Bt.slerp(e.array,t.array,r.array,n),e._dirty=!0,e};Je.mul=function(e,t,r){return Bt.multiply(e.array,t.array,r.array),e._dirty=!0,e};Je.multiply=Je.mul;Je.rotateX=function(e,t,r){return Bt.rotateX(e.array,t.array,r),e._dirty=!0,e};Je.rotateY=function(e,t,r){return Bt.rotateY(e.array,t.array,r),e._dirty=!0,e};Je.rotateZ=function(e,t,r){return Bt.rotateZ(e.array,t.array,r),e._dirty=!0,e};Je.setAxisAngle=function(e,t,r){return Bt.setAxisAngle(e.array,t.array,r),e._dirty=!0,e};Je.normalize=function(e,t){return Bt.normalize(e.array,t.array),e._dirty=!0,e};Je.sqrLen=function(e){return Bt.sqrLen(e.array)};Je.squaredLength=Je.sqrLen;Je.fromMat3=function(e,t){return Bt.fromMat3(e.array,t.array),e._dirty=!0,e};Je.setAxes=function(e,t,r,n){return Bt.setAxes(e.array,t.array,r.array,n.array),e._dirty=!0,e};Je.rotationTo=function(e,t,r){return Bt.rotationTo(e.array,t.array,r.array),e._dirty=!0,e};Je.fromEuler=function(e,t,h){e._dirty=!0,t=t.array;var n=e.array,i=Math.cos(t[0]/2),a=Math.cos(t[1]/2),o=Math.cos(t[2]/2),s=Math.sin(t[0]/2),l=Math.sin(t[1]/2),u=Math.sin(t[2]/2),h=(h||"XYZ").toUpperCase();switch(h){case"XYZ":n[0]=s*a*o+i*l*u,n[1]=i*l*o-s*a*u,n[2]=i*a*u+s*l*o,n[3]=i*a*o-s*l*u;break;case"YXZ":n[0]=s*a*o+i*l*u,n[1]=i*l*o-s*a*u,n[2]=i*a*u-s*l*o,n[3]=i*a*o+s*l*u;break;case"ZXY":n[0]=s*a*o-i*l*u,n[1]=i*l*o+s*a*u,n[2]=i*a*u+s*l*o,n[3]=i*a*o-s*l*u;break;case"ZYX":n[0]=s*a*o-i*l*u,n[1]=i*l*o+s*a*u,n[2]=i*a*u-s*l*o,n[3]=i*a*o+s*l*u;break;case"YZX":n[0]=s*a*o+i*l*u,n[1]=i*l*o+s*a*u,n[2]=i*a*u-s*l*o,n[3]=i*a*o-s*l*u;break;case"XZY":n[0]=s*a*o-i*l*u,n[1]=i*l*o-s*a*u,n[2]=i*a*u+s*l*o,n[3]=i*a*o+s*l*u;break}};var es=W.set,eg=W.copy,vn=function(e,t){this.min=e||new ht(1/0,1/0,1/0),this.max=t||new ht(-1/0,-1/0,-1/0),this.vertices=null};vn.prototype={constructor:vn,updateFromVertices:function(e){if(e.length>0){var t=this.min,r=this.max,n=t.array,i=r.array;eg(n,e[0]),eg(i,e[0]);for(var a=1;a<e.length;a++){var o=e[a];o[0]<n[0]&&(n[0]=o[0]),o[1]<n[1]&&(n[1]=o[1]),o[2]<n[2]&&(n[2]=o[2]),o[0]>i[0]&&(i[0]=o[0]),o[1]>i[1]&&(i[1]=o[1]),o[2]>i[2]&&(i[2]=o[2])}t._dirty=!0,r._dirty=!0}},union:function(e){var t=this.min,r=this.max;return W.min(t.array,t.array,e.min.array),W.max(r.array,r.array,e.max.array),t._dirty=!0,r._dirty=!0,this},intersection:function(e){var t=this.min,r=this.max;return W.max(t.array,t.array,e.min.array),W.min(r.array,r.array,e.max.array),t._dirty=!0,r._dirty=!0,this},intersectBoundingBox:function(e){var t=this.min.array,r=this.max.array,n=e.min.array,i=e.max.array;return!(t[0]>i[0]||t[1]>i[1]||t[2]>i[2]||r[0]<n[0]||r[1]<n[1]||r[2]<n[2])},containBoundingBox:function(e){var t=this.min.array,r=this.max.array,n=e.min.array,i=e.max.array;return t[0]<=n[0]&&t[1]<=n[1]&&t[2]<=n[2]&&r[0]>=i[0]&&r[1]>=i[1]&&r[2]>=i[2]},containPoint:function(e){var t=this.min.array,r=this.max.array,n=e.array;return t[0]<=n[0]&&t[1]<=n[1]&&t[2]<=n[2]&&r[0]>=n[0]&&r[1]>=n[1]&&r[2]>=n[2]},isFinite:function(){var e=this.min.array,t=this.max.array;return isFinite(e[0])&&isFinite(e[1])&&isFinite(e[2])&&isFinite(t[0])&&isFinite(t[1])&&isFinite(t[2])},applyTransform:function(e){this.transformFrom(this,e)},transformFrom:function(){var e=W.create(),t=W.create(),r=W.create(),n=W.create(),i=W.create(),a=W.create();return function(o,s){var l=o.min.array,u=o.max.array,h=s.array;return e[0]=h[0]*l[0],e[1]=h[1]*l[0],e[2]=h[2]*l[0],t[0]=h[0]*u[0],t[1]=h[1]*u[0],t[2]=h[2]*u[0],r[0]=h[4]*l[1],r[1]=h[5]*l[1],r[2]=h[6]*l[1],n[0]=h[4]*u[1],n[1]=h[5]*u[1],n[2]=h[6]*u[1],i[0]=h[8]*l[2],i[1]=h[9]*l[2],i[2]=h[10]*l[2],a[0]=h[8]*u[2],a[1]=h[9]*u[2],a[2]=h[10]*u[2],l=this.min.array,u=this.max.array,l[0]=Math.min(e[0],t[0])+Math.min(r[0],n[0])+Math.min(i[0],a[0])+h[12],l[1]=Math.min(e[1],t[1])+Math.min(r[1],n[1])+Math.min(i[1],a[1])+h[13],l[2]=Math.min(e[2],t[2])+Math.min(r[2],n[2])+Math.min(i[2],a[2])+h[14],u[0]=Math.max(e[0],t[0])+Math.max(r[0],n[0])+Math.max(i[0],a[0])+h[12],u[1]=Math.max(e[1],t[1])+Math.max(r[1],n[1])+Math.max(i[1],a[1])+h[13],u[2]=Math.max(e[2],t[2])+Math.max(r[2],n[2])+Math.max(i[2],a[2])+h[14],this.min._dirty=!0,this.max._dirty=!0,this}}(),applyProjection:function(e){var t=this.min.array,r=this.max.array,n=e.array,i=t[0],a=t[1],o=t[2],s=r[0],l=r[1],u=t[2],h=r[0],f=r[1],c=r[2];if(n[15]===1)t[0]=n[0]*i+n[12],t[1]=n[5]*a+n[13],r[2]=n[10]*o+n[14],r[0]=n[0]*h+n[12],r[1]=n[5]*f+n[13],t[2]=n[10]*c+n[14];else{var d=-1/o;t[0]=n[0]*i*d,t[1]=n[5]*a*d,r[2]=(n[10]*o+n[14])*d,d=-1/u,r[0]=n[0]*s*d,r[1]=n[5]*l*d,d=-1/c,t[2]=(n[10]*c+n[14])*d}return this.min._dirty=!0,this.max._dirty=!0,this},updateVertices:function(){var e=this.vertices;if(!e){e=[];for(var t=0;t<8;t++)e[t]=W.fromValues(0,0,0);this.vertices=e}var r=this.min.array,n=this.max.array;return es(e[0],r[0],r[1],r[2]),es(e[1],r[0],n[1],r[2]),es(e[2],n[0],r[1],r[2]),es(e[3],n[0],n[1],r[2]),es(e[4],r[0],r[1],n[2]),es(e[5],r[0],n[1],n[2]),es(e[6],n[0],r[1],n[2]),es(e[7],n[0],n[1],n[2]),this},copy:function(e){var t=this.min,r=this.max;return eg(t.array,e.min.array),eg(r.array,e.max.array),t._dirty=!0,r._dirty=!0,this},clone:function(){var e=new vn;return e.copy(this),e}};var Uit=0,Wa=gn.extend({name:"",position:null,rotation:null,scale:null,worldTransform:null,localTransform:null,autoUpdateLocalTransform:!0,_parent:null,_scene:null,_needsUpdateWorldTransform:!0,_inIterating:!1,__depth:0},function(){this.name||(this.name=(this.type||"NODE")+"_"+Uit++),this.position||(this.position=new ht),this.rotation||(this.rotation=new Je),this.scale||(this.scale=new ht(1,1,1)),this.worldTransform=new Nt,this.localTransform=new Nt,this._children=[]},{target:null,invisible:!1,isSkinnedMesh:function(){return!1},isRenderable:function(){return!1},setName:function(e){var t=this._scene;if(t){var r=t._nodeRepository;delete r[this.name],r[e]=this}this.name=e},add:function(e){var t=e._parent;if(t!==this){t&&t.remove(e),e._parent=this,this._children.push(e);var r=this._scene;r&&r!==e.scene&&e.traverse(this._addSelfToScene,this),e._needsUpdateWorldTransform=!0}},remove:function(e){var t=this._children,r=t.indexOf(e);r<0||(t.splice(r,1),e._parent=null,this._scene&&e.traverse(this._removeSelfFromScene,this))},removeAll:function(){for(var e=this._children,t=0;t<e.length;t++)e[t]._parent=null,this._scene&&e[t].traverse(this._removeSelfFromScene,this);this._children=[]},getScene:function(){return this._scene},getParent:function(){return this._parent},_removeSelfFromScene:function(e){e._scene.removeFromScene(e),e._scene=null},_addSelfToScene:function(e){this._scene.addToScene(e),e._scene=this._scene},isAncestor:function(e){for(var t=e._parent;t;){if(t===this)return!0;t=t._parent}return!1},children:function(){return this._children.slice()},childAt:function(e){return this._children[e]},getChildByName:function(e){for(var t=this._children,r=0;r<t.length;r++)if(t[r].name===e)return t[r]},getDescendantByName:function(e){for(var t=this._children,r=0;r<t.length;r++){var n=t[r];if(n.name===e)return n;var i=n.getDescendantByName(e);if(i)return i}},queryNode:function(e){if(e){for(var t=e.split("/"),r=this,n=0;n<t.length;n++){var i=t[n];if(i){for(var a=!1,o=r._children,s=0;s<o.length;s++){var l=o[s];if(l.name===i){r=l,a=!0;break}}if(!a)return}}return r}},getPath:function(e){if(!this._parent)return"/";for(var t=this._parent,r=this.name;t._parent&&(r=t.name+"/"+r,t._parent!=e);)t=t._parent;return!t._parent&&e?null:r},traverse:function(e,t){e.call(t,this);for(var r=this._children,n=0,i=r.length;n<i;n++)r[n].traverse(e,t)},eachChild:function(e,t){for(var r=this._children,n=0,i=r.length;n<i;n++){var a=r[n];e.call(t,a,n)}},setLocalTransform:function(e){xt.copy(this.localTransform.array,e.array),this.decomposeLocalTransform()},decomposeLocalTransform:function(e){var t=e?null:this.scale;this.localTransform.decomposeMatrix(t,this.rotation,this.position)},setWorldTransform:function(e){xt.copy(this.worldTransform.array,e.array),this.decomposeWorldTransform()},decomposeWorldTransform:function(){var e=xt.create();return function(t){var r=this.localTransform,n=this.worldTransform;this._parent?(xt.invert(e,this._parent.worldTransform.array),xt.multiply(r.array,e,n.array)):xt.copy(r.array,n.array);var i=t?null:this.scale;r.decomposeMatrix(i,this.rotation,this.position)}}(),transformNeedsUpdate:function(){return this.position._dirty||this.rotation._dirty||this.scale._dirty},updateLocalTransform:function(){var e=this.position,t=this.rotation,r=this.scale;if(this.transformNeedsUpdate()){var n=this.localTransform.array;xt.fromRotationTranslation(n,t.array,e.array),xt.scale(n,n,r.array),t._dirty=!1,r._dirty=!1,e._dirty=!1,this._needsUpdateWorldTransform=!0}},_updateWorldTransformTopDown:function(){var e=this.localTransform.array,t=this.worldTransform.array;this._parent?xt.multiplyAffine(t,this._parent.worldTransform.array,e):xt.copy(t,e)},updateWorldTransform:function(){for(var e=this;e&&e.getParent()&&e.getParent().transformNeedsUpdate();)e=e.getParent();e.update()},update:function(e){this.autoUpdateLocalTransform?this.updateLocalTransform():e=!0,(e||this._needsUpdateWorldTransform)&&(this._updateWorldTransformTopDown(),e=!0,this._needsUpdateWorldTransform=!1);for(var t=this._children,r=0,n=t.length;r<n;r++)t[r].update(e)},getBoundingBox:function(){function e(i){return!i.invisible&&i.geometry}var t=new vn,r=new Nt,n=new Nt;return function(i,a){return a=a||new vn,this._parent?Nt.invert(n,this._parent.worldTransform):Nt.identity(n),this.traverse(function(o){o.geometry&&o.geometry.boundingBox&&(t.copy(o.geometry.boundingBox),Nt.multiply(r,n,o.worldTransform),t.applyTransform(r),a.union(t))},this,e),a}}(),getWorldPosition:function(e){this.transformNeedsUpdate()&&this.updateWorldTransform();var t=this.worldTransform.array;if(e){var r=e.array;return r[0]=t[12],r[1]=t[13],r[2]=t[14],e}else return new ht(t[12],t[13],t[14])},clone:function(){var e=new this.constructor,t=this._children;e.setName(this.name),e.position.copy(this.position),e.rotation.copy(this.rotation),e.scale.copy(this.scale);for(var r=0;r<t.length;r++)e.add(t[r].clone());return e},rotateAround:function(){var e=new ht,t=new Nt;return function(r,n,i){e.copy(this.position).subtract(r);var a=this.localTransform;a.identity(),a.translate(r),a.rotate(i,n),t.fromRotationTranslation(this.rotation,e),a.multiply(t),a.scale(this.scale),this.decomposeLocalTransform(),this._needsUpdateWorldTransform=!0}}(),lookAt:function(){var e=new Nt;return function(t,r){e.lookAt(this.position,t,r||this.localTransform.y).invert(),this.setLocalTransform(e),this.target=t}}()}),Zn=Wa.extend({material:null,geometry:null,mode:mt.TRIANGLES,_renderInfo:null},{__program:null,lightGroup:0,renderOrder:0,culling:!0,cullFace:mt.BACK,frontFace:mt.CCW,frustumCulling:!0,receiveShadow:!0,castShadow:!0,ignorePicking:!1,ignorePreZ:!1,ignoreGBuffer:!1,isRenderable:function(){return this.geometry&&this.material&&this.material.shader&&!this.invisible&&this.geometry.vertexCount>0},beforeRender:function(e){},afterRender:function(e,t){},getBoundingBox:function(e,t){return t=Wa.prototype.getBoundingBox.call(this,e,t),this.geometry&&this.geometry.boundingBox&&t.union(this.geometry.boundingBox),t},clone:function(){var e=["castShadow","receiveShadow","mode","culling","cullFace","frontFace","frustumCulling","renderOrder","lineWidth","ignorePicking","ignorePreZ","ignoreGBuffer"];return function(){var t=Wa.prototype.clone.call(this);t.geometry=this.geometry,t.material=this.material;for(var r=0;r<e.length;r++){var n=e[r];t[n]!==this[n]&&(t[n]=this[n])}return t}}()});Zn.POINTS=mt.POINTS;Zn.LINES=mt.LINES;Zn.LINE_LOOP=mt.LINE_LOOP;Zn.LINE_STRIP=mt.LINE_STRIP;Zn.TRIANGLES=mt.TRIANGLES;Zn.TRIANGLE_STRIP=mt.TRIANGLE_STRIP;Zn.TRIANGLE_FAN=mt.TRIANGLE_FAN;Zn.BACK=mt.BACK;Zn.FRONT=mt.FRONT;Zn.FRONT_AND_BACK=mt.FRONT_AND_BACK;Zn.CW=mt.CW;Zn.CCW=mt.CCW;var rA=gn.extend({scene:null,camera:null,renderer:null},function(){this._ray=new mu,this._ndc=new ce},{pick:function(e,t,r){var n=this.pickAll(e,t,[],r);return n[0]||null},pickAll:function(e,t,r,n){return this.renderer.screenToNDC(e,t,this._ndc),this.camera.castRay(this._ndc,this._ray),r=r||[],this._intersectNode(this.scene,r,n||!1),r.sort(this._intersectionCompareFunc),r},_intersectNode:function(e,t,r){e instanceof Zn&&e.isRenderable()&&(!e.ignorePicking||r)&&(e.mode===mt.TRIANGLES&&e.geometry.isUseIndices()||e.geometry.pickByRay||e.geometry.pick)&&this._intersectRenderable(e,t);for(var n=0;n<e._children.length;n++)this._intersectNode(e._children[n],t,r)},_intersectRenderable:function(){var e=new ht,t=new ht,r=new ht,n=new mu,i=new Nt;return function(a,o){var s=a.isSkinnedMesh();n.copy(this._ray),Nt.invert(i,a.worldTransform),s||n.applyTransform(i);var l=a.geometry,u=s?a.skeleton.boundingBox:l.boundingBox;if(!(u&&!n.intersectBoundingBox(u))){if(l.pick){l.pick(this._ndc.x,this._ndc.y,this.renderer,this.camera,a,o);return}else if(l.pickByRay){l.pickByRay(n,a,o);return}var h=a.cullFace===mt.BACK&&a.frontFace===mt.CCW||a.cullFace===mt.FRONT&&a.frontFace===mt.CW,f,c=l.indices,d=l.attributes.position,v=l.attributes.weight,p=l.attributes.joint,g,m=[];if(!(!d||!d.value||!c)){if(s){g=a.skeleton.getSubSkinMatrices(a.__uid__,a.joints);for(var _=0;_<a.joints.length;_++){m[_]=m[_]||[];for(var y=0;y<16;y++)m[_][y]=g[_*16+y]}var x=[],T=[],S=[],M=[],w=[],b=l.attributes.skinnedPosition;(!b||!b.value)&&(l.createAttribute("skinnedPosition","f",3),b=l.attributes.skinnedPosition,b.init(l.vertexCount));for(var _=0;_<l.vertexCount;_++){d.get(_,x),v.get(_,T),p.get(_,S),T[3]=1-T[0]-T[1]-T[2],W.set(M,0,0,0);for(var y=0;y<4;y++)S[y]>=0&&T[y]>1e-4&&(W.transformMat4(w,x,m[S[y]]),W.scaleAndAdd(M,M,w,T[y]));b.set(_,M)}}for(var _=0;_<c.length;_+=3){var A=c[_],E=c[_+1],C=c[_+2],D=s?l.attributes.skinnedPosition:d;if(D.get(A,e.array),D.get(E,t.array),D.get(C,r.array),h?f=n.intersectTriangle(e,t,r,a.culling):f=n.intersectTriangle(e,r,t,a.culling),f){var L=new ht;s?ht.copy(L,f):ht.transformMat4(L,f,a.worldTransform),o.push(new rA.Intersection(f,L,a,[A,E,C],_/3,ht.dist(L,this._ray.origin)))}}}}}}(),_intersectionCompareFunc:function(e,t){return e.distance-t.distance}});rA.Intersection=function(e,t,r,n,i,a){this.point=e,this.pointWorld=t,this.target=r,this.triangle=n,this.triangleIndex=i,this.distance=a};var kc="__dt__",xf=function(){this._contextId=0,this._caches=[],this._context={}};xf.prototype={use:function(e,t){var r=this._caches;r[e]||(r[e]={},t&&(r[e]=t())),this._contextId=e,this._context=r[e]},put:function(e,t){this._context[e]=t},get:function(e){return this._context[e]},dirty:function(e){e=e||"";var t=kc+e;this.put(t,!0)},dirtyAll:function(e){e=e||"";for(var t=kc+e,r=this._caches,n=0;n<r.length;n++)r[n]&&(r[n][t]=!0)},fresh:function(e){e=e||"";var t=kc+e;this.put(t,!1)},freshAll:function(e){e=e||"";for(var t=kc+e,r=this._caches,n=0;n<r.length;n++)r[n]&&(r[n][t]=!1)},isDirty:function(e){e=e||"";var t=kc+e,r=this._context;return!r.hasOwnProperty(t)||r[t]===!0},deleteContext:function(e){delete this._caches[e],this._context={}},delete:function(e){delete this._context[e]},clearAll:function(){this._caches={}},getContext:function(){return this._context},eachContext:function(e,t){var r=Object.keys(this._caches);r.forEach(function(n){e&&e.call(t,n)})},miss:function(e){return!this._context.hasOwnProperty(e)}};xf.prototype.constructor=xf;var Mt=gn.extend({width:512,height:512,type:mt.UNSIGNED_BYTE,format:mt.RGBA,wrapS:mt.REPEAT,wrapT:mt.REPEAT,minFilter:mt.LINEAR_MIPMAP_LINEAR,magFilter:mt.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,sRGB:!0,unpackAlignment:4,premultiplyAlpha:!1,dynamic:!1,NPOT:!1,__used:0},function(){this._cache=new xf},{getWebGLTexture:function(e){var t=e.gl,r=this._cache;return r.use(e.__uid__),r.miss("webgl_texture")&&r.put("webgl_texture",t.createTexture()),this.dynamic?this.update(e):r.isDirty()&&(this.update(e),r.fresh()),r.get("webgl_texture")},bind:function(){},unbind:function(){},dirty:function(){this._cache&&this._cache.dirtyAll()},update:function(e){},updateCommon:function(e){var t=e.gl;t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,this.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,this.unpackAlignment),this.format===mt.DEPTH_COMPONENT&&(this.useMipmap=!1);var r=e.getGLExtension("EXT_sRGB");this.format===Mt.SRGB&&!r&&(this.format=Mt.RGB),this.format===Mt.SRGB_ALPHA&&!r&&(this.format=Mt.RGBA),this.NPOT=!this.isPowerOfTwo()},getAvailableWrapS:function(){return this.NPOT?mt.CLAMP_TO_EDGE:this.wrapS},getAvailableWrapT:function(){return this.NPOT?mt.CLAMP_TO_EDGE:this.wrapT},getAvailableMinFilter:function(){var e=this.minFilter;return this.NPOT||!this.useMipmap?e===mt.NEAREST_MIPMAP_NEAREST||e===mt.NEAREST_MIPMAP_LINEAR?mt.NEAREST:e===mt.LINEAR_MIPMAP_LINEAR||e===mt.LINEAR_MIPMAP_NEAREST?mt.LINEAR:e:e},getAvailableMagFilter:function(){return this.magFilter},nextHighestPowerOfTwo:function(e){--e;for(var t=1;t<32;t<<=1)e=e|e>>t;return e+1},dispose:function(e){var t=this._cache;t.use(e.__uid__);var r=t.get("webgl_texture");r&&e.gl.deleteTexture(r),t.deleteContext(e.__uid__)},isRenderable:function(){},isPowerOfTwo:function(){}});Object.defineProperty(Mt.prototype,"width",{get:function(){return this._width},set:function(e){this._width=e}});Object.defineProperty(Mt.prototype,"height",{get:function(){return this._height},set:function(e){this._height=e}});Mt.BYTE=mt.BYTE;Mt.UNSIGNED_BYTE=mt.UNSIGNED_BYTE;Mt.SHORT=mt.SHORT;Mt.UNSIGNED_SHORT=mt.UNSIGNED_SHORT;Mt.INT=mt.INT;Mt.UNSIGNED_INT=mt.UNSIGNED_INT;Mt.FLOAT=mt.FLOAT;Mt.HALF_FLOAT=36193;Mt.UNSIGNED_INT_24_8_WEBGL=34042;Mt.DEPTH_COMPONENT=mt.DEPTH_COMPONENT;Mt.DEPTH_STENCIL=mt.DEPTH_STENCIL;Mt.ALPHA=mt.ALPHA;Mt.RGB=mt.RGB;Mt.RGBA=mt.RGBA;Mt.LUMINANCE=mt.LUMINANCE;Mt.LUMINANCE_ALPHA=mt.LUMINANCE_ALPHA;Mt.SRGB=35904;Mt.SRGB_ALPHA=35906;Mt.COMPRESSED_RGB_S3TC_DXT1_EXT=33776;Mt.COMPRESSED_RGBA_S3TC_DXT1_EXT=33777;Mt.COMPRESSED_RGBA_S3TC_DXT3_EXT=33778;Mt.COMPRESSED_RGBA_S3TC_DXT5_EXT=33779;Mt.NEAREST=mt.NEAREST;Mt.LINEAR=mt.LINEAR;Mt.NEAREST_MIPMAP_NEAREST=mt.NEAREST_MIPMAP_NEAREST;Mt.LINEAR_MIPMAP_NEAREST=mt.LINEAR_MIPMAP_NEAREST;Mt.NEAREST_MIPMAP_LINEAR=mt.NEAREST_MIPMAP_LINEAR;Mt.LINEAR_MIPMAP_LINEAR=mt.LINEAR_MIPMAP_LINEAR;Mt.REPEAT=mt.REPEAT;Mt.CLAMP_TO_EDGE=mt.CLAMP_TO_EDGE;Mt.MIRRORED_REPEAT=mt.MIRRORED_REPEAT;var Qr=Zn.extend({skeleton:null,joints:null},function(){this.joints||(this.joints=[])},{offsetMatrix:null,isInstancedMesh:function(){return!1},isSkinnedMesh:function(){return!!(this.skeleton&&this.joints&&this.joints.length>0)},clone:function(){var e=Zn.prototype.clone.call(this);return e.skeleton=this.skeleton,this.joints&&(e.joints=this.joints.slice()),e}});Qr.POINTS=mt.POINTS;Qr.LINES=mt.LINES;Qr.LINE_LOOP=mt.LINE_LOOP;Qr.LINE_STRIP=mt.LINE_STRIP;Qr.TRIANGLES=mt.TRIANGLES;Qr.TRIANGLE_STRIP=mt.TRIANGLE_STRIP;Qr.TRIANGLE_FAN=mt.TRIANGLE_FAN;Qr.BACK=mt.BACK;Qr.FRONT=mt.FRONT;Qr.FRONT_AND_BACK=mt.FRONT_AND_BACK;Qr.CW=mt.CW;Qr.CCW=mt.CCW;var Uv={};Uv.isPowerOfTwo=function(e){return(e&e-1)===0};Uv.nextPowerOfTwo=function(e){return e--,e|=e>>1,e|=e>>2,e|=e>>4,e|=e>>8,e|=e>>16,e++,e};Uv.nearestPowerOfTwo=function(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))};var nI=Uv.isPowerOfTwo;function iI(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function zit(e,t){var r=iI(e.width),n=iI(e.height);t=t||document.createElement("canvas"),t.width=r,t.height=n;var i=t.getContext("2d");return i.drawImage(e.image,0,0,r,n),t}var xe=Mt.extend(function(){return{image:null,pixels:null,mipmaps:[],convertToPOT:!1}},{textureType:"texture2D",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),this.updateCommon(e);var r=this.format,n=this.type,i=!!(this.convertToPOT&&!this.mipmaps.length&&this.image&&(this.wrapS===Mt.REPEAT||this.wrapT===Mt.REPEAT)&&this.NPOT);t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,i?this.wrapS:this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,i?this.wrapT:this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,i?this.magFilter:this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,i?this.minFilter:this.getAvailableMinFilter());var a=e.getGLExtension("EXT_texture_filter_anisotropic");if(a&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_2D,a.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),n===36193){var o=e.getGLExtension("OES_texture_half_float");o||(n=mt.FLOAT)}if(this.mipmaps.length)for(var s=this.width,l=this.height,u=0;u<this.mipmaps.length;u++){var h=this.mipmaps[u];this._updateTextureData(t,h,u,s,l,r,n,!1),s/=2,l/=2}else this._updateTextureData(t,this,0,this.width,this.height,r,n,i),this.useMipmap&&(!this.NPOT||i)&&t.generateMipmap(t.TEXTURE_2D);t.bindTexture(t.TEXTURE_2D,null)},_updateTextureData:function(e,t,r,n,i,a,o,s){if(t.image){var l=t.image;s&&(this._potCanvas=zit(this,this._potCanvas),l=this._potCanvas),e.texImage2D(e.TEXTURE_2D,r,a,a,o,l)}else a<=Mt.COMPRESSED_RGBA_S3TC_DXT5_EXT&&a>=Mt.COMPRESSED_RGB_S3TC_DXT1_EXT?e.compressedTexImage2D(e.TEXTURE_2D,r,a,n,i,0,t.pixels):e.texImage2D(e.TEXTURE_2D,r,a,n,i,0,a,o,t.pixels)},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_2D,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_2D))},isPowerOfTwo:function(){return nI(this.width)&&nI(this.height)},isRenderable:function(){return this.image?this.image.width>0&&this.image.height>0:!!(this.width&&this.height)},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_2D,null)},load:function(e,t){var r=Ze.createImage();t&&(r.crossOrigin=t);var n=this;return r.onload=function(){n.dirty(),n.trigger("success",n)},r.onerror=function(){n.trigger("error",n)},r.src=e,this.image=r,this}});Object.defineProperty(xe.prototype,"width",{get:function(){return this.image?this.image.width:this._width},set:function(e){this.image?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}});Object.defineProperty(xe.prototype,"height",{get:function(){return this.image?this.image.height:this._height},set:function(e){this.image?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}});function Ok(e){return{byte:Ze.Int8Array,ubyte:Ze.Uint8Array,short:Ze.Int16Array,ushort:Ze.Uint16Array}[e]||Ze.Float32Array}function e1(e){return"attr_"+e}function Sf(e,t,r,n){switch(this.name=e,this.type=t,this.size=r,this.semantic=n||"",this.value=null,r){case 1:this.get=function(i){return this.value[i]},this.set=function(i,a){this.value[i]=a},this.copy=function(i,a){this.value[i]=this.value[i]};break;case 2:this.get=function(i,a){var o=this.value;return a[0]=o[i*2],a[1]=o[i*2+1],a},this.set=function(i,a){var o=this.value;o[i*2]=a[0],o[i*2+1]=a[1]},this.copy=function(i,a){var o=this.value;a*=2,i*=2,o[i]=o[a],o[i+1]=o[a+1]};break;case 3:this.get=function(i,a){var o=i*3,s=this.value;return a[0]=s[o],a[1]=s[o+1],a[2]=s[o+2],a},this.set=function(i,a){var o=i*3,s=this.value;s[o]=a[0],s[o+1]=a[1],s[o+2]=a[2]},this.copy=function(i,a){var o=this.value;a*=3,i*=3,o[i]=o[a],o[i+1]=o[a+1],o[i+2]=o[a+2]};break;case 4:this.get=function(i,a){var o=this.value,s=i*4;return a[0]=o[s],a[1]=o[s+1],a[2]=o[s+2],a[3]=o[s+3],a},this.set=function(i,a){var o=this.value,s=i*4;o[s]=a[0],o[s+1]=a[1],o[s+2]=a[2],o[s+3]=a[3]},this.copy=function(i,a){var o=this.value;a*=4,i*=4,o[i]=o[a],o[i+1]=o[a+1],o[i+2]=o[a+2],o[i+3]=o[a+3]}}}Sf.prototype.init=function(e){if(!this.value||this.value.length!==e*this.size){var t=Ok(this.type);this.value=new t(e*this.size)}};Sf.prototype.fromArray=function(e){var t=Ok(this.type),r;if(e[0]&&e[0].length){var n=0,i=this.size;r=new t(e.length*i);for(var a=0;a<e.length;a++)for(var o=0;o<i;o++)r[n++]=e[a][o]}else r=new t(e);this.value=r};Sf.prototype.clone=function(e){var t=new Sf(this.name,this.type,this.size,this.semantic);return e&&console.warn("todo"),t};function Fk(e,t,r,n,i){this.name=e,this.type=t,this.buffer=r,this.size=n,this.semantic=i,this.symbol="",this.needsRemove=!1}function Bk(e){this.buffer=e,this.count=0}var qn=gn.extend(function(){return{attributes:{},indices:null,dynamic:!0,_enabledAttributes:null,__used:0}},function(){this._cache=new xf,this._attributeList=Object.keys(this.attributes),this.__vaoCache={}},{mainAttribute:"",pick:null,pickByRay:null,dirty:function(){for(var e=this.getEnabledAttributes(),t=0;t<e.length;t++)this.dirtyAttribute(e[t]);this.dirtyIndices(),this._enabledAttributes=null,this._cache.dirty("any")},dirtyIndices:function(){this._cache.dirtyAll("indices")},dirtyAttribute:function(e){this._cache.dirtyAll(e1(e)),this._cache.dirtyAll("attributes")},getTriangleIndices:function(e,t){if(e<this.triangleCount&&e>=0){t||(t=[]);var r=this.indices;return t[0]=r[e*3],t[1]=r[e*3+1],t[2]=r[e*3+2],t}},setTriangleIndices:function(e,t){var r=this.indices;r[e*3]=t[0],r[e*3+1]=t[1],r[e*3+2]=t[2]},isUseIndices:function(){return!!this.indices},initIndicesFromArray:function(e){var t,r=this.vertexCount>65535?Ze.Uint32Array:Ze.Uint16Array;if(e[0]&&e[0].length){var n=0,i=3;t=new r(e.length*i);for(var a=0;a<e.length;a++)for(var o=0;o<i;o++)t[n++]=e[a][o]}else t=new r(e);this.indices=t},createAttribute:function(e,t,r,n){var i=new Sf(e,t,r,n);return this.attributes[e]&&this.removeAttribute(e),this.attributes[e]=i,this._attributeList.push(e),i},removeAttribute:function(e){var t=this._attributeList,r=t.indexOf(e);return r>=0?(t.splice(r,1),delete this.attributes[e],!0):!1},getAttribute:function(e){return this.attributes[e]},getEnabledAttributes:function(){var e=this._enabledAttributes,t=this._attributeList;if(e)return e;for(var r=[],n=this.vertexCount,i=0;i<t.length;i++){var a=t[i],o=this.attributes[a];o.value&&o.value.length===n*o.size&&r.push(a)}return this._enabledAttributes=r,r},getBufferChunks:function(e){var t=this._cache;t.use(e.__uid__);var r=t.isDirty("attributes"),n=t.isDirty("indices");if(r||n){this._updateBuffer(e.gl,r,n);for(var i=this.getEnabledAttributes(),a=0;a<i.length;a++)t.fresh(e1(i[a]));t.fresh("attributes"),t.fresh("indices")}return t.fresh("any"),t.get("chunks")},_updateBuffer:function(e,t,r){var n=this._cache,i=n.get("chunks"),a=!1;i||(i=[],i[0]={attributeBuffers:[],indicesBuffer:null},n.put("chunks",i),a=!0);var o=i[0],s=o.attributeBuffers,l=o.indicesBuffer;if(t||a){var u=this.getEnabledAttributes(),h={};if(!a)for(var f=0;f<s.length;f++)h[s[f].name]=s[f];for(var c=0;c<u.length;c++){var d=u[c],v=this.attributes[d],p;a||(p=h[d]);var g;p?g=p.buffer:g=e.createBuffer(),n.isDirty(e1(d))&&(e.bindBuffer(e.ARRAY_BUFFER,g),e.bufferData(e.ARRAY_BUFFER,v.value,this.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW)),s[c]=new Fk(d,v.type,g,v.size,v.semantic)}for(var f=c;f<s.length;f++)e.deleteBuffer(s[f].buffer);s.length=c}this.isUseIndices()&&(r||a)&&(l||(l=new Bk(e.createBuffer()),o.indicesBuffer=l),l.count=this.indices.length,e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,l.buffer),e.bufferData(e.ELEMENT_ARRAY_BUFFER,this.indices,this.dynamic?e.DYNAMIC_DRAW:e.STATIC_DRAW))},dispose:function(e){var t=this._cache;t.use(e.__uid__);var r=t.get("chunks");if(r)for(var n=0;n<r.length;n++){for(var i=r[n],a=0;a<i.attributeBuffers.length;a++){var o=i.attributeBuffers[a];e.gl.deleteBuffer(o.buffer)}i.indicesBuffer&&e.gl.deleteBuffer(i.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var l in this.__vaoCache){var u=this.__vaoCache[l].vao;u&&s.deleteVertexArrayOES(u)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});Object.defineProperty&&(Object.defineProperty(qn.prototype,"vertexCount",{enumerable:!1,get:function(){var e=this.attributes[this.mainAttribute];return e||(e=this.attributes[this._attributeList[0]]),!e||!e.value?0:e.value.length/e.size}}),Object.defineProperty(qn.prototype,"triangleCount",{enumerable:!1,get:function(){var e=this.indices;return e?e.length/3:0}}));qn.STATIC_DRAW=mt.STATIC_DRAW;qn.DYNAMIC_DRAW=mt.DYNAMIC_DRAW;qn.STREAM_DRAW=mt.STREAM_DRAW;qn.AttributeBuffer=Fk;qn.IndicesBuffer=Bk;qn.Attribute=Sf;var In=W.create,yh=W.add,Tl=W.set,Da=qn.Attribute,Ce=qn.extend(function(){return{attributes:{position:new Da("position","float",3,"POSITION"),texcoord0:new Da("texcoord0","float",2,"TEXCOORD_0"),texcoord1:new Da("texcoord1","float",2,"TEXCOORD_1"),normal:new Da("normal","float",3,"NORMAL"),tangent:new Da("tangent","float",4,"TANGENT"),color:new Da("color","float",4,"COLOR"),weight:new Da("weight","float",3,"WEIGHT"),joint:new Da("joint","float",4,"JOINT"),barycentric:new Da("barycentric","float",3,null)},boundingBox:null}},{mainAttribute:"position",updateBoundingBox:function(){var e=this.boundingBox;e||(e=this.boundingBox=new vn);var t=this.attributes.position.value;if(t&&t.length){var r=e.min,n=e.max,i=r.array,a=n.array;W.set(i,t[0],t[1],t[2]),W.set(a,t[0],t[1],t[2]);for(var o=3;o<t.length;){var s=t[o++],l=t[o++],u=t[o++];s<i[0]&&(i[0]=s),l<i[1]&&(i[1]=l),u<i[2]&&(i[2]=u),s>a[0]&&(a[0]=s),l>a[1]&&(a[1]=l),u>a[2]&&(a[2]=u)}r._dirty=!0,n._dirty=!0}},generateVertexNormals:function(){if(this.vertexCount){var e=this.indices,t=this.attributes,r=t.position.value,n=t.normal.value;if(!n||n.length!==r.length)n=t.normal.value=new Ze.Float32Array(r.length);else for(var i=0;i<n.length;i++)n[i]=0;for(var a=In(),o=In(),s=In(),l=In(),u=In(),h=In(),f=e?e.length:this.vertexCount,c,d,v,p=0;p<f;){e?(c=e[p++],d=e[p++],v=e[p++]):(c=p++,d=p++,v=p++),Tl(a,r[c*3],r[c*3+1],r[c*3+2]),Tl(o,r[d*3],r[d*3+1],r[d*3+2]),Tl(s,r[v*3],r[v*3+1],r[v*3+2]),W.sub(l,a,o),W.sub(u,o,s),W.cross(h,l,u);for(var i=0;i<3;i++)n[c*3+i]=n[c*3+i]+h[i],n[d*3+i]=n[d*3+i]+h[i],n[v*3+i]=n[v*3+i]+h[i]}for(var i=0;i<n.length;)Tl(h,n[i],n[i+1],n[i+2]),W.normalize(h,h),n[i++]=h[0],n[i++]=h[1],n[i++]=h[2];this.dirty()}},generateFaceNormals:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.indices,t=this.attributes,r=t.position.value,n=t.normal.value,i=In(),a=In(),o=In(),s=In(),l=In(),u=In();n||(n=t.normal.value=new Float32Array(r.length));for(var h=e?e.length:this.vertexCount,f,c,d,v=0;v<h;){e?(f=e[v++],c=e[v++],d=e[v++]):(f=v++,c=v++,d=v++),Tl(i,r[f*3],r[f*3+1],r[f*3+2]),Tl(a,r[c*3],r[c*3+1],r[c*3+2]),Tl(o,r[d*3],r[d*3+1],r[d*3+2]),W.sub(s,i,a),W.sub(l,a,o),W.cross(u,s,l),W.normalize(u,u);for(var p=0;p<3;p++)n[f*3+p]=u[p],n[c*3+p]=u[p],n[d*3+p]=u[p]}this.dirty()}},generateTangents:function(){if(this.vertexCount){var e=this.vertexCount,t=this.attributes;t.tangent.value||(t.tangent.value=new Float32Array(e*4));var r=t.texcoord0.value,n=t.position.value,i=t.tangent.value,a=t.normal.value;if(!r){console.warn("Geometry without texcoords can't generate tangents.");return}for(var o=[],s=[],l=0;l<e;l++)o[l]=[0,0,0],s[l]=[0,0,0];for(var u=[0,0,0],h=[0,0,0],f=this.indices,c=f?f.length:this.vertexCount,d,v,p,l=0;l<c;){f?(d=f[l++],v=f[l++],p=f[l++]):(d=l++,v=l++,p=l++);var g=r[d*2],m=r[v*2],_=r[p*2],y=r[d*2+1],x=r[v*2+1],T=r[p*2+1],S=n[d*3],M=n[v*3],w=n[p*3],b=n[d*3+1],A=n[v*3+1],E=n[p*3+1],C=n[d*3+2],D=n[v*3+2],L=n[p*3+2],P=M-S,N=w-S,O=A-b,I=E-b,k=D-C,z=L-C,X=m-g,Y=_-g,$=x-y,H=T-y,Z=1/(X*H-$*Y);u[0]=(H*P-$*N)*Z,u[1]=(H*O-$*I)*Z,u[2]=(H*k-$*z)*Z,h[0]=(X*N-Y*P)*Z,h[1]=(X*I-Y*O)*Z,h[2]=(X*z-Y*k)*Z,yh(o[d],o[d],u),yh(o[v],o[v],u),yh(o[p],o[p],u),yh(s[d],s[d],h),yh(s[v],s[v],h),yh(s[p],s[p],h)}for(var ct=In(),ut=In(),tt=In(),l=0;l<e;l++){tt[0]=a[l*3],tt[1]=a[l*3+1],tt[2]=a[l*3+2];var et=o[l];W.scale(ct,tt,W.dot(tt,et)),W.sub(ct,et,ct),W.normalize(ct,ct),W.cross(ut,tt,et),i[l*4]=ct[0],i[l*4+1]=ct[1],i[l*4+2]=ct[2],i[l*4+3]=W.dot(ut,s[l])<0?-1:1}this.dirty()}},isUniqueVertex:function(){return this.isUseIndices()?this.vertexCount===this.indices.length:!0},generateUniqueVertex:function(){if(!(!this.vertexCount||!this.indices)){this.indices.length>65535&&(this.indices=new Ze.Uint32Array(this.indices));for(var e=this.attributes,t=this.indices,r=this.getEnabledAttributes(),n={},i=0;i<r.length;i++){var a=r[i];n[a]=e[a].value,e[a].init(this.indices.length)}for(var o=0,s=0;s<t.length;s++){for(var l=t[s],i=0;i<r.length;i++)for(var a=r[i],u=e[a].value,h=e[a].size,f=0;f<h;f++)u[o*h+f]=n[a][l*h+f];t[s]=o,o++}this.dirty()}},generateBarycentric:function(){if(this.vertexCount){this.isUniqueVertex()||this.generateUniqueVertex();var e=this.attributes,t=e.barycentric.value,r=this.indices;if(!(t&&t.length===r.length*3)){t=e.barycentric.value=new Float32Array(r.length*3);for(var n=0;n<(r?r.length:this.vertexCount/3);)for(var i=0;i<3;i++){var a=r?r[n++]:n*3+i;t[a*3+i]=1}this.dirty()}}},applyTransform:function(e){var t=this.attributes,r=t.position.value,n=t.normal.value,i=t.tangent.value;e=e.array;var a=xt.create();xt.invert(a,e),xt.transpose(a,a);var o=W.transformMat4,s=W.forEach;s(r,3,0,null,o,e),n&&s(n,3,0,null,o,a),i&&s(i,4,0,null,o,a),this.boundingBox&&this.updateBoundingBox()},dispose:function(e){var t=this._cache;t.use(e.__uid__);var r=t.get("chunks");if(r)for(var n=0;n<r.length;n++){for(var i=r[n],a=0;a<i.attributeBuffers.length;a++){var o=i.attributeBuffers[a];e.gl.deleteBuffer(o.buffer)}i.indicesBuffer&&e.gl.deleteBuffer(i.indicesBuffer.buffer)}if(this.__vaoCache){var s=e.getGLExtension("OES_vertex_array_object");for(var l in this.__vaoCache){var u=this.__vaoCache[l].vao;u&&s.deleteVertexArrayOES(u)}}this.__vaoCache={},t.deleteContext(e.__uid__)}});Ce.STATIC_DRAW=qn.STATIC_DRAW;Ce.DYNAMIC_DRAW=qn.DYNAMIC_DRAW;Ce.STREAM_DRAW=qn.STREAM_DRAW;Ce.AttributeBuffer=qn.AttributeBuffer;Ce.IndicesBuffer=qn.IndicesBuffer;Ce.Attribute=Da;const kit=`vec3 calcAmbientSHLight(int idx, vec3 N) {
 int offset = 9 * idx;
 return ambientSHLightCoefficients[0]
 + ambientSHLightCoefficients[1] * N.x
 + ambientSHLightCoefficients[2] * N.y
 + ambientSHLightCoefficients[3] * N.z
 + ambientSHLightCoefficients[4] * N.x * N.z
 + ambientSHLightCoefficients[5] * N.z * N.y
 + ambientSHLightCoefficients[6] * N.y * N.x
 + ambientSHLightCoefficients[7] * (3.0 * N.z * N.z - 1.0)
 + ambientSHLightCoefficients[8] * (N.x * N.x - N.y * N.y);
}`;var ta="uniform vec3 ",Gc="uniform float ",xh="@export clay.header.",Sh="@end",fn=":unconfigurable;";const Git=[xh+"directional_light",ta+"directionalLightDirection[DIRECTIONAL_LIGHT_COUNT]"+fn,ta+"directionalLightColor[DIRECTIONAL_LIGHT_COUNT]"+fn,Sh,xh+"ambient_light",ta+"ambientLightColor[AMBIENT_LIGHT_COUNT]"+fn,Sh,xh+"ambient_sh_light",ta+"ambientSHLightColor[AMBIENT_SH_LIGHT_COUNT]"+fn,ta+"ambientSHLightCoefficients[AMBIENT_SH_LIGHT_COUNT * 9]"+fn,kit,Sh,xh+"ambient_cubemap_light",ta+"ambientCubemapLightColor[AMBIENT_CUBEMAP_LIGHT_COUNT]"+fn,"uniform samplerCube ambientCubemapLightCubemap[AMBIENT_CUBEMAP_LIGHT_COUNT]"+fn,"uniform sampler2D ambientCubemapLightBRDFLookup[AMBIENT_CUBEMAP_LIGHT_COUNT]"+fn,Sh,xh+"point_light",ta+"pointLightPosition[POINT_LIGHT_COUNT]"+fn,Gc+"pointLightRange[POINT_LIGHT_COUNT]"+fn,ta+"pointLightColor[POINT_LIGHT_COUNT]"+fn,Sh,xh+"spot_light",ta+"spotLightPosition[SPOT_LIGHT_COUNT]"+fn,ta+"spotLightDirection[SPOT_LIGHT_COUNT]"+fn,Gc+"spotLightRange[SPOT_LIGHT_COUNT]"+fn,Gc+"spotLightUmbraAngleCosine[SPOT_LIGHT_COUNT]"+fn,Gc+"spotLightPenumbraAngleCosine[SPOT_LIGHT_COUNT]"+fn,Gc+"spotLightFalloffFactor[SPOT_LIGHT_COUNT]"+fn,ta+"spotLightColor[SPOT_LIGHT_COUNT]"+fn,Sh].join(`
`);Et.import(Git);var xa=Wa.extend(function(){return{color:[1,1,1],intensity:1,castShadow:!0,shadowResolution:512,group:0}},{type:"",clone:function(){var e=Wa.prototype.clone.call(this);return e.color=Array.prototype.slice.call(this.color),e.intensity=this.intensity,e.castShadow=this.castShadow,e.shadowResolution=this.shadowResolution,e}}),Rd=function(e,t){this.normal=e||new ht(0,1,0),this.distance=t||0};Rd.prototype={constructor:Rd,distanceToPoint:function(e){return W.dot(e.array,this.normal.array)-this.distance},projectPoint:function(e,t){t||(t=new ht);var r=this.distanceToPoint(e);return W.scaleAndAdd(t.array,e.array,this.normal.array,-r),t._dirty=!0,t},normalize:function(){var e=1/W.len(this.normal.array);W.scale(this.normal.array,e),this.distance*=e},intersectFrustum:function(e){for(var t=e.vertices,r=this.normal.array,n=W.dot(t[0].array,r)>this.distance,i=1;i<8;i++)if(W.dot(t[i].array,r)>this.distance!=n)return!0},intersectLine:function(){var e=W.create();return function(t,r,n){var i=this.distanceToPoint(t),a=this.distanceToPoint(r);if(i>0&&a>0||i<0&&a<0)return null;var o=this.normal.array,s=this.distance,l=t.array;W.sub(e,r.array,t.array),W.normalize(e,e);var u=W.dot(o,e);if(u===0)return null;n||(n=new ht);var h=(W.dot(o,l)-s)/u;return W.scaleAndAdd(n.array,l,e,-h),n._dirty=!0,n}}(),applyTransform:function(){var e=xt.create(),t=yt.create(),r=yt.create();return r[3]=1,function(n){n=n.array,W.scale(r,this.normal.array,this.distance),yt.transformMat4(r,r,n),this.distance=W.dot(r,this.normal.array),xt.invert(e,n),xt.transpose(e,e),t[3]=0,W.copy(t,this.normal.array),yt.transformMat4(t,t,e),W.copy(this.normal.array,t)}}(),copy:function(e){W.copy(this.normal.array,e.normal.array),this.normal._dirty=!0,this.distance=e.distance},clone:function(){var e=new Rd;return e.copy(this),e}};var Cr=W.set,aI=W.copy,oI=W.transformMat4,r1=Math.min,n1=Math.max,l0=function(){this.planes=[];for(var e=0;e<6;e++)this.planes.push(new Rd);this.boundingBox=new vn,this.vertices=[];for(var e=0;e<8;e++)this.vertices[e]=W.fromValues(0,0,0)};l0.prototype={setFromProjection:function(e){var t=this.planes,r=e.array,n=r[0],i=r[1],a=r[2],o=r[3],s=r[4],l=r[5],u=r[6],h=r[7],f=r[8],c=r[9],d=r[10],v=r[11],p=r[12],g=r[13],m=r[14],_=r[15];Cr(t[0].normal.array,o-n,h-s,v-f),t[0].distance=-(_-p),t[0].normalize(),Cr(t[1].normal.array,o+n,h+s,v+f),t[1].distance=-(_+p),t[1].normalize(),Cr(t[2].normal.array,o+i,h+l,v+c),t[2].distance=-(_+g),t[2].normalize(),Cr(t[3].normal.array,o-i,h-l,v-c),t[3].distance=-(_-g),t[3].normalize(),Cr(t[4].normal.array,o-a,h-u,v-d),t[4].distance=-(_-m),t[4].normalize(),Cr(t[5].normal.array,o+a,h+u,v+d),t[5].distance=-(_+m),t[5].normalize();var y=this.boundingBox,x=this.vertices;if(_===0){var T=l/n,S=-m/(d-1),M=-m/(d+1),w=-M/l,b=-S/l;y.min.set(-w*T,-w,M),y.max.set(w*T,w,S),Cr(x[0],-w*T,-w,M),Cr(x[1],-w*T,w,M),Cr(x[2],w*T,-w,M),Cr(x[3],w*T,w,M),Cr(x[4],-b*T,-b,S),Cr(x[5],-b*T,b,S),Cr(x[6],b*T,-b,S),Cr(x[7],b*T,b,S)}else{var A=(-1-p)/n,E=(1-p)/n,C=(1-g)/l,D=(-1-g)/l,L=(-1-m)/d,P=(1-m)/d;y.min.set(Math.min(A,E),Math.min(D,C),Math.min(P,L)),y.max.set(Math.max(E,A),Math.max(C,D),Math.max(L,P));var N=y.min.array,O=y.max.array;Cr(x[0],N[0],N[1],N[2]),Cr(x[1],N[0],O[1],N[2]),Cr(x[2],O[0],N[1],N[2]),Cr(x[3],O[0],O[1],N[2]),Cr(x[4],N[0],N[1],O[2]),Cr(x[5],N[0],O[1],O[2]),Cr(x[6],O[0],N[1],O[2]),Cr(x[7],O[0],O[1],O[2])}},getTransformedBoundingBox:function(){var e=W.create();return function(t,r){var n=this.vertices,i=r.array,a=t.min,o=t.max,s=a.array,l=o.array,u=n[0];oI(e,u,i),aI(s,e),aI(l,e);for(var h=1;h<8;h++)u=n[h],oI(e,u,i),s[0]=r1(e[0],s[0]),s[1]=r1(e[1],s[1]),s[2]=r1(e[2],s[2]),l[0]=n1(e[0],l[0]),l[1]=n1(e[1],l[1]),l[2]=n1(e[2],l[2]);return a._dirty=!0,o._dirty=!0,t}}()};var Tf=Wa.extend(function(){return{projectionMatrix:new Nt,invProjectionMatrix:new Nt,viewMatrix:new Nt,frustum:new l0}},function(){this.update(!0)},{update:function(e){Wa.prototype.update.call(this,e),Nt.invert(this.viewMatrix,this.worldTransform),this.updateProjectionMatrix(),Nt.invert(this.invProjectionMatrix,this.projectionMatrix),this.frustum.setFromProjection(this.projectionMatrix)},setViewMatrix:function(e){Nt.copy(this.viewMatrix,e),Nt.invert(this.worldTransform,e),this.decomposeWorldTransform()},decomposeProjectionMatrix:function(){},setProjectionMatrix:function(e){Nt.copy(this.projectionMatrix,e),Nt.invert(this.invProjectionMatrix,e),this.decomposeProjectionMatrix()},updateProjectionMatrix:function(){},castRay:function(){var e=yt.create();return function(t,r){var n=r!==void 0?r:new mu,i=t.array[0],a=t.array[1];return yt.set(e,i,a,-1,1),yt.transformMat4(e,e,this.invProjectionMatrix.array),yt.transformMat4(e,e,this.worldTransform.array),W.scale(n.origin.array,e,1/e[3]),yt.set(e,i,a,1,1),yt.transformMat4(e,e,this.invProjectionMatrix.array),yt.transformMat4(e,e,this.worldTransform.array),W.scale(e,e,1/e[3]),W.sub(n.direction.array,e,n.origin.array),W.normalize(n.direction.array,n.direction.array),n.direction._dirty=!0,n.origin._dirty=!0,n}}()}),Vit=xt.create(),sI=xt.create(),i1={};function Hit(e){var t=[],r=Object.keys(e);r.sort();for(var n=0;n<r.length;n++){var i=r[n];t.push(i+" "+e[i])}var a=t.join(`
`);if(i1[a])return i1[a];var o=Lr.genGUID();return i1[a]=o,o}function u0(){this.opaque=[],this.transparent=[],this._opaqueCount=0,this._transparentCount=0}u0.prototype.startCount=function(){this._opaqueCount=0,this._transparentCount=0};u0.prototype.add=function(e,t){t?this.transparent[this._transparentCount++]=e:this.opaque[this._opaqueCount++]=e};u0.prototype.endCount=function(){this.transparent.length=this._transparentCount,this.opaque.length=this._opaqueCount};var Xs=Wa.extend(function(){return{material:null,lights:[],viewBoundingBoxLastFrame:new vn,shadowUniforms:{},_cameraList:[],_lightUniforms:{},_previousLightNumber:{},_lightNumber:{},_lightProgramKeys:{},_nodeRepository:{},_renderLists:new Xu(20)}},function(){this._scene=this},{addToScene:function(e){e instanceof Tf?(this._cameraList.length>0&&console.warn("Found multiple camera in one scene. Use the fist one."),this._cameraList.push(e)):e instanceof xa&&this.lights.push(e),e.name&&(this._nodeRepository[e.name]=e)},removeFromScene:function(e){var t;e instanceof Tf?(t=this._cameraList.indexOf(e),t>=0&&this._cameraList.splice(t,1)):e instanceof xa&&(t=this.lights.indexOf(e),t>=0&&this.lights.splice(t,1)),e.name&&delete this._nodeRepository[e.name]},getNode:function(e){return this._nodeRepository[e]},setMainCamera:function(e){var t=this._cameraList.indexOf(e);t>=0&&this._cameraList.splice(t,1),this._cameraList.unshift(e)},getMainCamera:function(){return this._cameraList[0]},getLights:function(){return this.lights},updateLights:function(){var e=this.lights;this._previousLightNumber=this._lightNumber;for(var t={},r=0;r<e.length;r++){var n=e[r];if(!n.invisible){var i=n.group;t[i]||(t[i]={}),t[i][n.type]=t[i][n.type]||0,t[i][n.type]++}}this._lightNumber=t;for(var a in t)this._lightProgramKeys[a]=Hit(t[a]);this._updateLightUniforms()},cloneNode:function(e){var t=e.clone(),r={};function n(i,a){r[i.__uid__]=a;for(var o=0;o<i._children.length;o++){var s=i._children[o],l=a._children[o];n(s,l)}}return n(e,t),t.traverse(function(i){i.skeleton&&(i.skeleton=i.skeleton.clone(r)),i.material&&(i.material=i.material.clone())}),t},updateRenderList:function(e,t){var r=e.__uid__,n=this._renderLists.get(r);n||(n=new u0,this._renderLists.put(r,n)),n.startCount(),t&&(this.viewBoundingBoxLastFrame.min.set(1/0,1/0,1/0),this.viewBoundingBoxLastFrame.max.set(-1/0,-1/0,-1/0));var i=this.material&&this.material.transparent||!1;return this._doUpdateRenderList(this,e,i,n,t),n.endCount(),n},getRenderList:function(e){return this._renderLists.get(e.__uid__)},_doUpdateRenderList:function(e,t,r,n,i){if(!e.invisible)for(var a=0;a<e._children.length;a++){var o=e._children[a];if(o.isRenderable()){var s=o.isSkinnedMesh()?Vit:o.worldTransform.array,l=o.geometry;xt.multiplyAffine(sI,t.viewMatrix.array,s),(i&&!l.boundingBox||!this.isFrustumCulled(o,t,sI))&&n.add(o,o.material.transparent||r)}o._children.length>0&&this._doUpdateRenderList(o,t,r,n,i)}},isFrustumCulled:function(){var e=new vn,t=new Nt;return function(r,n,i){var a=r.boundingBox;if(a||(r.skeleton&&r.skeleton.boundingBox?a=r.skeleton.boundingBox:a=r.geometry.boundingBox),!a)return!1;if(t.array=i,e.transformFrom(a,t),r.castShadow&&this.viewBoundingBoxLastFrame.union(e),r.frustumCulling){if(!e.intersectBoundingBox(n.frustum.boundingBox))return!0;t.array=n.projectionMatrix.array,e.max.array[2]>0&&e.min.array[2]<0&&(e.max.array[2]=-1e-20),e.applyProjection(t);var o=e.min.array,s=e.max.array;if(s[0]<-1||o[0]>1||s[1]<-1||o[1]>1||s[2]<-1||o[2]>1)return!0}return!1}}(),_updateLightUniforms:function(){var e=this.lights;e.sort(Wit);var t=this._lightUniforms;for(var r in t)for(var n in t[r])t[r][n].value.length=0;for(var i=0;i<e.length;i++){var a=e[i];if(!a.invisible){var r=a.group;for(var n in a.uniformTemplates){var o=a.uniformTemplates[n],s=o.value(a);if(s!=null){t[r]||(t[r]={}),t[r][n]||(t[r][n]={type:"",value:[]});var l=t[r][n];switch(l.type=o.type+"v",o.type){case"1i":case"1f":case"t":l.value.push(s);break;case"2f":case"3f":case"4f":for(var u=0;u<s.length;u++)l.value.push(s[u]);break;default:console.error("Unkown light uniform type "+o.type)}}}}}},getLightGroups:function(){var e=[];for(var t in this._lightNumber)e.push(t);return e},getNumberChangedLightGroups:function(){var e=[];for(var t in this._lightNumber)this.isLightNumberChanged(t)&&e.push(t);return e},isLightNumberChanged:function(e){var t=this._previousLightNumber,r=this._lightNumber;for(var n in r[e])if(!t[e]||r[e][n]!==t[e][n])return!0;for(var n in t[e])if(!r[e]||r[e][n]!==t[e][n])return!0;return!1},getLightsNumbers:function(e){return this._lightNumber[e]},getProgramKey:function(e){return this._lightProgramKeys[e]},setLightUniforms:function(){function e(t,r,n){for(var i in t){var a=t[i];if(a.type==="tv"){if(!r.hasUniform(i))continue;for(var o=[],s=0;s<a.value.length;s++){var l=a.value[s],u=r.takeCurrentTextureSlot(n,l);o.push(u)}r.setUniform(n.gl,"1iv",i,o)}else r.setUniform(n.gl,a.type,i,a.value)}}return function(t,r,n){e(this._lightUniforms[r],t,n),e(this.shadowUniforms,t,n)}}(),dispose:function(){this.material=null,this._opaqueList=[],this._transparentList=[],this.lights=[],this._lightUniforms={},this._lightNumber={},this._nodeRepository={}}});function Wit(e,t){if(t.castShadow&&!e.castShadow)return!0}var rg=Uv.isPowerOfTwo,Xit=["px","nx","py","ny","pz","nz"],Du=Mt.extend(function(){return{image:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},pixels:{px:null,nx:null,py:null,ny:null,pz:null,nz:null},mipmaps:[]}},{textureType:"textureCube",update:function(e){var t=e.gl;t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),this.updateCommon(e);var r=this.format,n=this.type;t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_S,this.getAvailableWrapS()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_WRAP_T,this.getAvailableWrapT()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MAG_FILTER,this.getAvailableMagFilter()),t.texParameteri(t.TEXTURE_CUBE_MAP,t.TEXTURE_MIN_FILTER,this.getAvailableMinFilter());var i=e.getGLExtension("EXT_texture_filter_anisotropic");if(i&&this.anisotropic>1&&t.texParameterf(t.TEXTURE_CUBE_MAP,i.TEXTURE_MAX_ANISOTROPY_EXT,this.anisotropic),n===36193){var a=e.getGLExtension("OES_texture_half_float");a||(n=mt.FLOAT)}if(this.mipmaps.length)for(var o=this.width,s=this.height,l=0;l<this.mipmaps.length;l++){var u=this.mipmaps[l];this._updateTextureData(t,u,l,o,s,r,n),o/=2,s/=2}else this._updateTextureData(t,this,0,this.width,this.height,r,n),!this.NPOT&&this.useMipmap&&t.generateMipmap(t.TEXTURE_CUBE_MAP);t.bindTexture(t.TEXTURE_CUBE_MAP,null)},_updateTextureData:function(e,t,r,n,i,a,o){for(var s=0;s<6;s++){var l=Xit[s],u=t.image&&t.image[l];u?e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,r,a,a,o,u):e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+s,r,a,n,i,0,a,o,t.pixels&&t.pixels[l])}},generateMipmap:function(e){var t=e.gl;this.useMipmap&&!this.NPOT&&(t.bindTexture(t.TEXTURE_CUBE_MAP,this._cache.get("webgl_texture")),t.generateMipmap(t.TEXTURE_CUBE_MAP))},bind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,this.getWebGLTexture(e))},unbind:function(e){e.gl.bindTexture(e.gl.TEXTURE_CUBE_MAP,null)},isPowerOfTwo:function(){return this.image.px?rg(this.image.px.width)&&rg(this.image.px.height):rg(this.width)&&rg(this.height)},isRenderable:function(){return this.image.px?Th(this.image.px)&&Th(this.image.nx)&&Th(this.image.py)&&Th(this.image.ny)&&Th(this.image.pz)&&Th(this.image.nz):!!(this.width&&this.height)},load:function(e,t){var r=0,n=this;return Lr.each(e,function(i,a){var o=Ze.createImage();t&&(o.crossOrigin=t),o.onload=function(){r--,r===0&&(n.dirty(),n.trigger("success",n))},o.onerror=function(){r--},r++,o.src=i,n.image[a]=o}),this}});Object.defineProperty(Du.prototype,"width",{get:function(){return this.image&&this.image.px?this.image.px.width:this._width},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set width"):(this._width!==e&&this.dirty(),this._width=e)}});Object.defineProperty(Du.prototype,"height",{get:function(){return this.image&&this.image.px?this.image.px.height:this._height},set:function(e){this.image&&this.image.px?console.warn("Texture from image can't set height"):(this._height!==e&&this.dirty(),this._height=e)}});function Th(e){return e.width>0&&e.height>0}var Kr=Tf.extend({fov:50,aspect:1,near:.1,far:2e3},{updateProjectionMatrix:function(){var e=this.fov/180*Math.PI;this.projectionMatrix.perspective(e,this.aspect,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array,t=Math.atan(1/e[5])*2;this.fov=t/Math.PI*180,this.aspect=e[5]/e[0],this.near=e[14]/(e[10]-1),this.far=e[14]/(e[10]+1)},clone:function(){var e=Tf.prototype.clone.call(this);return e.fov=this.fov,e.aspect=this.aspect,e.near=this.near,e.far=this.far,e}}),ng="framebuffer",mo="renderbuffer",lI=mo+"_width",uI=mo+"_height",a1=mo+"_attached",o1="depthtexture_attached",bl=mt.FRAMEBUFFER,Vc=mt.RENDERBUFFER,hd=mt.DEPTH_ATTACHMENT,Uk=mt.COLOR_ATTACHMENT0,Ir=gn.extend({depthBuffer:!0,viewport:null,_width:0,_height:0,_textures:null,_boundRenderer:null},function(){this._cache=new xf,this._textures={}},{getTextureWidth:function(){return this._width},getTextureHeight:function(){return this._height},bind:function(e){if(e.__currentFrameBuffer){if(e.__currentFrameBuffer===this)return;console.warn("Renderer already bound with another framebuffer. Unbind it first")}e.__currentFrameBuffer=this;var t=e.gl;t.bindFramebuffer(bl,this._getFrameBufferGL(e)),this._boundRenderer=e;var r=this._cache;r.put("viewport",e.viewport);var n=!1,i,a;for(var o in this._textures){n=!0;var s=this._textures[o];s&&(i=s.texture.width,a=s.texture.height,this._doAttach(e,s.texture,o,s.target))}this._width=i,this._height=a,!n&&this.depthBuffer&&console.error("Must attach texture before bind, or renderbuffer may have incorrect width and height."),this.viewport?e.setViewport(this.viewport):e.setViewport(0,0,i,a,1);var l=r.get("attached_textures");if(l){for(var o in l)if(!this._textures[o]){var u=l[o];this._doDetach(t,o,u)}}if(!r.get(o1)&&this.depthBuffer){r.miss(mo)&&r.put(mo,t.createRenderbuffer());var h=r.get(mo);(i!==r.get(lI)||a!==r.get(uI))&&(t.bindRenderbuffer(Vc,h),t.renderbufferStorage(Vc,t.DEPTH_COMPONENT16,i,a),r.put(lI,i),r.put(uI,a),t.bindRenderbuffer(Vc,null)),r.get(a1)||(t.framebufferRenderbuffer(bl,hd,Vc,h),r.put(a1,!0))}},unbind:function(e){e.__currentFrameBuffer=null;var t=e.gl;t.bindFramebuffer(bl,null),this._boundRenderer=null,this._cache.use(e.__uid__);var r=this._cache.get("viewport");r&&e.setViewport(r),this.updateMipmap(e)},updateMipmap:function(e){var t=e.gl;for(var r in this._textures){var n=this._textures[r];if(n){var i=n.texture;if(!i.NPOT&&i.useMipmap&&i.minFilter===Mt.LINEAR_MIPMAP_LINEAR){var a=i.textureType==="textureCube"?mt.TEXTURE_CUBE_MAP:mt.TEXTURE_2D;t.bindTexture(a,i.getWebGLTexture(e)),t.generateMipmap(a),t.bindTexture(a,null)}}}},checkStatus:function(e){return e.checkFramebufferStatus(bl)},_getFrameBufferGL:function(e){var t=this._cache;return t.use(e.__uid__),t.miss(ng)&&t.put(ng,e.gl.createFramebuffer()),t.get(ng)},attach:function(e,t,r){if(!e.width)throw new Error("The texture attached to color buffer is not a valid.");t=t||Uk,r=r||mt.TEXTURE_2D;var n=this._boundRenderer,i=n&&n.gl,a;if(i){var o=this._cache;o.use(n.__uid__),a=o.get("attached_textures")}var s=this._textures[t];if(!(s&&s.target===r&&s.texture===e&&a&&a[t]!=null)){var l=!0;n&&(l=this._doAttach(n,e,t,r),this.viewport||n.setViewport(0,0,e.width,e.height,1)),l&&(this._textures[t]=this._textures[t]||{},this._textures[t].texture=e,this._textures[t].target=r)}},_doAttach:function(e,t,r,n){var i=e.gl,a=t.getWebGLTexture(e),o=this._cache.get("attached_textures");if(o&&o[r]){var s=o[r];if(s.texture===t&&s.target===n)return}r=+r;var l=!0;if(r===hd||r===mt.DEPTH_STENCIL_ATTACHMENT){var u=e.getGLExtension("WEBGL_depth_texture");if(u||(console.error("Depth texture is not supported by the browser"),l=!1),t.format!==mt.DEPTH_COMPONENT&&t.format!==mt.DEPTH_STENCIL&&(console.error("The texture attached to depth buffer is not a valid."),l=!1),l){var h=this._cache.get(mo);h&&(i.framebufferRenderbuffer(bl,hd,Vc,null),i.deleteRenderbuffer(h),this._cache.put(mo,!1)),this._cache.put(a1,!1),this._cache.put(o1,!0)}}return i.framebufferTexture2D(bl,r,n,a,0),o||(o={},this._cache.put("attached_textures",o)),o[r]=o[r]||{},o[r].texture=t,o[r].target=n,l},_doDetach:function(e,t,r){e.framebufferTexture2D(bl,t,r,null,0);var n=this._cache.get("attached_textures");n&&n[t]&&(n[t]=null),(t===hd||t===mt.DEPTH_STENCIL_ATTACHMENT)&&this._cache.put(o1,!1)},detach:function(e,t){if(this._textures[e]=null,this._boundRenderer){var r=this._cache;r.use(this._boundRenderer.__uid__),this._doDetach(this._boundRenderer.gl,e,t)}},dispose:function(e){var t=e.gl,r=this._cache;r.use(e.__uid__);var n=r.get(mo);n&&t.deleteRenderbuffer(n);var i=r.get(ng);i&&t.deleteFramebuffer(i),r.deleteContext(e.__uid__),this._textures={}}});Ir.DEPTH_ATTACHMENT=hd;Ir.COLOR_ATTACHMENT0=Uk;Ir.STENCIL_ATTACHMENT=mt.STENCIL_ATTACHMENT;Ir.DEPTH_STENCIL_ATTACHMENT=mt.DEPTH_STENCIL_ATTACHMENT;var Yit=["px","nx","py","ny","pz","nz"],nA=gn.extend(function(){var e={position:new ht,far:1e3,near:.1,texture:null,shadowMapPass:null},t=e._cameras={px:new Kr({fov:90}),nx:new Kr({fov:90}),py:new Kr({fov:90}),ny:new Kr({fov:90}),pz:new Kr({fov:90}),nz:new Kr({fov:90})};return t.px.lookAt(ht.POSITIVE_X,ht.NEGATIVE_Y),t.nx.lookAt(ht.NEGATIVE_X,ht.NEGATIVE_Y),t.py.lookAt(ht.POSITIVE_Y,ht.POSITIVE_Z),t.ny.lookAt(ht.NEGATIVE_Y,ht.NEGATIVE_Z),t.pz.lookAt(ht.POSITIVE_Z,ht.NEGATIVE_Y),t.nz.lookAt(ht.NEGATIVE_Z,ht.NEGATIVE_Y),e._frameBuffer=new Ir,e},{getCamera:function(e){return this._cameras[e]},render:function(e,t,r){var n=e.gl;r||t.update();for(var i=this.texture.width,a=2*Math.atan(i/(i-.5))/Math.PI*180,o=0;o<6;o++){var s=Yit[o],l=this._cameras[s];if(ht.copy(l.position,this.position),l.far=this.far,l.near=this.near,l.fov=a,this.shadowMapPass){l.update();var u=t.getBoundingBox();u.applyTransform(l.viewMatrix),t.viewBoundingBoxLastFrame.copy(u),this.shadowMapPass.render(e,t,l,!0)}this._frameBuffer.attach(this.texture,n.COLOR_ATTACHMENT0,n.TEXTURE_CUBE_MAP_POSITIVE_X+o),this._frameBuffer.bind(e),e.render(t,l,!0),this._frameBuffer.unbind(e)}},dispose:function(e){this._frameBuffer.dispose(e)}}),h0=Ce.extend({dynamic:!1,widthSegments:1,heightSegments:1},function(){this.build()},{build:function(){for(var e=this.heightSegments,t=this.widthSegments,r=this.attributes,n=[],i=[],a=[],o=[],s=0;s<=e;s++)for(var l=s/e,u=0;u<=t;u++){var h=u/t;if(n.push([2*h-1,2*l-1,0]),i.push([h,l]),a.push([0,0,1]),u<t&&s<e){var f=u+s*(t+1);o.push([f,f+1,f+t+1]),o.push([f+t+1,f+1,f+t+2])}}r.position.fromArray(n),r.texcoord0.fromArray(i),r.normal.fromArray(a),this.initIndicesFromArray(o),this.boundingBox=new vn,this.boundingBox.min.set(-1,-1,0),this.boundingBox.max.set(1,1,0)}}),br=new Nt,zk=Ce.extend({dynamic:!1,widthSegments:1,heightSegments:1,depthSegments:1,inside:!1},function(){this.build()},{build:function(){var e={px:bh("px",this.depthSegments,this.heightSegments),nx:bh("nx",this.depthSegments,this.heightSegments),py:bh("py",this.widthSegments,this.depthSegments),ny:bh("ny",this.widthSegments,this.depthSegments),pz:bh("pz",this.widthSegments,this.heightSegments),nz:bh("nz",this.widthSegments,this.heightSegments)},t=["position","texcoord0","normal"],r=0,n=0;for(var i in e)r+=e[i].vertexCount,n+=e[i].indices.length;for(var a=0;a<t.length;a++)this.attributes[t[a]].init(r);this.indices=new Ze.Uint16Array(n);var o=0,s=0;for(var i in e){for(var l=e[i],a=0;a<t.length;a++)for(var u=t[a],h=l.attributes[u].value,f=l.attributes[u].size,c=u==="normal",d=0;d<h.length;d++){var v=h[d];this.inside&&c&&(v=-v),this.attributes[u].value[d+f*s]=v}for(var p=l.indices.length,d=0;d<l.indices.length;d++)this.indices[d+o]=s+l.indices[this.inside?p-d-1:d];o+=l.indices.length,s+=l.vertexCount}this.boundingBox=new vn,this.boundingBox.max.set(1,1,1),this.boundingBox.min.set(-1,-1,-1)}});function bh(e,t,r){br.identity();var n=new h0({widthSegments:t,heightSegments:r});switch(e){case"px":Nt.translate(br,br,ht.POSITIVE_X),Nt.rotateY(br,br,Math.PI/2);break;case"nx":Nt.translate(br,br,ht.NEGATIVE_X),Nt.rotateY(br,br,-Math.PI/2);break;case"py":Nt.translate(br,br,ht.POSITIVE_Y),Nt.rotateX(br,br,-Math.PI/2);break;case"ny":Nt.translate(br,br,ht.NEGATIVE_Y),Nt.rotateX(br,br,Math.PI/2);break;case"pz":Nt.translate(br,br,ht.POSITIVE_Z);break;case"nz":Nt.translate(br,br,ht.NEGATIVE_Z),Nt.rotateY(br,br,Math.PI);break}return n.applyTransform(br),n}const Zit=`@export clay.skybox.vertex
#define SHADER_NAME skybox
uniform mat4 world : WORLD;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
varying vec3 v_WorldPosition;
void main()
{
 v_WorldPosition = (world * vec4(position, 1.0)).xyz;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end
@export clay.skybox.fragment
#define PI 3.1415926
uniform mat4 viewInverse : VIEWINVERSE;
#ifdef EQUIRECTANGULAR
uniform sampler2D environmentMap;
#else
uniform samplerCube environmentMap;
#endif
uniform float lod: 0.0;
varying vec3 v_WorldPosition;
@import clay.util.rgbm
@import clay.util.srgb
@import clay.util.ACES
void main()
{
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(v_WorldPosition - eyePos);
#ifdef EQUIRECTANGULAR
 float phi = acos(V.y);
 float theta = atan(-V.x, V.z) + PI * 0.5;
 vec2 uv = vec2(theta / 2.0 / PI, phi / PI);
 vec4 texel = decodeHDR(texture2D(environmentMap, fract(uv)));
#else
 #if defined(LOD) || defined(SUPPORT_TEXTURE_LOD)
 vec4 texel = decodeHDR(textureCubeLodEXT(environmentMap, V, lod));
 #else
 vec4 texel = decodeHDR(textureCube(environmentMap, V));
 #endif
#endif
#ifdef SRGB_DECODE
 texel = sRGBToLinear(texel);
#endif
#ifdef TONEMAPPING
 texel.rgb = ACESToneMapping(texel.rgb);
#endif
#ifdef SRGB_ENCODE
 texel = linearTosRGB(texel);
#endif
 gl_FragColor = encodeHDR(vec4(texel.rgb, 1.0));
}
@end`;Et.import(Zit);var lv=Qr.extend(function(){var e=new Et({vertex:Et.source("clay.skybox.vertex"),fragment:Et.source("clay.skybox.fragment")}),t=new Vi({shader:e,depthMask:!1});return{scene:null,geometry:new zk,material:t,environmentMap:null,culling:!1,_dummyCamera:new Kr}},function(){var e=this.scene;e&&this.attachScene(e),this.environmentMap&&this.setEnvironmentMap(this.environmentMap)},{attachScene:function(e){this.scene&&this.detachScene(),e.skybox=this,this.scene=e,e.on("beforerender",this._beforeRenderScene,this)},detachScene:function(){this.scene&&(this.scene.off("beforerender",this._beforeRenderScene),this.scene.skybox=null),this.scene=null},dispose:function(e){this.detachScene(),this.geometry.dispose(e)},setEnvironmentMap:function(e){e.textureType==="texture2D"?(this.material.define("EQUIRECTANGULAR"),e.minFilter=Mt.LINEAR):this.material.undefine("EQUIRECTANGULAR"),this.material.set("environmentMap",e)},getEnvironmentMap:function(){return this.material.get("environmentMap")},_beforeRenderScene:function(e,t,r){this.renderSkybox(e,r)},renderSkybox:function(e,t){var r=this._dummyCamera;r.aspect=e.getViewportAspect(),r.fov=t.fov||50,r.updateProjectionMatrix(),Nt.invert(r.invProjectionMatrix,r.projectionMatrix),r.worldTransform.copy(t.worldTransform),r.viewMatrix.copy(t.viewMatrix),this.position.copy(t.getWorldPosition()),this.update(),e.gl.disable(e.gl.BLEND),this.material.get("lod")>0?this.material.define("fragment","LOD"):this.material.undefine("fragment","LOD"),e.renderPass([this],r)}}),qit=542327876,$it=131072,Kit=512,jit=4;function iA(e){return e.charCodeAt(0)+(e.charCodeAt(1)<<8)+(e.charCodeAt(2)<<16)+(e.charCodeAt(3)<<24)}var Jit=31,Qit=iA("DXT1"),tat=iA("DXT3"),eat=iA("DXT5"),rat=0,nat=1,iat=2,aat=3,oat=4,sat=7,lat=20,uat=21,hat=28,fat={parse:function(e,t){var r=new Int32Array(e,0,Jit);if(r[rat]!==qit||!r(lat)&jit)return null;var n=r(uat),i=r[oat],a=r[aat],o=r[hat]&Kit,s=r[iat]&$it,l,u;switch(n){case Qit:l=8,u=Mt.COMPRESSED_RGB_S3TC_DXT1_EXT;break;case tat:l=16,u=Mt.COMPRESSED_RGBA_S3TC_DXT3_EXT;break;case eat:l=16,u=Mt.COMPRESSED_RGBA_S3TC_DXT5_EXT;break;default:return null}var h=r[nat]+4,f=o?6:1,c=1;s&&(c=Math.max(1,r[sat]));for(var d=[],v=0;v<f;v++){var p=i,g=a;d[v]=new xe({width:p,height:g,format:u});for(var m=[],_=0;_<c;_++){var y=Math.max(4,p)/4*Math.max(4,g)/4*l,x=new Uint8Array(e,h,y);h+=y,p*=.5,g*=.5,m[_]=x}d[v].pixels=m[0],s&&(d[v].mipmaps=m)}if(t)t.width=d[0].width,t.height=d[0].height,t.format=d[0].format,t.pixels=d[0].pixels,t.mipmaps=d[0].mipmaps;else return d[0]}},im=String.fromCharCode,cat=8,dat=32767;function vat(e,t,r,n){if(e[3]>0){var i=Math.pow(2,e[3]-128-8+n);t[r+0]=e[0]*i,t[r+1]=e[1]*i,t[r+2]=e[2]*i}else t[r+0]=0,t[r+1]=0,t[r+2]=0;return t[r+3]=1,t}function pat(e,t,r){for(var n="",i=t;i<r;i++)n+=im(e[i]);return n}function gat(e,t){t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]}function hI(e,t,r,n){for(var i=0,a=0,o=n;o>0;)if(e[a][0]=t[r++],e[a][1]=t[r++],e[a][2]=t[r++],e[a][3]=t[r++],e[a][0]===1&&e[a][1]===1&&e[a][2]===1){for(var s=e[a][3]<<i>>>0;s>0;s--)gat(e[a-1],e[a]),a++,o--;i+=8}else a++,o--,i=0;return r}function mat(e,t,r,n){if(n<cat|n>dat)return hI(e,t,r,n);var i=t[r++];if(i!=2)return hI(e,t,r-1,n);if(e[0][1]=t[r++],e[0][2]=t[r++],i=t[r++],(e[0][2]<<8>>>0|i)>>>0!==n)return null;for(var i=0;i<4;i++)for(var a=0;a<n;){var o=t[r++];if(o>128){o=(o&127)>>>0;for(var s=t[r++];o--;)e[a++][i]=s}else for(;o--;)e[a++][i]=t[r++]}return r}var _at={parseRGBE:function(e,t,r){r==null&&(r=0);var n=new Uint8Array(e),i=n.length;if(pat(n,0,2)==="#?"){for(var a=2;a<i&&!(im(n[a])===`
`&&im(n[a+1])===`
`);a++);if(!(a>=i)){a+=2;for(var o="";a<i;a++){var s=im(n[a]);if(s===`
`)break;o+=s}var l=o.split(" "),u=parseInt(l[1]),h=parseInt(l[3]);if(!(!h||!u)){for(var f=a+1,c=[],d=0;d<h;d++){c[d]=[];for(var v=0;v<4;v++)c[d][v]=0}for(var p=new Float32Array(h*u*4),g=0,m=0;m<u;m++){var f=mat(c,n,f,h);if(!f)return null;for(var d=0;d<h;d++)vat(c[d],p,g,r),g+=4}return t||(t=new xe),t.width=h,t.height=u,t.pixels=p,t.type=Mt.FLOAT,t}}}},parseRGBEFromPNG:function(e){}},Xa={loadTexture:function(e,t,r,n){var i;if(typeof t=="function"?(r=t,n=r,t={}):t=t||{},typeof e=="string"){if(e.match(/.hdr$/)||t.fileType==="hdr")return i=new xe({width:0,height:0,sRGB:!1}),Xa._fetchTexture(e,function(a){_at.parseRGBE(a,i,t.exposure),i.dirty(),r&&r(i)},n),i;e.match(/.dds$/)||t.fileType==="dds"?(i=new xe({width:0,height:0}),Xa._fetchTexture(e,function(a){fat.parse(a,i),i.dirty(),r&&r(i)},n)):(i=new xe,i.load(e),i.success(r),i.error(n))}else typeof e=="object"&&typeof e.px<"u"&&(i=new Du,i.load(e),i.success(r),i.error(n));return i},loadPanorama:function(e,t,r,n,i,a){var o=this;typeof n=="function"?(i=n,a=i,n={}):n=n||{},Xa.loadTexture(t,n,function(s){s.flipY=n.flipY||!1,o.panoramaToCubeMap(e,s,r,n),s.dispose(e),i&&i(r)},a)},panoramaToCubeMap:function(e,t,r,n){var i=new nA,a=new lv({scene:new Xs});return a.setEnvironmentMap(t),n=n||{},n.encodeRGBM&&a.material.define("fragment","RGBM_ENCODE"),r.sRGB=t.sRGB,i.texture=r,i.render(e,a.scene),i.texture=null,i.dispose(e),r},heightToNormal:function(e,t){var r=document.createElement("canvas"),n=r.width=e.width,i=r.height=e.height,a=r.getContext("2d");a.drawImage(e,0,0,n,i),t=t||!1;for(var o=a.getImageData(0,0,n,i),s=a.createImageData(n,i),l=0;l<o.data.length;l+=4){if(t){var u=o.data[l],h=o.data[l+1],f=o.data[l+2],c=Math.abs(u-h)+Math.abs(h-f);if(c>20)return console.warn("Given image is not a height map"),e}var d,v,p,g;l%(n*4)===0?(d=o.data[l],p=o.data[l+4]):l%(n*4)===(n-1)*4?(d=o.data[l-4],p=o.data[l]):(d=o.data[l-4],p=o.data[l+4]),l<n*4?(v=o.data[l],g=o.data[l+n*4]):l>n*(i-1)*4?(v=o.data[l-n*4],g=o.data[l]):(v=o.data[l-n*4],g=o.data[l+n*4]),s.data[l]=d-p+127,s.data[l+1]=v-g+127,s.data[l+2]=255,s.data[l+3]=255}return a.putImageData(s,0,0),r},isHeightImage:function(e,t,r){if(!e||!e.width||!e.height)return!1;var n=document.createElement("canvas"),i=n.getContext("2d"),a=t||32;r=r||20,n.width=n.height=a,i.drawImage(e,0,0,a,a);for(var o=i.getImageData(0,0,a,a),s=0;s<o.data.length;s+=4){var l=o.data[s],u=o.data[s+1],h=o.data[s+2],f=Math.abs(l-u)+Math.abs(u-h);if(f>r)return!1}return!0},_fetchTexture:function(e,t,r){Ze.request.get({url:e,responseType:"arraybuffer",onload:t,onerror:r})},createChessboard:function(e,t,r,n){e=e||512,t=t||64,r=r||"black",n=n||"white";var i=Math.ceil(e/t),a=document.createElement("canvas");a.width=e,a.height=e;var o=a.getContext("2d");o.fillStyle=n,o.fillRect(0,0,e,e),o.fillStyle=r;for(var s=0;s<i;s++)for(var l=0;l<i;l++){var u=l%2?s%2:s%2-1;u&&o.fillRect(s*t,l*t,t,t)}var h=new xe({image:a,anisotropic:8});return h},createBlank:function(e){var t=document.createElement("canvas");t.width=1,t.height=1;var r=t.getContext("2d");r.fillStyle=e,r.fillRect(0,0,1,1);var n=new xe({image:t});return n}},VT=["mousedown","mouseup","mousemove","mouseover","mouseout","click","dblclick","contextmenu"];function HT(e){return"_on"+e}var WT=function(e){var t=this;this._texture=new xe({anisotropic:32,flipY:!1,surface:this,dispose:function(r){t.dispose(),xe.prototype.dispose.call(this,r)}}),VT.forEach(function(r){this[HT(r)]=function(n){n.triangle&&this._meshes.forEach(function(i){this.dispatchEvent(r,i,n.triangle,n.point)},this)}},this),this._meshes=[],e&&this.setECharts(e),this.onupdate=null};WT.prototype={constructor:WT,getTexture:function(){return this._texture},setECharts:function(e){this._chart=e;var t=e.getDom();if(!(t instanceof HTMLCanvasElement))console.error("ECharts must init on canvas if it is used as texture."),t=document.createElement("canvas");else{var r=this,n=e.getZr(),i=n.__oldRefreshImmediately||n.refreshImmediately;n.refreshImmediately=function(){i.call(this),r._texture.dirty(),r.onupdate&&r.onupdate()},n.__oldRefreshImmediately=i}this._texture.image=t,this._texture.dirty(),this.onupdate&&this.onupdate()},dispatchEvent:function(){var e=new ht,t=new ht,r=new ht,n=new ce,i=new ce,a=new ce,o=new ce,s=new ht;return function(l,u,h,f){var c=u.geometry,d=c.attributes.position,v=c.attributes.texcoord0,p=ht.dot,g=ht.cross;d.get(h[0],e.array),d.get(h[1],t.array),d.get(h[2],r.array),v.get(h[0],n.array),v.get(h[1],i.array),v.get(h[2],a.array),g(s,t,r);var m=p(e,s),_=p(f,s)/m;g(s,r,e);var y=p(f,s)/m;g(s,e,t);var x=p(f,s)/m;ce.scale(o,n,_),ce.scaleAndAdd(o,o,i,y),ce.scaleAndAdd(o,o,a,x);var T=o.x*this._chart.getWidth(),S=o.y*this._chart.getHeight();this._chart.getZr().handler.dispatch(l,{zrX:T,zrY:S})}}(),attachToMesh:function(e){this._meshes.indexOf(e)>=0||(VT.forEach(function(t){e.on(t,this[HT(t)],this)},this),this._meshes.push(e))},detachFromMesh:function(e){var t=this._meshes.indexOf(e);t>=0&&this._meshes.splice(t,1),VT.forEach(function(r){e.off(r,this[HT(r)])},this)},dispose:function(){this._meshes.forEach(function(e){this.detachFromMesh(e)},this)}};var bf=Tf.extend({left:-1,right:1,near:-1,far:1,top:1,bottom:-1},{updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},decomposeProjectionMatrix:function(){var e=this.projectionMatrix.array;this.left=(-1-e[12])/e[0],this.right=(1-e[12])/e[0],this.top=(1-e[13])/e[5],this.bottom=(-1-e[13])/e[5],this.near=-(-1-e[14])/e[10],this.far=-(1-e[14])/e[10]},clone:function(){var e=Tf.prototype.clone.call(this);return e.left=this.left,e.right=this.right,e.near=this.near,e.far=this.far,e.top=this.top,e.bottom=this.bottom,e}});const yat=`
@export clay.compositor.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
varying vec2 v_Texcoord;
void main()
{
 v_Texcoord = texcoord;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end`;Et.import(yat);var xat=new h0,fI=new Qr({geometry:xat,frustumCulling:!1}),Sat=new bf,kr=gn.extend(function(){return{fragment:"",outputs:null,material:null,blendWithPrevious:!1,clearColor:!1,clearDepth:!0}},function(){var e=new Et(Et.source("clay.compositor.vertex"),this.fragment),t=new Vi({shader:e});t.enableTexturesAll(),this.material=t},{setUniform:function(e,t){this.material.setUniform(e,t)},getUniform:function(e){var t=this.material.uniforms[e];if(t)return t.value},attachOutput:function(e,t){this.outputs||(this.outputs={}),t=t||mt.COLOR_ATTACHMENT0,this.outputs[t]=e},detachOutput:function(e){for(var t in this.outputs)this.outputs[t]===e&&(this.outputs[t]=null)},bind:function(e,t){if(this.outputs)for(var r in this.outputs){var n=this.outputs[r];n&&t.attach(n,r)}t&&t.bind(e)},unbind:function(e,t){t.unbind(e)},render:function(e,t){var r=e.gl;if(t){this.bind(e,t);var n=e.getGLExtension("EXT_draw_buffers");if(n&&this.outputs){var i=[];for(var a in this.outputs)a=+a,a>=r.COLOR_ATTACHMENT0&&a<=r.COLOR_ATTACHMENT0+8&&i.push(a);n.drawBuffersEXT(i)}}this.trigger("beforerender",this,e);var o=this.clearDepth?r.DEPTH_BUFFER_BIT:0;if(r.depthMask(!0),this.clearColor){o=o|r.COLOR_BUFFER_BIT,r.colorMask(!0,!0,!0,!0);var s=this.clearColor;Array.isArray(s)&&r.clearColor(s[0],s[1],s[2],s[3])}r.clear(o),this.blendWithPrevious?(r.enable(r.BLEND),this.material.transparent=!0):(r.disable(r.BLEND),this.material.transparent=!1),this.renderQuad(e),this.trigger("afterrender",this,e),t&&this.unbind(e,t)},renderQuad:function(e){fI.material=this.material,e.renderPass([fI],Sat)},dispose:function(e){}});const Tat=`#define SAMPLE_NUMBER 1024
#define PI 3.14159265358979
uniform sampler2D normalDistribution;
uniform vec2 viewportSize : [512, 256];
const vec3 N = vec3(0.0, 0.0, 1.0);
const float fSampleNumber = float(SAMPLE_NUMBER);
vec3 importanceSampleNormal(float i, float roughness, vec3 N) {
 vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;
 vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
float G_Smith(float roughness, float NoV, float NoL) {
 float k = roughness * roughness / 2.0;
 float G1V = NoV / (NoV * (1.0 - k) + k);
 float G1L = NoL / (NoL * (1.0 - k) + k);
 return G1L * G1V;
}
void main() {
 vec2 uv = gl_FragCoord.xy / viewportSize;
 float NoV = uv.x;
 float roughness = uv.y;
 vec3 V;
 V.x = sqrt(1.0 - NoV * NoV);
 V.y = 0.0;
 V.z = NoV;
 float A = 0.0;
 float B = 0.0;
 for (int i = 0; i < SAMPLE_NUMBER; i++) {
 vec3 H = importanceSampleNormal(float(i) / fSampleNumber, roughness, N);
 vec3 L = reflect(-V, H);
 float NoL = clamp(L.z, 0.0, 1.0);
 float NoH = clamp(H.z, 0.0, 1.0);
 float VoH = clamp(dot(V, H), 0.0, 1.0);
 if (NoL > 0.0) {
 float G = G_Smith(roughness, NoV, NoL);
 float G_Vis = G * VoH / (NoH * NoV);
 float Fc = pow(1.0 - VoH, 5.0);
 A += (1.0 - Fc) * G_Vis;
 B += Fc * G_Vis;
 }
 }
 gl_FragColor = vec4(vec2(A, B) / fSampleNumber, 0.0, 1.0);
}
`,bat=`#define SHADER_NAME prefilter
#define SAMPLE_NUMBER 1024
#define PI 3.14159265358979
uniform mat4 viewInverse : VIEWINVERSE;
uniform samplerCube environmentMap;
uniform sampler2D normalDistribution;
uniform float roughness : 0.5;
varying vec2 v_Texcoord;
varying vec3 v_WorldPosition;
@import clay.util.rgbm
vec3 importanceSampleNormal(float i, float roughness, vec3 N) {
 vec3 H = texture2D(normalDistribution, vec2(roughness, i)).rgb;
 vec3 upVector = abs(N.y) > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
void main() {
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(v_WorldPosition - eyePos);
 vec3 N = V;
 vec3 prefilteredColor = vec3(0.0);
 float totalWeight = 0.0;
 float fMaxSampleNumber = float(SAMPLE_NUMBER);
 for (int i = 0; i < SAMPLE_NUMBER; i++) {
 vec3 H = importanceSampleNormal(float(i) / fMaxSampleNumber, roughness, N);
 vec3 L = reflect(-V, H);
 float NoL = clamp(dot(N, L), 0.0, 1.0);
 if (NoL > 0.0) {
 prefilteredColor += decodeHDR(textureCube(environmentMap, L)).rgb * NoL;
 totalWeight += NoL;
 }
 }
 gl_FragColor = encodeHDR(vec4(prefilteredColor / totalWeight, 1.0));
}
`;var Ya={},s1=["px","nx","py","ny","pz","nz"];Ya.prefilterEnvironmentMap=function(e,t,r,n,i){(!i||!n)&&(n=Ya.generateNormalDistribution(),i=Ya.integrateBRDF(e,n)),r=r||{};var a=r.width||64,o=r.height||64,s=r.type||t.type,l=new Du({width:a,height:o,type:s,flipY:!1,mipmaps:[]});l.isPowerOfTwo()||console.warn("Width and height must be power of two to enable mipmap.");var u=Math.min(a,o),h=Math.log(u)/Math.log(2)+1,f=new Vi({shader:new Et({vertex:Et.source("clay.skybox.vertex"),fragment:bat})});f.set("normalDistribution",n),r.encodeRGBM&&f.define("fragment","RGBM_ENCODE"),r.decodeRGBM&&f.define("fragment","RGBM_DECODE");var c=new Xs,d;if(t.textureType==="texture2D"){var v=new Du({width:a,height:o,type:s===Mt.FLOAT?Mt.HALF_FLOAT:s});Xa.panoramaToCubeMap(e,t,v,{encodeRGBM:r.decodeRGBM}),t=v}d=new lv({scene:c,material:f}),d.material.set("environmentMap",t);var p=new nA({texture:l});r.encodeRGBM&&(s=l.type=Mt.UNSIGNED_BYTE);for(var g=new xe({width:a,height:o,type:s}),m=new Ir({depthBuffer:!1}),_=Ze[s===Mt.UNSIGNED_BYTE?"Uint8Array":"Float32Array"],y=0;y<h;y++){l.mipmaps[y]={pixels:{}},d.material.set("roughness",y/(h-1));for(var x=g.width,T=2*Math.atan(x/(x-.5))/Math.PI*180,S=0;S<s1.length;S++){var M=new _(g.width*g.height*4);m.attach(g),m.bind(e);var w=p.getCamera(s1[S]);w.fov=T,e.render(c,w),e.gl.readPixels(0,0,g.width,g.height,Mt.RGBA,s,M),m.unbind(e),l.mipmaps[y].pixels[s1[S]]=M}g.width/=2,g.height/=2,g.dirty()}return m.dispose(e),g.dispose(e),d.dispose(e),n.dispose(e),{environmentMap:l,brdfLookup:i,normalDistribution:n,maxMipmapLevel:h}};Ya.integrateBRDF=function(e,t){t=t||Ya.generateNormalDistribution();var r=new Ir({depthBuffer:!1}),n=new kr({fragment:Tat}),i=new xe({width:512,height:256,type:Mt.HALF_FLOAT,wrapS:Mt.CLAMP_TO_EDGE,wrapT:Mt.CLAMP_TO_EDGE,minFilter:Mt.NEAREST,magFilter:Mt.NEAREST,useMipmap:!1});return n.setUniform("normalDistribution",t),n.setUniform("viewportSize",[512,256]),n.attachOutput(i),n.render(e,r),r.dispose(e),i};Ya.generateNormalDistribution=function(r,n){for(var r=r||256,n=n||1024,i=new xe({width:r,height:n,type:Mt.FLOAT,minFilter:Mt.NEAREST,magFilter:Mt.NEAREST,wrapS:Mt.CLAMP_TO_EDGE,wrapT:Mt.CLAMP_TO_EDGE,useMipmap:!1}),a=new Float32Array(n*r*4),o=[],s=0;s<r;s++){for(var l=s/r,u=l*l,h=0;h<n;h++){var f=(h<<16|h>>>16)>>>0;f=((f&1431655765)<<1|(f&2863311530)>>>1)>>>0,f=((f&858993459)<<2|(f&3435973836)>>>2)>>>0,f=((f&252645135)<<4|(f&4042322160)>>>4)>>>0,f=(((f&16711935)<<8|(f&4278255360)>>>8)>>>0)/4294967296;var c=Math.sqrt((1-f)/(1+(u*u-1)*f));o[h]=c}for(var h=0;h<n;h++){var d=(h*r+s)*4,c=o[h],v=Math.sqrt(1-c*c),p=h/n,g=2*Math.PI*p;a[d]=v*Math.cos(g),a[d+1]=c,a[d+2]=v*Math.sin(g),a[d+3]=1}}return i.pixels=a,i};var wat=xa.extend({cubemap:null,castShadow:!1,_normalDistribution:null,_brdfLookup:null},{type:"AMBIENT_CUBEMAP_LIGHT",prefilter:function(e,t){if(!e.getGLExtension("EXT_shader_texture_lod")){console.warn("Device not support textureCubeLodEXT");return}this._brdfLookup||(this._normalDistribution=Ya.generateNormalDistribution(),this._brdfLookup=Ya.integrateBRDF(e,this._normalDistribution));var r=this.cubemap;if(!r.__prefiltered){var n=Ya.prefilterEnvironmentMap(e,r,{encodeRGBM:!0,width:t,height:t},this._normalDistribution,this._brdfLookup);this.cubemap=n.environmentMap,this.cubemap.__prefiltered=!0,r.dispose(e)}},getBRDFLookup:function(){return this._brdfLookup},uniformTemplates:{ambientCubemapLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}},ambientCubemapLightCubemap:{type:"t",value:function(e){return e.cubemap}},ambientCubemapLightBRDFLookup:{type:"t",value:function(e){return e._brdfLookup}}}}),Mat=xa.extend({castShadow:!1,coefficients:[]},function(){this._coefficientsTmpArr=new Ze.Float32Array(9*3)},{type:"AMBIENT_SH_LIGHT",uniformTemplates:{ambientSHLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}},ambientSHLightCoefficients:{type:"3f",value:function(e){for(var t=e._coefficientsTmpArr,r=0;r<e.coefficients.length;r++)t[r]=e.coefficients[r];return t}}}}),kk={},iu=["px","nx","py","ny","pz","nz"];function Aat(e,t){var r=e[0],n=e[1],i=e[2];return t===0?1:t===1?r:t===2?n:t===3?i:t===4?r*i:t===5?n*i:t===6?r*n:t===7?3*i*i-1:r*r-n*n}var Eat={px:[2,1,0,-1,-1,1],nx:[2,1,0,1,-1,-1],py:[0,2,1,1,-1,-1],ny:[0,2,1,1,1,1],pz:[0,1,2,-1,-1,-1],nz:[0,1,2,1,-1,1]};function Cat(e,t,r,n){for(var i=new Ze.Float32Array(27),a=W.create(),o=W.create(),s=W.create(),l=0;l<9;l++){for(var u=W.create(),h=0;h<iu.length;h++){for(var f=t[iu[h]],c=W.create(),d=0,v=0,p=Eat[iu[h]],g=0;g<n;g++)for(var m=0;m<r;m++){a[0]=m/(r-1)*2-1,a[1]=g/(n-1)*2-1,a[2]=-1,W.normalize(a,a),s[0]=a[p[0]]*p[3],s[1]=a[p[1]]*p[4],s[2]=a[p[2]]*p[5],o[0]=f[v++]/255,o[1]=f[v++]/255,o[2]=f[v++]/255;var _=f[v++]/255*8.12;o[0]*=_,o[1]*=_,o[2]*=_,W.scaleAndAdd(c,c,o,Aat(s,l)*-a[2]),d+=-a[2]}W.scaleAndAdd(u,u,c,1/d)}i[l*3]=u[0]/6,i[l*3+1]=u[1]/6,i[l*3+2]=u[2]/6}return i}kk.projectEnvironmentMap=function(e,t,r){r=r||{},r.lod=r.lod||0;var n,i=new Xs,a=64;t.textureType==="texture2D"?n=new lv({scene:i,environmentMap:t}):(a=t.image&&t.image.px?t.image.px.width:t.width,n=new lv({scene:i,environmentMap:t}));var o=Math.ceil(a/Math.pow(2,r.lod)),s=Math.ceil(a/Math.pow(2,r.lod)),l=new xe({width:o,height:s}),u=new Ir;n.material.define("fragment","RGBM_ENCODE"),r.decodeRGBM&&n.material.define("fragment","RGBM_DECODE"),n.material.set("lod",r.lod);for(var h=new nA({texture:l}),f={},c=0;c<iu.length;c++){f[iu[c]]=new Uint8Array(o*s*4);var d=h.getCamera(iu[c]);d.fov=90,u.attach(l),u.bind(e),e.render(i,d),e.gl.readPixels(0,0,o,s,Mt.RGBA,Mt.UNSIGNED_BYTE,f[iu[c]]),u.unbind(e)}return n.dispose(e),u.dispose(e),l.dispose(e),Cat(e,f,o,s)};var Ee={firstNotNull:function(){for(var e=0,t=arguments.length;e<t;e++)if(arguments[e]!=null)return arguments[e]},queryDataIndex:function(e,t){if(t.dataIndexInside!=null)return t.dataIndexInside;if(t.dataIndex!=null)return at(t.dataIndex)?ft(t.dataIndex,function(r){return e.indexOfRawIndex(r)}):e.indexOfRawIndex(t.dataIndex);if(t.name!=null)return at(t.name)?ft(t.name,function(r){return e.indexOfName(r)}):e.indexOfName(t.name)}},Dat=Ce.extend({dynamic:!1,widthSegments:40,heightSegments:20,phiStart:0,phiLength:Math.PI*2,thetaStart:0,thetaLength:Math.PI,radius:1},function(){this.build()},{build:function(){var e=this.heightSegments,t=this.widthSegments,r=this.attributes.position,n=this.attributes.texcoord0,i=this.attributes.normal,a=(t+1)*(e+1);r.init(a),n.init(a),i.init(a);var o=a>65535?Uint32Array:Uint16Array,s=this.indices=new o(t*e*6),l,u,h,f,c,d,v,y=this.radius,p=this.phiStart,g=this.phiLength,m=this.thetaStart,_=this.thetaLength,y=this.radius,x=[],T=[],S=0,M=1/y;for(v=0;v<=e;v++)for(d=0;d<=t;d++)f=d/t,c=v/e,l=-y*Math.cos(p+f*g)*Math.sin(m+c*_),u=y*Math.cos(m+c*_),h=y*Math.sin(p+f*g)*Math.sin(m+c*_),x[0]=l,x[1]=u,x[2]=h,T[0]=f,T[1]=c,r.set(S,x),n.set(S,T),x[0]*=M,x[1]*=M,x[2]*=M,i.set(S,x),S++;var w,b,A,E,C=t+1,D=0;for(v=0;v<e;v++)for(d=0;d<t;d++)b=v*C+d,w=v*C+d+1,E=(v+1)*C+d+1,A=(v+1)*C+d,s[D++]=w,s[D++]=b,s[D++]=E,s[D++]=b,s[D++]=A,s[D++]=E;this.boundingBox=new vn,this.boundingBox.max.set(y,y,y),this.boundingBox.min.set(-y,-y,-y)}}),Lat=xa.extend({castShadow:!1},{type:"AMBIENT_LIGHT",uniformTemplates:{ambientLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}}}),Rat=xa.extend({shadowBias:.001,shadowSlopeScale:2,shadowCascade:1,cascadeSplitLogFactor:.2},{type:"DIRECTIONAL_LIGHT",uniformTemplates:{directionalLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new ht,e.__dir.copy(e.worldTransform.z).normalize().negate().array}},directionalLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}},clone:function(){var e=xa.prototype.clone.call(this);return e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}}),Pat=xa.extend({range:100,castShadow:!1},{type:"POINT_LIGHT",uniformTemplates:{pointLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},pointLightRange:{type:"1f",value:function(e){return e.range}},pointLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}},clone:function(){var e=xa.prototype.clone.call(this);return e.range=this.range,e}}),Iat=xa.extend({range:20,umbraAngle:30,penumbraAngle:45,falloffFactor:2,shadowBias:.001,shadowSlopeScale:2},{type:"SPOT_LIGHT",uniformTemplates:{spotLightPosition:{type:"3f",value:function(e){return e.getWorldPosition().array}},spotLightRange:{type:"1f",value:function(e){return e.range}},spotLightUmbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.umbraAngle*Math.PI/180)}},spotLightPenumbraAngleCosine:{type:"1f",value:function(e){return Math.cos(e.penumbraAngle*Math.PI/180)}},spotLightFalloffFactor:{type:"1f",value:function(e){return e.falloffFactor}},spotLightDirection:{type:"3f",value:function(e){return e.__dir=e.__dir||new ht,e.__dir.copy(e.worldTransform.z).negate().array}},spotLightColor:{type:"3f",value:function(e){var t=e.color,r=e.intensity;return[t[0]*r,t[1]*r,t[2]*r]}}},clone:function(){var e=xa.prototype.clone.call(this);return e.range=this.range,e.umbraAngle=this.umbraAngle,e.penumbraAngle=this.penumbraAngle,e.falloffFactor=this.falloffFactor,e.shadowBias=this.shadowBias,e.shadowSlopeScale=this.shadowSlopeScale,e}}),Ve=function(e,t,r,n){e=e||0,t=t||0,r=r||0,n=n||0,this.array=yt.fromValues(e,t,r,n),this._dirty=!0};Ve.prototype={constructor:Ve,add:function(e){return yt.add(this.array,this.array,e.array),this._dirty=!0,this},set:function(e,t,r,n){return this.array[0]=e,this.array[1]=t,this.array[2]=r,this.array[3]=n,this._dirty=!0,this},setArray:function(e){return this.array[0]=e[0],this.array[1]=e[1],this.array[2]=e[2],this.array[3]=e[3],this._dirty=!0,this},clone:function(){return new Ve(this.x,this.y,this.z,this.w)},copy:function(e){return yt.copy(this.array,e.array),this._dirty=!0,this},dist:function(e){return yt.dist(this.array,e.array)},distance:function(e){return yt.distance(this.array,e.array)},div:function(e){return yt.div(this.array,this.array,e.array),this._dirty=!0,this},divide:function(e){return yt.divide(this.array,this.array,e.array),this._dirty=!0,this},dot:function(e){return yt.dot(this.array,e.array)},len:function(){return yt.len(this.array)},length:function(){return yt.length(this.array)},lerp:function(e,t,r){return yt.lerp(this.array,e.array,t.array,r),this._dirty=!0,this},min:function(e){return yt.min(this.array,this.array,e.array),this._dirty=!0,this},max:function(e){return yt.max(this.array,this.array,e.array),this._dirty=!0,this},mul:function(e){return yt.mul(this.array,this.array,e.array),this._dirty=!0,this},multiply:function(e){return yt.multiply(this.array,this.array,e.array),this._dirty=!0,this},negate:function(){return yt.negate(this.array,this.array),this._dirty=!0,this},normalize:function(){return yt.normalize(this.array,this.array),this._dirty=!0,this},random:function(e){return yt.random(this.array,e),this._dirty=!0,this},scale:function(e){return yt.scale(this.array,this.array,e),this._dirty=!0,this},scaleAndAdd:function(e,t){return yt.scaleAndAdd(this.array,this.array,e.array,t),this._dirty=!0,this},sqrDist:function(e){return yt.sqrDist(this.array,e.array)},squaredDistance:function(e){return yt.squaredDistance(this.array,e.array)},sqrLen:function(){return yt.sqrLen(this.array)},squaredLength:function(){return yt.squaredLength(this.array)},sub:function(e){return yt.sub(this.array,this.array,e.array),this._dirty=!0,this},subtract:function(e){return yt.subtract(this.array,this.array,e.array),this._dirty=!0,this},transformMat4:function(e){return yt.transformMat4(this.array,this.array,e.array),this._dirty=!0,this},transformQuat:function(e){return yt.transformQuat(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};var Hc=Object.defineProperty;if(Hc){var ig=Ve.prototype;Hc(ig,"x",{get:function(){return this.array[0]},set:function(e){this.array[0]=e,this._dirty=!0}}),Hc(ig,"y",{get:function(){return this.array[1]},set:function(e){this.array[1]=e,this._dirty=!0}}),Hc(ig,"z",{get:function(){return this.array[2]},set:function(e){this.array[2]=e,this._dirty=!0}}),Hc(ig,"w",{get:function(){return this.array[3]},set:function(e){this.array[3]=e,this._dirty=!0}})}Ve.add=function(e,t,r){return yt.add(e.array,t.array,r.array),e._dirty=!0,e};Ve.set=function(e,t,r,n,i){yt.set(e.array,t,r,n,i),e._dirty=!0};Ve.copy=function(e,t){return yt.copy(e.array,t.array),e._dirty=!0,e};Ve.dist=function(e,t){return yt.distance(e.array,t.array)};Ve.distance=Ve.dist;Ve.div=function(e,t,r){return yt.divide(e.array,t.array,r.array),e._dirty=!0,e};Ve.divide=Ve.div;Ve.dot=function(e,t){return yt.dot(e.array,t.array)};Ve.len=function(e){return yt.length(e.array)};Ve.lerp=function(e,t,r,n){return yt.lerp(e.array,t.array,r.array,n),e._dirty=!0,e};Ve.min=function(e,t,r){return yt.min(e.array,t.array,r.array),e._dirty=!0,e};Ve.max=function(e,t,r){return yt.max(e.array,t.array,r.array),e._dirty=!0,e};Ve.mul=function(e,t,r){return yt.multiply(e.array,t.array,r.array),e._dirty=!0,e};Ve.multiply=Ve.mul;Ve.negate=function(e,t){return yt.negate(e.array,t.array),e._dirty=!0,e};Ve.normalize=function(e,t){return yt.normalize(e.array,t.array),e._dirty=!0,e};Ve.random=function(e,t){return yt.random(e.array,t),e._dirty=!0,e};Ve.scale=function(e,t,r){return yt.scale(e.array,t.array,r),e._dirty=!0,e};Ve.scaleAndAdd=function(e,t,r,n){return yt.scaleAndAdd(e.array,t.array,r.array,n),e._dirty=!0,e};Ve.sqrDist=function(e,t){return yt.sqrDist(e.array,t.array)};Ve.squaredDistance=Ve.sqrDist;Ve.sqrLen=function(e){return yt.sqrLen(e.array)};Ve.squaredLength=Ve.sqrLen;Ve.sub=function(e,t,r){return yt.subtract(e.array,t.array,r.array),e._dirty=!0,e};Ve.subtract=Ve.sub;Ve.transformMat4=function(e,t,r){return yt.transformMat4(e.array,t.array,r.array),e._dirty=!0,e};Ve.transformQuat=function(e,t,r){return yt.transformQuat(e.array,t.array,r.array),e._dirty=!0,e};var Ge={};Ge.create=function(){var e=new mn(4);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e};Ge.clone=function(e){var t=new mn(4);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t};Ge.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e};Ge.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e};Ge.transpose=function(e,t){if(e===t){var r=t[1];e[1]=t[2],e[2]=r}else e[0]=t[0],e[1]=t[2],e[2]=t[1],e[3]=t[3];return e};Ge.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=r*a-i*n;return o?(o=1/o,e[0]=a*o,e[1]=-n*o,e[2]=-i*o,e[3]=r*o,e):null};Ge.adjoint=function(e,t){var r=t[0];return e[0]=t[3],e[1]=-t[1],e[2]=-t[2],e[3]=r,e};Ge.determinant=function(e){return e[0]*e[3]-e[2]*e[1]};Ge.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],l=r[1],u=r[2],h=r[3];return e[0]=n*s+a*l,e[1]=i*s+o*l,e[2]=n*u+a*h,e[3]=i*u+o*h,e};Ge.mul=Ge.multiply;Ge.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=Math.sin(r),l=Math.cos(r);return e[0]=n*l+a*s,e[1]=i*l+o*s,e[2]=n*-s+a*l,e[3]=i*-s+o*l,e};Ge.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=r[0],l=r[1];return e[0]=n*s,e[1]=i*s,e[2]=a*l,e[3]=o*l,e};Ge.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2))};Ge.LDU=function(e,t,r,n){return e[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-e[2]*r[1],[e,t,r]};var Vn=function(){this.array=Ge.create(),this._dirty=!0};Vn.prototype={constructor:Vn,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return new Vn().copy(this)},copy:function(e){return Ge.copy(this.array,e.array),this._dirty=!0,this},adjoint:function(){return Ge.adjoint(this.array,this.array),this._dirty=!0,this},determinant:function(){return Ge.determinant(this.array)},identity:function(){return Ge.identity(this.array),this._dirty=!0,this},invert:function(){return Ge.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return Ge.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return Ge.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return Ge.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return Ge.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return Ge.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return Ge.scale(this.array,this.array,e.array),this._dirty=!0,this},transpose:function(){return Ge.transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};Vn.adjoint=function(e,t){return Ge.adjoint(e.array,t.array),e._dirty=!0,e};Vn.copy=function(e,t){return Ge.copy(e.array,t.array),e._dirty=!0,e};Vn.determinant=function(e){return Ge.determinant(e.array)};Vn.identity=function(e){return Ge.identity(e.array),e._dirty=!0,e};Vn.invert=function(e,t){return Ge.invert(e.array,t.array),e._dirty=!0,e};Vn.mul=function(e,t,r){return Ge.mul(e.array,t.array,r.array),e._dirty=!0,e};Vn.multiply=Vn.mul;Vn.rotate=function(e,t,r){return Ge.rotate(e.array,t.array,r),e._dirty=!0,e};Vn.scale=function(e,t,r){return Ge.scale(e.array,t.array,r.array),e._dirty=!0,e};Vn.transpose=function(e,t){return Ge.transpose(e.array,t.array),e._dirty=!0,e};var $e={};$e.create=function(){var e=new mn(6);return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e};$e.clone=function(e){var t=new mn(6);return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t};$e.copy=function(e,t){return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e};$e.identity=function(e){return e[0]=1,e[1]=0,e[2]=0,e[3]=1,e[4]=0,e[5]=0,e};$e.invert=function(e,t){var r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=r*a-n*i;return l?(l=1/l,e[0]=a*l,e[1]=-n*l,e[2]=-i*l,e[3]=r*l,e[4]=(i*s-a*o)*l,e[5]=(n*o-r*s)*l,e):null};$e.determinant=function(e){return e[0]*e[3]-e[1]*e[2]};$e.multiply=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=r[0],h=r[1],f=r[2],c=r[3],d=r[4],v=r[5];return e[0]=n*u+a*h,e[1]=i*u+o*h,e[2]=n*f+a*c,e[3]=i*f+o*c,e[4]=n*d+a*v+s,e[5]=i*d+o*v+l,e};$e.mul=$e.multiply;$e.rotate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=Math.sin(r),h=Math.cos(r);return e[0]=n*h+a*u,e[1]=i*h+o*u,e[2]=n*-u+a*h,e[3]=i*-u+o*h,e[4]=s,e[5]=l,e};$e.scale=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=r[0],h=r[1];return e[0]=n*u,e[1]=i*u,e[2]=a*h,e[3]=o*h,e[4]=s,e[5]=l,e};$e.translate=function(e,t,r){var n=t[0],i=t[1],a=t[2],o=t[3],s=t[4],l=t[5],u=r[0],h=r[1];return e[0]=n,e[1]=i,e[2]=a,e[3]=o,e[4]=n*u+a*h+s,e[5]=i*u+o*h+l,e};$e.frob=function(e){return Math.sqrt(Math.pow(e[0],2)+Math.pow(e[1],2)+Math.pow(e[2],2)+Math.pow(e[3],2)+Math.pow(e[4],2)+Math.pow(e[5],2)+1)};var si=function(){this.array=$e.create(),this._dirty=!0};si.prototype={constructor:si,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},clone:function(){return new si().copy(this)},copy:function(e){return $e.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return $e.determinant(this.array)},identity:function(){return $e.identity(this.array),this._dirty=!0,this},invert:function(){return $e.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return $e.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return $e.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return $e.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return $e.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return $e.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return $e.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return $e.translate(this.array,this.array,e.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};si.copy=function(e,t){return $e.copy(e.array,t.array),e._dirty=!0,e};si.determinant=function(e){return $e.determinant(e.array)};si.identity=function(e){return $e.identity(e.array),e._dirty=!0,e};si.invert=function(e,t){return $e.invert(e.array,t.array),e._dirty=!0,e};si.mul=function(e,t,r){return $e.mul(e.array,t.array,r.array),e._dirty=!0,e};si.multiply=si.mul;si.rotate=function(e,t,r){return $e.rotate(e.array,t.array,r),e._dirty=!0,e};si.scale=function(e,t,r){return $e.scale(e.array,t.array,r.array),e._dirty=!0,e};si.translate=function(e,t,r){return $e.translate(e.array,t.array,r.array),e._dirty=!0,e};var Yr=function(){this.array=le.create(),this._dirty=!0};Yr.prototype={constructor:Yr,setArray:function(e){for(var t=0;t<this.array.length;t++)this.array[t]=e[t];return this._dirty=!0,this},adjoint:function(){return le.adjoint(this.array,this.array),this._dirty=!0,this},clone:function(){return new Yr().copy(this)},copy:function(e){return le.copy(this.array,e.array),this._dirty=!0,this},determinant:function(){return le.determinant(this.array)},fromMat2d:function(e){return le.fromMat2d(this.array,e.array),this._dirty=!0,this},fromMat4:function(e){return le.fromMat4(this.array,e.array),this._dirty=!0,this},fromQuat:function(e){return le.fromQuat(this.array,e.array),this._dirty=!0,this},identity:function(){return le.identity(this.array),this._dirty=!0,this},invert:function(){return le.invert(this.array,this.array),this._dirty=!0,this},mul:function(e){return le.mul(this.array,this.array,e.array),this._dirty=!0,this},mulLeft:function(e){return le.mul(this.array,e.array,this.array),this._dirty=!0,this},multiply:function(e){return le.multiply(this.array,this.array,e.array),this._dirty=!0,this},multiplyLeft:function(e){return le.multiply(this.array,e.array,this.array),this._dirty=!0,this},rotate:function(e){return le.rotate(this.array,this.array,e),this._dirty=!0,this},scale:function(e){return le.scale(this.array,this.array,e.array),this._dirty=!0,this},translate:function(e){return le.translate(this.array,this.array,e.array),this._dirty=!0,this},normalFromMat4:function(e){return le.normalFromMat4(this.array,e.array),this._dirty=!0,this},transpose:function(){return le.transpose(this.array,this.array),this._dirty=!0,this},toString:function(){return"["+Array.prototype.join.call(this.array,",")+"]"},toArray:function(){return Array.prototype.slice.call(this.array)}};Yr.adjoint=function(e,t){return le.adjoint(e.array,t.array),e._dirty=!0,e};Yr.copy=function(e,t){return le.copy(e.array,t.array),e._dirty=!0,e};Yr.determinant=function(e){return le.determinant(e.array)};Yr.identity=function(e){return le.identity(e.array),e._dirty=!0,e};Yr.invert=function(e,t){return le.invert(e.array,t.array),e};Yr.mul=function(e,t,r){return le.mul(e.array,t.array,r.array),e._dirty=!0,e};Yr.multiply=Yr.mul;Yr.fromMat2d=function(e,t){return le.fromMat2d(e.array,t.array),e._dirty=!0,e};Yr.fromMat4=function(e,t){return le.fromMat4(e.array,t.array),e._dirty=!0,e};Yr.fromQuat=function(e,t){return le.fromQuat(e.array,t.array),e._dirty=!0,e};Yr.normalFromMat4=function(e,t){return le.normalFromMat4(e.array,t.array),e._dirty=!0,e};Yr.rotate=function(e,t,r){return le.rotate(e.array,t.array,r),e._dirty=!0,e};Yr.scale=function(e,t,r){return le.scale(e.array,t.array,r.array),e._dirty=!0,e};Yr.transpose=function(e,t){return le.transpose(e.array,t.array),e._dirty=!0,e};Yr.translate=function(e,t,r){return le.translate(e.array,t.array,r.array),e._dirty=!0,e};var Nat={_animators:null,getAnimators:function(){return this._animators=this._animators||[],this._animators},animate:function(e,t){this._animators=this._animators||[];var r=this,n;if(e){for(var i=e.split("."),a=r,o=0,s=i.length;o<s;o++)a&&(a=a[i[o]]);a&&(n=a)}else n=r;if(n==null)throw new Error("Target "+e+" not exists");var l=this._animators,u=new M_(n,t),h=this;return u.during(function(){h.__zr&&h.__zr.refresh()}).done(function(){var f=l.indexOf(u);f>=0&&l.splice(f,1)}),l.push(u),this.__zr&&this.__zr.animation.addAnimator(u),u},stopAnimation:function(e){this._animators=this._animators||[];for(var t=this._animators,r=t.length,n=0;n<r;n++)t[n].stop(e);return t.length=0,this},addAnimatorsToZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.addAnimator(this._animators[t])},removeAnimatorsFromZr:function(e){if(this._animators)for(var t=0;t<this._animators.length;t++)e.animation.removeAnimator(this._animators[t])}};const Gk=`
@export clay.util.rand
highp float rand(vec2 uv) {
 const highp float a = 12.9898, b = 78.233, c = 43758.5453;
 highp float dt = dot(uv.xy, vec2(a,b)), sn = mod(dt, 3.141592653589793);
 return fract(sin(sn) * c);
}
@end
@export clay.util.calculate_attenuation
uniform float attenuationFactor : 5.0;
float lightAttenuation(float dist, float range)
{
 float attenuation = 1.0;
 attenuation = dist*dist/(range*range+1.0);
 float att_s = attenuationFactor;
 attenuation = 1.0/(attenuation*att_s+1.0);
 att_s = 1.0/(att_s+1.0);
 attenuation = attenuation - att_s;
 attenuation /= 1.0 - att_s;
 return clamp(attenuation, 0.0, 1.0);
}
@end
@export clay.util.edge_factor
#ifdef SUPPORT_STANDARD_DERIVATIVES
float edgeFactor(float width)
{
 vec3 d = fwidth(v_Barycentric);
 vec3 a3 = smoothstep(vec3(0.0), d * width, v_Barycentric);
 return min(min(a3.x, a3.y), a3.z);
}
#else
float edgeFactor(float width)
{
 return 1.0;
}
#endif
@end
@export clay.util.encode_float
vec4 encodeFloat(const in float depth)
{
 const vec4 bitShifts = vec4(256.0*256.0*256.0, 256.0*256.0, 256.0, 1.0);
 const vec4 bit_mask = vec4(0.0, 1.0/256.0, 1.0/256.0, 1.0/256.0);
 vec4 res = fract(depth * bitShifts);
 res -= res.xxyz * bit_mask;
 return res;
}
@end
@export clay.util.decode_float
float decodeFloat(const in vec4 color)
{
 const vec4 bitShifts = vec4(1.0/(256.0*256.0*256.0), 1.0/(256.0*256.0), 1.0/256.0, 1.0);
 return dot(color, bitShifts);
}
@end
@export clay.util.float
@import clay.util.encode_float
@import clay.util.decode_float
@end
@export clay.util.rgbm_decode
vec3 RGBMDecode(vec4 rgbm, float range) {
 return range * rgbm.rgb * rgbm.a;
}
@end
@export clay.util.rgbm_encode
vec4 RGBMEncode(vec3 color, float range) {
 if (dot(color, color) == 0.0) {
 return vec4(0.0);
 }
 vec4 rgbm;
 color /= range;
 rgbm.a = clamp(max(max(color.r, color.g), max(color.b, 1e-6)), 0.0, 1.0);
 rgbm.a = ceil(rgbm.a * 255.0) / 255.0;
 rgbm.rgb = color / rgbm.a;
 return rgbm;
}
@end
@export clay.util.rgbm
@import clay.util.rgbm_decode
@import clay.util.rgbm_encode
vec4 decodeHDR(vec4 color)
{
#if defined(RGBM_DECODE) || defined(RGBM)
 return vec4(RGBMDecode(color, 8.12), 1.0);
#else
 return color;
#endif
}
vec4 encodeHDR(vec4 color)
{
#if defined(RGBM_ENCODE) || defined(RGBM)
 return RGBMEncode(color.xyz, 8.12);
#else
 return color;
#endif
}
@end
@export clay.util.srgb
vec4 sRGBToLinear(in vec4 value) {
 return vec4(mix(pow(value.rgb * 0.9478672986 + vec3(0.0521327014), vec3(2.4)), value.rgb * 0.0773993808, vec3(lessThanEqual(value.rgb, vec3(0.04045)))), value.w);
}
vec4 linearTosRGB(in vec4 value) {
 return vec4(mix(pow(value.rgb, vec3(0.41666)) * 1.055 - vec3(0.055), value.rgb * 12.92, vec3(lessThanEqual(value.rgb, vec3(0.0031308)))), value.w);
}
@end
@export clay.chunk.skinning_header
#ifdef SKINNING
attribute vec3 weight : WEIGHT;
attribute vec4 joint : JOINT;
#ifdef USE_SKIN_MATRICES_TEXTURE
uniform sampler2D skinMatricesTexture : ignore;
uniform float skinMatricesTextureSize: ignore;
mat4 getSkinMatrix(sampler2D tex, float idx) {
 float j = idx * 4.0;
 float x = mod(j, skinMatricesTextureSize);
 float y = floor(j / skinMatricesTextureSize) + 0.5;
 vec2 scale = vec2(skinMatricesTextureSize);
 return mat4(
 texture2D(tex, vec2(x + 0.5, y) / scale),
 texture2D(tex, vec2(x + 1.5, y) / scale),
 texture2D(tex, vec2(x + 2.5, y) / scale),
 texture2D(tex, vec2(x + 3.5, y) / scale)
 );
}
mat4 getSkinMatrix(float idx) {
 return getSkinMatrix(skinMatricesTexture, idx);
}
#else
uniform mat4 skinMatrix[JOINT_COUNT] : SKIN_MATRIX;
mat4 getSkinMatrix(float idx) {
 return skinMatrix[int(idx)];
}
#endif
#endif
@end
@export clay.chunk.skin_matrix
mat4 skinMatrixWS = getSkinMatrix(joint.x) * weight.x;
if (weight.y > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.y) * weight.y;
}
if (weight.z > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.z) * weight.z;
}
float weightW = 1.0-weight.x-weight.y-weight.z;
if (weightW > 1e-4)
{
 skinMatrixWS += getSkinMatrix(joint.w) * weightW;
}
@end
@export clay.chunk.instancing_header
#ifdef INSTANCING
attribute vec4 instanceMat1;
attribute vec4 instanceMat2;
attribute vec4 instanceMat3;
#endif
@end
@export clay.chunk.instancing_matrix
mat4 instanceMat = mat4(
 vec4(instanceMat1.xyz, 0.0),
 vec4(instanceMat2.xyz, 0.0),
 vec4(instanceMat3.xyz, 0.0),
 vec4(instanceMat1.w, instanceMat2.w, instanceMat3.w, 1.0)
);
@end
@export clay.util.parallax_correct
vec3 parallaxCorrect(in vec3 dir, in vec3 pos, in vec3 boxMin, in vec3 boxMax) {
 vec3 first = (boxMax - pos) / dir;
 vec3 second = (boxMin - pos) / dir;
 vec3 further = max(first, second);
 float dist = min(further.x, min(further.y, further.z));
 vec3 fixedPos = pos + dir * dist;
 vec3 boxCenter = (boxMax + boxMin) * 0.5;
 return normalize(fixedPos - boxCenter);
}
@end
@export clay.util.clamp_sample
vec4 clampSample(const in sampler2D texture, const in vec2 coord)
{
#ifdef STEREO
 float eye = step(0.5, coord.x) * 0.5;
 vec2 coordClamped = clamp(coord, vec2(eye, 0.0), vec2(0.5 + eye, 1.0));
#else
 vec2 coordClamped = clamp(coord, vec2(0.0), vec2(1.0));
#endif
 return texture2D(texture, coordClamped);
}
@end
@export clay.util.ACES
vec3 ACESToneMapping(vec3 color)
{
 const float A = 2.51;
 const float B = 0.03;
 const float C = 2.43;
 const float D = 0.59;
 const float E = 0.14;
 return (color * (A * color + B)) / (color * (C * color + D) + E);
}
@end`,Oat=`
@export ecgl.common.transformUniforms
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;
uniform mat4 world : WORLD;
@end

@export ecgl.common.attributes
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
attribute vec3 normal : NORMAL;
@end

@export ecgl.common.uv.header
uniform vec2 uvRepeat : [1.0, 1.0];
uniform vec2 uvOffset : [0.0, 0.0];
uniform vec2 detailUvRepeat : [1.0, 1.0];
uniform vec2 detailUvOffset : [0.0, 0.0];

varying vec2 v_Texcoord;
varying vec2 v_DetailTexcoord;
@end

@export ecgl.common.uv.main
v_Texcoord = texcoord * uvRepeat + uvOffset;
v_DetailTexcoord = texcoord * detailUvRepeat + detailUvOffset;
@end

@export ecgl.common.uv.fragmentHeader
varying vec2 v_Texcoord;
varying vec2 v_DetailTexcoord;
@end


@export ecgl.common.albedo.main

 vec4 albedoTexel = vec4(1.0);
#ifdef DIFFUSEMAP_ENABLED
 albedoTexel = texture2D(diffuseMap, v_Texcoord);
 #ifdef SRGB_DECODE
 albedoTexel = sRGBToLinear(albedoTexel);
 #endif
#endif

#ifdef DETAILMAP_ENABLED
 vec4 detailTexel = texture2D(detailMap, v_DetailTexcoord);
 #ifdef SRGB_DECODE
 detailTexel = sRGBToLinear(detailTexel);
 #endif
 albedoTexel.rgb = mix(albedoTexel.rgb, detailTexel.rgb, detailTexel.a);
 albedoTexel.a = detailTexel.a + (1.0 - detailTexel.a) * albedoTexel.a;
#endif

@end

@export ecgl.common.wireframe.vertexHeader

#ifdef WIREFRAME_QUAD
attribute vec4 barycentric;
varying vec4 v_Barycentric;
#elif defined(WIREFRAME_TRIANGLE)
attribute vec3 barycentric;
varying vec3 v_Barycentric;
#endif

@end

@export ecgl.common.wireframe.vertexMain

#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)
 v_Barycentric = barycentric;
#endif

@end


@export ecgl.common.wireframe.fragmentHeader

uniform float wireframeLineWidth : 1;
uniform vec4 wireframeLineColor: [0, 0, 0, 0.5];

#ifdef WIREFRAME_QUAD
varying vec4 v_Barycentric;
float edgeFactor () {
 vec4 d = fwidth(v_Barycentric);
 vec4 a4 = smoothstep(vec4(0.0), d * wireframeLineWidth, v_Barycentric);
 return min(min(min(a4.x, a4.y), a4.z), a4.w);
}
#elif defined(WIREFRAME_TRIANGLE)
varying vec3 v_Barycentric;
float edgeFactor () {
 vec3 d = fwidth(v_Barycentric);
 vec3 a3 = smoothstep(vec3(0.0), d * wireframeLineWidth, v_Barycentric);
 return min(min(a3.x, a3.y), a3.z);
}
#endif

@end


@export ecgl.common.wireframe.fragmentMain

#if defined(WIREFRAME_QUAD) || defined(WIREFRAME_TRIANGLE)
 if (wireframeLineWidth > 0.) {
 vec4 lineColor = wireframeLineColor;
#ifdef SRGB_DECODE
 lineColor = sRGBToLinear(lineColor);
#endif

 gl_FragColor.rgb = mix(gl_FragColor.rgb, lineColor.rgb, (1.0 - edgeFactor()) * lineColor.a);
 }
#endif
@end




@export ecgl.common.bumpMap.header

#ifdef BUMPMAP_ENABLED
uniform sampler2D bumpMap;
uniform float bumpScale : 1.0;


vec3 bumpNormal(vec3 surfPos, vec3 surfNormal, vec3 baseNormal)
{
 vec2 dSTdx = dFdx(v_Texcoord);
 vec2 dSTdy = dFdy(v_Texcoord);

 float Hll = bumpScale * texture2D(bumpMap, v_Texcoord).x;
 float dHx = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdx).x - Hll;
 float dHy = bumpScale * texture2D(bumpMap, v_Texcoord + dSTdy).x - Hll;

 vec3 vSigmaX = dFdx(surfPos);
 vec3 vSigmaY = dFdy(surfPos);
 vec3 vN = surfNormal;

 vec3 R1 = cross(vSigmaY, vN);
 vec3 R2 = cross(vN, vSigmaX);

 float fDet = dot(vSigmaX, R1);

 vec3 vGrad = sign(fDet) * (dHx * R1 + dHy * R2);
 return normalize(abs(fDet) * baseNormal - vGrad);

}
#endif

@end

@export ecgl.common.normalMap.vertexHeader

#ifdef NORMALMAP_ENABLED
attribute vec4 tangent : TANGENT;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@end

@export ecgl.common.normalMap.vertexMain

#ifdef NORMALMAP_ENABLED
 if (dot(tangent, tangent) > 0.0) {
 v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);
 v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);
 }
#endif

@end


@export ecgl.common.normalMap.fragmentHeader

#ifdef NORMALMAP_ENABLED
uniform sampler2D normalMap;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@end

@export ecgl.common.normalMap.fragmentMain
#ifdef NORMALMAP_ENABLED
 if (dot(v_Tangent, v_Tangent) > 0.0) {
 vec3 normalTexel = texture2D(normalMap, v_DetailTexcoord).xyz;
 if (dot(normalTexel, normalTexel) > 0.0) { N = normalTexel * 2.0 - 1.0;
 mat3 tbn = mat3(v_Tangent, v_Bitangent, v_Normal);
 N = normalize(tbn * N);
 }
 }
#endif
@end



@export ecgl.common.vertexAnimation.header

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute vec3 prevNormal;
uniform float percent;
#endif

@end

@export ecgl.common.vertexAnimation.main

#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
 vec3 norm = mix(prevNormal, normal, percent);
#else
 vec3 pos = position;
 vec3 norm = normal;
#endif

@end


@export ecgl.common.ssaoMap.header
#ifdef SSAOMAP_ENABLED
uniform sampler2D ssaoMap;
uniform vec4 viewport : VIEWPORT;
#endif
@end

@export ecgl.common.ssaoMap.main
 float ao = 1.0;
#ifdef SSAOMAP_ENABLED
 ao = texture2D(ssaoMap, (gl_FragCoord.xy - viewport.xy) / viewport.zw).r;
#endif
@end




@export ecgl.common.diffuseLayer.header

#if (LAYER_DIFFUSEMAP_COUNT > 0)
uniform float layerDiffuseIntensity[LAYER_DIFFUSEMAP_COUNT];
uniform sampler2D layerDiffuseMap[LAYER_DIFFUSEMAP_COUNT];
#endif

@end

@export ecgl.common.emissiveLayer.header

#if (LAYER_EMISSIVEMAP_COUNT > 0)
uniform float layerEmissionIntensity[LAYER_EMISSIVEMAP_COUNT];
uniform sampler2D layerEmissiveMap[LAYER_EMISSIVEMAP_COUNT];
#endif

@end

@export ecgl.common.layers.header
@import ecgl.common.diffuseLayer.header
@import ecgl.common.emissiveLayer.header
@end

@export ecgl.common.diffuseLayer.main

#if (LAYER_DIFFUSEMAP_COUNT > 0)
 for (int _idx_ = 0; _idx_ < LAYER_DIFFUSEMAP_COUNT; _idx_++) {{
 float intensity = layerDiffuseIntensity[_idx_];
 vec4 texel2 = texture2D(layerDiffuseMap[_idx_], v_Texcoord);
 #ifdef SRGB_DECODE
 texel2 = sRGBToLinear(texel2);
 #endif
 albedoTexel.rgb = mix(albedoTexel.rgb, texel2.rgb * intensity, texel2.a);
 albedoTexel.a = texel2.a + (1.0 - texel2.a) * albedoTexel.a;
 }}
#endif

@end

@export ecgl.common.emissiveLayer.main

#if (LAYER_EMISSIVEMAP_COUNT > 0)
 for (int _idx_ = 0; _idx_ < LAYER_EMISSIVEMAP_COUNT; _idx_++)
 {{
 vec4 texel2 = texture2D(layerEmissiveMap[_idx_], v_Texcoord) * layerEmissionIntensity[_idx_];
 #ifdef SRGB_DECODE
 texel2 = sRGBToLinear(texel2);
 #endif
 float intensity = layerEmissionIntensity[_idx_];
 gl_FragColor.rgb += texel2.rgb * texel2.a * intensity;
 }}
#endif

@end
`,Fat=`@export ecgl.color.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

@import ecgl.common.uv.header

attribute vec2 texcoord : TEXCOORD_0;
attribute vec3 position: POSITION;

@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
uniform float percent : 1.0;
#endif

#ifdef ATMOSPHERE_ENABLED
attribute vec3 normal: NORMAL;
uniform mat4 worldInverseTranspose : WORLDINVERSETRANSPOSE;
varying vec3 v_Normal;
#endif

void main()
{
#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
#else
 vec3 pos = position;
#endif

 gl_Position = worldViewProjection * vec4(pos, 1.0);

 @import ecgl.common.uv.main

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

#ifdef ATMOSPHERE_ENABLED
 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);
#endif

 @import ecgl.common.wireframe.vertexMain

}

@end

@export ecgl.color.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0

uniform sampler2D diffuseMap;
uniform sampler2D detailMap;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
varying vec3 v_Normal;
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

@import ecgl.common.layers.header

@import ecgl.common.uv.fragmentHeader

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color);
#else
 gl_FragColor = color;
#endif

#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 gl_FragColor *= albedoTexel;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain

}
@end`,Bat=`/**
 * http: */

@export ecgl.lambert.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header


@import ecgl.common.attributes

@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif


@import ecgl.common.vertexAnimation.header


varying vec3 v_Normal;
varying vec3 v_WorldPosition;

void main()
{
 @import ecgl.common.uv.main

 @import ecgl.common.vertexAnimation.main


 gl_Position = worldViewProjection * vec4(pos, 1.0);

 v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

 @import ecgl.common.wireframe.vertexMain
}

@end


@export ecgl.lambert.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform sampler2D diffuseMap;
uniform sampler2D detailMap;

@import ecgl.common.layers.header

uniform float emissionIntensity: 1.0;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
#endif

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif


@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color);
#else
 gl_FragColor = color;
#endif

#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 gl_FragColor *= sRGBToLinear(v_Color);
 #else
 gl_FragColor *= v_Color;
 #endif
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 gl_FragColor *= albedoTexel;

 vec3 N = v_Normal;
#ifdef DOUBLE_SIDED
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 vec3 diffuseColor = vec3(0.0, 0.0, 0.0);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)
 {
 diffuseColor += ambientLightColor[i] * ambientFactor * ao;
 }
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 diffuseColor += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;
 }}
#endif
#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)
 {
 vec3 lightDirection = -directionalLightDirection[i];
 vec3 lightColor = directionalLightColor[i];

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[i];
 }
#endif

 float ndl = dot(N, normalize(lightDirection)) * shadowContrib;

 diffuseColor += lightColor * clamp(ndl, 0.0, 1.0);
 }
#endif

 gl_FragColor.rgb *= diffuseColor;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain
}

@end`,Uat=`@export ecgl.realistic.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes


@import ecgl.common.wireframe.vertexHeader

#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

#ifdef NORMALMAP_ENABLED
attribute vec4 tangent : TANGENT;
varying vec3 v_Tangent;
varying vec3 v_Bitangent;
#endif

@import ecgl.common.vertexAnimation.header

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

void main()
{

 @import ecgl.common.uv.main

 @import ecgl.common.vertexAnimation.main

 gl_Position = worldViewProjection * vec4(pos, 1.0);

 v_Normal = normalize((worldInverseTranspose * vec4(norm, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif

#ifdef NORMALMAP_ENABLED
 v_Tangent = normalize((worldInverseTranspose * vec4(tangent.xyz, 0.0)).xyz);
 v_Bitangent = normalize(cross(v_Normal, v_Tangent) * tangent.w);
#endif

 @import ecgl.common.wireframe.vertexMain

}

@end



@export ecgl.realistic.fragment

#define LAYER_DIFFUSEMAP_COUNT 0
#define LAYER_EMISSIVEMAP_COUNT 0
#define PI 3.14159265358979
#define ROUGHNESS_CHANEL 0
#define METALNESS_CHANEL 1

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform sampler2D diffuseMap;

uniform sampler2D detailMap;
uniform sampler2D metalnessMap;
uniform sampler2D roughnessMap;

@import ecgl.common.layers.header

uniform float emissionIntensity: 1.0;

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

uniform float metalness : 0.0;
uniform float roughness : 0.5;

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef ATMOSPHERE_ENABLED
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform vec3 glowColor;
uniform float glowPower;
#endif

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif

#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT
@import clay.header.ambient_cubemap_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

@import ecgl.common.normalMap.fragmentHeader

@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import clay.util.rgbm

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

vec3 F_Schlick(float ndv, vec3 spec) {
 return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);
}

float D_Phong(float g, float ndh) {
 float a = pow(8192.0, g);
 return (a + 2.0) / 8.0 * pow(ndh, a);
}

void main()
{
 vec4 albedoColor = color;

 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);
#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 albedoColor *= sRGBToLinear(v_Color);
 #else
 albedoColor *= v_Color;
 #endif
#endif

 @import ecgl.common.albedo.main

 @import ecgl.common.diffuseLayer.main

 albedoColor *= albedoTexel;

 float m = metalness;

#ifdef METALNESSMAP_ENABLED
 float m2 = texture2D(metalnessMap, v_DetailTexcoord)[METALNESS_CHANEL];
 m = clamp(m2 + (m - 0.5) * 2.0, 0.0, 1.0);
#endif

 vec3 baseColor = albedoColor.rgb;
 albedoColor.rgb = baseColor * (1.0 - m);
 vec3 specFactor = mix(vec3(0.04), baseColor, m);

 float g = 1.0 - roughness;

#ifdef ROUGHNESSMAP_ENABLED
 float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];
 g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);
#endif

 vec3 N = v_Normal;

#ifdef DOUBLE_SIDED
 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

@import ecgl.common.normalMap.fragmentMain

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 vec3 diffuseTerm = vec3(0.0);
 vec3 specularTerm = vec3(0.0);

 float ndv = clamp(dot(N, V), 0.0, 1.0);
 vec3 fresnelTerm = F_Schlick(ndv, specFactor);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_LIGHT_COUNT; _idx_++)
 {{
 diffuseTerm += ambientLightColor[_idx_] * ambientFactor * ao;
 }}
#endif

#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 diffuseTerm += calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_] * ao;
 }}
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++)
 {{
 vec3 L = -directionalLightDirection[_idx_];
 vec3 lc = directionalLightColor[_idx_];

 vec3 H = normalize(L + V);
 float ndl = clamp(dot(N, normalize(L)), 0.0, 1.0);
 float ndh = clamp(dot(N, H), 0.0, 1.0);

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[_idx_];
 }
#endif

 vec3 li = lc * ndl * shadowContrib;

 diffuseTerm += li;
 specularTerm += li * fresnelTerm * D_Phong(g, ndh);
 }}
#endif


#ifdef AMBIENT_CUBEMAP_LIGHT_COUNT
 vec3 L = reflect(-V, N);
 L = vec3(L.x, L[NORMAL_UP_AXIS], L[NORMAL_FRONT_AXIS]);
 float rough2 = clamp(1.0 - g, 0.0, 1.0);
 float bias2 = rough2 * 5.0;
 vec2 brdfParam2 = texture2D(ambientCubemapLightBRDFLookup[0], vec2(rough2, ndv)).xy;
 vec3 envWeight2 = specFactor * brdfParam2.x + brdfParam2.y;
 vec3 envTexel2;
 for(int _idx_ = 0; _idx_ < AMBIENT_CUBEMAP_LIGHT_COUNT; _idx_++)
 {{
 envTexel2 = RGBMDecode(textureCubeLodEXT(ambientCubemapLightCubemap[_idx_], L, bias2), 8.12);
 specularTerm += ambientCubemapLightColor[_idx_] * envTexel2 * envWeight2 * ao;
 }}
#endif

 gl_FragColor.rgb = albedoColor.rgb * diffuseTerm + specularTerm;
 gl_FragColor.a = albedoColor.a;

#ifdef ATMOSPHERE_ENABLED
 float atmoIntensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor.rgb += glowColor * atmoIntensity;
#endif

#ifdef SRGB_ENCODE
 gl_FragColor = linearTosRGB(gl_FragColor);
#endif

 @import ecgl.common.emissiveLayer.main

 @import ecgl.common.wireframe.fragmentMain
}

@end`,zat=`@export ecgl.hatching.vertex

@import ecgl.realistic.vertex

@end


@export ecgl.hatching.fragment

#define NORMAL_UP_AXIS 1
#define NORMAL_FRONT_AXIS 2

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform vec4 color : [0.0, 0.0, 0.0, 1.0];
uniform vec4 paperColor : [1.0, 1.0, 1.0, 1.0];

uniform mat4 viewInverse : VIEWINVERSE;

#ifdef AMBIENT_LIGHT_COUNT
@import clay.header.ambient_light
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
@import clay.header.ambient_sh_light
#endif

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif


@import ecgl.common.ssaoMap.header

@import ecgl.common.bumpMap.header

@import clay.util.srgb

@import ecgl.common.wireframe.fragmentHeader

@import clay.plugin.compute_shadow_map

uniform sampler2D hatch1;
uniform sampler2D hatch2;
uniform sampler2D hatch3;
uniform sampler2D hatch4;
uniform sampler2D hatch5;
uniform sampler2D hatch6;

float shade(in float tone) {
 vec4 c = vec4(1. ,1., 1., 1.);
 float step = 1. / 6.;
 vec2 uv = v_DetailTexcoord;
 if (tone <= step / 2.0) {
 c = mix(vec4(0.), texture2D(hatch6, uv), 12. * tone);
 }
 else if (tone <= step) {
 c = mix(texture2D(hatch6, uv), texture2D(hatch5, uv), 6. * tone);
 }
 if(tone > step && tone <= 2. * step){
 c = mix(texture2D(hatch5, uv), texture2D(hatch4, uv) , 6. * (tone - step));
 }
 if(tone > 2. * step && tone <= 3. * step){
 c = mix(texture2D(hatch4, uv), texture2D(hatch3, uv), 6. * (tone - 2. * step));
 }
 if(tone > 3. * step && tone <= 4. * step){
 c = mix(texture2D(hatch3, uv), texture2D(hatch2, uv), 6. * (tone - 3. * step));
 }
 if(tone > 4. * step && tone <= 5. * step){
 c = mix(texture2D(hatch2, uv), texture2D(hatch1, uv), 6. * (tone - 4. * step));
 }
 if(tone > 5. * step){
 c = mix(texture2D(hatch1, uv), vec4(1.), 6. * (tone - 5. * step));
 }

 return c.r;
}

const vec3 w = vec3(0.2125, 0.7154, 0.0721);

void main()
{
#ifdef SRGB_DECODE
 vec4 inkColor = sRGBToLinear(color);
#else
 vec4 inkColor = color;
#endif

#ifdef VERTEX_COLOR
 #ifdef SRGB_DECODE
 inkColor *= sRGBToLinear(v_Color);
 #else
 inkColor *= v_Color;
 #endif
#endif

 vec3 N = v_Normal;
#ifdef DOUBLE_SIDED
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 N = -N;
 }
#endif

 float tone = 0.0;

 float ambientFactor = 1.0;

#ifdef BUMPMAP_ENABLED
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 ambientFactor = dot(v_Normal, N);
#endif

 vec3 N2 = vec3(N.x, N[NORMAL_UP_AXIS], N[NORMAL_FRONT_AXIS]);

 @import ecgl.common.ssaoMap.main

#ifdef AMBIENT_LIGHT_COUNT
 for(int i = 0; i < AMBIENT_LIGHT_COUNT; i++)
 {
 tone += dot(ambientLightColor[i], w) * ambientFactor * ao;
 }
#endif
#ifdef AMBIENT_SH_LIGHT_COUNT
 for(int _idx_ = 0; _idx_ < AMBIENT_SH_LIGHT_COUNT; _idx_++)
 {{
 tone += dot(calcAmbientSHLight(_idx_, N2) * ambientSHLightColor[_idx_], w) * ao;
 }}
#endif
#ifdef DIRECTIONAL_LIGHT_COUNT
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
#endif
 for(int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++)
 {
 vec3 lightDirection = -directionalLightDirection[i];
 float lightTone = dot(directionalLightColor[i], w);

 float shadowContrib = 1.0;
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 if (shadowEnabled)
 {
 shadowContrib = shadowContribsDir[i];
 }
#endif

 float ndl = dot(N, normalize(lightDirection)) * shadowContrib;

 tone += lightTone * clamp(ndl, 0.0, 1.0);
 }
#endif

 gl_FragColor = mix(inkColor, paperColor, shade(clamp(tone, 0.0, 1.0)));
 }
@end
`,kat=`@export ecgl.sm.depth.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
uniform float percent : 1.0;
#endif

varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;

void main(){

#ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
#else
 vec3 pos = position;
#endif

 v_ViewPosition = worldViewProjection * vec4(pos, 1.0);
 gl_Position = v_ViewPosition;

 v_Texcoord = texcoord;

}
@end



@export ecgl.sm.depth.fragment

@import clay.sm.depth.fragment

@end`;Object.assign(Wa.prototype,Nat);Et.import(Gk);Et.import(Nk);Et.import(Oat);Et.import(Fat);Et.import(Bat);Et.import(Uat);Et.import(zat);Et.import(kat);function Gat(e){return!e||e==="none"}function Vk(e){return e instanceof HTMLCanvasElement||e instanceof HTMLImageElement||e instanceof Image}function Vat(e){return e.getZr&&e.setOption}var Hat=Xs.prototype.addToScene,Wat=Xs.prototype.removeFromScene;Xs.prototype.addToScene=function(e){if(Hat.call(this,e),this.__zr){var t=this.__zr;e.traverse(function(r){r.__zr=t,r.addAnimatorsToZr&&r.addAnimatorsToZr(t)})}};Xs.prototype.removeFromScene=function(e){Wat.call(this,e),e.traverse(function(t){var r=t.__zr;t.__zr=null,r&&t.removeAnimatorsFromZr&&t.removeAnimatorsFromZr(r)})};Vi.prototype.setTextureImage=function(e,t,r,n){if(this.shader){var i=r.getZr(),a=this,o;return a.autoUpdateTextureStatus=!1,a.disableTexture(e),Gat(t)||(o=U.loadTexture(t,r,n,function(s){a.enableTexture(e),i&&i.refresh()}),a.set(e,o)),o}};var U={};U.Renderer=Hi;U.Node=Wa;U.Mesh=Qr;U.Shader=Et;U.Material=Vi;U.Texture=Mt;U.Texture2D=xe;U.Geometry=Ce;U.SphereGeometry=Dat;U.PlaneGeometry=h0;U.CubeGeometry=zk;U.AmbientLight=Lat;U.DirectionalLight=Rat;U.PointLight=Pat;U.SpotLight=Iat;U.PerspectiveCamera=Kr;U.OrthographicCamera=bf;U.Vector2=ce;U.Vector3=ht;U.Vector4=Ve;U.Quaternion=Je;U.Matrix2=Vn;U.Matrix2d=si;U.Matrix3=Yr;U.Matrix4=Nt;U.Plane=Rd;U.Ray=mu;U.BoundingBox=vn;U.Frustum=l0;var ag=null;function Xat(){return ag!==null||(ag=Xa.createBlank("rgba(255,255,255,0)").image),ag}function cI(e){return Math.pow(2,Math.round(Math.log(e)/Math.LN2))}function dI(e){if((e.wrapS===Mt.REPEAT||e.wrapT===Mt.REPEAT)&&e.image){var t=cI(e.width),r=cI(e.height);if(t!==e.width||r!==e.height){var n=document.createElement("canvas");n.width=t,n.height=r;var i=n.getContext("2d");i.drawImage(e.image,0,0,t,r),e.image=n}}}U.loadTexture=function(e,t,r,n){typeof r=="function"&&(n=r,r={}),r=r||{};for(var i=Object.keys(r).sort(),a="",o=0;o<i.length;o++)a+=i[o]+"_"+r[i[o]]+"_";var s=t.__textureCache=t.__textureCache||new Bf(20);if(Vat(e)){var l=e.__textureid__,u=s.get(a+l);if(u)u.texture.surface.setECharts(e),n&&n(u.texture);else{var h=new WT(e);h.onupdate=function(){t.getZr().refresh()},u={texture:h.getTexture()};for(var o=0;o<i.length;o++)u.texture[i[o]]=r[i[o]];l=e.__textureid__||"__ecgl_ec__"+u.texture.__uid__,e.__textureid__=l,s.put(a+l,u),n&&n(u.texture)}return u.texture}else if(Vk(e)){var l=e.__textureid__,u=s.get(a+l);if(!u){u={texture:new U.Texture2D({image:e})};for(var o=0;o<i.length;o++)u.texture[i[o]]=r[i[o]];l=e.__textureid__||"__ecgl_image__"+u.texture.__uid__,e.__textureid__=l,s.put(a+l,u),dI(u.texture),n&&n(u.texture)}return u.texture}else{var u=s.get(a+e);if(u)u.callbacks?u.callbacks.push(n):n&&n(u.texture);else if(e.match(/.hdr$|^data:application\/octet-stream/)){u={callbacks:[n]};var f=Xa.loadTexture(e,{exposure:r.exposure,fileType:"hdr"},function(){f.dirty(),u.callbacks.forEach(function(v){v&&v(f)}),u.callbacks=null});u.texture=f,s.put(a+e,u)}else{for(var f=new U.Texture2D({image:new Image}),o=0;o<i.length;o++)f[i[o]]=r[i[o]];u={texture:f,callbacks:[n]};var c=f.image;c.onload=function(){f.image=c,dI(f),f.dirty(),u.callbacks.forEach(function(p){p&&p(f)}),u.callbacks=null},c.crossOrigin="Anonymous",c.src=e,f.image=Xat(),s.put(a+e,u)}return u.texture}};U.createAmbientCubemap=function(e,t,r,n){e=e||{};var i=e.texture,a=Ee.firstNotNull(e.exposure,1),o=new wat({intensity:Ee.firstNotNull(e.specularIntensity,1)}),s=new Mat({intensity:Ee.firstNotNull(e.diffuseIntensity,1),coefficients:[.844,.712,.691,-.037,.083,.167,.343,.288,.299,-.041,-.021,-.009,-.003,-.041,-.064,-.011,-.007,-.004,-.031,.034,.081,-.06,-.049,-.06,.046,.056,.05]});return o.cubemap=U.loadTexture(i,r,{exposure:a},function(){o.cubemap.flipY=!1,o.prefilter(t,32),s.coefficients=kk.projectEnvironmentMap(t,o.cubemap,{lod:1}),n&&n()}),{specular:o,diffuse:s}};U.createBlankTexture=Xa.createBlank;U.isImage=Vk;U.additiveBlend=function(e){e.blendEquation(e.FUNC_ADD),e.blendFunc(e.SRC_ALPHA,e.ONE)};U.parseColor=function(e,t){return e instanceof Array?(t||(t=[]),t[0]=e[0],t[1]=e[1],t[2]=e[2],e.length>3?t[3]=e[3]:t[3]=1,t):(t=kn(e||"#000",t)||[0,0,0,0],t[0]/=255,t[1]/=255,t[2]/=255,t)};U.directionFromAlphaBeta=function(e,t){var r=e/180*Math.PI+Math.PI/2,n=-t/180*Math.PI+Math.PI/2,i=[],a=Math.sin(r);return i[0]=a*Math.cos(n),i[1]=-Math.cos(r),i[2]=a*Math.sin(n),i};U.getShadowResolution=function(e){var t=1024;switch(e){case"low":t=512;break;case"medium":break;case"high":t=2048;break;case"ultra":t=4096;break}return t};U.COMMON_SHADERS=["lambert","color","realistic","hatching","shadow"];U.createShader=function(e){e==="ecgl.shadow"&&(e="ecgl.displayShadow");var t=Et.source(e+".vertex"),r=Et.source(e+".fragment");t||console.error("Vertex shader of '%s' not exits",e),r||console.error("Fragment shader of '%s' not exits",e);var n=new Et(t,r);return n.name=e,n};U.createMaterial=function(e,t){t instanceof Array||(t=[t]);var r=U.createShader(e),n=new Vi({shader:r});return t.forEach(function(i){typeof i=="string"&&n.define(i)}),n};U.setMaterialFromModel=function(e,t,r,n){t.autoUpdateTextureStatus=!1;var i=r.getModel(e+"Material"),a=i.get("detailTexture"),o=Ee.firstNotNull(i.get("textureTiling"),1),s=Ee.firstNotNull(i.get("textureOffset"),0);typeof o=="number"&&(o=[o,o]),typeof s=="number"&&(s=[s,s]);var l=o[0]>1||o[1]>1?U.Texture.REPEAT:U.Texture.CLAMP_TO_EDGE,u={anisotropic:8,wrapS:l,wrapT:l};if(e==="realistic"){var h=i.get("roughness"),f=i.get("metalness");f!=null?isNaN(f)&&(t.setTextureImage("metalnessMap",f,n,u),f=Ee.firstNotNull(i.get("metalnessAdjust"),.5)):f=0,h!=null?isNaN(h)&&(t.setTextureImage("roughnessMap",h,n,u),h=Ee.firstNotNull(i.get("roughnessAdjust"),.5)):h=.5;var c=i.get("normalTexture");t.setTextureImage("detailMap",a,n,u),t.setTextureImage("normalMap",c,n,u),t.set({roughness:h,metalness:f,detailUvRepeat:o,detailUvOffset:s})}else if(e==="lambert")t.setTextureImage("detailMap",a,n,u),t.set({detailUvRepeat:o,detailUvOffset:s});else if(e==="color")t.setTextureImage("detailMap",a,n,u),t.set({detailUvRepeat:o,detailUvOffset:s});else if(e==="hatching"){var d=i.get("hatchingTextures")||[];d.length<6;for(var v=0;v<6;v++)t.setTextureImage("hatch"+(v+1),d[v],n,{anisotropic:8,wrapS:U.Texture.REPEAT,wrapT:U.Texture.REPEAT});t.set({detailUvRepeat:o,detailUvOffset:s})}};U.updateVertexAnimation=function(e,t,r,n){var i=n.get("animation"),a=n.get("animationDurationUpdate"),o=n.get("animationEasingUpdate"),s=r.shadowDepthMaterial;if(i&&t&&a>0&&t.geometry.vertexCount===r.geometry.vertexCount){r.material.define("vertex","VERTEX_ANIMATION"),r.ignorePreZ=!0,s&&s.define("vertex","VERTEX_ANIMATION");for(var l=0;l<e.length;l++)r.geometry.attributes[e[l][0]].value=t.geometry.attributes[e[l][1]].value;r.geometry.dirty(),r.__percent=0,r.material.set("percent",0),r.stopAnimation(),r.animate().when(a,{__percent:1}).during(function(){r.material.set("percent",r.__percent),s&&s.set("percent",r.__percent)}).done(function(){r.ignorePreZ=!1,r.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")}).start(o)}else r.material.undefine("vertex","VERTEX_ANIMATION"),s&&s.undefine("vertex","VERTEX_ANIMATION")};var lr=function(e,t){this.id=e,this.zr=t;try{this.renderer=new Hi({clearBit:0,devicePixelRatio:t.painter.dpr,preserveDrawingBuffer:!0,premultipliedAlpha:!0}),this.renderer.resize(t.painter.getWidth(),t.painter.getHeight())}catch(n){this.renderer=null,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute; left: 0; top: 0; right: 0; bottom: 0;",this.dom.className="ecgl-nowebgl",this.dom.innerHTML="Sorry, your browser does not support WebGL",console.error(n);return}this.onglobalout=this.onglobalout.bind(this),t.on("globalout",this.onglobalout),this.dom=this.renderer.canvas;var r=this.dom.style;r.position="absolute",r.left="0",r.top="0",this.views=[],this._picking=new rA({renderer:this.renderer}),this._viewsToDispose=[],this._accumulatingId=0,this._zrEventProxy=new Ae({shape:{x:-1,y:-1,width:2,height:2},__isGLToZRProxy:!0}),this._backgroundColor=null,this._disposed=!1};lr.prototype.setUnpainted=function(){};lr.prototype.addView=function(e){if(e.layer!==this){var t=this._viewsToDispose.indexOf(e);t>=0&&this._viewsToDispose.splice(t,1),this.views.push(e),e.layer=this;var r=this.zr;e.scene.traverse(function(n){n.__zr=r,n.addAnimatorsToZr&&n.addAnimatorsToZr(r)})}};function Hk(e){var t=e.__zr;e.__zr=null,t&&e.removeAnimatorsFromZr&&e.removeAnimatorsFromZr(t)}lr.prototype.removeView=function(e){if(e.layer===this){var t=this.views.indexOf(e);t>=0&&(this.views.splice(t,1),e.scene.traverse(Hk,this),e.layer=null,this._viewsToDispose.push(e))}};lr.prototype.removeViewsAll=function(){this.views.forEach(function(e){e.scene.traverse(Hk,this),e.layer=null,this._viewsToDispose.push(e)},this),this.views.length=0};lr.prototype.resize=function(e,t){var r=this.renderer;r.resize(e,t)};lr.prototype.clear=function(){var e=this.renderer.gl,t=this._backgroundColor||[0,0,0,0];e.clearColor(t[0],t[1],t[2],t[3]),e.depthMask(!0),e.colorMask(!0,!0,!0,!0),e.clear(e.DEPTH_BUFFER_BIT|e.COLOR_BUFFER_BIT)};lr.prototype.clearDepth=function(){var e=this.renderer.gl;e.clear(e.DEPTH_BUFFER_BIT)};lr.prototype.clearColor=function(){var e=this.renderer.gl;e.clearColor(0,0,0,0),e.clear(e.COLOR_BUFFER_BIT)};lr.prototype.needsRefresh=function(){this.zr.refresh()};lr.prototype.refresh=function(e){this._backgroundColor=e?U.parseColor(e):[0,0,0,0],this.renderer.clearColor=this._backgroundColor;for(var t=0;t<this.views.length;t++)this.views[t].prepareRender(this.renderer);this._doRender(!1),this._trackAndClean();for(var t=0;t<this._viewsToDispose.length;t++)this._viewsToDispose[t].dispose(this.renderer);this._viewsToDispose.length=0,this._startAccumulating()};lr.prototype.renderToCanvas=function(e){this._startAccumulating(!0),e.drawImage(this.dom,0,0,e.canvas.width,e.canvas.height)};lr.prototype._doRender=function(e){this.clear(),this.renderer.saveViewport();for(var t=0;t<this.views.length;t++)this.views[t].render(this.renderer,e);this.renderer.restoreViewport()};lr.prototype._stopAccumulating=function(){this._accumulatingId=0,clearTimeout(this._accumulatingTimeout)};var Yat=1;lr.prototype._startAccumulating=function(e){var t=this;this._stopAccumulating();for(var r=!1,n=0;n<this.views.length;n++)r=this.views[n].needsAccumulate()||r;if(!r)return;function i(a){if(!(!t._accumulatingId||a!==t._accumulatingId)){for(var o=!0,s=0;s<t.views.length;s++)o=t.views[s].isAccumulateFinished()&&r;o||(t._doRender(!0),e?i(a):xu(function(){i(a)}))}}this._accumulatingId=Yat++,e?i(t._accumulatingId):this._accumulatingTimeout=setTimeout(function(){i(t._accumulatingId)},50)};lr.prototype._trackAndClean=function(){var e=[],t=[];this._textureList&&(a_(this._textureList),a_(this._geometriesList));for(var r=0;r<this.views.length;r++)Zat(this.views[r].scene,e,t);this._textureList&&(o_(this.renderer,this._textureList),o_(this.renderer,this._geometriesList)),this._textureList=e,this._geometriesList=t};function a_(e){for(var t=0;t<e.length;t++)e[t].__used__=0}function o_(e,t){for(var r=0;r<t.length;r++)t[r].__used__||t[r].dispose(e)}function og(e,t){e.__used__=e.__used__||0,e.__used__++,e.__used__===1&&t.push(e)}function Zat(e,t,r){var n,i;e.traverse(function(o){if(o.isRenderable()){var s=o.geometry,l=o.material;if(l!==n)for(var u=l.getTextureUniforms(),h=0;h<u.length;h++){var f=u[h],c=l.uniforms[f].value;if(c){if(c instanceof Mt)og(c,t);else if(c instanceof Array)for(var d=0;d<c.length;d++)c[d]instanceof Mt&&og(c[d],t)}}s!==i&&og(s,r),n=l,i=s}});for(var a=0;a<e.lights.length;a++)e.lights[a].cubemap&&og(e.lights[a].cubemap,t)}lr.prototype.dispose=function(){this._disposed||(this._stopAccumulating(),this._textureList&&(a_(this._textureList),a_(this._geometriesList),o_(this.renderer,this._textureList),o_(this.renderer,this._geometriesList)),this.zr.off("globalout",this.onglobalout),this._disposed=!0)};lr.prototype.onmousedown=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mousedown",e,t),this._dispatchDataEvent("mousedown",e,t)),this._downX=e.offsetX,this._downY=e.offsetY}};lr.prototype.onmousemove=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY),r=t&&t.target,n=this._hovered;this._hovered=t,n&&r!==n.target&&(n.relatedTarget=r,this._dispatchEvent("mouseout",e,n),this.zr.setCursorStyle("default")),this._dispatchEvent("mousemove",e,t),t&&(this.zr.setCursorStyle("pointer"),(!n||r!==n.target)&&this._dispatchEvent("mouseover",e,t)),this._dispatchDataEvent("mousemove",e,t)}};lr.prototype.onmouseup=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){e=e.event;var t=this.pickObject(e.offsetX,e.offsetY);t&&(this._dispatchEvent("mouseup",e,t),this._dispatchDataEvent("mouseup",e,t)),this._upX=e.offsetX,this._upY=e.offsetY}};lr.prototype.onclick=lr.prototype.dblclick=function(e){if(!(e.target&&e.target.__isGLToZRProxy)){var t=this._upX-this._downX,r=this._upY-this._downY;if(!(Math.sqrt(t*t+r*r)>20)){e=e.event;var n=this.pickObject(e.offsetX,e.offsetY);n&&(this._dispatchEvent(e.type,e,n),this._dispatchDataEvent(e.type,e,n));var i=this._clickToSetFocusPoint(e);if(i){var a=i.view.setDOFFocusOnPoint(i.distance);a&&this.zr.refresh()}}}};lr.prototype._clickToSetFocusPoint=function(e){for(var t=this.renderer,r=t.viewport,n=this.views.length-1;n>=0;n--){var i=this.views[n];if(i.hasDOF()&&i.containPoint(e.offsetX,e.offsetY)){this._picking.scene=i.scene,this._picking.camera=i.camera,t.viewport=i.viewport;var a=this._picking.pick(e.offsetX,e.offsetY,!0);if(a)return a.view=i,a}}t.viewport=r};lr.prototype.onglobalout=function(e){var t=this._hovered;t&&this._dispatchEvent("mouseout",e,{target:t.target})};lr.prototype.pickObject=function(e,t){for(var r=[],n=this.renderer,i=n.viewport,a=0;a<this.views.length;a++){var o=this.views[a];o.containPoint(e,t)&&(this._picking.scene=o.scene,this._picking.camera=o.camera,n.viewport=o.viewport,this._picking.pickAll(e,t,r))}return n.viewport=i,r.sort(function(s,l){return s.distance-l.distance}),r[0]};lr.prototype._dispatchEvent=function(e,t,r){r||(r={});var n=r.target;for(r.cancelBubble=!1,r.event=t,r.type=e,r.offsetX=t.offsetX,r.offsetY=t.offsetY;n&&(n.trigger(e,r),n=n.getParent(),!r.cancelBubble););this._dispatchToView(e,r)};lr.prototype._dispatchDataEvent=function(e,t,r){var n=r&&r.target,i=n&&n.dataIndex,a=n&&n.seriesIndex,o=n&&n.eventData,s=!1,l=this._zrEventProxy;l.x=t.offsetX,l.y=t.offsetY,l.update();var u={target:l};const h=oe(l);e==="mousemove"&&(i!=null?i!==this._lastDataIndex&&(parseInt(this._lastDataIndex,10)>=0&&(h.dataIndex=this._lastDataIndex,h.seriesIndex=this._lastSeriesIndex,this.zr.handler.dispatchToElement(u,"mouseout",t)),s=!0):o!=null&&o!==this._lastEventData&&(this._lastEventData!=null&&(h.eventData=this._lastEventData,this.zr.handler.dispatchToElement(u,"mouseout",t)),s=!0),this._lastEventData=o,this._lastDataIndex=i,this._lastSeriesIndex=a),h.eventData=o,h.dataIndex=i,h.seriesIndex=a,(o!=null||parseInt(i,10)>=0&&parseInt(a,10)>=0)&&(this.zr.handler.dispatchToElement(u,e,t),s&&this.zr.handler.dispatchToElement(u,"mouseover",t))};lr.prototype._dispatchToView=function(e,t){for(var r=0;r<this.views.length;r++)this.views[r].containPoint(t.offsetX,t.offsetY)&&this.views[r].trigger(e,t)};Object.assign(lr.prototype,eA);var qat=["bar3D","line3D","map3D","scatter3D","surface","lines3D","scatterGL","scatter3D"];function fd(e,t){if(e&&e[t]&&(e[t].normal||e[t].emphasis)){var r=e[t].normal,n=e[t].emphasis;r&&(e[t]=r),n&&(e.emphasis=e.emphasis||{},e.emphasis[t]=n)}}function $at(e){fd(e,"itemStyle"),fd(e,"lineStyle"),fd(e,"areaStyle"),fd(e,"label")}function sg(e){e&&(e instanceof Array||(e=[e]),R(e,function(t){if(t.axisLabel){var r=t.axisLabel;Object.assign(r,r.textStyle),r.textStyle=null}}))}function Kat(e){R(e.series,function(t){pe(qat,t.type)>=0&&($at(t),t.coordinateSystem==="mapbox"&&(t.coordinateSystem="mapbox3D",e.mapbox3D=e.mapbox))}),sg(e.xAxis3D),sg(e.yAxis3D),sg(e.zAxis3D),sg(e.grid3D),fd(e.geo3D)}function Wk(e){this._layers={},this._zr=e}Wk.prototype.update=function(e,t){var r=this,n=t.getZr();if(!n.getWidth()||!n.getHeight()){console.warn("Dom has no width or height");return}function i(s){n.setSleepAfterStill(0);var l;s.coordinateSystem&&s.coordinateSystem.model,l=s.get("zlevel");var u=r._layers,h=u[l];if(!h){if(h=u[l]=new lr("gl-"+l,n),n.painter.isSingleCanvas()){h.virtual=!0;var f=new hn({z:1e4,style:{image:h.renderer.canvas},silent:!0});h.__hostImage=f,n.add(f)}n.painter.insertLayer(l,h)}return h.__hostImage&&h.__hostImage.setStyle({width:h.renderer.getWidth(),height:h.renderer.getHeight()}),h}function a(s,l){s&&s.traverse(function(u){u.isRenderable&&u.isRenderable()&&(u.ignorePicking=u.$ignorePicking!=null?u.$ignorePicking:l)})}for(var o in this._layers)this._layers[o].removeViewsAll();e.eachComponent(function(s,l){if(s!=="series"){var u=t.getViewOfComponentModel(l),h=l.coordinateSystem;if(u.__ecgl__){var f;if(h){if(!h.viewGL){console.error("Can't find viewGL in coordinateSystem of component "+l.id);return}f=h.viewGL}else{if(!l.viewGL){console.error("Can't find viewGL of component "+l.id);return}f=h.viewGL}var f=h.viewGL,c=i(l);c.addView(f),u.afterRender&&u.afterRender(l,e,t,c),a(u.groupGL,l.get("silent"))}}}),e.eachSeries(function(s){var l=t.getViewOfSeriesModel(s),u=s.coordinateSystem;if(l.__ecgl__){if(u&&!u.viewGL&&!l.viewGL){console.error("Can't find viewGL of series "+l.id);return}var h=u&&u.viewGL||l.viewGL,f=i(s);f.addView(h),l.afterRender&&l.afterRender(s,e,t,f),a(l.groupGL,s.get("silent"))}})};GF(function(e){var t=e.getZr(),r=t.painter.dispose;t.painter.dispose=function(){typeof this.eachOtherLayer=="function"&&this.eachOtherLayer(function(n){n instanceof lr&&n.dispose()}),r.call(this)},t.painter.getRenderedCanvas=function(n){if(n=n||{},this._singleCanvas)return this._layers[0].dom;var i=document.createElement("canvas"),a=n.pixelRatio||this.dpr;i.width=this.getWidth()*a,i.height=this.getHeight()*a;var o=i.getContext("2d");o.dpr=a,o.clearRect(0,0,i.width,i.height),n.backgroundColor&&(o.fillStyle=n.backgroundColor,o.fillRect(0,0,i.width,i.height));var s=this.storage.getDisplayList(!0),l={},u,h=this;function f(p,g){var m=h._zlevelList;p==null&&(p=-1/0);for(var _,y=0;y<m.length;y++){var x=m[y],T=h._layers[x];if(!T.__builtin__&&x>p&&x<g){_=T;break}}_&&_.renderToCanvas&&(o.save(),_.renderToCanvas(o),o.restore())}for(var c={ctx:o},d=0;d<s.length;d++){var v=s[d];v.zlevel!==u&&(f(u,v.zlevel),u=v.zlevel),this._doPaintEl(v,c,!0,null,l)}return f(u,1/0),i}});VF(function(e,t){var r=t.getZr(),n=r.__egl=r.__egl||new Wk(r);n.update(e,t)});Fw(Kat);const f0={defaultOption:{viewControl:{projection:"perspective",autoRotate:!1,autoRotateDirection:"cw",autoRotateSpeed:10,autoRotateAfterStill:3,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",distance:150,minDistance:40,maxDistance:400,orthographicSize:150,maxOrthographicSize:400,minOrthographicSize:20,center:[0,0,0],alpha:0,beta:0,minAlpha:-90,maxAlpha:90}},setView:function(e){e=e||{},this.option.viewControl=this.option.viewControl||{},e.alpha!=null&&(this.option.viewControl.alpha=e.alpha),e.beta!=null&&(this.option.viewControl.beta=e.beta),e.distance!=null&&(this.option.viewControl.distance=e.distance),e.center!=null&&(this.option.viewControl.center=e.center)}},tc={defaultOption:{postEffect:{enable:!1,bloom:{enable:!0,intensity:.1},depthOfField:{enable:!1,focalRange:20,focalDistance:50,blurRadius:10,fstop:2.8,quality:"medium"},screenSpaceAmbientOcclusion:{enable:!1,radius:2,quality:"medium",intensity:1},screenSpaceReflection:{enable:!1,quality:"medium",maxRoughness:.8},colorCorrection:{enable:!0,exposure:0,brightness:0,contrast:1,saturation:1,lookupTexture:""},edge:{enable:!1},FXAA:{enable:!1}},temporalSuperSampling:{enable:"auto"}}},ec={defaultOption:{light:{main:{shadow:!1,shadowQuality:"high",color:"#fff",intensity:1,alpha:0,beta:0},ambient:{color:"#fff",intensity:.2},ambientCubemap:{texture:null,exposure:1,diffuseIntensity:.5,specularIntensity:.5}}}};var c0=me.extend({type:"grid3D",dependencies:["xAxis3D","yAxis3D","zAxis3D"],defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",boxWidth:100,boxHeight:100,boxDepth:100,axisPointer:{show:!0,lineStyle:{color:"rgba(0, 0, 0, 0.8)",width:1},label:{show:!0,formatter:null,margin:8,textStyle:{fontSize:14,color:"#fff",backgroundColor:"rgba(0,0,0,0.5)",padding:3,borderRadius:3}}},axisLine:{show:!0,lineStyle:{color:"#333",width:2,type:"solid"}},axisTick:{show:!0,inside:!1,length:3,lineStyle:{width:1}},axisLabel:{show:!0,inside:!1,rotate:0,margin:8,textStyle:{fontSize:12}},splitLine:{show:!0,lineStyle:{color:["#ccc"],width:1,type:"solid"}},splitArea:{show:!1,areaStyle:{color:["rgba(250,250,250,0.3)","rgba(200,200,200,0.3)"]}},light:{main:{alpha:30,beta:40},ambient:{intensity:.4}},viewControl:{alpha:20,beta:40,autoRotate:!1,distance:200,minDistance:40,maxDistance:400}}});Ot(c0.prototype,f0);Ot(c0.prototype,tc);Ot(c0.prototype,ec);var Wc=Ee.firstNotNull,vI={left:0,middle:1,right:2};function pI(e){return e instanceof Array||(e=[e,e]),e}var zv=gn.extend(function(){return{zr:null,viewGL:null,_center:new ht,minDistance:.5,maxDistance:1.5,maxOrthographicSize:300,minOrthographicSize:30,minAlpha:-90,maxAlpha:90,minBeta:-1/0,maxBeta:1/0,autoRotateAfterStill:0,autoRotateDirection:"cw",autoRotateSpeed:60,damping:.8,rotateSensitivity:1,zoomSensitivity:1,panSensitivity:1,panMouseButton:"middle",rotateMouseButton:"left",_mode:"rotate",_camera:null,_needsUpdate:!1,_rotating:!1,_phi:0,_theta:0,_mouseX:0,_mouseY:0,_rotateVelocity:new ce,_panVelocity:new ce,_distance:500,_zoomSpeed:0,_stillTimeout:0,_animators:[]}},function(){["_mouseDownHandler","_mouseWheelHandler","_mouseMoveHandler","_mouseUpHandler","_pinchHandler","_contextMenuHandler","_update"].forEach(function(e){this[e]=this[e].bind(this)},this)},{init:function(){var e=this.zr;e&&(e.on("mousedown",this._mouseDownHandler),e.on("globalout",this._mouseUpHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("pinch",this._pinchHandler),e.animation.on("frame",this._update),e.dom.addEventListener("contextmenu",this._contextMenuHandler))},dispose:function(){var e=this.zr;e&&(e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("pinch",this._pinchHandler),e.off("globalout",this._mouseUpHandler),e.dom.removeEventListener("contextmenu",this._contextMenuHandler),e.animation.off("frame",this._update)),this.stopAllAnimation()},getDistance:function(){return this._distance},setDistance:function(e){this._distance=e,this._needsUpdate=!0},getOrthographicSize:function(){return this._orthoSize},setOrthographicSize:function(e){this._orthoSize=e,this._needsUpdate=!0},getAlpha:function(){return this._theta/Math.PI*180},getBeta:function(){return-this._phi/Math.PI*180},getCenter:function(){return this._center.toArray()},setAlpha:function(e){e=Math.max(Math.min(this.maxAlpha,e),this.minAlpha),this._theta=e/180*Math.PI,this._needsUpdate=!0},setBeta:function(e){e=Math.max(Math.min(this.maxBeta,e),this.minBeta),this._phi=-e/180*Math.PI,this._needsUpdate=!0},setCenter:function(e){this._center.setArray(e)},setViewGL:function(e){this.viewGL=e},getCamera:function(){return this.viewGL.camera},setFromViewControlModel:function(e,t){t=t||{};var r=t.baseDistance||0,n=t.baseOrthoSize||1,i=e.get("projection");i!=="perspective"&&i!=="orthographic"&&i!=="isometric"&&(i="perspective"),this._projection=i,this.viewGL.setProjection(i);var a=e.get("distance")+r,o=e.get("orthographicSize")+n;[["damping",.8],["autoRotate",!1],["autoRotateAfterStill",3],["autoRotateDirection","cw"],["autoRotateSpeed",10],["minDistance",30],["maxDistance",400],["minOrthographicSize",30],["maxOrthographicSize",300],["minAlpha",-90],["maxAlpha",90],["minBeta",-1/0],["maxBeta",1/0],["rotateSensitivity",1],["zoomSensitivity",1],["panSensitivity",1],["panMouseButton","left"],["rotateMouseButton","middle"]].forEach(function(c){this[c[0]]=Wc(e.get(c[0]),c[1])},this),this.minDistance+=r,this.maxDistance+=r,this.minOrthographicSize+=n,this.maxOrthographicSize+=n;var s=e.ecModel,l={};["animation","animationDurationUpdate","animationEasingUpdate"].forEach(function(c){l[c]=Wc(e.get(c),s&&s.get(c))});var u=Wc(t.alpha,e.get("alpha"))||0,h=Wc(t.beta,e.get("beta"))||0,f=Wc(t.center,e.get("center"))||[0,0,0];l.animation&&l.animationDurationUpdate>0&&this._notFirst?this.animateTo({alpha:u,beta:h,center:f,distance:a,orthographicSize:o,easing:l.animationEasingUpdate,duration:l.animationDurationUpdate}):(this.setDistance(a),this.setAlpha(u),this.setBeta(h),this.setCenter(f),this.setOrthographicSize(o)),this._notFirst=!0,this._validateProperties()},_validateProperties:function(){},animateTo:function(e){var t=this.zr,r=this,n={},i={};return e.distance!=null&&(n.distance=this.getDistance(),i.distance=e.distance),e.orthographicSize!=null&&(n.orthographicSize=this.getOrthographicSize(),i.orthographicSize=e.orthographicSize),e.alpha!=null&&(n.alpha=this.getAlpha(),i.alpha=e.alpha),e.beta!=null&&(n.beta=this.getBeta(),i.beta=e.beta),e.center!=null&&(n.center=this.getCenter(),i.center=e.center),this._addAnimator(t.animation.animate(n).when(e.duration||1e3,i).during(function(){n.alpha!=null&&r.setAlpha(n.alpha),n.beta!=null&&r.setBeta(n.beta),n.distance!=null&&r.setDistance(n.distance),n.center!=null&&r.setCenter(n.center),n.orthographicSize!=null&&r.setOrthographicSize(n.orthographicSize),r._needsUpdate=!0})).start(e.easing||"linear")},stopAllAnimation:function(){for(var e=0;e<this._animators.length;e++)this._animators[e].stop();this._animators.length=0},update:function(){this._needsUpdate=!0,this._update(20)},_isAnimating:function(){return this._animators.length>0},_update:function(e){if(this._rotating){var t=(this.autoRotateDirection==="cw"?1:-1)*this.autoRotateSpeed/180*Math.PI;this._phi-=t*e/1e3,this._needsUpdate=!0}else this._rotateVelocity.len()>0&&(this._needsUpdate=!0);(Math.abs(this._zoomSpeed)>.1||this._panVelocity.len()>0)&&(this._needsUpdate=!0),this._needsUpdate&&(e=Math.min(e,50),this._updateDistanceOrSize(e),this._updatePan(e),this._updateRotate(e),this._updateTransform(),this.getCamera().update(),this.zr&&this.zr.refresh(),this.trigger("update"),this._needsUpdate=!1)},_updateRotate:function(e){var t=this._rotateVelocity;this._phi=t.y*e/20+this._phi,this._theta=t.x*e/20+this._theta,this.setAlpha(this.getAlpha()),this.setBeta(this.getBeta()),this._vectorDamping(t,Math.pow(this.damping,e/16))},_updateDistanceOrSize:function(e){this._projection==="perspective"?this._setDistance(this._distance+this._zoomSpeed*e/20):this._setOrthoSize(this._orthoSize+this._zoomSpeed*e/20),this._zoomSpeed*=Math.pow(this.damping,e/16)},_setDistance:function(e){this._distance=Math.max(Math.min(e,this.maxDistance),this.minDistance)},_setOrthoSize:function(e){this._orthoSize=Math.max(Math.min(e,this.maxOrthographicSize),this.minOrthographicSize);var t=this.getCamera(),r=this._orthoSize,n=r/this.viewGL.viewport.height*this.viewGL.viewport.width;t.left=-n/2,t.right=n/2,t.top=r/2,t.bottom=-r/2},_updatePan:function(e){var t=this._panVelocity,r=this._distance,n=this.getCamera(),i=n.worldTransform.y,a=n.worldTransform.x;this._center.scaleAndAdd(a,-t.x*r/200).scaleAndAdd(i,-t.y*r/200),this._vectorDamping(t,0)},_updateTransform:function(){var e=this.getCamera(),t=new ht,r=this._theta+Math.PI/2,n=this._phi+Math.PI/2,i=Math.sin(r);t.x=i*Math.cos(n),t.y=-Math.cos(r),t.z=i*Math.sin(n),e.position.copy(this._center).scaleAndAdd(t,this._distance),e.rotation.identity().rotateY(-this._phi).rotateX(-this._theta)},_startCountingStill:function(){clearTimeout(this._stillTimeout);var e=this.autoRotateAfterStill,t=this;!isNaN(e)&&e>0&&(this._stillTimeout=setTimeout(function(){t._rotating=!0},e*1e3))},_vectorDamping:function(e,t){var r=e.len();r=r*t,r<1e-4&&(r=0),e.normalize().scale(r)},_decomposeTransform:function(){if(this.getCamera()){this.getCamera().updateWorldTransform();var e=this.getCamera().worldTransform.z,t=Math.asin(e.y),r=Math.atan2(e.x,e.z);this._theta=t,this._phi=-r,this.setBeta(this.getBeta()),this.setAlpha(this.getAlpha()),this.getCamera().aspect?this._setDistance(this.getCamera().position.dist(this._center)):this._setOrthoSize(this.getCamera().top-this.getCamera().bottom)}},_mouseDownHandler:function(e){if(!e.target&&!this._isAnimating()){var t=e.offsetX,r=e.offsetY;this.viewGL&&!this.viewGL.containPoint(t,r)||(this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler),e.event.targetTouches?e.event.targetTouches.length===1&&(this._mode="rotate"):e.event.button===vI[this.rotateMouseButton]?this._mode="rotate":e.event.button===vI[this.panMouseButton]?this._mode="pan":this._mode="",this._rotateVelocity.set(0,0),this._rotating=!1,this.autoRotate&&this._startCountingStill(),this._mouseX=e.offsetX,this._mouseY=e.offsetY)}},_mouseMoveHandler:function(e){if(!(e.target&&e.target.__isGLToZRProxy)&&!this._isAnimating()){var t=pI(this.panSensitivity),r=pI(this.rotateSensitivity);this._mode==="rotate"?(this._rotateVelocity.y=(e.offsetX-this._mouseX)/this.zr.getHeight()*2*r[0],this._rotateVelocity.x=(e.offsetY-this._mouseY)/this.zr.getWidth()*2*r[1]):this._mode==="pan"&&(this._panVelocity.x=(e.offsetX-this._mouseX)/this.zr.getWidth()*t[0]*400,this._panVelocity.y=(-e.offsetY+this._mouseY)/this.zr.getHeight()*t[1]*400),this._mouseX=e.offsetX,this._mouseY=e.offsetY,e.event.preventDefault()}},_mouseWheelHandler:function(e){if(!this._isAnimating()){var t=e.event.wheelDelta||-e.event.detail;this._zoomHandler(e,t)}},_pinchHandler:function(e){this._isAnimating()||(this._zoomHandler(e,e.pinchScale>1?1:-1),this._mode="")},_zoomHandler:function(e,t){if(t!==0){var r=e.offsetX,n=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(r,n))){var i;this._projection==="perspective"?i=Math.max(Math.max(Math.min(this._distance-this.minDistance,this.maxDistance-this._distance))/20,.5):i=Math.max(Math.max(Math.min(this._orthoSize-this.minOrthographicSize,this.maxOrthographicSize-this._orthoSize))/20,.5),this._zoomSpeed=(t>0?-1:1)*i*this.zoomSensitivity,this._rotating=!1,this.autoRotate&&this._mode==="rotate"&&this._startCountingStill(),e.event.preventDefault()}}},_mouseUpHandler:function(){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_isRightMouseButtonUsed:function(){return this.rotateMouseButton==="right"||this.panMouseButton==="right"},_contextMenuHandler:function(e){this._isRightMouseButtonUsed()&&e.preventDefault()},_addAnimator:function(e){var t=this._animators;return t.push(e),e.done(function(){var r=t.indexOf(e);r>=0&&t.splice(r,1)}),e}});Object.defineProperty(zv.prototype,"autoRotate",{get:function(e){return this._autoRotate},set:function(e){this._autoRotate=e,this._rotating=e}});const kv={convertToDynamicArray:function(e){e&&this.resetOffset();var t=this.attributes;for(var r in t)e||!t[r].value?t[r].value=[]:t[r].value=Array.prototype.slice.call(t[r].value);e||!this.indices?this.indices=[]:this.indices=Array.prototype.slice.call(this.indices)},convertToTypedArray:function(){var e=this.attributes;for(var t in e)e[t].value&&e[t].value.length>0?e[t].value=new Float32Array(e[t].value):e[t].value=null;this.indices&&this.indices.length>0&&(this.indices=this.vertexCount>65535?new Uint32Array(this.indices):new Uint16Array(this.indices)),this.dirty()}},Or={vec2:bt,vec3:W,vec4:yt,mat2:Ge,mat2d:$e,mat3:le,mat4:xt,quat:Bt};var l1=Or.vec3,gI=[[0,0],[1,1]],Ys=Ce.extend(function(){return{segmentScale:1,dynamic:!0,useNativeLine:!0,attributes:{position:new Ce.Attribute("position","float",3,"POSITION"),positionPrev:new Ce.Attribute("positionPrev","float",3),positionNext:new Ce.Attribute("positionNext","float",3),prevPositionPrev:new Ce.Attribute("prevPositionPrev","float",3),prevPosition:new Ce.Attribute("prevPosition","float",3),prevPositionNext:new Ce.Attribute("prevPositionNext","float",3),offset:new Ce.Attribute("offset","float",1),color:new Ce.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.positionPrev.init(e),t.positionNext.init(e),t.offset.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(e===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(e*3):new Uint16Array(e*3))},_getCubicCurveApproxStep:function(e,t,r,n){var i=l1.dist(e,t)+l1.dist(r,t)+l1.dist(n,r),a=1/(i+1)*this.segmentScale;return a},getCubicCurveVertexCount:function(e,t,r,n){var i=this._getCubicCurveApproxStep(e,t,r,n),a=Math.ceil(1/i);return this.useNativeLine?a*2:a*2+2},getCubicCurveTriangleCount:function(e,t,r,n){var i=this._getCubicCurveApproxStep(e,t,r,n),a=Math.ceil(1/i);return this.useNativeLine?0:a*2},getLineVertexCount:function(){return this.getPolylineVertexCount(gI)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(gI)},getPolylineVertexCount:function(e){var t;if(typeof e=="number")t=e;else{var r=typeof e[0]!="number";t=r?e.length:e.length/3}return this.useNativeLine?(t-1)*2:(t-1)*2+2},getPolylineTriangleCount:function(e){var t;if(typeof e=="number")t=e;else{var r=typeof e[0]!="number";t=r?e.length:e.length/3}return this.useNativeLine?0:Math.max(t-1,0)*2},addCubicCurve:function(e,t,r,n,i,a){a==null&&(a=1);for(var o=e[0],s=e[1],l=e[2],u=t[0],h=t[1],f=t[2],c=r[0],d=r[1],v=r[2],p=n[0],g=n[1],m=n[2],_=this._getCubicCurveApproxStep(e,t,r,n),y=_*_,x=y*_,T=3*_,S=3*y,M=6*y,w=6*x,b=o-u*2+c,A=s-h*2+d,E=l-f*2+v,C=(u-c)*3-o+p,D=(h-d)*3-s+g,L=(f-v)*3-l+m,P=o,N=s,O=l,I=(u-o)*T+b*S+C*x,k=(h-s)*T+A*S+D*x,z=(f-l)*T+E*S+L*x,X=b*M+C*w,Y=A*M+D*w,$=E*M+L*w,H=C*w,Z=D*w,ct=L*w,ut=0,tt=0,et=Math.ceil(1/_),st=new Float32Array((et+1)*3),st=[],nt=0,tt=0;tt<et+1;tt++)st[nt++]=P,st[nt++]=N,st[nt++]=O,P+=I,N+=k,O+=z,I+=X,k+=Y,z+=$,X+=H,Y+=Z,$+=ct,ut+=_,ut>1&&(P=I>0?Math.min(P,p):Math.max(P,p),N=k>0?Math.min(N,g):Math.max(N,g),O=z>0?Math.min(O,m):Math.max(O,m));return this.addPolyline(st,i,a)},addLine:function(e,t,r,n){return this.addPolyline([e,t],r,n)},addPolyline:function(e,t,r,n,i){if(e.length){var a=typeof e[0]!="number";if(i==null&&(i=a?e.length:e.length/3),!(i<2)){n==null&&(n=0),r==null&&(r=1),this._itemVertexOffsets.push(this._vertexOffset);var a=typeof e[0]!="number",o=a?typeof t[0]!="number":t.length/4===i,s=this.attributes.position,l=this.attributes.positionPrev,u=this.attributes.positionNext,h=this.attributes.color,f=this.attributes.offset,c=this.indices,d=this._vertexOffset,v,p;r=Math.max(r,.01);for(var g=n;g<i;g++){if(a)v=e[g],o?p=t[g]:p=t;else{var m=g*3;if(v=v||[],v[0]=e[m],v[1]=e[m+1],v[2]=e[m+2],o){var _=g*4;p=p||[],p[0]=t[_],p[1]=t[_+1],p[2]=t[_+2],p[3]=t[_+3]}else p=t}if(this.useNativeLine?g>1&&(s.copy(d,d-1),h.copy(d,d-1),d++):(g<i-1&&(l.set(d+2,v),l.set(d+3,v)),g>0&&(u.set(d-2,v),u.set(d-1,v)),s.set(d,v),s.set(d+1,v),h.set(d,p),h.set(d+1,p),f.set(d,r/2),f.set(d+1,-r/2),d+=2),this.useNativeLine)h.set(d,p),s.set(d,v),d++;else if(g>0){var y=this._triangleOffset*3,c=this.indices;c[y]=d-4,c[y+1]=d-3,c[y+2]=d-2,c[y+3]=d-3,c[y+4]=d-1,c[y+5]=d-2,this._triangleOffset+=2}}if(!this.useNativeLine){var x=this._vertexOffset,T=this._vertexOffset+i*2;l.copy(x,x+2),l.copy(x+1,x+3),u.copy(T-1,T-3),u.copy(T-2,T-4)}return this._vertexOffset=d,this._vertexOffset}}},setItemColor:function(e,t){for(var r=this._itemVertexOffsets[e],n=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,i=r;i<n;i++)this.attributes.color.set(i,t);this.dirty("color")},currentTriangleOffset:function(){return this._triangleOffset},currentVertexOffset:function(){return this._vertexOffset}});Vt(Ys.prototype,kv);function s_(e,t,r,n,i,a,o){this._zr=e,this._x=0,this._y=0,this._rowHeight=0,this.width=n,this.height=i,this.offsetX=t,this.offsetY=r,this.dpr=o,this.gap=a}s_.prototype={constructor:s_,clear:function(){this._x=0,this._y=0,this._rowHeight=0},add:function(e,t,r){var n=e.getBoundingRect();t==null&&(t=n.width),r==null&&(r=n.height),t*=this.dpr,r*=this.dpr,this._fitElement(e,t,r);var i=this._x,a=this._y,o=this.width*this.dpr,s=this.height*this.dpr,l=this.gap;if(i+t+l>o&&(i=this._x=0,a+=this._rowHeight+l,this._y=a,this._rowHeight=0),this._x+=t+l,this._rowHeight=Math.max(this._rowHeight,r),a+r+l>s)return null;e.x+=this.offsetX*this.dpr+i,e.y+=this.offsetY*this.dpr+a,this._zr.add(e);var u=[this.offsetX/this.width,this.offsetY/this.height],h=[[i/o+u[0],a/s+u[1]],[(i+t)/o+u[0],(a+r)/s+u[1]]];return h},_fitElement:function(e,t,r){var n=e.getBoundingRect(),i=t/n.width,a=r/n.height;e.x=-n.x*i,e.y=-n.y*a,e.scaleX=i,e.scaleY=a,e.update()}};function l_(e){e=e||{},e.width=e.width||512,e.height=e.height||512,e.devicePixelRatio=e.devicePixelRatio||1,e.gap=e.gap==null?2:e.gap;var t=document.createElement("canvas");t.width=e.width*e.devicePixelRatio,t.height=e.height*e.devicePixelRatio,this._canvas=t,this._texture=new xe({image:t,flipY:!1});var r=this;this._zr=_S(t);var n=this._zr.refreshImmediately;this._zr.refreshImmediately=function(){n.call(this),r._texture.dirty(),r.onupdate&&r.onupdate()},this._dpr=e.devicePixelRatio,this._coords={},this.onupdate=e.onupdate,this._gap=e.gap,this._textureAtlasNodes=[new s_(this._zr,0,0,e.width,e.height,this._gap,this._dpr)],this._nodeWidth=e.width,this._nodeHeight=e.height,this._currentNodeIdx=0}l_.prototype={clear:function(){for(var e=0;e<this._textureAtlasNodes.length;e++)this._textureAtlasNodes[e].clear();this._currentNodeIdx=0,this._zr.clear(),this._coords={}},getWidth:function(){return this._width},getHeight:function(){return this._height},getTexture:function(){return this._texture},getDevicePixelRatio:function(){return this._dpr},getZr:function(){return this._zr},_getCurrentNode:function(){return this._textureAtlasNodes[this._currentNodeIdx]},_expand:function(){if(this._currentNodeIdx++,this._textureAtlasNodes[this._currentNodeIdx])return this._textureAtlasNodes[this._currentNodeIdx];var e=4096/this._dpr,t=this._textureAtlasNodes,r=t.length,n=r*this._nodeWidth%e,i=Math.floor(r*this._nodeWidth/e)*this._nodeHeight;if(!(i>=e)){var a=(n+this._nodeWidth)*this._dpr,o=(i+this._nodeHeight)*this._dpr;try{this._zr.resize({width:a,height:o})}catch{this._canvas.width=a,this._canvas.height=o}var s=new s_(this._zr,n,i,this._nodeWidth,this._nodeHeight,this._gap,this._dpr);return this._textureAtlasNodes.push(s),s}},add:function(e,t,r){if(this._coords[e.id])return this._coords[e.id];var n=this._getCurrentNode().add(e,t,r);if(!n){var i=this._expand();if(!i)return;n=i.add(e,t,r)}return this._coords[e.id]=n,n},getCoordsScale:function(){var e=this._dpr;return[this._nodeWidth/this._canvas.width*e,this._nodeHeight/this._canvas.height*e]},getCoords:function(e){return this._coords[e]},dispose:function(){this._zr.dispose()}};function ks(){}ks.prototype={constructor:ks,setScene:function(e){this._scene=e,this._skybox&&this._skybox.attachScene(this._scene)},initLight:function(e){this._lightRoot=e,this.mainLight=new U.DirectionalLight({shadowBias:.005}),this.ambientLight=new U.AmbientLight,e.add(this.mainLight),e.add(this.ambientLight)},dispose:function(){this._lightRoot&&(this._lightRoot.remove(this.mainLight),this._lightRoot.remove(this.ambientLight))},updateLight:function(e){var t=this.mainLight,r=this.ambientLight,n=e.getModel("light"),i=n.getModel("main"),a=n.getModel("ambient");t.intensity=i.get("intensity"),r.intensity=a.get("intensity"),t.color=U.parseColor(i.get("color")).slice(0,3),r.color=U.parseColor(a.get("color")).slice(0,3);var o=i.get("alpha")||0,s=i.get("beta")||0;t.position.setArray(U.directionFromAlphaBeta(o,s)),t.lookAt(U.Vector3.ZERO),t.castShadow=i.get("shadow"),t.shadowResolution=U.getShadowResolution(i.get("shadowQuality"))},updateAmbientCubemap:function(e,t,r){var n=t.getModel("light.ambientCubemap"),i=n.get("texture");if(i){this._cubemapLightsCache=this._cubemapLightsCache||{};var a=this._cubemapLightsCache[i];if(!a){var o=this;a=this._cubemapLightsCache[i]=U.createAmbientCubemap(n.option,e,r,function(){o._isSkyboxFromAmbientCubemap&&o._skybox.setEnvironmentMap(a.specular.cubemap),r.getZr().refresh()})}this._lightRoot.add(a.diffuse),this._lightRoot.add(a.specular),this._currentCubemapLights=a}else this._currentCubemapLights&&(this._lightRoot.remove(this._currentCubemapLights.diffuse),this._lightRoot.remove(this._currentCubemapLights.specular),this._currentCubemapLights=null)},updateSkybox:function(e,t,r){var n=t.get("environment"),i=this;function a(){return i._skybox=i._skybox||new lv,i._skybox}var o=a();if(n&&n!=="none")if(n==="auto")if(this._isSkyboxFromAmbientCubemap=!0,this._currentCubemapLights){var s=this._currentCubemapLights.specular.cubemap;o.setEnvironmentMap(s),this._scene&&o.attachScene(this._scene),o.material.set("lod",3)}else this._skybox&&this._skybox.detachScene();else if(typeof n=="object"&&n.colorStops||typeof n=="string"&&kn(n)){this._isSkyboxFromAmbientCubemap=!1;var l=new U.Texture2D({anisotropic:8,flipY:!1});o.setEnvironmentMap(l);var u=l.image=document.createElement("canvas");u.width=u.height=16;var h=u.getContext("2d"),f=new Ae({shape:{x:0,y:0,width:16,height:16},style:{fill:n}});q_(h,f),o.attachScene(this._scene)}else{this._isSkyboxFromAmbientCubemap=!1;var l=U.loadTexture(n,r,{anisotropic:8,flipY:!1});o.setEnvironmentMap(l),o.attachScene(this._scene)}else this._skybox&&this._skybox.detachScene(this._scene),this._skybox=null;var c=t.coordinateSystem;if(this._skybox)if(c&&c.viewGL&&n!=="auto"&&!(n.match&&n.match(/.hdr$/))){var d=c.viewGL.isLinearSpace()?"define":"undefine";this._skybox.material[d]("fragment","SRGB_DECODE")}else this._skybox.material.undefine("fragment","SRGB_DECODE")}};var wl=Or.vec3,Xk=Ce.extend(function(){return{segmentScale:1,useNativeLine:!0,attributes:{position:new Ce.Attribute("position","float",3,"POSITION"),normal:new Ce.Attribute("normal","float",3,"NORMAL"),color:new Ce.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setQuadCount:function(e){var t=this.attributes,r=this.getQuadVertexCount()*e,n=this.getQuadTriangleCount()*e;this.vertexCount!==r&&(t.position.init(r),t.normal.init(r),t.color.init(r)),this.triangleCount!==n&&(this.indices=r>65535?new Uint32Array(n*3):new Uint16Array(n*3))},getQuadVertexCount:function(){return 4},getQuadTriangleCount:function(){return 2},addQuad:function(){var e=wl.create(),t=wl.create(),r=wl.create(),n=[0,3,1,3,2,1];return function(i,a){var o=this.attributes.position,s=this.attributes.normal,l=this.attributes.color;wl.sub(e,i[1],i[0]),wl.sub(t,i[2],i[1]),wl.cross(r,e,t),wl.normalize(r,r);for(var u=0;u<4;u++)o.set(this._vertexOffset+u,i[u]),l.set(this._vertexOffset+u,a),s.set(this._vertexOffset+u,r);for(var h=this._faceOffset*3,u=0;u<6;u++)this.indices[h+u]=n[u]+this._vertexOffset;this._vertexOffset+=4,this._faceOffset+=2}}()});Vt(Xk.prototype,kv);var XT=Ee.firstNotNull,jat={x:0,y:2,z:1};function Jat(e,t,r,n){var i=[0,0,0],a=n<0?r.getExtentMin():r.getExtentMax();i[jat[r.dim]]=a,e.position.setArray(i),e.rotation.identity(),t.distance=-Math.abs(a),t.normal.set(0,0,0),r.dim==="x"?(e.rotation.rotateY(n*Math.PI/2),t.normal.x=-n):r.dim==="z"?(e.rotation.rotateX(-n*Math.PI/2),t.normal.y=-n):(n>0&&e.rotation.rotateY(Math.PI),t.normal.z=-n)}function d0(e,t,r){this.rootNode=new U.Node;var n=new U.Mesh({geometry:new Ys({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:1}),i=new U.Mesh({geometry:new Xk,material:r,castShadow:!1,culling:!1,ignorePicking:!0,$ignorePicking:!0,renderOrder:0});this.rootNode.add(i),this.rootNode.add(n),this.faceInfo=e,this.plane=new U.Plane,this.linesMesh=n,this.quadsMesh=i}d0.prototype.update=function(e,t,r){var n=e.coordinateSystem,i=[n.getAxis(this.faceInfo[0]),n.getAxis(this.faceInfo[1])],a=this.linesMesh.geometry,o=this.quadsMesh.geometry;a.convertToDynamicArray(!0),o.convertToDynamicArray(!0),this._updateSplitLines(a,i,e,r),this._udpateSplitAreas(o,i,e,r),a.convertToTypedArray(),o.convertToTypedArray();var s=n.getAxis(this.faceInfo[2]);Jat(this.rootNode,this.plane,s,this.faceInfo[3])};d0.prototype._updateSplitLines=function(e,t,r,n){var i=n.getDevicePixelRatio();t.forEach(function(a,o){var s=a.model,l=t[1-o].getExtent();if(!a.scale.isBlank()){var u=s.getModel("splitLine",r.getModel("splitLine"));if(u.get("show")){var h=u.getModel("lineStyle"),f=h.get("color"),c=XT(h.get("opacity"),1),d=XT(h.get("width"),1);f=at(f)?f:[f];for(var v=a.getTicksCoords({tickModel:u}),p=0,g=0;g<v.length;g++){var m=v[g].coord,_=U.parseColor(f[p%f.length]);_[3]*=c;var y=[0,0,0],x=[0,0,0];y[o]=x[o]=m,y[1-o]=l[0],x[1-o]=l[1],e.addLine(y,x,_,d*i),p++}}}})};d0.prototype._udpateSplitAreas=function(e,t,r,n){t.forEach(function(i,a){var o=i.model,s=t[1-a].getExtent();if(!i.scale.isBlank()){var l=o.getModel("splitArea",r.getModel("splitArea"));if(l.get("show")){var u=l.getModel("areaStyle"),h=u.get("color"),f=XT(u.get("opacity"),1);h=at(h)?h:[h];for(var c=i.getTicksCoords({tickModel:l,clamp:!0}),d=0,v=[0,0,0],p=[0,0,0],g=0;g<c.length;g++){var m=c[g].coord,_=[0,0,0],y=[0,0,0];if(_[a]=y[a]=m,_[1-a]=s[0],y[1-a]=s[1],g===0){v=_,p=y;continue}var x=U.parseColor(h[d%h.length]);x[3]*=f,e.addQuad([v,_,y,p],x),v=_,p=y,d++}}}})};var mI=[0,1,2,0,2,3],Yk=Ce.extend(function(){return{attributes:{position:new Ce.Attribute("position","float",3,"POSITION"),texcoord:new Ce.Attribute("texcoord","float",2,"TEXCOORD_0"),offset:new Ce.Attribute("offset","float",2),color:new Ce.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setSpriteCount:function(e){this._spriteCount=e;var t=e*4,r=e*2;this.vertexCount!==t&&(this.attributes.position.init(t),this.attributes.offset.init(t),this.attributes.color.init(t)),this.triangleCount!==r&&(this.indices=t>65535?new Uint32Array(r*3):new Uint16Array(r*3))},setSpriteAlign:function(e,t,r,n,i){r==null&&(r="left"),n==null&&(n="top");var a,o,s,l;switch(i=i||0,r){case"left":a=i,s=t[0]+i;break;case"center":case"middle":a=-t[0]/2,s=t[0]/2;break;case"right":a=-t[0]-i,s=-i;break}switch(n){case"bottom":o=i,l=t[1]+i;break;case"middle":o=-t[1]/2,l=t[1]/2;break;case"top":o=-t[1]-i,l=-i;break}var u=e*4,h=this.attributes.offset;h.set(u,[a,l]),h.set(u+1,[s,l]),h.set(u+2,[s,o]),h.set(u+3,[a,o])},addSprite:function(e,t,r,n,i,a){var o=this._vertexOffset;this.setSprite(this._vertexOffset/4,e,t,r,n,i,a);for(var s=0;s<mI.length;s++)this.indices[this._faceOffset*3+s]=mI[s]+o;return this._faceOffset+=2,this._vertexOffset+=4,o/4},setSprite:function(e,t,r,n,i,a,o){for(var s=e*4,l=this.attributes,u=0;u<4;u++)l.position.set(s+u,t);var h=l.texcoord;h.set(s,[n[0][0],n[0][1]]),h.set(s+1,[n[1][0],n[0][1]]),h.set(s+2,[n[1][0],n[1][1]]),h.set(s+3,[n[0][0],n[1][1]]),this.setSpriteAlign(e,r,i,a,o)}});Vt(Yk.prototype,kv);const Qat=`@export ecgl.labels.vertex

attribute vec3 position: POSITION;
attribute vec2 texcoord: TEXCOORD_0;
attribute vec2 offset;
#ifdef VERTEX_COLOR
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;
#endif

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;

varying vec2 v_Texcoord;

void main()
{
 vec4 proj = worldViewProjection * vec4(position, 1.0);

 vec2 screen = (proj.xy / abs(proj.w) + 1.0) * 0.5 * viewport.zw;

 screen += offset;

 proj.xy = (screen / viewport.zw - 0.5) * 2.0 * abs(proj.w);
 gl_Position = proj;
#ifdef VERTEX_COLOR
 v_Color = a_Color;
#endif
 v_Texcoord = texcoord;
}
@end


@export ecgl.labels.fragment

uniform vec3 color : [1.0, 1.0, 1.0];
uniform float alpha : 1.0;
uniform sampler2D textureAtlas;
uniform vec2 uvScale: [1.0, 1.0];

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif
varying float v_Miter;

varying vec2 v_Texcoord;

void main()
{
 gl_FragColor = vec4(color, alpha) * texture2D(textureAtlas, v_Texcoord * uvScale);
#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
#endif
}

@end`;U.Shader.import(Qat);const aA=U.Mesh.extend(function(){var e=new Yk({dynamic:!0}),t=new U.Material({shader:U.createShader("ecgl.labels"),transparent:!0,depthMask:!1});return{geometry:e,material:t,culling:!1,castShadow:!1,ignorePicking:!0}});var Ml=Ee.firstNotNull,Al={x:0,y:2,z:1};function oA(e,t){var r=new U.Mesh({geometry:new Ys({useNativeLine:!1}),material:t,castShadow:!1,ignorePicking:!0,renderOrder:2}),n=new aA;n.material.depthMask=!1;var i=new U.Node;i.add(r),i.add(n),this.rootNode=i,this.dim=e,this.linesMesh=r,this.labelsMesh=n,this.axisLineCoords=null,this.labelElements=[]}var u1={x:"y",y:"x",z:"y"};oA.prototype.update=function(e,t,r){var n=e.coordinateSystem,i=n.getAxis(this.dim),a=this.linesMesh.geometry,o=this.labelsMesh.geometry;a.convertToDynamicArray(!0),o.convertToDynamicArray(!0);var s=i.model,l=i.getExtent(),E=r.getDevicePixelRatio(),u=s.getModel("axisLine",e.getModel("axisLine")),h=s.getModel("axisTick",e.getModel("axisTick")),f=s.getModel("axisLabel",e.getModel("axisLabel")),c=u.get("lineStyle.color");if(u.get("show")){var d=u.getModel("lineStyle"),v=[0,0,0],p=[0,0,0],g=Al[i.dim];v[g]=l[0],p[g]=l[1],this.axisLineCoords=[v,p];var m=U.parseColor(c),_=Ml(d.get("width"),1),y=Ml(d.get("opacity"),1);m[3]*=y,a.addLine(v,p,m,_*E)}if(h.get("show")){var x=h.getModel("lineStyle"),T=U.parseColor(Ml(x.get("color"),c)),_=Ml(x.get("width"),1);T[3]*=Ml(x.get("opacity"),1);for(var S=i.getTicksCoords(),M=h.get("length"),w=0;w<S.length;w++){var b=S[w].coord,v=[0,0,0],p=[0,0,0],g=Al[i.dim],A=Al[u1[i.dim]];v[g]=p[g]=b,p[A]=M,a.addLine(v,p,T,_*E)}}this.labelElements=[];var E=r.getDevicePixelRatio();if(f.get("show"))for(var S=i.getTicksCoords(),C=s.get("data"),D=f.get("margin"),L=i.getViewLabels(),w=0;w<L.length;w++){var P=L[w].tickValue,N=L[w].formattedLabel,O=L[w].rawLabel,b=i.dataToCoord(P),I=[0,0,0],g=Al[i.dim],A=Al[u1[i.dim]];I[g]=I[g]=b,I[A]=D;var k=f;C&&C[P]&&C[P].textStyle&&(k=new Ie(C[P].textStyle,f,s.ecModel));var z=Ml(k.get("color"),c),X=new we({style:je(k,{text:N,fill:typeof z=="function"?z(i.type==="category"?O:i.type==="value"?P+"":P,w):z,verticalAlign:"top",align:"left"})}),Y=t.add(X),$=X.getBoundingRect();o.addSprite(I,[$.width*E,$.height*E],Y),this.labelElements.push(X)}if(s.get("name")){var H=s.getModel("nameTextStyle"),I=[0,0,0],g=Al[i.dim],A=Al[u1[i.dim]],Z=Ml(H.get("color"),c),ct=H.get("borderColor"),_=H.get("borderWidth");I[g]=I[g]=(l[0]+l[1])/2,I[A]=s.get("nameGap");var X=new we({style:je(H,{text:s.get("name"),fill:Z,stroke:ct,lineWidth:_})}),Y=t.add(X),$=X.getBoundingRect();o.addSprite(I,[$.width*E,$.height*E],Y),X.__idx=this.labelElements.length,this.nameLabelElement=X}this.labelsMesh.material.set("textureAtlas",t.getTexture()),this.labelsMesh.material.set("uvScale",t.getCoordsScale()),a.convertToTypedArray(),o.convertToTypedArray()};oA.prototype.setSpriteAlign=function(e,t,r){for(var n=r.getDevicePixelRatio(),i=this.labelsMesh.geometry,a=0;a<this.labelElements.length;a++){var o=this.labelElements[a],s=o.getBoundingRect();i.setSpriteAlign(a,[s.width*n,s.height*n],e,t)}var l=this.nameLabelElement;if(l){var s=l.getBoundingRect();i.setSpriteAlign(l.__idx,[s.width*n,s.height*n],e,t),i.dirty()}this.textAlign=e,this.textVerticalAlign=t};const v0=`@export ecgl.lines3D.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec3 position: POSITION;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

void main()
{
 gl_Position = worldViewProjection * vec4(position, 1.0);
 v_Color = a_Color;
}

@end

@export ecgl.lines3D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif
}
@end



@export ecgl.lines3D.clipNear

vec4 clipNear(vec4 p1, vec4 p2) {
 float n = (p1.w - near) / (p1.w - p2.w);
 return vec4(mix(p1.xy, p2.xy, n), -near, near);
}

@end

@export ecgl.lines3D.expandLine
#ifdef VERTEX_ANIMATION
 vec4 prevProj = worldViewProjection * vec4(mix(prevPositionPrev, positionPrev, percent), 1.0);
 vec4 currProj = worldViewProjection * vec4(mix(prevPosition, position, percent), 1.0);
 vec4 nextProj = worldViewProjection * vec4(mix(prevPositionNext, positionNext, percent), 1.0);
#else
 vec4 prevProj = worldViewProjection * vec4(positionPrev, 1.0);
 vec4 currProj = worldViewProjection * vec4(position, 1.0);
 vec4 nextProj = worldViewProjection * vec4(positionNext, 1.0);
#endif

 if (currProj.w < 0.0) {
 if (nextProj.w > 0.0) {
 currProj = clipNear(currProj, nextProj);
 }
 else if (prevProj.w > 0.0) {
 currProj = clipNear(currProj, prevProj);
 }
 }

 vec2 prevScreen = (prevProj.xy / abs(prevProj.w) + 1.0) * 0.5 * viewport.zw;
 vec2 currScreen = (currProj.xy / abs(currProj.w) + 1.0) * 0.5 * viewport.zw;
 vec2 nextScreen = (nextProj.xy / abs(nextProj.w) + 1.0) * 0.5 * viewport.zw;

 vec2 dir;
 float len = offset;
 if (position == positionPrev) {
 dir = normalize(nextScreen - currScreen);
 }
 else if (position == positionNext) {
 dir = normalize(currScreen - prevScreen);
 }
 else {
 vec2 dirA = normalize(currScreen - prevScreen);
 vec2 dirB = normalize(nextScreen - currScreen);

 vec2 tanget = normalize(dirA + dirB);

 float miter = 1.0 / max(dot(tanget, dirA), 0.5);
 len *= miter;
 dir = tanget;
 }

 dir = vec2(-dir.y, dir.x) * len;
 currScreen += dir;

 currProj.xy = (currScreen / viewport.zw - 0.5) * 2.0 * abs(currProj.w);
@end


@export ecgl.meshLines3D.vertex

attribute vec3 position: POSITION;
attribute vec3 positionPrev;
attribute vec3 positionNext;
attribute float offset;
attribute vec4 a_Color : COLOR;

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute vec3 prevPositionPrev;
attribute vec3 prevPositionNext;
uniform float percent : 1.0;
#endif

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;
uniform float near : NEAR;

varying vec4 v_Color;

@import ecgl.common.wireframe.vertexHeader

@import ecgl.lines3D.clipNear

void main()
{
 @import ecgl.lines3D.expandLine

 gl_Position = currProj;

 v_Color = a_Color;

 @import ecgl.common.wireframe.vertexMain
}
@end


@export ecgl.meshLines3D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif

 @import ecgl.common.wireframe.fragmentMain
}

@end`;var _I=Ee.firstNotNull;U.Shader.import(v0);var El={x:0,y:2,z:1};const tot=nr.extend({type:"grid3D",__ecgl__:!0,init:function(e,t){var r=[["y","z","x",-1,"left"],["y","z","x",1,"right"],["x","y","z",-1,"bottom"],["x","y","z",1,"top"],["x","z","y",-1,"far"],["x","z","y",1,"near"]],n=["x","y","z"],i=new U.Material({shader:U.createShader("ecgl.color"),depthMask:!1,transparent:!0}),a=new U.Material({shader:U.createShader("ecgl.meshLines3D"),depthMask:!1,transparent:!0});i.define("fragment","DOUBLE_SIDED"),i.define("both","VERTEX_COLOR"),this.groupGL=new U.Node,this._control=new zv({zr:t.getZr()}),this._control.init(),this._faces=r.map(function(s){var l=new d0(s,a,i);return this.groupGL.add(l.rootNode),l},this),this._axes=n.map(function(s){var l=new oA(s,a);return this.groupGL.add(l.rootNode),l},this);var o=t.getDevicePixelRatio();this._axisLabelSurface=new l_({width:256,height:256,devicePixelRatio:o}),this._axisLabelSurface.onupdate=function(){t.getZr().refresh()},this._axisPointerLineMesh=new U.Mesh({geometry:new Ys({useNativeLine:!1}),material:a,castShadow:!1,ignorePicking:!0,renderOrder:3}),this.groupGL.add(this._axisPointerLineMesh),this._axisPointerLabelsSurface=new l_({width:128,height:128,devicePixelRatio:o}),this._axisPointerLabelsMesh=new aA({ignorePicking:!0,renderOrder:4,castShadow:!1}),this._axisPointerLabelsMesh.material.set("textureAtlas",this._axisPointerLabelsSurface.getTexture()),this.groupGL.add(this._axisPointerLabelsMesh),this._lightRoot=new U.Node,this._sceneHelper=new ks,this._sceneHelper.initLight(this._lightRoot)},render:function(e,t,r){this._model=e,this._api=r;var n=e.coordinateSystem;n.viewGL.add(this._lightRoot),e.get("show")?n.viewGL.add(this.groupGL):n.viewGL.remove(this.groupGL);var i=this._control;i.setViewGL(n.viewGL);var a=e.getModel("viewControl");i.setFromViewControlModel(a,0),this._axisLabelSurface.clear(),i.off("update"),e.get("show")&&(this._faces.forEach(function(o){o.update(e,t,r)},this),this._axes.forEach(function(o){o.update(e,this._axisLabelSurface,r)},this)),i.on("update",this._onCameraChange.bind(this,e,r),this),this._sceneHelper.setScene(n.viewGL.scene),this._sceneHelper.updateLight(e),n.viewGL.setPostEffect(e.getModel("postEffect"),r),n.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._initMouseHandler(e)},afterRender:function(e,t,r,n){var i=n.renderer;this._sceneHelper.updateAmbientCubemap(i,e,r),this._sceneHelper.updateSkybox(i,e,r)},showAxisPointer:function(e,t,r,n){this._doShowAxisPointer(),this._updateAxisPointer(n.value)},hideAxisPointer:function(e,t,r,n){this._doHideAxisPointer()},_initMouseHandler:function(e){var t=e.coordinateSystem,r=t.viewGL;e.get("show")&&e.get("axisPointer.show")?r.on("mousemove",this._updateAxisPointerOnMousePosition,this):r.off("mousemove",this._updateAxisPointerOnMousePosition)},_updateAxisPointerOnMousePosition:function(e){if(!e.target){for(var t=this._model,r=t.coordinateSystem,n=r.viewGL,i=n.castRay(e.offsetX,e.offsetY,new U.Ray),a,o=0;o<this._faces.length;o++){var s=this._faces[o];if(!s.rootNode.invisible){s.plane.normal.dot(n.camera.worldTransform.z)<0&&s.plane.normal.negate();var l=i.intersectPlane(s.plane);if(l){var u=r.getAxis(s.faceInfo[0]),h=r.getAxis(s.faceInfo[1]),f=El[s.faceInfo[0]],c=El[s.faceInfo[1]];u.contain(l.array[f])&&h.contain(l.array[c])&&(a=l)}}}if(a){var d=r.pointToData(a.array,[],!0);this._updateAxisPointer(d),this._doShowAxisPointer()}else this._doHideAxisPointer()}},_onCameraChange:function(e,t){e.get("show")&&(this._updateFaceVisibility(),this._updateAxisLinePosition());var r=this._control;t.dispatchAction({type:"grid3DChangeCamera",alpha:r.getAlpha(),beta:r.getBeta(),distance:r.getDistance(),center:r.getCenter(),from:this.uid,grid3DId:e.id})},_updateFaceVisibility:function(){var e=this._control.getCamera(),t=new U.Vector3;e.update();for(var r=0;r<this._faces.length/2;r++){for(var n=[],i=0;i<2;i++){var a=this._faces[r*2+i];a.rootNode.getWorldPosition(t),t.transformMat4(e.viewMatrix),n[i]=t.z}var o=n[0]>n[1]?0:1,s=this._faces[r*2+o],l=this._faces[r*2+1-o];s.rootNode.invisible=!0,l.rootNode.invisible=!1}},_updateAxisLinePosition:function(){var e=this._model.coordinateSystem,t=e.getAxis("x"),r=e.getAxis("y"),n=e.getAxis("z"),i=n.getExtentMax(),a=n.getExtentMin(),o=t.getExtentMin(),s=t.getExtentMax(),l=r.getExtentMax(),u=r.getExtentMin(),h=this._axes[0].rootNode,f=this._axes[1].rootNode,c=this._axes[2].rootNode,d=this._faces,v=d[4].rootNode.invisible?u:l,p=d[2].rootNode.invisible?i:a,g=d[0].rootNode.invisible?o:s,m=d[2].rootNode.invisible?i:a,_=d[0].rootNode.invisible?s:o,y=d[4].rootNode.invisible?u:l;h.rotation.identity(),f.rotation.identity(),c.rotation.identity(),d[4].rootNode.invisible&&(this._axes[0].flipped=!0,h.rotation.rotateX(Math.PI)),d[0].rootNode.invisible&&(this._axes[1].flipped=!0,f.rotation.rotateZ(Math.PI)),d[4].rootNode.invisible&&(this._axes[2].flipped=!0,c.rotation.rotateY(Math.PI)),h.position.set(0,p,v),f.position.set(g,m,0),c.position.set(_,0,y),h.update(),f.update(),c.update(),this._updateAxisLabelAlign()},_updateAxisLabelAlign:function(){var e=this._control.getCamera(),t=[new U.Vector4,new U.Vector4],r=new U.Vector4;this.groupGL.getWorldPosition(r),r.w=1,r.transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),r.x/=r.w,r.y/=r.w,this._axes.forEach(function(n){var i=n.axisLineCoords;n.labelsMesh.geometry;for(var a=0;a<t.length;a++)t[a].setArray(i[a]),t[a].w=1,t[a].transformMat4(n.rootNode.worldTransform).transformMat4(e.viewMatrix).transformMat4(e.projectionMatrix),t[a].x/=t[a].w,t[a].y/=t[a].w;var o=t[1].x-t[0].x,s=t[1].y-t[0].y,l=(t[1].x+t[0].x)/2,u=(t[1].y+t[0].y)/2,h,f;Math.abs(s/o)<.5?(h="center",f=u>r.y?"bottom":"top"):(f="middle",h=l>r.x?"left":"right"),n.setSpriteAlign(h,f,this._api)},this)},_doShowAxisPointer:function(){this._axisPointerLineMesh.invisible&&(this._axisPointerLineMesh.invisible=!1,this._axisPointerLabelsMesh.invisible=!1,this._api.getZr().refresh())},_doHideAxisPointer:function(){this._axisPointerLineMesh.invisible||(this._axisPointerLineMesh.invisible=!0,this._axisPointerLabelsMesh.invisible=!0,this._api.getZr().refresh())},_updateAxisPointer:function(e){var t=this._model.coordinateSystem,r=t.dataToPoint(e),n=this._axisPointerLineMesh,i=n.geometry,a=this._model.getModel("axisPointer"),o=this._api.getDevicePixelRatio();i.convertToDynamicArray(!0);function s(w){return Ee.firstNotNull(w.model.get("axisPointer.show"),a.get("show"))}function l(w){var b=w.model.getModel("axisPointer",a),A=b.getModel("lineStyle"),E=U.parseColor(A.get("color")),C=_I(A.get("width"),1),D=_I(A.get("opacity"),1);return E[3]*=D,{color:E,lineWidth:C}}for(var u=0;u<this._faces.length;u++){var h=this._faces[u];if(!h.rootNode.invisible){for(var f=h.faceInfo,c=f[3]<0?t.getAxis(f[2]).getExtentMin():t.getAxis(f[2]).getExtentMax(),d=El[f[2]],v=0;v<2;v++){var p=f[v],g=f[1-v],m=t.getAxis(p),_=t.getAxis(g);if(s(m)){var y=[0,0,0],x=[0,0,0],T=El[p],S=El[g];y[T]=x[T]=r[T],y[d]=x[d]=c,y[S]=_.getExtentMin(),x[S]=_.getExtentMax();var M=l(m);i.addLine(y,x,M.color,M.lineWidth*o)}}if(s(t.getAxis(f[2]))){var y=r.slice(),x=r.slice();x[d]=c;var M=l(t.getAxis(f[2]));i.addLine(y,x,M.color,M.lineWidth*o)}}}i.convertToTypedArray(),this._updateAxisPointerLabelsMesh(e),this._api.getZr().refresh()},_updateAxisPointerLabelsMesh:function(e){var t=this._model,r=this._axisPointerLabelsMesh,n=this._axisPointerLabelsSurface,i=t.coordinateSystem,a=t.getModel("axisPointer");r.geometry.convertToDynamicArray(!0),n.clear();var o={x:"y",y:"x",z:"y"};this._axes.forEach(function(s,l){var u=i.getAxis(s.dim),h=u.model,f=h.getModel("axisPointer",a),c=f.getModel("label"),d=f.get("lineStyle.color");if(!(!c.get("show")||!f.get("show"))){var v=e[l],p=c.get("formatter"),g=u.scale.getLabel({value:v});if(p!=null)g=p(g,e);else if(u.scale.type==="interval"||u.scale.type==="log"){var m=Jb(u.scale.getTicks()[0]);g=v.toFixed(m+2)}var _=c.get("color"),y=new we({style:je(c,{text:g,fill:_||d,align:"left",verticalAlign:"top"})}),x=n.add(y),T=y.getBoundingRect(),S=this._api.getDevicePixelRatio(),M=s.rootNode.position.toArray(),w=El[o[s.dim]];M[w]+=(s.flipped?-1:1)*c.get("margin"),M[El[s.dim]]=u.dataToCoord(e[l]),r.geometry.addSprite(M,[T.width*S,T.height*S],x,s.textAlign,s.textVerticalAlign)}},this),n.getZr().refreshImmediately(),r.material.set("uvScale",n.getCoordsScale()),r.geometry.convertToTypedArray()},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._axisLabelSurface.dispose(),this._axisPointerLabelsSurface.dispose()}});function uv(e){rM.call(this,e),this.type="cartesian3D",this.dimensions=["x","y","z"],this.size=[0,0,0]}uv.prototype={constructor:uv,model:null,containPoint:function(e){return this.getAxis("x").contain(e[0])&&this.getAxis("y").contain(e[2])&&this.getAxis("z").contain(e[1])},containData:function(e){return this.getAxis("x").containData(e[0])&&this.getAxis("y").containData(e[1])&&this.getAxis("z").containData(e[2])},dataToPoint:function(e,t,r){return t=t||[],t[0]=this.getAxis("x").dataToCoord(e[0],r),t[2]=this.getAxis("y").dataToCoord(e[1],r),t[1]=this.getAxis("z").dataToCoord(e[2],r),t},pointToData:function(e,t,r){return t=t||[],t[0]=this.getAxis("x").coordToData(e[0],r),t[1]=this.getAxis("y").coordToData(e[2],r),t[2]=this.getAxis("z").coordToData(e[1],r),t}};Wb(uv,rM);function u_(e,t,r){Kn.call(this,e,t,r)}u_.prototype={constructor:u_,getExtentMin:function(){var e=this._extent;return Math.min(e[0],e[1])},getExtentMax:function(){var e=this._extent;return Math.max(e[0],e[1])},calculateCategoryInterval:function(){return Math.floor(this.scale.count()/8)}};Wb(u_,Kn);var h_=function(){this._pool={},this._allocatedTextures=[]};h_.prototype={constructor:h_,get:function(e){var t=yI(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var r=this._pool[t];if(!r.length){var n=new xe(e);return this._allocatedTextures.push(n),n}return r.pop()},put:function(e){var t=yI(e);this._pool.hasOwnProperty(t)||(this._pool[t]=[]);var r=this._pool[t];r.push(e)},clear:function(e){for(var t=0;t<this._allocatedTextures.length;t++)this._allocatedTextures[t].dispose(e);this._pool={},this._allocatedTextures=[]}};var Zk={width:512,height:512,type:mt.UNSIGNED_BYTE,format:mt.RGBA,wrapS:mt.CLAMP_TO_EDGE,wrapT:mt.CLAMP_TO_EDGE,minFilter:mt.LINEAR_MIPMAP_LINEAR,magFilter:mt.LINEAR,useMipmap:!0,anisotropic:1,flipY:!0,unpackAlignment:4,premultiplyAlpha:!1},h1=Object.keys(Zk);function yI(e){Lr.defaultsWithPropList(e,Zk,h1),eot(e);for(var t="",r=0;r<h1.length;r++){var n=h1[r],i=e[n].toString();t+=i}return t}function eot(e){var t=rot(e.width,e.height);e.format===mt.DEPTH_COMPONENT&&(e.useMipmap=!1),(!t||!e.useMipmap)&&(e.minFilter==mt.NEAREST_MIPMAP_NEAREST||e.minFilter==mt.NEAREST_MIPMAP_LINEAR?e.minFilter=mt.NEAREST:(e.minFilter==mt.LINEAR_MIPMAP_LINEAR||e.minFilter==mt.LINEAR_MIPMAP_NEAREST)&&(e.minFilter=mt.LINEAR)),t||(e.wrapS=mt.CLAMP_TO_EDGE,e.wrapT=mt.CLAMP_TO_EDGE)}function rot(e,t){return(e&e-1)===0&&(t&t-1)===0}const not=`@export clay.sm.depth.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
attribute vec3 position : POSITION;
attribute vec2 texcoord : TEXCOORD_0;
uniform vec2 uvRepeat = vec2(1.0, 1.0);
uniform vec2 uvOffset = vec2(0.0, 0.0);
@import clay.chunk.skinning_header
@import clay.chunk.instancing_header
varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;
void main(){
 vec4 P = vec4(position, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 v_ViewPosition = worldViewProjection * P;
 gl_Position = v_ViewPosition;
 v_Texcoord = texcoord * uvRepeat + uvOffset;
}
@end
@export clay.sm.depth.fragment
varying vec4 v_ViewPosition;
varying vec2 v_Texcoord;
uniform float bias : 0.001;
uniform float slopeScale : 1.0;
uniform sampler2D alphaMap;
uniform float alphaCutoff: 0.0;
@import clay.util.encode_float
void main(){
 float depth = v_ViewPosition.z / v_ViewPosition.w;
 if (alphaCutoff > 0.0) {
 if (texture2D(alphaMap, v_Texcoord).a <= alphaCutoff) {
 discard;
 }
 }
#ifdef USE_VSM
 depth = depth * 0.5 + 0.5;
 float moment1 = depth;
 float moment2 = depth * depth;
 #ifdef SUPPORT_STANDARD_DERIVATIVES
 float dx = dFdx(depth);
 float dy = dFdy(depth);
 moment2 += 0.25*(dx*dx+dy*dy);
 #endif
 gl_FragColor = vec4(moment1, moment2, 0.0, 1.0);
#else
 #ifdef SUPPORT_STANDARD_DERIVATIVES
 float dx = dFdx(depth);
 float dy = dFdy(depth);
 depth += sqrt(dx*dx + dy*dy) * slopeScale + bias;
 #else
 depth += bias;
 #endif
 gl_FragColor = encodeFloat(depth * 0.5 + 0.5);
#endif
}
@end
@export clay.sm.debug_depth
uniform sampler2D depthMap;
varying vec2 v_Texcoord;
@import clay.util.decode_float
void main() {
 vec4 tex = texture2D(depthMap, v_Texcoord);
#ifdef USE_VSM
 gl_FragColor = vec4(tex.rgb, 1.0);
#else
 float depth = decodeFloat(tex);
 gl_FragColor = vec4(depth, depth, depth, 1.0);
#endif
}
@end
@export clay.sm.distance.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 world : WORLD;
attribute vec3 position : POSITION;
@import clay.chunk.skinning_header
varying vec3 v_WorldPosition;
void main (){
 vec4 P = vec4(position, 1.0);
#ifdef SKINNING
 @import clay.chunk.skin_matrix
 P = skinMatrixWS * P;
#endif
#ifdef INSTANCING
 @import clay.chunk.instancing_matrix
 P = instanceMat * P;
#endif
 gl_Position = worldViewProjection * P;
 v_WorldPosition = (world * P).xyz;
}
@end
@export clay.sm.distance.fragment
uniform vec3 lightPosition;
uniform float range : 100;
varying vec3 v_WorldPosition;
@import clay.util.encode_float
void main(){
 float dist = distance(lightPosition, v_WorldPosition);
#ifdef USE_VSM
 gl_FragColor = vec4(dist, dist * dist, 0.0, 0.0);
#else
 dist = dist / range;
 gl_FragColor = encodeFloat(dist);
#endif
}
@end
@export clay.plugin.shadow_map_common
@import clay.util.decode_float
float tapShadowMap(sampler2D map, vec2 uv, float z){
 vec4 tex = texture2D(map, uv);
 return step(z, decodeFloat(tex) * 2.0 - 1.0);
}
float pcf(sampler2D map, vec2 uv, float z, float textureSize, vec2 scale) {
 float shadowContrib = tapShadowMap(map, uv, z);
 vec2 offset = vec2(1.0 / textureSize) * scale;
#ifdef PCF_KERNEL_SIZE
 for (int _idx_ = 0; _idx_ < PCF_KERNEL_SIZE; _idx_++) {{
 shadowContrib += tapShadowMap(map, uv + offset * pcfKernel[_idx_], z);
 }}
 return shadowContrib / float(PCF_KERNEL_SIZE + 1);
#else
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, 0.0), z);
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(0.0, offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, 0.0), z);
 shadowContrib += tapShadowMap(map, uv+vec2(-offset.x, -offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(offset.x, -offset.y), z);
 shadowContrib += tapShadowMap(map, uv+vec2(0.0, -offset.y), z);
 return shadowContrib / 9.0;
#endif
}
float pcf(sampler2D map, vec2 uv, float z, float textureSize) {
 return pcf(map, uv, z, textureSize, vec2(1.0));
}
float chebyshevUpperBound(vec2 moments, float z){
 float p = 0.0;
 z = z * 0.5 + 0.5;
 if (z <= moments.x) {
 p = 1.0;
 }
 float variance = moments.y - moments.x * moments.x;
 variance = max(variance, 0.0000001);
 float mD = moments.x - z;
 float pMax = variance / (variance + mD * mD);
 pMax = clamp((pMax-0.4)/(1.0-0.4), 0.0, 1.0);
 return max(p, pMax);
}
float computeShadowContrib(
 sampler2D map, mat4 lightVPM, vec3 position, float textureSize, vec2 scale, vec2 offset
) {
 vec4 posInLightSpace = lightVPM * vec4(position, 1.0);
 posInLightSpace.xyz /= posInLightSpace.w;
 float z = posInLightSpace.z;
 if(all(greaterThan(posInLightSpace.xyz, vec3(-0.99, -0.99, -1.0))) &&
 all(lessThan(posInLightSpace.xyz, vec3(0.99, 0.99, 1.0)))){
 vec2 uv = (posInLightSpace.xy+1.0) / 2.0;
 #ifdef USE_VSM
 vec2 moments = texture2D(map, uv * scale + offset).xy;
 return chebyshevUpperBound(moments, z);
 #else
 return pcf(map, uv * scale + offset, z, textureSize, scale);
 #endif
 }
 return 1.0;
}
float computeShadowContrib(sampler2D map, mat4 lightVPM, vec3 position, float textureSize) {
 return computeShadowContrib(map, lightVPM, position, textureSize, vec2(1.0), vec2(0.0));
}
float computeShadowContribOmni(samplerCube map, vec3 direction, float range)
{
 float dist = length(direction);
 vec4 shadowTex = textureCube(map, direction);
#ifdef USE_VSM
 vec2 moments = shadowTex.xy;
 float variance = moments.y - moments.x * moments.x;
 float mD = moments.x - dist;
 float p = variance / (variance + mD * mD);
 if(moments.x + 0.001 < dist){
 return clamp(p, 0.0, 1.0);
 }else{
 return 1.0;
 }
#else
 return step(dist, (decodeFloat(shadowTex) + 0.0002) * range);
#endif
}
@end
@export clay.plugin.compute_shadow_map
#if defined(SPOT_LIGHT_SHADOWMAP_COUNT) || defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT) || defined(POINT_LIGHT_SHADOWMAP_COUNT)
#ifdef SPOT_LIGHT_SHADOWMAP_COUNT
uniform sampler2D spotLightShadowMaps[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform mat4 spotLightMatrices[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform float spotLightShadowMapSizes[SPOT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
#ifdef DIRECTIONAL_LIGHT_SHADOWMAP_COUNT
#if defined(SHADOW_CASCADE)
uniform sampler2D directionalLightShadowMaps[1]:unconfigurable;
uniform mat4 directionalLightMatrices[SHADOW_CASCADE]:unconfigurable;
uniform float directionalLightShadowMapSizes[1]:unconfigurable;
uniform float shadowCascadeClipsNear[SHADOW_CASCADE]:unconfigurable;
uniform float shadowCascadeClipsFar[SHADOW_CASCADE]:unconfigurable;
#else
uniform sampler2D directionalLightShadowMaps[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform mat4 directionalLightMatrices[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
uniform float directionalLightShadowMapSizes[DIRECTIONAL_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
#endif
#ifdef POINT_LIGHT_SHADOWMAP_COUNT
uniform samplerCube pointLightShadowMaps[POINT_LIGHT_SHADOWMAP_COUNT]:unconfigurable;
#endif
uniform bool shadowEnabled : true;
#ifdef PCF_KERNEL_SIZE
uniform vec2 pcfKernel[PCF_KERNEL_SIZE];
#endif
@import clay.plugin.shadow_map_common
#if defined(SPOT_LIGHT_SHADOWMAP_COUNT)
void computeShadowOfSpotLights(vec3 position, inout float shadowContribs[SPOT_LIGHT_COUNT] ) {
 float shadowContrib;
 for(int _idx_ = 0; _idx_ < SPOT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 shadowContrib = computeShadowContrib(
 spotLightShadowMaps[_idx_], spotLightMatrices[_idx_], position,
 spotLightShadowMapSizes[_idx_]
 );
 shadowContribs[_idx_] = shadowContrib;
 }}
 for(int _idx_ = SPOT_LIGHT_SHADOWMAP_COUNT; _idx_ < SPOT_LIGHT_COUNT; _idx_++){{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#if defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
#ifdef SHADOW_CASCADE
void computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){
 float depth = (2.0 * gl_FragCoord.z - gl_DepthRange.near - gl_DepthRange.far)
 / (gl_DepthRange.far - gl_DepthRange.near);
 float shadowContrib;
 shadowContribs[0] = 1.0;
 for (int _idx_ = 0; _idx_ < SHADOW_CASCADE; _idx_++) {{
 if (
 depth >= shadowCascadeClipsNear[_idx_] &&
 depth <= shadowCascadeClipsFar[_idx_]
 ) {
 shadowContrib = computeShadowContrib(
 directionalLightShadowMaps[0], directionalLightMatrices[_idx_], position,
 directionalLightShadowMapSizes[0],
 vec2(1.0 / float(SHADOW_CASCADE), 1.0),
 vec2(float(_idx_) / float(SHADOW_CASCADE), 0.0)
 );
 shadowContribs[0] = shadowContrib;
 }
 }}
 for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#else
void computeShadowOfDirectionalLights(vec3 position, inout float shadowContribs[DIRECTIONAL_LIGHT_COUNT]){
 float shadowContrib;
 for(int _idx_ = 0; _idx_ < DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 shadowContrib = computeShadowContrib(
 directionalLightShadowMaps[_idx_], directionalLightMatrices[_idx_], position,
 directionalLightShadowMapSizes[_idx_]
 );
 shadowContribs[_idx_] = shadowContrib;
 }}
 for(int _idx_ = DIRECTIONAL_LIGHT_SHADOWMAP_COUNT; _idx_ < DIRECTIONAL_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#endif
#if defined(POINT_LIGHT_SHADOWMAP_COUNT)
void computeShadowOfPointLights(vec3 position, inout float shadowContribs[POINT_LIGHT_COUNT] ){
 vec3 lightPosition;
 vec3 direction;
 for(int _idx_ = 0; _idx_ < POINT_LIGHT_SHADOWMAP_COUNT; _idx_++) {{
 lightPosition = pointLightPosition[_idx_];
 direction = position - lightPosition;
 shadowContribs[_idx_] = computeShadowContribOmni(pointLightShadowMaps[_idx_], direction, pointLightRange[_idx_]);
 }}
 for(int _idx_ = POINT_LIGHT_SHADOWMAP_COUNT; _idx_ < POINT_LIGHT_COUNT; _idx_++) {{
 shadowContribs[_idx_] = 1.0;
 }}
}
#endif
#endif
@end`;var rs=["px","nx","py","ny","pz","nz"];Et.import(not);function f1(e,t,r){if(r==="alphaMap")return e.material.get("diffuseMap");if(r==="alphaCutoff"){if(e.material.isDefined("fragment","ALPHA_TEST")&&e.material.get("diffuseMap")){var n=e.material.get("alphaCutoff");return n||0}return 0}else return r==="uvRepeat"?e.material.get("uvRepeat"):r==="uvOffset"?e.material.get("uvOffset"):t.get(r)}function xI(e,t){var r=e.material,n=t.material;return r.get("diffuseMap")!==n.get("diffuseMap")||(r.get("alphaCutoff")||0)!==(n.get("alphaCutoff")||0)}var Ra=gn.extend(function(){return{softShadow:Ra.PCF,shadowBlur:1,lightFrustumBias:"auto",kernelPCF:new Float32Array([1,0,1,1,-1,1,0,1,-1,0,-1,-1,1,-1,0,-1]),precision:"highp",_lastRenderNotCastShadow:!1,_frameBuffer:new Ir,_textures:{},_shadowMapNumber:{POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},_depthMaterials:{},_distanceMaterials:{},_receivers:[],_lightsCastShadow:[],_lightCameras:{},_lightMaterials:{},_texturePool:new h_}},function(){this._gaussianPassH=new kr({fragment:Et.source("clay.compositor.gaussian_blur")}),this._gaussianPassV=new kr({fragment:Et.source("clay.compositor.gaussian_blur")}),this._gaussianPassH.setUniform("blurSize",this.shadowBlur),this._gaussianPassH.setUniform("blurDir",0),this._gaussianPassV.setUniform("blurSize",this.shadowBlur),this._gaussianPassV.setUniform("blurDir",1),this._outputDepthPass=new kr({fragment:Et.source("clay.sm.debug_depth")})},{render:function(e,t,r,n){r||(r=t.getMainCamera()),this.trigger("beforerender",this,e,t,r),this._renderShadowPass(e,t,r,n),this.trigger("afterrender",this,e,t,r)},renderDebug:function(e,t){e.saveClear();var r=e.viewport,n=0,i=0,a=t||r.width/4,o=a;this.softShadow===Ra.VSM?this._outputDepthPass.material.define("fragment","USE_VSM"):this._outputDepthPass.material.undefine("fragment","USE_VSM");for(var s in this._textures){var l=this._textures[s];e.setViewport(n,i,a*l.width/l.height,o),this._outputDepthPass.setUniform("depthMap",l),this._outputDepthPass.render(e),n+=a*l.width/l.height}e.setViewport(r),e.restoreClear()},_updateReceivers:function(e,t){if(t.receiveShadow?(this._receivers.push(t),t.material.set("shadowEnabled",1),t.material.set("pcfKernel",this.kernelPCF)):t.material.set("shadowEnabled",0),this.softShadow===Ra.VSM)t.material.define("fragment","USE_VSM"),t.material.undefine("fragment","PCF_KERNEL_SIZE");else{t.material.undefine("fragment","USE_VSM");var r=this.kernelPCF;r&&r.length?t.material.define("fragment","PCF_KERNEL_SIZE",r.length/2):t.material.undefine("fragment","PCF_KERNEL_SIZE")}},_update:function(e,t){var r=this;t.traverse(function(a){a.isRenderable()&&r._updateReceivers(e,a)});for(var n=0;n<t.lights.length;n++){var i=t.lights[n];i.castShadow&&!i.invisible&&this._lightsCastShadow.push(i)}},_renderShadowPass:function(e,t,r,n){for(var i in this._shadowMapNumber)this._shadowMapNumber[i]=0;this._lightsCastShadow.length=0,this._receivers.length=0;var a=e.gl;if(n||t.update(),r&&r.update(),t.updateLights(),this._update(e,t),!this._lightsCastShadow.length&&this._lastRenderNotCastShadow)return;this._lastRenderNotCastShadow=this._lightsCastShadow===0,a.enable(a.DEPTH_TEST),a.depthMask(!0),a.disable(a.BLEND),a.clearColor(1,1,1,1);for(var o=[],s=[],l=[],u=[],h=[],f=[],c,d=0;d<this._lightsCastShadow.length;d++){var v=this._lightsCastShadow[d];if(v.type==="DIRECTIONAL_LIGHT"){if(c){console.warn("Only one direectional light supported with shadow cascade");continue}if(v.shadowCascade>4){console.warn("Support at most 4 cascade");continue}v.shadowCascade>1&&(c=v),this.renderDirectionalLightShadow(e,t,r,v,h,u,l)}else v.type==="SPOT_LIGHT"?this.renderSpotLightShadow(e,t,v,s,o):v.type==="POINT_LIGHT"&&this.renderPointLightShadow(e,t,v,f);this._shadowMapNumber[v.type]++}for(var p in this._shadowMapNumber)for(var g=this._shadowMapNumber[p],m=p+"_SHADOWMAP_COUNT",d=0;d<this._receivers.length;d++){var _=this._receivers[d],y=_.material;y.fragmentDefines[m]!==g&&(g>0?y.define("fragment",m,g):y.isDefined("fragment",m)&&y.undefine("fragment",m))}for(var d=0;d<this._receivers.length;d++){var _=this._receivers[d],y=_.material;c?y.define("fragment","SHADOW_CASCADE",c.shadowCascade):y.undefine("fragment","SHADOW_CASCADE")}var x=t.shadowUniforms;function T(A){return A.height}if(l.length>0){var S=l.map(T);if(x.directionalLightShadowMaps={value:l,type:"tv"},x.directionalLightMatrices={value:u,type:"m4v"},x.directionalLightShadowMapSizes={value:S,type:"1fv"},c){var M=h.slice(),w=h.slice();M.pop(),w.shift(),M.reverse(),w.reverse(),u.reverse(),x.shadowCascadeClipsNear={value:M,type:"1fv"},x.shadowCascadeClipsFar={value:w,type:"1fv"}}}if(o.length>0){var b=o.map(T),x=t.shadowUniforms;x.spotLightShadowMaps={value:o,type:"tv"},x.spotLightMatrices={value:s,type:"m4v"},x.spotLightShadowMapSizes={value:b,type:"1fv"}}f.length>0&&(x.pointLightShadowMaps={value:f,type:"tv"})},renderDirectionalLightShadow:function(){var e=new l0,t=new Nt,r=new vn,n=new Nt,i=new Nt,a=new Nt,o=new Nt;return function(s,l,u,h,f,c,d){var v=this._getDepthMaterial(h),p={getMaterial:function($){return $.shadowDepthMaterial||v},isMaterialChanged:xI,getUniform:f1,ifRender:function($){return $.castShadow},sortCompare:Hi.opaqueSortCompare};if(!l.viewBoundingBoxLastFrame.isFinite()){var g=l.getBoundingBox();l.viewBoundingBoxLastFrame.copy(g).applyTransform(u.viewMatrix)}var m=Math.min(-l.viewBoundingBoxLastFrame.min.z,u.far),_=Math.max(-l.viewBoundingBoxLastFrame.max.z,u.near),y=this._getDirectionalLightCamera(h,l,u),x=a.array;o.copy(y.projectionMatrix),xt.invert(i.array,y.worldTransform.array),xt.multiply(i.array,i.array,u.worldTransform.array),xt.multiply(x,o.array,i.array);for(var T=[],S=u instanceof Kr,M=(u.near+u.far)/(u.near-u.far),w=2*u.near*u.far/(u.near-u.far),b=0;b<=h.shadowCascade;b++){var A=_*Math.pow(m/_,b/h.shadowCascade),E=_+(m-_)*b/h.shadowCascade,C=A*h.cascadeSplitLogFactor+E*(1-h.cascadeSplitLogFactor);T.push(C),f.push(-(-C*M+w)/-C)}var D=this._getTexture(h,h.shadowCascade);d.push(D);var L=s.viewport,P=s.gl;this._frameBuffer.attach(D),this._frameBuffer.bind(s),P.clear(P.COLOR_BUFFER_BIT|P.DEPTH_BUFFER_BIT);for(var b=0;b<h.shadowCascade;b++){var N=T[b],O=T[b+1];S?xt.perspective(t.array,u.fov/180*Math.PI,u.aspect,N,O):xt.ortho(t.array,u.left,u.right,u.bottom,u.top,N,O),e.setFromProjection(t),e.getTransformedBoundingBox(r,i),r.applyProjection(o);var I=r.min.array,k=r.max.array;I[0]=Math.max(I[0],-1),I[1]=Math.max(I[1],-1),k[0]=Math.min(k[0],1),k[1]=Math.min(k[1],1),n.ortho(I[0],k[0],I[1],k[1],1,-1),y.projectionMatrix.multiplyLeft(n);var z=h.shadowResolution||512;s.setViewport((h.shadowCascade-b-1)*z,0,z,z,1);var X=l.updateRenderList(y);s.renderPass(X.opaque,y,p),this.softShadow===Ra.VSM&&this._gaussianFilter(s,D,D.width);var Y=new Nt;Y.copy(y.viewMatrix).multiplyLeft(y.projectionMatrix),c.push(Y.array),y.projectionMatrix.copy(o)}this._frameBuffer.unbind(s),s.setViewport(L)}}(),renderSpotLightShadow:function(e,t,r,n,i){var a=this._getTexture(r),o=this._getSpotLightCamera(r),s=e.gl;this._frameBuffer.attach(a),this._frameBuffer.bind(e),s.clear(s.COLOR_BUFFER_BIT|s.DEPTH_BUFFER_BIT);var l=this._getDepthMaterial(r),u={getMaterial:function(c){return c.shadowDepthMaterial||l},isMaterialChanged:xI,getUniform:f1,ifRender:function(c){return c.castShadow},sortCompare:Hi.opaqueSortCompare},h=t.updateRenderList(o);e.renderPass(h.opaque,o,u),this._frameBuffer.unbind(e),this.softShadow===Ra.VSM&&this._gaussianFilter(e,a,a.width);var f=new Nt;f.copy(o.worldTransform).invert().multiplyLeft(o.projectionMatrix),i.push(a),n.push(f.array)},renderPointLightShadow:function(e,t,r,n){var i=this._getTexture(r),a=e.gl;n.push(i);var o=this._getDepthMaterial(r),s={getMaterial:function(_){return _.shadowDepthMaterial||o},getUniform:f1,sortCompare:Hi.opaqueSortCompare},l={px:[],py:[],pz:[],nx:[],ny:[],nz:[]},u=new vn,h=r.getWorldPosition().array,f=new vn,c=r.range;f.min.setArray(h),f.max.setArray(h);var d=new ht(c,c,c);f.max.add(d),f.min.sub(d);var v={px:!1,py:!1,pz:!1,nx:!1,ny:!1,nz:!1};t.traverse(function(_){if(_.isRenderable()&&_.castShadow){var y=_.geometry;if(!y.boundingBox){for(var x=0;x<rs.length;x++)l[rs[x]].push(_);return}if(u.transformFrom(y.boundingBox,_.worldTransform),!u.intersectBoundingBox(f))return;u.updateVertices();for(var x=0;x<rs.length;x++)v[rs[x]]=!1;for(var x=0;x<8;x++){var T=u.vertices[x],S=T[0]-h[0],M=T[1]-h[1],w=T[2]-h[2],b=Math.abs(S),A=Math.abs(M),E=Math.abs(w);b>A?b>E?v[S>0?"px":"nx"]=!0:v[w>0?"pz":"nz"]=!0:A>E?v[M>0?"py":"ny"]=!0:v[w>0?"pz":"nz"]=!0}for(var x=0;x<rs.length;x++)v[rs[x]]&&l[rs[x]].push(_)}});for(var p=0;p<6;p++){var g=rs[p],m=this._getPointLightCamera(r,g);this._frameBuffer.attach(i,a.COLOR_ATTACHMENT0,a.TEXTURE_CUBE_MAP_POSITIVE_X+p),this._frameBuffer.bind(e),a.clear(a.COLOR_BUFFER_BIT|a.DEPTH_BUFFER_BIT),e.renderPass(l[g],m,s)}this._frameBuffer.unbind(e)},_getDepthMaterial:function(e){var t=this._lightMaterials[e.__uid__],r=e.type==="POINT_LIGHT";if(!t){var n=r?"clay.sm.distance.":"clay.sm.depth.";t=new Vi({precision:this.precision,shader:new Et(Et.source(n+"vertex"),Et.source(n+"fragment"))}),this._lightMaterials[e.__uid__]=t}return e.shadowSlopeScale!=null&&t.setUniform("slopeScale",e.shadowSlopeScale),e.shadowBias!=null&&t.setUniform("bias",e.shadowBias),this.softShadow===Ra.VSM?t.define("fragment","USE_VSM"):t.undefine("fragment","USE_VSM"),r&&(t.set("lightPosition",e.getWorldPosition().array),t.set("range",e.range)),t},_gaussianFilter:function(e,t,r){var n={width:r,height:r,type:Mt.FLOAT},i=this._texturePool.get(n);this._frameBuffer.attach(i),this._frameBuffer.bind(e),this._gaussianPassH.setUniform("texture",t),this._gaussianPassH.setUniform("textureWidth",r),this._gaussianPassH.render(e),this._frameBuffer.attach(t),this._gaussianPassV.setUniform("texture",i),this._gaussianPassV.setUniform("textureHeight",r),this._gaussianPassV.render(e),this._frameBuffer.unbind(e),this._texturePool.put(i)},_getTexture:function(e,t){var r=e.__uid__,n=this._textures[r],i=e.shadowResolution||512;return t=t||1,n||(e.type==="POINT_LIGHT"?n=new Du:n=new xe,n.width=i*t,n.height=i,this.softShadow===Ra.VSM?(n.type=Mt.FLOAT,n.anisotropic=4):(n.minFilter=mt.NEAREST,n.magFilter=mt.NEAREST,n.useMipmap=!1),this._textures[r]=n),n},_getPointLightCamera:function(e,t){this._lightCameras.point||(this._lightCameras.point={px:new Kr,nx:new Kr,py:new Kr,ny:new Kr,pz:new Kr,nz:new Kr});var r=this._lightCameras.point[t];switch(r.far=e.range,r.fov=90,r.position.set(0,0,0),t){case"px":r.lookAt(ht.POSITIVE_X,ht.NEGATIVE_Y);break;case"nx":r.lookAt(ht.NEGATIVE_X,ht.NEGATIVE_Y);break;case"py":r.lookAt(ht.POSITIVE_Y,ht.POSITIVE_Z);break;case"ny":r.lookAt(ht.NEGATIVE_Y,ht.NEGATIVE_Z);break;case"pz":r.lookAt(ht.POSITIVE_Z,ht.NEGATIVE_Y);break;case"nz":r.lookAt(ht.NEGATIVE_Z,ht.NEGATIVE_Y);break}return e.getWorldPosition(r.position),r.update(),r},_getDirectionalLightCamera:function(){var e=new Nt,t=new vn,r=new vn;return function(n,i,a){this._lightCameras.directional||(this._lightCameras.directional=new bf);var o=this._lightCameras.directional;t.copy(i.viewBoundingBoxLastFrame),t.intersection(a.frustum.boundingBox),o.position.copy(t.min).add(t.max).scale(.5).transformMat4(a.worldTransform),o.rotation.copy(n.rotation),o.scale.copy(n.scale),o.updateWorldTransform(),Nt.invert(e,o.worldTransform),Nt.multiply(e,e,a.worldTransform),r.copy(t).applyTransform(e);var s=r.min.array,l=r.max.array;return o.position.set((s[0]+l[0])/2,(s[1]+l[1])/2,l[2]).transformMat4(o.worldTransform),o.near=0,o.far=-s[2]+l[2],isNaN(this.lightFrustumBias)?o.far*=4:o.far+=this.lightFrustumBias,o.left=s[0],o.right=l[0],o.top=l[1],o.bottom=s[1],o.update(!0),o}}(),_getSpotLightCamera:function(e){this._lightCameras.spot||(this._lightCameras.spot=new Kr);var t=this._lightCameras.spot;return t.fov=e.penumbraAngle*2,t.far=e.range,t.worldTransform.copy(e.worldTransform),t.updateProjectionMatrix(),xt.invert(t.viewMatrix.array,t.worldTransform.array),t},dispose:function(e){var t=e.gl||e;this._frameBuffer&&this._frameBuffer.dispose(t);for(var r in this._textures)this._textures[r].dispose(t);this._texturePool.clear(e.gl),this._depthMaterials={},this._distanceMaterials={},this._textures={},this._lightCameras={},this._shadowMapNumber={POINT_LIGHT:0,DIRECTIONAL_LIGHT:0,SPOT_LIGHT:0},this._meshMaterials={};for(var n=0;n<this._receivers.length;n++){var i=this._receivers[n];if(i.material){var a=i.material;a.undefine("fragment","POINT_LIGHT_SHADOW_COUNT"),a.undefine("fragment","DIRECTIONAL_LIGHT_SHADOW_COUNT"),a.undefine("fragment","AMBIENT_LIGHT_SHADOW_COUNT"),a.set("shadowEnabled",0)}}this._receivers=[],this._lightsCastShadow=[]}});Ra.VSM=1;Ra.PCF=2;var hv=gn.extend(function(){return{name:"",inputLinks:{},outputLinks:{},_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},{updateParameter:function(e,t){var r=this.outputs[e],n=r.parameters,i=r._parametersCopy;if(i||(i=r._parametersCopy={}),n)for(var a in n)a!=="width"&&a!=="height"&&(i[a]=n[a]);var o,s;return n.width instanceof Function?o=n.width.call(this,t):o=n.width,n.height instanceof Function?s=n.height.call(this,t):s=n.height,(i.width!==o||i.height!==s)&&this._outputTextures[e]&&this._outputTextures[e].dispose(t.gl),i.width=o,i.height=s,i},setParameter:function(e,t){},getParameter:function(e){},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},render:function(){},getOutput:function(e,t){if(t==null)return t=e,this._outputTextures[t];var r=this.outputs[t];if(r)return this._rendered?r.outputLastFrame?this._prevOutputTextures[t]:this._outputTextures[t]:this._rendering?(this._prevOutputTextures[t]||(this._prevOutputTextures[t]=this._compositor.allocateTexture(r.parameters||{})),this._prevOutputTextures[t]):(this.render(e),this._outputTextures[t])},removeReference:function(e){if(this._outputReferences[e]--,this._outputReferences[e]===0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},link:function(e,t,r){this.inputLinks[e]={node:t,pin:r},t.outputLinks[r]||(t.outputLinks[r]=[]),t.outputLinks[r].push({node:this,pin:e}),this.pass.material.enableTexture(e)},clear:function(){this.inputLinks={},this.outputLinks={}},updateReference:function(e){if(!this._rendering){this._rendering=!0;for(var t in this.inputLinks){var r=this.inputLinks[t];r.node.updateReference(r.pin)}this._rendering=!1}e&&this._outputReferences[e]++},beforeFrame:function(){this._rendered=!1;for(var e in this.outputLinks)this._outputReferences[e]=0},afterFrame:function(){for(var e in this.outputLinks)if(this._outputReferences[e]>0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}}}),SI=gn.extend(function(){return{nodes:[]}},{dirty:function(){this._dirty=!0},addNode:function(e){this.nodes.indexOf(e)>=0||(this.nodes.push(e),this._dirty=!0)},removeNode:function(e){typeof e=="string"&&(e=this.getNodeByName(e));var t=this.nodes.indexOf(e);t>=0&&(this.nodes.splice(t,1),this._dirty=!0)},getNodeByName:function(e){for(var t=0;t<this.nodes.length;t++)if(this.nodes[t].name===e)return this.nodes[t]},update:function(){for(var e=0;e<this.nodes.length;e++)this.nodes[e].clear();for(var e=0;e<this.nodes.length;e++){var t=this.nodes[e];if(t.inputs){for(var r in t.inputs)if(t.inputs[r]){if(t.pass&&!t.pass.material.isUniformEnabled(r)){console.warn("Pin "+t.name+"."+r+" not used.");continue}var n=t.inputs[r],i=this.findPin(n);i?t.link(r,i.node,i.pin):console.warn(typeof n=="string"?"Node "+n+" not exist":"Pin of "+n.node+"."+n.pin+" not exist")}}}},findPin:function(e){var t;if((typeof e=="string"||e instanceof hv)&&(e={node:e}),typeof e.node=="string")for(var r=0;r<this.nodes.length;r++){var n=this.nodes[r];n.name===e.node&&(t=n)}else t=e.node;if(t){var i=e.pin;if(i||t.outputs&&(i=Object.keys(t.outputs)[0]),t.outputs[i])return{node:t,pin:i}}}}),iot=SI.extend(function(){return{_outputs:[],_texturePool:new h_,_frameBuffer:new Ir({depthBuffer:!1})}},{addNode:function(e){SI.prototype.addNode.call(this,e),e._compositor=this},render:function(e,t){if(this._dirty){this.update(),this._dirty=!1,this._outputs.length=0;for(var r=0;r<this.nodes.length;r++)this.nodes[r].outputs||this._outputs.push(this.nodes[r])}for(var r=0;r<this.nodes.length;r++)this.nodes[r].beforeFrame();for(var r=0;r<this._outputs.length;r++)this._outputs[r].updateReference();for(var r=0;r<this._outputs.length;r++)this._outputs[r].render(e,t);for(var r=0;r<this.nodes.length;r++)this.nodes[r].afterFrame()},allocateTexture:function(e){return this._texturePool.get(e)},releaseTexture:function(e){this._texturePool.put(e)},getFrameBuffer:function(){return this._frameBuffer},dispose:function(e){this._texturePool.clear(e)}}),aot=hv.extend({name:"scene",scene:null,camera:null,autoUpdateScene:!0,preZ:!1},function(){this.frameBuffer=new Ir},{render:function(e){this._rendering=!0;var t=e.gl;this.trigger("beforerender");var r;if(!this.outputs)r=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ);else{var n=this.frameBuffer;for(var i in this.outputs){var a=this.updateParameter(i,e),o=this.outputs[i],s=this._compositor.allocateTexture(a);this._outputTextures[i]=s;var l=o.attachment||t.COLOR_ATTACHMENT0;typeof l=="string"&&(l=t[l]),n.attach(s,l)}n.bind(e);var u=e.getGLExtension("EXT_draw_buffers");if(u){var h=[];for(var l in this.outputs)l=parseInt(l),l>=t.COLOR_ATTACHMENT0&&l<=t.COLOR_ATTACHMENT0+8&&h.push(l);u.drawBuffersEXT(h)}e.saveClear(),e.clearBit=mt.DEPTH_BUFFER_BIT|mt.COLOR_BUFFER_BIT,r=e.render(this.scene,this.camera,!this.autoUpdateScene,this.preZ),e.restoreClear(),n.unbind(e)}this.trigger("afterrender",r),this._rendering=!1,this._rendered=!0}}),oot=hv.extend(function(){return{texture:null,outputs:{color:{}}}},function(){},{getOutput:function(e,t){return this.texture},beforeFrame:function(){},afterFrame:function(){}}),sot=hv.extend(function(){return{name:"",inputs:{},outputs:null,shader:"",inputLinks:{},outputLinks:{},pass:null,_prevOutputTextures:{},_outputTextures:{},_outputReferences:{},_rendering:!1,_rendered:!1,_compositor:null}},function(){var e=new kr({fragment:this.shader});this.pass=e},{render:function(e,t){this.trigger("beforerender",e),this._rendering=!0;var r=e.gl;for(var n in this.inputLinks){var i=this.inputLinks[n],a=i.node.getOutput(e,i.pin);this.pass.setUniform(n,a)}if(!this.outputs)this.pass.outputs=null,this._compositor.getFrameBuffer().unbind(e),this.pass.render(e,t);else{this.pass.outputs={};var o={};for(var s in this.outputs){var l=this.updateParameter(s,e);isNaN(l.width)&&this.updateParameter(s,e);var u=this.outputs[s],h=this._compositor.allocateTexture(l);this._outputTextures[s]=h;var f=u.attachment||r.COLOR_ATTACHMENT0;typeof f=="string"&&(f=r[f]),o[f]=h}this._compositor.getFrameBuffer().bind(e);for(var f in o)this._compositor.getFrameBuffer().attach(o[f],f);this.pass.render(e),this._compositor.getFrameBuffer().updateMipmap(e)}for(var n in this.inputLinks){var i=this.inputLinks[n];i.node.removeReference(i.pin)}this._rendering=!1,this._rendered=!0,this.trigger("afterrender",e)},updateParameter:function(e,t){var r=this.outputs[e],n=r.parameters,i=r._parametersCopy;if(i||(i=r._parametersCopy={}),n)for(var a in n)a!=="width"&&a!=="height"&&(i[a]=n[a]);var o,s;return typeof n.width=="function"?o=n.width.call(this,t):o=n.width,typeof n.height=="function"?s=n.height.call(this,t):s=n.height,o=Math.ceil(o),s=Math.ceil(s),(i.width!==o||i.height!==s)&&this._outputTextures[e]&&this._outputTextures[e].dispose(t),i.width=o,i.height=s,i},setParameter:function(e,t){this.pass.setUniform(e,t)},getParameter:function(e){return this.pass.getUniform(e)},setParameters:function(e){for(var t in e)this.setParameter(t,e[t])},define:function(e,t){this.pass.material.define("fragment",e,t)},undefine:function(e){this.pass.material.undefine("fragment",e)},removeReference:function(e){if(this._outputReferences[e]--,this._outputReferences[e]===0){var t=this.outputs[e];t.keepLastFrame?(this._prevOutputTextures[e]&&this._compositor.releaseTexture(this._prevOutputTextures[e]),this._prevOutputTextures[e]=this._outputTextures[e]):this._compositor.releaseTexture(this._outputTextures[e])}},clear:function(){hv.prototype.clear.call(this),this.pass.material.disableTexturesAll()}});const lot=`@export clay.compositor.coloradjust
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float brightness : 0.0;
uniform float contrast : 1.0;
uniform float exposure : 0.0;
uniform float gamma : 1.0;
uniform float saturation : 1.0;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = clamp(tex.rgb + vec3(brightness), 0.0, 1.0);
 color = clamp( (color-vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);
 color = clamp( color * pow(2.0, exposure), 0.0, 1.0);
 color = clamp( pow(color, vec3(gamma)), 0.0, 1.0);
 float luminance = dot( color, w );
 color = mix(vec3(luminance), color, saturation);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.brightness
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float brightness : 0.0;
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = tex.rgb + vec3(brightness);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.contrast
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float contrast : 1.0;
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord);
 vec3 color = (tex.rgb-vec3(0.5))*contrast+vec3(0.5);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.exposure
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float exposure : 0.0;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = tex.rgb * pow(2.0, exposure);
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.gamma
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float gamma : 1.0;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = pow(tex.rgb, vec3(gamma));
 gl_FragColor = vec4(color, tex.a);
}
@end
@export clay.compositor.saturation
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float saturation : 1.0;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 vec3 color = tex.rgb;
 float luminance = dot(color, w);
 color = mix(vec3(luminance), color, saturation);
 gl_FragColor = vec4(color, tex.a);
}
@end`,qk=`@export clay.compositor.kernel.gaussian_9
float gaussianKernel[9];
gaussianKernel[0] = 0.07;
gaussianKernel[1] = 0.09;
gaussianKernel[2] = 0.12;
gaussianKernel[3] = 0.14;
gaussianKernel[4] = 0.16;
gaussianKernel[5] = 0.14;
gaussianKernel[6] = 0.12;
gaussianKernel[7] = 0.09;
gaussianKernel[8] = 0.07;
@end
@export clay.compositor.kernel.gaussian_13
float gaussianKernel[13];
gaussianKernel[0] = 0.02;
gaussianKernel[1] = 0.03;
gaussianKernel[2] = 0.06;
gaussianKernel[3] = 0.08;
gaussianKernel[4] = 0.11;
gaussianKernel[5] = 0.13;
gaussianKernel[6] = 0.14;
gaussianKernel[7] = 0.13;
gaussianKernel[8] = 0.11;
gaussianKernel[9] = 0.08;
gaussianKernel[10] = 0.06;
gaussianKernel[11] = 0.03;
gaussianKernel[12] = 0.02;
@end
@export clay.compositor.gaussian_blur
#define SHADER_NAME gaussian_blur
uniform sampler2D texture;varying vec2 v_Texcoord;
uniform float blurSize : 2.0;
uniform vec2 textureSize : [512.0, 512.0];
uniform float blurDir : 0.0;
@import clay.util.rgbm
@import clay.util.clamp_sample
void main (void)
{
 @import clay.compositor.kernel.gaussian_9
 vec2 off = blurSize / textureSize;
 off *= vec2(1.0 - blurDir, blurDir);
 vec4 sum = vec4(0.0);
 float weightAll = 0.0;
 for (int i = 0; i < 9; i++) {
 float w = gaussianKernel[i];
 vec4 texel = decodeHDR(clampSample(texture, v_Texcoord + float(i - 4) * off));
 sum += texel * w;
 weightAll += w;
 }
 gl_FragColor = encodeHDR(sum / max(weightAll, 0.01));
}
@end
`,uot=`@export clay.compositor.hdr.log_lum
varying vec2 v_Texcoord;
uniform sampler2D texture;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
@import clay.util.rgbm
void main()
{
 vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));
 float luminance = dot(tex.rgb, w);
 luminance = log(luminance + 0.001);
 gl_FragColor = encodeHDR(vec4(vec3(luminance), 1.0));
}
@end
@export clay.compositor.hdr.lum_adaption
varying vec2 v_Texcoord;
uniform sampler2D adaptedLum;
uniform sampler2D currentLum;
uniform float frameTime : 0.02;
@import clay.util.rgbm
void main()
{
 float fAdaptedLum = decodeHDR(texture2D(adaptedLum, vec2(0.5, 0.5))).r;
 float fCurrentLum = exp(encodeHDR(texture2D(currentLum, vec2(0.5, 0.5))).r);
 fAdaptedLum += (fCurrentLum - fAdaptedLum) * (1.0 - pow(0.98, 30.0 * frameTime));
 gl_FragColor = encodeHDR(vec4(vec3(fAdaptedLum), 1.0));
}
@end
@export clay.compositor.lum
varying vec2 v_Texcoord;
uniform sampler2D texture;
const vec3 w = vec3(0.2125, 0.7154, 0.0721);
void main()
{
 vec4 tex = texture2D( texture, v_Texcoord );
 float luminance = dot(tex.rgb, w);
 gl_FragColor = vec4(vec3(luminance), 1.0);
}
@end`,$k=`
@export clay.compositor.lut
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform sampler2D lookup;
void main()
{
 vec4 tex = texture2D(texture, v_Texcoord);
 float blueColor = tex.b * 63.0;
 vec2 quad1;
 quad1.y = floor(floor(blueColor) / 8.0);
 quad1.x = floor(blueColor) - (quad1.y * 8.0);
 vec2 quad2;
 quad2.y = floor(ceil(blueColor) / 8.0);
 quad2.x = ceil(blueColor) - (quad2.y * 8.0);
 vec2 texPos1;
 texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);
 texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);
 vec2 texPos2;
 texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.r);
 texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * tex.g);
 vec4 newColor1 = texture2D(lookup, texPos1);
 vec4 newColor2 = texture2D(lookup, texPos2);
 vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
 gl_FragColor = vec4(newColor.rgb, tex.w);
}
@end`,hot=`@export clay.compositor.vignette
#define OUTPUT_ALPHA
varying vec2 v_Texcoord;
uniform sampler2D texture;
uniform float darkness: 1;
uniform float offset: 1;
@import clay.util.rgbm
void main()
{
 vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));
 gl_FragColor.rgb = texel.rgb;
 vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(offset);
 gl_FragColor = encodeHDR(vec4(mix(texel.rgb, vec3(1.0 - darkness), dot(uv, uv)), texel.a));
}
@end`,Kk=`@export clay.compositor.output
#define OUTPUT_ALPHA
varying vec2 v_Texcoord;
uniform sampler2D texture;
@import clay.util.rgbm
void main()
{
 vec4 tex = decodeHDR(texture2D(texture, v_Texcoord));
 gl_FragColor.rgb = tex.rgb;
#ifdef OUTPUT_ALPHA
 gl_FragColor.a = tex.a;
#else
 gl_FragColor.a = 1.0;
#endif
 gl_FragColor = encodeHDR(gl_FragColor);
#ifdef PREMULTIPLY_ALPHA
 gl_FragColor.rgb *= gl_FragColor.a;
#endif
}
@end`,jk=`@export clay.compositor.bright
uniform sampler2D texture;
uniform float threshold : 1;
uniform float scale : 1.0;
uniform vec2 textureSize: [512, 512];
varying vec2 v_Texcoord;
const vec3 lumWeight = vec3(0.2125, 0.7154, 0.0721);
@import clay.util.rgbm
vec4 median(vec4 a, vec4 b, vec4 c)
{
 return a + b + c - min(min(a, b), c) - max(max(a, b), c);
}
void main()
{
 vec4 texel = decodeHDR(texture2D(texture, v_Texcoord));
#ifdef ANTI_FLICKER
 vec3 d = 1.0 / textureSize.xyx * vec3(1.0, 1.0, 0.0);
 vec4 s1 = decodeHDR(texture2D(texture, v_Texcoord - d.xz));
 vec4 s2 = decodeHDR(texture2D(texture, v_Texcoord + d.xz));
 vec4 s3 = decodeHDR(texture2D(texture, v_Texcoord - d.zy));
 vec4 s4 = decodeHDR(texture2D(texture, v_Texcoord + d.zy));
 texel = median(median(texel, s1, s2), s3, s4);
#endif
 float lum = dot(texel.rgb , lumWeight);
 vec4 color;
 if (lum > threshold && texel.a > 0.0)
 {
 color = vec4(texel.rgb * scale, texel.a * scale);
 }
 else
 {
 color = vec4(0.0);
 }
 gl_FragColor = encodeHDR(color);
}
@end
`,Jk=`@export clay.compositor.downsample
uniform sampler2D texture;
uniform vec2 textureSize : [512, 512];
varying vec2 v_Texcoord;
@import clay.util.rgbm
float brightness(vec3 c)
{
 return max(max(c.r, c.g), c.b);
}
@import clay.util.clamp_sample
void main()
{
 vec4 d = vec4(-1.0, -1.0, 1.0, 1.0) / textureSize.xyxy;
#ifdef ANTI_FLICKER
 vec3 s1 = decodeHDR(clampSample(texture, v_Texcoord + d.xy)).rgb;
 vec3 s2 = decodeHDR(clampSample(texture, v_Texcoord + d.zy)).rgb;
 vec3 s3 = decodeHDR(clampSample(texture, v_Texcoord + d.xw)).rgb;
 vec3 s4 = decodeHDR(clampSample(texture, v_Texcoord + d.zw)).rgb;
 float s1w = 1.0 / (brightness(s1) + 1.0);
 float s2w = 1.0 / (brightness(s2) + 1.0);
 float s3w = 1.0 / (brightness(s3) + 1.0);
 float s4w = 1.0 / (brightness(s4) + 1.0);
 float oneDivideSum = 1.0 / (s1w + s2w + s3w + s4w);
 vec4 color = vec4(
 (s1 * s1w + s2 * s2w + s3 * s3w + s4 * s4w) * oneDivideSum,
 1.0
 );
#else
 vec4 color = decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.xw));
 color += decodeHDR(clampSample(texture, v_Texcoord + d.zw));
 color *= 0.25;
#endif
 gl_FragColor = encodeHDR(color);
}
@end`,Qk=`
@export clay.compositor.upsample
#define HIGH_QUALITY
uniform sampler2D texture;
uniform vec2 textureSize : [512, 512];
uniform float sampleScale: 0.5;
varying vec2 v_Texcoord;
@import clay.util.rgbm
@import clay.util.clamp_sample
void main()
{
#ifdef HIGH_QUALITY
 vec4 d = vec4(1.0, 1.0, -1.0, 0.0) / textureSize.xyxy * sampleScale;
 vec4 s;
 s = decodeHDR(clampSample(texture, v_Texcoord - d.xy));
 s += decodeHDR(clampSample(texture, v_Texcoord - d.wy)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord - d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zw)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord )) * 4.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xw)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.wy)) * 2.0;
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 gl_FragColor = encodeHDR(s / 16.0);
#else
 vec4 d = vec4(-1.0, -1.0, +1.0, +1.0) / textureSize.xyxy;
 vec4 s;
 s = decodeHDR(clampSample(texture, v_Texcoord + d.xy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zy));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.xw));
 s += decodeHDR(clampSample(texture, v_Texcoord + d.zw));
 gl_FragColor = encodeHDR(s / 4.0);
#endif
}
@end`,tG=`@export clay.compositor.hdr.composite
#define TONEMAPPING
uniform sampler2D texture;
#ifdef BLOOM_ENABLED
uniform sampler2D bloom;
#endif
#ifdef LENSFLARE_ENABLED
uniform sampler2D lensflare;
uniform sampler2D lensdirt;
#endif
#ifdef LUM_ENABLED
uniform sampler2D lum;
#endif
#ifdef LUT_ENABLED
uniform sampler2D lut;
#endif
#ifdef COLOR_CORRECTION
uniform float brightness : 0.0;
uniform float contrast : 1.0;
uniform float saturation : 1.0;
#endif
#ifdef VIGNETTE
uniform float vignetteDarkness: 1.0;
uniform float vignetteOffset: 1.0;
#endif
uniform float exposure : 1.0;
uniform float bloomIntensity : 0.25;
uniform float lensflareIntensity : 1;
varying vec2 v_Texcoord;
@import clay.util.srgb
vec3 ACESToneMapping(vec3 color)
{
 const float A = 2.51;
 const float B = 0.03;
 const float C = 2.43;
 const float D = 0.59;
 const float E = 0.14;
 return (color * (A * color + B)) / (color * (C * color + D) + E);
}
float eyeAdaption(float fLum)
{
 return mix(0.2, fLum, 0.5);
}
#ifdef LUT_ENABLED
vec3 lutTransform(vec3 color) {
 float blueColor = color.b * 63.0;
 vec2 quad1;
 quad1.y = floor(floor(blueColor) / 8.0);
 quad1.x = floor(blueColor) - (quad1.y * 8.0);
 vec2 quad2;
 quad2.y = floor(ceil(blueColor) / 8.0);
 quad2.x = ceil(blueColor) - (quad2.y * 8.0);
 vec2 texPos1;
 texPos1.x = (quad1.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
 texPos1.y = (quad1.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);
 vec2 texPos2;
 texPos2.x = (quad2.x * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.r);
 texPos2.y = (quad2.y * 0.125) + 0.5/512.0 + ((0.125 - 1.0/512.0) * color.g);
 vec4 newColor1 = texture2D(lut, texPos1);
 vec4 newColor2 = texture2D(lut, texPos2);
 vec4 newColor = mix(newColor1, newColor2, fract(blueColor));
 return newColor.rgb;
}
#endif
@import clay.util.rgbm
void main()
{
 vec4 texel = vec4(0.0);
 vec4 originalTexel = vec4(0.0);
#ifdef TEXTURE_ENABLED
 texel = decodeHDR(texture2D(texture, v_Texcoord));
 originalTexel = texel;
#endif
#ifdef BLOOM_ENABLED
 vec4 bloomTexel = decodeHDR(texture2D(bloom, v_Texcoord));
 texel.rgb += bloomTexel.rgb * bloomIntensity;
 texel.a += bloomTexel.a * bloomIntensity;
#endif
#ifdef LENSFLARE_ENABLED
 texel += decodeHDR(texture2D(lensflare, v_Texcoord)) * texture2D(lensdirt, v_Texcoord) * lensflareIntensity;
#endif
 texel.a = min(texel.a, 1.0);
#ifdef LUM_ENABLED
 float fLum = texture2D(lum, vec2(0.5, 0.5)).r;
 float adaptedLumDest = 3.0 / (max(0.1, 1.0 + 10.0*eyeAdaption(fLum)));
 float exposureBias = adaptedLumDest * exposure;
#else
 float exposureBias = exposure;
#endif
#ifdef TONEMAPPING
 texel.rgb *= exposureBias;
 texel.rgb = ACESToneMapping(texel.rgb);
#endif
 texel = linearTosRGB(texel);
#ifdef LUT_ENABLED
 texel.rgb = lutTransform(clamp(texel.rgb,vec3(0.0),vec3(1.0)));
#endif
#ifdef COLOR_CORRECTION
 texel.rgb = clamp(texel.rgb + vec3(brightness), 0.0, 1.0);
 texel.rgb = clamp((texel.rgb - vec3(0.5))*contrast+vec3(0.5), 0.0, 1.0);
 float lum = dot(texel.rgb, vec3(0.2125, 0.7154, 0.0721));
 texel.rgb = mix(vec3(lum), texel.rgb, saturation);
#endif
#ifdef VIGNETTE
 vec2 uv = (v_Texcoord - vec2(0.5)) * vec2(vignetteOffset);
 texel.rgb = mix(texel.rgb, vec3(1.0 - vignetteDarkness), dot(uv, uv));
#endif
 gl_FragColor = encodeHDR(texel);
#ifdef DEBUG
 #if DEBUG == 1
 gl_FragColor = encodeHDR(decodeHDR(texture2D(texture, v_Texcoord)));
 #elif DEBUG == 2
 gl_FragColor = encodeHDR(decodeHDR(texture2D(bloom, v_Texcoord)) * bloomIntensity);
 #elif DEBUG == 3
 gl_FragColor = encodeHDR(decodeHDR(texture2D(lensflare, v_Texcoord) * lensflareIntensity));
 #endif
#endif
 if (originalTexel.a <= 0.01 && gl_FragColor.a > 1e-5) {
 gl_FragColor.a = dot(gl_FragColor.rgb, vec3(0.2125, 0.7154, 0.0721));
 }
#ifdef PREMULTIPLY_ALPHA
 gl_FragColor.rgb *= gl_FragColor.a;
#endif
}
@end`,fot=`@export clay.compositor.lensflare
#define SAMPLE_NUMBER 8
uniform sampler2D texture;
uniform sampler2D lenscolor;
uniform vec2 textureSize : [512, 512];
uniform float dispersal : 0.3;
uniform float haloWidth : 0.4;
uniform float distortion : 1.0;
varying vec2 v_Texcoord;
@import clay.util.rgbm
vec4 textureDistorted(
 in vec2 texcoord,
 in vec2 direction,
 in vec3 distortion
) {
 return vec4(
 decodeHDR(texture2D(texture, texcoord + direction * distortion.r)).r,
 decodeHDR(texture2D(texture, texcoord + direction * distortion.g)).g,
 decodeHDR(texture2D(texture, texcoord + direction * distortion.b)).b,
 1.0
 );
}
void main()
{
 vec2 texcoord = -v_Texcoord + vec2(1.0); vec2 textureOffset = 1.0 / textureSize;
 vec2 ghostVec = (vec2(0.5) - texcoord) * dispersal;
 vec2 haloVec = normalize(ghostVec) * haloWidth;
 vec3 distortion = vec3(-textureOffset.x * distortion, 0.0, textureOffset.x * distortion);
 vec4 result = vec4(0.0);
 for (int i = 0; i < SAMPLE_NUMBER; i++)
 {
 vec2 offset = fract(texcoord + ghostVec * float(i));
 float weight = length(vec2(0.5) - offset) / length(vec2(0.5));
 weight = pow(1.0 - weight, 10.0);
 result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;
 }
 result *= texture2D(lenscolor, vec2(length(vec2(0.5) - texcoord)) / length(vec2(0.5)));
 float weight = length(vec2(0.5) - fract(texcoord + haloVec)) / length(vec2(0.5));
 weight = pow(1.0 - weight, 10.0);
 vec2 offset = fract(texcoord + haloVec);
 result += textureDistorted(offset, normalize(ghostVec), distortion) * weight;
 gl_FragColor = result;
}
@end`,eG=`@export clay.compositor.blend
#define SHADER_NAME blend
#ifdef TEXTURE1_ENABLED
uniform sampler2D texture1;
uniform float weight1 : 1.0;
#endif
#ifdef TEXTURE2_ENABLED
uniform sampler2D texture2;
uniform float weight2 : 1.0;
#endif
#ifdef TEXTURE3_ENABLED
uniform sampler2D texture3;
uniform float weight3 : 1.0;
#endif
#ifdef TEXTURE4_ENABLED
uniform sampler2D texture4;
uniform float weight4 : 1.0;
#endif
#ifdef TEXTURE5_ENABLED
uniform sampler2D texture5;
uniform float weight5 : 1.0;
#endif
#ifdef TEXTURE6_ENABLED
uniform sampler2D texture6;
uniform float weight6 : 1.0;
#endif
varying vec2 v_Texcoord;
@import clay.util.rgbm
void main()
{
 vec4 tex = vec4(0.0);
#ifdef TEXTURE1_ENABLED
 tex += decodeHDR(texture2D(texture1, v_Texcoord)) * weight1;
#endif
#ifdef TEXTURE2_ENABLED
 tex += decodeHDR(texture2D(texture2, v_Texcoord)) * weight2;
#endif
#ifdef TEXTURE3_ENABLED
 tex += decodeHDR(texture2D(texture3, v_Texcoord)) * weight3;
#endif
#ifdef TEXTURE4_ENABLED
 tex += decodeHDR(texture2D(texture4, v_Texcoord)) * weight4;
#endif
#ifdef TEXTURE5_ENABLED
 tex += decodeHDR(texture2D(texture5, v_Texcoord)) * weight5;
#endif
#ifdef TEXTURE6_ENABLED
 tex += decodeHDR(texture2D(texture6, v_Texcoord)) * weight6;
#endif
 gl_FragColor = encodeHDR(tex);
}
@end`,rG=`@export clay.compositor.fxaa
uniform sampler2D texture;
uniform vec4 viewport : VIEWPORT;
varying vec2 v_Texcoord;
#define FXAA_REDUCE_MIN (1.0/128.0)
#define FXAA_REDUCE_MUL (1.0/8.0)
#define FXAA_SPAN_MAX 8.0
@import clay.util.rgbm
void main()
{
 vec2 resolution = 1.0 / viewport.zw;
 vec3 rgbNW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, -1.0 ) ) * resolution ) ).xyz;
 vec3 rgbNE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, -1.0 ) ) * resolution ) ).xyz;
 vec3 rgbSW = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( -1.0, 1.0 ) ) * resolution ) ).xyz;
 vec3 rgbSE = decodeHDR( texture2D( texture, ( gl_FragCoord.xy + vec2( 1.0, 1.0 ) ) * resolution ) ).xyz;
 vec4 rgbaM = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution ) );
 vec3 rgbM = rgbaM.xyz;
 float opacity = rgbaM.w;
 vec3 luma = vec3( 0.299, 0.587, 0.114 );
 float lumaNW = dot( rgbNW, luma );
 float lumaNE = dot( rgbNE, luma );
 float lumaSW = dot( rgbSW, luma );
 float lumaSE = dot( rgbSE, luma );
 float lumaM = dot( rgbM, luma );
 float lumaMin = min( lumaM, min( min( lumaNW, lumaNE ), min( lumaSW, lumaSE ) ) );
 float lumaMax = max( lumaM, max( max( lumaNW, lumaNE) , max( lumaSW, lumaSE ) ) );
 vec2 dir;
 dir.x = -((lumaNW + lumaNE) - (lumaSW + lumaSE));
 dir.y = ((lumaNW + lumaSW) - (lumaNE + lumaSE));
 float dirReduce = max( ( lumaNW + lumaNE + lumaSW + lumaSE ) * ( 0.25 * FXAA_REDUCE_MUL ), FXAA_REDUCE_MIN );
 float rcpDirMin = 1.0 / ( min( abs( dir.x ), abs( dir.y ) ) + dirReduce );
 dir = min( vec2( FXAA_SPAN_MAX, FXAA_SPAN_MAX),
 max( vec2(-FXAA_SPAN_MAX, -FXAA_SPAN_MAX),
 dir * rcpDirMin)) * resolution;
 vec3 rgbA = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 1.0 / 3.0 - 0.5 ) ) ).xyz;
 rgbA += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * ( 2.0 / 3.0 - 0.5 ) ) ).xyz;
 rgbA *= 0.5;
 vec3 rgbB = decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * -0.5 ) ).xyz;
 rgbB += decodeHDR( texture2D( texture, gl_FragCoord.xy * resolution + dir * 0.5 ) ).xyz;
 rgbB *= 0.25;
 rgbB += rgbA * 0.5;
 float lumaB = dot( rgbB, luma );
 if ( ( lumaB < lumaMin ) || ( lumaB > lumaMax ) )
 {
 gl_FragColor = vec4( rgbA, opacity );
 }
 else {
 gl_FragColor = vec4( rgbB, opacity );
 }
}
@end`;function cot(e){e.import(lot),e.import(qk),e.import(uot),e.import($k),e.import(hot),e.import(Kk),e.import(jk),e.import(Jk),e.import(Qk),e.import(tG),e.import(fot),e.import(eG),e.import(rG)}cot(Et);var dot=/^#source\((.*?)\)/;function vot(e,t){var r=new iot;t=t||{};var n={textures:{},parameters:{}},i=function(s,l){for(var u=0;u<e.nodes.length;u++){var h=e.nodes[u],f=pot(h,n,t);f&&r.addNode(f)}};for(var a in e.parameters){var o=e.parameters[a];n.parameters[a]=sA(o)}return _ot(e,n,t,function(s){n.textures=s,i()}),r}function pot(e,t,r){var n=e.type||"filter",i,a,o;if(n==="filter"){var s=e.shader.trim(),l=dot.exec(s);if(l?i=Et.source(l[1].trim()):s.charAt(0)==="#"&&(i=t.shaders[s.substr(1)]),i||(i=s),!i)return}if(e.inputs){a={};for(var u in e.inputs)typeof e.inputs[u]=="string"?a[u]=e.inputs[u]:a[u]={node:e.inputs[u].node,pin:e.inputs[u].pin}}if(e.outputs){o={};for(var u in e.outputs){var h=e.outputs[u];o[u]={},h.attachment!=null&&(o[u].attachment=h.attachment),h.keepLastFrame!=null&&(o[u].keepLastFrame=h.keepLastFrame),h.outputLastFrame!=null&&(o[u].outputLastFrame=h.outputLastFrame),h.parameters&&(o[u].parameters=sA(h.parameters))}}var f;if(n==="scene"?f=new aot({name:e.name,scene:r.scene,camera:r.camera,outputs:o}):n==="texture"?f=new oot({name:e.name,outputs:o}):f=new sot({name:e.name,shader:i,inputs:a,outputs:o}),f){if(e.parameters)for(var u in e.parameters){var c=e.parameters[u];typeof c=="string"?(c=c.trim(),c.charAt(0)==="#"?c=t.textures[c.substr(1)]:f.on("beforerender",yot(u,nG(c)))):typeof c=="function"&&f.on("beforerender",c),f.setParameter(u,c)}if(e.defines&&f.pass)for(var u in e.defines){var c=e.defines[u];f.pass.material.define("fragment",u,c)}}return f}function got(e,t){return e}function mot(e,t){return t}function sA(e){var t={};if(!e)return t;["type","minFilter","magFilter","wrapS","wrapT","flipY","useMipmap"].forEach(function(n){var i=e[n];i!=null&&(typeof i=="string"&&(i=Mt[i]),t[n]=i)});var r=e.scale||1;return["width","height"].forEach(function(n){if(e[n]!=null){var i=e[n];typeof i=="string"?(i=i.trim(),t[n]=xot(n,nG(i),r)):t[n]=i}}),t.width||(t.width=got),t.height||(t.height=mot),e.useMipmap!=null&&(t.useMipmap=e.useMipmap),t}function _ot(e,t,r,n){if(!e.textures){n({});return}var i={},a=0,o=!1,s=r.textureRootPath;Lr.each(e.textures,function(l,u){var h,f=l.path,c=sA(l.parameters);if(Array.isArray(f)&&f.length===6)s&&(f=f.map(function(d){return Lr.relative2absolute(d,s)})),h=new Du(c);else if(typeof f=="string")s&&(f=Lr.relative2absolute(f,s)),h=new xe(c);else return;h.load(f),a++,h.once("success",function(){i[u]=h,a--,a===0&&(n(i),o=!0)})}),a===0&&!o&&n(i)}function yot(e,t){return function(r){var n=r.getDevicePixelRatio(),i=r.getWidth(),a=r.getHeight(),o=t(i,a,n);this.setParameter(e,o)}}function xot(e,t,r){return r=r||1,function(n){var i=n.getDevicePixelRatio(),a=n.getWidth()*r,o=n.getHeight()*r;return t(a,o,i)}}function nG(e){var t=/^expr\((.*)\)$/.exec(e);if(t)try{var r=new Function("width","height","dpr","return "+t[1]);return r(1,1),r}catch{throw new Error("Invalid expression.")}}function wf(e,t){for(var r=0,n=1/t,i=e;i>0;)r=r+n*(i%t),i=Math.floor(i/t),n=n/t;return r}const Sot=`@export ecgl.ssao.estimate

uniform sampler2D depthTex;

uniform sampler2D normalTex;

uniform sampler2D noiseTex;

uniform vec2 depthTexSize;

uniform vec2 noiseTexSize;

uniform mat4 projection;

uniform mat4 projectionInv;

uniform mat4 viewInverseTranspose;

uniform vec3 kernel[KERNEL_SIZE];

uniform float radius : 1;

uniform float power : 1;

uniform float bias: 1e-2;

uniform float intensity: 1.0;

varying vec2 v_Texcoord;

float ssaoEstimator(in vec3 originPos, in mat3 kernelBasis) {
 float occlusion = 0.0;

 for (int i = 0; i < KERNEL_SIZE; i++) {
 vec3 samplePos = kernel[i];
#ifdef NORMALTEX_ENABLED
 samplePos = kernelBasis * samplePos;
#endif
 samplePos = samplePos * radius + originPos;

 vec4 texCoord = projection * vec4(samplePos, 1.0);
 texCoord.xy /= texCoord.w;

 vec4 depthTexel = texture2D(depthTex, texCoord.xy * 0.5 + 0.5);

 float sampleDepth = depthTexel.r * 2.0 - 1.0;
 if (projection[3][3] == 0.0) {
 sampleDepth = projection[3][2] / (sampleDepth * projection[2][3] - projection[2][2]);
 }
 else {
 sampleDepth = (sampleDepth - projection[3][2]) / projection[2][2];
 }
 
 float rangeCheck = smoothstep(0.0, 1.0, radius / abs(originPos.z - sampleDepth));
 occlusion += rangeCheck * step(samplePos.z, sampleDepth - bias);
 }
#ifdef NORMALTEX_ENABLED
 occlusion = 1.0 - occlusion / float(KERNEL_SIZE);
#else
 occlusion = 1.0 - clamp((occlusion / float(KERNEL_SIZE) - 0.6) * 2.5, 0.0, 1.0);
#endif
 return pow(occlusion, power);
}

void main()
{

 vec4 depthTexel = texture2D(depthTex, v_Texcoord);

#ifdef NORMALTEX_ENABLED
 vec4 tex = texture2D(normalTex, v_Texcoord);
 if (dot(tex.rgb, tex.rgb) == 0.0) {
 gl_FragColor = vec4(1.0);
 return;
 }
 vec3 N = tex.rgb * 2.0 - 1.0;
 N = (viewInverseTranspose * vec4(N, 0.0)).xyz;

 vec2 noiseTexCoord = depthTexSize / vec2(noiseTexSize) * v_Texcoord;
 vec3 rvec = texture2D(noiseTex, noiseTexCoord).rgb * 2.0 - 1.0;
 vec3 T = normalize(rvec - N * dot(rvec, N));
 vec3 BT = normalize(cross(N, T));
 mat3 kernelBasis = mat3(T, BT, N);
#else
 if (depthTexel.r > 0.99999) {
 gl_FragColor = vec4(1.0);
 return;
 }
 mat3 kernelBasis;
#endif

 float z = depthTexel.r * 2.0 - 1.0;

 vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);
 vec4 p4 = projectionInv * projectedPos;

 vec3 position = p4.xyz / p4.w;

 float ao = ssaoEstimator(position, kernelBasis);
 ao = clamp(1.0 - (1.0 - ao) * intensity, 0.0, 1.0);
 gl_FragColor = vec4(vec3(ao), 1.0);
}

@end


@export ecgl.ssao.blur
#define SHADER_NAME SSAO_BLUR

uniform sampler2D ssaoTexture;

#ifdef NORMALTEX_ENABLED
uniform sampler2D normalTex;
#endif

varying vec2 v_Texcoord;

uniform vec2 textureSize;
uniform float blurSize : 1.0;

uniform int direction: 0.0;

#ifdef DEPTHTEX_ENABLED
uniform sampler2D depthTex;
uniform mat4 projection;
uniform float depthRange : 0.5;

float getLinearDepth(vec2 coord)
{
 float depth = texture2D(depthTex, coord).r * 2.0 - 1.0;
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
}
#endif

void main()
{
 float kernel[5];
 kernel[0] = 0.122581;
 kernel[1] = 0.233062;
 kernel[2] = 0.288713;
 kernel[3] = 0.233062;
 kernel[4] = 0.122581;

 vec2 off = vec2(0.0);
 if (direction == 0) {
 off[0] = blurSize / textureSize.x;
 }
 else {
 off[1] = blurSize / textureSize.y;
 }

 vec2 coord = v_Texcoord;

 float sum = 0.0;
 float weightAll = 0.0;

#ifdef NORMALTEX_ENABLED
 vec3 centerNormal = texture2D(normalTex, v_Texcoord).rgb * 2.0 - 1.0;
#endif
#if defined(DEPTHTEX_ENABLED)
 float centerDepth = getLinearDepth(v_Texcoord);
#endif

 for (int i = 0; i < 5; i++) {
 vec2 coord = clamp(v_Texcoord + vec2(float(i) - 2.0) * off, vec2(0.0), vec2(1.0));

 float w = kernel[i];
#ifdef NORMALTEX_ENABLED
 vec3 normal = texture2D(normalTex, coord).rgb * 2.0 - 1.0;
 w *= clamp(dot(normal, centerNormal), 0.0, 1.0);
#endif
#ifdef DEPTHTEX_ENABLED
 float d = getLinearDepth(coord);
 w *= (1.0 - smoothstep(abs(centerDepth - d) / depthRange, 0.0, 1.0));
#endif

 weightAll += w;
 sum += texture2D(ssaoTexture, coord).r * w;
 }

 gl_FragColor = vec4(vec3(sum / weightAll), 1.0);
}

@end
`;Et.import(Sot);function iG(e){for(var t=new Uint8Array(e*e*4),r=0,n=new ht,i=0;i<e;i++)for(var a=0;a<e;a++)n.set(Math.random()*2-1,Math.random()*2-1,0).normalize(),t[r++]=(n.x*.5+.5)*255,t[r++]=(n.y*.5+.5)*255,t[r++]=0,t[r++]=255;return t}function TI(e){return new xe({pixels:iG(e),wrapS:Mt.REPEAT,wrapT:Mt.REPEAT,width:e,height:e})}function Tot(e,t,r){var n=new Float32Array(e*3);t=t||0;for(var i=0;i<e;i++){var a=wf(i+t,2)*(r?1:2)*Math.PI,o=wf(i+t,3)*Math.PI,s=Math.random(),l=Math.cos(a)*Math.sin(o)*s,u=Math.cos(o)*s,h=Math.sin(a)*Math.sin(o)*s;n[i*3]=l,n[i*3+1]=u,n[i*3+2]=h}return n}function Ho(e){e=e||{},this._ssaoPass=new kr({fragment:Et.source("ecgl.ssao.estimate")}),this._blurPass=new kr({fragment:Et.source("ecgl.ssao.blur")}),this._framebuffer=new Ir({depthBuffer:!1}),this._ssaoTexture=new xe,this._blurTexture=new xe,this._blurTexture2=new xe,this._depthTex=e.depthTexture,this._normalTex=e.normalTexture,this.setNoiseSize(4),this.setKernelSize(e.kernelSize||12),e.radius!=null&&this.setParameter("radius",e.radius),e.power!=null&&this.setParameter("power",e.power),this._normalTex||(this._ssaoPass.material.disableTexture("normalTex"),this._blurPass.material.disableTexture("normalTex")),this._depthTex||this._blurPass.material.disableTexture("depthTex"),this._blurPass.material.setUniform("normalTex",this._normalTex),this._blurPass.material.setUniform("depthTex",this._depthTex)}Ho.prototype.setDepthTexture=function(e){this._depthTex=e};Ho.prototype.setNormalTexture=function(e){this._normalTex=e,this._ssaoPass.material[e?"enableTexture":"disableTexture"]("normalTex"),this.setKernelSize(this._kernelSize)};Ho.prototype.update=function(e,t,r){var n=e.getWidth(),i=e.getHeight(),a=this._ssaoPass,o=this._blurPass;a.setUniform("kernel",this._kernels[r%this._kernels.length]),a.setUniform("depthTex",this._depthTex),this._normalTex!=null&&a.setUniform("normalTex",this._normalTex),a.setUniform("depthTexSize",[this._depthTex.width,this._depthTex.height]);var s=new Nt;Nt.transpose(s,t.worldTransform),a.setUniform("projection",t.projectionMatrix.array),a.setUniform("projectionInv",t.invProjectionMatrix.array),a.setUniform("viewInverseTranspose",s.array);var l=this._ssaoTexture,u=this._blurTexture,h=this._blurTexture2;l.width=n/2,l.height=i/2,u.width=n,u.height=i,h.width=n,h.height=i,this._framebuffer.attach(l),this._framebuffer.bind(e),e.gl.clearColor(1,1,1,1),e.gl.clear(e.gl.COLOR_BUFFER_BIT),a.render(e),o.setUniform("textureSize",[n/2,i/2]),o.setUniform("projection",t.projectionMatrix.array),this._framebuffer.attach(u),o.setUniform("direction",0),o.setUniform("ssaoTexture",l),o.render(e),this._framebuffer.attach(h),o.setUniform("textureSize",[n,i]),o.setUniform("direction",1),o.setUniform("ssaoTexture",u),o.render(e),this._framebuffer.unbind(e);var f=e.clearColor;e.gl.clearColor(f[0],f[1],f[2],f[3])};Ho.prototype.getTargetTexture=function(){return this._blurTexture2};Ho.prototype.setParameter=function(e,t){e==="noiseTexSize"?this.setNoiseSize(t):e==="kernelSize"?this.setKernelSize(t):e==="intensity"?this._ssaoPass.material.set("intensity",t):this._ssaoPass.setUniform(e,t)};Ho.prototype.setKernelSize=function(e){this._kernelSize=e,this._ssaoPass.material.define("fragment","KERNEL_SIZE",e),this._kernels=this._kernels||[];for(var t=0;t<30;t++)this._kernels[t]=Tot(e,t*e,!!this._normalTex)};Ho.prototype.setNoiseSize=function(e){var t=this._ssaoPass.getUniform("noiseTex");t?(t.data=iG(e),t.width=t.height=e,t.dirty()):(t=TI(e),this._ssaoPass.setUniform("noiseTex",TI(e))),this._ssaoPass.setUniform("noiseTexSize",[e,e])};Ho.prototype.dispose=function(e){this._blurTexture.dispose(e),this._ssaoTexture.dispose(e),this._blurTexture2.dispose(e)};const bot=`@export ecgl.ssr.main

#define SHADER_NAME SSR
#define MAX_ITERATION 20;
#define SAMPLE_PER_FRAME 5;
#define TOTAL_SAMPLES 128;

uniform sampler2D sourceTexture;
uniform sampler2D gBufferTexture1;
uniform sampler2D gBufferTexture2;
uniform sampler2D gBufferTexture3;
uniform samplerCube specularCubemap;
uniform float specularIntensity: 1;

uniform mat4 projection;
uniform mat4 projectionInv;
uniform mat4 toViewSpace;
uniform mat4 toWorldSpace;

uniform float maxRayDistance: 200;

uniform float pixelStride: 16;
uniform float pixelStrideZCutoff: 50; 
uniform float screenEdgeFadeStart: 0.9; 
uniform float eyeFadeStart : 0.2; uniform float eyeFadeEnd: 0.8; 
uniform float minGlossiness: 0.2; uniform float zThicknessThreshold: 1;

uniform float nearZ;
uniform vec2 viewportSize : VIEWPORT_SIZE;

uniform float jitterOffset: 0;

varying vec2 v_Texcoord;

#ifdef DEPTH_DECODE
@import clay.util.decode_float
#endif

#ifdef PHYSICALLY_CORRECT
uniform sampler2D normalDistribution;
uniform float sampleOffset: 0;
uniform vec2 normalDistributionSize;

vec3 transformNormal(vec3 H, vec3 N) {
 vec3 upVector = N.y > 0.999 ? vec3(1.0, 0.0, 0.0) : vec3(0.0, 1.0, 0.0);
 vec3 tangentX = normalize(cross(N, upVector));
 vec3 tangentZ = cross(N, tangentX);
 return normalize(tangentX * H.x + N * H.y + tangentZ * H.z);
}
vec3 importanceSampleNormalGGX(float i, float roughness, vec3 N) {
 float p = fract((i + sampleOffset) / float(TOTAL_SAMPLES));
 vec3 H = texture2D(normalDistribution,vec2(roughness, p)).rgb;
 return transformNormal(H, N);
}
float G_Smith(float g, float ndv, float ndl) {
 float roughness = 1.0 - g;
 float k = roughness * roughness / 2.0;
 float G1V = ndv / (ndv * (1.0 - k) + k);
 float G1L = ndl / (ndl * (1.0 - k) + k);
 return G1L * G1V;
}
vec3 F_Schlick(float ndv, vec3 spec) {
 return spec + (1.0 - spec) * pow(1.0 - ndv, 5.0);
}
#endif

float fetchDepth(sampler2D depthTexture, vec2 uv)
{
 vec4 depthTexel = texture2D(depthTexture, uv);
 return depthTexel.r * 2.0 - 1.0;
}

float linearDepth(float depth)
{
 if (projection[3][3] == 0.0) {
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
 }
 else {
 return (depth - projection[3][2]) / projection[2][2];
 }
}

bool rayIntersectDepth(float rayZNear, float rayZFar, vec2 hitPixel)
{
 if (rayZFar > rayZNear)
 {
 float t = rayZFar; rayZFar = rayZNear; rayZNear = t;
 }
 float cameraZ = linearDepth(fetchDepth(gBufferTexture2, hitPixel));
 return rayZFar <= cameraZ && rayZNear >= cameraZ - zThicknessThreshold;
}


bool traceScreenSpaceRay(
 vec3 rayOrigin, vec3 rayDir, float jitter,
 out vec2 hitPixel, out vec3 hitPoint, out float iterationCount
)
{
 float rayLength = ((rayOrigin.z + rayDir.z * maxRayDistance) > -nearZ)
 ? (-nearZ - rayOrigin.z) / rayDir.z : maxRayDistance;

 vec3 rayEnd = rayOrigin + rayDir * rayLength;

 vec4 H0 = projection * vec4(rayOrigin, 1.0);
 vec4 H1 = projection * vec4(rayEnd, 1.0);

 float k0 = 1.0 / H0.w, k1 = 1.0 / H1.w;

 vec3 Q0 = rayOrigin * k0, Q1 = rayEnd * k1;

 vec2 P0 = (H0.xy * k0 * 0.5 + 0.5) * viewportSize;
 vec2 P1 = (H1.xy * k1 * 0.5 + 0.5) * viewportSize;

 P1 += dot(P1 - P0, P1 - P0) < 0.0001 ? 0.01 : 0.0;
 vec2 delta = P1 - P0;

 bool permute = false;
 if (abs(delta.x) < abs(delta.y)) {
 permute = true;
 delta = delta.yx;
 P0 = P0.yx;
 P1 = P1.yx;
 }
 float stepDir = sign(delta.x);
 float invdx = stepDir / delta.x;

 vec3 dQ = (Q1 - Q0) * invdx;
 float dk = (k1 - k0) * invdx;

 vec2 dP = vec2(stepDir, delta.y * invdx);

 float strideScaler = 1.0 - min(1.0, -rayOrigin.z / pixelStrideZCutoff);
 float pixStride = 1.0 + strideScaler * pixelStride;

 dP *= pixStride; dQ *= pixStride; dk *= pixStride;

 vec4 pqk = vec4(P0, Q0.z, k0);
 vec4 dPQK = vec4(dP, dQ.z, dk);

 pqk += dPQK * jitter;
 float rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);
 float rayZNear;

 bool intersect = false;

 vec2 texelSize = 1.0 / viewportSize;

 iterationCount = 0.0;

 for (int i = 0; i < MAX_ITERATION; i++)
 {
 pqk += dPQK;

 rayZNear = rayZFar;
 rayZFar = (dPQK.z * 0.5 + pqk.z) / (dPQK.w * 0.5 + pqk.w);

 hitPixel = permute ? pqk.yx : pqk.xy;
 hitPixel *= texelSize;

 intersect = rayIntersectDepth(rayZNear, rayZFar, hitPixel);

 iterationCount += 1.0;

 dPQK *= 1.2;

 if (intersect) {
 break;
 }
 }

 Q0.xy += dQ.xy * iterationCount;
 Q0.z = pqk.z;
 hitPoint = Q0 / pqk.w;

 return intersect;
}

float calculateAlpha(
 float iterationCount, float reflectivity,
 vec2 hitPixel, vec3 hitPoint, float dist, vec3 rayDir
)
{
 float alpha = clamp(reflectivity, 0.0, 1.0);
 alpha *= 1.0 - (iterationCount / float(MAX_ITERATION));
 vec2 hitPixelNDC = hitPixel * 2.0 - 1.0;
 float maxDimension = min(1.0, max(abs(hitPixelNDC.x), abs(hitPixelNDC.y)));
 alpha *= 1.0 - max(0.0, maxDimension - screenEdgeFadeStart) / (1.0 - screenEdgeFadeStart);

 float _eyeFadeStart = eyeFadeStart;
 float _eyeFadeEnd = eyeFadeEnd;
 if (_eyeFadeStart > _eyeFadeEnd) {
 float tmp = _eyeFadeEnd;
 _eyeFadeEnd = _eyeFadeStart;
 _eyeFadeStart = tmp;
 }

 float eyeDir = clamp(rayDir.z, _eyeFadeStart, _eyeFadeEnd);
 alpha *= 1.0 - (eyeDir - _eyeFadeStart) / (_eyeFadeEnd - _eyeFadeStart);

 alpha *= 1.0 - clamp(dist / maxRayDistance, 0.0, 1.0);

 return alpha;
}

@import clay.util.rand

@import clay.util.rgbm

void main()
{
 vec4 normalAndGloss = texture2D(gBufferTexture1, v_Texcoord);

 if (dot(normalAndGloss.rgb, vec3(1.0)) == 0.0) {
 discard;
 }

 float g = normalAndGloss.a;
#if !defined(PHYSICALLY_CORRECT)
 if (g <= minGlossiness) {
 discard;
 }
#endif

 float reflectivity = (g - minGlossiness) / (1.0 - minGlossiness);

 vec3 N = normalize(normalAndGloss.rgb * 2.0 - 1.0);
 N = normalize((toViewSpace * vec4(N, 0.0)).xyz);

 vec4 projectedPos = vec4(v_Texcoord * 2.0 - 1.0, fetchDepth(gBufferTexture2, v_Texcoord), 1.0);
 vec4 pos = projectionInv * projectedPos;
 vec3 rayOrigin = pos.xyz / pos.w;
 vec3 V = -normalize(rayOrigin);

 float ndv = clamp(dot(N, V), 0.0, 1.0);
 float iterationCount;
 float jitter = rand(fract(v_Texcoord + jitterOffset));

#ifdef PHYSICALLY_CORRECT
 vec4 color = vec4(vec3(0.0), 1.0);
 vec4 albedoMetalness = texture2D(gBufferTexture3, v_Texcoord);
 vec3 albedo = albedoMetalness.rgb;
 float m = albedoMetalness.a;
 vec3 diffuseColor = albedo * (1.0 - m);
 vec3 spec = mix(vec3(0.04), albedo, m);

 float jitter2 = rand(fract(v_Texcoord)) * float(TOTAL_SAMPLES);

 for (int i = 0; i < SAMPLE_PER_FRAME; i++) {
 vec3 H = importanceSampleNormalGGX(float(i) + jitter2, 1.0 - g, N);
 vec3 rayDir = normalize(reflect(-V, H));
#else
 vec3 rayDir = normalize(reflect(-V, N));
#endif
 vec2 hitPixel;
 vec3 hitPoint;

 bool intersect = traceScreenSpaceRay(rayOrigin, rayDir, jitter, hitPixel, hitPoint, iterationCount);

 float dist = distance(rayOrigin, hitPoint);

 vec3 hitNormal = texture2D(gBufferTexture1, hitPixel).rgb * 2.0 - 1.0;
 hitNormal = normalize((toViewSpace * vec4(hitNormal, 0.0)).xyz);
#ifdef PHYSICALLY_CORRECT
 float ndl = clamp(dot(N, rayDir), 0.0, 1.0);
 float vdh = clamp(dot(V, H), 0.0, 1.0);
 float ndh = clamp(dot(N, H), 0.0, 1.0);
 vec3 litTexel = vec3(0.0);
 if (dot(hitNormal, rayDir) < 0.0 && intersect) {
 litTexel = texture2D(sourceTexture, hitPixel).rgb;
 litTexel *= pow(clamp(1.0 - dist / 200.0, 0.0, 1.0), 3.0);

 }
 else {
 #ifdef SPECULARCUBEMAP_ENABLED
 vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;
 litTexel = RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, 0.0), 8.12).rgb * specularIntensity;
#endif
 }
 color.rgb += ndl * litTexel * (
 F_Schlick(ndl, spec) * G_Smith(g, ndv, ndl) * vdh / (ndh * ndv + 0.001)
 );
 }
 color.rgb /= float(SAMPLE_PER_FRAME);
#else
 #if !defined(SPECULARCUBEMAP_ENABLED)
 if (dot(hitNormal, rayDir) >= 0.0) {
 discard;
 }
 if (!intersect) {
 discard;
 }
#endif
 float alpha = clamp(calculateAlpha(iterationCount, reflectivity, hitPixel, hitPoint, dist, rayDir), 0.0, 1.0);
 vec4 color = texture2D(sourceTexture, hitPixel);
 color.rgb *= alpha;

#ifdef SPECULARCUBEMAP_ENABLED
 vec3 rayDirW = normalize(toWorldSpace * vec4(rayDir, 0.0)).rgb;
 alpha = alpha * (intersect ? 1.0 : 0.0);
 float bias = (1.0 -g) * 5.0;
 color.rgb += (1.0 - alpha)
 * RGBMDecode(textureCubeLodEXT(specularCubemap, rayDirW, bias), 8.12).rgb
 * specularIntensity;
#endif

#endif

 gl_FragColor = encodeHDR(color);
}
@end

@export ecgl.ssr.blur

uniform sampler2D texture;
uniform sampler2D gBufferTexture1;
uniform sampler2D gBufferTexture2;
uniform mat4 projection;
uniform float depthRange : 0.05;

varying vec2 v_Texcoord;

uniform vec2 textureSize;
uniform float blurSize : 1.0;

#ifdef BLEND
 #ifdef SSAOTEX_ENABLED
uniform sampler2D ssaoTex;
 #endif
uniform sampler2D sourceTexture;
#endif

float getLinearDepth(vec2 coord)
{
 float depth = texture2D(gBufferTexture2, coord).r * 2.0 - 1.0;
 return projection[3][2] / (depth * projection[2][3] - projection[2][2]);
}

@import clay.util.rgbm


void main()
{
 @import clay.compositor.kernel.gaussian_9

 vec4 centerNTexel = texture2D(gBufferTexture1, v_Texcoord);
 float g = centerNTexel.a;
 float maxBlurSize = clamp(1.0 - g, 0.0, 1.0) * blurSize;
#ifdef VERTICAL
 vec2 off = vec2(0.0, maxBlurSize / textureSize.y);
#else
 vec2 off = vec2(maxBlurSize / textureSize.x, 0.0);
#endif

 vec2 coord = v_Texcoord;

 vec4 sum = vec4(0.0);
 float weightAll = 0.0;

 vec3 cN = centerNTexel.rgb * 2.0 - 1.0;
 float cD = getLinearDepth(v_Texcoord);
 for (int i = 0; i < 9; i++) {
 vec2 coord = clamp((float(i) - 4.0) * off + v_Texcoord, vec2(0.0), vec2(1.0));
 float w = gaussianKernel[i]
 * clamp(dot(cN, texture2D(gBufferTexture1, coord).rgb * 2.0 - 1.0), 0.0, 1.0);
 float d = getLinearDepth(coord);
 w *= (1.0 - smoothstep(abs(cD - d) / depthRange, 0.0, 1.0));

 weightAll += w;
 sum += decodeHDR(texture2D(texture, coord)) * w;
 }

#ifdef BLEND
 float aoFactor = 1.0;
 #ifdef SSAOTEX_ENABLED
 aoFactor = texture2D(ssaoTex, v_Texcoord).r;
 #endif
 gl_FragColor = encodeHDR(
 sum / weightAll * aoFactor + decodeHDR(texture2D(sourceTexture, v_Texcoord))
 );
#else
 gl_FragColor = encodeHDR(sum / weightAll);
#endif
}

@end`;Et.import(bot);function Wo(e){e=e||{},this._ssrPass=new kr({fragment:Et.source("ecgl.ssr.main"),clearColor:[0,0,0,0]}),this._blurPass1=new kr({fragment:Et.source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blurPass2=new kr({fragment:Et.source("ecgl.ssr.blur"),clearColor:[0,0,0,0]}),this._blendPass=new kr({fragment:Et.source("clay.compositor.blend")}),this._blendPass.material.disableTexturesAll(),this._blendPass.material.enableTexture(["texture1","texture2"]),this._ssrPass.setUniform("gBufferTexture1",e.normalTexture),this._ssrPass.setUniform("gBufferTexture2",e.depthTexture),this._blurPass1.setUniform("gBufferTexture1",e.normalTexture),this._blurPass1.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.setUniform("gBufferTexture1",e.normalTexture),this._blurPass2.setUniform("gBufferTexture2",e.depthTexture),this._blurPass2.material.define("fragment","VERTICAL"),this._blurPass2.material.define("fragment","BLEND"),this._ssrTexture=new xe({type:Mt.HALF_FLOAT}),this._texture2=new xe({type:Mt.HALF_FLOAT}),this._texture3=new xe({type:Mt.HALF_FLOAT}),this._prevTexture=new xe({type:Mt.HALF_FLOAT}),this._currentTexture=new xe({type:Mt.HALF_FLOAT}),this._frameBuffer=new Ir({depthBuffer:!1}),this._normalDistribution=null,this._totalSamples=256,this._samplePerFrame=4,this._ssrPass.material.define("fragment","SAMPLE_PER_FRAME",this._samplePerFrame),this._ssrPass.material.define("fragment","TOTAL_SAMPLES",this._totalSamples),this._downScale=1}Wo.prototype.setAmbientCubemap=function(e,t){this._ssrPass.material.set("specularCubemap",e),this._ssrPass.material.set("specularIntensity",t);var r=e&&t;this._ssrPass.material[r?"enableTexture":"disableTexture"]("specularCubemap")};Wo.prototype.update=function(e,t,r,n){var i=e.getWidth(),a=e.getHeight(),o=this._ssrTexture,s=this._texture2,l=this._texture3;o.width=this._prevTexture.width=this._currentTexture.width=i/this._downScale,o.height=this._prevTexture.height=this._currentTexture.height=a/this._downScale,s.width=l.width=i,s.height=l.height=a;var u=this._frameBuffer,h=this._ssrPass,f=this._blurPass1,c=this._blurPass2,d=this._blendPass,v=new Nt,p=new Nt;Nt.transpose(v,t.worldTransform),Nt.transpose(p,t.viewMatrix),h.setUniform("sourceTexture",r),h.setUniform("projection",t.projectionMatrix.array),h.setUniform("projectionInv",t.invProjectionMatrix.array),h.setUniform("toViewSpace",v.array),h.setUniform("toWorldSpace",p.array),h.setUniform("nearZ",t.near);var g=n/this._totalSamples*this._samplePerFrame;if(h.setUniform("jitterOffset",g),h.setUniform("sampleOffset",n*this._samplePerFrame),f.setUniform("textureSize",[o.width,o.height]),c.setUniform("textureSize",[i,a]),c.setUniform("sourceTexture",r),f.setUniform("projection",t.projectionMatrix.array),c.setUniform("projection",t.projectionMatrix.array),u.attach(o),u.bind(e),h.render(e),this._physicallyCorrect&&(u.attach(this._currentTexture),d.setUniform("texture1",this._prevTexture),d.setUniform("texture2",o),d.material.set({weight1:n>=1?.95:0,weight2:n>=1?.05:1}),d.render(e)),u.attach(s),f.setUniform("texture",this._physicallyCorrect?this._currentTexture:o),f.render(e),u.attach(l),c.setUniform("texture",s),c.render(e),u.unbind(e),this._physicallyCorrect){var m=this._prevTexture;this._prevTexture=this._currentTexture,this._currentTexture=m}};Wo.prototype.getTargetTexture=function(){return this._texture3};Wo.prototype.setParameter=function(e,t){e==="maxIteration"?this._ssrPass.material.define("fragment","MAX_ITERATION",t):this._ssrPass.setUniform(e,t)};Wo.prototype.setPhysicallyCorrect=function(e){e?(this._normalDistribution||(this._normalDistribution=Ya.generateNormalDistribution(64,this._totalSamples)),this._ssrPass.material.define("fragment","PHYSICALLY_CORRECT"),this._ssrPass.material.set("normalDistribution",this._normalDistribution),this._ssrPass.material.set("normalDistributionSize",[64,this._totalSamples])):this._ssrPass.material.undefine("fragment","PHYSICALLY_CORRECT"),this._physicallyCorrect=e};Wo.prototype.setSSAOTexture=function(e){var t=this._blurPass2;e?(t.material.enableTexture("ssaoTex"),t.material.set("ssaoTex",e)):t.material.disableTexture("ssaoTex")};Wo.prototype.isFinished=function(e){return this._physicallyCorrect?e>this._totalSamples/this._samplePerFrame:!0};Wo.prototype.dispose=function(e){this._ssrTexture.dispose(e),this._texture2.dispose(e),this._texture3.dispose(e),this._prevTexture.dispose(e),this._currentTexture.dispose(e),this._frameBuffer.dispose(e)};const bI=[0,0,-.321585265978,-.154972575841,.458126042375,.188473391593,.842080129861,.527766490688,.147304551086,-.659453822776,-.331943915203,-.940619700594,.0479226680259,.54812163202,.701581552186,-.709825561388,-.295436780218,.940589268233,-.901489676764,.237713156085,.973570876096,-.109899459384,-.866792314779,-.451805525005,.330975007087,.800048655954,-.344275183665,.381779221166,-.386139432542,-.437418421534,-.576478634965,-.0148463392551,.385798197415,-.262426961053,-.666302061145,.682427250835,-.628010632582,-.732836215494,.10163141741,-.987658134403,.711995289051,-.320024291314,.0296005138058,.950296523438,.0130612307608,-.351024443122,-.879596633704,-.10478487883,.435712737232,.504254490347,.779203817497,.206477676721,.388264289969,-.896736162545,-.153106280781,-.629203242522,-.245517550697,.657969239148,.126830499058,.26862328493,-.634888119007,-.302301223431,.617074219636,.779817204925],wot=`@export ecgl.normal.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

@import ecgl.common.normalMap.vertexHeader

@import ecgl.common.vertexAnimation.header

void main()
{

 @import ecgl.common.vertexAnimation.main

 @import ecgl.common.uv.main

 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);
 v_WorldPosition = (world * vec4(pos, 1.0)).xyz;

 @import ecgl.common.normalMap.vertexMain

 gl_Position = worldViewProjection * vec4(pos, 1.0);

}


@end


@export ecgl.normal.fragment

#define ROUGHNESS_CHANEL 0

uniform bool useBumpMap;
uniform bool useRoughnessMap;
uniform bool doubleSide;
uniform float roughness;

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform mat4 viewInverse : VIEWINVERSE;

@import ecgl.common.normalMap.fragmentHeader
@import ecgl.common.bumpMap.header

uniform sampler2D roughnessMap;

void main()
{
 vec3 N = v_Normal;
 
 bool flipNormal = false;
 if (doubleSide) {
 vec3 eyePos = viewInverse[3].xyz;
 vec3 V = normalize(eyePos - v_WorldPosition);

 if (dot(N, V) < 0.0) {
 flipNormal = true;
 }
 }

 @import ecgl.common.normalMap.fragmentMain

 if (useBumpMap) {
 N = bumpNormal(v_WorldPosition, v_Normal, N);
 }

 float g = 1.0 - roughness;

 if (useRoughnessMap) {
 float g2 = 1.0 - texture2D(roughnessMap, v_DetailTexcoord)[ROUGHNESS_CHANEL];
 g = clamp(g2 + (g - 0.5) * 2.0, 0.0, 1.0);
 }

 if (flipNormal) {
 N = -N;
 }

 gl_FragColor.rgb = (N.xyz + 1.0) * 0.5;
 gl_FragColor.a = g;
}
@end`;Et.import(wot);function c1(e,t,r,n,i){var a=e.gl;t.setUniform(a,"1i",r,i),a.activeTexture(a.TEXTURE0+i),n.isRenderable()?n.bind(e):n.unbind(e)}function Mot(e,t,r,n,i){var a,o,s,l,u=e.gl;return function(h,f,c){if(!(l&&l.material===h.material)){var d=h.material,v=h.__program,p=d.get("roughness");p==null&&(p=1);var g=d.get("normalMap")||t,m=d.get("roughnessMap"),_=d.get("bumpMap"),y=d.get("uvRepeat"),x=d.get("uvOffset"),T=d.get("detailUvRepeat"),S=d.get("detailUvOffset"),M=!!_&&d.isTextureEnabled("bumpMap"),w=!!m&&d.isTextureEnabled("roughnessMap"),b=d.isDefined("fragment","DOUBLE_SIDED");_=_||r,m=m||n,c!==f?(f.set("normalMap",g),f.set("bumpMap",_),f.set("roughnessMap",m),f.set("useBumpMap",M),f.set("useRoughnessMap",w),f.set("doubleSide",b),y!=null&&f.set("uvRepeat",y),x!=null&&f.set("uvOffset",x),T!=null&&f.set("detailUvRepeat",T),S!=null&&f.set("detailUvOffset",S),f.set("roughness",p)):(v.setUniform(u,"1f","roughness",p),a!==g&&c1(e,v,"normalMap",g,0),o!==_&&_&&c1(e,v,"bumpMap",_,1),s!==m&&m&&c1(e,v,"roughnessMap",m,2),y!=null&&v.setUniform(u,"2f","uvRepeat",y),x!=null&&v.setUniform(u,"2f","uvOffset",x),T!=null&&v.setUniform(u,"2f","detailUvRepeat",T),S!=null&&v.setUniform(u,"2f","detailUvOffset",S),v.setUniform(u,"1i","useBumpMap",+M),v.setUniform(u,"1i","useRoughnessMap",+w),v.setUniform(u,"1i","doubleSide",+b)),a=g,o=_,s=m,l=h}}}function rc(e){this._depthTex=new xe({format:Mt.DEPTH_COMPONENT,type:Mt.UNSIGNED_INT}),this._normalTex=new xe({type:Mt.HALF_FLOAT}),this._framebuffer=new Ir,this._framebuffer.attach(this._normalTex),this._framebuffer.attach(this._depthTex,Ir.DEPTH_ATTACHMENT),this._normalMaterial=new Vi({shader:new Et(Et.source("ecgl.normal.vertex"),Et.source("ecgl.normal.fragment"))}),this._normalMaterial.enableTexture(["normalMap","bumpMap","roughnessMap"]),this._defaultNormalMap=Xa.createBlank("#000"),this._defaultBumpMap=Xa.createBlank("#000"),this._defaultRoughessMap=Xa.createBlank("#000"),this._debugPass=new kr({fragment:Et.source("clay.compositor.output")}),this._debugPass.setUniform("texture",this._normalTex),this._debugPass.material.undefine("fragment","OUTPUT_ALPHA")}rc.prototype.getDepthTexture=function(){return this._depthTex};rc.prototype.getNormalTexture=function(){return this._normalTex};rc.prototype.update=function(e,t,r){var n=e.getWidth(),i=e.getHeight(),a=this._depthTex,o=this._normalTex,s=this._normalMaterial;a.width=n,a.height=i,o.width=n,o.height=i;var l=t.getRenderList(r).opaque;this._framebuffer.bind(e),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT|e.gl.DEPTH_BUFFER_BIT),e.gl.disable(e.gl.BLEND),e.renderPass(l,r,{getMaterial:function(){return s},ifRender:function(u){return u.renderNormal},beforeRender:Mot(e,this._defaultNormalMap,this._defaultBumpMap,this._defaultRoughessMap,this._normalMaterial),sort:e.opaqueSortCompare}),this._framebuffer.unbind(e)};rc.prototype.renderDebug=function(e){this._debugPass.render(e)};rc.prototype.dispose=function(e){this._depthTex.dispose(e),this._normalTex.dispose(e)};function Gv(e){e=e||{},this._edgePass=new kr({fragment:Et.source("ecgl.edge")}),this._edgePass.setUniform("normalTexture",e.normalTexture),this._edgePass.setUniform("depthTexture",e.depthTexture),this._targetTexture=new xe({type:Mt.HALF_FLOAT}),this._frameBuffer=new Ir,this._frameBuffer.attach(this._targetTexture)}Gv.prototype.update=function(e,t,r,n){var i=e.getWidth(),a=e.getHeight(),o=this._targetTexture;o.width=i,o.height=a;var s=this._frameBuffer;s.bind(e),this._edgePass.setUniform("projectionInv",t.invProjectionMatrix.array),this._edgePass.setUniform("textureSize",[i,a]),this._edgePass.setUniform("texture",r),this._edgePass.render(e),s.unbind(e)};Gv.prototype.getTargetTexture=function(){return this._targetTexture};Gv.prototype.setParameter=function(e,t){this._edgePass.setUniform(e,t)};Gv.prototype.dispose=function(e){this._targetTexture.dispose(e),this._frameBuffer.dispose(e)};const Aot={type:"compositor",nodes:[{name:"source",type:"texture",outputs:{color:{}}},{name:"source_half",shader:"#source(clay.compositor.downsample)",inputs:{texture:"source"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bright",shader:"#source(clay.compositor.bright)",inputs:{texture:"source_half"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{threshold:2,scale:4,textureSize:"expr([width * 1.0 / 2, height / 2])"}},{name:"bright_downsample_4",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 2, height / 2] )"}},{name:"bright_downsample_8",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 4, height / 4] )"}},{name:"bright_downsample_16",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 8, height / 8] )"}},{name:"bright_downsample_32",shader:"#source(clay.compositor.downsample)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 32)",height:"expr(height * 1.0 / 32)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0 / 16, height / 16] )"}},{name:"bright_upsample_16_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_32"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 32, height / 32] )"}},{name:"bright_upsample_16_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_16_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 16)",height:"expr(height * 1.0 / 16)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_16"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 16, height * 1.0 / 16] )"}},{name:"bright_upsample_8_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_8_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_8_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_8_blur_v",texture2:"bright_upsample_16_blur_v"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 8)",height:"expr(height * 1.0 / 8)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_4_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_8"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 8, height * 1.0 / 8] )"}},{name:"bright_upsample_4_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_4_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_4_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_4_blur_v",texture2:"bright_upsample_8_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 4)",height:"expr(height * 1.0 / 4)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_2_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_downsample_4"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 4, height * 1.0 / 4] )"}},{name:"bright_upsample_2_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_2_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_2_blend",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_2_blur_v",texture2:"bright_upsample_4_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0 / 2)",height:"expr(height * 1.0 / 2)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"bright_upsample_full_blur_h",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:0,textureSize:"expr( [width * 1.0 / 2, height * 1.0 / 2] )"}},{name:"bright_upsample_full_blur_v",shader:"#source(clay.compositor.gaussian_blur)",inputs:{texture:"bright_upsample_full_blur_h"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{blurSize:1,blurDir:1,textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"bloom_composite",shader:"#source(clay.compositor.blend)",inputs:{texture1:"bright_upsample_full_blur_v",texture2:"bright_upsample_2_blend"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{weight1:.3,weight2:.7}},{name:"coc",shader:"#source(ecgl.dof.coc)",outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{focalDist:50,focalRange:30}},{name:"dof_far_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"}},{name:"dof_near_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"source",coc:"coc"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_NEARFIELD:null}},{name:"dof_coc_blur",shader:"#source(ecgl.dof.diskBlur)",inputs:{texture:"coc"},outputs:{color:{parameters:{minFilter:"NEAREST",magFilter:"NEAREST",width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},parameters:{textureSize:"expr( [width * 1.0, height * 1.0] )"},defines:{BLUR_COC:null}},{name:"dof_composite",shader:"#source(ecgl.dof.composite)",inputs:{original:"source",blurred:"dof_far_blur",nearfield:"dof_near_blur",coc:"coc",nearcoc:"dof_coc_blur"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)",type:"HALF_FLOAT"}}}},{name:"composite",shader:"#source(clay.compositor.hdr.composite)",inputs:{texture:"source",bloom:"bloom_composite"},outputs:{color:{parameters:{width:"expr(width * 1.0)",height:"expr(height * 1.0)"}}},defines:{}},{name:"FXAA",shader:"#source(clay.compositor.fxaa)",inputs:{texture:"composite"}}]},Eot=`@export ecgl.dof.coc

uniform sampler2D depth;

uniform float zNear: 0.1;
uniform float zFar: 2000;

uniform float focalDistance: 3;
uniform float focalRange: 1;
uniform float focalLength: 30;
uniform float fstop: 2.8;

varying vec2 v_Texcoord;

@import clay.util.encode_float

void main()
{
 float z = texture2D(depth, v_Texcoord).r * 2.0 - 1.0;

 float dist = 2.0 * zNear * zFar / (zFar + zNear - z * (zFar - zNear));

 float aperture = focalLength / fstop;

 float coc;

 float uppper = focalDistance + focalRange;
 float lower = focalDistance - focalRange;
 if (dist <= uppper && dist >= lower) {
 coc = 0.5;
 }
 else {
 float focalAdjusted = dist > uppper ? uppper : lower;

 coc = abs(aperture * (focalLength * (dist - focalAdjusted)) / (dist * (focalAdjusted - focalLength)));
 coc = clamp(coc, 0.0, 2.0) / 2.00001;

 if (dist < lower) {
 coc = -coc;
 }
 coc = coc * 0.5 + 0.5;
 }

 gl_FragColor = encodeFloat(coc);
}
@end


@export ecgl.dof.composite

#define DEBUG 0

uniform sampler2D original;
uniform sampler2D blurred;
uniform sampler2D nearfield;
uniform sampler2D coc;
uniform sampler2D nearcoc;
varying vec2 v_Texcoord;

@import clay.util.rgbm
@import clay.util.float

void main()
{
 vec4 blurredColor = texture2D(blurred, v_Texcoord);
 vec4 originalColor = texture2D(original, v_Texcoord);

 float fCoc = decodeFloat(texture2D(coc, v_Texcoord));

 fCoc = abs(fCoc * 2.0 - 1.0);

 float weight = smoothstep(0.0, 1.0, fCoc);
 
#ifdef NEARFIELD_ENABLED
 vec4 nearfieldColor = texture2D(nearfield, v_Texcoord);
 float fNearCoc = decodeFloat(texture2D(nearcoc, v_Texcoord));
 fNearCoc = abs(fNearCoc * 2.0 - 1.0);

 gl_FragColor = encodeHDR(
 mix(
 nearfieldColor, mix(originalColor, blurredColor, weight),
 pow(1.0 - fNearCoc, 4.0)
 )
 );
#else
 gl_FragColor = encodeHDR(mix(originalColor, blurredColor, weight));
#endif

}

@end



@export ecgl.dof.diskBlur

#define POISSON_KERNEL_SIZE 16;

uniform sampler2D texture;
uniform sampler2D coc;
varying vec2 v_Texcoord;

uniform float blurRadius : 10.0;
uniform vec2 textureSize : [512.0, 512.0];

uniform vec2 poissonKernel[POISSON_KERNEL_SIZE];

uniform float percent;

float nrand(const in vec2 n) {
 return fract(sin(dot(n.xy ,vec2(12.9898,78.233))) * 43758.5453);
}

@import clay.util.rgbm
@import clay.util.float


void main()
{
 vec2 offset = blurRadius / textureSize;

 float rnd = 6.28318 * nrand(v_Texcoord + 0.07 * percent );
 float cosa = cos(rnd);
 float sina = sin(rnd);
 vec4 basis = vec4(cosa, -sina, sina, cosa);

#if !defined(BLUR_NEARFIELD) && !defined(BLUR_COC)
 offset *= abs(decodeFloat(texture2D(coc, v_Texcoord)) * 2.0 - 1.0);
#endif

#ifdef BLUR_COC
 float cocSum = 0.0;
#else
 vec4 color = vec4(0.0);
#endif


 float weightSum = 0.0;

 for (int i = 0; i < POISSON_KERNEL_SIZE; i++) {
 vec2 ofs = poissonKernel[i];

 ofs = vec2(dot(ofs, basis.xy), dot(ofs, basis.zw));

 vec2 uv = v_Texcoord + ofs * offset;
 vec4 texel = texture2D(texture, uv);

 float w = 1.0;
#ifdef BLUR_COC
 float fCoc = decodeFloat(texel) * 2.0 - 1.0;
 cocSum += clamp(fCoc, -1.0, 0.0) * w;
#else
 texel = texel;
 #if !defined(BLUR_NEARFIELD)
 float fCoc = decodeFloat(texture2D(coc, uv)) * 2.0 - 1.0;
 w *= abs(fCoc);
 #endif
 texel.rgb *= texel.a;
 color += texel * w;
#endif

 weightSum += w;
 }

#ifdef BLUR_COC
 gl_FragColor = encodeFloat(clamp(cocSum / weightSum, -1.0, 0.0) * 0.5 + 0.5);
#else
 color /= weightSum;
 color.rgb /= (color.a + 0.0001);
 gl_FragColor = color;
#endif
}

@end`,Cot=`@export ecgl.edge

uniform sampler2D texture;

uniform sampler2D normalTexture;
uniform sampler2D depthTexture;

uniform mat4 projectionInv;

uniform vec2 textureSize;

uniform vec4 edgeColor: [0,0,0,0.8];

varying vec2 v_Texcoord;

vec3 packColor(vec2 coord) {
 float z = texture2D(depthTexture, coord).r * 2.0 - 1.0;
 vec4 p = vec4(v_Texcoord * 2.0 - 1.0, z, 1.0);
 vec4 p4 = projectionInv * p;

 return vec3(
 texture2D(normalTexture, coord).rg,
 -p4.z / p4.w / 5.0
 );
}

void main() {
 vec2 cc = v_Texcoord;
 vec3 center = packColor(cc);

 float size = clamp(1.0 - (center.z - 10.0) / 100.0, 0.0, 1.0) * 0.5;
 float dx = size / textureSize.x;
 float dy = size / textureSize.y;

 vec2 coord;
 vec3 topLeft = packColor(cc+vec2(-dx, -dy));
 vec3 top = packColor(cc+vec2(0.0, -dy));
 vec3 topRight = packColor(cc+vec2(dx, -dy));
 vec3 left = packColor(cc+vec2(-dx, 0.0));
 vec3 right = packColor(cc+vec2(dx, 0.0));
 vec3 bottomLeft = packColor(cc+vec2(-dx, dy));
 vec3 bottom = packColor(cc+vec2(0.0, dy));
 vec3 bottomRight = packColor(cc+vec2(dx, dy));

 vec3 v = -topLeft-2.0*top-topRight+bottomLeft+2.0*bottom+bottomRight;
 vec3 h = -bottomLeft-2.0*left-topLeft+bottomRight+2.0*right+topRight;

 float edge = sqrt(dot(h, h) + dot(v, v));

 edge = smoothstep(0.8, 1.0, edge);

 gl_FragColor = mix(texture2D(texture, v_Texcoord), vec4(edgeColor.rgb, 1.0), edgeColor.a * edge);
}
@end`;Et.import(qk);Et.import($k);Et.import(Kk);Et.import(jk);Et.import(Jk);Et.import(Qk);Et.import(tG);Et.import(eG);Et.import(rG);Et.import(Eot);Et.import(Cot);function aG(e,t){return{color:{parameters:{width:e,height:t}}}}var lA=["composite","FXAA"];function ze(){this._width,this._height,this._dpr,this._sourceTexture=new xe({type:Mt.HALF_FLOAT}),this._depthTexture=new xe({format:Mt.DEPTH_COMPONENT,type:Mt.UNSIGNED_INT}),this._framebuffer=new Ir,this._framebuffer.attach(this._sourceTexture),this._framebuffer.attach(this._depthTexture,Ir.DEPTH_ATTACHMENT),this._normalPass=new rc,this._compositor=vot(Aot);var e=this._compositor.getNodeByName("source");e.texture=this._sourceTexture;var t=this._compositor.getNodeByName("coc");this._sourceNode=e,this._cocNode=t,this._compositeNode=this._compositor.getNodeByName("composite"),this._fxaaNode=this._compositor.getNodeByName("FXAA"),this._dofBlurNodes=["dof_far_blur","dof_near_blur","dof_coc_blur"].map(function(n){return this._compositor.getNodeByName(n)},this),this._dofBlurKernel=0,this._dofBlurKernelSize=new Float32Array(0),this._finalNodesChain=lA.map(function(n){return this._compositor.getNodeByName(n)},this);var r={normalTexture:this._normalPass.getNormalTexture(),depthTexture:this._normalPass.getDepthTexture()};this._ssaoPass=new Ho(r),this._ssrPass=new Wo(r),this._edgePass=new Gv(r)}ze.prototype.resize=function(n,i,r){r=r||1;var n=n*r,i=i*r,a=this._sourceTexture,o=this._depthTexture;a.width=n,a.height=i,o.width=n,o.height=i;var s={getWidth:function(){return n},getHeight:function(){return i},getDevicePixelRatio:function(){return r}};function l(u,h){if(typeof u[h]=="function"){var f=u[h].__original||u[h];u[h]=function(c){return f.call(this,s)},u[h].__original=f}}this._compositor.nodes.forEach(function(u){for(var h in u.outputs){var f=u.outputs[h].parameters;f&&(l(f,"width"),l(f,"height"))}for(var c in u.parameters)l(u.parameters,c)}),this._width=n,this._height=i,this._dpr=r};ze.prototype.getWidth=function(){return this._width};ze.prototype.getHeight=function(){return this._height};ze.prototype._ifRenderNormalPass=function(){return this._enableSSAO||this._enableEdge||this._enableSSR};ze.prototype._getPrevNode=function(e){for(var t=lA.indexOf(e.name)-1,r=this._finalNodesChain[t];r&&!this._compositor.getNodeByName(r.name);)t-=1,r=this._finalNodesChain[t];return r};ze.prototype._getNextNode=function(e){for(var t=lA.indexOf(e.name)+1,r=this._finalNodesChain[t];r&&!this._compositor.getNodeByName(r.name);)t+=1,r=this._finalNodesChain[t];return r};ze.prototype._addChainNode=function(e){var t=this._getPrevNode(e),r=this._getNextNode(e);t&&(e.inputs.texture=t.name,r?(e.outputs=aG(this.getWidth.bind(this),this.getHeight.bind(this)),r.inputs.texture=e.name):e.outputs=null,this._compositor.addNode(e))};ze.prototype._removeChainNode=function(e){var t=this._getPrevNode(e),r=this._getNextNode(e);t&&(r?(t.outputs=aG(this.getWidth.bind(this),this.getHeight.bind(this)),r.inputs.texture=t.name):t.outputs=null,this._compositor.removeNode(e))};ze.prototype.updateNormal=function(e,t,r,n){this._ifRenderNormalPass()&&this._normalPass.update(e,t,r)};ze.prototype.updateSSAO=function(e,t,r,n){this._ssaoPass.update(e,r,n)};ze.prototype.enableSSAO=function(){this._enableSSAO=!0};ze.prototype.disableSSAO=function(){this._enableSSAO=!1};ze.prototype.enableSSR=function(){this._enableSSR=!0};ze.prototype.disableSSR=function(){this._enableSSR=!1};ze.prototype.getSSAOTexture=function(){return this._ssaoPass.getTargetTexture()};ze.prototype.getSourceFrameBuffer=function(){return this._framebuffer};ze.prototype.getSourceTexture=function(){return this._sourceTexture};ze.prototype.disableFXAA=function(){this._removeChainNode(this._fxaaNode)};ze.prototype.enableFXAA=function(){this._addChainNode(this._fxaaNode)};ze.prototype.enableBloom=function(){this._compositeNode.inputs.bloom="bloom_composite",this._compositor.dirty()};ze.prototype.disableBloom=function(){this._compositeNode.inputs.bloom=null,this._compositor.dirty()};ze.prototype.enableDOF=function(){this._compositeNode.inputs.texture="dof_composite",this._compositor.dirty()};ze.prototype.disableDOF=function(){this._compositeNode.inputs.texture="source",this._compositor.dirty()};ze.prototype.enableColorCorrection=function(){this._compositeNode.define("COLOR_CORRECTION"),this._enableColorCorrection=!0};ze.prototype.disableColorCorrection=function(){this._compositeNode.undefine("COLOR_CORRECTION"),this._enableColorCorrection=!1};ze.prototype.enableEdge=function(){this._enableEdge=!0};ze.prototype.disableEdge=function(){this._enableEdge=!1};ze.prototype.setBloomIntensity=function(e){this._compositeNode.setParameter("bloomIntensity",e)};ze.prototype.setSSAOParameter=function(e,t){switch(e){case"quality":var r={low:6,medium:12,high:32,ultra:62}[t]||12;this._ssaoPass.setParameter("kernelSize",r);break;case"radius":this._ssaoPass.setParameter(e,t),this._ssaoPass.setParameter("bias",t/200);break;case"intensity":this._ssaoPass.setParameter(e,t);break}};ze.prototype.setDOFParameter=function(e,t){switch(e){case"focalDistance":case"focalRange":case"fstop":this._cocNode.setParameter(e,t);break;case"blurRadius":for(var r=0;r<this._dofBlurNodes.length;r++)this._dofBlurNodes[r].setParameter("blurRadius",t);break;case"quality":var n={low:4,medium:8,high:16,ultra:32}[t]||8;this._dofBlurKernelSize=n;for(var r=0;r<this._dofBlurNodes.length;r++)this._dofBlurNodes[r].pass.material.define("POISSON_KERNEL_SIZE",n);this._dofBlurKernel=new Float32Array(n*2);break}};ze.prototype.setSSRParameter=function(e,t){if(t!=null)switch(e){case"quality":var r={low:10,medium:15,high:30,ultra:80}[t]||20,n={low:32,medium:16,high:8,ultra:4}[t]||16;this._ssrPass.setParameter("maxIteration",r),this._ssrPass.setParameter("pixelStride",n);break;case"maxRoughness":this._ssrPass.setParameter("minGlossiness",Math.max(Math.min(1-t,1),0));break;case"physical":this.setPhysicallyCorrectSSR(t);break;default:console.warn("Unkown SSR parameter "+e)}};ze.prototype.setPhysicallyCorrectSSR=function(e){this._ssrPass.setPhysicallyCorrect(e)};ze.prototype.setEdgeColor=function(e){var t=U.parseColor(e);this._edgePass.setParameter("edgeColor",t)};ze.prototype.setExposure=function(e){this._compositeNode.setParameter("exposure",Math.pow(2,e))};ze.prototype.setColorLookupTexture=function(e,t){this._compositeNode.pass.material.setTextureImage("lut",this._enableColorCorrection?e:"none",t,{minFilter:U.Texture.NEAREST,magFilter:U.Texture.NEAREST,flipY:!1})};ze.prototype.setColorCorrection=function(e,t){this._compositeNode.setParameter(e,t)};ze.prototype.isSSREnabled=function(){return this._enableSSR};ze.prototype.composite=function(e,t,r,n,i){var a=this._sourceTexture,o=a;this._enableEdge&&(this._edgePass.update(e,r,a,i),a=o=this._edgePass.getTargetTexture()),this._enableSSR&&(this._ssrPass.update(e,r,a,i),o=this._ssrPass.getTargetTexture(),this._ssrPass.setSSAOTexture(this._enableSSAO?this._ssaoPass.getTargetTexture():null)),this._sourceNode.texture=o,this._cocNode.setParameter("depth",this._depthTexture);for(var s=this._dofBlurKernel,l=this._dofBlurKernelSize,u=Math.floor(bI.length/2/l),h=i%u,f=0;f<l*2;f++)s[f]=bI[f+h*l*2];for(var f=0;f<this._dofBlurNodes.length;f++)this._dofBlurNodes[f].setParameter("percent",i/30),this._dofBlurNodes[f].setParameter("poissonKernel",s);this._cocNode.setParameter("zNear",r.near),this._cocNode.setParameter("zFar",r.far),this._compositor.render(e,n)};ze.prototype.dispose=function(e){this._sourceTexture.dispose(e),this._depthTexture.dispose(e),this._framebuffer.dispose(e),this._compositor.dispose(e),this._normalPass.dispose(e),this._ssaoPass.dispose(e)};function YT(e){for(var t=[],r=0;r<30;r++)t.push([wf(r,2),wf(r,3)]);this._haltonSequence=t,this._frame=0,this._sourceTex=new xe,this._sourceFb=new Ir,this._sourceFb.attach(this._sourceTex),this._prevFrameTex=new xe,this._outputTex=new xe;var n=this._blendPass=new kr({fragment:Et.source("clay.compositor.blend")});n.material.disableTexturesAll(),n.material.enableTexture(["texture1","texture2"]),this._blendFb=new Ir({depthBuffer:!1}),this._outputPass=new kr({fragment:Et.source("clay.compositor.output"),blendWithPrevious:!0}),this._outputPass.material.define("fragment","OUTPUT_ALPHA"),this._outputPass.material.blend=function(i){i.blendEquationSeparate(i.FUNC_ADD,i.FUNC_ADD),i.blendFuncSeparate(i.ONE,i.ONE_MINUS_SRC_ALPHA,i.ONE,i.ONE_MINUS_SRC_ALPHA)}}YT.prototype={constructor:YT,jitterProjection:function(e,t){var r=e.viewport,n=r.devicePixelRatio||e.getDevicePixelRatio(),i=r.width*n,a=r.height*n,o=this._haltonSequence[this._frame%this._haltonSequence.length],s=new Nt;s.array[12]=(o[0]*2-1)/i,s.array[13]=(o[1]*2-1)/a,Nt.mul(t.projectionMatrix,s,t.projectionMatrix),Nt.invert(t.invProjectionMatrix,t.projectionMatrix)},resetFrame:function(){this._frame=0},getFrame:function(){return this._frame},getSourceFrameBuffer:function(){return this._sourceFb},getOutputTexture:function(){return this._outputTex},resize:function(e,t){this._prevFrameTex.width=e,this._prevFrameTex.height=t,this._outputTex.width=e,this._outputTex.height=t,this._sourceTex.width=e,this._sourceTex.height=t,this._prevFrameTex.dirty(),this._outputTex.dirty(),this._sourceTex.dirty()},isFinished:function(){return this._frame>=this._haltonSequence.length},render:function(e,t,r){var n=this._blendPass;this._frame===0?(n.setUniform("weight1",0),n.setUniform("weight2",1)):(n.setUniform("weight1",.9),n.setUniform("weight2",.1)),n.setUniform("texture1",this._prevFrameTex),n.setUniform("texture2",t||this._sourceTex),this._blendFb.attach(this._outputTex),this._blendFb.bind(e),n.render(e),this._blendFb.unbind(e),r||(this._outputPass.setUniform("texture",this._outputTex),this._outputPass.render(e));var i=this._prevFrameTex;this._prevFrameTex=this._outputTex,this._outputTex=i,this._frame++},dispose:function(e){this._sourceFb.dispose(e),this._blendFb.dispose(e),this._prevFrameTex.dispose(e),this._outputTex.dispose(e),this._sourceTex.dispose(e),this._outputPass.dispose(e),this._blendPass.dispose(e)}};function rr(e){e=e||"perspective",this.layer=null,this.scene=new Xs,this.rootNode=this.scene,this.viewport={x:0,y:0,width:0,height:0},this.setProjection(e),this._compositor=new ze,this._temporalSS=new YT,this._shadowMapPass=new Ra;for(var t=[],r=0,n=0;n<30;n++){for(var i=[],a=0;a<6;a++)i.push(wf(r,2)*4-2),i.push(wf(r,3)*4-2),r++;t.push(i)}this._pcfKernels=t,this.scene.on("beforerender",function(o,s,l){this.needsTemporalSS()&&this._temporalSS.jitterProjection(o,l)},this)}rr.prototype.setProjection=function(e){var t=this.camera;t&&t.update(),e==="perspective"?this.camera instanceof Kr||(this.camera=new Kr,t&&this.camera.setLocalTransform(t.localTransform)):this.camera instanceof bf||(this.camera=new bf,t&&this.camera.setLocalTransform(t.localTransform)),this.camera.near=.1,this.camera.far=2e3};rr.prototype.setViewport=function(e,t,r,n,i){this.camera instanceof Kr&&(this.camera.aspect=r/n),i=i||1,this.viewport.x=e,this.viewport.y=t,this.viewport.width=r,this.viewport.height=n,this.viewport.devicePixelRatio=i,this._compositor.resize(r*i,n*i),this._temporalSS.resize(r*i,n*i)};rr.prototype.containPoint=function(e,t){var r=this.viewport,n=this.layer.renderer.getHeight();return t=n-t,e>=r.x&&t>=r.y&&e<=r.x+r.width&&t<=r.y+r.height};var wI=new ce;rr.prototype.castRay=function(e,t,r){var n=this.layer.renderer,i=n.viewport;return n.viewport=this.viewport,n.screenToNDC(e,t,wI),this.camera.castRay(wI,r),n.viewport=i,r};rr.prototype.prepareRender=function(){this.scene.update(),this.camera.update(),this.scene.updateLights();var e=this.scene.updateRenderList(this.camera);this._needsSortProgressively=!1;for(var t=0;t<e.transparent.length;t++){var r=e.transparent[t],n=r.geometry;n.needsSortVerticesProgressively&&n.needsSortVerticesProgressively()&&(this._needsSortProgressively=!0),n.needsSortTrianglesProgressively&&n.needsSortTrianglesProgressively()&&(this._needsSortProgressively=!0)}this._frame=0,this._temporalSS.resetFrame()};rr.prototype.render=function(e,t){this._doRender(e,t,this._frame),this._frame++};rr.prototype.needsAccumulate=function(){return this.needsTemporalSS()||this._needsSortProgressively};rr.prototype.needsTemporalSS=function(){var e=this._enableTemporalSS;return e==="auto"&&(e=this._enablePostEffect),e};rr.prototype.hasDOF=function(){return this._enableDOF};rr.prototype.isAccumulateFinished=function(){return this.needsTemporalSS()?this._temporalSS.isFinished():this._frame>30};rr.prototype._doRender=function(e,t,r){var n=this.scene,i=this.camera;r=r||0,this._updateTransparent(e,n,i,r),t||(this._shadowMapPass.kernelPCF=this._pcfKernels[0],this._shadowMapPass.render(e,n,i,!0)),this._updateShadowPCFKernel(r);var a=e.clearColor;if(e.gl.clearColor(a[0],a[1],a[2],a[3]),this._enablePostEffect&&(this.needsTemporalSS()&&this._temporalSS.jitterProjection(e,i),this._compositor.updateNormal(e,n,i,this._temporalSS.getFrame())),this._updateSSAO(e,n,i,this._temporalSS.getFrame()),this._enablePostEffect){var o=this._compositor.getSourceFrameBuffer();o.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),e.render(n,i,!0,!0),o.unbind(e),this.needsTemporalSS()&&t?(this._compositor.composite(e,n,i,this._temporalSS.getSourceFrameBuffer(),this._temporalSS.getFrame()),e.setViewport(this.viewport),this._temporalSS.render(e)):(e.setViewport(this.viewport),this._compositor.composite(e,n,i,null,0))}else if(this.needsTemporalSS()&&t){var o=this._temporalSS.getSourceFrameBuffer();o.bind(e),e.saveClear(),e.clearBit=e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT,e.render(n,i,!0,!0),e.restoreClear(),o.unbind(e),e.setViewport(this.viewport),this._temporalSS.render(e)}else e.setViewport(this.viewport),e.render(n,i,!0,!0)};rr.prototype._updateTransparent=function(e,t,r,n){for(var i=new ht,a=new Nt,o=r.getWorldPosition(),s=t.getRenderList(r).transparent,l=0;l<s.length;l++){var u=s[l],h=u.geometry;Nt.invert(a,u.worldTransform),ht.transformMat4(i,o,a),h.needsSortTriangles&&h.needsSortTriangles()&&h.doSortTriangles(i,n),h.needsSortVertices&&h.needsSortVertices()&&h.doSortVertices(i,n)}};rr.prototype._updateSSAO=function(e,t,r){var n=this._enableSSAO&&this._enablePostEffect;n&&this._compositor.updateSSAO(e,t,r,this._temporalSS.getFrame());for(var i=t.getRenderList(r),a=0;a<i.opaque.length;a++){var o=i.opaque[a];o.renderNormal&&o.material[n?"enableTexture":"disableTexture"]("ssaoMap"),n&&o.material.set("ssaoMap",this._compositor.getSSAOTexture())}};rr.prototype._updateShadowPCFKernel=function(e){for(var t=this._pcfKernels[e%this._pcfKernels.length],r=this.scene.getRenderList(this.camera),n=r.opaque,i=0;i<n.length;i++)n[i].receiveShadow&&(n[i].material.set("pcfKernel",t),n[i].material.define("fragment","PCF_KERNEL_SIZE",t.length/2))};rr.prototype.dispose=function(e){this._compositor.dispose(e.gl),this._temporalSS.dispose(e.gl),this._shadowMapPass.dispose(e)};rr.prototype.setPostEffect=function(e,t){var r=this._compositor;this._enablePostEffect=e.get("enable");var n=e.getModel("bloom"),i=e.getModel("edge"),a=e.getModel("DOF",e.getModel("depthOfField")),o=e.getModel("SSAO",e.getModel("screenSpaceAmbientOcclusion")),s=e.getModel("SSR",e.getModel("screenSpaceReflection")),l=e.getModel("FXAA"),u=e.getModel("colorCorrection");n.get("enable")?r.enableBloom():r.disableBloom(),a.get("enable")?r.enableDOF():r.disableDOF(),s.get("enable")?r.enableSSR():r.disableSSR(),u.get("enable")?r.enableColorCorrection():r.disableColorCorrection(),i.get("enable")?r.enableEdge():r.disableEdge(),l.get("enable")?r.enableFXAA():r.disableFXAA(),this._enableDOF=a.get("enable"),this._enableSSAO=o.get("enable"),this._enableSSAO?r.enableSSAO():r.disableSSAO(),r.setBloomIntensity(n.get("intensity")),r.setEdgeColor(i.get("color")),r.setColorLookupTexture(u.get("lookupTexture"),t),r.setExposure(u.get("exposure")),["radius","quality","intensity"].forEach(function(h){r.setSSAOParameter(h,o.get(h))}),["quality","maxRoughness","physical"].forEach(function(h){r.setSSRParameter(h,s.get(h))}),["quality","focalDistance","focalRange","blurRadius","fstop"].forEach(function(h){r.setDOFParameter(h,a.get(h))}),["brightness","contrast","saturation"].forEach(function(h){r.setColorCorrection(h,u.get(h))})};rr.prototype.setDOFFocusOnPoint=function(e){if(this._enablePostEffect)return e>this.camera.far||e<this.camera.near?void 0:(this._compositor.setDOFParameter("focalDistance",e),!0)};rr.prototype.setTemporalSuperSampling=function(e){this._enableTemporalSS=e.get("enable")};rr.prototype.isLinearSpace=function(){return this._enablePostEffect};rr.prototype.setRootNode=function(e){if(this.rootNode!==e){for(var t=this.rootNode.children(),r=0;r<t.length;r++)e.add(t[r]);e!==this.scene&&this.scene.add(e),this.rootNode=e}};rr.prototype.add=function(e){this.rootNode.add(e)};rr.prototype.remove=function(e){this.rootNode.remove(e)};rr.prototype.removeAll=function(e){this.rootNode.removeAll(e)};Object.assign(rr.prototype,eA);function Dot(e,t){var r=e.getBoxLayoutParams(),n=Mr(r,{width:t.getWidth(),height:t.getHeight()});n.y=t.getHeight()-n.y-n.height,this.viewGL.setViewport(n.x,n.y,n.width,n.height,t.getDevicePixelRatio());var i=e.get("boxWidth"),a=e.get("boxHeight"),o=e.get("boxDepth");this.getAxis("x").setExtent(-i/2,i/2),this.getAxis("y").setExtent(o/2,-o/2),this.getAxis("z").setExtent(-a/2,a/2),this.size=[i,a,o]}function Lot(e,t){var r={};function n(i,a){r[i]=r[i]||[1/0,-1/0],r[i][0]=Math.min(a[0],r[i][0]),r[i][1]=Math.max(a[1],r[i][1])}e.eachSeries(function(i){if(i.coordinateSystem===this){var a=i.getData();["x","y","z"].forEach(function(o){a.mapDimensionsAll(o,!0).forEach(function(s){n(o,a.getDataExtent(s,!0))})})}},this),["xAxis3D","yAxis3D","zAxis3D"].forEach(function(i){e.eachComponent(i,function(a){var o=i.charAt(0),s=a.getReferringComponents("grid3D").models[0],l=s.coordinateSystem;if(l===this){var u=l.getAxis(o);if(!u){var h=Yw(r[o]||[1/0,-1/0],a);u=new u_(o,h),u.type=a.get("type");var f=u.type==="category";u.onBand=f&&a.get("boundaryGap"),u.inverse=a.get("inverse"),a.axis=u,u.model=a,u.getLabelModel=function(){return a.getModel("axisLabel",s.getModel("axisLabel"))},u.getTickModel=function(){return a.getModel("axisTick",s.getModel("axisTick"))},l.addAxis(u)}}},this)},this),this.resize(this.model,t)}var Rot={dimensions:uv.prototype.dimensions,create:function(e,t){var r=[];e.eachComponent("grid3D",function(a){a.__viewGL=a.__viewGL||new rr;var o=new uv;o.model=a,o.viewGL=a.__viewGL,a.coordinateSystem=o,r.push(o),o.resize=Dot,o.update=Lot});var n=["xAxis3D","yAxis3D","zAxis3D"];function i(a,o){return n.map(function(s){var l=a.getReferringComponents(s).models[0];return l==null&&(l=o.getComponent(s)),l})}return e.eachSeries(function(a){if(a.get("coordinateSystem")==="cartesian3D"){var o=a.getReferringComponents("grid3D").models[0];if(o==null){var s=i(a,e),o=s[0].getCoordSysModel();s.forEach(function(h){h.getCoordSysModel()})}var l=o.coordinateSystem;a.coordinateSystem=l}}),r}},oG=me.extend({type:"cartesian3DAxis",axis:null,getCoordSysModel:function(){return this.ecModel.queryComponents({mainType:"grid3D",index:this.option.gridIndex,id:this.option.gridId})[0]}});u9(oG);var sG={show:!0,grid3DIndex:0,inverse:!1,name:"",nameLocation:"middle",nameTextStyle:{fontSize:16},nameGap:20,axisPointer:{},axisLine:{},axisTick:{},axisLabel:{},splitArea:{}},Pot=Ot({boundaryGap:!0,axisTick:{alignWithLabel:!1,interval:"auto"},axisLabel:{interval:"auto"},axisPointer:{label:{show:!1}}},sG),uA=Ot({boundaryGap:[0,0],splitNumber:5,axisPointer:{label:{}}},sG),Iot=Vt({scale:!0,min:"dataMin",max:"dataMax"},uA),lG=Vt({logBase:10},uA);lG.scale=!0;const Not={categoryAxis3D:Pot,valueAxis3D:uA,timeAxis3D:Iot,logAxis3D:lG};var Oot=["value","category","time","log"];function Fot(e,t,r,n,i){Oot.forEach(function(a){var o=r.extend({type:t+"Axis3D."+a,__ordinalMeta:null,mergeDefaultAndTheme:function(s,l){var u=l.getTheme();Ot(s,u.get(a+"Axis3D")),Ot(s,this.getDefaultOption()),s.type=n(t,s)},optionUpdated:function(){var s=this.option;s.type==="category"&&(this.__ordinalMeta=Om.createByAxisModel(this))},getCategories:function(){if(this.option.type==="category")return this.__ordinalMeta.categories},getOrdinalMeta:function(){return this.__ordinalMeta},defaultOption:Ot(Qt(Not[a+"Axis3D"]),i,!0)});e.registerComponentModel(o)}),e.registerSubTypeDefaulter(t+"Axis3D",ue(n,t))}function Bot(e,t){return t.type||(t.data?"category":"value")}function Uot(e){e.registerComponentModel(c0),e.registerComponentView(tot),e.registerCoordinateSystem("grid3D",Rot),["x","y","z"].forEach(function(t){Fot(e,t,oG,Bot,{name:t.toUpperCase()});const r=e.ComponentView.extend({type:t+"Axis3D"});e.registerComponentView(r)}),e.registerAction({type:"grid3DChangeCamera",event:"grid3dcamerachanged",update:"series:updateCamera"},function(t,r){r.eachComponent({mainType:"grid3D",query:t},function(n){n.setView(t)})}),e.registerAction({type:"grid3DShowAxisPointer",event:"grid3dshowaxispointer",update:"grid3D:showAxisPointer"},function(t,r){}),e.registerAction({type:"grid3DHideAxisPointer",event:"grid3dhideaxispointer",update:"grid3D:hideAxisPointer"},function(t,r){})}te(Uot);const nc={defaultOption:{shading:null,realisticMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},lambertMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},colorMaterial:{textureTiling:1,textureOffset:0,detailTexture:null},hatchingMaterial:{textureTiling:1,textureOffset:0,paperColor:"#fff"}}},uG={getFilledRegions:function(e,t){var r=(e||[]).slice(),n;if(typeof t=="string"?(t=ZS(t),n=t&&t.geoJson):t&&t.features&&(n=t),!n)return[];for(var i={},a=n.features,o=0;o<r.length;o++)i[r[o].name]=r[o];for(var o=0;o<a.length;o++){var s=a[o].properties.name;i[s]||r.push({name:s})}return r},defaultOption:{show:!0,zlevel:-10,map:"",left:0,top:0,width:"100%",height:"100%",boxWidth:100,boxHeight:10,boxDepth:"auto",regionHeight:3,environment:"auto",groundPlane:{show:!1,color:"#aaa"},shading:"lambert",light:{main:{alpha:40,beta:30}},viewControl:{alpha:40,beta:0,distance:100,orthographicSize:60,minAlpha:5,minBeta:-80,maxBeta:80},label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}};var ic=me.extend({type:"geo3D",layoutMode:"box",coordinateSystem:null,optionUpdated:function(){var e=this.option;e.regions=this.getFilledRegions(e.regions,e.map);var t=Ev(e.data||[],{coordDimensions:["value"],encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),r=new xr(t,this);r.initData(e.regions);var n={};r.each(function(i){var a=r.getName(i),o=r.getItemModel(i);n[a]=o}),this._regionModelMap=n,this._data=r},getData:function(){return this._data},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new Ie(null,this)},getRegionPolygonCoords:function(e){var t=this.getData().getName(e),r=this.coordinateSystem.getRegion(t);return r?r.geometries:[]},getFormattedLabel:function(e,t){var r=this._data.getName(e),n=this.getRegionModel(e),i=n.get(t==="normal"?["label","formatter"]:["emphasis","label","formatter"]);i==null&&(i=n.get(["label","formatter"]));var a={name:r};if(typeof i=="function")return a.status=t,i(a);if(typeof i=="string"){var o=a.seriesName;return i.replace("{a}",o??"")}else return r},defaultOption:{regions:[]}});Ot(ic.prototype,uG);Ot(ic.prototype,f0);Ot(ic.prototype,tc);Ot(ic.prototype,ec);Ot(ic.prototype,nc);function hG(e,t,r){r=r||2;var n=t&&t.length,i=n?t[0]*r:e.length,a=fG(e,0,i,r,!0),o=[];if(!a)return o;var s,l,u,h,f,c,d;if(n&&(a=Hot(e,t,a,r)),e.length>80*r){s=u=e[0],l=h=e[1];for(var v=r;v<i;v+=r)f=e[v],c=e[v+1],f<s&&(s=f),c<l&&(l=c),f>u&&(u=f),c>h&&(h=c);d=Math.max(u-s,h-l)}return cv(a,o,r,s,l,d),o}function fG(e,t,r,n,i){var a,o;if(i===$T(e,t,r,n)>0)for(a=t;a<r;a+=n)o=MI(a,e[a],e[a+1],o);else for(a=r-n;a>=t;a-=n)o=MI(a,e[a],e[a+1],o);return o&&au(o,o.next)&&(vv(o),o=o.next),o}function fv(e,t){if(!e)return e;t||(t=e);var r=e,n;do if(n=!1,!r.steiner&&(au(r,r.next)||zn(r.prev,r,r.next)===0)){if(vv(r),r=t=r.prev,r===r.next)return null;n=!0}else r=r.next;while(n||r!==t);return t}function cv(e,t,r,n,i,a,o){if(e){!o&&a&&Zot(e,n,i,a);for(var s=e,l,u;e.prev!==e.next;){if(l=e.prev,u=e.next,a?kot(e,n,i,a):zot(e)){t.push(l.i/r),t.push(e.i/r),t.push(u.i/r),vv(e),e=u.next,s=u.next;continue}if(e=u,e===s){o?o===1?(e=Got(e,t,r),cv(e,t,r,n,i,a,2)):o===2&&Vot(e,t,r,n,i,a):cv(fv(e),t,r,n,i,a,1);break}}}}function zot(e){var t=e.prev,r=e,n=e.next;if(zn(t,r,n)>=0)return!1;for(var i=e.next.next;i!==e.prev;){if(f_(t.x,t.y,r.x,r.y,n.x,n.y,i.x,i.y)&&zn(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function kot(e,t,r,n){var i=e.prev,a=e,o=e.next;if(zn(i,a,o)>=0)return!1;for(var s=i.x<a.x?i.x<o.x?i.x:o.x:a.x<o.x?a.x:o.x,l=i.y<a.y?i.y<o.y?i.y:o.y:a.y<o.y?a.y:o.y,u=i.x>a.x?i.x>o.x?i.x:o.x:a.x>o.x?a.x:o.x,h=i.y>a.y?i.y>o.y?i.y:o.y:a.y>o.y?a.y:o.y,f=ZT(s,l,t,r,n),c=ZT(u,h,t,r,n),d=e.nextZ;d&&d.z<=c;){if(d!==e.prev&&d!==e.next&&f_(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&zn(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=e.prevZ;d&&d.z>=f;){if(d!==e.prev&&d!==e.next&&f_(i.x,i.y,a.x,a.y,o.x,o.y,d.x,d.y)&&zn(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function Got(e,t,r){var n=e;do{var i=n.prev,a=n.next.next;!au(i,a)&&cG(i,n,n.next,a)&&dv(i,a)&&dv(a,i)&&(t.push(i.i/r),t.push(n.i/r),t.push(a.i/r),vv(n),vv(n.next),n=e=a),n=n.next}while(n!==e);return n}function Vot(e,t,r,n,i,a){var o=e;do{for(var s=o.next.next;s!==o.prev;){if(o.i!==s.i&&Kot(o,s)){var l=dG(o,s);o=fv(o,o.next),l=fv(l,l.next),cv(o,t,r,n,i,a),cv(l,t,r,n,i,a);return}s=s.next}o=o.next}while(o!==e)}function Hot(e,t,r,n){var i=[],a,o,s,l,u;for(a=0,o=t.length;a<o;a++)s=t[a]*n,l=a<o-1?t[a+1]*n:e.length,u=fG(e,s,l,n,!1),u===u.next&&(u.steiner=!0),i.push($ot(u));for(i.sort(Wot),a=0;a<i.length;a++)Xot(i[a],r),r=fv(r,r.next);return r}function Wot(e,t){return e.x-t.x}function Xot(e,t){if(t=Yot(e,t),t){var r=dG(t,e);fv(r,r.next)}}function Yot(e,t){var r=t,n=e.x,i=e.y,a=-1/0,o;do{if(i<=r.y&&i>=r.next.y&&r.next.y!==r.y){var s=r.x+(i-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=n&&s>a){if(a=s,s===n){if(i===r.y)return r;if(i===r.next.y)return r.next}o=r.x<r.next.x?r:r.next}}r=r.next}while(r!==t);if(!o)return null;if(n===a)return o.prev;var l=o,u=o.x,h=o.y,f=1/0,c;for(r=o.next;r!==l;)n>=r.x&&r.x>=u&&n!==r.x&&f_(i<h?n:a,i,u,h,i<h?a:n,i,r.x,r.y)&&(c=Math.abs(i-r.y)/(n-r.x),(c<f||c===f&&r.x>o.x)&&dv(r,e)&&(o=r,f=c)),r=r.next;return o}function Zot(e,t,r,n){var i=e;do i.z===null&&(i.z=ZT(i.x,i.y,t,r,n)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next;while(i!==e);i.prevZ.nextZ=null,i.prevZ=null,qot(i)}function qot(e){var t,r,n,i,a,o,s,l,u=1;do{for(r=e,e=null,a=null,o=0;r;){for(o++,n=r,s=0,t=0;t<u&&(s++,n=n.nextZ,!!n);t++);for(l=u;s>0||l>0&&n;)s!==0&&(l===0||!n||r.z<=n.z)?(i=r,r=r.nextZ,s--):(i=n,n=n.nextZ,l--),a?a.nextZ=i:e=i,i.prevZ=a,a=i;r=n}a.nextZ=null,u*=2}while(o>1);return e}function ZT(e,t,r,n,i){return e=32767*(e-r)/i,t=32767*(t-n)/i,e=(e|e<<8)&16711935,e=(e|e<<4)&252645135,e=(e|e<<2)&858993459,e=(e|e<<1)&1431655765,t=(t|t<<8)&16711935,t=(t|t<<4)&252645135,t=(t|t<<2)&858993459,t=(t|t<<1)&1431655765,e|t<<1}function $ot(e){var t=e,r=e;do t.x<r.x&&(r=t),t=t.next;while(t!==e);return r}function f_(e,t,r,n,i,a,o,s){return(i-o)*(t-s)-(e-o)*(a-s)>=0&&(e-o)*(n-s)-(r-o)*(t-s)>=0&&(r-o)*(a-s)-(i-o)*(n-s)>=0}function Kot(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!jot(e,t)&&dv(e,t)&&dv(t,e)&&Jot(e,t)}function zn(e,t,r){return(t.y-e.y)*(r.x-t.x)-(t.x-e.x)*(r.y-t.y)}function au(e,t){return e.x===t.x&&e.y===t.y}function cG(e,t,r,n){return au(e,t)&&au(r,n)||au(e,n)&&au(r,t)?!0:zn(e,t,r)>0!=zn(e,t,n)>0&&zn(r,n,e)>0!=zn(r,n,t)>0}function jot(e,t){var r=e;do{if(r.i!==e.i&&r.next.i!==e.i&&r.i!==t.i&&r.next.i!==t.i&&cG(r,r.next,e,t))return!0;r=r.next}while(r!==e);return!1}function dv(e,t){return zn(e.prev,e,e.next)<0?zn(e,t,e.next)>=0&&zn(e,e.prev,t)>=0:zn(e,t,e.prev)<0||zn(e,e.next,t)<0}function Jot(e,t){var r=e,n=!1,i=(e.x+t.x)/2,a=(e.y+t.y)/2;do r.y>a!=r.next.y>a&&r.next.y!==r.y&&i<(r.next.x-r.x)*(a-r.y)/(r.next.y-r.y)+r.x&&(n=!n),r=r.next;while(r!==e);return n}function dG(e,t){var r=new qT(e.i,e.x,e.y),n=new qT(t.i,t.x,t.y),i=e.next,a=t.prev;return e.next=t,t.prev=e,r.next=i,i.prev=r,n.next=r,r.prev=n,a.next=n,n.prev=a,n}function MI(e,t,r,n){var i=new qT(e,t,r);return n?(i.next=n.next,i.prev=n,n.next.prev=i,n.next=i):(i.prev=i,i.next=i),i}function vv(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function qT(e,t,r){this.i=e,this.x=t,this.y=r,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}hG.deviation=function(e,t,r,n){var i=t&&t.length,a=i?t[0]*r:e.length,o=Math.abs($T(e,0,a,r));if(i)for(var s=0,l=t.length;s<l;s++){var u=t[s]*r,h=s<l-1?t[s+1]*r:e.length;o-=Math.abs($T(e,u,h,r))}var f=0;for(s=0;s<n.length;s+=3){var c=n[s]*r,d=n[s+1]*r,v=n[s+2]*r;f+=Math.abs((e[c]-e[v])*(e[d+1]-e[c+1])-(e[c]-e[d])*(e[v+1]-e[c+1]))}return o===0&&f===0?0:Math.abs((f-o)/o)};function $T(e,t,r,n){for(var i=0,a=t,o=r-n;a<r;a+=n)i+=(e[o]-e[a])*(e[a+1]+e[o+1]),o=a;return i}function d1(e,t,r){var n=e[t];e[t]=e[r],e[r]=n}function vG(e,t,r,n,i){var a=r,o=e[t];d1(e,t,n);for(var s=r;s<n;s++)i(e[s],o)<0&&(d1(e,s,a),a++);return d1(e,n,a),a}function c_(e,t,r,n){if(r<n){var i=Math.floor((r+n)/2),a=vG(e,i,r,n,t);c_(e,t,r,a-1),c_(e,t,a+1,n)}}function Mf(){this._parts=[]}Mf.prototype.step=function(e,t,r){var n=e.length;if(r===0){this._parts=[],this._sorted=!1;var i=Math.floor(n/2);this._parts.push({pivot:i,left:0,right:n-1}),this._currentSortPartIdx=0}if(!this._sorted){var a=this._parts;if(a.length===0)return this._sorted=!0,!0;if(a.length<512){for(var o=0;o<a.length;o++)a[o].pivot=vG(e,a[o].pivot,a[o].left,a[o].right,t);for(var s=[],o=0;o<a.length;o++){var l=a[o].left,u=a[o].pivot-1;u>l&&s.push({pivot:Math.floor((u+l)/2),left:l,right:u});var l=a[o].pivot+1,u=a[o].right;u>l&&s.push({pivot:Math.floor((u+l)/2),left:l,right:u})}a=this._parts=s}else for(var o=0;o<Math.floor(a.length/10);o++){var h=a.length-1-this._currentSortPartIdx;if(c_(e,t,a[h].left,a[h].right),this._currentSortPartIdx++,this._currentSortPartIdx===a.length)return this._sorted=!0,!0}return!1}};Mf.sort=c_;var nf=Or.vec3,AI=nf.create(),EI=nf.create(),CI=nf.create();const hA={needsSortTriangles:function(){return this.indices&&this.sortTriangles},needsSortTrianglesProgressively:function(){return this.needsSortTriangles()&&this.triangleCount>=2e4},doSortTriangles:function(e,t){var r=this.indices;if(t===0){var n=this.attributes.position,e=e.array;(!this._triangleZList||this._triangleZList.length!==this.triangleCount)&&(this._triangleZList=new Float32Array(this.triangleCount),this._sortedTriangleIndices=new Uint32Array(this.triangleCount),this._indicesTmp=new r.constructor(r.length),this._triangleZListTmp=new Float32Array(this.triangleCount));for(var i=0,a,o=0;o<r.length;){n.get(r[o++],AI),n.get(r[o++],EI),n.get(r[o++],CI);var s=nf.sqrDist(AI,e),l=nf.sqrDist(EI,e),u=nf.sqrDist(CI,e),h=Math.min(s,l);h=Math.min(h,u),o===3?(a=h,h=0):h=h-a,this._triangleZList[i++]=h}}for(var f=this._sortedTriangleIndices,o=0;o<f.length;o++)f[o]=o;if(this.triangleCount<2e4)t===0&&this._simpleSort(!0);else for(var o=0;o<3;o++)this._progressiveQuickSort(t*3+o);for(var c=this._indicesTmp,d=this._triangleZListTmp,v=this._triangleZList,o=0;o<this.triangleCount;o++){var p=f[o]*3,g=o*3;c[g++]=r[p++],c[g++]=r[p++],c[g]=r[p],d[o]=v[f[o]]}var m=this._indicesTmp;this._indicesTmp=this.indices,this.indices=m;var m=this._triangleZListTmp;this._triangleZListTmp=this._triangleZList,this._triangleZList=m,this.dirtyIndices()},_simpleSort:function(e){var t=this._triangleZList,r=this._sortedTriangleIndices;function n(i,a){return t[a]-t[i]}e?Array.prototype.sort.call(r,n):Mf.sort(r,n,0,r.length-1)},_progressiveQuickSort:function(e){var t=this._triangleZList,r=this._sortedTriangleIndices;this._quickSort=this._quickSort||new Mf,this._quickSort.step(r,function(n,i){return t[i]-t[n]},e)}};function Qot(e){const t=e.getVisual("style");if(t){const r=e.getVisual("drawType");return t[r]}}function tst(e){return e.getVisual("style").opacity}function nn(e,t){const r=e.getItemVisual(t,"style");if(r){const n=e.getVisual("drawType");return r[n]}}function tn(e,t){const r=e.getItemVisual(t,"style");return r&&r.opacity}var pG=1,gG=2;function Xo(e,t,r){this._labelsMesh=new aA,this._labelTextureSurface=new l_({width:512,height:512,devicePixelRatio:r.getDevicePixelRatio(),onupdate:function(){r.getZr().refresh()}}),this._api=r,this._labelsMesh.material.set("textureAtlas",this._labelTextureSurface.getTexture())}Xo.prototype.getLabelPosition=function(e,t,r){return[0,0,0]};Xo.prototype.getLabelDistance=function(e,t,r){return 0};Xo.prototype.getMesh=function(){return this._labelsMesh};Xo.prototype.updateData=function(e,t,r){t==null&&(t=0),r==null&&(r=e.count()),(!this._labelsVisibilitiesBits||this._labelsVisibilitiesBits.length!==r-t)&&(this._labelsVisibilitiesBits=new Uint8Array(r-t));for(var n=["label","show"],i=["emphasis","label","show"],a=t;a<r;a++){var o=e.getItemModel(a),s=o.get(n),l=o.get(i);l==null&&(l=s);var u=(s?pG:0)|(l?gG:0);this._labelsVisibilitiesBits[a-t]=u}this._start=t,this._end=r,this._data=e};Xo.prototype.updateLabels=function(e){if(this._data){e=e||[];for(var t=e.length>0,r={},n=0;n<e.length;n++)r[e[n]]=!0;this._labelsMesh.geometry.convertToDynamicArray(!0),this._labelTextureSurface.clear();for(var i=["label"],a=["emphasis","label"],o=this._data.hostModel,s=this._data,l=o.getModel(i),u=o.getModel(a,l),h={left:"right",right:"left",top:"center",bottom:"center"},f={left:"middle",right:"middle",top:"bottom",bottom:"top"},c=this._start;c<this._end;c++){var d=!1;t&&r[c]&&(d=!0);var v=this._labelsVisibilitiesBits[c-this._start]&(d?gG:pG);if(v){var p=s.getItemModel(c),g=p.getModel(d?a:i,d?u:l),m=g.get("distance")||0,_=g.get("position"),y=this._api.getDevicePixelRatio(),x=o.getFormattedLabel(c,d?"emphasis":"normal");if(x==null||x==="")return;var T=new we({style:je(g,{text:x,fill:g.get("color")||nn(s,c)||"#000",align:"left",verticalAlign:"top",opacity:Ee.firstNotNull(g.get("opacity"),tn(s,c),1)})}),S=T.getBoundingRect(),M=1.2;S.height*=M;var w=this._labelTextureSurface.add(T),b=h[_]||"center",A=f[_]||"bottom";this._labelsMesh.geometry.addSprite(this.getLabelPosition(c,_,m),[S.width*y,S.height*y],w,b,A,this.getLabelDistance(c,_,m)*y)}}this._labelsMesh.material.set("uvScale",this._labelTextureSurface.getCoordsScale()),this._labelTextureSurface.getZr().refreshImmediately(),this._labelsMesh.geometry.convertToTypedArray(),this._labelsMesh.geometry.dirty()}};Xo.prototype.dispose=function(){this._labelTextureSurface.dispose()};var ti=Or.vec3;U.Shader.import(v0);function Af(e){this.rootNode=new U.Node,this._triangulationResults={},this._shadersMap=U.COMMON_SHADERS.filter(function(r){return r!=="shadow"}).reduce(function(r,n){return r[n]=U.createShader("ecgl."+n),r},{}),this._linesShader=U.createShader("ecgl.meshLines3D");var t={};U.COMMON_SHADERS.forEach(function(r){t[r]=new U.Material({shader:U.createShader("ecgl."+r)})}),this._groundMaterials=t,this._groundMesh=new U.Mesh({geometry:new U.PlaneGeometry({dynamic:!0}),castShadow:!1,renderNormal:!0,$ignorePicking:!0}),this._groundMesh.rotation.rotateX(-Math.PI/2),this._labelsBuilder=new Xo(512,512,e),this._labelsBuilder.getMesh().renderOrder=100,this._labelsBuilder.getMesh().material.depthTest=!1,this.rootNode.add(this._labelsBuilder.getMesh()),this._initMeshes(),this._api=e}Af.prototype={constructor:Af,extrudeY:!0,update:function(e,t,r,n,i){var a=e.getData();n==null&&(n=0),i==null&&(i=a.count()),this._startIndex=n,this._endIndex=i-1,this._triangulation(e,n,i);var o=this._getShader(e.get("shading"));this._prepareMesh(e,o,r,n,i),this.rootNode.updateWorldTransform(),this._updateRegionMesh(e,r,n,i);var s=e.coordinateSystem;s.type==="geo3D"&&this._updateGroundPlane(e,s,r);var l=this;this._labelsBuilder.updateData(a,n,i),this._labelsBuilder.getLabelPosition=function(u,h,f){var c=a.getName(u),d,v=f;if(s.type==="geo3D"){var p=s.getRegion(c);if(!p)return[NaN,NaN,NaN];d=p.getCenter();var g=s.dataToPoint([d[0],d[1],v]);return g}else var m=l._triangulationResults[u-l._startIndex],d=l.extrudeY?[(m.max[0]+m.min[0])/2,m.max[1]+v,(m.max[2]+m.min[2])/2]:[(m.max[0]+m.min[0])/2,(m.max[1]+m.min[1])/2,m.max[2]+v]},this._data=a,this._labelsBuilder.updateLabels(),this._updateDebugWireframe(e),this._lastHoverDataIndex=0},_initMeshes:function(){var e=this;function t(){var i=new U.Mesh({name:"Polygon",material:new U.Material({shader:e._shadersMap.lambert}),geometry:new U.Geometry({sortTriangles:!0,dynamic:!0}),culling:!1,ignorePicking:!0,renderNormal:!0});return Object.assign(i.geometry,hA),i}var r=t(),n=new U.Mesh({material:new U.Material({shader:this._linesShader}),castShadow:!1,ignorePicking:!0,$ignorePicking:!0,geometry:new Ys({useNativeLine:!1})});this.rootNode.add(r),this.rootNode.add(n),r.material.define("both","VERTEX_COLOR"),r.material.define("fragment","DOUBLE_SIDED"),this._polygonMesh=r,this._linesMesh=n,this.rootNode.add(this._groundMesh)},_getShader:function(e){var t=this._shadersMap[e];return t||(t=this._shadersMap.lambert),t.__shading=e,t},_prepareMesh:function(e,t,r,n,i){for(var a=0,o=0,s=0,l=0,u=n;u<i;u++){var h=this._getRegionPolygonInfo(u),f=this._getRegionLinesInfo(u,e,this._linesMesh.geometry);a+=h.vertexCount,o+=h.triangleCount,s+=f.vertexCount,l+=f.triangleCount}var c=this._polygonMesh,d=c.geometry;["position","normal","texcoord0","color"].forEach(function(v){d.attributes[v].init(a)}),d.indices=a>65535?new Uint32Array(o*3):new Uint16Array(o*3),c.material.shader!==t&&c.material.attachShader(t,!0),U.setMaterialFromModel(t.__shading,c.material,e,r),s>0&&(this._linesMesh.geometry.resetOffset(),this._linesMesh.geometry.setVertexCount(s),this._linesMesh.geometry.setTriangleCount(l)),this._dataIndexOfVertex=new Uint32Array(a),this._vertexRangeOfDataIndex=new Uint32Array((i-n)*2)},_updateRegionMesh:function(e,t,r,n){for(var i=e.getData(),a=0,o=0,s=!1,S=this._polygonMesh,l=this._linesMesh,u=r;u<n;u++){var h=e.getRegionModel(u),f=h.getModel("itemStyle"),c=Ee.firstNotNull(nn(i,u),f.get("color"),"#fff"),d=Ee.firstNotNull(tn(i,u),f.get("opacity"),1),v=U.parseColor(c),p=U.parseColor(f.get("borderColor"));v[3]*=d,p[3]*=d;var g=v[3]<.99;S.material.set("color",[1,1,1,1]),s=s||g;for(var m=Ee.firstNotNull(h.get("height",!0),e.get("regionHeight")),_=this._updatePolygonGeometry(e,S.geometry,u,m,a,o,v),y=a;y<_.vertexOffset;y++)this._dataIndexOfVertex[y]=u;this._vertexRangeOfDataIndex[(u-r)*2]=a,this._vertexRangeOfDataIndex[(u-r)*2+1]=_.vertexOffset,a=_.vertexOffset,o=_.triangleOffset;var x=f.get("borderWidth"),T=x>0;T&&(x*=t.getDevicePixelRatio(),this._updateLinesGeometry(l.geometry,e,u,m,x,e.coordinateSystem.transform)),l.invisible=!T,l.material.set({color:p})}var S=this._polygonMesh;S.material.transparent=s,S.material.depthMask=!s,S.geometry.updateBoundingBox(),S.frontFace=this.extrudeY?U.Mesh.CCW:U.Mesh.CW,S.material.get("normalMap")&&S.geometry.generateTangents(),S.seriesIndex=e.seriesIndex,S.on("mousemove",this._onmousemove,this),S.on("mouseout",this._onmouseout,this)},_updateDebugWireframe:function(e){var t=e.getModel("debug.wireframe");if(t.get("show")){var r=U.parseColor(t.get("lineStyle.color")||"rgba(0,0,0,0.5)"),n=Ee.firstNotNull(t.get("lineStyle.width"),1),i=this._polygonMesh;i.geometry.generateBarycentric(),i.material.define("both","WIREFRAME_TRIANGLE"),i.material.set("wireframeLineColor",r),i.material.set("wireframeLineWidth",n)}},_onmousemove:function(e){var t=this._dataIndexOfVertex[e.triangle[0]];t==null&&(t=-1),t!==this._lastHoverDataIndex&&(this.downplay(this._lastHoverDataIndex),this.highlight(t),this._labelsBuilder.updateLabels([t])),this._lastHoverDataIndex=t,this._polygonMesh.dataIndex=t},_onmouseout:function(e){e.target&&(this.downplay(this._lastHoverDataIndex),this._lastHoverDataIndex=-1,this._polygonMesh.dataIndex=-1),this._labelsBuilder.updateLabels([])},_updateGroundPlane:function(e,t,r){var n=e.getModel("groundPlane",e);if(this._groundMesh.invisible=!n.get("show",!0),!this._groundMesh.invisible){var i=e.get("shading"),a=this._groundMaterials[i];a||(a=this._groundMaterials.lambert),U.setMaterialFromModel(i,a,n,r),a.get("normalMap")&&this._groundMesh.geometry.generateTangents(),this._groundMesh.material=a,this._groundMesh.material.set("color",U.parseColor(n.get("color"))),this._groundMesh.scale.set(t.size[0],t.size[2],1)}},_triangulation:function(e,t,r){this._triangulationResults=[];for(var n=[1/0,1/0,1/0],i=[-1/0,-1/0,-1/0],a=e.coordinateSystem,o=t;o<r;o++){for(var s=[],l=e.getRegionPolygonCoords(o),u=0;u<l.length;u++){var h=l[u].exterior,f=l[u].interiors,c=[],d=[];if(!(h.length<3)){for(var v=0,p=0;p<h.length;p++){var g=h[p];c[v++]=g[0],c[v++]=g[1]}for(var p=0;p<f.length;p++)if(!(f[p].length<3)){for(var m=c.length/2,_=0;_<f[p].length;_++){var g=f[p][_];c.push(g[0]),c.push(g[1])}d.push(m)}for(var y=hG(c,d),x=new Float64Array(c.length/2*3),T=[],S=[1/0,1/0,1/0],M=[-1/0,-1/0,-1/0],w=0,p=0;p<c.length;)ti.set(T,c[p++],0,c[p++]),a&&a.transform&&ti.transformMat4(T,T,a.transform),ti.min(S,S,T),ti.max(M,M,T),x[w++]=T[0],x[w++]=T[1],x[w++]=T[2];ti.min(n,n,S),ti.max(i,i,M),s.push({points:x,indices:y,min:S,max:M})}}this._triangulationResults.push(s)}this._geoBoundingBox=[n,i]},_getRegionPolygonInfo:function(e){for(var t=this._triangulationResults[e-this._startIndex],r=0,n=0,i=0;i<t.length;i++)r+=t[i].points.length/3,n+=t[i].indices.length/3;var a=r*2+r*4,o=n*2+r*2;return{vertexCount:a,triangleCount:o}},_updatePolygonGeometry:function(e,t,r,n,i,a,o){var s=e.get("projectUVOnGround"),l=t.attributes.position,u=t.attributes.normal,h=t.attributes.texcoord0,f=t.attributes.color,c=this._triangulationResults[r-this._startIndex],d=f.value&&o,v=t.indices,p=this.extrudeY?1:2,g=this.extrudeY?2:1,m=[this.rootNode.worldTransform.x.len(),this.rootNode.worldTransform.y.len(),this.rootNode.worldTransform.z.len()],_=ti.mul([],this._geoBoundingBox[0],m),y=ti.mul([],this._geoBoundingBox[1],m),x=Math.max(y[0]-_[0],y[2]-_[2]);function T(tt,et,st){for(var nt=tt.points,dt=nt.length,At=[],G=[],Dt=0;Dt<dt;Dt+=3)At[0]=nt[Dt],At[p]=et,At[g]=nt[Dt+2],G[0]=(nt[Dt]*m[0]-_[0])/x,G[1]=(nt[Dt+2]*m[g]-_[2])/x,l.set(i,At),d&&f.set(i,o),h.set(i++,G)}function S(tt,et,st){var nt=i;T(tt,et);for(var dt=tt.indices.length,At=0;At<dt;At++)v[a*3+At]=tt.indices[At]+nt;a+=tt.indices.length/3}for(var M=this.extrudeY?[0,1,0]:[0,0,1],w=ti.negate([],M),b=0;b<c.length;b++){var A=i,E=c[b];S(E,0),S(E,n);for(var C=E.points.length/3,D=0;D<C;D++)u.set(A+D,w),u.set(A+D+C,M);for(var L=[0,3,1,1,3,2],P=[[],[],[],[]],N=[],O=[],I=[],k=[],z=0,D=0;D<C;D++){for(var X=(D+1)%C,Y=(E.points[X*3]-E.points[D*3])*m[0],$=(E.points[X*3+2]-E.points[D*3+2])*m[g],H=Math.sqrt(Y*Y+$*$),Z=0;Z<4;Z++){var ct=Z===0||Z===3,ut=(ct?D:X)*3;P[Z][0]=E.points[ut],P[Z][p]=Z>1?n:0,P[Z][g]=E.points[ut+2],l.set(i+Z,P[Z]),s?(k[0]=(E.points[ut]*m[0]-_[0])/x,k[1]=(E.points[ut+2]*m[g]-_[g])/x):(k[0]=(ct?z:z+H)/x,k[1]=(P[Z][p]*m[p]-_[p])/x),h.set(i+Z,k)}ti.sub(N,P[1],P[0]),ti.sub(O,P[3],P[0]),ti.cross(I,N,O),ti.normalize(I,I);for(var Z=0;Z<4;Z++)u.set(i+Z,I),d&&f.set(i+Z,o);for(var Z=0;Z<6;Z++)v[a*3+Z]=L[Z]+i;i+=4,a+=2,z+=H}}return t.dirty(),{vertexOffset:i,triangleOffset:a}},_getRegionLinesInfo:function(e,t,r){var n=0,i=0,a=t.getRegionModel(e),o=a.getModel("itemStyle"),s=o.get("borderWidth");if(s>0){var l=t.getRegionPolygonCoords(e);l.forEach(function(u){var h=u.exterior,f=u.interiors;n+=r.getPolylineVertexCount(h),i+=r.getPolylineTriangleCount(h);for(var c=0;c<f.length;c++)n+=r.getPolylineVertexCount(f[c]),i+=r.getPolylineTriangleCount(f[c])},this)}return{vertexCount:n,triangleCount:i}},_updateLinesGeometry:function(e,t,r,n,i,a){function o(u){for(var h=new Float64Array(u.length*3),f=0,c=[],d=0;d<u.length;d++)c[0]=u[d][0],c[1]=n+.1,c[2]=u[d][1],a&&ti.transformMat4(c,c,a),h[f++]=c[0],h[f++]=c[1],h[f++]=c[2];return h}var s=[1,1,1,1],l=t.getRegionPolygonCoords(r);l.forEach(function(u){var h=u.exterior,f=u.interiors;e.addPolyline(o(h),s,i);for(var c=0;c<f.length;c++)e.addPolyline(o(f[c]),s,i)})},highlight:function(e){var t=this._data;if(t){var r=t.getItemModel(e),n=r.getModel(["emphasis","itemStyle"]),i=n.get("color"),a=Ee.firstNotNull(n.get("opacity"),tn(t,e),1);if(i==null){var o=nn(t,e);i=uf(o,-.4)}a==null&&(a=tn(t,e));var s=U.parseColor(i);s[3]*=a,this._setColorOfDataIndex(t,e,s)}},downplay:function(e){var t=this._data;if(t){var r=t.getItemModel(e),n=Ee.firstNotNull(nn(t,e),r.get(["itemStyle","color"]),"#fff"),i=Ee.firstNotNull(tn(t,e),r.get(["itemStyle","opacity"]),1),a=U.parseColor(n);a[3]*=i,this._setColorOfDataIndex(t,e,a)}},dispose:function(){this._labelsBuilder.dispose()},_setColorOfDataIndex:function(e,t,r){if(!(t<this._startIndex&&t>this._endIndex)){t-=this._startIndex;for(var n=this._vertexRangeOfDataIndex[t*2];n<this._vertexRangeOfDataIndex[t*2+1];n++)this._polygonMesh.geometry.attributes.color.set(n,r);this._polygonMesh.geometry.dirty(),this._api.getZr().refresh()}}};const est=nr.extend({type:"geo3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new Af(t),this.groupGL=new U.Node,this._lightRoot=new U.Node,this._sceneHelper=new ks(this._lightRoot),this._sceneHelper.initLight(this._lightRoot),this._control=new zv({zr:t.getZr()}),this._control.init()},render:function(e,t,r){this.groupGL.add(this._geo3DBuilder.rootNode);var n=e.coordinateSystem;if(!(!n||!n.viewGL)){n.viewGL.add(this._lightRoot),e.get("show")?n.viewGL.add(this.groupGL):n.viewGL.remove(this.groupGL);var i=this._control;i.setViewGL(n.viewGL);var a=e.getModel("viewControl");i.setFromViewControlModel(a,0),this._sceneHelper.setScene(n.viewGL.scene),this._sceneHelper.updateLight(e),n.viewGL.setPostEffect(e.getModel("postEffect"),r),n.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._geo3DBuilder.update(e,t,r,0,e.getData().count());var o=n.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse(function(s){s.material&&s.material[o]("fragment","SRGB_DECODE")}),i.off("update"),i.on("update",function(){r.dispatchAction({type:"geo3DChangeCamera",alpha:i.getAlpha(),beta:i.getBeta(),distance:i.getDistance(),center:i.getCenter(),from:this.uid,geo3DId:e.id})}),i.update()}},afterRender:function(e,t,r,n){var i=n.renderer;this._sceneHelper.updateAmbientCubemap(i,e,r),this._sceneHelper.updateSkybox(i,e,r)},dispose:function(){this._control.dispose(),this._geo3DBuilder.dispose()}});var rst={Russia:[100,60],"United States":[-99,38],"United States of America":[-99,38]};function nst(e,t){if(e==="world"){var r=rst[t.name];if(r){var n=[r[0],r[1]];t.setCenter(n)}}}var ist=Or.vec3,$h=Or.mat4,ast=[xU,nst];function d_(e,t,r,n,i){this.name=e,this.map=t,this.regionHeight=0,this.regions=[],this._nameCoordMap={},this.loadGeoJson(r,n,i),this.transform=$h.identity(new Float64Array(16)),this.invTransform=$h.identity(new Float64Array(16)),this.extrudeY=!0,this.altitudeAxis}d_.prototype={constructor:d_,type:"geo3D",dimensions:["lng","lat","alt"],containPoint:function(){},loadGeoJson:function(e,t,r){var n=vB;try{this.regions=e?n(e):[]}catch(u){throw`Invalid geoJson format
`+u}t=t||{},r=r||{};for(var i=this.regions,a={},o=0;o<i.length;o++){var s=i[o].name;s=r[s]||s,i[o].name=s,a[s]=i[o],this.addGeoCoord(s,i[o].getCenter());var l=t[s];l&&i[o].transformTo(l.left,l.top,l.width,l.height)}this._regionsMap=a,this._geoRect=null,ast.forEach(function(u){u(this)},this)},getGeoBoundingRect:function(){if(this._geoRect)return this._geoRect;for(var e,t=this.regions,r=0;r<t.length;r++){var n=t[r].getBoundingRect();e=e||n.clone(),e.union(n)}return this._geoRect=e||new fe(0,0,0,0)},addGeoCoord:function(e,t){this._nameCoordMap[e]=t},getRegion:function(e){return this._regionsMap[e]},getRegionByCoord:function(e){for(var t=this.regions,r=0;r<t.length;r++)if(t[r].contain(e))return t[r]},setSize:function(e,t,r){this.size=[e,t,r];var n=this.getGeoBoundingRect(),i=e/n.width,a=-r/n.height,o=-e/2-n.x*i,s=r/2-n.y*a,l=this.extrudeY?[o,0,s]:[o,s,0],u=this.extrudeY?[i,1,a]:[i,a,1],h=this.transform;$h.identity(h),$h.translate(h,h,l),$h.scale(h,h,u),$h.invert(this.invTransform,h)},dataToPoint:function(e,t){t=t||[];var r=this.extrudeY?1:2,n=this.extrudeY?2:1,i=e[2];return isNaN(i)&&(i=0),t[0]=e[0],t[n]=e[1],this.altitudeAxis?t[r]=this.altitudeAxis.dataToCoord(i):t[r]=0,t[r]+=this.regionHeight,ist.transformMat4(t,t,this.transform),t},pointToData:function(e,t){}};function ost(e,t){var r=e.getBoxLayoutParams(),n=Mr(r,{width:t.getWidth(),height:t.getHeight()});n.y=t.getHeight()-n.y-n.height,this.viewGL.setViewport(n.x,n.y,n.width,n.height,t.getDevicePixelRatio());var i=this.getGeoBoundingRect(),a=i.width/i.height*(e.get("aspectScale")||.75),o=e.get("boxWidth"),s=e.get("boxDepth"),l=e.get("boxHeight");l==null&&(l=5),isNaN(o)&&isNaN(s)&&(o=100),isNaN(s)?s=o/a:isNaN(o)&&(o=s/a),this.setSize(o,l,s),this.regionHeight=e.get("regionHeight"),this.altitudeAxis&&this.altitudeAxis.setExtent(0,Math.max(l-this.regionHeight,0))}function sst(e,t){var r=[1/0,-1/0];if(e.eachSeries(function(i){if(i.coordinateSystem===this&&i.type!=="series.map3D"){var a=i.getData(),o=i.coordDimToDataDim("alt"),s=o&&o[0];if(s){var l=a.getDataExtent(s,!0);r[0]=Math.min(r[0],l[0]),r[1]=Math.max(r[1],l[1])}}},this),isFinite(r[1]-r[0])){var n=Yw(r,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new Kn("altitude",n),this.resize(this.model,t)}}var DI=0,fA={dimensions:d_.prototype.dimensions,create:function(e,t){var r=[];if(!ZS)throw new Error("geo3D component depends on geo component");function n(i,a){var o=fA.createGeo3D(i);i.__viewGL=i.__viewGL||new rr,o.viewGL=i.__viewGL,i.coordinateSystem=o,o.model=i,r.push(o),o.resize=ost,o.resize(i,t),o.update=sst}return e.eachComponent("geo3D",function(i,a){n(i)}),e.eachSeriesByType("map3D",function(i,a){var o=i.get("coordinateSystem");o==null&&(o="geo3D"),o==="geo3D"&&n(i)}),e.eachSeries(function(i){if(i.get("coordinateSystem")==="geo3D"){if(i.type==="series.map3D")return;var a=i.getReferringComponents("geo3D").models[0];if(a||(a=e.getComponent("geo3D")),!a)throw new Error('geo "'+Ee.firstNotNull(i.get("geo3DIndex"),i.get("geo3DId"),0)+'" not found');i.coordinateSystem=a.coordinateSystem}}),r},createGeo3D:function(e){var t=e.get("map"),r;return typeof t=="string"?(r=t,t=ZS(t)):t&&t.features&&(t={geoJson:t}),r==null&&(r="GEO_ANONYMOUS_"+DI++),new d_(r+DI++,r,t&&t.geoJson,t&&t.specialAreas,e.get("nameMap"))}};function mG(e){e.registerComponentModel(ic),e.registerComponentView(est),e.registerAction({type:"geo3DChangeCamera",event:"geo3dcamerachanged",update:"series:updateCamera"},function(t,r){r.eachComponent({mainType:"geo3D",query:t},function(n){n.setView(t)})}),e.registerCoordinateSystem("geo3D",fA)}te(mG);function LI(e,t){e.id=e.id||e.name||t+""}var Lu=me.extend({type:"globe",layoutMode:"box",coordinateSystem:null,init:function(){Lu.superApply(this,"init",arguments),R(this.option.layers,function(e,t){Ot(e,this.defaultLayerOption),LI(e,t)},this)},mergeOption:function(e){var t=this.option.layers;this.option.layers=null,Lu.superApply(this,"mergeOption",arguments);function r(o){return ma(o,function(s,l,u){return LI(l,u),s[l.id]=l,s},{})}if(t&&t.length){var n=r(e.layers),i=r(t);for(var a in n)i[a]?Ot(i[a],n[a],!0):t.push(e.layers[a]);this.option.layers=t}R(this.option.layers,function(o){Ot(o,this.defaultLayerOption)},this)},optionUpdated:function(){this.updateDisplacementHash()},defaultLayerOption:{show:!0,type:"overlay"},defaultOption:{show:!0,zlevel:-10,left:0,top:0,width:"100%",height:"100%",environment:"auto",baseColor:"#fff",baseTexture:"",heightTexture:"",displacementTexture:"",displacementScale:0,displacementQuality:"medium",globeRadius:100,globeOuterRadius:150,shading:"lambert",light:{main:{time:""}},atmosphere:{show:!1,offset:5,color:"#ffffff",glowPower:6,innerGlowPower:2},viewControl:{autoRotate:!0,panSensitivity:0,targetCoord:null},layers:[]},setDisplacementData:function(e,t,r){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=r},getDisplacementTexture:function(){return this.get("displacementTexture")||this.get("heightTexture")},getDisplacemenScale:function(){var e=this.getDisplacementTexture(),t=this.get("displacementScale");return(!e||e==="none")&&(t=0),t},hasDisplacement:function(){return this.getDisplacemenScale()>0},_displacementChanged:!0,_displacementScale:0,updateDisplacementHash:function(){var e=this.getDisplacementTexture(),t=this.getDisplacemenScale();this._displacementChanged=this._displacementTexture!==e||this._displacementScale!==t,this._displacementTexture=e,this._displacementScale=t},isDisplacementChanged:function(){return this._displacementChanged}});Ot(Lu.prototype,f0);Ot(Lu.prototype,tc);Ot(Lu.prototype,ec);Ot(Lu.prototype,nc);var _G=Math.PI,Wi=Math.sin,Co=Math.cos,yG=Math.tan,xG=Math.asin,SG=Math.atan2,Ru=_G/180,lst=1e3*60*60*24,ust=2440588,hst=2451545;function fst(e){return e.valueOf()/lst-.5+ust}function cst(e){return fst(e)-hst}var v_=Ru*23.4397;function dst(e,t){return SG(Wi(e)*Co(v_)-yG(t)*Wi(v_),Co(e))}function vst(e,t){return xG(Wi(t)*Co(v_)+Co(t)*Wi(v_)*Wi(e))}function pst(e,t,r){return SG(Wi(e),Co(e)*Wi(t)-yG(r)*Co(t))}function gst(e,t,r){return xG(Wi(t)*Wi(r)+Co(t)*Co(r)*Co(e))}function mst(e,t){return Ru*(280.16+360.9856235*e)-t}function _st(e){return Ru*(357.5291+.98560028*e)}function yst(e){var t=Ru*(1.9148*Wi(e)+.02*Wi(2*e)+3e-4*Wi(3*e)),r=Ru*102.9372;return e+t+r+_G}function xst(e){var t=_st(e),r=yst(t);return{dec:vst(r,0),ra:dst(r,0)}}var TG={};TG.getPosition=function(e,t,r){var n=Ru*-r,i=Ru*t,a=cst(e),o=xst(a),s=mst(a,n)-o.ra;return{azimuth:pst(s,i,o.dec),altitude:gst(s,i,o.dec)}};const Sst=`@export ecgl.atmosphere.vertex
attribute vec3 position: POSITION;
attribute vec3 normal : NORMAL;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform mat4 normalMatrix : WORLDINVERSETRANSPOSE;

varying vec3 v_Normal;

void main() {
 v_Normal = normalize((normalMatrix * vec4(normal, 0.0)).xyz);
 gl_Position = worldViewProjection * vec4(position, 1.0);
}
@end


@export ecgl.atmosphere.fragment
uniform mat4 viewTranspose: VIEWTRANSPOSE;
uniform float glowPower;
uniform vec3 glowColor;

varying vec3 v_Normal;

void main() {
 float intensity = pow(1.0 - dot(v_Normal, (viewTranspose * vec4(0.0, 0.0, 1.0, 0.0)).xyz), glowPower);
 gl_FragColor = vec4(glowColor, intensity * intensity);
}
@end`;U.Shader.import(Gk);U.Shader.import(Sst);const Tst=nr.extend({type:"globe",__ecgl__:!0,_displacementScale:0,init:function(e,t){this.groupGL=new U.Node,this._sphereGeometry=new U.SphereGeometry({widthSegments:200,heightSegments:100,dynamic:!0}),this._overlayGeometry=new U.SphereGeometry({widthSegments:80,heightSegments:40}),this._planeGeometry=new U.PlaneGeometry,this._earthMesh=new U.Mesh({renderNormal:!0}),this._atmosphereMesh=new U.Mesh,this._atmosphereGeometry=new U.SphereGeometry({widthSegments:80,heightSegments:40}),this._atmosphereMaterial=new U.Material({shader:new U.Shader(U.Shader.source("ecgl.atmosphere.vertex"),U.Shader.source("ecgl.atmosphere.fragment")),transparent:!0}),this._atmosphereMesh.geometry=this._atmosphereGeometry,this._atmosphereMesh.material=this._atmosphereMaterial,this._atmosphereMesh.frontFace=U.Mesh.CW,this._lightRoot=new U.Node,this._sceneHelper=new ks,this._sceneHelper.initLight(this._lightRoot),this.groupGL.add(this._atmosphereMesh),this.groupGL.add(this._earthMesh),this._control=new zv({zr:t.getZr()}),this._control.init(),this._layerMeshes={}},render:function(e,t,r){var n=e.coordinateSystem,i=e.get("shading");n.viewGL.add(this._lightRoot),e.get("show")?n.viewGL.add(this.groupGL):n.viewGL.remove(this.groupGL),this._sceneHelper.setScene(n.viewGL.scene),n.viewGL.setPostEffect(e.getModel("postEffect"),r),n.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var a=this._earthMesh;a.geometry=this._sphereGeometry;var o="ecgl."+i;(!a.material||a.material.shader.name!==o)&&(a.material=U.createMaterial(o)),U.setMaterialFromModel(i,a.material,e,r),["roughnessMap","metalnessMap","detailMap","normalMap"].forEach(function(f){var c=a.material.get(f);c&&(c.flipY=!1)}),a.material.set("color",U.parseColor(e.get("baseColor")));var s=n.radius*.99;if(a.scale.set(s,s,s),e.get("atmosphere.show")){a.material.define("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!1,this._atmosphereMaterial.setUniforms({glowPower:e.get("atmosphere.glowPower")||6,glowColor:e.get("atmosphere.color")||"#ffffff"}),a.material.setUniforms({glowPower:e.get("atmosphere.innerGlowPower")||2,glowColor:e.get("atmosphere.color")||"#ffffff"});var l=e.get("atmosphere.offset")||5;this._atmosphereMesh.scale.set(s+l,s+l,s+l)}else a.material.undefine("both","ATMOSPHERE_ENABLED"),this._atmosphereMesh.invisible=!0;var u=a.material.setTextureImage("diffuseMap",e.get("baseTexture"),r,{flipY:!1,anisotropic:8});u&&u.surface&&u.surface.attachToMesh(a);var h=a.material.setTextureImage("bumpMap",e.get("heightTexture"),r,{flipY:!1,anisotropic:8});h&&h.surface&&h.surface.attachToMesh(a),a.material[e.get("postEffect.enable")?"define":"undefine"]("fragment","SRGB_DECODE"),this._updateLight(e,r),this._displaceVertices(e,r),this._updateViewControl(e,r),this._updateLayers(e,r)},afterRender:function(e,t,r,n){var i=n.renderer;this._sceneHelper.updateAmbientCubemap(i,e,r),this._sceneHelper.updateSkybox(i,e,r)},_updateLayers:function(e,t){var r=e.coordinateSystem,n=e.get("layers"),i=r.radius,a=[],o=[],s=[],l=[];R(n,function(d){var v=new Ie(d),p=v.get("type"),g=U.loadTexture(v.get("texture"),t,{flipY:!1,anisotropic:8});if(g.surface&&g.surface.attachToMesh(this._earthMesh),p==="blend"){var m=v.get("blendTo"),_=Ee.firstNotNull(v.get("intensity"),1);m==="emission"?(s.push(g),l.push(_)):(a.push(g),o.push(_))}else{var y=v.get("id"),x=this._layerMeshes[y];x||(x=this._layerMeshes[y]=new U.Mesh({geometry:this._overlayGeometry,castShadow:!1,ignorePicking:!0}));var T=v.get("shading");T==="lambert"?(x.material=x.__lambertMaterial||new U.Material({autoUpdateTextureStatus:!1,shader:U.createShader("ecgl.lambert"),transparent:!0,depthMask:!1}),x.__lambertMaterial=x.material):(x.material=x.__colorMaterial||new U.Material({autoUpdateTextureStatus:!1,shader:U.createShader("ecgl.color"),transparent:!0,depthMask:!1}),x.__colorMaterial=x.material),x.material.enableTexture("diffuseMap");var S=v.get("distance"),M=i+(S??r.radius/100);x.scale.set(M,M,M),i=M;var w=this._blankTexture||(this._blankTexture=U.createBlankTexture("rgba(255, 255, 255, 0)"));x.material.set("diffuseMap",w),U.loadTexture(v.get("texture"),t,{flipY:!1,anisotropic:8},function(b){b.surface&&b.surface.attachToMesh(x),x.material.set("diffuseMap",b),t.getZr().refresh()}),v.get("show")?this.groupGL.add(x):this.groupGL.remove(x)}},this);var u=this._earthMesh.material;u.define("fragment","LAYER_DIFFUSEMAP_COUNT",a.length),u.define("fragment","LAYER_EMISSIVEMAP_COUNT",s.length),u.set("layerDiffuseMap",a),u.set("layerDiffuseIntensity",o),u.set("layerEmissiveMap",s),u.set("layerEmissionIntensity",l);var h=e.getModel("debug.wireframe");if(h.get("show")){u.define("both","WIREFRAME_TRIANGLE");var f=U.parseColor(h.get("lineStyle.color")||"rgba(0,0,0,0.5)"),c=Ee.firstNotNull(h.get("lineStyle.width"),1);u.set("wireframeLineWidth",c),u.set("wireframeLineColor",f)}else u.undefine("both","WIREFRAME_TRIANGLE")},_updateViewControl:function(e,t){var r=e.coordinateSystem,n=e.getModel("viewControl");r.viewGL.camera;var i=this;function a(){return{type:"globeChangeCamera",alpha:o.getAlpha(),beta:o.getBeta(),distance:o.getDistance()-r.radius,center:o.getCenter(),from:i.uid,globeId:e.id}}var o=this._control;o.setViewGL(r.viewGL);var s=n.get("targetCoord"),l,u;s!=null&&(u=s[0]+90,l=s[1]),o.setFromViewControlModel(n,{baseDistance:r.radius,alpha:l,beta:u}),o.off("update"),o.on("update",function(){t.dispatchAction(a())})},_displaceVertices:function(e,t){var r=e.get("displacementQuality"),n=e.get("debug.wireframe.show"),i=e.coordinateSystem;if(!(!e.isDisplacementChanged()&&r===this._displacementQuality&&n===this._showDebugWireframe)){this._displacementQuality=r,this._showDebugWireframe=n;var a=this._sphereGeometry,o={low:100,medium:200,high:400,ultra:800}[r]||200,s=o/2;(a.widthSegments!==o||n)&&(a.widthSegments=o,a.heightSegments=s,a.build()),this._doDisplaceVertices(a,i),n&&a.generateBarycentric()}},_doDisplaceVertices:function(e,t){var r=e.attributes.position.value,n=e.attributes.texcoord0.value,i=e.__originalPosition;(!i||i.length!==r.length)&&(i=new Float32Array(r.length),i.set(r),e.__originalPosition=i);for(var a=t.displacementWidth,o=t.displacementHeight,s=t.displacementData,l=0;l<e.vertexCount;l++){var u=l*3,h=l*2,f=i[u+1],c=i[u+2],d=i[u+3],v=n[h++],p=n[h++],g=Math.round(v*(a-1)),m=Math.round(p*(o-1)),_=m*a+g,y=s?s[_]:0;r[u+1]=f+f*y,r[u+2]=c+c*y,r[u+3]=d+d*y}e.generateVertexNormals(),e.dirty(),e.updateBoundingBox()},_updateLight:function(e,t){var r=this._earthMesh;this._sceneHelper.updateLight(e);var n=this._sceneHelper.mainLight,i=e.get("light.main.time")||new Date,a=TG.getPosition(Xi(i),0,0),o=Math.cos(a.altitude);n.position.y=-o*Math.cos(a.azimuth),n.position.x=Math.sin(a.altitude),n.position.z=o*Math.sin(a.azimuth),n.lookAt(r.getWorldPosition())},dispose:function(e,t){this.groupGL.removeAll(),this._control.dispose()}});var bst=Or.vec3;function p_(e){this.radius=e,this.viewGL=null,this.altitudeAxis,this.displacementData=null,this.displacementWidth,this.displacementHeight}p_.prototype={constructor:p_,dimensions:["lng","lat","alt"],type:"globe",containPoint:function(){},setDisplacementData:function(e,t,r){this.displacementData=e,this.displacementWidth=t,this.displacementHeight=r},_getDisplacementScale:function(e,t){var r=(e+180)/360*(this.displacementWidth-1),n=(90-t)/180*(this.displacementHeight-1),i=Math.round(r)+Math.round(n)*this.displacementWidth;return this.displacementData[i]},dataToPoint:function(e,t){var r=e[0],n=e[1],i=e[2]||0,a=this.radius;this.displacementData&&(a*=1+this._getDisplacementScale(r,n)),this.altitudeAxis&&(a+=this.altitudeAxis.dataToCoord(i)),r=r*Math.PI/180,n=n*Math.PI/180;var o=Math.cos(n)*a;return t=t||[],t[0]=-o*Math.cos(r+Math.PI),t[1]=Math.sin(n)*a,t[2]=o*Math.sin(r+Math.PI),t},pointToData:function(e,t){var r=e[0],n=e[1],i=e[2],a=bst.len(e);r/=a,n/=a,i/=a;var o=Math.asin(n),s=Math.atan2(i,-r);s<0&&(s=Math.PI*2+s);var l=o*180/Math.PI,u=s*180/Math.PI-180;return t=t||[],t[0]=u,t[1]=l,t[2]=a-this.radius,this.altitudeAxis&&(t[2]=this.altitudeAxis.coordToData(t[2])),t}};function wst(e,t){var r=document.createElement("canvas"),n=r.getContext("2d"),i=e.width,a=e.height;r.width=i,r.height=a,n.drawImage(e,0,0,i,a);for(var o=n.getImageData(0,0,i,a).data,s=new Float32Array(o.length/4),l=0;l<o.length/4;l++){var u=o[l*4];s[l]=u/255*t}return{data:s,width:i,height:a}}function Mst(e,t){var r=e.getBoxLayoutParams(),n=Mr(r,{width:t.getWidth(),height:t.getHeight()});n.y=t.getHeight()-n.y-n.height,this.viewGL.setViewport(n.x,n.y,n.width,n.height,t.getDevicePixelRatio()),this.radius=e.get("globeRadius");var i=e.get("globeOuterRadius");this.altitudeAxis&&this.altitudeAxis.setExtent(0,i-this.radius)}function Ast(e,t){var r=[1/0,-1/0];if(e.eachSeries(function(i){if(i.coordinateSystem===this){var a=i.getData(),o=i.coordDimToDataDim("alt"),s=o&&o[0];if(s){var l=a.getDataExtent(s,!0);r[0]=Math.min(r[0],l[0]),r[1]=Math.max(r[1],l[1])}}},this),isFinite(r[1]-r[0])){var n=Yw(r,{type:"value",min:"dataMin",max:"dataMax"});this.altitudeAxis=new Kn("altitude",n),this.resize(this.model,t)}}var Est={dimensions:p_.prototype.dimensions,create:function(e,t){var r=[];return e.eachComponent("globe",function(n){n.__viewGL=n.__viewGL||new rr;var i=new p_;i.viewGL=n.__viewGL,n.coordinateSystem=i,i.model=n,r.push(i),i.resize=Mst,i.resize(n,t),i.update=Ast}),e.eachSeries(function(n){if(n.get("coordinateSystem")==="globe"){var i=n.getReferringComponents("globe").models[0];if(i||(i=e.getComponent("globe")),!i)throw new Error('globe "'+Ee.firstNotNull(n.get("globe3DIndex"),n.get("globe3DId"),0)+'" not found');var a=i.coordinateSystem;n.coordinateSystem=a}}),e.eachComponent("globe",function(n,i){var a=n.coordinateSystem,o=n.getDisplacementTexture(),s=n.getDisplacemenScale();if(n.isDisplacementChanged()){if(n.hasDisplacement()){var l=!0;U.loadTexture(o,t,function(u){var h=u.image,f=wst(h,s);n.setDisplacementData(f.data,f.width,f.height),l||t.dispatchAction({type:"globeUpdateDisplacment"})}),l=!1}else a.setDisplacementData(null,0,0);a.setDisplacementData(n.displacementData,n.displacementWidth,n.displacementHeight)}}),r}};function Cst(e){e.registerComponentModel(Lu),e.registerComponentView(Tst),e.registerCoordinateSystem("globe",Est),e.registerAction({type:"globeChangeCamera",event:"globecamerachanged",update:"series:updateCamera"},function(t,r){r.eachComponent({mainType:"globe",query:t},function(n){n.setView(t)})}),e.registerAction({type:"globeUpdateDisplacment",event:"globedisplacementupdated",update:"update"},function(t,r){})}te(Cst);var RI=["zoom","center","pitch","bearing"],cA=me.extend({type:"mapbox3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,style:"mapbox://styles/mapbox/light-v9",center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMapboxCameraOption:function(){var e=this;return RI.reduce(function(t,r){return t[r]=e.get(r),t},{})},setMapboxCameraOption:function(e){e!=null&&RI.forEach(function(t){e[t]!=null&&(this.option[t]=e[t])},this)},getMapbox:function(){return this._mapbox},setMapbox:function(e){this._mapbox=e}});Ot(cA.prototype,tc);Ot(cA.prototype,ec);function Zs(e,t){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!mapboxgl)throw new Error("Mapbox GL library must be included. See https://www.mapbox.com/mapbox-gl-js/api/");this._mapbox=new mapboxgl.Map({container:this.dom}),this._initEvents()}Zs.prototype.setUnpainted=function(){};Zs.prototype.resize=function(){this._mapbox.resize()};Zs.prototype.getMapbox=function(){return this._mapbox};Zs.prototype.clear=function(){};Zs.prototype.refresh=function(){this._mapbox.resize()};var bG=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","wheel","touchstart","touchend","touchmove","touchcancel"];Zs.prototype._initEvents=function(){var e=this._mapbox.getCanvasContainer();this._handlers=this._handlers||{contextmenu:function(t){return t.preventDefault(),!1}},bG.forEach(function(t){this._handlers[t]=function(r){var n={};for(var i in r)n[i]=r[i];n.bubbles=!1;var a=new r.constructor(r.type,n);e.dispatchEvent(a)},this.zr.dom.addEventListener(t,this._handlers[t])},this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)};Zs.prototype.dispose=function(){bG.forEach(function(e){this.zr.dom.removeEventListener(e,this._handlers[e])},this)};const wG=`
@export ecgl.displayShadow.vertex

@import ecgl.common.transformUniforms

@import ecgl.common.uv.header

@import ecgl.common.attributes

varying vec3 v_WorldPosition;

varying vec3 v_Normal;

void main()
{
 @import ecgl.common.uv.main
 v_Normal = normalize((worldInverseTranspose * vec4(normal, 0.0)).xyz);

 v_WorldPosition = (world * vec4(position, 1.0)).xyz;
 gl_Position = worldViewProjection * vec4(position, 1.0);
}

@end


@export ecgl.displayShadow.fragment

@import ecgl.common.uv.fragmentHeader

varying vec3 v_Normal;
varying vec3 v_WorldPosition;

uniform float roughness: 0.2;

#ifdef DIRECTIONAL_LIGHT_COUNT
@import clay.header.directional_light
#endif

@import ecgl.common.ssaoMap.header

@import clay.plugin.compute_shadow_map

void main()
{
 float shadow = 1.0;

 @import ecgl.common.ssaoMap.main

#if defined(DIRECTIONAL_LIGHT_COUNT) && defined(DIRECTIONAL_LIGHT_SHADOWMAP_COUNT)
 float shadowContribsDir[DIRECTIONAL_LIGHT_COUNT];
 if(shadowEnabled)
 {
 computeShadowOfDirectionalLights(v_WorldPosition, shadowContribsDir);
 }
 for (int i = 0; i < DIRECTIONAL_LIGHT_COUNT; i++) {
 shadow = min(shadow, shadowContribsDir[i] * 0.5 + 0.5);
 }
#endif

 shadow *= 0.5 + ao * 0.5;
 shadow = clamp(shadow, 0.0, 1.0);

 gl_FragColor = vec4(vec3(0.0), 1.0 - shadow);
}

@end`;U.Shader.import(wG);const Dst=nr.extend({type:"mapbox3D",__ecgl__:!0,init:function(e,t){var r=t.getZr();this._zrLayer=new Zs("mapbox3D",r),r.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new U.Node,this._sceneHelper=new ks(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var n=this._zrLayer.getMapbox(),i=this._dispatchInteractAction.bind(this,t,n);["zoom","rotate","drag","pitch","rotate","move"].forEach(function(a){n.on(a,i)}),this._groundMesh=new U.Mesh({geometry:new U.PlaneGeometry,material:new U.Material({shader:new U.Shader({vertex:U.Shader.source("ecgl.displayShadow.vertex"),fragment:U.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},render:function(e,t,r){var n=this._zrLayer.getMapbox(),i=e.get("style"),a=JSON.stringify(i);a!==this._oldStyleStr&&i&&n.setStyle(i),this._oldStyleStr=a,n.setCenter(e.get("center")),n.setZoom(e.get("zoom")),n.setPitch(e.get("pitch")),n.setBearing(e.get("bearing")),e.setMapbox(n);var o=e.coordinateSystem;o.viewGL.scene.add(this._lightRoot),o.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(o.viewGL.scene),this._sceneHelper.updateLight(e),o.viewGL.setPostEffect(e.getModel("postEffect"),r),o.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._mapbox3DModel=e},afterRender:function(e,t,r,n){var i=n.renderer;this._sceneHelper.updateAmbientCubemap(i,e,r),this._sceneHelper.updateSkybox(i,e,r),e.coordinateSystem.viewGL.scene.traverse(function(a){a.material&&(a.material.define("fragment","NORMAL_UP_AXIS",2),a.material.define("fragment","NORMAL_FRONT_AXIS",1))})},updateCamera:function(e,t,r,n){e.coordinateSystem.setCameraOption(n),this._updateGroundMesh(),r.getZr().refresh()},_dispatchInteractAction:function(e,t,r){e.dispatchAction({type:"mapbox3DChangeCamera",pitch:t.getPitch(),zoom:t.getZoom(),center:t.getCenter().toArray(),bearing:t.getBearing(),mapbox3DId:this._mapbox3DModel&&this._mapbox3DModel.id})},_updateGroundMesh:function(){if(this._mapbox3DModel){var e=this._mapbox3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var r=new U.Plane(new U.Vector3(0,0,1),0),n=e.viewGL.camera.castRay(new U.Vector2(-1,-1)),i=e.viewGL.camera.castRay(new U.Vector2(1,1)),a=n.intersectPlane(r),o=i.intersectPlane(r),s=a.dist(o)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}});var ns=Or.mat4,Xc=512,v1=.6435011087932844,ei=Math.PI,wh=1/10;function Ef(){this.width=0,this.height=0,this.altitudeScale=1,this.boxHeight="auto",this.altitudeExtent,this.bearing=0,this.pitch=0,this.center=[0,0],this._origin,this.zoom=0,this._initialZoom,this.maxPitch=60,this.zoomOffset=0}Ef.prototype={constructor:Ef,dimensions:["lng","lat","alt"],containPoint:function(){},setCameraOption:function(e){this.bearing=e.bearing,this.pitch=e.pitch,this.center=e.center,this.zoom=e.zoom,this._origin||(this._origin=this.projectOnTileWithScale(this.center,Xc)),this._initialZoom==null&&(this._initialZoom=this.zoom),this.updateTransform()},updateTransform:function(){if(this.height){var e=.5/Math.tan(v1/2)*this.height*wh,t=Math.max(Math.min(this.pitch,this.maxPitch),0)/180*Math.PI,r=v1/2,n=Math.PI/2+t,i=Math.sin(r)*e/Math.sin(Math.PI-n-r),a=Math.cos(Math.PI/2-t)*i+e,o=a*1.1;this.pitch>50&&(o=1e3);var s=[];ns.perspective(s,v1,this.width/this.height,1,o),this.viewGL.camera.projectionMatrix.setArray(s),this.viewGL.camera.decomposeProjectionMatrix();var s=ns.identity([]),l=this.dataToPoint(this.center);ns.scale(s,s,[1,-1,1]),ns.translate(s,s,[0,0,-e]),ns.rotateX(s,s,t),ns.rotateZ(s,s,-this.bearing/180*Math.PI),ns.translate(s,s,[-l[0]*this.getScale()*wh,-l[1]*this.getScale()*wh,0]),this.viewGL.camera.viewMatrix.array=s;var u=[];ns.invert(u,s),this.viewGL.camera.worldTransform.array=u,this.viewGL.camera.decomposeWorldTransform();var h=Xc*this.getScale(),f;if(this.altitudeExtent&&!isNaN(this.boxHeight)){var c=this.altitudeExtent[1]-this.altitudeExtent[0];f=this.boxHeight/c*this.getScale()/Math.pow(2,this._initialZoom-this.zoomOffset)}else f=h/(2*Math.PI*6378e3*Math.abs(Math.cos(this.center[1]*(Math.PI/180))))*this.altitudeScale*wh;this.viewGL.rootNode.scale.set(this.getScale()*wh,this.getScale()*wh,f)}},getScale:function(){return Math.pow(2,this.zoom-this.zoomOffset)},projectOnTile:function(e,t){return this.projectOnTileWithScale(e,this.getScale()*Xc,t)},projectOnTileWithScale:function(e,t,r){var n=e[0],i=e[1],a=n*ei/180,o=i*ei/180,s=t*(a+ei)/(2*ei),l=t*(ei-Math.log(Math.tan(ei/4+o*.5)))/(2*ei);return r=r||[],r[0]=s,r[1]=l,r},unprojectFromTile:function(e,t){return this.unprojectOnTileWithScale(e,this.getScale()*Xc,t)},unprojectOnTileWithScale:function(e,t,r){var n=e[0],i=e[1],a=n/t*(2*ei)-ei,o=2*(Math.atan(Math.exp(ei-i/t*(2*ei)))-ei/4);return r=r||[],r[0]=a*180/ei,r[1]=o*180/ei,r},dataToPoint:function(e,t){return t=this.projectOnTileWithScale(e,Xc,t),t[0]-=this._origin[0],t[1]-=this._origin[1],t[2]=isNaN(e[2])?0:e[2],isNaN(e[2])||(t[2]=e[2],this.altitudeExtent&&(t[2]-=this.altitudeExtent[0])),t}};function pv(){Ef.apply(this,arguments)}pv.prototype=new Ef;pv.prototype.constructor=pv;pv.prototype.type="mapbox3D";function MG(e,t,r){function n(a,o){var s=o.getWidth(),l=o.getHeight(),u=o.getDevicePixelRatio();this.viewGL.setViewport(0,0,s,l,u),this.width=s,this.height=l,this.altitudeScale=a.get("altitudeScale"),this.boxHeight=a.get("boxHeight")}function i(a,o){if(this.model.get("boxHeight")!=="auto"){var s=[1/0,-1/0];a.eachSeries(function(l){if(l.coordinateSystem===this){var u=l.getData(),h=l.coordDimToDataDim("alt")[0];if(h){var f=u.getDataExtent(h,!0);s[0]=Math.min(s[0],f[0]),s[1]=Math.max(s[1],f[1])}}},this),isFinite(s[1]-s[0])&&(this.altitudeExtent=s)}}return{dimensions:t.prototype.dimensions,create:function(a,o){var s=[];return a.eachComponent(e,function(l){var u=l.__viewGL;u||(u=l.__viewGL=new rr,u.setRootNode(new U.Node));var h=new t;h.viewGL=l.__viewGL,h.resize=n,h.resize(l,o),s.push(h),l.coordinateSystem=h,h.model=l,h.update=i}),a.eachSeries(function(l){if(l.get("coordinateSystem")===e){var u=l.getReferringComponents(e).models[0];if(u||(u=a.getComponent(e)),!u)throw new Error(e+' "'+Ee.firstNotNull(l.get(e+"Index"),l.get(e+"Id"),0)+'" not found');l.coordinateSystem=u.coordinateSystem}}),r&&r(s,a,o),s}}}var Lst=MG("mapbox3D",pv,function(e){e.forEach(function(t){t.setCameraOption(t.model.getMapboxCameraOption())})});function Rst(e){e.registerComponentModel(cA),e.registerComponentView(Dst),e.registerCoordinateSystem("mapbox3D",Lst),e.registerAction({type:"mapbox3DChangeCamera",event:"mapbox3dcamerachanged",update:"mapbox3D:updateCamera"},function(t,r){r.eachComponent({mainType:"mapbox3D",query:t},function(n){n.setMapboxCameraOption(t)})})}te(Rst);var PI=["zoom","center","pitch","bearing"],dA=me.extend({type:"maptalks3D",layoutMode:"box",coordinateSystem:null,defaultOption:{zlevel:-10,urlTemplate:"http://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}.png",attribution:'&copy; <a href="http://osm.org">OpenStreetMap</a> contributors, &copy; <a href="https://carto.com/">CARTO</a>',center:[0,0],zoom:0,pitch:0,bearing:0,light:{main:{alpha:20,beta:30}},altitudeScale:1,boxHeight:"auto"},getMaptalksCameraOption:function(){var e=this;return PI.reduce(function(t,r){return t[r]=e.get(r),t},{})},setMaptalksCameraOption:function(e){e!=null&&PI.forEach(function(t){e[t]!=null&&(this.option[t]=e[t])},this)},getMaptalks:function(){return this._maptalks},setMaptalks:function(e){this._maptalks=e}});Ot(dA.prototype,tc);Ot(dA.prototype,ec);function qs(e,t,r,n){if(this.id=e,this.zr=t,this.dom=document.createElement("div"),this.dom.style.cssText="position:absolute;left:0;right:0;top:0;bottom:0;",!maptalks)throw new Error("Maptalks library must be included. See https://maptalks.org");this._maptalks=new maptalks.Map(this.dom,{center:r,zoom:n,doubleClickZoom:!1,fog:!1}),this._initEvents()}qs.prototype.setUnpainted=function(){};qs.prototype.resize=function(){this._maptalks.checkSize()};qs.prototype.getMaptalks=function(){return this._maptalks};qs.prototype.clear=function(){};qs.prototype.refresh=function(){this._maptalks.checkSize()};var AG=["mousedown","mouseup","click","dblclick","mousemove","mousewheel","DOMMouseScroll","touchstart","touchend","touchmove","touchcancel"];qs.prototype._initEvents=function(){var e=this.dom;this._handlers=this._handlers||{contextmenu:function(t){return t.preventDefault(),!1}},AG.forEach(function(t){this._handlers[t]=function(r){var n={};for(var i in r)n[i]=r[i];n.bubbles=!1;var a=new r.constructor(r.type,n);t==="mousewheel"||t==="DOMMouseScroll"?e.dispatchEvent(a):e.firstElementChild.dispatchEvent(a)},this.zr.dom.addEventListener(t,this._handlers[t])},this),this.zr.dom.addEventListener("contextmenu",this._handlers.contextmenu)};qs.prototype.dispose=function(){AG.forEach(function(e){this.zr.dom.removeEventListener(e,this._handlers[e])},this),this._maptalks.remove()};U.Shader.import(wG);const Pst=nr.extend({type:"maptalks3D",__ecgl__:!0,init:function(e,t){this._groundMesh=new U.Mesh({geometry:new U.PlaneGeometry,material:new U.Material({shader:new U.Shader({vertex:U.Shader.source("ecgl.displayShadow.vertex"),fragment:U.Shader.source("ecgl.displayShadow.fragment")}),depthMask:!1}),renderOrder:-100,culling:!1,castShadow:!1,$ignorePicking:!0,renderNormal:!0})},_initMaptalksLayer:function(e,t){var r=t.getZr();this._zrLayer=new qs("maptalks3D",r,e.get("center"),e.get("zoom")),r.painter.insertLayer(-1e3,this._zrLayer),this._lightRoot=new U.Node,this._sceneHelper=new ks(this._lightRoot),this._sceneHelper.initLight(this._lightRoot);var n=this._zrLayer.getMaptalks(),i=this._dispatchInteractAction.bind(this,t,n);["zoomend","zooming","zoomstart","dragrotating","pitch","pitchend","movestart","moving","moveend","resize","touchstart","touchmove","touchend","animating"].forEach(function(a){n.on(a,i)})},render:function(e,t,r){this._zrLayer||this._initMaptalksLayer(e,r);var n=this._zrLayer.getMaptalks(),i=e.get("urlTemplate"),a=n.getBaseLayer();i!==this._oldUrlTemplate&&(a?a.setOptions({urlTemplate:i,attribution:e.get("attribution")}):(a=new maptalks.TileLayer("maptalks-echarts-gl-baselayer",{urlTemplate:i,subdomains:["a","b","c"],attribution:e.get("attribution")}),n.setBaseLayer(a))),this._oldUrlTemplate=i,n.setCenter(e.get("center")),n.setZoom(e.get("zoom"),{animation:!1}),n.setPitch(e.get("pitch")),n.setBearing(e.get("bearing")),e.setMaptalks(n);var o=e.coordinateSystem;o.viewGL.scene.add(this._lightRoot),o.viewGL.add(this._groundMesh),this._updateGroundMesh(),this._sceneHelper.setScene(o.viewGL.scene),this._sceneHelper.updateLight(e),o.viewGL.setPostEffect(e.getModel("postEffect"),r),o.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling")),this._maptalks3DModel=e},afterRender:function(e,t,r,n){var i=n.renderer;this._sceneHelper.updateAmbientCubemap(i,e,r),this._sceneHelper.updateSkybox(i,e,r),e.coordinateSystem.viewGL.scene.traverse(function(a){a.material&&(a.material.define("fragment","NORMAL_UP_AXIS",2),a.material.define("fragment","NORMAL_FRONT_AXIS",1))})},updateCamera:function(e,t,r,n){e.coordinateSystem.setCameraOption(n),this._updateGroundMesh(),r.getZr().refresh()},_dispatchInteractAction:function(e,t,r){e.dispatchAction({type:"maptalks3DChangeCamera",pitch:t.getPitch(),zoom:Nst(t.getResolution())+1,center:t.getCenter().toArray(),bearing:t.getBearing(),maptalks3DId:this._maptalks3DModel&&this._maptalks3DModel.id})},_updateGroundMesh:function(){if(this._maptalks3DModel){var e=this._maptalks3DModel.coordinateSystem,t=e.dataToPoint(e.center);this._groundMesh.position.set(t[0],t[1],-.001);var r=new U.Plane(new U.Vector3(0,0,1),0),n=e.viewGL.camera.castRay(new U.Vector2(-1,-1)),i=e.viewGL.camera.castRay(new U.Vector2(1,1)),a=n.intersectPlane(r),o=i.intersectPlane(r),s=a.dist(o)/e.viewGL.rootNode.scale.x;this._groundMesh.scale.set(s,s,1)}},dispose:function(e,t){this._zrLayer&&this._zrLayer.dispose(),t.getZr().painter.delLayer(-1e3)}}),Ist=2*6378137*Math.PI/(256*Math.pow(2,20));function Nst(e){return 19-Math.log(e/Ist)/Math.LN2}function gv(){Ef.apply(this,arguments),this.maxPitch=85,this.zoomOffset=1}gv.prototype=new Ef;gv.prototype.constructor=gv;gv.prototype.type="maptalks3D";var Ost=MG("maptalks3D",gv,function(e){e.forEach(function(t){t.setCameraOption(t.model.getMaptalksCameraOption())})});function Fst(e){e.registerComponentModel(dA),e.registerComponentView(Pst),e.registerCoordinateSystem("maptalks3D",Ost),e.registerAction({type:"maptalks3DChangeCamera",event:"maptalks3dcamerachanged",update:"maptalks3D:updateCamera"},function(t,r){r.eachComponent({mainType:"maptalks3D",query:t},function(n){n.setMaptalksCameraOption(t)})})}te(Fst);var Bst=Or.vec3,Ust=Xw.isDimensionStacked;function zst(e){var t=e[0],r=e[1];return!(t>0&&r>0||t<0&&r<0)}function kst(e,t){var r=e.getData(),n=e.get("barSize");if(n==null){var i=t.size,a,o,s=t.getAxis("x"),l=t.getAxis("y");s.type==="category"?a=s.getBandWidth()*.7:a=Math.round(i[0]/Math.sqrt(r.count()))*.6,l.type==="category"?o=l.getBandWidth()*.7:o=Math.round(i[1]/Math.sqrt(r.count()))*.6,n=[a,o]}else at(n)||(n=[n,n]);var u=t.getAxis("z").scale.getExtent(),h=zst(u),f=["x","y","z"].map(function(v){return e.coordDimToDataDim(v)[0]}),c=Ust(r,f[2]),d=c?r.getCalculationInfo("stackResultDimension"):f[2];r.each(f,function(v,p,g,m){var _=r.get(d,m),y=c?_-g:h?0:u[0],x=t.dataToPoint([v,p,y]),T=t.dataToPoint([v,p,_]),S=Bst.dist(x,T),M=[0,T[1]<x[1]?-1:1,0];Math.abs(S)===0&&(S=.1);var w=[n[0],S,n[1]];r.setItemLayout(m,[x,M,w])}),r.setLayout("orient",[1,0,0])}function vA(e,t,r){for(var n=e.getDataExtent(t),i=e.getDataExtent(r),a=n[1]-n[0]||n[0],o=i[1]-i[0]||i[0],s=50,l=new Uint8Array(s*s),u=0;u<e.count();u++){var h=e.get(t,u),f=e.get(r,u),c=Math.floor((h-n[0])/a*(s-1)),d=Math.floor((f-i[0])/o*(s-1)),v=d*s+c;l[v]=l[v]||1}for(var p=0,u=0;u<l.length;u++)l[u]&&p++;return p/l.length}var II=Or.vec3,Gst=Xw.isDimensionStacked;function Vst(e,t){var r=e.getData(),n=e.get("minHeight")||0,i=e.get("barSize"),a=["lng","lat","alt"].map(function(u){return e.coordDimToDataDim(u)[0]});if(i==null){var o=t.radius*Math.PI,s=vA(r,a[0],a[1]);i=[o/Math.sqrt(r.count()/s),o/Math.sqrt(r.count()/s)]}else at(i)||(i=[i,i]);var l=pA(r,a);r.each(a,function(u,h,f,c){var d=r.get(l.dimension,c),v=l.isStacked?d-f:t.altitudeAxis.scale.getExtent()[0],p=Math.max(t.altitudeAxis.dataToCoord(f),n),g=t.dataToPoint([u,h,v]),m=t.dataToPoint([u,h,d]),_=II.sub([],m,g);II.normalize(_,_);var y=[i[0],p,i[1]];r.setItemLayout(c,[g,_,y])}),r.setLayout("orient",ht.UP.array)}function Hst(e,t){var r=e.getData(),n=e.get("barSize"),i=e.get("minHeight")||0,a=["lng","lat","alt"].map(function(h){return e.coordDimToDataDim(h)[0]});if(n==null){var o=Math.min(t.size[0],t.size[2]),s=vA(r,a[0],a[1]);n=[o/Math.sqrt(r.count()/s),o/Math.sqrt(r.count()/s)]}else at(n)||(n=[n,n]);var l=[0,1,0],u=pA(r,a);r.each(a,function(h,f,c,d){var v=r.get(u.dimension,d),p=u.isStacked?v-c:t.altitudeAxis.scale.getExtent()[0],g=Math.max(t.altitudeAxis.dataToCoord(c),i),m=t.dataToPoint([h,f,p]),_=[n[0],g,n[1]];r.setItemLayout(d,[m,l,_])}),r.setLayout("orient",[1,0,0])}function Wst(e,t){var r=e.getData(),n=e.coordDimToDataDim("lng")[0],i=e.coordDimToDataDim("lat")[0],a=e.coordDimToDataDim("alt")[0],o=e.get("barSize"),s=e.get("minHeight")||0;if(o==null){var l=r.getDataExtent(n),u=r.getDataExtent(i),h=t.dataToPoint([l[0],u[0]]),f=t.dataToPoint([l[1],u[1]]),c=Math.min(Math.abs(h[0]-f[0]),Math.abs(h[1]-f[1]))||1,d=vA(r,n,i);o=[c/Math.sqrt(r.count()/d),c/Math.sqrt(r.count()/d)]}else at(o)||(o=[o,o]),o[0]/=t.getScale()/16,o[1]/=t.getScale()/16;var v=[0,0,1],p=[n,i,a],g=pA(r,p);r.each(p,function(m,_,y,x){var T=r.get(g.dimension,x),S=g.isStacked?T-y:0,M=t.dataToPoint([m,_,S]),w=t.dataToPoint([m,_,T]),b=Math.max(w[2]-M[2],s),A=[o[0],b,o[1]];r.setItemLayout(x,[M,v,A])}),r.setLayout("orient",[1,0,0])}function pA(e,t){var r=Gst(e,t[2]);return{dimension:r?e.getCalculationInfo("stackResultDimension"):t[2],isStacked:r}}function Xst(e){e.registerLayout(function(t,r){t.eachSeriesByType("bar3D",function(n){var i=n.coordinateSystem,a=i&&i.type;a==="globe"?Vst(n,i):a==="cartesian3D"?kst(n,i):a==="geo3D"?Hst(n,i):(a==="mapbox3D"||a==="maptalks3D")&&Wst(n,i)})})}var $s={};$s.getFormattedLabel=function(e,t,r,n,i){r=r||"normal";var a=e.getData(n),o=a.getItemModel(t),s=e.getDataParams(t,n);i!=null&&s.value instanceof Array&&(s.value=s.value[i]);var l=o.get(r==="normal"?["label","formatter"]:["emphasis","label","formatter"]);l==null&&(l=o.get(["label","formatter"]));var u;return typeof l=="function"?(s.status=r,u=l(s)):typeof l=="string"&&(u=xw(l,s)),u};$s.normalizeToArray=function(e){return e instanceof Array?e:e==null?[]:[e]};function Yst(e,t){var r=[];return R(e.dimensions,function(n){var i=e.getDimensionInfo(n),a=i.otherDims,o=a[t];o!=null&&o!==!1&&(r[o]=i.name)}),r}function Vv(e,t,r){function n(f){var c=[],d=Yst(i,"tooltip");d.length?R(d,function(p){v(i.get(p,t),p)}):R(f,v);function v(p,g){var m=i.getDimensionInfo(g);if(!(!m||m.otherDims.tooltip===!1)){var _=m.type,y="- "+(m.tooltipName||m.name)+": "+(_==="ordinal"?p+"":_==="time"?r?"":RW("yyyy/MM/dd hh:mm:ss",p):Mm(p));y&&c.push(Br(y))}}return"<br/>"+c.join("<br/>")}var i=e.getData(),a=e.getRawValue(t),o=at(a)?n(a):Br(Mm(a)),s=i.getName(t),l=nn(i,t);Kt(l)&&l.colorStops&&(l=(l.colorStops[0]||{}).color),l=l||"transparent";var u=L3(l),h=e.name;return h==="\0-"&&(h=""),h=h?Br(h)+(r?": ":"<br/>"):"",r?u+h+o:h+u+(s?Br(s)+": "+o:o)}function p0(e,t,r){r=r||e.getSource();var n=t||HF(e.get("coordinateSystem"))||["x","y","z"],i=Ev(r,{dimensionsDefine:r.dimensionsDefine||e.get("dimensions"),encodeDefine:r.encodeDefine||e.get("encode"),coordDimensions:n.map(function(s){var l=e.getReferringComponents(s+"Axis3D").models[0];return{type:l&&l.get("type")==="category"?"ordinal":"float",name:s}})});e.get("coordinateSystem")==="cartesian3D"&&i.forEach(function(s){if(n.indexOf(s.coordDim)>=0){var l=e.getReferringComponents(s.coordDim+"Axis3D").models[0];l&&l.get("type")==="category"&&(s.ordinalMeta=l.getOrdinalMeta())}});var a=Xw.enableDataStack(e,i,{byIndex:!0,stackedCoordDimension:"z"}),o=new xr(i,e);return o.setCalculationInfo(a),o.initData(r),o}var EG=Ue.extend({type:"series.bar3D",dependencies:["globe"],visualStyleAccessPathvisu:"itemStyle",getInitialData:function(e,t){return p0(this)},getFormattedLabel:function(e,t,r,n){var i=$s.getFormattedLabel(this,e,t,r,n);return i==null&&(i=this.getData().get("z",e)),i},formatTooltip:function(e){return Vv(this,e)},defaultOption:{coordinateSystem:"cartesian3D",globeIndex:0,grid3DIndex:0,zlevel:-10,bevelSize:0,bevelSmoothness:2,onGridPlane:"xy",shading:"color",minHeight:0,itemStyle:{opacity:1},label:{show:!1,distance:2,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},emphasis:{label:{show:!0}},animationDurationUpdate:500}});Ot(EG.prototype,nc);var wr=Or.vec3,Zst=Or.mat3,gA=Ce.extend(function(){return{attributes:{position:new Ce.Attribute("position","float",3,"POSITION"),normal:new Ce.Attribute("normal","float",3,"NORMAL"),color:new Ce.Attribute("color","float",4,"COLOR"),prevPosition:new Ce.Attribute("prevPosition","float",3),prevNormal:new Ce.Attribute("prevNormal","float",3)},dynamic:!0,enableNormal:!1,bevelSize:1,bevelSegments:0,_dataIndices:null,_vertexOffset:0,_triangleOffset:0}},{resetOffset:function(){this._vertexOffset=0,this._triangleOffset=0},setBarCount:function(e){var t=this.enableNormal,r=this.getBarVertexCount()*e,n=this.getBarTriangleCount()*e;this.vertexCount!==r&&(this.attributes.position.init(r),t?this.attributes.normal.init(r):this.attributes.normal.value=null,this.attributes.color.init(r)),this.triangleCount!==n&&(this.indices=r>65535?new Uint32Array(n*3):new Uint16Array(n*3),this._dataIndices=new Uint32Array(r))},getBarVertexCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarVertexCount(e):this.enableNormal?24:8},getBarTriangleCount:function(){var e=this.bevelSize>0?this.bevelSegments:0;return e>0?this._getBevelBarTriangleCount(e):12},_getBevelBarVertexCount:function(e){return(e+1)*4*(e+1)*2},_getBevelBarTriangleCount:function(e){var t=e*4+3,r=e*2+1;return(t+1)*r*2+4},setColor:function(e,t){for(var r=this.getBarVertexCount(),n=r*e,i=r*(e+1),a=n;a<i;a++)this.attributes.color.set(a,t);this.dirtyAttribute("color")},getDataIndexOfVertex:function(e){return this._dataIndices?this._dataIndices[e]:null},addBar:function(){for(var e=wr.create,t=wr.scaleAndAdd,r=e(),n=e(),i=e(),a=e(),o=e(),s=e(),l=e(),u=[],h=[],f=0;f<8;f++)u[f]=e();for(var c=[[0,1,5,4],[2,3,7,6],[4,5,6,7],[3,2,1,0],[0,4,7,3],[1,2,6,5]],d=[0,1,2,0,2,3],v=[],f=0;f<c.length;f++)for(var p=c[f],g=0;g<2;g++){for(var m=[],_=0;_<3;_++)m.push(p[d[g*3+_]]);v.push(m)}return function(y,x,T,S,M,w){var b=this._vertexOffset;if(this.bevelSize>0&&this.bevelSegments>0)this._addBevelBar(y,x,T,S,this.bevelSize,this.bevelSegments,M);else{wr.copy(i,x),wr.normalize(i,i),wr.cross(a,T,i),wr.normalize(a,a),wr.cross(n,i,a),wr.normalize(a,a),wr.negate(o,n),wr.negate(s,i),wr.negate(l,a),t(u[0],y,n,S[0]/2),t(u[0],u[0],a,S[2]/2),t(u[1],y,n,S[0]/2),t(u[1],u[1],l,S[2]/2),t(u[2],y,o,S[0]/2),t(u[2],u[2],l,S[2]/2),t(u[3],y,o,S[0]/2),t(u[3],u[3],a,S[2]/2),t(r,y,i,S[1]),t(u[4],r,n,S[0]/2),t(u[4],u[4],a,S[2]/2),t(u[5],r,n,S[0]/2),t(u[5],u[5],l,S[2]/2),t(u[6],r,o,S[0]/2),t(u[6],u[6],l,S[2]/2),t(u[7],r,o,S[0]/2),t(u[7],u[7],a,S[2]/2);var A=this.attributes;if(this.enableNormal){h[0]=n,h[1]=o,h[2]=i,h[3]=s,h[4]=a,h[5]=l;for(var E=this._vertexOffset,C=0;C<c.length;C++){for(var D=this._triangleOffset*3,L=0;L<6;L++)this.indices[D++]=E+d[L];E+=4,this._triangleOffset+=2}for(var C=0;C<c.length;C++)for(var P=h[C],L=0;L<4;L++){var N=c[C][L];A.position.set(this._vertexOffset,u[N]),A.normal.set(this._vertexOffset,P),A.color.set(this._vertexOffset++,M)}}else{for(var C=0;C<v.length;C++){for(var D=this._triangleOffset*3,L=0;L<3;L++)this.indices[D+L]=v[C][L]+this._vertexOffset;this._triangleOffset++}for(var C=0;C<u.length;C++)A.position.set(this._vertexOffset,u[C]),A.color.set(this._vertexOffset++,M)}}for(var O=this._vertexOffset,C=b;C<O;C++)this._dataIndices[C]=w}}(),_addBevelBar:function(){var e=wr.create(),t=wr.create(),r=wr.create(),n=Zst.create(),i=[],a=[1,-1,-1,1],o=[1,1,-1,-1],s=[2,0];return function(l,u,h,f,c,d,v){wr.copy(t,u),wr.normalize(t,t),wr.cross(r,h,t),wr.normalize(r,r),wr.cross(e,t,r),wr.normalize(r,r),n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=t[0],n[4]=t[1],n[5]=t[2],n[6]=r[0],n[7]=r[1],n[8]=r[2],c=Math.min(f[0],f[2])/2*c;for(var p=0;p<3;p++)i[p]=Math.max(f[p]-c*2,0);for(var g=(f[0]-i[0])/2,m=(f[1]-i[1])/2,_=(f[2]-i[2])/2,y=[],x=[],T=this._vertexOffset,S=[],p=0;p<2;p++){S[p]=S[p]=[];for(var M=0;M<=d;M++)for(var w=0;w<4;w++){(M===0&&p===0||p===1&&M===d)&&S[p].push(T);for(var b=0;b<=d;b++){var A=b/d*Math.PI/2+Math.PI/2*w,E=M/d*Math.PI/2+Math.PI/2*p;x[0]=g*Math.cos(A)*Math.sin(E),x[1]=m*Math.cos(E),x[2]=_*Math.sin(A)*Math.sin(E),y[0]=x[0]+a[w]*i[0]/2,y[1]=x[1]+m+s[p]*i[1]/2,y[2]=x[2]+o[w]*i[2]/2,Math.abs(g-m)<1e-6&&Math.abs(m-_)<1e-6||(x[0]/=g*g,x[1]/=m*m,x[2]/=_*_),wr.normalize(x,x),wr.transformMat3(y,y,n),wr.transformMat3(x,x,n),wr.add(y,y,l),this.attributes.position.set(T,y),this.enableNormal&&this.attributes.normal.set(T,x),this.attributes.color.set(T,v),T++}}}for(var C=d*4+3,D=d*2+1,L=C+1,w=0;w<D;w++)for(var p=0;p<=C;p++){var P=w*L+p+this._vertexOffset,N=w*L+(p+1)%L+this._vertexOffset,O=(w+1)*L+(p+1)%L+this._vertexOffset,I=(w+1)*L+p+this._vertexOffset;this.setTriangleIndices(this._triangleOffset++,[O,P,N]),this.setTriangleIndices(this._triangleOffset++,[O,I,P])}this.setTriangleIndices(this._triangleOffset++,[S[0][0],S[0][2],S[0][1]]),this.setTriangleIndices(this._triangleOffset++,[S[0][0],S[0][3],S[0][2]]),this.setTriangleIndices(this._triangleOffset++,[S[1][0],S[1][1],S[1][2]]),this.setTriangleIndices(this._triangleOffset++,[S[1][0],S[1][2],S[1][3]]),this._vertexOffset=T}}()});Vt(gA.prototype,kv);Vt(gA.prototype,hA);var qst=Or.vec3;const $st=De.extend({type:"bar3D",__ecgl__:!0,init:function(e,t){this.groupGL=new U.Node,this._api=t,this._labelsBuilder=new Xo(256,256,t);var r=this;this._labelsBuilder.getLabelPosition=function(n,i,a){if(r._data){var o=r._data.getItemLayout(n),s=o[0],l=o[1],u=o[2][1];return qst.scaleAndAdd([],s,l,a+u)}else return[0,0]},this._labelsBuilder.getMesh().renderOrder=100},render:function(e,t,r){var n=this._prevBarMesh;this._prevBarMesh=this._barMesh,this._barMesh=n,this._barMesh||(this._barMesh=new U.Mesh({geometry:new gA,shadowDepthMaterial:new U.Material({shader:new U.Shader(U.Shader.source("ecgl.sm.depth.vertex"),U.Shader.source("ecgl.sm.depth.fragment"))}),culling:e.coordinateSystem.type==="cartesian3D",renderOrder:10,renderNormal:!0})),this.groupGL.remove(this._prevBarMesh),this.groupGL.add(this._barMesh),this.groupGL.add(this._labelsBuilder.getMesh());var i=e.coordinateSystem;if(this._doRender(e,r),i&&i.viewGL){i.viewGL.add(this.groupGL);var a=i.viewGL.isLinearSpace()?"define":"undefine";this._barMesh.material[a]("fragment","SRGB_DECODE")}this._data=e.getData(),this._labelsBuilder.updateData(this._data),this._labelsBuilder.updateLabels(),this._updateAnimation(e)},_updateAnimation:function(e){U.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevBarMesh,this._barMesh,e)},_doRender:function(e,t){var r=e.getData(),n=e.get("shading"),i=n!=="color",a=this,o=this._barMesh,s="ecgl."+n;(!o.material||o.material.shader.name!==s)&&(o.material=U.createMaterial(s,["VERTEX_COLOR"])),U.setMaterialFromModel(n,o.material,e,t),o.geometry.enableNormal=i,o.geometry.resetOffset();var l=e.get("bevelSize"),u=e.get("bevelSmoothness");o.geometry.bevelSegments=u,o.geometry.bevelSize=l;var h=[],f=new Float32Array(r.count()*4),c=0,g=0,d=!1;r.each(function(_){if(r.hasValue(_)){var y=nn(r,_),x=tn(r,_);x==null&&(x=1),U.parseColor(y,h),h[3]*=x,f[c++]=h[0],f[c++]=h[1],f[c++]=h[2],f[c++]=h[3],h[3]>0&&(g++,h[3]<.99&&(d=!0))}}),o.geometry.setBarCount(g);var v=r.getLayout("orient"),p=this._barIndexOfData=new Int32Array(r.count()),g=0;r.each(function(_){if(!r.hasValue(_)){p[_]=-1;return}var y=r.getItemLayout(_),x=y[0],T=y[1],S=y[2],M=_*4;h[0]=f[M++],h[1]=f[M++],h[2]=f[M++],h[3]=f[M++],h[3]>0&&(a._barMesh.geometry.addBar(x,T,v,S,h,_),p[_]=g++)}),o.geometry.dirty(),o.geometry.updateBoundingBox();var m=o.material;m.transparent=d,m.depthMask=!d,o.geometry.sortTriangles=d,this._initHandler(e,t)},_initHandler:function(e,t){var r=e.getData(),n=this._barMesh,i=e.coordinateSystem.type==="cartesian3D";n.seriesIndex=e.seriesIndex;var a=-1;n.off("mousemove"),n.off("mouseout"),n.on("mousemove",function(o){var s=n.geometry.getDataIndexOfVertex(o.triangle[0]);s!==a&&(this._downplay(a),this._highlight(s),this._labelsBuilder.updateLabels([s]),i&&t.dispatchAction({type:"grid3DShowAxisPointer",value:[r.get("x",s),r.get("y",s),r.get("z",s,!0)]})),a=s,n.dataIndex=s},this),n.on("mouseout",function(o){this._downplay(a),this._labelsBuilder.updateLabels(),a=-1,n.dataIndex=-1,i&&t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_highlight:function(e){var t=this._data;if(t){var r=this._barIndexOfData[e];if(!(r<0)){var n=t.getItemModel(e),i=n.getModel("emphasis.itemStyle"),a=i.get("color"),o=i.get("opacity");if(a==null){var s=nn(t,e);a=uf(s,-.4)}o==null&&(o=tn(t,e));var l=U.parseColor(a);l[3]*=o,this._barMesh.geometry.setColor(r,l),this._api.getZr().refresh()}}},_downplay:function(e){var t=this._data;if(t){var r=this._barIndexOfData[e];if(!(r<0)){var n=nn(t,e),i=tn(t,e),a=U.parseColor(n);a[3]*=i,this._barMesh.geometry.setColor(r,a),this._api.getZr().refresh()}}},highlight:function(e,t,r,n){this._toggleStatus("highlight",e,t,r,n)},downplay:function(e,t,r,n){this._toggleStatus("downplay",e,t,r,n)},_toggleStatus:function(e,t,r,n,i){var a=t.getData(),o=Ee.queryDataIndex(a,i),s=this;o!=null?R($s.normalizeToArray(o),function(l){e==="highlight"?this._highlight(l):this._downplay(l)},this):a.each(function(l){e==="highlight"?s._highlight(l):s._downplay(l)})},remove:function(){this.groupGL.removeAll()},dispose:function(){this._labelsBuilder.dispose(),this.groupGL.removeAll()}});function Kst(e){e.registerChartView($st),e.registerSeriesModel(EG),Xst(e),e.registerProcessor(function(t,r){t.eachSeriesByType("bar3d",function(n){var i=n.getData();i.filterSelf(function(a){return i.hasValue(a)})})})}te(Kst);var jst=Ue.extend({type:"series.line3D",dependencies:["grid3D"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){return p0(this)},formatTooltip:function(e){return Vv(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,lineStyle:{width:2},animationDurationUpdate:500}}),Jst=Or.vec3;U.Shader.import(v0);const Qst=De.extend({type:"line3D",__ecgl__:!0,init:function(e,t){this.groupGL=new U.Node,this._api=t},render:function(e,t,r){var n=this._prevLine3DMesh;this._prevLine3DMesh=this._line3DMesh,this._line3DMesh=n,this._line3DMesh||(this._line3DMesh=new U.Mesh({geometry:new Ys({useNativeLine:!1,sortTriangles:!0}),material:new U.Material({shader:U.createShader("ecgl.meshLines3D")}),renderOrder:10}),this._line3DMesh.geometry.pick=this._pick.bind(this)),this.groupGL.remove(this._prevLine3DMesh),this.groupGL.add(this._line3DMesh);var i=e.coordinateSystem;if(i&&i.viewGL){i.viewGL.add(this.groupGL);var a=i.viewGL.isLinearSpace()?"define":"undefine";this._line3DMesh.material[a]("fragment","SRGB_DECODE")}this._doRender(e,r),this._data=e.getData(),this._camera=i.viewGL.camera,this.updateCamera(),this._updateAnimation(e)},updateCamera:function(){this._updateNDCPosition()},_doRender:function(e,t){var r=e.getData(),n=this._line3DMesh;n.geometry.resetOffset();var i=r.getLayout("points"),a=[],o=new Float32Array(i.length/3*4),s=0,l=!1;r.each(function(f){var c=nn(r,f),d=tn(r,f);d==null&&(d=1),U.parseColor(c,a),a[3]*=d,o[s++]=a[0],o[s++]=a[1],o[s++]=a[2],o[s++]=a[3],a[3]<.99&&(l=!0)}),n.geometry.setVertexCount(n.geometry.getPolylineVertexCount(i)),n.geometry.setTriangleCount(n.geometry.getPolylineTriangleCount(i)),n.geometry.addPolyline(i,o,Ee.firstNotNull(e.get("lineStyle.width"),1)),n.geometry.dirty(),n.geometry.updateBoundingBox();var u=n.material;u.transparent=l,u.depthMask=!l;var h=e.getModel("debug.wireframe");h.get("show")?(n.geometry.createAttribute("barycentric","float",3),n.geometry.generateBarycentric(),n.material.set("both","WIREFRAME_TRIANGLE"),n.material.set("wireframeLineColor",U.parseColor(h.get("lineStyle.color")||"rgba(0,0,0,0.5)")),n.material.set("wireframeLineWidth",Ee.firstNotNull(h.get("lineStyle.width"),1))):n.material.set("both","WIREFRAME_TRIANGLE"),this._points=i,this._initHandler(e,t)},_updateAnimation:function(e){U.updateVertexAnimation([["prevPosition","position"],["prevPositionPrev","positionPrev"],["prevPositionNext","positionNext"]],this._prevLine3DMesh,this._line3DMesh,e)},_initHandler:function(e,t){var r=e.getData(),n=e.coordinateSystem,i=this._line3DMesh,a=-1;i.seriesIndex=e.seriesIndex,i.off("mousemove"),i.off("mouseout"),i.on("mousemove",function(o){var s=n.pointToData(o.point.array),l=r.indicesOfNearest("x",s[0])[0];l!==a&&(t.dispatchAction({type:"grid3DShowAxisPointer",value:[r.get("x",l),r.get("y",l),r.get("z",l)]}),i.dataIndex=l),a=l},this),i.on("mouseout",function(o){a=-1,i.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_updateNDCPosition:function(){var e=new Nt,t=this._camera;Nt.multiply(e,t.projectionMatrix,t.viewMatrix);var r=this._positionNDC,n=this._points,i=n.length/3;(!r||r.length/2!==i)&&(r=this._positionNDC=new Float32Array(i*2));for(var a=[],o=0;o<i;o++){var s=o*3,l=o*2;a[0]=n[s],a[1]=n[s+1],a[2]=n[s+2],a[3]=1,Jst.transformMat4(a,a,e.array),r[l]=a[0]/a[3],r[l+1]=a[1]/a[3]}},_pick:function(e,t,r,n,i,a){var o=this._positionNDC,s=this._data.hostModel,l=s.get("lineStyle.width"),u=-1,h=r.viewport.width,f=r.viewport.height,c=h*.5,d=f*.5;e=(e+1)*c,t=(t+1)*d;for(var v=1;v<o.length/2;v++){var p=(o[(v-1)*2]+1)*c,g=(o[(v-1)*2+1]+1)*d,m=(o[v*2]+1)*c,_=(o[v*2+1]+1)*d;if(go(p,g,m,_,l,e,t)){var y=(p-e)*(p-e)+(g-t)*(g-t),x=(m-e)*(m-e)+(_-t)*(_-t);u=y<x?v-1:v}}if(u>=0){var T=u*3,S=new ht(this._points[T],this._points[T+1],this._points[T+2]);a.push({dataIndex:u,point:S,pointWorld:S.clone(),target:this._line3DMesh,distance:this._camera.getWorldPosition().dist(S)})}},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function tlt(e){e.registerChartView(Qst),e.registerSeriesModel(jst),e.registerLayout(function(t,r){t.eachSeriesByType("line3D",function(n){var i=n.getData(),a=n.coordinateSystem;if(a){if(a.type!=="cartesian3D")return;var o=new Float32Array(i.count()*3),s=[],l=[],u=a.dimensions,h=u.map(function(f){return n.coordDimToDataDim(f)[0]});a&&i.each(h,function(f,c,d,v){s[0]=f,s[1]=c,s[2]=d,a.dataToPoint(s,l),o[v*3]=l[0],o[v*3+1]=l[1],o[v*3+2]=l[2]}),i.setLayout("points",o)}})})}te(tlt);const elt=Ue.extend({type:"series.scatter3D",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(e,t){return p0(this)},getFormattedLabel:function(e,t,r,n){var i=$s.getFormattedLabel(this,e,t,r,n);if(i==null){var a=this.getData(),o=a.dimensions[a.dimensions.length-1];i=a.get(o,e)}return i},formatTooltip:function(e){return Vv(this,e)},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,progressive:1e5,progressiveThreshold:1e5,grid3DIndex:0,globeIndex:0,symbol:"circle",symbolSize:10,blendMode:"source-over",label:{show:!1,position:"right",distance:5,textStyle:{fontSize:14,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:3}},itemStyle:{opacity:.8},emphasis:{label:{show:!0}},animationDurationUpdate:500}});function p1(e,n,r){var n=n||document.createElement("canvas");n.width=e,n.height=e;var i=n.getContext("2d");return r&&r(i),n}function rlt(e,t,r,n){at(t)||(t=[t,t]);var i=g_.getMarginByStyle(r,n),a=t[0]+i.left+i.right,o=t[1]+i.top+i.bottom,s=Pr(e,0,0,t[0],t[1]),l=Math.max(a,o);s.x=i.left,s.y=i.top,a>o?s.y+=(l-o)/2:s.x+=(l-a)/2;var u=s.getBoundingRect();return s.x-=u.x,s.y-=u.y,s.setStyle(r),s.update(),s.__size=l,s}function nlt(e,t,r){var n=t.width,i=t.height,a=e.canvas.width,o=e.canvas.height,s=n/a,l=i/o;function u(m){return m<128?1:-1}function h(m,_){var y=1/0;m=Math.floor(m*s),_=Math.floor(_*l);for(var x=_*n+m,T=t.data[x*4],S=u(T),M=Math.max(_-r,0);M<Math.min(_+r,i);M++)for(var w=Math.max(m-r,0);w<Math.min(m+r,n);w++){var x=M*n+w,b=t.data[x*4],A=u(b),E=w-m,C=M-_;if(S!==A){var D=E*E+C*C;D<y&&(y=D)}}return S*Math.sqrt(y)}for(var f=e.createImageData(a,o),c=0;c<o;c++)for(var d=0;d<a;d++){var v=h(d,c),p=v/r*.5+.5,g=(c*a+d)*4;f.data[g++]=(1-p)*255,f.data[g++]=(1-p)*255,f.data[g++]=(1-p)*255,f.data[g++]=255}return f}var g_={getMarginByStyle:function(e){var t=e.minMargin||0,r=0;e.stroke&&e.stroke!=="none"&&(r=e.lineWidth==null?1:e.lineWidth);var n=e.shadowBlur||0,i=e.shadowOffsetX||0,a=e.shadowOffsetY||0,o={};return o.left=Math.max(r/2,-i+n,t),o.right=Math.max(r/2,i+n,t),o.top=Math.max(r/2,-a+n,t),o.bottom=Math.max(r/2,a+n,t),o},createSymbolSprite:function(e,t,r,n){var i=rlt(e,t,r),a=g_.getMarginByStyle(r);return{image:p1(i.__size,n,function(o){q_(o,i)}),margin:a}},createSDFFromCanvas:function(e,t,r,n){return p1(t,n,function(i){var a=e.getContext("2d"),o=a.getImageData(0,0,e.width,e.height);i.putImageData(nlt(i,o,r),0,0)})},createSimpleSprite:function(e,t){return p1(e,t,function(r){var n=e/2;r.beginPath(),r.arc(n,n,60,0,Math.PI*2,!1),r.closePath();var i=r.createRadialGradient(n,n,0,n,n,n);i.addColorStop(0,"rgba(255, 255, 255, 1)"),i.addColorStop(.5,"rgba(255, 255, 255, 0.5)"),i.addColorStop(1,"rgba(255, 255, 255, 0)"),r.fillStyle=i,r.fill()})}},NI=Or.vec3;const ilt={needsSortVertices:function(){return this.sortVertices},needsSortVerticesProgressively:function(){return this.needsSortVertices()&&this.vertexCount>=2e4},doSortVertices:function(e,t){var r=this.indices,n=NI.create();if(!r){r=this.indices=this.vertexCount>65535?new Uint32Array(this.vertexCount):new Uint16Array(this.vertexCount);for(var i=0;i<r.length;i++)r[i]=i}if(t===0){var a=this.attributes.position,e=e.array,o=0;(!this._zList||this._zList.length!==this.vertexCount)&&(this._zList=new Float32Array(this.vertexCount));for(var s,i=0;i<this.vertexCount;i++){a.get(i,n);var l=NI.sqrDist(n,e);isNaN(l)&&(l=1e7,o++),i===0?(s=l,l=0):l=l-s,this._zList[i]=l}this._noneCount=o}if(this.vertexCount<2e4)t===0&&this._simpleSort(this._noneCount/this.vertexCount>.05);else for(var i=0;i<3;i++)this._progressiveQuickSort(t*3+i);this.dirtyIndices()},_simpleSort:function(e){var t=this._zList,r=this.indices;function n(i,a){return t[a]-t[i]}e?Array.prototype.sort.call(r,n):Mf.sort(r,n,0,r.length-1)},_progressiveQuickSort:function(e){var t=this._zList,r=this.indices;this._quickSort=this._quickSort||new Mf,this._quickSort.step(r,function(n,i){return t[i]-t[n]},e)}},alt=`@export ecgl.sdfSprite.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform float elapsedTime : 0;

attribute vec3 position : POSITION;

#ifdef VERTEX_SIZE
attribute float size;
#else
uniform float u_Size;
#endif

#ifdef VERTEX_COLOR
attribute vec4 a_FillColor: COLOR;
varying vec4 v_Color;
#endif

#ifdef VERTEX_ANIMATION
attribute vec3 prevPosition;
attribute float prevSize;
uniform float percent : 1.0;
#endif


#ifdef POSITIONTEXTURE_ENABLED
uniform sampler2D positionTexture;
#endif

varying float v_Size;

void main()
{

#ifdef POSITIONTEXTURE_ENABLED
 gl_Position = worldViewProjection * vec4(texture2D(positionTexture, position.xy).xy, -10.0, 1.0);
#else

 #ifdef VERTEX_ANIMATION
 vec3 pos = mix(prevPosition, position, percent);
 #else
 vec3 pos = position;
 #endif
 gl_Position = worldViewProjection * vec4(pos, 1.0);
#endif

#ifdef VERTEX_SIZE
#ifdef VERTEX_ANIMATION
 v_Size = mix(prevSize, size, percent);
#else
 v_Size = size;
#endif
#else
 v_Size = u_Size;
#endif

#ifdef VERTEX_COLOR
 v_Color = a_FillColor;
 #endif

 gl_PointSize = v_Size;
}

@end

@export ecgl.sdfSprite.fragment

uniform vec4 color: [1, 1, 1, 1];
uniform vec4 strokeColor: [1, 1, 1, 1];
uniform float smoothing: 0.07;

uniform float lineWidth: 0.0;

#ifdef VERTEX_COLOR
varying vec4 v_Color;
#endif

varying float v_Size;

uniform sampler2D sprite;

@import clay.util.srgb

void main()
{
 gl_FragColor = color;

 vec4 _strokeColor = strokeColor;

#ifdef VERTEX_COLOR
 gl_FragColor *= v_Color;
 #endif

#ifdef SPRITE_ENABLED
 float d = texture2D(sprite, gl_PointCoord).r;
 gl_FragColor.a *= smoothstep(0.5 - smoothing, 0.5 + smoothing, d);

 if (lineWidth > 0.0) {
 float sLineWidth = lineWidth / 2.0;

 float outlineMaxValue0 = 0.5 + sLineWidth;
 float outlineMaxValue1 = 0.5 + sLineWidth + smoothing;
 float outlineMinValue0 = 0.5 - sLineWidth - smoothing;
 float outlineMinValue1 = 0.5 - sLineWidth;

 if (d <= outlineMaxValue1 && d >= outlineMinValue0) {
 float a = _strokeColor.a;
 if (d <= outlineMinValue1) {
 a = a * smoothstep(outlineMinValue0, outlineMinValue1, d);
 }
 else {
 a = a * smoothstep(outlineMaxValue1, outlineMaxValue0, d);
 }
 gl_FragColor.rgb = mix(gl_FragColor.rgb * gl_FragColor.a, _strokeColor.rgb, a);
 gl_FragColor.a = gl_FragColor.a * (1.0 - a) + a;
 }
 }
#endif

#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(gl_FragColor);
#endif
}
@end`;var g1=Or.vec4;U.Shader.import(alt);var olt=U.Mesh.extend(function(){var e=new U.Geometry({dynamic:!0,attributes:{color:new U.Geometry.Attribute("color","float",4,"COLOR"),position:new U.Geometry.Attribute("position","float",3,"POSITION"),size:new U.Geometry.Attribute("size","float",1),prevPosition:new U.Geometry.Attribute("prevPosition","float",3),prevSize:new U.Geometry.Attribute("prevSize","float",1)}});Object.assign(e,ilt);var t=new U.Material({shader:U.createShader("ecgl.sdfSprite"),transparent:!0,depthMask:!1});t.enableTexture("sprite"),t.define("both","VERTEX_COLOR"),t.define("both","VERTEX_SIZE");var r=new U.Texture2D({image:document.createElement("canvas"),flipY:!1});return t.set("sprite",r),e.pick=this._pick.bind(this),{geometry:e,material:t,mode:U.Mesh.POINTS,sizeScale:1}},{_pick:function(e,t,r,n,i,a){var o=this._positionNDC;if(o)for(var s=r.viewport,l=2/s.width,u=2/s.height,h=this.geometry.vertexCount-1;h>=0;h--){var f;this.geometry.indices?f=this.geometry.indices[h]:f=h;var c=o[f*2],d=o[f*2+1],v=this.geometry.attributes.size.get(f)/this.sizeScale,p=v/2;if(e>c-p*l&&e<c+p*l&&t>d-p*u&&t<d+p*u){var g=new U.Vector3,m=new U.Vector3;this.geometry.attributes.position.get(f,g.array),U.Vector3.transformMat4(m,g,this.worldTransform),a.push({vertexIndex:f,point:g,pointWorld:m,target:this,distance:m.distance(n.getWorldPosition())})}}},updateNDCPosition:function(e,t,r){var n=this._positionNDC,i=this.geometry;(!n||n.length/2!==i.vertexCount)&&(n=this._positionNDC=new Float32Array(i.vertexCount*2));for(var a=g1.create(),o=0;o<i.vertexCount;o++)i.attributes.position.get(o,a),a[3]=1,g1.transformMat4(a,a,e.array),g1.scale(a,a,1/a[3]),n[o*2]=a[0],n[o*2+1]=a[1]}}),OI=20,FI=-10;function slt(e,t){return e&&t&&e[0]===t[0]&&e[1]===t[1]}function Pu(e,t){this.rootNode=new U.Node,this.is2D=e,this._labelsBuilder=new Xo(256,256,t),this._labelsBuilder.getMesh().renderOrder=100,this.rootNode.add(this._labelsBuilder.getMesh()),this._api=t,this._spriteImageCanvas=document.createElement("canvas"),this._startDataIndex=0,this._endDataIndex=0,this._sizeScale=1}Pu.prototype={constructor:Pu,highlightOnMouseover:!0,update:function(e,t,r,n,i){var a=this._prevMesh;this._prevMesh=this._mesh,this._mesh=a;var o=e.getData();if(n==null&&(n=0),i==null&&(i=o.count()),this._startDataIndex=n,this._endDataIndex=i-1,!this._mesh){var s=this._prevMesh&&this._prevMesh.material;this._mesh=new olt({renderOrder:10,frustumCulling:!1}),s&&(this._mesh.material=s)}var s=this._mesh.material,l=this._mesh.geometry,u=l.attributes;this.rootNode.remove(this._prevMesh),this.rootNode.add(this._mesh),this._setPositionTextureToMesh(this._mesh,this._positionTexture);var h=this._getSymbolInfo(e,n,i),f=r.getDevicePixelRatio(),c=e.getModel("itemStyle").getItemStyle(),d=e.get("large"),v=1;h.maxSize>2?(v=this._updateSymbolSprite(e,c,h,f),s.enableTexture("sprite")):s.disableTexture("sprite"),u.position.init(i-n);var p=[];if(d){s.undefine("VERTEX_SIZE"),s.undefine("VERTEX_COLOR");var g=Qot(o),m=tst(o);U.parseColor(g,p),p[3]*=m,s.set({color:p,u_Size:h.maxSize*this._sizeScale})}else s.set({color:[1,1,1,1]}),s.define("VERTEX_SIZE"),s.define("VERTEX_COLOR"),u.size.init(i-n),u.color.init(i-n),this._originalOpacity=new Float32Array(i-n);for(var _=o.getLayout("points"),y=u.position.value,x=0;x<i-n;x++){var T=x*3,S=x*2;if(this.is2D?(y[T]=_[S],y[T+1]=_[S+1],y[T+2]=FI):(y[T]=_[T],y[T+1]=_[T+1],y[T+2]=_[T+2]),!d){var g=nn(o,x),m=tn(o,x);U.parseColor(g,p),p[3]*=m,u.color.set(x,p),p[3]<.99;var M=o.getItemVisual(x,"symbolSize");M=M instanceof Array?Math.max(M[0],M[1]):M,isNaN(M)&&(M=0),u.size.value[x]=M*v*this._sizeScale,this._originalOpacity[x]=p[3]}}this._mesh.sizeScale=v,l.updateBoundingBox(),l.dirty(),this._updateMaterial(e,c);var w=e.coordinateSystem;if(w&&w.viewGL){var b=w.viewGL.isLinearSpace()?"define":"undefine";s[b]("fragment","SRGB_DECODE")}d||this._updateLabelBuilder(e,n,i),this._updateHandler(e,t,r),this._updateAnimation(e),this._api=r},getPointsMesh:function(){return this._mesh},updateLabels:function(e){this._labelsBuilder.updateLabels(e)},hideLabels:function(){this.rootNode.remove(this._labelsBuilder.getMesh())},showLabels:function(){this.rootNode.add(this._labelsBuilder.getMesh())},dispose:function(){this._labelsBuilder.dispose()},_updateSymbolSprite:function(e,t,r,n){r.maxSize=Math.min(r.maxSize*2,200);var i=[];return r.aspect>1?(i[0]=r.maxSize,i[1]=r.maxSize/r.aspect):(i[1]=r.maxSize,i[0]=r.maxSize*r.aspect),i[0]=i[0]||1,i[1]=i[1]||1,(this._symbolType!==r.type||!slt(this._symbolSize,i)||this._lineWidth!==t.lineWidth)&&(g_.createSymbolSprite(r.type,i,{fill:"#fff",lineWidth:t.lineWidth,stroke:"transparent",shadowColor:"transparent",minMargin:Math.min(i[0]/2,10)},this._spriteImageCanvas),g_.createSDFFromCanvas(this._spriteImageCanvas,Math.min(this._spriteImageCanvas.width,32),OI,this._mesh.material.get("sprite").image),this._symbolType=r.type,this._symbolSize=i,this._lineWidth=t.lineWidth),this._spriteImageCanvas.width/r.maxSize*n},_updateMaterial:function(e,t){var r=e.get("blendMode")==="lighter"?U.additiveBlend:null,n=this._mesh.material;n.blend=r,n.set("lineWidth",t.lineWidth/OI);var i=U.parseColor(t.stroke);n.set("strokeColor",i),n.transparent=!0,n.depthMask=!1,n.depthTest=!this.is2D,n.sortVertices=!this.is2D},_updateLabelBuilder:function(e,o,r){var n=e.getData(),i=this._mesh.geometry,a=i.attributes.position.value,o=this._startDataIndex,s=this._mesh.sizeScale;this._labelsBuilder.updateData(n,o,r),this._labelsBuilder.getLabelPosition=function(l,u,h){var f=(l-o)*3;return[a[f],a[f+1],a[f+2]]},this._labelsBuilder.getLabelDistance=function(l,u,h){var f=i.attributes.size.get(l-o)/s;return f/2+h},this._labelsBuilder.updateLabels()},_updateAnimation:function(e){U.updateVertexAnimation([["prevPosition","position"],["prevSize","size"]],this._prevMesh,this._mesh,e)},_updateHandler:function(e,t,r){var n=e.getData(),i=this._mesh,a=this,o=-1,s=e.coordinateSystem&&e.coordinateSystem.type==="cartesian3D",l;s&&(l=e.coordinateSystem.model),i.seriesIndex=e.seriesIndex,i.off("mousemove"),i.off("mouseout"),i.on("mousemove",function(u){var h=u.vertexIndex+a._startDataIndex;h!==o&&(this.highlightOnMouseover&&(this.downplay(n,o),this.highlight(n,h),this._labelsBuilder.updateLabels([h])),s&&r.dispatchAction({type:"grid3DShowAxisPointer",value:[n.get(e.coordDimToDataDim("x")[0],h),n.get(e.coordDimToDataDim("y")[0],h),n.get(e.coordDimToDataDim("z")[0],h)],grid3DIndex:l.componentIndex})),i.dataIndex=h,o=h},this),i.on("mouseout",function(u){var h=u.vertexIndex+a._startDataIndex;this.highlightOnMouseover&&(this.downplay(n,h),this._labelsBuilder.updateLabels()),o=-1,i.dataIndex=-1,s&&r.dispatchAction({type:"grid3DHideAxisPointer",grid3DIndex:l.componentIndex})},this)},updateLayout:function(e,t,r){var n=e.getData();if(this._mesh){var i=this._mesh.geometry.attributes.position.value,a=n.getLayout("points");if(this.is2D)for(var o=0;o<a.length/2;o++){var s=o*3,l=o*2;i[s]=a[l],i[s+1]=a[l+1],i[s+2]=FI}else for(var o=0;o<a.length;o++)i[o]=a[o];this._mesh.geometry.dirty(),r.getZr().refresh()}},updateView:function(e){if(this._mesh){var t=new Nt;Nt.mul(t,e.viewMatrix,this._mesh.worldTransform),Nt.mul(t,e.projectionMatrix,t),this._mesh.updateNDCPosition(t,this.is2D,this._api)}},highlight:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var r=e.getItemModel(t),n=r.getModel("emphasis.itemStyle"),i=n.get("color"),a=n.get("opacity");if(i==null){var o=nn(e,t);i=uf(o,-.4)}a==null&&(a=tn(e,t));var s=U.parseColor(i);s[3]*=a,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,s),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},downplay:function(e,t){if(!(t>this._endDataIndex||t<this._startDataIndex)){var r=nn(e,t),n=tn(e,t),i=U.parseColor(r);i[3]*=n,this._mesh.geometry.attributes.color.set(t-this._startDataIndex,i),this._mesh.geometry.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeOutAll:function(e){if(this._originalOpacity){for(var t=this._mesh.geometry,r=0;r<t.vertexCount;r++){var n=this._originalOpacity[r]*e;t.attributes.color.value[r*4+3]=n}t.dirtyAttribute("color"),this._api.getZr().refresh()}},fadeInAll:function(){this.fadeOutAll(1)},setPositionTexture:function(e){this._mesh&&this._setPositionTextureToMesh(this._mesh,e),this._positionTexture=e},removePositionTexture:function(){this._positionTexture=null,this._mesh&&this._setPositionTextureToMesh(this._mesh,null)},setSizeScale:function(e){if(e!==this._sizeScale){if(this._mesh){var t=this._mesh.material.get("u_Size");this._mesh.material.set("u_Size",t/this._sizeScale*e);var r=this._mesh.geometry.attributes;if(r.size.value)for(var n=0;n<r.size.value.length;n++)r.size.value[n]=r.size.value[n]/this._sizeScale*e}this._sizeScale=e}},_setPositionTextureToMesh:function(e,t){t&&e.material.set("positionTexture",t),e.material[t?"enableTexture":"disableTexture"]("positionTexture")},_getSymbolInfo:function(e,t,r){if(e.get("large")){var n=Ee.firstNotNull(e.get("symbolSize"),1),s,a;return n instanceof Array?(s=Math.max(n[0],n[1]),a=n[0]/n[1]):(s=n,a=1),{maxSize:n,type:e.get("symbol"),aspect:a}}for(var i=e.getData(),a,o=i.getItemVisual(0,"symbol")||"circle",s=0,l=t;l<r;l++){var n=i.getItemVisual(l,"symbolSize"),u=i.getItemVisual(l,"symbol"),h;if(n instanceof Array)h=n[0]/n[1],s=Math.max(Math.max(n[0],n[1]),s);else{if(isNaN(n))continue;h=1,s=Math.max(n,s)}o=u,a=h}return{maxSize:s,type:o,aspect:a}}};const llt=De.extend({type:"scatter3D",hasSymbolVisual:!0,__ecgl__:!0,init:function(e,t){this.groupGL=new U.Node,this._pointsBuilderList=[],this._currentStep=0},render:function(e,t,r){if(this.groupGL.removeAll(),!!e.getData().count()){var n=e.coordinateSystem;if(n&&n.viewGL){n.viewGL.add(this.groupGL),this._camera=n.viewGL.camera;var i=this._pointsBuilderList[0];i||(i=this._pointsBuilderList[0]=new Pu(!1,r)),this._pointsBuilderList.length=1,this.groupGL.add(i.rootNode),i.update(e,t,r),i.updateView(n.viewGL.camera)}}},incrementalPrepareRender:function(e,t,r){var n=e.coordinateSystem;n&&n.viewGL&&(n.viewGL.add(this.groupGL),this._camera=n.viewGL.camera),this.groupGL.removeAll(),this._currentStep=0},incrementalRender:function(e,t,r,n){if(!(e.end<=e.start)){var i=this._pointsBuilderList[this._currentStep];i||(i=new Pu(!1,n),this._pointsBuilderList[this._currentStep]=i),this.groupGL.add(i.rootNode),i.update(t,r,n,e.start,e.end),i.updateView(t.coordinateSystem.viewGL.camera),this._currentStep++}},updateCamera:function(){this._pointsBuilderList.forEach(function(e){e.updateView(this._camera)},this)},highlight:function(e,t,r,n){this._toggleStatus("highlight",e,t,r,n)},downplay:function(e,t,r,n){this._toggleStatus("downplay",e,t,r,n)},_toggleStatus:function(e,t,r,n,i){var a=t.getData(),o=Ee.queryDataIndex(a,i),s=e==="highlight";o!=null?R($s.normalizeToArray(o),function(l){for(var u=0;u<this._pointsBuilderList.length;u++){var h=this._pointsBuilderList[u];s?h.highlight(a,l):h.downplay(a,l)}},this):a.each(function(l){for(var u=0;u<this._pointsBuilderList.length;u++){var h=this._pointsBuilderList[u];s?h.highlight(a,l):h.downplay(a,l)}})},dispose:function(){this._pointsBuilderList.forEach(function(e){e.dispose()}),this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function ult(e){e.registerChartView(llt),e.registerSeriesModel(elt),e.registerLayout({seriesType:"scatter3D",reset:function(t){var r=t.coordinateSystem;if(r){var n=r.dimensions;if(n.length<3)return;var i=n.map(function(s){return t.coordDimToDataDim(s)[0]}),a=[],o=[];return{progress:function(s,l){for(var u=new Float32Array((s.end-s.start)*3),h=s.start;h<s.end;h++){var f=(h-s.start)*3;a[0]=l.get(i[0],h),a[1]=l.get(i[1],h),a[2]=l.get(i[2],h),r.dataToPoint(a,o),u[f]=o[0],u[f+1]=o[1],u[f+2]=o[2]}l.setLayout("points",u)}}}}})}te(ult);var Wr=Or.vec3,BI=Or.vec2,oo=Wr.normalize,lg=Wr.cross,UI=Wr.sub,m1=Wr.add,As=Wr.create,is=As(),Mi=As(),as=As(),Yc=As(),zI=[],kI=[];function hlt(e,t){BI.copy(zI,e[0]),BI.copy(kI,e[1]);var r=[],n=r[0]=As(),i=r[1]=As(),a=r[2]=As(),o=r[3]=As();t.dataToPoint(zI,n),t.dataToPoint(kI,o),oo(is,n),UI(Mi,o,n),oo(Mi,Mi),lg(as,Mi,is),oo(as,as),lg(Mi,is,as),m1(i,is,Mi),oo(i,i),oo(is,o),UI(Mi,n,o),oo(Mi,Mi),lg(as,Mi,is),oo(as,as),lg(Mi,is,as),m1(a,is,Mi),oo(a,a),m1(Yc,n,o),oo(Yc,Yc);var s=Wr.dot(n,Yc),l=Wr.dot(Yc,i),u=(Math.max(Wr.len(n),Wr.len(o))-s)/l*2;return Wr.scaleAndAdd(i,n,i,u),Wr.scaleAndAdd(a,o,a,u),r}function flt(e,t,r){var n=[],i=n[0]=Wr.create(),a=n[1]=Wr.create(),o=n[2]=Wr.create(),s=n[3]=Wr.create();t.dataToPoint(e[0],i),t.dataToPoint(e[1],s);var l=Wr.dist(i,s);return Wr.lerp(a,i,s,.3),Wr.lerp(o,i,s,.3),Wr.scaleAndAdd(a,a,r,Math.min(l*.1,10)),Wr.scaleAndAdd(o,o,r,Math.min(l*.1,10)),n}function CG(e,t){for(var r=new Float32Array(e.length*3),n=0,i=[],a=0;a<e.length;a++)t.dataToPoint(e[a],i),r[n++]=i[0],r[n++]=i[1],r[n++]=i[2];return r}function DG(e){var t=[];return e.each(function(r){var n=e.getItemModel(r),i=n.option instanceof Array?n.option:n.getShallow("coords",!0);t.push(i)}),{coordsList:t}}function clt(e,t){var r=e.getData(),n=e.get("polyline");r.setLayout("lineType",n?"polyline":"cubicBezier");var i=DG(r);r.each(function(a){var o=i.coordsList[a],s=n?CG:hlt;r.setItemLayout(a,s(o,t))})}function GI(e,t,r){var n=e.getData(),i=e.get("polyline"),a=DG(n);n.setLayout("lineType",i?"polyline":"cubicBezier"),n.each(function(o){var s=a.coordsList[o],l=i?CG(s,t):flt(s,t,r);n.setItemLayout(o,l)})}function dlt(e,t){e.eachSeriesByType("lines3D",function(r){var n=r.coordinateSystem;n.type==="globe"?clt(r,n):n.type==="geo3D"?GI(r,n,[0,1,0]):(n.type==="mapbox3D"||n.type==="maptalks3D")&&GI(r,n,[0,0,1])})}const vlt=Ue.extend({type:"series.lines3D",dependencies:["globe"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",getInitialData:function(e,t){var r=new xr(["value"],this);return r.hasItemOption=!1,r.initData(e.data,[],function(n,i,a,o){if(n instanceof Array)return NaN;r.hasItemOption=!0;var s=n.value;if(s!=null)return s instanceof Array?s[o]:s}),r},defaultOption:{coordinateSystem:"globe",globeIndex:0,geo3DIndex:0,zlevel:-10,polyline:!1,effect:{show:!1,period:4,trailWidth:4,trailLength:.2,spotIntensity:6},silent:!0,blendMode:"source-over",lineStyle:{width:1,opacity:.5}}}),plt=`@export ecgl.trail2.vertex
attribute vec3 position: POSITION;
attribute vec3 positionPrev;
attribute vec3 positionNext;
attribute float offset;
attribute float dist;
attribute float distAll;
attribute float start;

attribute vec4 a_Color : COLOR;

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;
uniform float near : NEAR;

uniform float speed : 0;
uniform float trailLength: 0.3;
uniform float time;
uniform float period: 1000;

uniform float spotSize: 1;

varying vec4 v_Color;
varying float v_Percent;
varying float v_SpotPercent;

@import ecgl.common.wireframe.vertexHeader

@import ecgl.lines3D.clipNear

void main()
{
 @import ecgl.lines3D.expandLine

 gl_Position = currProj;

 v_Color = a_Color;

 @import ecgl.common.wireframe.vertexMain

#ifdef CONSTANT_SPEED
 float t = mod((speed * time + start) / distAll, 1. + trailLength) - trailLength;
#else
 float t = mod((time + start) / period, 1. + trailLength) - trailLength;
#endif

 float trailLen = distAll * trailLength;

 v_Percent = (dist - t * distAll) / trailLen;

 v_SpotPercent = spotSize / distAll;

 }
@end


@export ecgl.trail2.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform float spotIntensity: 5;

varying vec4 v_Color;
varying float v_Percent;
varying float v_SpotPercent;

@import ecgl.common.wireframe.fragmentHeader

@import clay.util.srgb

void main()
{
 if (v_Percent > 1.0 || v_Percent < 0.0) {
 discard;
 }

 float fade = v_Percent;

#ifdef SRGB_DECODE
 gl_FragColor = sRGBToLinear(color * v_Color);
#else
 gl_FragColor = color * v_Color;
#endif

 @import ecgl.common.wireframe.fragmentMain

 if (v_Percent > (1.0 - v_SpotPercent)) {
 gl_FragColor.rgb *= spotIntensity;
 }

 gl_FragColor.a *= fade;
}

@end`;var VI=Or.vec3;function glt(e){return e>0?1:-1}U.Shader.import(plt);const mlt=U.Mesh.extend(function(){var e=new U.Material({shader:new U.Shader(U.Shader.source("ecgl.trail2.vertex"),U.Shader.source("ecgl.trail2.fragment")),transparent:!0,depthMask:!1}),t=new Ys({dynamic:!0});return t.createAttribute("dist","float",1),t.createAttribute("distAll","float",1),t.createAttribute("start","float",1),{geometry:t,material:e,culling:!1,$ignorePicking:!0}},{updateData:function(e,t,r){var n=e.hostModel,i=this.geometry,a=n.getModel("effect"),o=a.get("trailWidth")*t.getDevicePixelRatio(),s=a.get("trailLength"),l=n.get("effect.constantSpeed"),u=n.get("effect.period")*1e3,h=l!=null;h?this.material.set("speed",l/1e3):this.material.set("period",u),this.material[h?"define":"undefine"]("vertex","CONSTANT_SPEED");var f=n.get("polyline");i.trailLength=s,this.material.set("trailLength",s),i.resetOffset(),["position","positionPrev","positionNext"].forEach(function(M){i.attributes[M].value=r.attributes[M].value});var c=["dist","distAll","start","offset","color"];c.forEach(function(M){i.attributes[M].init(i.vertexCount)}),i.indices=r.indices;var d=[],v=a.get("trailColor"),p=a.get("trailOpacity"),g=v!=null,m=p!=null;this.updateWorldTransform();var _=this.worldTransform.x.len(),y=this.worldTransform.y.len(),x=this.worldTransform.z.len(),T=0,S=0;e.each(function(M){var w=e.getItemLayout(M),b=m?p:tn(e,M),A=nn(e,M);b==null&&(b=1),d=U.parseColor(g?v:A,d),d[3]*=b;for(var E=f?r.getPolylineVertexCount(w):r.getCubicCurveVertexCount(w[0],w[1],w[2],w[3]),C=0,D=[],L=[],P=T;P<T+E;P++)i.attributes.position.get(P,D),D[0]*=_,D[1]*=y,D[2]*=x,P>T&&(C+=VI.dist(D,L)),i.attributes.dist.set(P,C),VI.copy(L,D);S=Math.max(S,C);for(var N=Math.random()*(h?C:u),P=T;P<T+E;P++)i.attributes.distAll.set(P,C),i.attributes.start.set(P,N),i.attributes.offset.set(P,glt(r.attributes.offset.get(P))*o/2),i.attributes.color.set(P,d);T+=E}),this.material.set("spotSize",S*.1*s),this.material.set("spotIntensity",a.get("spotIntensity")),i.dirty()},setAnimationTime:function(e){this.material.set("time",e)}});U.Shader.import(v0);function _lt(e){return e.radius!=null?e.radius:e.size!=null?Math.max(e.size[0],e.size[1],e.size[2]):100}const ylt=De.extend({type:"lines3D",__ecgl__:!0,init:function(e,t){this.groupGL=new U.Node,this._meshLinesMaterial=new U.Material({shader:U.createShader("ecgl.meshLines3D"),transparent:!0,depthMask:!1}),this._linesMesh=new U.Mesh({geometry:new Ys,material:this._meshLinesMaterial,$ignorePicking:!0}),this._trailMesh=new mlt},render:function(e,t,r){this.groupGL.add(this._linesMesh);var n=e.coordinateSystem,i=e.getData();if(n&&n.viewGL){var a=n.viewGL;a.add(this.groupGL),this._updateLines(e,t,r);var o=n.viewGL.isLinearSpace()?"define":"undefine";this._linesMesh.material[o]("fragment","SRGB_DECODE"),this._trailMesh.material[o]("fragment","SRGB_DECODE")}var s=this._trailMesh;if(s.stopAnimation(),e.get("effect.show")){this.groupGL.add(s),s.updateData(i,r,this._linesMesh.geometry),s.__time=s.__time||0;var l=3600*1e3;this._curveEffectsAnimator=s.animate("",{loop:!0}).when(l,{__time:l}).during(function(){s.setAnimationTime(s.__time)}).start()}else this.groupGL.remove(s),this._curveEffectsAnimator=null;this._linesMesh.material.blend=this._trailMesh.material.blend=e.get("blendMode")==="lighter"?U.additiveBlend:null},pauseEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.pause()},resumeEffect:function(){this._curveEffectsAnimator&&this._curveEffectsAnimator.resume()},toggleEffect:function(){var e=this._curveEffectsAnimator;e&&(e.isPaused()?e.resume():e.pause())},_updateLines:function(e,t,r){var n=e.getData(),i=e.coordinateSystem,a=this._linesMesh.geometry,o=e.get("polyline");a.expandLine=!0;var s=_lt(i);a.segmentScale=s/20;var l="lineStyle.width".split("."),u=r.getDevicePixelRatio();n.each(function(d){var v=n.getItemModel(d),p=v.get(l);p==null&&(p=1),n.setItemVisual(d,"lineWidth",p)}),a.useNativeLine=!1;var h=0,f=0;n.each(function(d){var v=n.getItemLayout(d);o?(h+=a.getPolylineVertexCount(v),f+=a.getPolylineTriangleCount(v)):(h+=a.getCubicCurveVertexCount(v[0],v[1],v[2],v[3]),f+=a.getCubicCurveTriangleCount(v[0],v[1],v[2],v[3]))}),a.setVertexCount(h),a.setTriangleCount(f),a.resetOffset();var c=[];n.each(function(d){var v=n.getItemLayout(d),p=nn(n,d),g=tn(n,d),m=n.getItemVisual(d,"lineWidth")*u;g==null&&(g=1),c=U.parseColor(p,c),c[3]*=g,o?a.addPolyline(v,c,m):a.addCubicCurve(v[0],v[1],v[2],v[3],c,m)}),a.dirty()},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll()}});function xlt(e){e.registerChartView(ylt),e.registerSeriesModel(vlt),e.registerLayout(dlt),e.registerAction({type:"lines3DPauseEffect",event:"lines3deffectpaused",update:"series.lines3D:pauseEffect"},function(){}),e.registerAction({type:"lines3DResumeEffect",event:"lines3deffectresumed",update:"series.lines3D:resumeEffect"},function(){}),e.registerAction({type:"lines3DToggleEffect",event:"lines3deffectchanged",update:"series.lines3D:toggleEffect"},function(){})}te(xlt);function HI(e,t){for(var r=[],n=0;n<t.length;n++)r.push(e.dataToPoint(t[n]));return r}var LG=Ue.extend({type:"series.polygons3D",getRegionModel:function(e){return this.getData().getItemModel(e)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,r=this.getData().getItemModel(e),n=r.option instanceof Array?r.option:r.getShallow("coords");r.get("multiPolygon")||(n=[n]);for(var i=[],a=0;a<n.length;a++){for(var o=[],s=1;s<n[a].length;s++)o.push(HI(t,n[a][s]));i.push({exterior:HI(t,n[a][0]),interiors:o})}return i},getInitialData:function(e){var t=new xr(["value"],this);return t.hasItemOption=!1,t.initData(e.data,[],function(r,n,i,a){if(r instanceof Array)return NaN;t.hasItemOption=!0;var o=r.value;if(o!=null)return o instanceof Array?o[a]:o}),t},defaultOption:{show:!0,data:null,multiPolygon:!1,progressiveThreshold:1e3,progressive:1e3,zlevel:-10,label:{show:!1,distance:2,textStyle:{fontSize:20,color:"#000",backgroundColor:"rgba(255,255,255,0.7)",padding:3,borderRadius:4}},itemStyle:{color:"#fff",borderWidth:0,borderColor:"#333"},emphasis:{itemStyle:{color:"#639fc0"},label:{show:!0}}}});Ot(LG.prototype,nc);const Slt=De.extend({type:"polygons3D",__ecgl__:!0,init:function(e,t){this.groupGL=new U.Node,this._geo3DBuilderList=[],this._currentStep=0},render:function(e,t,r){this.groupGL.removeAll();var n=e.coordinateSystem;n&&n.viewGL&&n.viewGL.add(this.groupGL);var i=this._geo3DBuilderList[0];i||(i=new Af(r),i.extrudeY=n.type!=="mapbox3D"&&n.type!=="maptalks3D",this._geo3DBuilderList[0]=i),this._updateShaderDefines(n,i),i.update(e,t,r),this._geo3DBuilderList.length=1,this.groupGL.add(i.rootNode)},incrementalPrepareRender:function(e,t,r){this.groupGL.removeAll();var n=e.coordinateSystem;n&&n.viewGL&&n.viewGL.add(this.groupGL),this._currentStep=0},incrementalRender:function(e,t,r,n){var i=this._geo3DBuilderList[this._currentStep],a=t.coordinateSystem;i||(i=new Af(n),i.extrudeY=a.type!=="mapbox3D"&&a.type!=="maptalks3D",this._geo3DBuilderList[this._currentStep]=i),i.update(t,r,n,e.start,e.end),this.groupGL.add(i.rootNode),this._updateShaderDefines(a,i),this._currentStep++},_updateShaderDefines:function(e,t){var r=e.viewGL.isLinearSpace()?"define":"undefine";t.rootNode.traverse(function(n){n.material&&(n.material[r]("fragment","SRGB_DECODE"),(e.type==="mapbox3D"||e.type==="maptalks3D")&&(n.material.define("fragment","NORMAL_UP_AXIS",2),n.material.define("fragment","NORMAL_FRONT_AXIS",1)))})},remove:function(){this.groupGL.removeAll()},dispose:function(){this.groupGL.removeAll(),this._geo3DBuilderList.forEach(function(e){e.dispose()})}});function Tlt(e){e.registerChartView(Slt),e.registerSeriesModel(LG)}te(Tlt);var RG=Ue.extend({type:"series.surface",dependencies:["globe","grid3D","geo3D"],visualStyleAccessPath:"itemStyle",formatTooltip:function(e){return Vv(this,e)},getInitialData:function(e,t){var r=e.data;function n(O){return!(isNaN(O.min)||isNaN(O.max)||isNaN(O.step))}function i(O){var I=Jb;return Math.max(I(O.min),I(O.max),I(O.step))+1}if(!r)if(e.parametric){var x=e.parametricEquation||{},T=x.u||{},S=x.v||{};["u","v"].forEach(function(I){n(x[I])}),["x","y","z"].forEach(function(I){x[I]});var M=Math.floor((T.max+T.step-T.min)/T.step),w=Math.floor((S.max+S.step-S.min)/S.step);r=new Float32Array(M*w*5);for(var b=i(T),A=i(S),c=0,d=0;d<w;d++)for(var v=0;v<M;v++){var E=v*T.step+T.min,C=d*S.step+S.min,D=dr(Math.min(E,T.max),b),L=dr(Math.min(C,S.max),A),p=x.x(D,L),g=x.y(D,L),y=x.z(D,L);r[c++]=p,r[c++]=g,r[c++]=y,r[c++]=D,r[c++]=L}}else{var a=e.equation||{},o=a.x||{},s=a.y||{};if(["x","y"].forEach(function(O){n(a[O])}),typeof a.z!="function")return;var l=Math.floor((o.max+o.step-o.min)/o.step),u=Math.floor((s.max+s.step-s.min)/s.step);r=new Float32Array(l*u*3);for(var h=i(o),f=i(s),c=0,d=0;d<u;d++)for(var v=0;v<l;v++){var p=v*o.step+o.min,g=d*s.step+s.min,m=dr(Math.min(p,o.max),h),_=dr(Math.min(g,s.max),f),y=a.z(m,_);r[c++]=m,r[c++]=_,r[c++]=y}}var P=["x","y","z"];e.parametric&&P.push("u","v");var N=p0(this,P,r);return N},defaultOption:{coordinateSystem:"cartesian3D",zlevel:-10,grid3DIndex:0,shading:"lambert",parametric:!1,wireframe:{show:!0,lineStyle:{color:"rgba(0,0,0,0.5)",width:1}},equation:{x:{min:-1,max:1,step:.1},y:{min:-1,max:1,step:.1},z:null},parametricEquation:{u:{min:-1,max:1,step:.1},v:{min:-1,max:1,step:.1},x:null,y:null,z:null},dataShape:null,itemStyle:{},animationDurationUpdate:500}});Ot(RG.prototype,nc);var Cl=Or.vec3;function blt(e){return isNaN(e[0])||isNaN(e[1])||isNaN(e[2])}const wlt=De.extend({type:"surface",__ecgl__:!0,init:function(e,t){this.groupGL=new U.Node},render:function(e,t,r){var n=this._prevSurfaceMesh;this._prevSurfaceMesh=this._surfaceMesh,this._surfaceMesh=n,this._surfaceMesh||(this._surfaceMesh=this._createSurfaceMesh()),this.groupGL.remove(this._prevSurfaceMesh),this.groupGL.add(this._surfaceMesh);var i=e.coordinateSystem,a=e.get("shading"),o=e.getData(),s="ecgl."+a;if((!this._surfaceMesh.material||this._surfaceMesh.material.shader.name!==s)&&(this._surfaceMesh.material=U.createMaterial(s,["VERTEX_COLOR","DOUBLE_SIDED"])),U.setMaterialFromModel(a,this._surfaceMesh.material,e,r),i&&i.viewGL){i.viewGL.add(this.groupGL);var l=i.viewGL.isLinearSpace()?"define":"undefine";this._surfaceMesh.material[l]("fragment","SRGB_DECODE")}var u=e.get("parametric"),h=e.get("dataShape");h||(h=this._getDataShape(o,u));var f=e.getModel("wireframe"),c=f.get("lineStyle.width"),d=f.get("show")&&c>0;this._updateSurfaceMesh(this._surfaceMesh,e,h,d);var v=this._surfaceMesh.material;d?(v.define("WIREFRAME_QUAD"),v.set("wireframeLineWidth",c),v.set("wireframeLineColor",U.parseColor(f.get("lineStyle.color")))):v.undefine("WIREFRAME_QUAD"),this._initHandler(e,r),this._updateAnimation(e)},_updateAnimation:function(e){U.updateVertexAnimation([["prevPosition","position"],["prevNormal","normal"]],this._prevSurfaceMesh,this._surfaceMesh,e)},_createSurfaceMesh:function(){var e=new U.Mesh({geometry:new U.Geometry({dynamic:!0,sortTriangles:!0}),shadowDepthMaterial:new U.Material({shader:new U.Shader(U.Shader.source("ecgl.sm.depth.vertex"),U.Shader.source("ecgl.sm.depth.fragment"))}),culling:!1,renderOrder:10,renderNormal:!0});return e.geometry.createAttribute("barycentric","float",4),e.geometry.createAttribute("prevPosition","float",3),e.geometry.createAttribute("prevNormal","float",3),Object.assign(e.geometry,hA),e},_initHandler:function(e,t){var r=e.getData(),n=this._surfaceMesh,i=e.coordinateSystem;function a(s,l){for(var u=1/0,h=-1,f=[],c=0;c<s.length;c++){n.geometry.attributes.position.get(s[c],f);var d=Cl.dist(l.array,f);d<u&&(u=d,h=s[c])}return h}n.seriesIndex=e.seriesIndex;var o=-1;n.off("mousemove"),n.off("mouseout"),n.on("mousemove",function(s){var l=a(s.triangle,s.point);if(l>=0){var u=[];n.geometry.attributes.position.get(l,u);for(var h=i.pointToData(u),f=1/0,c=-1,d=[],v=0;v<r.count();v++){d[0]=r.get("x",v),d[1]=r.get("y",v),d[2]=r.get("z",v);var p=Cl.squaredDistance(d,h);p<f&&(c=v,f=p)}c!==o&&t.dispatchAction({type:"grid3DShowAxisPointer",value:h}),o=c,n.dataIndex=c}else n.dataIndex=-1},this),n.on("mouseout",function(s){o=-1,n.dataIndex=-1,t.dispatchAction({type:"grid3DHideAxisPointer"})},this)},_updateSurfaceMesh:function(e,t,r,n){var i=e.geometry,a=t.getData(),o=a.getLayout("points"),s=0;a.each(function(At){a.hasValue(At)||s++});var l=s||n,u=i.attributes.position,h=i.attributes.normal,f=i.attributes.texcoord0,c=i.attributes.barycentric,d=i.attributes.color,v=r[0],p=r[1],g=t.get("shading"),m=g!=="color";if(l){var _=(v-1)*(p-1)*4;u.init(_),n&&c.init(_)}else u.value=new Float32Array(o);d.init(i.vertexCount),f.init(i.vertexCount);var y=[0,3,1,1,3,2],x=[[1,1,0,0],[0,1,0,1],[1,0,0,1],[1,0,1,0]],T=i.indices=new(i.vertexCount>65535?Uint32Array:Uint16Array)((v-1)*(p-1)*6),S=function(At,G,Dt){Dt[1]=At*p+G,Dt[0]=At*p+G+1,Dt[3]=(At+1)*p+G+1,Dt[2]=(At+1)*p+G},M=!1;if(l){var w=[],b=[],A=0;m?h.init(i.vertexCount):h.value=null;for(var E=[[],[],[]],C=[],D=[],L=Cl.create(),P=function(At,G,Dt){var Pt=G*3;return Dt[0]=At[Pt],Dt[1]=At[Pt+1],Dt[2]=At[Pt+2],Dt},N=new Float32Array(o.length),O=new Float32Array(o.length/3*4),I=0;I<a.count();I++)if(a.hasValue(I)){var st=U.parseColor(nn(a,I)),k=tn(a,I);k!=null&&(st[3]*=k),st[3]<.99&&(M=!0);for(var z=0;z<4;z++)O[I*4+z]=st[z]}for(var X=[1e7,1e7,1e7],I=0;I<v-1;I++)for(var Y=0;Y<p-1;Y++){var $=I*(p-1)+Y,H=$*4;S(I,Y,w);for(var Z=!1,z=0;z<4;z++)P(o,w[z],b),blt(b)&&(Z=!0);for(var z=0;z<4;z++)Z?u.set(H+z,X):(P(o,w[z],b),u.set(H+z,b)),n&&c.set(H+z,x[z]);for(var z=0;z<6;z++)T[A++]=y[z]+H;if(m&&!Z)for(var z=0;z<2;z++){for(var ct=z*3,ut=0;ut<3;ut++){var tt=w[y[ct]+ut];P(o,tt,E[ut])}Cl.sub(C,E[0],E[1]),Cl.sub(D,E[1],E[2]),Cl.cross(L,C,D);for(var ut=0;ut<3;ut++){var et=w[y[ct]+ut]*3;N[et]=N[et]+L[0],N[et+1]=N[et+1]+L[1],N[et+2]=N[et+2]+L[2]}}}if(m)for(var I=0;I<N.length/3;I++)P(N,I,L),Cl.normalize(L,L),N[I*3]=L[0],N[I*3+1]=L[1],N[I*3+2]=L[2];for(var st=[],nt=[],I=0;I<v-1;I++)for(var Y=0;Y<p-1;Y++){var $=I*(p-1)+Y,H=$*4;S(I,Y,w);for(var z=0;z<4;z++){for(var ut=0;ut<4;ut++)st[ut]=O[w[z]*4+ut];d.set(H+z,st),m&&(P(N,w[z],L),h.set(H+z,L));var tt=w[z];nt[0]=tt%p/(p-1),nt[1]=Math.floor(tt/p)/(v-1),f.set(H+z,nt)}$++}}else{for(var nt=[],I=0;I<a.count();I++){nt[0]=I%p/(p-1),nt[1]=Math.floor(I/p)/(v-1);var st=U.parseColor(nn(a,I)),k=tn(a,I);k!=null&&(st[3]*=k),st[3]<.99&&(M=!0),d.set(I,st),f.set(I,nt)}for(var w=[],dt=0,I=0;I<v-1;I++)for(var Y=0;Y<p-1;Y++){S(I,Y,w);for(var z=0;z<6;z++)T[dt++]=w[y[z]]}m?i.generateVertexNormals():h.value=null}e.material.get("normalMap")&&i.generateTangents(),i.updateBoundingBox(),i.dirty(),e.material.transparent=M,e.material.depthMask=!M},_getDataShape:function(e,t){for(var r=-1/0,n=0,i=0,a=!1,o=t?"u":"x",s=e.count(),l=0;l<s;l++){var u=e.get(o,l);u<r&&(i=0,n++),r=u,i++}if((!n||i===1)&&(a=!0),!a)return[n+1,i];for(var h=Math.floor(Math.sqrt(s));h>0;){if(Math.floor(s/h)===s/h)return[h,s/h];h--}return h=Math.floor(Math.sqrt(s)),[h,h]},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function Mlt(e){e.registerChartView(wlt),e.registerSeriesModel(RG),e.registerLayout(function(t,r){t.eachSeriesByType("surface",function(n){var i=n.coordinateSystem;!i||i.type;var a=n.getData(),o=new Float32Array(3*a.count()),s=[NaN,NaN,NaN];if(i&&i.type==="cartesian3D"){var l=i.dimensions,u=l.map(function(h){return n.coordDimToDataDim(h)[0]});a.each(u,function(h,f,c,d){var v;a.hasValue(d)?v=i.dataToPoint([h,f,c]):v=s,o[d*3]=v[0],o[d*3+1]=v[1],o[d*3+2]=v[2]})}a.setLayout("points",o)})})}te(Mlt);function WI(e,t){for(var r=[],n=0;n<t.length;n++)r.push(e.dataToPoint(t[n]));return r}var ac=Ue.extend({type:"series.map3D",layoutMode:"box",coordinateSystem:null,visualStyleAccessPath:"itemStyle",optionUpdated:function(e){var t=this.get("coordinateSystem");t==null||t==="geo3D"||(this.get("groundPlane.show")&&(this.option.groundPlane.show=!1),this._geo=null)},getInitialData:function(e){e.data=this.getFilledRegions(e.data,e.map);var t=Ev(e.data,{coordDimensions:["value"]}),r=new xr(t,this);r.initData(e.data);var n={};return r.each(function(i){var a=r.getName(i),o=r.getItemModel(i);n[a]=o}),this._regionModelMap=n,r},formatTooltip:function(e){return Vv(this,e)},getRegionModel:function(e){var t=this.getData().getName(e);return this._regionModelMap[t]||new Ie(null,this)},getRegionPolygonCoords:function(e){var t=this.coordinateSystem,r=this.getData().getName(e);if(t.transform){var n=t.getRegion(r);return n?n.geometries:[]}else{this._geo||(this._geo=fA.createGeo3D(this));for(var n=this._geo.getRegion(r),i=[],a=0;a<n.geometries.length;a++){var o=n.geometries[a],s=[],l=WI(t,o.exterior);if(s&&s.length)for(var u=0;u<o.interiors.length;u++)s.push(WI(t,s[u]));i.push({interiors:s,exterior:l})}return i}},getFormattedLabel:function(e,t){var r=$s.getFormattedLabel(this,e,t);return r==null&&(r=this.getData().getName(e)),r},defaultOption:{coordinateSystem:"geo3D",data:null}});Ot(ac.prototype,uG);Ot(ac.prototype,f0);Ot(ac.prototype,tc);Ot(ac.prototype,ec);Ot(ac.prototype,nc);const Alt=De.extend({type:"map3D",__ecgl__:!0,init:function(e,t){this._geo3DBuilder=new Af(t),this.groupGL=new U.Node},render:function(e,t,r){var n=e.coordinateSystem;if(!(!n||!n.viewGL)){if(this.groupGL.add(this._geo3DBuilder.rootNode),n.viewGL.add(this.groupGL),n.type==="geo3D"){this._sceneHelper||(this._sceneHelper=new ks,this._sceneHelper.initLight(this.groupGL)),this._sceneHelper.setScene(n.viewGL.scene),this._sceneHelper.updateLight(e),n.viewGL.setPostEffect(e.getModel("postEffect"),r),n.viewGL.setTemporalSuperSampling(e.getModel("temporalSuperSampling"));var i=this._control;i||(i=this._control=new zv({zr:r.getZr()}),this._control.init());var a=e.getModel("viewControl");i.setViewGL(n.viewGL),i.setFromViewControlModel(a,0),i.off("update"),i.on("update",function(){r.dispatchAction({type:"map3DChangeCamera",alpha:i.getAlpha(),beta:i.getBeta(),distance:i.getDistance(),from:this.uid,map3DId:e.id})}),this._geo3DBuilder.extrudeY=!0}else this._control&&(this._control.dispose(),this._control=null),this._sceneHelper&&(this._sceneHelper.dispose(),this._sceneHelper=null),e.getData().getLayout("geo3D"),this._geo3DBuilder.extrudeY=!1;this._geo3DBuilder.update(e,t,r,0,e.getData().count());var o=n.viewGL.isLinearSpace()?"define":"undefine";this._geo3DBuilder.rootNode.traverse(function(s){s.material&&s.material[o]("fragment","SRGB_DECODE")})}},afterRender:function(e,t,r,n){var i=n.renderer,a=e.coordinateSystem;a&&a.type==="geo3D"&&(this._sceneHelper.updateAmbientCubemap(i,e,r),this._sceneHelper.updateSkybox(i,e,r))},dispose:function(){this.groupGL.removeAll(),this._control.dispose(),this._geo3DBuilder.dispose()}});function Elt(e){mG(e),e.registerChartView(Alt),e.registerSeriesModel(ac),e.registerAction({type:"map3DChangeCamera",event:"map3dcamerachanged",update:"series:updateCamera"},function(t,r){r.eachComponent({mainType:"series",subType:"map3D",query:t},function(n){n.setView(t)})})}te(Elt);const Clt=Ue.extend({type:"series.scatterGL",dependencies:["grid","polar","geo","singleAxis"],visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,getInitialData:function(){return l9(this)},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,progressive:1e5,progressiveThreshold:1e5,large:!1,symbol:"circle",symbolSize:10,zoomScale:0,blendMode:"source-over",itemStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}});function Yo(e){this.viewGL=e}Yo.prototype.reset=function(e,t){this._updateCamera(t.getWidth(),t.getHeight(),t.getDevicePixelRatio()),this._viewTransform=oi(),this.updateTransform(e,t)};Yo.prototype.updateTransform=function(e,t){var r=e.coordinateSystem;r.getRoamTransform&&(Bu(this._viewTransform,r.getRoamTransform()),this._setCameraTransform(this._viewTransform),t.getZr().refresh())};Yo.prototype.dataToPoint=function(e,t,r){r=e.dataToPoint(t,null,r);var n=this._viewTransform;n&&en(r,r,n)};Yo.prototype.removeTransformInPoint=function(e){return this._viewTransform&&en(e,e,this._viewTransform),e};Yo.prototype.getZoom=function(){if(this._viewTransform){var e=this._viewTransform;return 1/Math.max(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]))}return 1};Yo.prototype._setCameraTransform=function(e){var t=this.viewGL.camera;t.position.set(e[4],e[5],0),t.scale.set(Math.sqrt(e[0]*e[0]+e[1]*e[1]),Math.sqrt(e[2]*e[2]+e[3]*e[3]),1)};Yo.prototype._updateCamera=function(e,t,r){this.viewGL.setViewport(0,0,e,t,r);var n=this.viewGL.camera;n.left=n.top=0,n.bottom=t,n.right=e,n.near=0,n.far=100};const Dlt=De.extend({type:"scatterGL",__ecgl__:!0,init:function(e,t){this.groupGL=new U.Node,this.viewGL=new rr("orthographic"),this.viewGL.add(this.groupGL),this._pointsBuilderList=[],this._currentStep=0,this._sizeScale=1,this._glViewHelper=new Yo(this.viewGL)},render:function(e,t,r){if(this.groupGL.removeAll(),this._glViewHelper.reset(e,r),!!e.getData().count()){var n=this._pointsBuilderList[0];n||(n=this._pointsBuilderList[0]=new Pu(!0,r)),this._pointsBuilderList.length=1,this.groupGL.add(n.rootNode),this._removeTransformInPoints(e.getData().getLayout("points")),n.update(e,t,r),this.viewGL.setPostEffect(e.getModel("postEffect"),r)}},incrementalPrepareRender:function(e,t,r){this.groupGL.removeAll(),this._glViewHelper.reset(e,r),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),r)},incrementalRender:function(e,t,r,n){if(!(e.end<=e.start)){var i=this._pointsBuilderList[this._currentStep];i||(i=new Pu(!0,n),this._pointsBuilderList[this._currentStep]=i),this.groupGL.add(i.rootNode),this._removeTransformInPoints(t.getData().getLayout("points")),i.setSizeScale(this._sizeScale),i.update(t,r,n,e.start,e.end),n.getZr().refresh(),this._currentStep++}},updateTransform:function(e,t,r){if(e.coordinateSystem.getRoamTransform){this._glViewHelper.updateTransform(e,r);var n=this._glViewHelper.getZoom(),i=Math.max((e.get("zoomScale")||0)*(n-1)+1,0);this._sizeScale=i,this._pointsBuilderList.forEach(function(a){a.setSizeScale(i)})}},_removeTransformInPoints:function(e){if(e)for(var t=[],r=0;r<e.length;r+=2)t[0]=e[r],t[1]=e[r+1],this._glViewHelper.removeTransformInPoint(t),e[r]=t[0],e[r+1]=t[1]},dispose:function(){this.groupGL.removeAll(),this._pointsBuilderList.forEach(function(e){e.dispose()})},remove:function(){this.groupGL.removeAll()}});function Llt(e){e.registerChartView(Dlt),e.registerSeriesModel(Clt),e.registerLayout({seriesType:"scatterGL",reset:function(t){var r=t.coordinateSystem,n=t.getData(),i;if(r){var a=r.dimensions.map(function(s){return n.mapDimension(s)}).slice(0,2),o=[];a.length===1?i=function(s){for(var l=new Float32Array((s.end-s.start)*2),u=s.start;u<s.end;u++){var h=(u-s.start)*2,f=n.get(a[0],u),c=r.dataToPoint(f);l[h]=c[0],l[h+1]=c[1]}n.setLayout("points",l)}:a.length===2&&(i=function(s){for(var l=new Float32Array((s.end-s.start)*2),u=s.start;u<s.end;u++){var h=(u-s.start)*2,f=n.get(a[0],u),c=n.get(a[1],u);o[0]=f,o[1]=c,o=r.dataToPoint(o),l[h]=o[0],l[h+1]=o[1]}n.setLayout("points",l)})}return{progress:i}}})}te(Llt);function Rlt(e,t,r,n,i){for(var a=new HU(n),o=0;o<e.length;o++)a.addNode(Ee.firstNotNull(e[o].id,e[o].name,o),o);for(var s=[],l=[],u=0,o=0;o<t.length;o++){var h=t[o],f=h.source,c=h.target;a.addEdge(f,c,u)&&(l.push(h),s.push(Ee.firstNotNull(h.id,f+" > "+c)),u++)}var d,v=Ev(e,{coordDimensions:["value"]});d=new xr(v,r),d.initData(e);var p=new xr(["value"],r);return p.initData(l,s),i(d,p),uM({mainData:d,struct:a,structAttr:"graph",datas:{node:d,edge:p},datasAttr:{node:"data",edge:"edgeData"}}),a.update(),a}var cd=Ue.extend({type:"series.graphGL",visualStyleAccessPath:"itemStyle",hasSymbolVisual:!0,init:function(e){cd.superApply(this,"init",arguments),this.legendDataProvider=function(){return this._categoriesData},this._updateCategoriesData()},mergeOption:function(e){cd.superApply(this,"mergeOption",arguments),this._updateCategoriesData()},getFormattedLabel:function(e,t,r,n){var i=$s.getFormattedLabel(this,e,t,r,n);if(i==null){var a=this.getData(),o=a.dimensions[a.dimensions.length-1];i=a.get(o,e)}return i},getInitialData:function(e,t){var r=e.edges||e.links||[],n=e.data||e.nodes||[],i=this;return Rlt(n,r,this,!0,a).data;function a(o,s){o.wrapMethod("getItemModel",function(f){const c=i._categoriesModels,d=f.getShallow("category"),v=c[d];return v&&(v.parentModel=f.parentModel,f.parentModel=v),f});const l=t.getModel([]).getModel;function u(f,c){const d=l.call(this,f,c);return d.resolveParentPath=h,d}s.wrapMethod("getItemModel",function(f){return f.resolveParentPath=h,f.getModel=u,f});function h(f){if(f&&(f[0]==="label"||f[1]==="label")){const c=f.slice();return f[0]==="label"?c[0]="edgeLabel":f[1]==="label"&&(c[1]="edgeLabel"),c}return f}}},getGraph:function(){return this.getData().graph},getEdgeData:function(){return this.getGraph().edgeData},getCategoriesData:function(){return this._categoriesData},formatTooltip:function(e,t,r){if(r==="edge"){var n=this.getData(),i=this.getDataParams(e,r),a=n.graph.getEdgeByIndex(e),o=n.getName(a.node1.dataIndex),s=n.getName(a.node2.dataIndex),l=[];return o!=null&&l.push(o),s!=null&&l.push(s),l=Br(l.join(" > ")),i.value&&(l+=" : "+Br(i.value)),l}else return cd.superApply(this,"formatTooltip",arguments)},_updateCategoriesData:function(){var e=(this.option.categories||[]).map(function(r){return r.value!=null?r:Object.assign({value:0},r)}),t=new xr(["value"],this);t.initData(e),this._categoriesData=t,this._categoriesModels=t.mapArray(function(r){return t.getItemModel(r,!0)})},setView:function(e){e.zoom!=null&&(this.option.zoom=e.zoom),e.offset!=null&&(this.option.offset=e.offset)},setNodePosition:function(e){for(var t=0;t<e.length/2;t++){var r=e[t*2],n=e[t*2+1],i=this.getData().getRawDataItem(t);i.x=r,i.y=n}},isAnimationEnabled:function(){return cd.superCall(this,"isAnimationEnabled")&&!(this.get("layout")==="force"&&this.get("force.layoutAnimation"))},defaultOption:{zlevel:10,z:2,legendHoverLink:!0,layout:"forceAtlas2",forceAtlas2:{initLayout:null,GPU:!0,steps:1,maxSteps:1e3,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,edgeWeightInfluence:1,edgeWeight:[1,4],nodeWeight:[1,4],preventOverlap:!1,gravityCenter:null},focusNodeAdjacency:!0,focusNodeAdjacencyOn:"mouseover",left:"center",top:"center",symbol:"circle",symbolSize:5,roam:!1,center:null,zoom:1,label:{show:!1,formatter:"{b}",position:"right",distance:5,textStyle:{fontSize:14}},itemStyle:{},lineStyle:{color:"#aaa",width:1,opacity:.5},emphasis:{label:{show:!0}},animation:!1}}),Vr=Or.vec2,XI=[[0,0],[1,1]],mA=Ce.extend(function(){return{segmentScale:4,dynamic:!0,useNativeLine:!0,attributes:{position:new Ce.Attribute("position","float",2,"POSITION"),normal:new Ce.Attribute("normal","float",2),offset:new Ce.Attribute("offset","float",1),color:new Ce.Attribute("color","float",4,"COLOR")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0,this._itemVertexOffsets=[]},setVertexCount:function(e){var t=this.attributes;this.vertexCount!==e&&(t.position.init(e),t.color.init(e),this.useNativeLine||(t.offset.init(e),t.normal.init(e)),e>65535?this.indices instanceof Uint16Array&&(this.indices=new Uint32Array(this.indices)):this.indices instanceof Uint32Array&&(this.indices=new Uint16Array(this.indices)))},setTriangleCount:function(e){this.triangleCount!==e&&(e===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(e*3):new Uint16Array(e*3))},_getCubicCurveApproxStep:function(e,t,r,n){var i=Vr.dist(e,t)+Vr.dist(r,t)+Vr.dist(n,r),a=1/(i+1)*this.segmentScale;return a},getCubicCurveVertexCount:function(e,t,r,n){var i=this._getCubicCurveApproxStep(e,t,r,n),a=Math.ceil(1/i);return this.useNativeLine?a*2:a*2+2},getCubicCurveTriangleCount:function(e,t,r,n){var i=this._getCubicCurveApproxStep(e,t,r,n),a=Math.ceil(1/i);return this.useNativeLine?0:a*2},getLineVertexCount:function(){return this.getPolylineVertexCount(XI)},getLineTriangleCount:function(){return this.getPolylineTriangleCount(XI)},getPolylineVertexCount:function(e){var t;if(typeof e=="number")t=e;else{var r=typeof e[0]!="number";t=r?e.length:e.length/2}return this.useNativeLine?(t-1)*2:(t-1)*2+2},getPolylineTriangleCount:function(e){var t;if(typeof e=="number")t=e;else{var r=typeof e[0]!="number";t=r?e.length:e.length/2}return this.useNativeLine?0:(t-1)*2},addCubicCurve:function(e,t,r,n,i,a){a==null&&(a=1);for(var o=e[0],s=e[1],l=t[0],u=t[1],h=r[0],f=r[1],c=n[0],d=n[1],v=this._getCubicCurveApproxStep(e,t,r,n),p=v*v,g=p*v,m=3*v,_=3*p,y=6*p,x=6*g,T=o-l*2+h,S=s-u*2+f,M=(l-h)*3-o+c,w=(u-f)*3-s+d,b=o,A=s,E=(l-o)*m+T*_+M*g,C=(u-s)*m+S*_+w*g,D=T*y+M*x,L=S*y+w*x,P=M*x,N=w*x,O=0,I=0,k=Math.ceil(1/v),z=new Float32Array((k+1)*3),z=[],X=0,I=0;I<k+1;I++)z[X++]=b,z[X++]=A,b+=E,A+=C,E+=D,C+=L,D+=P,L+=N,O+=v,O>1&&(b=E>0?Math.min(b,c):Math.max(b,c),A=C>0?Math.min(A,d):Math.max(A,d));this.addPolyline(z,i,a)},addLine:function(e,t,r,n){this.addPolyline([e,t],r,n)},addPolyline:function(){var e=Vr.create(),t=Vr.create(),r=Vr.create(),n=Vr.create(),i=[],a=[],o=[];return function(s,l,u,h,f){if(s.length){var c=typeof s[0]!="number";if(f==null&&(f=c?s.length:s.length/2),!(f<2)){h==null&&(h=0),u==null&&(u=1),this._itemVertexOffsets.push(this._vertexOffset);for(var d=c?typeof l[0]!="number":l.length/4===f,v=this.attributes.position,p=this.attributes.color,g=this.attributes.offset,m=this.attributes.normal,_=this.indices,y=this._vertexOffset,x,T=0;T<f;T++){if(c)i=s[T+h],d?x=l[T+h]:x=l;else{var S=T*2+h;if(i=i||[],i[0]=s[S],i[1]=s[S+1],d){var M=T*4+h;x=x||[],x[0]=l[M],x[1]=l[M+1],x[2]=l[M+2],x[3]=l[M+3]}else x=l}if(this.useNativeLine)T>1&&(v.copy(y,y-1),p.copy(y,y-1),y++);else{var w;if(T<f-1){if(c)Vr.copy(a,s[T+1]);else{var S=(T+1)*2+h;a=a||[],a[0]=s[S],a[1]=s[S+1]}if(T>0){Vr.sub(e,i,o),Vr.sub(t,a,i),Vr.normalize(e,e),Vr.normalize(t,t),Vr.add(n,e,t),Vr.normalize(n,n);var b=u/2*Math.min(1/Vr.dot(e,n),2);r[0]=-n[1],r[1]=n[0],w=b}else Vr.sub(e,a,i),Vr.normalize(e,e),r[0]=-e[1],r[1]=e[0],w=u/2}else Vr.sub(e,i,o),Vr.normalize(e,e),r[0]=-e[1],r[1]=e[0],w=u/2;m.set(y,r),m.set(y+1,r),g.set(y,w),g.set(y+1,-w),Vr.copy(o,i),v.set(y,i),v.set(y+1,i),p.set(y,x),p.set(y+1,x),y+=2}if(this.useNativeLine)p.set(y,x),v.set(y,i),y++;else if(T>0){var A=this._faceOffset*3,_=this.indices;_[A]=y-4,_[A+1]=y-3,_[A+2]=y-2,_[A+3]=y-3,_[A+4]=y-1,_[A+5]=y-2,this._faceOffset+=2}}this._vertexOffset=y}}}}(),setItemColor:function(e,t){for(var r=this._itemVertexOffsets[e],n=e<this._itemVertexOffsets.length-1?this._itemVertexOffsets[e+1]:this._vertexOffset,i=r;i<n;i++)this.attributes.color.set(i,t);this.dirty("color")}});Vt(mA.prototype,kv);const Plt=`@export ecgl.forceAtlas2.updateNodeRepulsion

#define NODE_COUNT 0

uniform sampler2D positionTex;

uniform vec2 textureSize;
uniform float gravity;
uniform float scaling;
uniform vec2 gravityCenter;

uniform bool strongGravityMode;
uniform bool preventOverlap;

varying vec2 v_Texcoord;

void main() {

 vec4 n0 = texture2D(positionTex, v_Texcoord);

 vec2 force = vec2(0.0);
 for (int i = 0; i < NODE_COUNT; i++) {
 vec2 uv = vec2(
 mod(float(i), textureSize.x) / (textureSize.x - 1.0),
 floor(float(i) / textureSize.x) / (textureSize.y - 1.0)
 );
 vec4 n1 = texture2D(positionTex, uv);

 vec2 dir = n0.xy - n1.xy;
 float d2 = dot(dir, dir);

 if (d2 > 0.0) {
 float factor = 0.0;
 if (preventOverlap) {
 float d = sqrt(d2);
 d = d - n0.w - n1.w;
 if (d > 0.0) {
 factor = scaling * n0.z * n1.z / (d * d);
 }
 else if (d < 0.0) {
 factor = scaling * 100.0 * n0.z * n1.z;
 }
 }
 else {
 factor = scaling * n0.z * n1.z / d2;
 }
 force += dir * factor;
 }
 }

 vec2 dir = gravityCenter - n0.xy;
 float d = 1.0;
 if (!strongGravityMode) {
 d = length(dir);
 }

 force += dir * n0.z * gravity / (d + 1.0);

 gl_FragColor = vec4(force, 0.0, 1.0);
}
@end

@export ecgl.forceAtlas2.updateEdgeAttraction.vertex

attribute vec2 node1;
attribute vec2 node2;
attribute float weight;

uniform sampler2D positionTex;
uniform float edgeWeightInfluence;
uniform bool preventOverlap;
uniform bool linLogMode;

uniform vec2 windowSize: WINDOW_SIZE;

varying vec2 v_Force;

void main() {

 vec4 n0 = texture2D(positionTex, node1);
 vec4 n1 = texture2D(positionTex, node2);

 vec2 dir = n1.xy - n0.xy;
 float d = length(dir);
 float w;
 if (edgeWeightInfluence == 0.0) {
 w = 1.0;
 }
 else if (edgeWeightInfluence == 1.0) {
 w = weight;
 }
 else {
 w = pow(weight, edgeWeightInfluence);
 }
 vec2 offset = vec2(1.0 / windowSize.x, 1.0 / windowSize.y);
 vec2 scale = vec2((windowSize.x - 1.0) / windowSize.x, (windowSize.y - 1.0) / windowSize.y);
 vec2 pos = node1 * scale * 2.0 - 1.0;
 gl_Position = vec4(pos + offset, 0.0, 1.0);
 gl_PointSize = 1.0;

 float factor;
 if (preventOverlap) {
 d = d - n1.w - n0.w;
 }
 if (d <= 0.0) {
 v_Force = vec2(0.0);
 return;
 }

 if (linLogMode) {
 factor = w * log(d) / d;
 }
 else {
 factor = w;
 }
 v_Force = dir * factor;
}
@end

@export ecgl.forceAtlas2.updateEdgeAttraction.fragment

varying vec2 v_Force;

void main() {
 gl_FragColor = vec4(v_Force, 0.0, 0.0);
}
@end

@export ecgl.forceAtlas2.calcWeightedSum.vertex

attribute vec2 node;

varying vec2 v_NodeUv;

void main() {

 v_NodeUv = node;
 gl_Position = vec4(0.0, 0.0, 0.0, 1.0);
 gl_PointSize = 1.0;
}
@end

@export ecgl.forceAtlas2.calcWeightedSum.fragment

varying vec2 v_NodeUv;

uniform sampler2D positionTex;
uniform sampler2D forceTex;
uniform sampler2D forcePrevTex;

void main() {
 vec2 force = texture2D(forceTex, v_NodeUv).rg;
 vec2 forcePrev = texture2D(forcePrevTex, v_NodeUv).rg;

 float mass = texture2D(positionTex, v_NodeUv).z;
 float swing = length(force - forcePrev) * mass;
 float traction = length(force + forcePrev) * 0.5 * mass;

 gl_FragColor = vec4(swing, traction, 0.0, 0.0);
}
@end

@export ecgl.forceAtlas2.calcGlobalSpeed

uniform sampler2D globalSpeedPrevTex;
uniform sampler2D weightedSumTex;
uniform float jitterTolerence;

void main() {
 vec2 weightedSum = texture2D(weightedSumTex, vec2(0.5)).xy;
 float prevGlobalSpeed = texture2D(globalSpeedPrevTex, vec2(0.5)).x;
 float globalSpeed = jitterTolerence * jitterTolerence
 * weightedSum.y / weightedSum.x;
 if (prevGlobalSpeed > 0.0) {
 globalSpeed = min(globalSpeed / prevGlobalSpeed, 1.5) * prevGlobalSpeed;
 }
 gl_FragColor = vec4(globalSpeed, 0.0, 0.0, 1.0);
}
@end

@export ecgl.forceAtlas2.updatePosition

uniform sampler2D forceTex;
uniform sampler2D forcePrevTex;
uniform sampler2D positionTex;
uniform sampler2D globalSpeedTex;

varying vec2 v_Texcoord;

void main() {
 vec2 force = texture2D(forceTex, v_Texcoord).xy;
 vec2 forcePrev = texture2D(forcePrevTex, v_Texcoord).xy;
 vec4 node = texture2D(positionTex, v_Texcoord);

 float globalSpeed = texture2D(globalSpeedTex, vec2(0.5)).r;
 float swing = length(force - forcePrev);
 float speed = 0.1 * globalSpeed / (0.1 + globalSpeed * sqrt(swing));

 float df = length(force);
 if (df > 0.0) {
 speed = min(df * speed, 10.0) / df;

 gl_FragColor = vec4(node.xy + speed * force, node.zw);
 }
 else {
 gl_FragColor = node;
 }
}
@end

@export ecgl.forceAtlas2.edges.vertex
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec2 node;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

uniform sampler2D positionTex;

void main()
{
 gl_Position = worldViewProjection * vec4(
 texture2D(positionTex, node).xy, -10.0, 1.0
 );
 v_Color = a_Color;
}
@end

@export ecgl.forceAtlas2.edges.fragment
uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
varying vec4 v_Color;
void main() {
 gl_FragColor = color * v_Color;
}
@end`;U.Shader.import(Plt);var _1={repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null};function Zr(e){var t={type:U.Texture.FLOAT,minFilter:U.Texture.NEAREST,magFilter:U.Texture.NEAREST};this._positionSourceTex=new U.Texture2D(t),this._positionSourceTex.flipY=!1,this._positionTex=new U.Texture2D(t),this._positionPrevTex=new U.Texture2D(t),this._forceTex=new U.Texture2D(t),this._forcePrevTex=new U.Texture2D(t),this._weightedSumTex=new U.Texture2D(t),this._weightedSumTex.width=this._weightedSumTex.height=1,this._globalSpeedTex=new U.Texture2D(t),this._globalSpeedPrevTex=new U.Texture2D(t),this._globalSpeedTex.width=this._globalSpeedTex.height=1,this._globalSpeedPrevTex.width=this._globalSpeedPrevTex.height=1,this._nodeRepulsionPass=new kr({fragment:U.Shader.source("ecgl.forceAtlas2.updateNodeRepulsion")}),this._positionPass=new kr({fragment:U.Shader.source("ecgl.forceAtlas2.updatePosition")}),this._globalSpeedPass=new kr({fragment:U.Shader.source("ecgl.forceAtlas2.calcGlobalSpeed")}),this._copyPass=new kr({fragment:U.Shader.source("clay.compositor.output")});var r=function(n){n.blendEquation(n.FUNC_ADD),n.blendFunc(n.ONE,n.ONE)};this._edgeForceMesh=new U.Mesh({geometry:new U.Geometry({attributes:{node1:new U.Geometry.Attribute("node1","float",2),node2:new U.Geometry.Attribute("node2","float",2),weight:new U.Geometry.Attribute("weight","float",1)},dynamic:!0,mainAttribute:"node1"}),material:new U.Material({transparent:!0,shader:U.createShader("ecgl.forceAtlas2.updateEdgeAttraction"),blend:r,depthMask:!1,depthText:!1}),mode:U.Mesh.POINTS}),this._weightedSumMesh=new U.Mesh({geometry:new U.Geometry({attributes:{node:new U.Geometry.Attribute("node","float",2)},dynamic:!0,mainAttribute:"node"}),material:new U.Material({transparent:!0,shader:U.createShader("ecgl.forceAtlas2.calcWeightedSum"),blend:r,depthMask:!1,depthText:!1}),mode:U.Mesh.POINTS}),this._framebuffer=new Ir({depthBuffer:!1}),this._dummyCamera=new U.OrthographicCamera({left:-1,right:1,top:1,bottom:-1,near:0,far:100}),this._globalSpeed=0}Zr.prototype.updateOption=function(e){for(var t in _1)this[t]=_1[t];var r=this._nodes.length;if(r>5e4?this.jitterTolerence=10:r>5e3?this.jitterTolerence=1:this.jitterTolerence=.1,r>100?this.scaling=2:this.scaling=10,e)for(var t in _1)e[t]!=null&&(this[t]=e[t]);if(this.repulsionByDegree)for(var n=this._positionSourceTex.pixels,i=0;i<this._nodes.length;i++)n[i*4+2]=(this._nodes[i].degree||0)+1};Zr.prototype._updateGravityCenter=function(e){var t=this._nodes,r=this._edges;if(this.gravityCenter)this._gravityCenter=this.gravityCenter;else{for(var n=[1/0,1/0],i=[-1/0,-1/0],a=0;a<t.length;a++)n[0]=Math.min(t[a].x,n[0]),n[1]=Math.min(t[a].y,n[1]),i[0]=Math.max(t[a].x,i[0]),i[1]=Math.max(t[a].y,i[1]);this._gravityCenter=[(n[0]+i[0])*.5,(n[1]+i[1])*.5]}for(var a=0;a<r.length;a++){var o=r[a].node1,s=r[a].node2;t[o].degree=(t[o].degree||0)+1,t[s].degree=(t[s].degree||0)+1}};Zr.prototype.initData=function(e,t){this._nodes=e,this._edges=t,this._updateGravityCenter();var r=Math.ceil(Math.sqrt(e.length)),n=r,i=new Float32Array(r*n*4);this._resize(r,n);for(var a=0,o=0;o<e.length;o++){var s=e[o];i[a++]=s.x||0,i[a++]=s.y||0,i[a++]=s.mass||1,i[a++]=s.size||1}this._positionSourceTex.pixels=i;var l=this._edgeForceMesh.geometry,u=t.length;l.attributes.node1.init(u*2),l.attributes.node2.init(u*2),l.attributes.weight.init(u*2);for(var h=[],o=0;o<t.length;o++){var f=l.attributes,c=t[o].weight;c==null&&(c=1),f.node1.set(o,this.getNodeUV(t[o].node1,h)),f.node2.set(o,this.getNodeUV(t[o].node2,h)),f.weight.set(o,c),f.node1.set(o+u,this.getNodeUV(t[o].node2,h)),f.node2.set(o+u,this.getNodeUV(t[o].node1,h)),f.weight.set(o+u,c)}var d=this._weightedSumMesh.geometry;d.attributes.node.init(e.length);for(var o=0;o<e.length;o++)d.attributes.node.set(o,this.getNodeUV(o,h));l.dirty(),d.dirty(),this._nodeRepulsionPass.material.define("fragment","NODE_COUNT",e.length),this._nodeRepulsionPass.material.setUniform("textureSize",[r,n]),this._inited=!1,this._frame=0};Zr.prototype.getNodes=function(){return this._nodes};Zr.prototype.getEdges=function(){return this._edges};Zr.prototype.step=function(e){this._inited||(this._initFromSource(e),this._inited=!0),this._frame++,this._framebuffer.attach(this._forceTex),this._framebuffer.bind(e);var t=this._nodeRepulsionPass;t.setUniform("strongGravityMode",this.strongGravityMode),t.setUniform("gravity",this.gravity),t.setUniform("gravityCenter",this._gravityCenter),t.setUniform("scaling",this.scaling),t.setUniform("preventOverlap",this.preventOverlap),t.setUniform("positionTex",this._positionPrevTex),t.render(e);var r=this._edgeForceMesh;r.material.set("linLogMode",this.linLogMode),r.material.set("edgeWeightInfluence",this.edgeWeightInfluence),r.material.set("preventOverlap",this.preventOverlap),r.material.set("positionTex",this._positionPrevTex),e.gl.enable(e.gl.BLEND),e.renderPass([r],this._dummyCamera),this._framebuffer.attach(this._weightedSumTex),e.gl.clearColor(0,0,0,0),e.gl.clear(e.gl.COLOR_BUFFER_BIT),e.gl.enable(e.gl.BLEND);var n=this._weightedSumMesh;n.material.set("positionTex",this._positionPrevTex),n.material.set("forceTex",this._forceTex),n.material.set("forcePrevTex",this._forcePrevTex),e.renderPass([n],this._dummyCamera),this._framebuffer.attach(this._globalSpeedTex);var i=this._globalSpeedPass;i.setUniform("globalSpeedPrevTex",this._globalSpeedPrevTex),i.setUniform("weightedSumTex",this._weightedSumTex),i.setUniform("jitterTolerence",this.jitterTolerence),e.gl.disable(e.gl.BLEND),i.render(e);var a=this._positionPass;this._framebuffer.attach(this._positionTex),a.setUniform("globalSpeedTex",this._globalSpeedTex),a.setUniform("positionTex",this._positionPrevTex),a.setUniform("forceTex",this._forceTex),a.setUniform("forcePrevTex",this._forcePrevTex),a.render(e),this._framebuffer.unbind(e),this._swapTexture()};Zr.prototype.update=function(e,t,r){t==null&&(t=1),t=Math.max(t,1);for(var n=0;n<t;n++)this.step(e);r&&r()};Zr.prototype.getNodePositionTexture=function(){return this._inited?this._positionPrevTex:this._positionSourceTex};Zr.prototype.getNodeUV=function(e,t){t=t||[];var r=this._positionTex.width,n=this._positionTex.height;return t[0]=e%r/(r-1),t[1]=Math.floor(e/r)/(n-1)||0,t};Zr.prototype.getNodePosition=function(e,t){var r=this._positionArr,n=this._positionTex.width,i=this._positionTex.height,a=n*i;(!r||r.length!==a*4)&&(r=this._positionArr=new Float32Array(a*4)),this._framebuffer.bind(e),this._framebuffer.attach(this._positionPrevTex),e.gl.readPixels(0,0,n,i,e.gl.RGBA,e.gl.FLOAT,r),this._framebuffer.unbind(e),t||(t=new Float32Array(this._nodes.length*2));for(var o=0;o<this._nodes.length;o++)t[o*2]=r[o*4],t[o*2+1]=r[o*4+1];return t};Zr.prototype.getTextureData=function(e,t){var r=this["_"+t+"Tex"],n=r.width,i=r.height;this._framebuffer.bind(e),this._framebuffer.attach(r);var a=new Float32Array(n*i*4);return e.gl.readPixels(0,0,n,i,e.gl.RGBA,e.gl.FLOAT,a),this._framebuffer.unbind(e),a};Zr.prototype.getTextureSize=function(){return{width:this._positionTex.width,height:this._positionTex.height}};Zr.prototype.isFinished=function(e){return this._frame>e};Zr.prototype._swapTexture=function(){var e=this._positionPrevTex;this._positionPrevTex=this._positionTex,this._positionTex=e;var e=this._forcePrevTex;this._forcePrevTex=this._forceTex,this._forceTex=e;var e=this._globalSpeedPrevTex;this._globalSpeedPrevTex=this._globalSpeedTex,this._globalSpeedTex=e};Zr.prototype._initFromSource=function(e){this._framebuffer.attach(this._positionPrevTex),this._framebuffer.bind(e),this._copyPass.setUniform("texture",this._positionSourceTex),this._copyPass.render(e),e.gl.clearColor(0,0,0,0),this._framebuffer.attach(this._forcePrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.attach(this._globalSpeedPrevTex),e.gl.clear(e.gl.COLOR_BUFFER_BIT),this._framebuffer.unbind(e)};Zr.prototype._resize=function(e,t){["_positionSourceTex","_positionTex","_positionPrevTex","_forceTex","_forcePrevTex"].forEach(function(r){this[r].width=e,this[r].height=t,this[r].dirty()},this)};Zr.prototype.dispose=function(e){this._framebuffer.dispose(e),this._copyPass.dispose(e),this._nodeRepulsionPass.dispose(e),this._positionPass.dispose(e),this._globalSpeedPass.dispose(e),this._edgeForceMesh.geometry.dispose(e),this._weightedSumMesh.geometry.dispose(e),this._positionSourceTex.dispose(e),this._positionTex.dispose(e),this._positionPrevTex.dispose(e),this._forceTex.dispose(e),this._forcePrevTex.dispose(e),this._weightedSumTex.dispose(e),this._globalSpeedTex.dispose(e),this._globalSpeedPrevTex.dispose(e)};function Ilt(){var e={create:function(){return new Float32Array(2)},dist:function(l,u){var h=u[0]-l[0],f=u[1]-l[1];return Math.sqrt(h*h+f*f)},len:function(l){var u=l[0],h=l[1];return Math.sqrt(u*u+h*h)},scaleAndAdd:function(l,u,h,f){return l[0]=u[0]+h[0]*f,l[1]=u[1]+h[1]*f,l},scale:function(l,u,h){return l[0]=u[0]*h,l[1]=u[1]*h,l},add:function(l,u,h){return l[0]=u[0]+h[0],l[1]=u[1]+h[1],l},sub:function(l,u,h){return l[0]=u[0]-h[0],l[1]=u[1]-h[1],l},normalize:function(l,u){var h=u[0],f=u[1],c=h*h+f*f;return c>0&&(c=1/Math.sqrt(c),l[0]=u[0]*c,l[1]=u[1]*c),l},negate:function(l,u){return l[0]=-u[0],l[1]=-u[1],l},copy:function(l,u){return l[0]=u[0],l[1]=u[1],l},set:function(l,u,h){return l[0]=u,l[1]=h,l}};function t(){this.subRegions=[],this.nSubRegions=0,this.node=null,this.mass=0,this.centerOfMass=null,this.bbox=new Float32Array(4),this.size=0}var r=t.prototype;r.beforeUpdate=function(){for(var l=0;l<this.nSubRegions;l++)this.subRegions[l].beforeUpdate();this.mass=0,this.centerOfMass&&(this.centerOfMass[0]=0,this.centerOfMass[1]=0),this.nSubRegions=0,this.node=null},r.afterUpdate=function(){this.subRegions.length=this.nSubRegions;for(var l=0;l<this.nSubRegions;l++)this.subRegions[l].afterUpdate()},r.addNode=function(l){if(this.nSubRegions===0)if(this.node==null){this.node=l;return}else this._addNodeToSubRegion(this.node),this.node=null;this._addNodeToSubRegion(l),this._updateCenterOfMass(l)},r.findSubRegion=function(l,u){for(var h=0;h<this.nSubRegions;h++){var f=this.subRegions[h];if(f.contain(l,u))return f}},r.contain=function(l,u){return this.bbox[0]<=l&&this.bbox[2]>=l&&this.bbox[1]<=u&&this.bbox[3]>=u},r.setBBox=function(l,u,h,f){this.bbox[0]=l,this.bbox[1]=u,this.bbox[2]=h,this.bbox[3]=f,this.size=(h-l+f-u)/2},r._newSubRegion=function(){var l=this.subRegions[this.nSubRegions];return l||(l=new t,this.subRegions[this.nSubRegions]=l),this.nSubRegions++,l},r._addNodeToSubRegion=function(l){var u=this.findSubRegion(l.position[0],l.position[1]),h=this.bbox;if(!u){var f=(h[0]+h[2])/2,c=(h[1]+h[3])/2,d=(h[2]-h[0])/2,v=(h[3]-h[1])/2,p=l.position[0]>=f?1:0,g=l.position[1]>=c?1:0,u=this._newSubRegion();u.setBBox(p*d+h[0],g*v+h[1],(p+1)*d+h[0],(g+1)*v+h[1])}u.addNode(l)},r._updateCenterOfMass=function(l){this.centerOfMass==null&&(this.centerOfMass=new Float32Array(2));var u=this.centerOfMass[0]*this.mass,h=this.centerOfMass[1]*this.mass;u+=l.position[0]*l.mass,h+=l.position[1]*l.mass,this.mass+=l.mass,this.centerOfMass[0]=u/this.mass,this.centerOfMass[1]=h/this.mass};function n(){this.position=new Float32Array(2),this.force=e.create(),this.forcePrev=e.create(),this.mass=1,this.inDegree=0,this.outDegree=0}function i(l,u){this.source=l,this.target=u,this.weight=1}function a(){this.autoSettings=!0,this.barnesHutOptimize=!0,this.barnesHutTheta=1.5,this.repulsionByDegree=!0,this.linLogMode=!1,this.strongGravityMode=!1,this.gravity=1,this.scaling=1,this.edgeWeightInfluence=1,this.jitterTolerence=.1,this.preventOverlap=!1,this.dissuadeHubs=!1,this.rootRegion=new t,this.rootRegion.centerOfMass=e.create(),this.nodes=[],this.edges=[],this.bbox=new Float32Array(4),this.gravityCenter=null,this._massArr=null,this._swingingArr=null,this._sizeArr=null,this._globalSpeed=0}var o=a.prototype;o.initNodes=function(l,u,h){var f=u.length;this.nodes.length=0;for(var c=typeof h<"u",d=0;d<f;d++){var v=new n;v.position[0]=l[d*2],v.position[1]=l[d*2+1],v.mass=u[d],c&&(v.size=h[d]),this.nodes.push(v)}this._massArr=u,this._swingingArr=new Float32Array(f),c&&(this._sizeArr=h)},o.initEdges=function(l,u){var h=l.length/2;this.edges.length=0;for(var f=0;f<h;f++){var c=l[f*2],d=l[f*2+1],v=this.nodes[c],p=this.nodes[d];if(!v||!p){console.error("Node not exists, try initNodes before initEdges");return}v.outDegree++,p.inDegree++;var g=new i(v,p);u&&(g.weight=u[f]),this.edges.push(g)}},o.updateSettings=function(){if(this.repulsionByDegree)for(var l=0;l<this.nodes.length;l++){var u=this.nodes[l];u.mass=u.inDegree+u.outDegree+1}else for(var l=0;l<this.nodes.length;l++){var u=this.nodes[l];u.mass=this._massArr[l]}},o.update=function(){var l=this.nodes.length;if(this.updateSettings(),this.updateBBox(),this.barnesHutOptimize){this.rootRegion.setBBox(this.bbox[0],this.bbox[1],this.bbox[2],this.bbox[3]),this.rootRegion.beforeUpdate();for(var u=0;u<l;u++)this.rootRegion.addNode(this.nodes[u]);this.rootRegion.afterUpdate()}for(var u=0;u<l;u++){var h=this.nodes[u];e.copy(h.forcePrev,h.force),e.set(h.force,0,0)}for(var u=0;u<l;u++){var f=this.nodes[u];if(this.barnesHutOptimize)this.applyRegionToNodeRepulsion(this.rootRegion,f);else for(var c=u+1;c<l;c++){var d=this.nodes[c];this.applyNodeToNodeRepulsion(f,d,!1)}this.gravity>0&&(this.strongGravityMode?this.applyNodeStrongGravity(f):this.applyNodeGravity(f))}for(var u=0;u<this.edges.length;u++)this.applyEdgeAttraction(this.edges[u]);for(var v=0,p=0,g=e.create(),u=0;u<l;u++){var h=this.nodes[u],m=e.dist(h.force,h.forcePrev);v+=m*h.mass,e.add(g,h.force,h.forcePrev);var _=e.len(g)*.5;p+=_*h.mass,this._swingingArr[u]=m}var y=this.jitterTolerence*this.jitterTolerence*p/v;this._globalSpeed>0&&(y=Math.min(y/this._globalSpeed,1.5)*this._globalSpeed),this._globalSpeed=y;for(var u=0;u<l;u++){var h=this.nodes[u],m=this._swingingArr[u],x=.1*y/(1+y*Math.sqrt(m)),T=e.len(h.force);T>0&&(x=Math.min(T*x,10)/T,e.scaleAndAdd(h.position,h.position,h.force,x))}},o.applyRegionToNodeRepulsion=function(){var l=e.create();return function(h,f){if(h.node)this.applyNodeToNodeRepulsion(h.node,f,!0);else{e.sub(l,f.position,h.centerOfMass);var c=l[0]*l[0]+l[1]*l[1];if(c>this.barnesHutTheta*h.size*h.size){var d=this.scaling*f.mass*h.mass/c;e.scaleAndAdd(f.force,f.force,l,d)}else for(var v=0;v<h.nSubRegions;v++)this.applyRegionToNodeRepulsion(h.subRegions[v],f)}}}(),o.applyNodeToNodeRepulsion=function(){var l=e.create();return function(h,f,c){if(h!=f){e.sub(l,h.position,f.position);var d=l[0]*l[0]+l[1]*l[1];if(d!==0){var v;if(this.preventOverlap){var p=Math.sqrt(d);if(p=p-h.size-f.size,p>0)v=this.scaling*h.mass*f.mass/(p*p);else if(p<0)v=this.scaling*100*h.mass*f.mass;else return}else v=this.scaling*h.mass*f.mass/d;e.scaleAndAdd(h.force,h.force,l,v),e.scaleAndAdd(f.force,f.force,l,-v)}}}}(),o.applyEdgeAttraction=function(){var l=e.create();return function(h){var f=h.source,c=h.target;e.sub(l,f.position,c.position);var d=e.len(l),v;this.edgeWeightInfluence===0?v=1:this.edgeWeightInfluence===1?v=h.weight:v=Math.pow(h.weight,this.edgeWeightInfluence);var p;this.preventOverlap&&(d=d-f.size-c.size,d<=0)||(this.linLogMode?p=-v*Math.log(d+1)/(d+1):p=-v,e.scaleAndAdd(f.force,f.force,l,p),e.scaleAndAdd(c.force,c.force,l,-p))}}(),o.applyNodeGravity=function(){var l=e.create();return function(u){e.sub(l,this.gravityCenter,u.position);var h=e.len(l);e.scaleAndAdd(u.force,u.force,l,this.gravity*u.mass/(h+1))}}(),o.applyNodeStrongGravity=function(){var l=e.create();return function(u){e.sub(l,this.gravityCenter,u.position),e.scaleAndAdd(u.force,u.force,l,this.gravity*u.mass)}}(),o.updateBBox=function(){for(var l=1/0,u=1/0,h=-1/0,f=-1/0,c=0;c<this.nodes.length;c++){var d=this.nodes[c].position;l=Math.min(l,d[0]),u=Math.min(u,d[1]),h=Math.max(h,d[0]),f=Math.max(f,d[1])}this.bbox[0]=l,this.bbox[1]=u,this.bbox[2]=h,this.bbox[3]=f},o.getGlobalSpeed=function(){return this._globalSpeed};var s=null;self.onmessage=function(l){switch(l.data.cmd){case"init":s=new a,s.initNodes(l.data.nodesPosition,l.data.nodesMass,l.data.nodesSize),s.initEdges(l.data.edges,l.data.edgesWeight);break;case"updateConfig":if(s)for(var u in l.data.config)s[u]=l.data.config[u];break;case"update":var h=l.data.steps;if(s){for(var f=0;f<h;f++)s.update();for(var c=s.nodes.length,d=new Float32Array(c*2),f=0;f<c;f++){var v=s.nodes[f];d[f*2]=v.position[0],d[f*2+1]=v.position[1]}self.postMessage({buffer:d.buffer,globalSpeed:s.getGlobalSpeed()},[d.buffer])}else{var p=new Float32Array;self.postMessage({buffer:p.buffer,globalSpeed:s.getGlobalSpeed()},[p.buffer])}break}}}var dd=Ilt.toString();dd=dd.slice(dd.indexOf("{")+1,dd.lastIndexOf("}"));var Pd={barnesHutOptimize:!0,barnesHutTheta:1.5,repulsionByDegree:!0,linLogMode:!1,strongGravityMode:!1,gravity:1,scaling:1,edgeWeightInfluence:1,jitterTolerence:.1,preventOverlap:!1,dissuadeHubs:!1,gravityCenter:null},ci=function(e){for(var t in Pd)this[t]=Pd[t];if(e)for(var t in e)this[t]=e[t];this._nodes=[],this._edges=[],this._disposed=!1,this._positionTex=new xe({type:Mt.FLOAT,flipY:!1,minFilter:Mt.NEAREST,magFilter:Mt.NEAREST})};ci.prototype.initData=function(e,t){var r=new Blob([dd]),n=window.URL.createObjectURL(r);this._worker=new Worker(n),this._worker.onmessage=this._$onupdate.bind(this),this._nodes=e,this._edges=t,this._frame=0;for(var i=e.length,a=t.length,o=new Float32Array(i*2),s=new Float32Array(i),l=new Float32Array(i),u=new Float32Array(a*2),h=new Float32Array(a),f=0;f<e.length;f++){var c=e[f];o[f*2]=c.x,o[f*2+1]=c.y,s[f]=c.mass==null?1:c.mass,l[f]=c.size==null?1:c.size}for(var f=0;f<t.length;f++){var d=t[f],v=d.node1,p=d.node2;u[f*2]=v,u[f*2+1]=p,h[f]=d.weight==null?1:d.weight}var g=Math.ceil(Math.sqrt(e.length)),m=g,_=new Float32Array(g*m*4),y=this._positionTex;y.width=g,y.height=m,y.pixels=_,this._worker.postMessage({cmd:"init",nodesPosition:o,nodesMass:s,nodesSize:l,edges:u,edgesWeight:h}),this._globalSpeed=1/0};ci.prototype.updateOption=function(e){var t={};for(var r in Pd)t[r]=Pd[r];var n=this._nodes,i=this._edges,a=n.length;if(a>5e4?t.jitterTolerence=10:a>5e3?t.jitterTolerence=1:t.jitterTolerence=.1,a>100?t.scaling=2:t.scaling=10,a>1e3?t.barnesHutOptimize=!0:t.barnesHutOptimize=!1,e)for(var r in Pd)e[r]!=null&&(t[r]=e[r]);if(!t.gravityCenter){for(var o=[1/0,1/0],s=[-1/0,-1/0],l=0;l<n.length;l++)o[0]=Math.min(n[l].x,o[0]),o[1]=Math.min(n[l].y,o[1]),s[0]=Math.max(n[l].x,s[0]),s[1]=Math.max(n[l].y,s[1]);t.gravityCenter=[(o[0]+s[0])*.5,(o[1]+s[1])*.5]}for(var l=0;l<i.length;l++){var u=i[l].node1,h=i[l].node2;n[u].degree=(n[u].degree||0)+1,n[h].degree=(n[h].degree||0)+1}this._worker&&this._worker.postMessage({cmd:"updateConfig",config:t})};ci.prototype.update=function(e,t,r){t==null&&(t=1),t=Math.max(t,1),this._frame+=t,this._onupdate=r,this._worker&&this._worker.postMessage({cmd:"update",steps:Math.round(t)})};ci.prototype._$onupdate=function(e){if(!this._disposed){var t=new Float32Array(e.data.buffer);this._globalSpeed=e.data.globalSpeed,this._positionArr=t,this._updateTexture(t),this._onupdate&&this._onupdate()}};ci.prototype.getNodePositionTexture=function(){return this._positionTex};ci.prototype.getNodeUV=function(e,t){t=t||[];var r=this._positionTex.width,n=this._positionTex.height;return t[0]=e%r/(r-1),t[1]=Math.floor(e/r)/(n-1),t};ci.prototype.getNodes=function(){return this._nodes};ci.prototype.getEdges=function(){return this._edges};ci.prototype.isFinished=function(e){return this._frame>e};ci.prototype.getNodePosition=function(e,t){if(t||(t=new Float32Array(this._nodes.length*2)),this._positionArr)for(var r=0;r<this._positionArr.length;r++)t[r]=this._positionArr[r];return t};ci.prototype._updateTexture=function(e){for(var t=this._positionTex.pixels,r=0,n=0;n<e.length;)t[r++]=e[n++],t[r++]=e[n++],t[r++]=1,t[r++]=1;this._positionTex.dirty()};ci.prototype.dispose=function(e){this._disposed=!0,this._worker=null};var Nlt=gn.extend(function(){return{zr:null,viewGL:null,minZoom:.2,maxZoom:5,_needsUpdate:!1,_dx:0,_dy:0,_zoom:1}},function(){this._mouseDownHandler=this._mouseDownHandler.bind(this),this._mouseWheelHandler=this._mouseWheelHandler.bind(this),this._mouseMoveHandler=this._mouseMoveHandler.bind(this),this._mouseUpHandler=this._mouseUpHandler.bind(this),this._update=this._update.bind(this)},{init:function(){var e=this.zr;e.on("mousedown",this._mouseDownHandler),e.on("mousewheel",this._mouseWheelHandler),e.on("globalout",this._mouseUpHandler),e.animation.on("frame",this._update)},setTarget:function(e){this._target=e},setZoom:function(e){this._zoom=Math.max(Math.min(e,this.maxZoom),this.minZoom),this._needsUpdate=!0},setOffset:function(e){this._dx=e[0],this._dy=e[1],this._needsUpdate=!0},getZoom:function(){return this._zoom},getOffset:function(){return[this._dx,this._dy]},_update:function(){if(this._target&&this._needsUpdate){var e=this._target,t=this._zoom;e.position.x=this._dx,e.position.y=this._dy,e.scale.set(t,t,t),this.zr.refresh(),this._needsUpdate=!1,this.trigger("update")}},_mouseDownHandler:function(e){if(!e.target){var t=e.offsetX,r=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(t,r))){this.zr.on("mousemove",this._mouseMoveHandler),this.zr.on("mouseup",this._mouseUpHandler);var n=this._convertPos(t,r);this._x=n.x,this._y=n.y}}},_convertPos:function(e,t){var r=this.viewGL.camera,n=this.viewGL.viewport;return{x:(e-n.x)/n.width*(r.right-r.left)+r.left,y:(t-n.y)/n.height*(r.bottom-r.top)+r.top}},_mouseMoveHandler:function(e){var t=this._convertPos(e.offsetX,e.offsetY);this._dx+=t.x-this._x,this._dy+=t.y-this._y,this._x=t.x,this._y=t.y,this._needsUpdate=!0},_mouseUpHandler:function(e){this.zr.off("mousemove",this._mouseMoveHandler),this.zr.off("mouseup",this._mouseUpHandler)},_mouseWheelHandler:function(e){e=e.event;var t=e.wheelDelta||-e.detail;if(t!==0){var r=e.offsetX,n=e.offsetY;if(!(this.viewGL&&!this.viewGL.containPoint(r,n))){var i=t>0?1.1:.9,a=Math.max(Math.min(this._zoom*i,this.maxZoom),this.minZoom);i=a/this._zoom;var o=this._convertPos(r,n),s=(o.x-this._dx)*(i-1),l=(o.y-this._dy)*(i-1);this._dx-=s,this._dy-=l,this._zoom=a,this._needsUpdate=!0}}},dispose:function(){var e=this.zr;e.off("mousedown",this._mouseDownHandler),e.off("mousemove",this._mouseMoveHandler),e.off("mouseup",this._mouseUpHandler),e.off("mousewheel",this._mouseWheelHandler),e.off("globalout",this._mouseUpHandler),e.animation.off("frame",this._update)}});const Olt=`@export ecgl.lines2D.vertex

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

attribute vec2 position: POSITION;
attribute vec4 a_Color : COLOR;
varying vec4 v_Color;

#ifdef POSITIONTEXTURE_ENABLED
uniform sampler2D positionTexture;
#endif

void main()
{
 gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);

 v_Color = a_Color;
}

@end

@export ecgl.lines2D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;

void main()
{
 gl_FragColor = color * v_Color;
}
@end


@export ecgl.meshLines2D.vertex

attribute vec2 position: POSITION;
attribute vec2 normal;
attribute float offset;
attribute vec4 a_Color : COLOR;

uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;
uniform vec4 viewport : VIEWPORT;

varying vec4 v_Color;
varying float v_Miter;

void main()
{
 vec4 p2 = worldViewProjection * vec4(position + normal, -10.0, 1.0);
 gl_Position = worldViewProjection * vec4(position, -10.0, 1.0);

 p2.xy /= p2.w;
 gl_Position.xy /= gl_Position.w;

 vec2 N = normalize(p2.xy - gl_Position.xy);
 gl_Position.xy += N * offset / viewport.zw * 2.0;

 gl_Position.xy *= gl_Position.w;

 v_Color = a_Color;
}
@end


@export ecgl.meshLines2D.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];

varying vec4 v_Color;
varying float v_Miter;

void main()
{
 gl_FragColor = color * v_Color;
}

@end`;var ug=Or.vec2;U.Shader.import(Olt);var Flt=1;const Blt=De.extend({type:"graphGL",__ecgl__:!0,init:function(e,t){this.groupGL=new U.Node,this.viewGL=new rr("orthographic"),this.viewGL.camera.left=this.viewGL.camera.right=0,this.viewGL.add(this.groupGL),this._pointsBuilder=new Pu(!0,t),this._forceEdgesMesh=new U.Mesh({material:new U.Material({shader:U.createShader("ecgl.forceAtlas2.edges"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new U.Geometry({attributes:{node:new U.Geometry.Attribute("node","float",2),color:new U.Geometry.Attribute("color","float",4,"COLOR")},dynamic:!0,mainAttribute:"node"}),renderOrder:-1,mode:U.Mesh.LINES}),this._edgesMesh=new U.Mesh({material:new U.Material({shader:U.createShader("ecgl.meshLines2D"),transparent:!0,depthMask:!1,depthTest:!1}),$ignorePicking:!0,geometry:new mA({useNativeLine:!1,dynamic:!0}),renderOrder:-1,culling:!1}),this._layoutId=0,this._control=new Nlt({zr:t.getZr(),viewGL:this.viewGL}),this._control.setTarget(this.groupGL),this._control.init(),this._clickHandler=this._clickHandler.bind(this)},render:function(e,t,r){this.groupGL.add(this._pointsBuilder.rootNode),this._model=e,this._api=r,this._initLayout(e,t,r),this._pointsBuilder.update(e,t,r),this._forceLayoutInstance instanceof Zr||this.groupGL.remove(this._forceEdgesMesh),this._updateCamera(e,r),this._control.off("update"),this._control.on("update",function(){r.dispatchAction({type:"graphGLRoam",seriesId:e.id,zoom:this._control.getZoom(),offset:this._control.getOffset()}),this._pointsBuilder.updateView(this.viewGL.camera)},this),this._control.setZoom(Ee.firstNotNull(e.get("zoom"),1)),this._control.setOffset(e.get("offset")||[0,0]);var n=this._pointsBuilder.getPointsMesh();if(n.off("mousemove",this._mousemoveHandler),n.off("mouseout",this._mouseOutHandler,this),r.getZr().off("click",this._clickHandler),this._pointsBuilder.highlightOnMouseover=!0,e.get("focusNodeAdjacency")){var i=e.get("focusNodeAdjacencyOn");i==="click"?r.getZr().on("click",this._clickHandler):i==="mouseover"&&(n.on("mousemove",this._mousemoveHandler,this),n.on("mouseout",this._mouseOutHandler,this),this._pointsBuilder.highlightOnMouseover=!1)}this._lastMouseOverDataIndex=-1},_clickHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id})}},_mousemoveHandler:function(e){if(!this._layouting){var t=this._pointsBuilder.getPointsMesh().dataIndex;t>=0?t!==this._lastMouseOverDataIndex&&this._api.dispatchAction({type:"graphGLFocusNodeAdjacency",seriesId:this._model.id,dataIndex:t}):this._mouseOutHandler(e),this._lastMouseOverDataIndex=t}},_mouseOutHandler:function(e){this._layouting||(this._api.dispatchAction({type:"graphGLUnfocusNodeAdjacency",seriesId:this._model.id}),this._lastMouseOverDataIndex=-1)},_updateForceEdgesGeometry:function(e,t){var r=this._forceEdgesMesh.geometry,n=t.getEdgeData(),i=0,a=this._forceLayoutInstance,o=n.count()*2;r.attributes.node.init(o),r.attributes.color.init(o),n.each(function(s){var l=e[s];r.attributes.node.set(i,a.getNodeUV(l.node1)),r.attributes.node.set(i+1,a.getNodeUV(l.node2));var u=nn(n,l.dataIndex),h=U.parseColor(u);h[3]*=Ee.firstNotNull(tn(n,l.dataIndex),1),r.attributes.color.set(i,h),r.attributes.color.set(i+1,h),i+=2}),r.dirty()},_updateMeshLinesGeometry:function(){var t=this._model.getEdgeData(),e=this._edgesMesh.geometry,t=this._model.getEdgeData(),r=this._model.getData().getLayout("points");e.resetOffset(),e.setVertexCount(t.count()*e.getLineVertexCount()),e.setTriangleCount(t.count()*e.getLineTriangleCount());var n=[],i=[],a=["lineStyle","width"];this._originalEdgeColors=new Float32Array(t.count()*4),this._edgeIndicesMap=new Float32Array(t.count()),t.each(function(o){var s=t.graph.getEdgeByIndex(o),l=s.node1.dataIndex*2,u=s.node2.dataIndex*2;n[0]=r[l],n[1]=r[l+1],i[0]=r[u],i[1]=r[u+1];var h=nn(t,s.dataIndex),f=U.parseColor(h);f[3]*=Ee.firstNotNull(tn(t,s.dataIndex),1);var c=t.getItemModel(s.dataIndex),d=Ee.firstNotNull(c.get(a),1)*this._api.getDevicePixelRatio();e.addLine(n,i,f,d);for(var v=0;v<4;v++)this._originalEdgeColors[s.dataIndex*4+v]=f[v];this._edgeIndicesMap[s.dataIndex]=o},this),e.dirty()},_updateForceNodesGeometry:function(e){for(var t=this._pointsBuilder.getPointsMesh(),r=[],n=0;n<e.count();n++)this._forceLayoutInstance.getNodeUV(n,r),t.geometry.attributes.position.set(n,r);t.geometry.dirty("position")},_initLayout:function(e,t,r){var n=e.get("layout"),i=e.getGraph(),a=e.getBoxLayoutParams(),o=Mr(a,{width:r.getWidth(),height:r.getHeight()});n==="force"&&(n="forceAtlas2"),this.stopLayout(e,t,r,{beforeLayout:!0});var s=e.getData(),l=e.getData();if(n==="forceAtlas2"){var u=e.getModel("forceAtlas2"),h=this._forceLayoutInstance,f=[],c=[],d=s.getDataExtent("value"),v=l.getDataExtent("value"),p=Ee.firstNotNull(u.get("edgeWeight"),1),g=Ee.firstNotNull(u.get("nodeWeight"),1);typeof p=="number"&&(p=[p,p]),typeof g=="number"&&(g=[g,g]);var m=0,_={},y=new Float32Array(s.count()*2);if(i.eachNode(function(T){var S=T.dataIndex,M=s.get("value",S),w,b;if(s.hasItemOption){var A=s.getItemModel(S);w=A.get("x"),b=A.get("y")}w==null&&(w=o.x+Math.random()*o.width,b=o.y+Math.random()*o.height),y[m*2]=w,y[m*2+1]=b,_[T.id]=m++;var E=He(M,d,g);isNaN(E)&&(isNaN(g[0])?E=1:E=g[0]),f.push({x:w,y:b,mass:E,size:s.getItemVisual(S,"symbolSize")})}),s.setLayout("points",y),i.eachEdge(function(T){var S=T.dataIndex,M=s.get("value",S),w=He(M,v,p);isNaN(w)&&(isNaN(p[0])?w=1:w=p[0]),c.push({node1:_[T.node1.id],node2:_[T.node2.id],weight:w,dataIndex:S})}),!h){var x=u.get("GPU");this._forceLayoutInstance&&(x&&!(this._forceLayoutInstance instanceof Zr)||!x&&!(this._forceLayoutInstance instanceof ci))&&(this._forceLayoutInstanceToDispose=this._forceLayoutInstance),h=this._forceLayoutInstance=x?new Zr:new ci}h.initData(f,c),h.updateOption(u.option),this._updateForceEdgesGeometry(h.getEdges(),e),this._updatePositionTexture(),r.dispatchAction({type:"graphGLStartLayout",from:this.uid})}else{var y=new Float32Array(s.count()*2),m=0;i.eachNode(function(M){var w=M.dataIndex,b,A;if(s.hasItemOption){var E=s.getItemModel(w);b=E.get("x"),A=E.get("y")}y[m++]=b,y[m++]=A}),s.setLayout("points",y),this._updateAfterLayout(e,t,r)}},_updatePositionTexture:function(){var e=this._forceLayoutInstance.getNodePositionTexture();this._pointsBuilder.setPositionTexture(e),this._forceEdgesMesh.material.set("positionTex",e)},startLayout:function(e,t,a,n){if(!(n&&n.from!=null&&n.from!==this.uid)){var i=this.viewGL,a=this._api,o=this._forceLayoutInstance,s=this._model.getData(),l=this._model.getModel("forceAtlas2");if(o&&(this.groupGL.remove(this._edgesMesh),this.groupGL.add(this._forceEdgesMesh),!!this._forceLayoutInstance)){this._updateForceNodesGeometry(e.getData()),this._pointsBuilder.hideLabels();var u=this,h=this._layoutId=Flt++,f=l.getShallow("maxSteps"),c=l.getShallow("steps"),d=0,v=Math.max(c*2,20),p=function(g){if(g===u._layoutId){if(o.isFinished(f)){a.dispatchAction({type:"graphGLStopLayout",from:u.uid}),a.dispatchAction({type:"graphGLFinishLayout",points:s.getLayout("points"),from:u.uid});return}o.update(i.layer.renderer,c,function(){u._updatePositionTexture(),d+=c,d>=v&&(u._syncNodePosition(e),d=0),a.getZr().refresh(),xu(function(){p(g)})})}};xu(function(){u._forceLayoutInstanceToDispose&&(u._forceLayoutInstanceToDispose.dispose(i.layer.renderer),u._forceLayoutInstanceToDispose=null),p(h)}),this._layouting=!0}}},stopLayout:function(e,t,r,n){n&&n.from!=null&&n.from!==this.uid||(this._layoutId=0,this.groupGL.remove(this._forceEdgesMesh),this.groupGL.add(this._edgesMesh),this._forceLayoutInstance&&this.viewGL.layer&&(n&&n.beforeLayout||(this._syncNodePosition(e),this._updateAfterLayout(e,t,r)),this._api.getZr().refresh(),this._layouting=!1))},_syncNodePosition:function(e){var t=this._forceLayoutInstance.getNodePosition(this.viewGL.layer.renderer);e.getData().setLayout("points",t),e.setNodePosition(t)},_updateAfterLayout:function(e,t,r){this._updateMeshLinesGeometry(),this._pointsBuilder.removePositionTexture(),this._pointsBuilder.updateLayout(e,t,r),this._pointsBuilder.updateView(this.viewGL.camera),this._pointsBuilder.updateLabels(),this._pointsBuilder.showLabels()},focusNodeAdjacency:function(e,t,r,n){var i=this._model.getData();this._downplayAll();var a=n.dataIndex,o=i.graph,s=[],l=o.getNodeByIndex(a);s.push(l),l.edges.forEach(function(h){h.dataIndex<0||(h.node1!==l&&s.push(h.node1),h.node2!==l&&s.push(h.node2))},this),this._pointsBuilder.fadeOutAll(.05),this._fadeOutEdgesAll(.05),s.forEach(function(h){this._pointsBuilder.highlight(i,h.dataIndex)},this),this._pointsBuilder.updateLabels(s.map(function(h){return h.dataIndex}));var u=[];l.edges.forEach(function(h){h.dataIndex>=0&&(this._highlightEdge(h.dataIndex),u.push(h))},this),this._focusNodes=s,this._focusEdges=u},unfocusNodeAdjacency:function(e,t,r,n){this._downplayAll(),this._pointsBuilder.fadeInAll(),this._fadeInEdgesAll(),this._pointsBuilder.updateLabels()},_highlightEdge:function(e){var t=this._model.getEdgeData().getItemModel(e),r=U.parseColor(t.get("emphasis.lineStyle.color")||t.get("lineStyle.color")),n=Ee.firstNotNull(t.get("emphasis.lineStyle.opacity"),t.get("lineStyle.opacity"),1);r[3]*=n,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],r)},_downplayAll:function(){this._focusNodes&&this._focusNodes.forEach(function(e){this._pointsBuilder.downplay(this._model.getData(),e.dataIndex)},this),this._focusEdges&&this._focusEdges.forEach(function(e){this._downplayEdge(e.dataIndex)},this)},_downplayEdge:function(e){var t=this._getColor(e,[]);this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[e],t)},_setEdgeFade:function(){var e=[];return function(t,r){this._getColor(t,e),e[3]*=r,this._edgesMesh.geometry.setItemColor(this._edgeIndicesMap[t],e)}}(),_getColor:function(e,t){for(var r=0;r<4;r++)t[r]=this._originalEdgeColors[e*4+r];return t},_fadeOutEdgesAll:function(e){var t=this._model.getData().graph;t.eachEdge(function(r){this._setEdgeFade(r.dataIndex,e)},this)},_fadeInEdgesAll:function(){this._fadeOutEdgesAll(1)},_updateCamera:function(e,t){this.viewGL.setViewport(0,0,t.getWidth(),t.getHeight(),t.getDevicePixelRatio());for(var r=this.viewGL.camera,n=e.getData(),i=n.getLayout("points"),a=ug.create(1/0,1/0),o=ug.create(-1/0,-1/0),s=[],l=0;l<i.length;)s[0]=i[l++],s[1]=i[l++],ug.min(a,a,s),ug.max(o,o,s);var u=(o[1]+a[1])/2,h=(o[0]+a[0])/2;if(!(h>r.left&&h<r.right&&u<r.bottom&&u>r.top)){var f=Math.max(o[0]-a[0],10),c=f/t.getWidth()*t.getHeight();f*=1.4,c*=1.4,a[0]-=f*.2,r.left=a[0],r.top=u-c/2,r.bottom=u+c/2,r.right=f+a[0],r.near=0,r.far=100}},dispose:function(){var e=this.viewGL.layer.renderer;this._forceLayoutInstance&&this._forceLayoutInstance.dispose(e),this.groupGL.removeAll(),this._layoutId=-1,this._pointsBuilder.dispose()},remove:function(){this.groupGL.removeAll(),this._control.dispose()}});function hg(e){return e instanceof Array||(e=[e,e]),e}function Ult(e){e.registerChartView(Blt),e.registerSeriesModel(cd),e.registerVisual(function(r){const n={};r.eachSeriesByType("graphGL",function(i){var a=i.getCategoriesData(),o=i.getData(),s={};a.each(function(l){var u=a.getName(l);s["ec-"+u]=l;var h=a.getItemModel(l),f=h.getModel("itemStyle").getItemStyle();f.fill||(f.fill=i.getColorFromPalette(u,n)),a.setItemVisual(l,"style",f);var c=["symbol","symbolSize","symbolKeepAspect"];for(let v=0;v<c.length;v++){var d=h.getShallow(c[v],!0);d!=null&&a.setItemVisual(l,c[v],d)}}),a.count()&&o.each(function(l){var u=o.getItemModel(l);let h=u.getShallow("category");if(h!=null){typeof h=="string"&&(h=s["ec-"+h]);var f=a.getItemVisual(h,"style"),c=o.ensureUniqueItemVisual(l,"style");rt(c,f);var d=["symbol","symbolSize","symbolKeepAspect"];for(let v=0;v<d.length;v++)o.setItemVisual(l,d[v],a.getItemVisual(h,d[v]))}})})}),e.registerVisual(function(r){r.eachSeriesByType("graphGL",function(n){var i=n.getGraph(),a=n.getEdgeData(),o=hg(n.get("edgeSymbol")),s=hg(n.get("edgeSymbolSize"));a.setVisual("drawType","stroke"),a.setVisual("fromSymbol",o&&o[0]),a.setVisual("toSymbol",o&&o[1]),a.setVisual("fromSymbolSize",s&&s[0]),a.setVisual("toSymbolSize",s&&s[1]),a.setVisual("style",n.getModel("lineStyle").getLineStyle()),a.each(function(l){var u=a.getItemModel(l),h=i.getEdgeByIndex(l),f=hg(u.getShallow("symbol",!0)),c=hg(u.getShallow("symbolSize",!0)),d=u.getModel("lineStyle").getLineStyle(),v=a.ensureUniqueItemVisual(l,"style");switch(rt(v,d),v.stroke){case"source":{var p=h.node1.getVisual("style");v.stroke=p&&p.fill;break}case"target":{var p=h.node2.getVisual("style");v.stroke=p&&p.fill;break}}f[0]&&h.setVisual("fromSymbol",f[0]),f[1]&&h.setVisual("toSymbol",f[1]),c[0]&&h.setVisual("fromSymbolSize",c[0]),c[1]&&h.setVisual("toSymbolSize",c[1])})})}),e.registerAction({type:"graphGLRoam",event:"graphglroam",update:"series.graphGL:roam"},function(r,n){n.eachComponent({mainType:"series",query:r},function(i){i.setView(r)})});function t(){}e.registerAction({type:"graphGLStartLayout",event:"graphgllayoutstarted",update:"series.graphGL:startLayout"},t),e.registerAction({type:"graphGLStopLayout",event:"graphgllayoutstopped",update:"series.graphGL:stopLayout"},t),e.registerAction({type:"graphGLFocusNodeAdjacency",event:"graphGLFocusNodeAdjacency",update:"series.graphGL:focusNodeAdjacency"},t),e.registerAction({type:"graphGLUnfocusNodeAdjacency",event:"graphGLUnfocusNodeAdjacency",update:"series.graphGL:unfocusNodeAdjacency"},t)}te(Ult);const zlt=Ue.extend({type:"series.flowGL",dependencies:["geo","grid","bmap"],visualStyleAccessPath:"itemStyle",getInitialData:function(e,t){var r=this.get("coordinateSystem"),n=r==="geo"?["lng","lat"]:HF(r)||["x","y"];n.push("vx","vy");var i=Ev(this.getSource(),{coordDimensions:n,encodeDefine:this.get("encode"),dimensionsDefine:this.get("dimensions")}),a=new xr(i,this);return a.initData(this.getSource()),a},defaultOption:{coordinateSystem:"cartesian2d",zlevel:10,supersampling:1,particleType:"point",particleDensity:128,particleSize:1,particleSpeed:1,particleTrail:2,colorTexture:null,gridWidth:"auto",gridHeight:"auto",itemStyle:{color:"#fff",opacity:.8}}});var klt=Ce.extend(function(){return{dynamic:!0,attributes:{position:new Ce.Attribute("position","float",3,"POSITION")}}},{resetOffset:function(){this._vertexOffset=0,this._faceOffset=0},setLineCount:function(e){var t=this.attributes,r=4*e,n=2*e;this.vertexCount!==r&&t.position.init(r),this.triangleCount!==n&&(n===0?this.indices=null:this.indices=this.vertexCount>65535?new Uint32Array(n*3):new Uint16Array(n*3))},addLine:function(e){var t=this._vertexOffset;this.attributes.position.set(t,[e[0],e[1],1]),this.attributes.position.set(t+1,[e[0],e[1],-1]),this.attributes.position.set(t+2,[e[0],e[1],2]),this.attributes.position.set(t+3,[e[0],e[1],-2]),this.setTriangleIndices(this._faceOffset++,[t,t+1,t+2]),this.setTriangleIndices(this._faceOffset++,[t+1,t+2,t+3]),this._vertexOffset+=4}});const Glt=`@export ecgl.vfParticle.particle.fragment

uniform sampler2D particleTexture;
uniform sampler2D spawnTexture;
uniform sampler2D velocityTexture;

uniform float deltaTime;
uniform float elapsedTime;

uniform float speedScaling : 1.0;

uniform vec2 textureSize;
uniform vec4 region : [0, 0, 1, 1];
uniform float firstFrameTime;

varying vec2 v_Texcoord;


void main()
{
 vec4 p = texture2D(particleTexture, v_Texcoord);
 bool spawn = false;
 if (p.w <= 0.0) {
 p = texture2D(spawnTexture, fract(v_Texcoord + elapsedTime / 10.0));
 p.w -= firstFrameTime;
 spawn = true;
 }
 vec2 v = texture2D(velocityTexture, fract(p.xy * region.zw + region.xy)).xy;
 v = (v - 0.5) * 2.0;
 p.z = length(v);
 p.xy += v * deltaTime / 10.0 * speedScaling;
 p.w -= deltaTime;

 if (spawn || p.xy != fract(p.xy)) {
 p.z = 0.0;
 }
 p.xy = fract(p.xy);

 gl_FragColor = p;
}
@end

@export ecgl.vfParticle.renderPoints.vertex

#define PI 3.1415926

attribute vec2 texcoord : TEXCOORD_0;

uniform sampler2D particleTexture;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

uniform float size : 1.0;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 vec4 p = texture2D(particleTexture, texcoord);

 if (p.w > 0.0 && p.z > 1e-5) {
 gl_Position = worldViewProjection * vec4(p.xy * 2.0 - 1.0, 0.0, 1.0);
 }
 else {
 gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);
 }

 v_Mag = p.z;
 v_Uv = p.xy;

 gl_PointSize = size;
}

@end

@export ecgl.vfParticle.renderPoints.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform sampler2D gradientTexture;
uniform sampler2D colorTexture;
uniform sampler2D spriteTexture;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 gl_FragColor = color;
#ifdef SPRITETEXTURE_ENABLED
 gl_FragColor *= texture2D(spriteTexture, gl_PointCoord);
 if (color.a == 0.0) {
 discard;
 }
#endif
#ifdef GRADIENTTEXTURE_ENABLED
 gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));
#endif
#ifdef COLORTEXTURE_ENABLED
 gl_FragColor *= texture2D(colorTexture, v_Uv);
#endif
}

@end

@export ecgl.vfParticle.renderLines.vertex

#define PI 3.1415926

attribute vec3 position : POSITION;

uniform sampler2D particleTexture;
uniform sampler2D prevParticleTexture;

uniform float size : 1.0;
uniform vec4 vp: VIEWPORT;
uniform mat4 worldViewProjection : WORLDVIEWPROJECTION;

varying float v_Mag;
varying vec2 v_Uv;

@import clay.util.rand

void main()
{
 vec4 p = texture2D(particleTexture, position.xy);
 vec4 p2 = texture2D(prevParticleTexture, position.xy);

 p.xy = p.xy * 2.0 - 1.0;
 p2.xy = p2.xy * 2.0 - 1.0;

 if (p.w > 0.0 && p.z > 1e-5) {
 vec2 dir = normalize(p.xy - p2.xy);
 vec2 norm = vec2(dir.y / vp.z, -dir.x / vp.w) * sign(position.z) * size;
 if (abs(position.z) == 2.0) {
 gl_Position = vec4(p.xy + norm, 0.0, 1.0);
 v_Uv = p.xy;
 v_Mag = p.z;
 }
 else {
 gl_Position = vec4(p2.xy + norm, 0.0, 1.0);
 v_Mag = p2.z;
 v_Uv = p2.xy;
 }
 gl_Position = worldViewProjection * gl_Position;
 }
 else {
 gl_Position = vec4(100000.0, 100000.0, 100000.0, 1.0);
 }
}

@end

@export ecgl.vfParticle.renderLines.fragment

uniform vec4 color : [1.0, 1.0, 1.0, 1.0];
uniform sampler2D gradientTexture;
uniform sampler2D colorTexture;

varying float v_Mag;
varying vec2 v_Uv;

void main()
{
 gl_FragColor = color;
 #ifdef GRADIENTTEXTURE_ENABLED
 gl_FragColor *= texture2D(gradientTexture, vec2(v_Mag, 0.5));
#endif
#ifdef COLORTEXTURE_ENABLED
 gl_FragColor *= texture2D(colorTexture, v_Uv);
#endif
}

@end
`;Et.import(Glt);function Vlt(e){var t=document.createElement("canvas");t.width=t.height=e;var r=t.getContext("2d");return r.fillStyle="#fff",r.arc(e/2,e/2,e/2,0,Math.PI*2),r.fill(),t}var KT=function(){this.motionBlurFactor=.99,this.vectorFieldTexture=new xe({type:Mt.FLOAT,flipY:!1}),this.particleLife=[5,20],this._particleType="point",this._particleSize=1,this.particleColor=[1,1,1,1],this.particleSpeedScaling=1,this._thisFrameTexture=null,this._particlePass=null,this._spawnTexture=null,this._particleTexture0=null,this._particleTexture1=null,this._particlePointsMesh=null,this._surfaceFrameBuffer=null,this._elapsedTime=0,this._scene=null,this._camera=null,this._lastFrameTexture=null,this._supersampling=1,this._downsampleTextures=[],this._width=512,this._height=512,this.init()};KT.prototype={constructor:KT,init:function(){var e={type:Mt.FLOAT,minFilter:Mt.NEAREST,magFilter:Mt.NEAREST,useMipmap:!1};this._spawnTexture=new xe(e),this._particleTexture0=new xe(e),this._particleTexture1=new xe(e),this._frameBuffer=new Ir({depthBuffer:!1}),this._particlePass=new kr({fragment:Et.source("ecgl.vfParticle.particle.fragment")}),this._particlePass.setUniform("velocityTexture",this.vectorFieldTexture),this._particlePass.setUniform("spawnTexture",this._spawnTexture),this._downsamplePass=new kr({fragment:Et.source("clay.compositor.downsample")});var t=new Qr({renderOrder:10,material:new Vi({shader:new Et(Et.source("ecgl.vfParticle.renderPoints.vertex"),Et.source("ecgl.vfParticle.renderPoints.fragment"))}),mode:Qr.POINTS,geometry:new Ce({dynamic:!0,mainAttribute:"texcoord0"})}),r=new Qr({renderOrder:10,material:new Vi({shader:new Et(Et.source("ecgl.vfParticle.renderLines.vertex"),Et.source("ecgl.vfParticle.renderLines.fragment"))}),geometry:new klt,culling:!1}),n=new Qr({material:new Vi({shader:new Et(Et.source("ecgl.color.vertex"),Et.source("ecgl.color.fragment"))}),geometry:new h0});n.material.enableTexture("diffuseMap"),this._particlePointsMesh=t,this._particleLinesMesh=r,this._lastFrameFullQuadMesh=n,this._camera=new bf,this._thisFrameTexture=new xe,this._lastFrameTexture=new xe},setParticleDensity:function(e,t){for(var r=e*t,n=new Float32Array(r*4),i=0,a=this.particleLife,o=0;o<e;o++)for(var s=0;s<t;s++,i++){n[i*4]=Math.random(),n[i*4+1]=Math.random(),n[i*4+2]=Math.random();var l=(a[1]-a[0])*Math.random()+a[0];n[i*4+3]=l}this._particleType==="line"?this._setLineGeometry(e,t):this._setPointsGeometry(e,t),this._spawnTexture.width=e,this._spawnTexture.height=t,this._spawnTexture.pixels=n,this._particleTexture0.width=this._particleTexture1.width=e,this._particleTexture0.height=this._particleTexture1.height=t,this._particlePass.setUniform("textureSize",[e,t])},_setPointsGeometry:function(e,t){var r=e*t,n=this._particlePointsMesh.geometry,i=n.attributes;i.texcoord0.init(r);for(var a=0,o=0;o<e;o++)for(var s=0;s<t;s++,a++)i.texcoord0.value[a*2]=o/e,i.texcoord0.value[a*2+1]=s/t;n.dirty()},_setLineGeometry:function(e,t){var r=e*t,n=this._getParticleMesh().geometry;n.setLineCount(r),n.resetOffset();for(var i=0;i<e;i++)for(var a=0;a<t;a++)n.addLine([i/e,a/t]);n.dirty()},_getParticleMesh:function(){return this._particleType==="line"?this._particleLinesMesh:this._particlePointsMesh},update:function(e,t,r,n){var i=this._getParticleMesh(),a=this._frameBuffer,o=this._particlePass;n&&this._updateDownsampleTextures(e,t),i.material.set("size",this._particleSize*this._supersampling),i.material.set("color",this.particleColor),o.setUniform("speedScaling",this.particleSpeedScaling),a.attach(this._particleTexture1),o.setUniform("firstFrameTime",n?(this.particleLife[1]+this.particleLife[0])/2:0),o.setUniform("particleTexture",this._particleTexture0),o.setUniform("deltaTime",r),o.setUniform("elapsedTime",this._elapsedTime),o.render(e,a),i.material.set("particleTexture",this._particleTexture1),i.material.set("prevParticleTexture",this._particleTexture0),a.attach(this._thisFrameTexture),a.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT);var s=this._lastFrameFullQuadMesh;s.material.set("diffuseMap",this._lastFrameTexture),s.material.set("color",[1,1,1,this.motionBlurFactor]),this._camera.update(!0),e.renderPass([s,i],this._camera),a.unbind(e),this._downsample(e),this._swapTexture(),this._elapsedTime+=r},_downsample:function(e){var t=this._downsampleTextures;if(t.length!==0)for(var r=0,n=this._thisFrameTexture,i=t[r];i;)this._frameBuffer.attach(i),this._downsamplePass.setUniform("texture",n),this._downsamplePass.setUniform("textureSize",[n.width,n.height]),this._downsamplePass.render(e,this._frameBuffer),n=i,i=t[++r]},getSurfaceTexture:function(){var e=this._downsampleTextures;return e.length>0?e[e.length-1]:this._lastFrameTexture},setRegion:function(e){this._particlePass.setUniform("region",e)},resize:function(e,t){this._lastFrameTexture.width=e*this._supersampling,this._lastFrameTexture.height=t*this._supersampling,this._thisFrameTexture.width=e*this._supersampling,this._thisFrameTexture.height=t*this._supersampling,this._width=e,this._height=t},setParticleSize:function(e){var t=this._getParticleMesh();if(e<=2){t.material.disableTexture("spriteTexture"),t.material.transparent=!1;return}this._spriteTexture||(this._spriteTexture=new xe),(!this._spriteTexture.image||this._spriteTexture.image.width!==e)&&(this._spriteTexture.image=Vlt(e),this._spriteTexture.dirty()),t.material.transparent=!0,t.material.enableTexture("spriteTexture"),t.material.set("spriteTexture",this._spriteTexture),this._particleSize=e},setGradientTexture:function(e){var t=this._getParticleMesh().material;t[e?"enableTexture":"disableTexture"]("gradientTexture"),t.setUniform("gradientTexture",e)},setColorTextureImage:function(e,t){var r=this._getParticleMesh().material;r.setTextureImage("colorTexture",e,t,{flipY:!0})},setParticleType:function(e){this._particleType=e},clearFrame:function(e){var t=this._frameBuffer;t.attach(this._lastFrameTexture),t.bind(e),e.gl.clear(e.gl.DEPTH_BUFFER_BIT|e.gl.COLOR_BUFFER_BIT),t.unbind(e)},setSupersampling:function(e){this._supersampling=e,this.resize(this._width,this._height)},_updateDownsampleTextures:function(e,t){for(var r=this._downsampleTextures,n=Math.max(Math.floor(Math.log(this._supersampling/t.getDevicePixelRatio())/Math.log(2)),0),i=2,a=this._width*this._supersampling,o=this._height*this._supersampling,s=0;s<n;s++)r[s]=r[s]||new xe,r[s].width=a/i,r[s].height=o/i,i*=2;for(;s<r.length;s++)r[s].dispose(e);r.length=n},_swapTexture:function(){var e=this._particleTexture0;this._particleTexture0=this._particleTexture1,this._particleTexture1=e;var e=this._thisFrameTexture;this._thisFrameTexture=this._lastFrameTexture,this._lastFrameTexture=e},dispose:function(e){e.disposeFrameBuffer(this._frameBuffer),e.disposeTexture(this.vectorFieldTexture),e.disposeTexture(this._spawnTexture),e.disposeTexture(this._particleTexture0),e.disposeTexture(this._particleTexture1),e.disposeTexture(this._thisFrameTexture),e.disposeTexture(this._lastFrameTexture),e.disposeGeometry(this._particleLinesMesh.geometry),e.disposeGeometry(this._particlePointsMesh.geometry),e.disposeGeometry(this._lastFrameFullQuadMesh.geometry),this._spriteTexture&&e.disposeTexture(this._spriteTexture),this._particlePass.dispose(e),this._downsamplePass.dispose(e),this._downsampleTextures.forEach(function(t){t.dispose(e)})}};const Hlt=De.extend({type:"flowGL",__ecgl__:!0,init:function(e,t){this.viewGL=new rr("orthographic"),this.groupGL=new U.Node,this.viewGL.add(this.groupGL),this._particleSurface=new KT;var r=new U.Mesh({geometry:new U.PlaneGeometry,material:new U.Material({shader:new U.Shader({vertex:U.Shader.source("ecgl.color.vertex"),fragment:U.Shader.source("ecgl.color.fragment")}),transparent:!0})});r.material.enableTexture("diffuseMap"),this.groupGL.add(r),this._planeMesh=r},render:function(e,t,r){var n=this._particleSurface;n.setParticleType(e.get("particleType")),n.setSupersampling(e.get("supersampling")),this._updateData(e,r),this._updateCamera(r.getWidth(),r.getHeight(),r.getDevicePixelRatio());var i=Ee.firstNotNull(e.get("particleDensity"),128);n.setParticleDensity(i,i);var a=this._planeMesh,o=+new Date,s=this,l=!0;a.__percent=0,a.stopAnimation(),a.animate("",{loop:!0}).when(1e5,{__percent:1}).during(function(){var f=+new Date,c=Math.min(f-o,20);o=o+c,s._renderer&&(n.update(s._renderer,r,c/1e3,l),a.material.set("diffuseMap",n.getSurfaceTexture())),l=!1}).start();var u=e.getModel("itemStyle"),h=U.parseColor(u.get("color"));h[3]*=Ee.firstNotNull(u.get("opacity"),1),a.material.set("color",h),n.setColorTextureImage(e.get("colorTexture"),r),n.setParticleSize(e.get("particleSize")),n.particleSpeedScaling=e.get("particleSpeed"),n.motionBlurFactor=1-Math.pow(.1,e.get("particleTrail"))},updateTransform:function(e,t,r){this._updateData(e,r)},afterRender:function(e,t,r,n){var i=n.renderer;this._renderer=i},_updateData:function(e,t){var r=e.coordinateSystem,n=r.dimensions.map(function(_){return e.coordDimToDataDim(_)[0]}),i=e.getData(),a=i.getDataExtent(n[0]),o=i.getDataExtent(n[1]),s=e.get("gridWidth"),l=e.get("gridHeight");if(s==null||s==="auto"){var u=(a[1]-a[0])/(o[1]-o[0]);s=Math.round(Math.sqrt(u*i.count()))}(l==null||l==="auto")&&(l=Math.ceil(i.count()/s));var h=this._particleSurface.vectorFieldTexture,f=h.pixels;if(!f||f.length!==l*s*4)f=h.pixels=new Float32Array(s*l*4);else for(var c=0;c<f.length;c++)f[c]=0;var d=0,v=1/0,p=new Float32Array(i.count()*2),g=0,m=[[1/0,1/0],[-1/0,-1/0]];i.each([n[0],n[1],"vx","vy"],function(_,y,x,T){var S=r.dataToPoint([_,y]);p[g++]=S[0],p[g++]=S[1],m[0][0]=Math.min(S[0],m[0][0]),m[0][1]=Math.min(S[1],m[0][1]),m[1][0]=Math.max(S[0],m[1][0]),m[1][1]=Math.max(S[1],m[1][1]);var M=Math.sqrt(x*x+T*T);d=Math.max(d,M),v=Math.min(v,M)}),i.each(["vx","vy"],function(_,y,x){var T=Math.round((p[x*2]-m[0][0])/(m[1][0]-m[0][0])*(s-1)),S=l-1-Math.round((p[x*2+1]-m[0][1])/(m[1][1]-m[0][1])*(l-1)),M=(S*s+T)*4;f[M]=_/d*.5+.5,f[M+1]=y/d*.5+.5,f[M+3]=1}),h.width=s,h.height=l,e.get("coordinateSystem")==="bmap"&&this._fillEmptyPixels(h),h.dirty(),this._updatePlanePosition(m[0],m[1],e,t),this._updateGradientTexture(i.getVisual("visualMeta"),[v,d])},_fillEmptyPixels:function(e){var t=e.pixels,r=e.width,n=e.height;function i(p,g,m){p=Math.max(Math.min(p,r-1),0),g=Math.max(Math.min(g,n-1),0);var _=(g*(r-1)+p)*4;return t[_+3]===0?!1:(m[0]=t[_],m[1]=t[_+1],!0)}function a(p,g,m){m[0]=p[0]+g[0],m[1]=p[1]+g[1]}for(var o=[],s=[],l=[],u=[],h=[],f=0,c=0;c<n;c++)for(var d=0;d<r;d++){var v=(c*(r-1)+d)*4;t[v+3]===0&&(f=o[0]=o[1]=0,i(d-1,c,s)&&(f++,a(s,o,o)),i(d+1,c,l)&&(f++,a(l,o,o)),i(d,c-1,u)&&(f++,a(u,o,o)),i(d,c+1,h)&&(f++,a(h,o,o)),o[0]/=f,o[1]/=f,t[v]=o[0],t[v+1]=o[1]),t[v+3]=1}},_updateGradientTexture:function(e,t){if(!e||!e.length){this._particleSurface.setGradientTexture(null);return}this._gradientTexture=this._gradientTexture||new U.Texture2D({image:document.createElement("canvas")});var r=this._gradientTexture,n=r.image;n.width=200,n.height=1;var i=n.getContext("2d"),a=i.createLinearGradient(0,.5,n.width,.5);e[0].stops.forEach(function(o){var s;t[1]===t[0]?s=0:(s=o.value/t[1],s=Math.min(Math.max(s,0),1)),a.addColorStop(s,o.color)}),i.fillStyle=a,i.fillRect(0,0,n.width,n.height),r.dirty(),this._particleSurface.setGradientTexture(this._gradientTexture)},_updatePlanePosition:function(e,t,r,n){var i=this._limitInViewportAndFullFill(e,t,r,n);e=i.leftTop,t=i.rightBottom,this._particleSurface.setRegion(i.region),this._planeMesh.position.set((e[0]+t[0])/2,n.getHeight()-(e[1]+t[1])/2,0);var a=t[0]-e[0],o=t[1]-e[1];this._planeMesh.scale.set(a/2,o/2,1),this._particleSurface.resize(Math.max(Math.min(a,2048),1),Math.max(Math.min(o,2048),1)),this._renderer&&this._particleSurface.clearFrame(this._renderer)},_limitInViewportAndFullFill:function(e,t,r,n){var i=[Math.max(e[0],0),Math.max(e[1],0)],a=[Math.min(t[0],n.getWidth()),Math.min(t[1],n.getHeight())];if(r.get("coordinateSystem")==="bmap"){var o=r.getData().getDataExtent(r.coordDimToDataDim("lng")[0]),s=Math.floor(o[1]-o[0])>=359;s&&(i[0]>0&&(i[0]=0),a[0]<n.getWidth()&&(a[0]=n.getWidth()))}var l=t[0]-e[0],u=t[1]-e[1],h=a[0]-i[0],f=a[1]-i[1],c=[(i[0]-e[0])/l,1-f/u-(i[1]-e[1])/u,h/l,f/u];return{leftTop:i,rightBottom:a,region:c}},_updateCamera:function(e,t,r){this.viewGL.setViewport(0,0,e,t,r);var n=this.viewGL.camera;n.left=n.bottom=0,n.top=t,n.right=e,n.near=0,n.far=100,n.position.z=10},remove:function(){this._planeMesh.stopAnimation(),this.groupGL.removeAll()},dispose:function(){this._renderer&&this._particleSurface.dispose(this._renderer),this.groupGL.removeAll()}});function Wlt(e){e.registerChartView(Hlt),e.registerSeriesModel(zlt)}te(Wlt);var jT=Ue.extend({type:"series.linesGL",dependencies:["grid","geo"],visualStyleAccessPath:"lineStyle",visualDrawType:"stroke",streamEnabled:!0,init:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),jT.superApply(this,"init",arguments)},mergeOption:function(e){var t=this._processFlatCoordsArray(e.data);this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset,t.flatCoords&&(e.data=new Float32Array(t.count)),jT.superApply(this,"mergeOption",arguments)},appendData:function(e){var t=this._processFlatCoordsArray(e.data);t.flatCoords&&(this._flatCoords?(this._flatCoords=yu(this._flatCoords,t.flatCoords),this._flatCoordsOffset=yu(this._flatCoordsOffset,t.flatCoordsOffset)):(this._flatCoords=t.flatCoords,this._flatCoordsOffset=t.flatCoordsOffset),e.data=new Float32Array(t.count)),this.getRawData().appendData(e.data)},_getCoordsFromItemModel:function(e){var t=this.getData().getItemModel(e),r=t.option instanceof Array?t.option:t.getShallow("coords");return r},getLineCoordsCount:function(e){return this._flatCoordsOffset?this._flatCoordsOffset[e*2+1]:this._getCoordsFromItemModel(e).length},getLineCoords:function(e,t){if(this._flatCoordsOffset){for(var r=this._flatCoordsOffset[e*2],n=this._flatCoordsOffset[e*2+1],i=0;i<n;i++)t[i]=t[i]||[],t[i][0]=this._flatCoords[r+i*2],t[i][1]=this._flatCoords[r+i*2+1];return n}else{for(var a=this._getCoordsFromItemModel(e),i=0;i<a.length;i++)t[i]=t[i]||[],t[i][0]=a[i][0],t[i][1]=a[i][1];return a.length}},_processFlatCoordsArray:function(e){var t=0;if(this._flatCoords&&(t=this._flatCoords.length),typeof e[0]=="number"){for(var r=e.length,n=new Uint32Array(r),i=new Float64Array(r),a=0,o=0,s=0,l=0;l<r;){s++;var u=e[l++];n[o++]=a+t,n[o++]=u;for(var h=0;h<u;h++){var f=e[l++],c=e[l++];i[a++]=f,i[a++]=c}}return{flatCoordsOffset:new Uint32Array(n.buffer,0,o),flatCoords:i,count:s}}return{flatCoordsOffset:null,flatCoords:null,count:e.length}},getInitialData:function(e,t){var r=new xr(["value"],this);return r.hasItemOption=!1,r.initData(e.data,[],function(n,i,a,o){if(n instanceof Array)return NaN;r.hasItemOption=!0;var s=n.value;if(s!=null)return s instanceof Array?s[o]:s}),r},defaultOption:{coordinateSystem:"geo",zlevel:10,progressive:1e4,progressiveThreshold:5e4,blendMode:"source-over",lineStyle:{opacity:.8},postEffect:{enable:!1,colorCorrection:{exposure:0,brightness:0,contrast:1,saturation:1,enable:!0}}}});const Xlt=De.extend({type:"linesGL",__ecgl__:!0,init:function(e,t){this.groupGL=new U.Node,this.viewGL=new rr("orthographic"),this.viewGL.add(this.groupGL),this._glViewHelper=new Yo(this.viewGL),this._nativeLinesShader=U.createShader("ecgl.lines3D"),this._meshLinesShader=U.createShader("ecgl.meshLines3D"),this._linesMeshes=[],this._currentStep=0},render:function(e,t,r){this.groupGL.removeAll(),this._glViewHelper.reset(e,r);var n=this._linesMeshes[0];n||(n=this._linesMeshes[0]=this._createLinesMesh(e)),this._linesMeshes.length=1,this.groupGL.add(n),this._updateLinesMesh(e,n,0,e.getData().count()),this.viewGL.setPostEffect(e.getModel("postEffect"),r)},incrementalPrepareRender:function(e,t,r){this.groupGL.removeAll(),this._glViewHelper.reset(e,r),this._currentStep=0,this.viewGL.setPostEffect(e.getModel("postEffect"),r)},incrementalRender:function(e,t,r,n){var i=this._linesMeshes[this._currentStep];i||(i=this._createLinesMesh(t),this._linesMeshes[this._currentStep]=i),this._updateLinesMesh(t,i,e.start,e.end),this.groupGL.add(i),n.getZr().refresh(),this._currentStep++},updateTransform:function(e,t,r){e.coordinateSystem.getRoamTransform&&this._glViewHelper.updateTransform(e,r)},_createLinesMesh:function(e){var t=new U.Mesh({$ignorePicking:!0,material:new U.Material({shader:U.createShader("ecgl.lines3D"),transparent:!0,depthMask:!1,depthTest:!1}),geometry:new mA({segmentScale:10,useNativeLine:!0,dynamic:!1}),mode:U.Mesh.LINES,culling:!1});return t},_updateLinesMesh:function(e,t,r,n){var i=e.getData();t.material.blend=e.get("blendMode")==="lighter"?U.additiveBlend:null;var a=e.get("lineStyle.curveness")||0,o=e.get("polyline"),s=t.geometry,l=e.coordinateSystem,u=Ee.firstNotNull(e.get("lineStyle.width"),1);u>1?(t.material.shader!==this._meshLinesShader&&t.material.attachShader(this._meshLinesShader),t.mode=U.Mesh.TRIANGLES):(t.material.shader!==this._nativeLinesShader&&t.material.attachShader(this._nativeLinesShader),t.mode=U.Mesh.LINES),r=r||0,n=n||i.count(),s.resetOffset();var h=0,f=0,c=[],d=[],v=[],p=[],g=[],m=.3,_=.7;function y(){d[0]=c[0]*_+p[0]*m-(c[1]-p[1])*a,d[1]=c[1]*_+p[1]*m-(p[0]-c[0])*a,v[0]=c[0]*m+p[0]*_-(c[1]-p[1])*a,v[1]=c[1]*m+p[1]*_-(p[0]-c[0])*a}if(o||a!==0)for(var x=r;x<n;x++)if(o){var T=e.getLineCoordsCount(x);h+=s.getPolylineVertexCount(T),f+=s.getPolylineTriangleCount(T)}else e.getLineCoords(x,g),this._glViewHelper.dataToPoint(l,g[0],c),this._glViewHelper.dataToPoint(l,g[1],p),y(),h+=s.getCubicCurveVertexCount(c,d,v,p),f+=s.getCubicCurveTriangleCount(c,d,v,p);else{var S=n-r;h+=S*s.getLineVertexCount(),f+=S*s.getLineVertexCount()}s.setVertexCount(h),s.setTriangleCount(f);for(var M=r,w=[],x=r;x<n;x++){U.parseColor(nn(i,M),w);var b=Ee.firstNotNull(tn(i,M),1);w[3]*=b;for(var T=e.getLineCoords(x,g),A=0;A<T;A++)this._glViewHelper.dataToPoint(l,g[A],g[A]);o?s.addPolyline(g,w,u,0,T):a!==0?(c=g[0],p=g[1],y(),s.addCubicCurve(c,d,v,p,w,u)):s.addPolyline(g,w,u,0,2),M++}},dispose:function(){this.groupGL.removeAll()},remove:function(){this.groupGL.removeAll()}});function Ylt(e){e.registerChartView(Xlt),e.registerSeriesModel(jT)}te(Ylt);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */const _A="172",Zlt=0,YI=1,qlt=2,PG=1,$lt=2,co=3,Gs=0,li=1,_o=2,Rs=0,af=1,ZI=2,qI=3,$I=4,Klt=5,Zl=100,jlt=101,Jlt=102,Qlt=103,tut=104,eut=200,rut=201,nut=202,iut=203,JT=204,QT=205,aut=206,out=207,sut=208,lut=209,uut=210,hut=211,fut=212,cut=213,dut=214,tb=0,eb=1,rb=2,Cf=3,nb=4,ib=5,ab=6,ob=7,IG=0,vut=1,put=2,Ps=0,gut=1,mut=2,_ut=3,yut=4,xut=5,Sut=6,Tut=7,NG=300,Df=301,Lf=302,sb=303,lb=304,g0=306,ub=1e3,ou=1001,hb=1002,ga=1003,but=1004,fg=1005,za=1006,y1=1007,su=1008,zo=1009,OG=1010,FG=1011,mv=1012,yA=1013,Iu=1014,So=1015,Hv=1016,xA=1017,SA=1018,Rf=1020,BG=35902,UG=1021,zG=1022,ca=1023,kG=1024,GG=1025,of=1026,Pf=1027,VG=1028,TA=1029,HG=1030,bA=1031,wA=1033,am=33776,om=33777,sm=33778,lm=33779,fb=35840,cb=35841,db=35842,vb=35843,pb=36196,gb=37492,mb=37496,_b=37808,yb=37809,xb=37810,Sb=37811,Tb=37812,bb=37813,wb=37814,Mb=37815,Ab=37816,Eb=37817,Cb=37818,Db=37819,Lb=37820,Rb=37821,um=36492,Pb=36494,Ib=36495,WG=36283,Nb=36284,Ob=36285,Fb=36286,wut=3200,Mut=3201,Aut=0,Eut=1,ps="",Pi="srgb",If="srgb-linear",m_="linear",cr="srgb",Mh=7680,KI=519,Cut=512,Dut=513,Lut=514,XG=515,Rut=516,Put=517,Iut=518,Nut=519,jI=35044,JI="300 es",To=2e3,__=2001;class oc{addEventListener(t,r){this._listeners===void 0&&(this._listeners={});const n=this._listeners;n[t]===void 0&&(n[t]=[]),n[t].indexOf(r)===-1&&n[t].push(r)}hasEventListener(t,r){if(this._listeners===void 0)return!1;const n=this._listeners;return n[t]!==void 0&&n[t].indexOf(r)!==-1}removeEventListener(t,r){if(this._listeners===void 0)return;const i=this._listeners[t];if(i!==void 0){const a=i.indexOf(r);a!==-1&&i.splice(a,1)}}dispatchEvent(t){if(this._listeners===void 0)return;const n=this._listeners[t.type];if(n!==void 0){t.target=this;const i=n.slice(0);for(let a=0,o=i.length;a<o;a++)i[a].call(this,t);t.target=null}}}const Mn=["00","01","02","03","04","05","06","07","08","09","0a","0b","0c","0d","0e","0f","10","11","12","13","14","15","16","17","18","19","1a","1b","1c","1d","1e","1f","20","21","22","23","24","25","26","27","28","29","2a","2b","2c","2d","2e","2f","30","31","32","33","34","35","36","37","38","39","3a","3b","3c","3d","3e","3f","40","41","42","43","44","45","46","47","48","49","4a","4b","4c","4d","4e","4f","50","51","52","53","54","55","56","57","58","59","5a","5b","5c","5d","5e","5f","60","61","62","63","64","65","66","67","68","69","6a","6b","6c","6d","6e","6f","70","71","72","73","74","75","76","77","78","79","7a","7b","7c","7d","7e","7f","80","81","82","83","84","85","86","87","88","89","8a","8b","8c","8d","8e","8f","90","91","92","93","94","95","96","97","98","99","9a","9b","9c","9d","9e","9f","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","aa","ab","ac","ad","ae","af","b0","b1","b2","b3","b4","b5","b6","b7","b8","b9","ba","bb","bc","bd","be","bf","c0","c1","c2","c3","c4","c5","c6","c7","c8","c9","ca","cb","cc","cd","ce","cf","d0","d1","d2","d3","d4","d5","d6","d7","d8","d9","da","db","dc","dd","de","df","e0","e1","e2","e3","e4","e5","e6","e7","e8","e9","ea","eb","ec","ed","ee","ef","f0","f1","f2","f3","f4","f5","f6","f7","f8","f9","fa","fb","fc","fd","fe","ff"],x1=Math.PI/180,Bb=180/Math.PI;function Wv(){const e=Math.random()*4294967295|0,t=Math.random()*4294967295|0,r=Math.random()*4294967295|0,n=Math.random()*4294967295|0;return(Mn[e&255]+Mn[e>>8&255]+Mn[e>>16&255]+Mn[e>>24&255]+"-"+Mn[t&255]+Mn[t>>8&255]+"-"+Mn[t>>16&15|64]+Mn[t>>24&255]+"-"+Mn[r&63|128]+Mn[r>>8&255]+"-"+Mn[r>>16&255]+Mn[r>>24&255]+Mn[n&255]+Mn[n>>8&255]+Mn[n>>16&255]+Mn[n>>24&255]).toLowerCase()}function Ye(e,t,r){return Math.max(t,Math.min(r,e))}function Out(e,t){return(e%t+t)%t}function S1(e,t,r){return(1-r)*e+r*t}function Zc(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return e/4294967295;case Uint16Array:return e/65535;case Uint8Array:return e/255;case Int32Array:return Math.max(e/2147483647,-1);case Int16Array:return Math.max(e/32767,-1);case Int8Array:return Math.max(e/127,-1);default:throw new Error("Invalid component type.")}}function ri(e,t){switch(t.constructor){case Float32Array:return e;case Uint32Array:return Math.round(e*4294967295);case Uint16Array:return Math.round(e*65535);case Uint8Array:return Math.round(e*255);case Int32Array:return Math.round(e*2147483647);case Int16Array:return Math.round(e*32767);case Int8Array:return Math.round(e*127);default:throw new Error("Invalid component type.")}}class pr{constructor(t=0,r=0){pr.prototype.isVector2=!0,this.x=t,this.y=r}get width(){return this.x}set width(t){this.x=t}get height(){return this.y}set height(t){this.y=t}set(t,r){return this.x=t,this.y=r,this}setScalar(t){return this.x=t,this.y=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setComponent(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y)}copy(t){return this.x=t.x,this.y=t.y,this}add(t){return this.x+=t.x,this.y+=t.y,this}addScalar(t){return this.x+=t,this.y+=t,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this}subScalar(t){return this.x-=t,this.y-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this}multiply(t){return this.x*=t.x,this.y*=t.y,this}multiplyScalar(t){return this.x*=t,this.y*=t,this}divide(t){return this.x/=t.x,this.y/=t.y,this}divideScalar(t){return this.multiplyScalar(1/t)}applyMatrix3(t){const r=this.x,n=this.y,i=t.elements;return this.x=i[0]*r+i[3]*n+i[6],this.y=i[1]*r+i[4]*n+i[7],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this}clamp(t,r){return this.x=Ye(this.x,t.x,r.x),this.y=Ye(this.y,t.y,r.y),this}clampScalar(t,r){return this.x=Ye(this.x,t,r),this.y=Ye(this.y,t,r),this}clampLength(t,r){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ye(n,t,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this}negate(){return this.x=-this.x,this.y=-this.y,this}dot(t){return this.x*t.x+this.y*t.y}cross(t){return this.x*t.y-this.y*t.x}lengthSq(){return this.x*this.x+this.y*this.y}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)}normalize(){return this.divideScalar(this.length()||1)}angle(){return Math.atan2(-this.y,-this.x)+Math.PI}angleTo(t){const r=Math.sqrt(this.lengthSq()*t.lengthSq());if(r===0)return Math.PI/2;const n=this.dot(t)/r;return Math.acos(Ye(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const r=this.x-t.x,n=this.y-t.y;return r*r+n*n}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this}lerpVectors(t,r,n){return this.x=t.x+(r.x-t.x)*n,this.y=t.y+(r.y-t.y)*n,this}equals(t){return t.x===this.x&&t.y===this.y}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this}toArray(t=[],r=0){return t[r]=this.x,t[r+1]=this.y,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this}rotateAround(t,r){const n=Math.cos(r),i=Math.sin(r),a=this.x-t.x,o=this.y-t.y;return this.x=a*n-o*i+t.x,this.y=a*i+o*n+t.y,this}random(){return this.x=Math.random(),this.y=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y}}class Pe{constructor(t,r,n,i,a,o,s,l,u){Pe.prototype.isMatrix3=!0,this.elements=[1,0,0,0,1,0,0,0,1],t!==void 0&&this.set(t,r,n,i,a,o,s,l,u)}set(t,r,n,i,a,o,s,l,u){const h=this.elements;return h[0]=t,h[1]=i,h[2]=s,h[3]=r,h[4]=a,h[5]=l,h[6]=n,h[7]=o,h[8]=u,this}identity(){return this.set(1,0,0,0,1,0,0,0,1),this}copy(t){const r=this.elements,n=t.elements;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],this}extractBasis(t,r,n){return t.setFromMatrix3Column(this,0),r.setFromMatrix3Column(this,1),n.setFromMatrix3Column(this,2),this}setFromMatrix4(t){const r=t.elements;return this.set(r[0],r[4],r[8],r[1],r[5],r[9],r[2],r[6],r[10]),this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,r){const n=t.elements,i=r.elements,a=this.elements,o=n[0],s=n[3],l=n[6],u=n[1],h=n[4],f=n[7],c=n[2],d=n[5],v=n[8],p=i[0],g=i[3],m=i[6],_=i[1],y=i[4],x=i[7],T=i[2],S=i[5],M=i[8];return a[0]=o*p+s*_+l*T,a[3]=o*g+s*y+l*S,a[6]=o*m+s*x+l*M,a[1]=u*p+h*_+f*T,a[4]=u*g+h*y+f*S,a[7]=u*m+h*x+f*M,a[2]=c*p+d*_+v*T,a[5]=c*g+d*y+v*S,a[8]=c*m+d*x+v*M,this}multiplyScalar(t){const r=this.elements;return r[0]*=t,r[3]*=t,r[6]*=t,r[1]*=t,r[4]*=t,r[7]*=t,r[2]*=t,r[5]*=t,r[8]*=t,this}determinant(){const t=this.elements,r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],h=t[8];return r*o*h-r*s*u-n*a*h+n*s*l+i*a*u-i*o*l}invert(){const t=this.elements,r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],h=t[8],f=h*o-s*u,c=s*l-h*a,d=u*a-o*l,v=r*f+n*c+i*d;if(v===0)return this.set(0,0,0,0,0,0,0,0,0);const p=1/v;return t[0]=f*p,t[1]=(i*u-h*n)*p,t[2]=(s*n-i*o)*p,t[3]=c*p,t[4]=(h*r-i*l)*p,t[5]=(i*a-s*r)*p,t[6]=d*p,t[7]=(n*l-u*r)*p,t[8]=(o*r-n*a)*p,this}transpose(){let t;const r=this.elements;return t=r[1],r[1]=r[3],r[3]=t,t=r[2],r[2]=r[6],r[6]=t,t=r[5],r[5]=r[7],r[7]=t,this}getNormalMatrix(t){return this.setFromMatrix4(t).invert().transpose()}transposeIntoArray(t){const r=this.elements;return t[0]=r[0],t[1]=r[3],t[2]=r[6],t[3]=r[1],t[4]=r[4],t[5]=r[7],t[6]=r[2],t[7]=r[5],t[8]=r[8],this}setUvTransform(t,r,n,i,a,o,s){const l=Math.cos(a),u=Math.sin(a);return this.set(n*l,n*u,-n*(l*o+u*s)+o+t,-i*u,i*l,-i*(-u*o+l*s)+s+r,0,0,1),this}scale(t,r){return this.premultiply(T1.makeScale(t,r)),this}rotate(t){return this.premultiply(T1.makeRotation(-t)),this}translate(t,r){return this.premultiply(T1.makeTranslation(t,r)),this}makeTranslation(t,r){return t.isVector2?this.set(1,0,t.x,0,1,t.y,0,0,1):this.set(1,0,t,0,1,r,0,0,1),this}makeRotation(t){const r=Math.cos(t),n=Math.sin(t);return this.set(r,-n,0,n,r,0,0,0,1),this}makeScale(t,r){return this.set(t,0,0,0,r,0,0,0,1),this}equals(t){const r=this.elements,n=t.elements;for(let i=0;i<9;i++)if(r[i]!==n[i])return!1;return!0}fromArray(t,r=0){for(let n=0;n<9;n++)this.elements[n]=t[n+r];return this}toArray(t=[],r=0){const n=this.elements;return t[r]=n[0],t[r+1]=n[1],t[r+2]=n[2],t[r+3]=n[3],t[r+4]=n[4],t[r+5]=n[5],t[r+6]=n[6],t[r+7]=n[7],t[r+8]=n[8],t}clone(){return new this.constructor().fromArray(this.elements)}}const T1=new Pe;function YG(e){for(let t=e.length-1;t>=0;--t)if(e[t]>=65535)return!0;return!1}function y_(e){return document.createElementNS("http://www.w3.org/1999/xhtml",e)}function Fut(){const e=y_("canvas");return e.style.display="block",e}const QI={};function Hh(e){e in QI||(QI[e]=!0,console.warn(e))}function But(e,t,r){return new Promise(function(n,i){function a(){switch(e.clientWaitSync(t,e.SYNC_FLUSH_COMMANDS_BIT,0)){case e.WAIT_FAILED:i();break;case e.TIMEOUT_EXPIRED:setTimeout(a,r);break;default:n()}}setTimeout(a,r)})}function Uut(e){const t=e.elements;t[2]=.5*t[2]+.5*t[3],t[6]=.5*t[6]+.5*t[7],t[10]=.5*t[10]+.5*t[11],t[14]=.5*t[14]+.5*t[15]}function zut(e){const t=e.elements;t[11]===-1?(t[10]=-t[10]-1,t[14]=-t[14]):(t[10]=-t[10],t[14]=-t[14]+1)}const tN=new Pe().set(.4123908,.3575843,.1804808,.212639,.7151687,.0721923,.0193308,.1191948,.9505322),eN=new Pe().set(3.2409699,-1.5373832,-.4986108,-.9692436,1.8759675,.0415551,.0556301,-.203977,1.0569715);function kut(){const e={enabled:!0,workingColorSpace:If,spaces:{},convert:function(i,a,o){return this.enabled===!1||a===o||!a||!o||(this.spaces[a].transfer===cr&&(i.r=Do(i.r),i.g=Do(i.g),i.b=Do(i.b)),this.spaces[a].primaries!==this.spaces[o].primaries&&(i.applyMatrix3(this.spaces[a].toXYZ),i.applyMatrix3(this.spaces[o].fromXYZ)),this.spaces[o].transfer===cr&&(i.r=sf(i.r),i.g=sf(i.g),i.b=sf(i.b))),i},fromWorkingColorSpace:function(i,a){return this.convert(i,this.workingColorSpace,a)},toWorkingColorSpace:function(i,a){return this.convert(i,a,this.workingColorSpace)},getPrimaries:function(i){return this.spaces[i].primaries},getTransfer:function(i){return i===ps?m_:this.spaces[i].transfer},getLuminanceCoefficients:function(i,a=this.workingColorSpace){return i.fromArray(this.spaces[a].luminanceCoefficients)},define:function(i){Object.assign(this.spaces,i)},_getMatrix:function(i,a,o){return i.copy(this.spaces[a].toXYZ).multiply(this.spaces[o].fromXYZ)},_getDrawingBufferColorSpace:function(i){return this.spaces[i].outputColorSpaceConfig.drawingBufferColorSpace},_getUnpackColorSpace:function(i=this.workingColorSpace){return this.spaces[i].workingColorSpaceConfig.unpackColorSpace}},t=[.64,.33,.3,.6,.15,.06],r=[.2126,.7152,.0722],n=[.3127,.329];return e.define({[If]:{primaries:t,whitePoint:n,transfer:m_,toXYZ:tN,fromXYZ:eN,luminanceCoefficients:r,workingColorSpaceConfig:{unpackColorSpace:Pi},outputColorSpaceConfig:{drawingBufferColorSpace:Pi}},[Pi]:{primaries:t,whitePoint:n,transfer:cr,toXYZ:tN,fromXYZ:eN,luminanceCoefficients:r,outputColorSpaceConfig:{drawingBufferColorSpace:Pi}}}),e}const tr=kut();function Do(e){return e<.04045?e*.0773993808:Math.pow(e*.9478672986+.0521327014,2.4)}function sf(e){return e<.0031308?e*12.92:1.055*Math.pow(e,.41666)-.055}let Ah;class Gut{static getDataURL(t){if(/^data:/i.test(t.src)||typeof HTMLCanvasElement>"u")return t.src;let r;if(t instanceof HTMLCanvasElement)r=t;else{Ah===void 0&&(Ah=y_("canvas")),Ah.width=t.width,Ah.height=t.height;const n=Ah.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height),r=Ah}return r.width>2048||r.height>2048?(console.warn("THREE.ImageUtils.getDataURL: Image converted to jpg for performance reasons",t),r.toDataURL("image/jpeg",.6)):r.toDataURL("image/png")}static sRGBToLinear(t){if(typeof HTMLImageElement<"u"&&t instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&t instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&t instanceof ImageBitmap){const r=y_("canvas");r.width=t.width,r.height=t.height;const n=r.getContext("2d");n.drawImage(t,0,0,t.width,t.height);const i=n.getImageData(0,0,t.width,t.height),a=i.data;for(let o=0;o<a.length;o++)a[o]=Do(a[o]/255)*255;return n.putImageData(i,0,0),r}else if(t.data){const r=t.data.slice(0);for(let n=0;n<r.length;n++)r instanceof Uint8Array||r instanceof Uint8ClampedArray?r[n]=Math.floor(Do(r[n]/255)*255):r[n]=Do(r[n]);return{data:r,width:t.width,height:t.height}}else return console.warn("THREE.ImageUtils.sRGBToLinear(): Unsupported image type. No color space conversion applied."),t}}let Vut=0;class ZG{constructor(t=null){this.isSource=!0,Object.defineProperty(this,"id",{value:Vut++}),this.uuid=Wv(),this.data=t,this.dataReady=!0,this.version=0}set needsUpdate(t){t===!0&&this.version++}toJSON(t){const r=t===void 0||typeof t=="string";if(!r&&t.images[this.uuid]!==void 0)return t.images[this.uuid];const n={uuid:this.uuid,url:""},i=this.data;if(i!==null){let a;if(Array.isArray(i)){a=[];for(let o=0,s=i.length;o<s;o++)i[o].isDataTexture?a.push(b1(i[o].image)):a.push(b1(i[o]))}else a=b1(i);n.url=a}return r||(t.images[this.uuid]=n),n}}function b1(e){return typeof HTMLImageElement<"u"&&e instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&e instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&e instanceof ImageBitmap?Gut.getDataURL(e):e.data?{data:Array.from(e.data),width:e.width,height:e.height,type:e.data.constructor.name}:(console.warn("THREE.Texture: Unable to serialize Texture."),{})}let Hut=0;class ui extends oc{constructor(t=ui.DEFAULT_IMAGE,r=ui.DEFAULT_MAPPING,n=ou,i=ou,a=za,o=su,s=ca,l=zo,u=ui.DEFAULT_ANISOTROPY,h=ps){super(),this.isTexture=!0,Object.defineProperty(this,"id",{value:Hut++}),this.uuid=Wv(),this.name="",this.source=new ZG(t),this.mipmaps=[],this.mapping=r,this.channel=0,this.wrapS=n,this.wrapT=i,this.magFilter=a,this.minFilter=o,this.anisotropy=u,this.format=s,this.internalFormat=null,this.type=l,this.offset=new pr(0,0),this.repeat=new pr(1,1),this.center=new pr(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new Pe,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.colorSpace=h,this.userData={},this.version=0,this.onUpdate=null,this.renderTarget=null,this.isRenderTargetTexture=!1,this.pmremVersion=0}get image(){return this.source.data}set image(t=null){this.source.data=t}updateMatrix(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)}clone(){return new this.constructor().copy(this)}copy(t){return this.name=t.name,this.source=t.source,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.channel=t.channel,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.internalFormat=t.internalFormat,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.colorSpace=t.colorSpace,this.renderTarget=t.renderTarget,this.isRenderTargetTexture=t.isRenderTargetTexture,this.userData=JSON.parse(JSON.stringify(t.userData)),this.needsUpdate=!0,this}toJSON(t){const r=t===void 0||typeof t=="string";if(!r&&t.textures[this.uuid]!==void 0)return t.textures[this.uuid];const n={metadata:{version:4.6,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,image:this.source.toJSON(t).uuid,mapping:this.mapping,channel:this.channel,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,internalFormat:this.internalFormat,type:this.type,colorSpace:this.colorSpace,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY,generateMipmaps:this.generateMipmaps,premultiplyAlpha:this.premultiplyAlpha,unpackAlignment:this.unpackAlignment};return Object.keys(this.userData).length>0&&(n.userData=this.userData),r||(t.textures[this.uuid]=n),n}dispose(){this.dispatchEvent({type:"dispose"})}transformUv(t){if(this.mapping!==NG)return t;if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case ub:t.x=t.x-Math.floor(t.x);break;case ou:t.x=t.x<0?0:1;break;case hb:Math.abs(Math.floor(t.x)%2)===1?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x);break}if(t.y<0||t.y>1)switch(this.wrapT){case ub:t.y=t.y-Math.floor(t.y);break;case ou:t.y=t.y<0?0:1;break;case hb:Math.abs(Math.floor(t.y)%2)===1?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y);break}return this.flipY&&(t.y=1-t.y),t}set needsUpdate(t){t===!0&&(this.version++,this.source.needsUpdate=!0)}set needsPMREMUpdate(t){t===!0&&this.pmremVersion++}}ui.DEFAULT_IMAGE=null;ui.DEFAULT_MAPPING=NG;ui.DEFAULT_ANISOTROPY=1;class Ur{constructor(t=0,r=0,n=0,i=1){Ur.prototype.isVector4=!0,this.x=t,this.y=r,this.z=n,this.w=i}get width(){return this.z}set width(t){this.z=t}get height(){return this.w}set height(t){this.w=t}set(t,r,n,i){return this.x=t,this.y=r,this.z=n,this.w=i,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this.w=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setW(t){return this.w=t,this}setComponent(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;case 3:this.w=r;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z,this.w)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=t.w!==void 0?t.w:1,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this.w=t.w+r.w,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this.w+=t.w*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this.w=t.w-r.w,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this.w*=t.w,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this}applyMatrix4(t){const r=this.x,n=this.y,i=this.z,a=this.w,o=t.elements;return this.x=o[0]*r+o[4]*n+o[8]*i+o[12]*a,this.y=o[1]*r+o[5]*n+o[9]*i+o[13]*a,this.z=o[2]*r+o[6]*n+o[10]*i+o[14]*a,this.w=o[3]*r+o[7]*n+o[11]*i+o[15]*a,this}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this.w/=t.w,this}divideScalar(t){return this.multiplyScalar(1/t)}setAxisAngleFromQuaternion(t){this.w=2*Math.acos(t.w);const r=Math.sqrt(1-t.w*t.w);return r<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/r,this.y=t.y/r,this.z=t.z/r),this}setAxisAngleFromRotationMatrix(t){let r,n,i,a;const l=t.elements,u=l[0],h=l[4],f=l[8],c=l[1],d=l[5],v=l[9],p=l[2],g=l[6],m=l[10];if(Math.abs(h-c)<.01&&Math.abs(f-p)<.01&&Math.abs(v-g)<.01){if(Math.abs(h+c)<.1&&Math.abs(f+p)<.1&&Math.abs(v+g)<.1&&Math.abs(u+d+m-3)<.1)return this.set(1,0,0,0),this;r=Math.PI;const y=(u+1)/2,x=(d+1)/2,T=(m+1)/2,S=(h+c)/4,M=(f+p)/4,w=(v+g)/4;return y>x&&y>T?y<.01?(n=0,i=.707106781,a=.707106781):(n=Math.sqrt(y),i=S/n,a=M/n):x>T?x<.01?(n=.707106781,i=0,a=.707106781):(i=Math.sqrt(x),n=S/i,a=w/i):T<.01?(n=.707106781,i=.707106781,a=0):(a=Math.sqrt(T),n=M/a,i=w/a),this.set(n,i,a,r),this}let _=Math.sqrt((g-v)*(g-v)+(f-p)*(f-p)+(c-h)*(c-h));return Math.abs(_)<.001&&(_=1),this.x=(g-v)/_,this.y=(f-p)/_,this.z=(c-h)/_,this.w=Math.acos((u+d+m-1)/2),this}setFromMatrixPosition(t){const r=t.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this.w=r[15],this}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this}clamp(t,r){return this.x=Ye(this.x,t.x,r.x),this.y=Ye(this.y,t.y,r.y),this.z=Ye(this.z,t.z,r.z),this.w=Ye(this.w,t.w,r.w),this}clampScalar(t,r){return this.x=Ye(this.x,t,r),this.y=Ye(this.y,t,r),this.z=Ye(this.z,t,r),this.w=Ye(this.w,t,r),this}clampLength(t,r){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ye(n,t,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this.w=Math.trunc(this.w),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this.w+=(t.w-this.w)*r,this}lerpVectors(t,r,n){return this.x=t.x+(r.x-t.x)*n,this.y=t.y+(r.y-t.y)*n,this.z=t.z+(r.z-t.z)*n,this.w=t.w+(r.w-t.w)*n,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this.z=t[r+2],this.w=t[r+3],this}toArray(t=[],r=0){return t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t[r+3]=this.w,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this.w=t.getW(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this.w=Math.random(),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z,yield this.w}}class Wut extends oc{constructor(t=1,r=1,n={}){super(),this.isRenderTarget=!0,this.width=t,this.height=r,this.depth=1,this.scissor=new Ur(0,0,t,r),this.scissorTest=!1,this.viewport=new Ur(0,0,t,r);const i={width:t,height:r,depth:1};n=Object.assign({generateMipmaps:!1,internalFormat:null,minFilter:za,depthBuffer:!0,stencilBuffer:!1,resolveDepthBuffer:!0,resolveStencilBuffer:!0,depthTexture:null,samples:0,count:1},n);const a=new ui(i,n.mapping,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.colorSpace);a.flipY=!1,a.generateMipmaps=n.generateMipmaps,a.internalFormat=n.internalFormat,this.textures=[];const o=n.count;for(let s=0;s<o;s++)this.textures[s]=a.clone(),this.textures[s].isRenderTargetTexture=!0,this.textures[s].renderTarget=this;this.depthBuffer=n.depthBuffer,this.stencilBuffer=n.stencilBuffer,this.resolveDepthBuffer=n.resolveDepthBuffer,this.resolveStencilBuffer=n.resolveStencilBuffer,this._depthTexture=null,this.depthTexture=n.depthTexture,this.samples=n.samples}get texture(){return this.textures[0]}set texture(t){this.textures[0]=t}set depthTexture(t){this._depthTexture!==null&&(this._depthTexture.renderTarget=null),t!==null&&(t.renderTarget=this),this._depthTexture=t}get depthTexture(){return this._depthTexture}setSize(t,r,n=1){if(this.width!==t||this.height!==r||this.depth!==n){this.width=t,this.height=r,this.depth=n;for(let i=0,a=this.textures.length;i<a;i++)this.textures[i].image.width=t,this.textures[i].image.height=r,this.textures[i].image.depth=n;this.dispose()}this.viewport.set(0,0,t,r),this.scissor.set(0,0,t,r)}clone(){return new this.constructor().copy(this)}copy(t){this.width=t.width,this.height=t.height,this.depth=t.depth,this.scissor.copy(t.scissor),this.scissorTest=t.scissorTest,this.viewport.copy(t.viewport),this.textures.length=0;for(let n=0,i=t.textures.length;n<i;n++)this.textures[n]=t.textures[n].clone(),this.textures[n].isRenderTargetTexture=!0,this.textures[n].renderTarget=this;const r=Object.assign({},t.texture.image);return this.texture.source=new ZG(r),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.resolveDepthBuffer=t.resolveDepthBuffer,this.resolveStencilBuffer=t.resolveStencilBuffer,t.depthTexture!==null&&(this.depthTexture=t.depthTexture.clone()),this.samples=t.samples,this}dispose(){this.dispatchEvent({type:"dispose"})}}class Nu extends Wut{constructor(t=1,r=1,n={}){super(t,r,n),this.isWebGLRenderTarget=!0}}class qG extends ui{constructor(t=null,r=1,n=1,i=1){super(null),this.isDataArrayTexture=!0,this.image={data:t,width:r,height:n,depth:i},this.magFilter=ga,this.minFilter=ga,this.wrapR=ou,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1,this.layerUpdates=new Set}addLayerUpdate(t){this.layerUpdates.add(t)}clearLayerUpdates(){this.layerUpdates.clear()}}class Xut extends ui{constructor(t=null,r=1,n=1,i=1){super(null),this.isData3DTexture=!0,this.image={data:t,width:r,height:n,depth:i},this.magFilter=ga,this.minFilter=ga,this.wrapR=ou,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}}class Xv{constructor(t=0,r=0,n=0,i=1){this.isQuaternion=!0,this._x=t,this._y=r,this._z=n,this._w=i}static slerpFlat(t,r,n,i,a,o,s){let l=n[i+0],u=n[i+1],h=n[i+2],f=n[i+3];const c=a[o+0],d=a[o+1],v=a[o+2],p=a[o+3];if(s===0){t[r+0]=l,t[r+1]=u,t[r+2]=h,t[r+3]=f;return}if(s===1){t[r+0]=c,t[r+1]=d,t[r+2]=v,t[r+3]=p;return}if(f!==p||l!==c||u!==d||h!==v){let g=1-s;const m=l*c+u*d+h*v+f*p,_=m>=0?1:-1,y=1-m*m;if(y>Number.EPSILON){const T=Math.sqrt(y),S=Math.atan2(T,m*_);g=Math.sin(g*S)/T,s=Math.sin(s*S)/T}const x=s*_;if(l=l*g+c*x,u=u*g+d*x,h=h*g+v*x,f=f*g+p*x,g===1-s){const T=1/Math.sqrt(l*l+u*u+h*h+f*f);l*=T,u*=T,h*=T,f*=T}}t[r]=l,t[r+1]=u,t[r+2]=h,t[r+3]=f}static multiplyQuaternionsFlat(t,r,n,i,a,o){const s=n[i],l=n[i+1],u=n[i+2],h=n[i+3],f=a[o],c=a[o+1],d=a[o+2],v=a[o+3];return t[r]=s*v+h*f+l*d-u*c,t[r+1]=l*v+h*c+u*f-s*d,t[r+2]=u*v+h*d+s*c-l*f,t[r+3]=h*v-s*f-l*c-u*d,t}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get w(){return this._w}set w(t){this._w=t,this._onChangeCallback()}set(t,r,n,i){return this._x=t,this._y=r,this._z=n,this._w=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._w)}copy(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this._onChangeCallback(),this}setFromEuler(t,r=!0){const n=t._x,i=t._y,a=t._z,o=t._order,s=Math.cos,l=Math.sin,u=s(n/2),h=s(i/2),f=s(a/2),c=l(n/2),d=l(i/2),v=l(a/2);switch(o){case"XYZ":this._x=c*h*f+u*d*v,this._y=u*d*f-c*h*v,this._z=u*h*v+c*d*f,this._w=u*h*f-c*d*v;break;case"YXZ":this._x=c*h*f+u*d*v,this._y=u*d*f-c*h*v,this._z=u*h*v-c*d*f,this._w=u*h*f+c*d*v;break;case"ZXY":this._x=c*h*f-u*d*v,this._y=u*d*f+c*h*v,this._z=u*h*v+c*d*f,this._w=u*h*f-c*d*v;break;case"ZYX":this._x=c*h*f-u*d*v,this._y=u*d*f+c*h*v,this._z=u*h*v-c*d*f,this._w=u*h*f+c*d*v;break;case"YZX":this._x=c*h*f+u*d*v,this._y=u*d*f+c*h*v,this._z=u*h*v-c*d*f,this._w=u*h*f-c*d*v;break;case"XZY":this._x=c*h*f-u*d*v,this._y=u*d*f-c*h*v,this._z=u*h*v+c*d*f,this._w=u*h*f+c*d*v;break;default:console.warn("THREE.Quaternion: .setFromEuler() encountered an unknown order: "+o)}return r===!0&&this._onChangeCallback(),this}setFromAxisAngle(t,r){const n=r/2,i=Math.sin(n);return this._x=t.x*i,this._y=t.y*i,this._z=t.z*i,this._w=Math.cos(n),this._onChangeCallback(),this}setFromRotationMatrix(t){const r=t.elements,n=r[0],i=r[4],a=r[8],o=r[1],s=r[5],l=r[9],u=r[2],h=r[6],f=r[10],c=n+s+f;if(c>0){const d=.5/Math.sqrt(c+1);this._w=.25/d,this._x=(h-l)*d,this._y=(a-u)*d,this._z=(o-i)*d}else if(n>s&&n>f){const d=2*Math.sqrt(1+n-s-f);this._w=(h-l)/d,this._x=.25*d,this._y=(i+o)/d,this._z=(a+u)/d}else if(s>f){const d=2*Math.sqrt(1+s-n-f);this._w=(a-u)/d,this._x=(i+o)/d,this._y=.25*d,this._z=(l+h)/d}else{const d=2*Math.sqrt(1+f-n-s);this._w=(o-i)/d,this._x=(a+u)/d,this._y=(l+h)/d,this._z=.25*d}return this._onChangeCallback(),this}setFromUnitVectors(t,r){let n=t.dot(r)+1;return n<Number.EPSILON?(n=0,Math.abs(t.x)>Math.abs(t.z)?(this._x=-t.y,this._y=t.x,this._z=0,this._w=n):(this._x=0,this._y=-t.z,this._z=t.y,this._w=n)):(this._x=t.y*r.z-t.z*r.y,this._y=t.z*r.x-t.x*r.z,this._z=t.x*r.y-t.y*r.x,this._w=n),this.normalize()}angleTo(t){return 2*Math.acos(Math.abs(Ye(this.dot(t),-1,1)))}rotateTowards(t,r){const n=this.angleTo(t);if(n===0)return this;const i=Math.min(1,r/n);return this.slerp(t,i),this}identity(){return this.set(0,0,0,1)}invert(){return this.conjugate()}conjugate(){return this._x*=-1,this._y*=-1,this._z*=-1,this._onChangeCallback(),this}dot(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w}lengthSq(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w}length(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)}normalize(){let t=this.length();return t===0?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this._onChangeCallback(),this}multiply(t){return this.multiplyQuaternions(this,t)}premultiply(t){return this.multiplyQuaternions(t,this)}multiplyQuaternions(t,r){const n=t._x,i=t._y,a=t._z,o=t._w,s=r._x,l=r._y,u=r._z,h=r._w;return this._x=n*h+o*s+i*u-a*l,this._y=i*h+o*l+a*s-n*u,this._z=a*h+o*u+n*l-i*s,this._w=o*h-n*s-i*l-a*u,this._onChangeCallback(),this}slerp(t,r){if(r===0)return this;if(r===1)return this.copy(t);const n=this._x,i=this._y,a=this._z,o=this._w;let s=o*t._w+n*t._x+i*t._y+a*t._z;if(s<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,s=-s):this.copy(t),s>=1)return this._w=o,this._x=n,this._y=i,this._z=a,this;const l=1-s*s;if(l<=Number.EPSILON){const d=1-r;return this._w=d*o+r*this._w,this._x=d*n+r*this._x,this._y=d*i+r*this._y,this._z=d*a+r*this._z,this.normalize(),this}const u=Math.sqrt(l),h=Math.atan2(u,s),f=Math.sin((1-r)*h)/u,c=Math.sin(r*h)/u;return this._w=o*f+this._w*c,this._x=n*f+this._x*c,this._y=i*f+this._y*c,this._z=a*f+this._z*c,this._onChangeCallback(),this}slerpQuaternions(t,r,n){return this.copy(t).slerp(r,n)}random(){const t=2*Math.PI*Math.random(),r=2*Math.PI*Math.random(),n=Math.random(),i=Math.sqrt(1-n),a=Math.sqrt(n);return this.set(i*Math.sin(t),i*Math.cos(t),a*Math.sin(r),a*Math.cos(r))}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w}fromArray(t,r=0){return this._x=t[r],this._y=t[r+1],this._z=t[r+2],this._w=t[r+3],this._onChangeCallback(),this}toArray(t=[],r=0){return t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._w,t}fromBufferAttribute(t,r){return this._x=t.getX(r),this._y=t.getY(r),this._z=t.getZ(r),this._w=t.getW(r),this._onChangeCallback(),this}toJSON(){return this.toArray()}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._w}}class lt{constructor(t=0,r=0,n=0){lt.prototype.isVector3=!0,this.x=t,this.y=r,this.z=n}set(t,r,n){return n===void 0&&(n=this.z),this.x=t,this.y=r,this.z=n,this}setScalar(t){return this.x=t,this.y=t,this.z=t,this}setX(t){return this.x=t,this}setY(t){return this.y=t,this}setZ(t){return this.z=t,this}setComponent(t,r){switch(t){case 0:this.x=r;break;case 1:this.y=r;break;case 2:this.z=r;break;default:throw new Error("index is out of range: "+t)}return this}getComponent(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}}clone(){return new this.constructor(this.x,this.y,this.z)}copy(t){return this.x=t.x,this.y=t.y,this.z=t.z,this}add(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this}addScalar(t){return this.x+=t,this.y+=t,this.z+=t,this}addVectors(t,r){return this.x=t.x+r.x,this.y=t.y+r.y,this.z=t.z+r.z,this}addScaledVector(t,r){return this.x+=t.x*r,this.y+=t.y*r,this.z+=t.z*r,this}sub(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this}subScalar(t){return this.x-=t,this.y-=t,this.z-=t,this}subVectors(t,r){return this.x=t.x-r.x,this.y=t.y-r.y,this.z=t.z-r.z,this}multiply(t){return this.x*=t.x,this.y*=t.y,this.z*=t.z,this}multiplyScalar(t){return this.x*=t,this.y*=t,this.z*=t,this}multiplyVectors(t,r){return this.x=t.x*r.x,this.y=t.y*r.y,this.z=t.z*r.z,this}applyEuler(t){return this.applyQuaternion(rN.setFromEuler(t))}applyAxisAngle(t,r){return this.applyQuaternion(rN.setFromAxisAngle(t,r))}applyMatrix3(t){const r=this.x,n=this.y,i=this.z,a=t.elements;return this.x=a[0]*r+a[3]*n+a[6]*i,this.y=a[1]*r+a[4]*n+a[7]*i,this.z=a[2]*r+a[5]*n+a[8]*i,this}applyNormalMatrix(t){return this.applyMatrix3(t).normalize()}applyMatrix4(t){const r=this.x,n=this.y,i=this.z,a=t.elements,o=1/(a[3]*r+a[7]*n+a[11]*i+a[15]);return this.x=(a[0]*r+a[4]*n+a[8]*i+a[12])*o,this.y=(a[1]*r+a[5]*n+a[9]*i+a[13])*o,this.z=(a[2]*r+a[6]*n+a[10]*i+a[14])*o,this}applyQuaternion(t){const r=this.x,n=this.y,i=this.z,a=t.x,o=t.y,s=t.z,l=t.w,u=2*(o*i-s*n),h=2*(s*r-a*i),f=2*(a*n-o*r);return this.x=r+l*u+o*f-s*h,this.y=n+l*h+s*u-a*f,this.z=i+l*f+a*h-o*u,this}project(t){return this.applyMatrix4(t.matrixWorldInverse).applyMatrix4(t.projectionMatrix)}unproject(t){return this.applyMatrix4(t.projectionMatrixInverse).applyMatrix4(t.matrixWorld)}transformDirection(t){const r=this.x,n=this.y,i=this.z,a=t.elements;return this.x=a[0]*r+a[4]*n+a[8]*i,this.y=a[1]*r+a[5]*n+a[9]*i,this.z=a[2]*r+a[6]*n+a[10]*i,this.normalize()}divide(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this}divideScalar(t){return this.multiplyScalar(1/t)}min(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this}max(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this}clamp(t,r){return this.x=Ye(this.x,t.x,r.x),this.y=Ye(this.y,t.y,r.y),this.z=Ye(this.z,t.z,r.z),this}clampScalar(t,r){return this.x=Ye(this.x,t,r),this.y=Ye(this.y,t,r),this.z=Ye(this.z,t,r),this}clampLength(t,r){const n=this.length();return this.divideScalar(n||1).multiplyScalar(Ye(n,t,r))}floor(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this}ceil(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this}round(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this}roundToZero(){return this.x=Math.trunc(this.x),this.y=Math.trunc(this.y),this.z=Math.trunc(this.z),this}negate(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this}dot(t){return this.x*t.x+this.y*t.y+this.z*t.z}lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}length(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)}manhattanLength(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)}normalize(){return this.divideScalar(this.length()||1)}setLength(t){return this.normalize().multiplyScalar(t)}lerp(t,r){return this.x+=(t.x-this.x)*r,this.y+=(t.y-this.y)*r,this.z+=(t.z-this.z)*r,this}lerpVectors(t,r,n){return this.x=t.x+(r.x-t.x)*n,this.y=t.y+(r.y-t.y)*n,this.z=t.z+(r.z-t.z)*n,this}cross(t){return this.crossVectors(this,t)}crossVectors(t,r){const n=t.x,i=t.y,a=t.z,o=r.x,s=r.y,l=r.z;return this.x=i*l-a*s,this.y=a*o-n*l,this.z=n*s-i*o,this}projectOnVector(t){const r=t.lengthSq();if(r===0)return this.set(0,0,0);const n=t.dot(this)/r;return this.copy(t).multiplyScalar(n)}projectOnPlane(t){return w1.copy(this).projectOnVector(t),this.sub(w1)}reflect(t){return this.sub(w1.copy(t).multiplyScalar(2*this.dot(t)))}angleTo(t){const r=Math.sqrt(this.lengthSq()*t.lengthSq());if(r===0)return Math.PI/2;const n=this.dot(t)/r;return Math.acos(Ye(n,-1,1))}distanceTo(t){return Math.sqrt(this.distanceToSquared(t))}distanceToSquared(t){const r=this.x-t.x,n=this.y-t.y,i=this.z-t.z;return r*r+n*n+i*i}manhattanDistanceTo(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)}setFromSpherical(t){return this.setFromSphericalCoords(t.radius,t.phi,t.theta)}setFromSphericalCoords(t,r,n){const i=Math.sin(r)*t;return this.x=i*Math.sin(n),this.y=Math.cos(r)*t,this.z=i*Math.cos(n),this}setFromCylindrical(t){return this.setFromCylindricalCoords(t.radius,t.theta,t.y)}setFromCylindricalCoords(t,r,n){return this.x=t*Math.sin(r),this.y=n,this.z=t*Math.cos(r),this}setFromMatrixPosition(t){const r=t.elements;return this.x=r[12],this.y=r[13],this.z=r[14],this}setFromMatrixScale(t){const r=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),i=this.setFromMatrixColumn(t,2).length();return this.x=r,this.y=n,this.z=i,this}setFromMatrixColumn(t,r){return this.fromArray(t.elements,r*4)}setFromMatrix3Column(t,r){return this.fromArray(t.elements,r*3)}setFromEuler(t){return this.x=t._x,this.y=t._y,this.z=t._z,this}setFromColor(t){return this.x=t.r,this.y=t.g,this.z=t.b,this}equals(t){return t.x===this.x&&t.y===this.y&&t.z===this.z}fromArray(t,r=0){return this.x=t[r],this.y=t[r+1],this.z=t[r+2],this}toArray(t=[],r=0){return t[r]=this.x,t[r+1]=this.y,t[r+2]=this.z,t}fromBufferAttribute(t,r){return this.x=t.getX(r),this.y=t.getY(r),this.z=t.getZ(r),this}random(){return this.x=Math.random(),this.y=Math.random(),this.z=Math.random(),this}randomDirection(){const t=Math.random()*Math.PI*2,r=Math.random()*2-1,n=Math.sqrt(1-r*r);return this.x=n*Math.cos(t),this.y=r,this.z=n*Math.sin(t),this}*[Symbol.iterator](){yield this.x,yield this.y,yield this.z}}const w1=new lt,rN=new Xv;class Yv{constructor(t=new lt(1/0,1/0,1/0),r=new lt(-1/0,-1/0,-1/0)){this.isBox3=!0,this.min=t,this.max=r}set(t,r){return this.min.copy(t),this.max.copy(r),this}setFromArray(t){this.makeEmpty();for(let r=0,n=t.length;r<n;r+=3)this.expandByPoint(ea.fromArray(t,r));return this}setFromBufferAttribute(t){this.makeEmpty();for(let r=0,n=t.count;r<n;r++)this.expandByPoint(ea.fromBufferAttribute(t,r));return this}setFromPoints(t){this.makeEmpty();for(let r=0,n=t.length;r<n;r++)this.expandByPoint(t[r]);return this}setFromCenterAndSize(t,r){const n=ea.copy(r).multiplyScalar(.5);return this.min.copy(t).sub(n),this.max.copy(t).add(n),this}setFromObject(t,r=!1){return this.makeEmpty(),this.expandByObject(t,r)}clone(){return new this.constructor().copy(this)}copy(t){return this.min.copy(t.min),this.max.copy(t.max),this}makeEmpty(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this}isEmpty(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z}getCenter(t){return this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)}getSize(t){return this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)}expandByPoint(t){return this.min.min(t),this.max.max(t),this}expandByVector(t){return this.min.sub(t),this.max.add(t),this}expandByScalar(t){return this.min.addScalar(-t),this.max.addScalar(t),this}expandByObject(t,r=!1){t.updateWorldMatrix(!1,!1);const n=t.geometry;if(n!==void 0){const a=n.getAttribute("position");if(r===!0&&a!==void 0&&t.isInstancedMesh!==!0)for(let o=0,s=a.count;o<s;o++)t.isMesh===!0?t.getVertexPosition(o,ea):ea.fromBufferAttribute(a,o),ea.applyMatrix4(t.matrixWorld),this.expandByPoint(ea);else t.boundingBox!==void 0?(t.boundingBox===null&&t.computeBoundingBox(),cg.copy(t.boundingBox)):(n.boundingBox===null&&n.computeBoundingBox(),cg.copy(n.boundingBox)),cg.applyMatrix4(t.matrixWorld),this.union(cg)}const i=t.children;for(let a=0,o=i.length;a<o;a++)this.expandByObject(i[a],r);return this}containsPoint(t){return t.x>=this.min.x&&t.x<=this.max.x&&t.y>=this.min.y&&t.y<=this.max.y&&t.z>=this.min.z&&t.z<=this.max.z}containsBox(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z}getParameter(t,r){return r.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))}intersectsBox(t){return t.max.x>=this.min.x&&t.min.x<=this.max.x&&t.max.y>=this.min.y&&t.min.y<=this.max.y&&t.max.z>=this.min.z&&t.min.z<=this.max.z}intersectsSphere(t){return this.clampPoint(t.center,ea),ea.distanceToSquared(t.center)<=t.radius*t.radius}intersectsPlane(t){let r,n;return t.normal.x>0?(r=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(r=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(r+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(r+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(r+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(r+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),r<=-t.constant&&n>=-t.constant}intersectsTriangle(t){if(this.isEmpty())return!1;this.getCenter(qc),dg.subVectors(this.max,qc),Eh.subVectors(t.a,qc),Ch.subVectors(t.b,qc),Dh.subVectors(t.c,qc),os.subVectors(Ch,Eh),ss.subVectors(Dh,Ch),Dl.subVectors(Eh,Dh);let r=[0,-os.z,os.y,0,-ss.z,ss.y,0,-Dl.z,Dl.y,os.z,0,-os.x,ss.z,0,-ss.x,Dl.z,0,-Dl.x,-os.y,os.x,0,-ss.y,ss.x,0,-Dl.y,Dl.x,0];return!M1(r,Eh,Ch,Dh,dg)||(r=[1,0,0,0,1,0,0,0,1],!M1(r,Eh,Ch,Dh,dg))?!1:(vg.crossVectors(os,ss),r=[vg.x,vg.y,vg.z],M1(r,Eh,Ch,Dh,dg))}clampPoint(t,r){return r.copy(t).clamp(this.min,this.max)}distanceToPoint(t){return this.clampPoint(t,ea).distanceTo(t)}getBoundingSphere(t){return this.isEmpty()?t.makeEmpty():(this.getCenter(t.center),t.radius=this.getSize(ea).length()*.5),t}intersect(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this}union(t){return this.min.min(t.min),this.max.max(t.max),this}applyMatrix4(t){return this.isEmpty()?this:(so[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(t),so[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(t),so[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(t),so[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(t),so[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(t),so[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(t),so[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(t),so[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(t),this.setFromPoints(so),this)}translate(t){return this.min.add(t),this.max.add(t),this}equals(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}const so=[new lt,new lt,new lt,new lt,new lt,new lt,new lt,new lt],ea=new lt,cg=new Yv,Eh=new lt,Ch=new lt,Dh=new lt,os=new lt,ss=new lt,Dl=new lt,qc=new lt,dg=new lt,vg=new lt,Ll=new lt;function M1(e,t,r,n,i){for(let a=0,o=e.length-3;a<=o;a+=3){Ll.fromArray(e,a);const s=i.x*Math.abs(Ll.x)+i.y*Math.abs(Ll.y)+i.z*Math.abs(Ll.z),l=t.dot(Ll),u=r.dot(Ll),h=n.dot(Ll);if(Math.max(-Math.max(l,u,h),Math.min(l,u,h))>s)return!1}return!0}const Yut=new Yv,$c=new lt,A1=new lt;class MA{constructor(t=new lt,r=-1){this.isSphere=!0,this.center=t,this.radius=r}set(t,r){return this.center.copy(t),this.radius=r,this}setFromPoints(t,r){const n=this.center;r!==void 0?n.copy(r):Yut.setFromPoints(t).getCenter(n);let i=0;for(let a=0,o=t.length;a<o;a++)i=Math.max(i,n.distanceToSquared(t[a]));return this.radius=Math.sqrt(i),this}copy(t){return this.center.copy(t.center),this.radius=t.radius,this}isEmpty(){return this.radius<0}makeEmpty(){return this.center.set(0,0,0),this.radius=-1,this}containsPoint(t){return t.distanceToSquared(this.center)<=this.radius*this.radius}distanceToPoint(t){return t.distanceTo(this.center)-this.radius}intersectsSphere(t){const r=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=r*r}intersectsBox(t){return t.intersectsSphere(this)}intersectsPlane(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius}clampPoint(t,r){const n=this.center.distanceToSquared(t);return r.copy(t),n>this.radius*this.radius&&(r.sub(this.center).normalize(),r.multiplyScalar(this.radius).add(this.center)),r}getBoundingBox(t){return this.isEmpty()?(t.makeEmpty(),t):(t.set(this.center,this.center),t.expandByScalar(this.radius),t)}applyMatrix4(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this}translate(t){return this.center.add(t),this}expandByPoint(t){if(this.isEmpty())return this.center.copy(t),this.radius=0,this;$c.subVectors(t,this.center);const r=$c.lengthSq();if(r>this.radius*this.radius){const n=Math.sqrt(r),i=(n-this.radius)*.5;this.center.addScaledVector($c,i/n),this.radius+=i}return this}union(t){return t.isEmpty()?this:this.isEmpty()?(this.copy(t),this):(this.center.equals(t.center)===!0?this.radius=Math.max(this.radius,t.radius):(A1.subVectors(t.center,this.center).setLength(t.radius),this.expandByPoint($c.copy(t.center).add(A1)),this.expandByPoint($c.copy(t.center).sub(A1))),this)}equals(t){return t.center.equals(this.center)&&t.radius===this.radius}clone(){return new this.constructor().copy(this)}}const lo=new lt,E1=new lt,pg=new lt,ls=new lt,C1=new lt,gg=new lt,D1=new lt;class Zut{constructor(t=new lt,r=new lt(0,0,-1)){this.origin=t,this.direction=r}set(t,r){return this.origin.copy(t),this.direction.copy(r),this}copy(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this}at(t,r){return r.copy(this.origin).addScaledVector(this.direction,t)}lookAt(t){return this.direction.copy(t).sub(this.origin).normalize(),this}recast(t){return this.origin.copy(this.at(t,lo)),this}closestPointToPoint(t,r){r.subVectors(t,this.origin);const n=r.dot(this.direction);return n<0?r.copy(this.origin):r.copy(this.origin).addScaledVector(this.direction,n)}distanceToPoint(t){return Math.sqrt(this.distanceSqToPoint(t))}distanceSqToPoint(t){const r=lo.subVectors(t,this.origin).dot(this.direction);return r<0?this.origin.distanceToSquared(t):(lo.copy(this.origin).addScaledVector(this.direction,r),lo.distanceToSquared(t))}distanceSqToSegment(t,r,n,i){E1.copy(t).add(r).multiplyScalar(.5),pg.copy(r).sub(t).normalize(),ls.copy(this.origin).sub(E1);const a=t.distanceTo(r)*.5,o=-this.direction.dot(pg),s=ls.dot(this.direction),l=-ls.dot(pg),u=ls.lengthSq(),h=Math.abs(1-o*o);let f,c,d,v;if(h>0)if(f=o*l-s,c=o*s-l,v=a*h,f>=0)if(c>=-v)if(c<=v){const p=1/h;f*=p,c*=p,d=f*(f+o*c+2*s)+c*(o*f+c+2*l)+u}else c=a,f=Math.max(0,-(o*c+s)),d=-f*f+c*(c+2*l)+u;else c=-a,f=Math.max(0,-(o*c+s)),d=-f*f+c*(c+2*l)+u;else c<=-v?(f=Math.max(0,-(-o*a+s)),c=f>0?-a:Math.min(Math.max(-a,-l),a),d=-f*f+c*(c+2*l)+u):c<=v?(f=0,c=Math.min(Math.max(-a,-l),a),d=c*(c+2*l)+u):(f=Math.max(0,-(o*a+s)),c=f>0?a:Math.min(Math.max(-a,-l),a),d=-f*f+c*(c+2*l)+u);else c=o>0?-a:a,f=Math.max(0,-(o*c+s)),d=-f*f+c*(c+2*l)+u;return n&&n.copy(this.origin).addScaledVector(this.direction,f),i&&i.copy(E1).addScaledVector(pg,c),d}intersectSphere(t,r){lo.subVectors(t.center,this.origin);const n=lo.dot(this.direction),i=lo.dot(lo)-n*n,a=t.radius*t.radius;if(i>a)return null;const o=Math.sqrt(a-i),s=n-o,l=n+o;return l<0?null:s<0?this.at(l,r):this.at(s,r)}intersectsSphere(t){return this.distanceSqToPoint(t.center)<=t.radius*t.radius}distanceToPlane(t){const r=t.normal.dot(this.direction);if(r===0)return t.distanceToPoint(this.origin)===0?0:null;const n=-(this.origin.dot(t.normal)+t.constant)/r;return n>=0?n:null}intersectPlane(t,r){const n=this.distanceToPlane(t);return n===null?null:this.at(n,r)}intersectsPlane(t){const r=t.distanceToPoint(this.origin);return r===0||t.normal.dot(this.direction)*r<0}intersectBox(t,r){let n,i,a,o,s,l;const u=1/this.direction.x,h=1/this.direction.y,f=1/this.direction.z,c=this.origin;return u>=0?(n=(t.min.x-c.x)*u,i=(t.max.x-c.x)*u):(n=(t.max.x-c.x)*u,i=(t.min.x-c.x)*u),h>=0?(a=(t.min.y-c.y)*h,o=(t.max.y-c.y)*h):(a=(t.max.y-c.y)*h,o=(t.min.y-c.y)*h),n>o||a>i||((a>n||isNaN(n))&&(n=a),(o<i||isNaN(i))&&(i=o),f>=0?(s=(t.min.z-c.z)*f,l=(t.max.z-c.z)*f):(s=(t.max.z-c.z)*f,l=(t.min.z-c.z)*f),n>l||s>i)||((s>n||n!==n)&&(n=s),(l<i||i!==i)&&(i=l),i<0)?null:this.at(n>=0?n:i,r)}intersectsBox(t){return this.intersectBox(t,lo)!==null}intersectTriangle(t,r,n,i,a){C1.subVectors(r,t),gg.subVectors(n,t),D1.crossVectors(C1,gg);let o=this.direction.dot(D1),s;if(o>0){if(i)return null;s=1}else if(o<0)s=-1,o=-o;else return null;ls.subVectors(this.origin,t);const l=s*this.direction.dot(gg.crossVectors(ls,gg));if(l<0)return null;const u=s*this.direction.dot(C1.cross(ls));if(u<0||l+u>o)return null;const h=-s*ls.dot(D1);return h<0?null:this.at(h/o,a)}applyMatrix4(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this}equals(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}clone(){return new this.constructor().copy(this)}}class qr{constructor(t,r,n,i,a,o,s,l,u,h,f,c,d,v,p,g){qr.prototype.isMatrix4=!0,this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],t!==void 0&&this.set(t,r,n,i,a,o,s,l,u,h,f,c,d,v,p,g)}set(t,r,n,i,a,o,s,l,u,h,f,c,d,v,p,g){const m=this.elements;return m[0]=t,m[4]=r,m[8]=n,m[12]=i,m[1]=a,m[5]=o,m[9]=s,m[13]=l,m[2]=u,m[6]=h,m[10]=f,m[14]=c,m[3]=d,m[7]=v,m[11]=p,m[15]=g,this}identity(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this}clone(){return new qr().fromArray(this.elements)}copy(t){const r=this.elements,n=t.elements;return r[0]=n[0],r[1]=n[1],r[2]=n[2],r[3]=n[3],r[4]=n[4],r[5]=n[5],r[6]=n[6],r[7]=n[7],r[8]=n[8],r[9]=n[9],r[10]=n[10],r[11]=n[11],r[12]=n[12],r[13]=n[13],r[14]=n[14],r[15]=n[15],this}copyPosition(t){const r=this.elements,n=t.elements;return r[12]=n[12],r[13]=n[13],r[14]=n[14],this}setFromMatrix3(t){const r=t.elements;return this.set(r[0],r[3],r[6],0,r[1],r[4],r[7],0,r[2],r[5],r[8],0,0,0,0,1),this}extractBasis(t,r,n){return t.setFromMatrixColumn(this,0),r.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this}makeBasis(t,r,n){return this.set(t.x,r.x,n.x,0,t.y,r.y,n.y,0,t.z,r.z,n.z,0,0,0,0,1),this}extractRotation(t){const r=this.elements,n=t.elements,i=1/Lh.setFromMatrixColumn(t,0).length(),a=1/Lh.setFromMatrixColumn(t,1).length(),o=1/Lh.setFromMatrixColumn(t,2).length();return r[0]=n[0]*i,r[1]=n[1]*i,r[2]=n[2]*i,r[3]=0,r[4]=n[4]*a,r[5]=n[5]*a,r[6]=n[6]*a,r[7]=0,r[8]=n[8]*o,r[9]=n[9]*o,r[10]=n[10]*o,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromEuler(t){const r=this.elements,n=t.x,i=t.y,a=t.z,o=Math.cos(n),s=Math.sin(n),l=Math.cos(i),u=Math.sin(i),h=Math.cos(a),f=Math.sin(a);if(t.order==="XYZ"){const c=o*h,d=o*f,v=s*h,p=s*f;r[0]=l*h,r[4]=-l*f,r[8]=u,r[1]=d+v*u,r[5]=c-p*u,r[9]=-s*l,r[2]=p-c*u,r[6]=v+d*u,r[10]=o*l}else if(t.order==="YXZ"){const c=l*h,d=l*f,v=u*h,p=u*f;r[0]=c+p*s,r[4]=v*s-d,r[8]=o*u,r[1]=o*f,r[5]=o*h,r[9]=-s,r[2]=d*s-v,r[6]=p+c*s,r[10]=o*l}else if(t.order==="ZXY"){const c=l*h,d=l*f,v=u*h,p=u*f;r[0]=c-p*s,r[4]=-o*f,r[8]=v+d*s,r[1]=d+v*s,r[5]=o*h,r[9]=p-c*s,r[2]=-o*u,r[6]=s,r[10]=o*l}else if(t.order==="ZYX"){const c=o*h,d=o*f,v=s*h,p=s*f;r[0]=l*h,r[4]=v*u-d,r[8]=c*u+p,r[1]=l*f,r[5]=p*u+c,r[9]=d*u-v,r[2]=-u,r[6]=s*l,r[10]=o*l}else if(t.order==="YZX"){const c=o*l,d=o*u,v=s*l,p=s*u;r[0]=l*h,r[4]=p-c*f,r[8]=v*f+d,r[1]=f,r[5]=o*h,r[9]=-s*h,r[2]=-u*h,r[6]=d*f+v,r[10]=c-p*f}else if(t.order==="XZY"){const c=o*l,d=o*u,v=s*l,p=s*u;r[0]=l*h,r[4]=-f,r[8]=u*h,r[1]=c*f+p,r[5]=o*h,r[9]=d*f-v,r[2]=v*f-d,r[6]=s*h,r[10]=p*f+c}return r[3]=0,r[7]=0,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,this}makeRotationFromQuaternion(t){return this.compose(qut,t,$ut)}lookAt(t,r,n){const i=this.elements;return pi.subVectors(t,r),pi.lengthSq()===0&&(pi.z=1),pi.normalize(),us.crossVectors(n,pi),us.lengthSq()===0&&(Math.abs(n.z)===1?pi.x+=1e-4:pi.z+=1e-4,pi.normalize(),us.crossVectors(n,pi)),us.normalize(),mg.crossVectors(pi,us),i[0]=us.x,i[4]=mg.x,i[8]=pi.x,i[1]=us.y,i[5]=mg.y,i[9]=pi.y,i[2]=us.z,i[6]=mg.z,i[10]=pi.z,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}multiplyMatrices(t,r){const n=t.elements,i=r.elements,a=this.elements,o=n[0],s=n[4],l=n[8],u=n[12],h=n[1],f=n[5],c=n[9],d=n[13],v=n[2],p=n[6],g=n[10],m=n[14],_=n[3],y=n[7],x=n[11],T=n[15],S=i[0],M=i[4],w=i[8],b=i[12],A=i[1],E=i[5],C=i[9],D=i[13],L=i[2],P=i[6],N=i[10],O=i[14],I=i[3],k=i[7],z=i[11],X=i[15];return a[0]=o*S+s*A+l*L+u*I,a[4]=o*M+s*E+l*P+u*k,a[8]=o*w+s*C+l*N+u*z,a[12]=o*b+s*D+l*O+u*X,a[1]=h*S+f*A+c*L+d*I,a[5]=h*M+f*E+c*P+d*k,a[9]=h*w+f*C+c*N+d*z,a[13]=h*b+f*D+c*O+d*X,a[2]=v*S+p*A+g*L+m*I,a[6]=v*M+p*E+g*P+m*k,a[10]=v*w+p*C+g*N+m*z,a[14]=v*b+p*D+g*O+m*X,a[3]=_*S+y*A+x*L+T*I,a[7]=_*M+y*E+x*P+T*k,a[11]=_*w+y*C+x*N+T*z,a[15]=_*b+y*D+x*O+T*X,this}multiplyScalar(t){const r=this.elements;return r[0]*=t,r[4]*=t,r[8]*=t,r[12]*=t,r[1]*=t,r[5]*=t,r[9]*=t,r[13]*=t,r[2]*=t,r[6]*=t,r[10]*=t,r[14]*=t,r[3]*=t,r[7]*=t,r[11]*=t,r[15]*=t,this}determinant(){const t=this.elements,r=t[0],n=t[4],i=t[8],a=t[12],o=t[1],s=t[5],l=t[9],u=t[13],h=t[2],f=t[6],c=t[10],d=t[14],v=t[3],p=t[7],g=t[11],m=t[15];return v*(+a*l*f-i*u*f-a*s*c+n*u*c+i*s*d-n*l*d)+p*(+r*l*d-r*u*c+a*o*c-i*o*d+i*u*h-a*l*h)+g*(+r*u*f-r*s*d-a*o*f+n*o*d+a*s*h-n*u*h)+m*(-i*s*h-r*l*f+r*s*c+i*o*f-n*o*c+n*l*h)}transpose(){const t=this.elements;let r;return r=t[1],t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,this}setPosition(t,r,n){const i=this.elements;return t.isVector3?(i[12]=t.x,i[13]=t.y,i[14]=t.z):(i[12]=t,i[13]=r,i[14]=n),this}invert(){const t=this.elements,r=t[0],n=t[1],i=t[2],a=t[3],o=t[4],s=t[5],l=t[6],u=t[7],h=t[8],f=t[9],c=t[10],d=t[11],v=t[12],p=t[13],g=t[14],m=t[15],_=f*g*u-p*c*u+p*l*d-s*g*d-f*l*m+s*c*m,y=v*c*u-h*g*u-v*l*d+o*g*d+h*l*m-o*c*m,x=h*p*u-v*f*u+v*s*d-o*p*d-h*s*m+o*f*m,T=v*f*l-h*p*l-v*s*c+o*p*c+h*s*g-o*f*g,S=r*_+n*y+i*x+a*T;if(S===0)return this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0);const M=1/S;return t[0]=_*M,t[1]=(p*c*a-f*g*a-p*i*d+n*g*d+f*i*m-n*c*m)*M,t[2]=(s*g*a-p*l*a+p*i*u-n*g*u-s*i*m+n*l*m)*M,t[3]=(f*l*a-s*c*a-f*i*u+n*c*u+s*i*d-n*l*d)*M,t[4]=y*M,t[5]=(h*g*a-v*c*a+v*i*d-r*g*d-h*i*m+r*c*m)*M,t[6]=(v*l*a-o*g*a-v*i*u+r*g*u+o*i*m-r*l*m)*M,t[7]=(o*c*a-h*l*a+h*i*u-r*c*u-o*i*d+r*l*d)*M,t[8]=x*M,t[9]=(v*f*a-h*p*a-v*n*d+r*p*d+h*n*m-r*f*m)*M,t[10]=(o*p*a-v*s*a+v*n*u-r*p*u-o*n*m+r*s*m)*M,t[11]=(h*s*a-o*f*a-h*n*u+r*f*u+o*n*d-r*s*d)*M,t[12]=T*M,t[13]=(h*p*i-v*f*i+v*n*c-r*p*c-h*n*g+r*f*g)*M,t[14]=(v*s*i-o*p*i-v*n*l+r*p*l+o*n*g-r*s*g)*M,t[15]=(o*f*i-h*s*i+h*n*l-r*f*l-o*n*c+r*s*c)*M,this}scale(t){const r=this.elements,n=t.x,i=t.y,a=t.z;return r[0]*=n,r[4]*=i,r[8]*=a,r[1]*=n,r[5]*=i,r[9]*=a,r[2]*=n,r[6]*=i,r[10]*=a,r[3]*=n,r[7]*=i,r[11]*=a,this}getMaxScaleOnAxis(){const t=this.elements,r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],i=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(r,n,i))}makeTranslation(t,r,n){return t.isVector3?this.set(1,0,0,t.x,0,1,0,t.y,0,0,1,t.z,0,0,0,1):this.set(1,0,0,t,0,1,0,r,0,0,1,n,0,0,0,1),this}makeRotationX(t){const r=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,r,-n,0,0,n,r,0,0,0,0,1),this}makeRotationY(t){const r=Math.cos(t),n=Math.sin(t);return this.set(r,0,n,0,0,1,0,0,-n,0,r,0,0,0,0,1),this}makeRotationZ(t){const r=Math.cos(t),n=Math.sin(t);return this.set(r,-n,0,0,n,r,0,0,0,0,1,0,0,0,0,1),this}makeRotationAxis(t,r){const n=Math.cos(r),i=Math.sin(r),a=1-n,o=t.x,s=t.y,l=t.z,u=a*o,h=a*s;return this.set(u*o+n,u*s-i*l,u*l+i*s,0,u*s+i*l,h*s+n,h*l-i*o,0,u*l-i*s,h*l+i*o,a*l*l+n,0,0,0,0,1),this}makeScale(t,r,n){return this.set(t,0,0,0,0,r,0,0,0,0,n,0,0,0,0,1),this}makeShear(t,r,n,i,a,o){return this.set(1,n,a,0,t,1,o,0,r,i,1,0,0,0,0,1),this}compose(t,r,n){const i=this.elements,a=r._x,o=r._y,s=r._z,l=r._w,u=a+a,h=o+o,f=s+s,c=a*u,d=a*h,v=a*f,p=o*h,g=o*f,m=s*f,_=l*u,y=l*h,x=l*f,T=n.x,S=n.y,M=n.z;return i[0]=(1-(p+m))*T,i[1]=(d+x)*T,i[2]=(v-y)*T,i[3]=0,i[4]=(d-x)*S,i[5]=(1-(c+m))*S,i[6]=(g+_)*S,i[7]=0,i[8]=(v+y)*M,i[9]=(g-_)*M,i[10]=(1-(c+p))*M,i[11]=0,i[12]=t.x,i[13]=t.y,i[14]=t.z,i[15]=1,this}decompose(t,r,n){const i=this.elements;let a=Lh.set(i[0],i[1],i[2]).length();const o=Lh.set(i[4],i[5],i[6]).length(),s=Lh.set(i[8],i[9],i[10]).length();this.determinant()<0&&(a=-a),t.x=i[12],t.y=i[13],t.z=i[14],ra.copy(this);const u=1/a,h=1/o,f=1/s;return ra.elements[0]*=u,ra.elements[1]*=u,ra.elements[2]*=u,ra.elements[4]*=h,ra.elements[5]*=h,ra.elements[6]*=h,ra.elements[8]*=f,ra.elements[9]*=f,ra.elements[10]*=f,r.setFromRotationMatrix(ra),n.x=a,n.y=o,n.z=s,this}makePerspective(t,r,n,i,a,o,s=To){const l=this.elements,u=2*a/(r-t),h=2*a/(n-i),f=(r+t)/(r-t),c=(n+i)/(n-i);let d,v;if(s===To)d=-(o+a)/(o-a),v=-2*o*a/(o-a);else if(s===__)d=-o/(o-a),v=-o*a/(o-a);else throw new Error("THREE.Matrix4.makePerspective(): Invalid coordinate system: "+s);return l[0]=u,l[4]=0,l[8]=f,l[12]=0,l[1]=0,l[5]=h,l[9]=c,l[13]=0,l[2]=0,l[6]=0,l[10]=d,l[14]=v,l[3]=0,l[7]=0,l[11]=-1,l[15]=0,this}makeOrthographic(t,r,n,i,a,o,s=To){const l=this.elements,u=1/(r-t),h=1/(n-i),f=1/(o-a),c=(r+t)*u,d=(n+i)*h;let v,p;if(s===To)v=(o+a)*f,p=-2*f;else if(s===__)v=a*f,p=-1*f;else throw new Error("THREE.Matrix4.makeOrthographic(): Invalid coordinate system: "+s);return l[0]=2*u,l[4]=0,l[8]=0,l[12]=-c,l[1]=0,l[5]=2*h,l[9]=0,l[13]=-d,l[2]=0,l[6]=0,l[10]=p,l[14]=-v,l[3]=0,l[7]=0,l[11]=0,l[15]=1,this}equals(t){const r=this.elements,n=t.elements;for(let i=0;i<16;i++)if(r[i]!==n[i])return!1;return!0}fromArray(t,r=0){for(let n=0;n<16;n++)this.elements[n]=t[n+r];return this}toArray(t=[],r=0){const n=this.elements;return t[r]=n[0],t[r+1]=n[1],t[r+2]=n[2],t[r+3]=n[3],t[r+4]=n[4],t[r+5]=n[5],t[r+6]=n[6],t[r+7]=n[7],t[r+8]=n[8],t[r+9]=n[9],t[r+10]=n[10],t[r+11]=n[11],t[r+12]=n[12],t[r+13]=n[13],t[r+14]=n[14],t[r+15]=n[15],t}}const Lh=new lt,ra=new qr,qut=new lt(0,0,0),$ut=new lt(1,1,1),us=new lt,mg=new lt,pi=new lt,nN=new qr,iN=new Xv;class ko{constructor(t=0,r=0,n=0,i=ko.DEFAULT_ORDER){this.isEuler=!0,this._x=t,this._y=r,this._z=n,this._order=i}get x(){return this._x}set x(t){this._x=t,this._onChangeCallback()}get y(){return this._y}set y(t){this._y=t,this._onChangeCallback()}get z(){return this._z}set z(t){this._z=t,this._onChangeCallback()}get order(){return this._order}set order(t){this._order=t,this._onChangeCallback()}set(t,r,n,i=this._order){return this._x=t,this._y=r,this._z=n,this._order=i,this._onChangeCallback(),this}clone(){return new this.constructor(this._x,this._y,this._z,this._order)}copy(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this._onChangeCallback(),this}setFromRotationMatrix(t,r=this._order,n=!0){const i=t.elements,a=i[0],o=i[4],s=i[8],l=i[1],u=i[5],h=i[9],f=i[2],c=i[6],d=i[10];switch(r){case"XYZ":this._y=Math.asin(Ye(s,-1,1)),Math.abs(s)<.9999999?(this._x=Math.atan2(-h,d),this._z=Math.atan2(-o,a)):(this._x=Math.atan2(c,u),this._z=0);break;case"YXZ":this._x=Math.asin(-Ye(h,-1,1)),Math.abs(h)<.9999999?(this._y=Math.atan2(s,d),this._z=Math.atan2(l,u)):(this._y=Math.atan2(-f,a),this._z=0);break;case"ZXY":this._x=Math.asin(Ye(c,-1,1)),Math.abs(c)<.9999999?(this._y=Math.atan2(-f,d),this._z=Math.atan2(-o,u)):(this._y=0,this._z=Math.atan2(l,a));break;case"ZYX":this._y=Math.asin(-Ye(f,-1,1)),Math.abs(f)<.9999999?(this._x=Math.atan2(c,d),this._z=Math.atan2(l,a)):(this._x=0,this._z=Math.atan2(-o,u));break;case"YZX":this._z=Math.asin(Ye(l,-1,1)),Math.abs(l)<.9999999?(this._x=Math.atan2(-h,u),this._y=Math.atan2(-f,a)):(this._x=0,this._y=Math.atan2(s,d));break;case"XZY":this._z=Math.asin(-Ye(o,-1,1)),Math.abs(o)<.9999999?(this._x=Math.atan2(c,u),this._y=Math.atan2(s,a)):(this._x=Math.atan2(-h,d),this._y=0);break;default:console.warn("THREE.Euler: .setFromRotationMatrix() encountered an unknown order: "+r)}return this._order=r,n===!0&&this._onChangeCallback(),this}setFromQuaternion(t,r,n){return nN.makeRotationFromQuaternion(t),this.setFromRotationMatrix(nN,r,n)}setFromVector3(t,r=this._order){return this.set(t.x,t.y,t.z,r)}reorder(t){return iN.setFromEuler(this),this.setFromQuaternion(iN,t)}equals(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order}fromArray(t){return this._x=t[0],this._y=t[1],this._z=t[2],t[3]!==void 0&&(this._order=t[3]),this._onChangeCallback(),this}toArray(t=[],r=0){return t[r]=this._x,t[r+1]=this._y,t[r+2]=this._z,t[r+3]=this._order,t}_onChange(t){return this._onChangeCallback=t,this}_onChangeCallback(){}*[Symbol.iterator](){yield this._x,yield this._y,yield this._z,yield this._order}}ko.DEFAULT_ORDER="XYZ";class $G{constructor(){this.mask=1}set(t){this.mask=(1<<t|0)>>>0}enable(t){this.mask|=1<<t|0}enableAll(){this.mask=-1}toggle(t){this.mask^=1<<t|0}disable(t){this.mask&=~(1<<t|0)}disableAll(){this.mask=0}test(t){return(this.mask&t.mask)!==0}isEnabled(t){return(this.mask&(1<<t|0))!==0}}let Kut=0;const aN=new lt,Rh=new Xv,uo=new qr,_g=new lt,Kc=new lt,jut=new lt,Jut=new Xv,oN=new lt(1,0,0),sN=new lt(0,1,0),lN=new lt(0,0,1),uN={type:"added"},Qut={type:"removed"},Ph={type:"childadded",child:null},L1={type:"childremoved",child:null};class hi extends oc{constructor(){super(),this.isObject3D=!0,Object.defineProperty(this,"id",{value:Kut++}),this.uuid=Wv(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=hi.DEFAULT_UP.clone();const t=new lt,r=new ko,n=new Xv,i=new lt(1,1,1);function a(){n.setFromEuler(r,!1)}function o(){r.setFromQuaternion(n,void 0,!1)}r._onChange(a),n._onChange(o),Object.defineProperties(this,{position:{configurable:!0,enumerable:!0,value:t},rotation:{configurable:!0,enumerable:!0,value:r},quaternion:{configurable:!0,enumerable:!0,value:n},scale:{configurable:!0,enumerable:!0,value:i},modelViewMatrix:{value:new qr},normalMatrix:{value:new Pe}}),this.matrix=new qr,this.matrixWorld=new qr,this.matrixAutoUpdate=hi.DEFAULT_MATRIX_AUTO_UPDATE,this.matrixWorldAutoUpdate=hi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE,this.matrixWorldNeedsUpdate=!1,this.layers=new $G,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.animations=[],this.userData={}}onBeforeShadow(){}onAfterShadow(){}onBeforeRender(){}onAfterRender(){}applyMatrix4(t){this.matrixAutoUpdate&&this.updateMatrix(),this.matrix.premultiply(t),this.matrix.decompose(this.position,this.quaternion,this.scale)}applyQuaternion(t){return this.quaternion.premultiply(t),this}setRotationFromAxisAngle(t,r){this.quaternion.setFromAxisAngle(t,r)}setRotationFromEuler(t){this.quaternion.setFromEuler(t,!0)}setRotationFromMatrix(t){this.quaternion.setFromRotationMatrix(t)}setRotationFromQuaternion(t){this.quaternion.copy(t)}rotateOnAxis(t,r){return Rh.setFromAxisAngle(t,r),this.quaternion.multiply(Rh),this}rotateOnWorldAxis(t,r){return Rh.setFromAxisAngle(t,r),this.quaternion.premultiply(Rh),this}rotateX(t){return this.rotateOnAxis(oN,t)}rotateY(t){return this.rotateOnAxis(sN,t)}rotateZ(t){return this.rotateOnAxis(lN,t)}translateOnAxis(t,r){return aN.copy(t).applyQuaternion(this.quaternion),this.position.add(aN.multiplyScalar(r)),this}translateX(t){return this.translateOnAxis(oN,t)}translateY(t){return this.translateOnAxis(sN,t)}translateZ(t){return this.translateOnAxis(lN,t)}localToWorld(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(this.matrixWorld)}worldToLocal(t){return this.updateWorldMatrix(!0,!1),t.applyMatrix4(uo.copy(this.matrixWorld).invert())}lookAt(t,r,n){t.isVector3?_g.copy(t):_g.set(t,r,n);const i=this.parent;this.updateWorldMatrix(!0,!1),Kc.setFromMatrixPosition(this.matrixWorld),this.isCamera||this.isLight?uo.lookAt(Kc,_g,this.up):uo.lookAt(_g,Kc,this.up),this.quaternion.setFromRotationMatrix(uo),i&&(uo.extractRotation(i.matrixWorld),Rh.setFromRotationMatrix(uo),this.quaternion.premultiply(Rh.invert()))}add(t){if(arguments.length>1){for(let r=0;r<arguments.length;r++)this.add(arguments[r]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(t.removeFromParent(),t.parent=this,this.children.push(t),t.dispatchEvent(uN),Ph.child=t,this.dispatchEvent(Ph),Ph.child=null):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)}remove(t){if(arguments.length>1){for(let n=0;n<arguments.length;n++)this.remove(arguments[n]);return this}const r=this.children.indexOf(t);return r!==-1&&(t.parent=null,this.children.splice(r,1),t.dispatchEvent(Qut),L1.child=t,this.dispatchEvent(L1),L1.child=null),this}removeFromParent(){const t=this.parent;return t!==null&&t.remove(this),this}clear(){return this.remove(...this.children)}attach(t){return this.updateWorldMatrix(!0,!1),uo.copy(this.matrixWorld).invert(),t.parent!==null&&(t.parent.updateWorldMatrix(!0,!1),uo.multiply(t.parent.matrixWorld)),t.applyMatrix4(uo),t.removeFromParent(),t.parent=this,this.children.push(t),t.updateWorldMatrix(!1,!0),t.dispatchEvent(uN),Ph.child=t,this.dispatchEvent(Ph),Ph.child=null,this}getObjectById(t){return this.getObjectByProperty("id",t)}getObjectByName(t){return this.getObjectByProperty("name",t)}getObjectByProperty(t,r){if(this[t]===r)return this;for(let n=0,i=this.children.length;n<i;n++){const o=this.children[n].getObjectByProperty(t,r);if(o!==void 0)return o}}getObjectsByProperty(t,r,n=[]){this[t]===r&&n.push(this);const i=this.children;for(let a=0,o=i.length;a<o;a++)i[a].getObjectsByProperty(t,r,n);return n}getWorldPosition(t){return this.updateWorldMatrix(!0,!1),t.setFromMatrixPosition(this.matrixWorld)}getWorldQuaternion(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kc,t,jut),t}getWorldScale(t){return this.updateWorldMatrix(!0,!1),this.matrixWorld.decompose(Kc,Jut,t),t}getWorldDirection(t){this.updateWorldMatrix(!0,!1);const r=this.matrixWorld.elements;return t.set(r[8],r[9],r[10]).normalize()}raycast(){}traverse(t){t(this);const r=this.children;for(let n=0,i=r.length;n<i;n++)r[n].traverse(t)}traverseVisible(t){if(this.visible===!1)return;t(this);const r=this.children;for(let n=0,i=r.length;n<i;n++)r[n].traverseVisible(t)}traverseAncestors(t){const r=this.parent;r!==null&&(t(r),r.traverseAncestors(t))}updateMatrix(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0}updateMatrixWorld(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),this.matrixWorldNeedsUpdate=!1,t=!0);const r=this.children;for(let n=0,i=r.length;n<i;n++)r[n].updateMatrixWorld(t)}updateWorldMatrix(t,r){const n=this.parent;if(t===!0&&n!==null&&n.updateWorldMatrix(!0,!1),this.matrixAutoUpdate&&this.updateMatrix(),this.matrixWorldAutoUpdate===!0&&(this.parent===null?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix)),r===!0){const i=this.children;for(let a=0,o=i.length;a<o;a++)i[a].updateWorldMatrix(!1,!0)}}toJSON(t){const r=t===void 0||typeof t=="string",n={};r&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{},skeletons:{},animations:{},nodes:{}},n.metadata={version:4.6,type:"Object",generator:"Object3D.toJSON"});const i={};i.uuid=this.uuid,i.type=this.type,this.name!==""&&(i.name=this.name),this.castShadow===!0&&(i.castShadow=!0),this.receiveShadow===!0&&(i.receiveShadow=!0),this.visible===!1&&(i.visible=!1),this.frustumCulled===!1&&(i.frustumCulled=!1),this.renderOrder!==0&&(i.renderOrder=this.renderOrder),Object.keys(this.userData).length>0&&(i.userData=this.userData),i.layers=this.layers.mask,i.matrix=this.matrix.toArray(),i.up=this.up.toArray(),this.matrixAutoUpdate===!1&&(i.matrixAutoUpdate=!1),this.isInstancedMesh&&(i.type="InstancedMesh",i.count=this.count,i.instanceMatrix=this.instanceMatrix.toJSON(),this.instanceColor!==null&&(i.instanceColor=this.instanceColor.toJSON())),this.isBatchedMesh&&(i.type="BatchedMesh",i.perObjectFrustumCulled=this.perObjectFrustumCulled,i.sortObjects=this.sortObjects,i.drawRanges=this._drawRanges,i.reservedRanges=this._reservedRanges,i.visibility=this._visibility,i.active=this._active,i.bounds=this._bounds.map(s=>({boxInitialized:s.boxInitialized,boxMin:s.box.min.toArray(),boxMax:s.box.max.toArray(),sphereInitialized:s.sphereInitialized,sphereRadius:s.sphere.radius,sphereCenter:s.sphere.center.toArray()})),i.maxInstanceCount=this._maxInstanceCount,i.maxVertexCount=this._maxVertexCount,i.maxIndexCount=this._maxIndexCount,i.geometryInitialized=this._geometryInitialized,i.geometryCount=this._geometryCount,i.matricesTexture=this._matricesTexture.toJSON(t),this._colorsTexture!==null&&(i.colorsTexture=this._colorsTexture.toJSON(t)),this.boundingSphere!==null&&(i.boundingSphere={center:i.boundingSphere.center.toArray(),radius:i.boundingSphere.radius}),this.boundingBox!==null&&(i.boundingBox={min:i.boundingBox.min.toArray(),max:i.boundingBox.max.toArray()}));function a(s,l){return s[l.uuid]===void 0&&(s[l.uuid]=l.toJSON(t)),l.uuid}if(this.isScene)this.background&&(this.background.isColor?i.background=this.background.toJSON():this.background.isTexture&&(i.background=this.background.toJSON(t).uuid)),this.environment&&this.environment.isTexture&&this.environment.isRenderTargetTexture!==!0&&(i.environment=this.environment.toJSON(t).uuid);else if(this.isMesh||this.isLine||this.isPoints){i.geometry=a(t.geometries,this.geometry);const s=this.geometry.parameters;if(s!==void 0&&s.shapes!==void 0){const l=s.shapes;if(Array.isArray(l))for(let u=0,h=l.length;u<h;u++){const f=l[u];a(t.shapes,f)}else a(t.shapes,l)}}if(this.isSkinnedMesh&&(i.bindMode=this.bindMode,i.bindMatrix=this.bindMatrix.toArray(),this.skeleton!==void 0&&(a(t.skeletons,this.skeleton),i.skeleton=this.skeleton.uuid)),this.material!==void 0)if(Array.isArray(this.material)){const s=[];for(let l=0,u=this.material.length;l<u;l++)s.push(a(t.materials,this.material[l]));i.material=s}else i.material=a(t.materials,this.material);if(this.children.length>0){i.children=[];for(let s=0;s<this.children.length;s++)i.children.push(this.children[s].toJSON(t).object)}if(this.animations.length>0){i.animations=[];for(let s=0;s<this.animations.length;s++){const l=this.animations[s];i.animations.push(a(t.animations,l))}}if(r){const s=o(t.geometries),l=o(t.materials),u=o(t.textures),h=o(t.images),f=o(t.shapes),c=o(t.skeletons),d=o(t.animations),v=o(t.nodes);s.length>0&&(n.geometries=s),l.length>0&&(n.materials=l),u.length>0&&(n.textures=u),h.length>0&&(n.images=h),f.length>0&&(n.shapes=f),c.length>0&&(n.skeletons=c),d.length>0&&(n.animations=d),v.length>0&&(n.nodes=v)}return n.object=i,n;function o(s){const l=[];for(const u in s){const h=s[u];delete h.metadata,l.push(h)}return l}}clone(t){return new this.constructor().copy(this,t)}copy(t,r=!0){if(this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.rotation.order=t.rotation.order,this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldAutoUpdate=t.matrixWorldAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.animations=t.animations.slice(),this.userData=JSON.parse(JSON.stringify(t.userData)),r===!0)for(let n=0;n<t.children.length;n++){const i=t.children[n];this.add(i.clone())}return this}}hi.DEFAULT_UP=new lt(0,1,0);hi.DEFAULT_MATRIX_AUTO_UPDATE=!0;hi.DEFAULT_MATRIX_WORLD_AUTO_UPDATE=!0;const na=new lt,ho=new lt,R1=new lt,fo=new lt,Ih=new lt,Nh=new lt,hN=new lt,P1=new lt,I1=new lt,N1=new lt,O1=new Ur,F1=new Ur,B1=new Ur;class ua{constructor(t=new lt,r=new lt,n=new lt){this.a=t,this.b=r,this.c=n}static getNormal(t,r,n,i){i.subVectors(n,r),na.subVectors(t,r),i.cross(na);const a=i.lengthSq();return a>0?i.multiplyScalar(1/Math.sqrt(a)):i.set(0,0,0)}static getBarycoord(t,r,n,i,a){na.subVectors(i,r),ho.subVectors(n,r),R1.subVectors(t,r);const o=na.dot(na),s=na.dot(ho),l=na.dot(R1),u=ho.dot(ho),h=ho.dot(R1),f=o*u-s*s;if(f===0)return a.set(0,0,0),null;const c=1/f,d=(u*l-s*h)*c,v=(o*h-s*l)*c;return a.set(1-d-v,v,d)}static containsPoint(t,r,n,i){return this.getBarycoord(t,r,n,i,fo)===null?!1:fo.x>=0&&fo.y>=0&&fo.x+fo.y<=1}static getInterpolation(t,r,n,i,a,o,s,l){return this.getBarycoord(t,r,n,i,fo)===null?(l.x=0,l.y=0,"z"in l&&(l.z=0),"w"in l&&(l.w=0),null):(l.setScalar(0),l.addScaledVector(a,fo.x),l.addScaledVector(o,fo.y),l.addScaledVector(s,fo.z),l)}static getInterpolatedAttribute(t,r,n,i,a,o){return O1.setScalar(0),F1.setScalar(0),B1.setScalar(0),O1.fromBufferAttribute(t,r),F1.fromBufferAttribute(t,n),B1.fromBufferAttribute(t,i),o.setScalar(0),o.addScaledVector(O1,a.x),o.addScaledVector(F1,a.y),o.addScaledVector(B1,a.z),o}static isFrontFacing(t,r,n,i){return na.subVectors(n,r),ho.subVectors(t,r),na.cross(ho).dot(i)<0}set(t,r,n){return this.a.copy(t),this.b.copy(r),this.c.copy(n),this}setFromPointsAndIndices(t,r,n,i){return this.a.copy(t[r]),this.b.copy(t[n]),this.c.copy(t[i]),this}setFromAttributeAndIndices(t,r,n,i){return this.a.fromBufferAttribute(t,r),this.b.fromBufferAttribute(t,n),this.c.fromBufferAttribute(t,i),this}clone(){return new this.constructor().copy(this)}copy(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this}getArea(){return na.subVectors(this.c,this.b),ho.subVectors(this.a,this.b),na.cross(ho).length()*.5}getMidpoint(t){return t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)}getNormal(t){return ua.getNormal(this.a,this.b,this.c,t)}getPlane(t){return t.setFromCoplanarPoints(this.a,this.b,this.c)}getBarycoord(t,r){return ua.getBarycoord(t,this.a,this.b,this.c,r)}getInterpolation(t,r,n,i,a){return ua.getInterpolation(t,this.a,this.b,this.c,r,n,i,a)}containsPoint(t){return ua.containsPoint(t,this.a,this.b,this.c)}isFrontFacing(t){return ua.isFrontFacing(this.a,this.b,this.c,t)}intersectsBox(t){return t.intersectsTriangle(this)}closestPointToPoint(t,r){const n=this.a,i=this.b,a=this.c;let o,s;Ih.subVectors(i,n),Nh.subVectors(a,n),P1.subVectors(t,n);const l=Ih.dot(P1),u=Nh.dot(P1);if(l<=0&&u<=0)return r.copy(n);I1.subVectors(t,i);const h=Ih.dot(I1),f=Nh.dot(I1);if(h>=0&&f<=h)return r.copy(i);const c=l*f-h*u;if(c<=0&&l>=0&&h<=0)return o=l/(l-h),r.copy(n).addScaledVector(Ih,o);N1.subVectors(t,a);const d=Ih.dot(N1),v=Nh.dot(N1);if(v>=0&&d<=v)return r.copy(a);const p=d*u-l*v;if(p<=0&&u>=0&&v<=0)return s=u/(u-v),r.copy(n).addScaledVector(Nh,s);const g=h*v-d*f;if(g<=0&&f-h>=0&&d-v>=0)return hN.subVectors(a,i),s=(f-h)/(f-h+(d-v)),r.copy(i).addScaledVector(hN,s);const m=1/(g+p+c);return o=p*m,s=c*m,r.copy(n).addScaledVector(Ih,o).addScaledVector(Nh,s)}equals(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}const KG={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074},hs={h:0,s:0,l:0},yg={h:0,s:0,l:0};function U1(e,t,r){return r<0&&(r+=1),r>1&&(r-=1),r<1/6?e+(t-e)*6*r:r<1/2?t:r<2/3?e+(t-e)*6*(2/3-r):e}class fr{constructor(t,r,n){return this.isColor=!0,this.r=1,this.g=1,this.b=1,this.set(t,r,n)}set(t,r,n){if(r===void 0&&n===void 0){const i=t;i&&i.isColor?this.copy(i):typeof i=="number"?this.setHex(i):typeof i=="string"&&this.setStyle(i)}else this.setRGB(t,r,n);return this}setScalar(t){return this.r=t,this.g=t,this.b=t,this}setHex(t,r=Pi){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(t&255)/255,tr.toWorkingColorSpace(this,r),this}setRGB(t,r,n,i=tr.workingColorSpace){return this.r=t,this.g=r,this.b=n,tr.toWorkingColorSpace(this,i),this}setHSL(t,r,n,i=tr.workingColorSpace){if(t=Out(t,1),r=Ye(r,0,1),n=Ye(n,0,1),r===0)this.r=this.g=this.b=n;else{const a=n<=.5?n*(1+r):n+r-n*r,o=2*n-a;this.r=U1(o,a,t+1/3),this.g=U1(o,a,t),this.b=U1(o,a,t-1/3)}return tr.toWorkingColorSpace(this,i),this}setStyle(t,r=Pi){function n(a){a!==void 0&&parseFloat(a)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}let i;if(i=/^(\w+)\(([^\)]*)\)/.exec(t)){let a;const o=i[1],s=i[2];switch(o){case"rgb":case"rgba":if(a=/^\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setRGB(Math.min(255,parseInt(a[1],10))/255,Math.min(255,parseInt(a[2],10))/255,Math.min(255,parseInt(a[3],10))/255,r);if(a=/^\s*(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setRGB(Math.min(100,parseInt(a[1],10))/100,Math.min(100,parseInt(a[2],10))/100,Math.min(100,parseInt(a[3],10))/100,r);break;case"hsl":case"hsla":if(a=/^\s*(\d*\.?\d+)\s*,\s*(\d*\.?\d+)\%\s*,\s*(\d*\.?\d+)\%\s*(?:,\s*(\d*\.?\d+)\s*)?$/.exec(s))return n(a[4]),this.setHSL(parseFloat(a[1])/360,parseFloat(a[2])/100,parseFloat(a[3])/100,r);break;default:console.warn("THREE.Color: Unknown color model "+t)}}else if(i=/^\#([A-Fa-f\d]+)$/.exec(t)){const a=i[1],o=a.length;if(o===3)return this.setRGB(parseInt(a.charAt(0),16)/15,parseInt(a.charAt(1),16)/15,parseInt(a.charAt(2),16)/15,r);if(o===6)return this.setHex(parseInt(a,16),r);console.warn("THREE.Color: Invalid hex color "+t)}else if(t&&t.length>0)return this.setColorName(t,r);return this}setColorName(t,r=Pi){const n=KG[t.toLowerCase()];return n!==void 0?this.setHex(n,r):console.warn("THREE.Color: Unknown color "+t),this}clone(){return new this.constructor(this.r,this.g,this.b)}copy(t){return this.r=t.r,this.g=t.g,this.b=t.b,this}copySRGBToLinear(t){return this.r=Do(t.r),this.g=Do(t.g),this.b=Do(t.b),this}copyLinearToSRGB(t){return this.r=sf(t.r),this.g=sf(t.g),this.b=sf(t.b),this}convertSRGBToLinear(){return this.copySRGBToLinear(this),this}convertLinearToSRGB(){return this.copyLinearToSRGB(this),this}getHex(t=Pi){return tr.fromWorkingColorSpace(An.copy(this),t),Math.round(Ye(An.r*255,0,255))*65536+Math.round(Ye(An.g*255,0,255))*256+Math.round(Ye(An.b*255,0,255))}getHexString(t=Pi){return("000000"+this.getHex(t).toString(16)).slice(-6)}getHSL(t,r=tr.workingColorSpace){tr.fromWorkingColorSpace(An.copy(this),r);const n=An.r,i=An.g,a=An.b,o=Math.max(n,i,a),s=Math.min(n,i,a);let l,u;const h=(s+o)/2;if(s===o)l=0,u=0;else{const f=o-s;switch(u=h<=.5?f/(o+s):f/(2-o-s),o){case n:l=(i-a)/f+(i<a?6:0);break;case i:l=(a-n)/f+2;break;case a:l=(n-i)/f+4;break}l/=6}return t.h=l,t.s=u,t.l=h,t}getRGB(t,r=tr.workingColorSpace){return tr.fromWorkingColorSpace(An.copy(this),r),t.r=An.r,t.g=An.g,t.b=An.b,t}getStyle(t=Pi){tr.fromWorkingColorSpace(An.copy(this),t);const r=An.r,n=An.g,i=An.b;return t!==Pi?`color(${t} ${r.toFixed(3)} ${n.toFixed(3)} ${i.toFixed(3)})`:`rgb(${Math.round(r*255)},${Math.round(n*255)},${Math.round(i*255)})`}offsetHSL(t,r,n){return this.getHSL(hs),this.setHSL(hs.h+t,hs.s+r,hs.l+n)}add(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this}addColors(t,r){return this.r=t.r+r.r,this.g=t.g+r.g,this.b=t.b+r.b,this}addScalar(t){return this.r+=t,this.g+=t,this.b+=t,this}sub(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this}multiply(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this}multiplyScalar(t){return this.r*=t,this.g*=t,this.b*=t,this}lerp(t,r){return this.r+=(t.r-this.r)*r,this.g+=(t.g-this.g)*r,this.b+=(t.b-this.b)*r,this}lerpColors(t,r,n){return this.r=t.r+(r.r-t.r)*n,this.g=t.g+(r.g-t.g)*n,this.b=t.b+(r.b-t.b)*n,this}lerpHSL(t,r){this.getHSL(hs),t.getHSL(yg);const n=S1(hs.h,yg.h,r),i=S1(hs.s,yg.s,r),a=S1(hs.l,yg.l,r);return this.setHSL(n,i,a),this}setFromVector3(t){return this.r=t.x,this.g=t.y,this.b=t.z,this}applyMatrix3(t){const r=this.r,n=this.g,i=this.b,a=t.elements;return this.r=a[0]*r+a[3]*n+a[6]*i,this.g=a[1]*r+a[4]*n+a[7]*i,this.b=a[2]*r+a[5]*n+a[8]*i,this}equals(t){return t.r===this.r&&t.g===this.g&&t.b===this.b}fromArray(t,r=0){return this.r=t[r],this.g=t[r+1],this.b=t[r+2],this}toArray(t=[],r=0){return t[r]=this.r,t[r+1]=this.g,t[r+2]=this.b,t}fromBufferAttribute(t,r){return this.r=t.getX(r),this.g=t.getY(r),this.b=t.getZ(r),this}toJSON(){return this.getHex()}*[Symbol.iterator](){yield this.r,yield this.g,yield this.b}}const An=new fr;fr.NAMES=KG;let tht=0;class m0 extends oc{constructor(){super(),this.isMaterial=!0,Object.defineProperty(this,"id",{value:tht++}),this.uuid=Wv(),this.name="",this.type="Material",this.blending=af,this.side=Gs,this.vertexColors=!1,this.opacity=1,this.transparent=!1,this.alphaHash=!1,this.blendSrc=JT,this.blendDst=QT,this.blendEquation=Zl,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.blendColor=new fr(0,0,0),this.blendAlpha=0,this.depthFunc=Cf,this.depthTest=!0,this.depthWrite=!0,this.stencilWriteMask=255,this.stencilFunc=KI,this.stencilRef=0,this.stencilFuncMask=255,this.stencilFail=Mh,this.stencilZFail=Mh,this.stencilZPass=Mh,this.stencilWrite=!1,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaToCoverage=!1,this.premultipliedAlpha=!1,this.forceSinglePass=!1,this.visible=!0,this.toneMapped=!0,this.userData={},this.version=0,this._alphaTest=0}get alphaTest(){return this._alphaTest}set alphaTest(t){this._alphaTest>0!=t>0&&this.version++,this._alphaTest=t}onBeforeRender(){}onBeforeCompile(){}customProgramCacheKey(){return this.onBeforeCompile.toString()}setValues(t){if(t!==void 0)for(const r in t){const n=t[r];if(n===void 0){console.warn(`THREE.Material: parameter '${r}' has value of undefined.`);continue}const i=this[r];if(i===void 0){console.warn(`THREE.Material: '${r}' is not a property of THREE.${this.type}.`);continue}i&&i.isColor?i.set(n):i&&i.isVector3&&n&&n.isVector3?i.copy(n):this[r]=n}}toJSON(t){const r=t===void 0||typeof t=="string";r&&(t={textures:{},images:{}});const n={metadata:{version:4.6,type:"Material",generator:"Material.toJSON"}};n.uuid=this.uuid,n.type=this.type,this.name!==""&&(n.name=this.name),this.color&&this.color.isColor&&(n.color=this.color.getHex()),this.roughness!==void 0&&(n.roughness=this.roughness),this.metalness!==void 0&&(n.metalness=this.metalness),this.sheen!==void 0&&(n.sheen=this.sheen),this.sheenColor&&this.sheenColor.isColor&&(n.sheenColor=this.sheenColor.getHex()),this.sheenRoughness!==void 0&&(n.sheenRoughness=this.sheenRoughness),this.emissive&&this.emissive.isColor&&(n.emissive=this.emissive.getHex()),this.emissiveIntensity!==void 0&&this.emissiveIntensity!==1&&(n.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(n.specular=this.specular.getHex()),this.specularIntensity!==void 0&&(n.specularIntensity=this.specularIntensity),this.specularColor&&this.specularColor.isColor&&(n.specularColor=this.specularColor.getHex()),this.shininess!==void 0&&(n.shininess=this.shininess),this.clearcoat!==void 0&&(n.clearcoat=this.clearcoat),this.clearcoatRoughness!==void 0&&(n.clearcoatRoughness=this.clearcoatRoughness),this.clearcoatMap&&this.clearcoatMap.isTexture&&(n.clearcoatMap=this.clearcoatMap.toJSON(t).uuid),this.clearcoatRoughnessMap&&this.clearcoatRoughnessMap.isTexture&&(n.clearcoatRoughnessMap=this.clearcoatRoughnessMap.toJSON(t).uuid),this.clearcoatNormalMap&&this.clearcoatNormalMap.isTexture&&(n.clearcoatNormalMap=this.clearcoatNormalMap.toJSON(t).uuid,n.clearcoatNormalScale=this.clearcoatNormalScale.toArray()),this.dispersion!==void 0&&(n.dispersion=this.dispersion),this.iridescence!==void 0&&(n.iridescence=this.iridescence),this.iridescenceIOR!==void 0&&(n.iridescenceIOR=this.iridescenceIOR),this.iridescenceThicknessRange!==void 0&&(n.iridescenceThicknessRange=this.iridescenceThicknessRange),this.iridescenceMap&&this.iridescenceMap.isTexture&&(n.iridescenceMap=this.iridescenceMap.toJSON(t).uuid),this.iridescenceThicknessMap&&this.iridescenceThicknessMap.isTexture&&(n.iridescenceThicknessMap=this.iridescenceThicknessMap.toJSON(t).uuid),this.anisotropy!==void 0&&(n.anisotropy=this.anisotropy),this.anisotropyRotation!==void 0&&(n.anisotropyRotation=this.anisotropyRotation),this.anisotropyMap&&this.anisotropyMap.isTexture&&(n.anisotropyMap=this.anisotropyMap.toJSON(t).uuid),this.map&&this.map.isTexture&&(n.map=this.map.toJSON(t).uuid),this.matcap&&this.matcap.isTexture&&(n.matcap=this.matcap.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(n.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(n.lightMap=this.lightMap.toJSON(t).uuid,n.lightMapIntensity=this.lightMapIntensity),this.aoMap&&this.aoMap.isTexture&&(n.aoMap=this.aoMap.toJSON(t).uuid,n.aoMapIntensity=this.aoMapIntensity),this.bumpMap&&this.bumpMap.isTexture&&(n.bumpMap=this.bumpMap.toJSON(t).uuid,n.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(n.normalMap=this.normalMap.toJSON(t).uuid,n.normalMapType=this.normalMapType,n.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(n.displacementMap=this.displacementMap.toJSON(t).uuid,n.displacementScale=this.displacementScale,n.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(n.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(n.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(n.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(n.specularMap=this.specularMap.toJSON(t).uuid),this.specularIntensityMap&&this.specularIntensityMap.isTexture&&(n.specularIntensityMap=this.specularIntensityMap.toJSON(t).uuid),this.specularColorMap&&this.specularColorMap.isTexture&&(n.specularColorMap=this.specularColorMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(n.envMap=this.envMap.toJSON(t).uuid,this.combine!==void 0&&(n.combine=this.combine)),this.envMapRotation!==void 0&&(n.envMapRotation=this.envMapRotation.toArray()),this.envMapIntensity!==void 0&&(n.envMapIntensity=this.envMapIntensity),this.reflectivity!==void 0&&(n.reflectivity=this.reflectivity),this.refractionRatio!==void 0&&(n.refractionRatio=this.refractionRatio),this.gradientMap&&this.gradientMap.isTexture&&(n.gradientMap=this.gradientMap.toJSON(t).uuid),this.transmission!==void 0&&(n.transmission=this.transmission),this.transmissionMap&&this.transmissionMap.isTexture&&(n.transmissionMap=this.transmissionMap.toJSON(t).uuid),this.thickness!==void 0&&(n.thickness=this.thickness),this.thicknessMap&&this.thicknessMap.isTexture&&(n.thicknessMap=this.thicknessMap.toJSON(t).uuid),this.attenuationDistance!==void 0&&this.attenuationDistance!==1/0&&(n.attenuationDistance=this.attenuationDistance),this.attenuationColor!==void 0&&(n.attenuationColor=this.attenuationColor.getHex()),this.size!==void 0&&(n.size=this.size),this.shadowSide!==null&&(n.shadowSide=this.shadowSide),this.sizeAttenuation!==void 0&&(n.sizeAttenuation=this.sizeAttenuation),this.blending!==af&&(n.blending=this.blending),this.side!==Gs&&(n.side=this.side),this.vertexColors===!0&&(n.vertexColors=!0),this.opacity<1&&(n.opacity=this.opacity),this.transparent===!0&&(n.transparent=!0),this.blendSrc!==JT&&(n.blendSrc=this.blendSrc),this.blendDst!==QT&&(n.blendDst=this.blendDst),this.blendEquation!==Zl&&(n.blendEquation=this.blendEquation),this.blendSrcAlpha!==null&&(n.blendSrcAlpha=this.blendSrcAlpha),this.blendDstAlpha!==null&&(n.blendDstAlpha=this.blendDstAlpha),this.blendEquationAlpha!==null&&(n.blendEquationAlpha=this.blendEquationAlpha),this.blendColor&&this.blendColor.isColor&&(n.blendColor=this.blendColor.getHex()),this.blendAlpha!==0&&(n.blendAlpha=this.blendAlpha),this.depthFunc!==Cf&&(n.depthFunc=this.depthFunc),this.depthTest===!1&&(n.depthTest=this.depthTest),this.depthWrite===!1&&(n.depthWrite=this.depthWrite),this.colorWrite===!1&&(n.colorWrite=this.colorWrite),this.stencilWriteMask!==255&&(n.stencilWriteMask=this.stencilWriteMask),this.stencilFunc!==KI&&(n.stencilFunc=this.stencilFunc),this.stencilRef!==0&&(n.stencilRef=this.stencilRef),this.stencilFuncMask!==255&&(n.stencilFuncMask=this.stencilFuncMask),this.stencilFail!==Mh&&(n.stencilFail=this.stencilFail),this.stencilZFail!==Mh&&(n.stencilZFail=this.stencilZFail),this.stencilZPass!==Mh&&(n.stencilZPass=this.stencilZPass),this.stencilWrite===!0&&(n.stencilWrite=this.stencilWrite),this.rotation!==void 0&&this.rotation!==0&&(n.rotation=this.rotation),this.polygonOffset===!0&&(n.polygonOffset=!0),this.polygonOffsetFactor!==0&&(n.polygonOffsetFactor=this.polygonOffsetFactor),this.polygonOffsetUnits!==0&&(n.polygonOffsetUnits=this.polygonOffsetUnits),this.linewidth!==void 0&&this.linewidth!==1&&(n.linewidth=this.linewidth),this.dashSize!==void 0&&(n.dashSize=this.dashSize),this.gapSize!==void 0&&(n.gapSize=this.gapSize),this.scale!==void 0&&(n.scale=this.scale),this.dithering===!0&&(n.dithering=!0),this.alphaTest>0&&(n.alphaTest=this.alphaTest),this.alphaHash===!0&&(n.alphaHash=!0),this.alphaToCoverage===!0&&(n.alphaToCoverage=!0),this.premultipliedAlpha===!0&&(n.premultipliedAlpha=!0),this.forceSinglePass===!0&&(n.forceSinglePass=!0),this.wireframe===!0&&(n.wireframe=!0),this.wireframeLinewidth>1&&(n.wireframeLinewidth=this.wireframeLinewidth),this.wireframeLinecap!=="round"&&(n.wireframeLinecap=this.wireframeLinecap),this.wireframeLinejoin!=="round"&&(n.wireframeLinejoin=this.wireframeLinejoin),this.flatShading===!0&&(n.flatShading=!0),this.visible===!1&&(n.visible=!1),this.toneMapped===!1&&(n.toneMapped=!1),this.fog===!1&&(n.fog=!1),Object.keys(this.userData).length>0&&(n.userData=this.userData);function i(a){const o=[];for(const s in a){const l=a[s];delete l.metadata,o.push(l)}return o}if(r){const a=i(t.textures),o=i(t.images);a.length>0&&(n.textures=a),o.length>0&&(n.images=o)}return n}clone(){return new this.constructor().copy(this)}copy(t){this.name=t.name,this.blending=t.blending,this.side=t.side,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.blendColor.copy(t.blendColor),this.blendAlpha=t.blendAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.stencilWriteMask=t.stencilWriteMask,this.stencilFunc=t.stencilFunc,this.stencilRef=t.stencilRef,this.stencilFuncMask=t.stencilFuncMask,this.stencilFail=t.stencilFail,this.stencilZFail=t.stencilZFail,this.stencilZPass=t.stencilZPass,this.stencilWrite=t.stencilWrite;const r=t.clippingPlanes;let n=null;if(r!==null){const i=r.length;n=new Array(i);for(let a=0;a!==i;++a)n[a]=r[a].clone()}return this.clippingPlanes=n,this.clipIntersection=t.clipIntersection,this.clipShadows=t.clipShadows,this.shadowSide=t.shadowSide,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.alphaHash=t.alphaHash,this.alphaToCoverage=t.alphaToCoverage,this.premultipliedAlpha=t.premultipliedAlpha,this.forceSinglePass=t.forceSinglePass,this.visible=t.visible,this.toneMapped=t.toneMapped,this.userData=JSON.parse(JSON.stringify(t.userData)),this}dispose(){this.dispatchEvent({type:"dispose"})}set needsUpdate(t){t===!0&&this.version++}onBuild(){console.warn("Material: onBuild() has been removed.")}}class AA extends m0{constructor(t){super(),this.isMeshBasicMaterial=!0,this.type="MeshBasicMaterial",this.color=new fr(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.envMapRotation=new ko,this.combine=IG,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.fog=!0,this.setValues(t)}copy(t){return super.copy(t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapRotation.copy(t.envMapRotation),this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.fog=t.fog,this}}const Hr=new lt,xg=new pr;class Za{constructor(t,r,n=!1){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.isBufferAttribute=!0,this.name="",this.array=t,this.itemSize=r,this.count=t!==void 0?t.length/r:0,this.normalized=n,this.usage=jI,this.updateRanges=[],this.gpuType=So,this.version=0}onUploadCallback(){}set needsUpdate(t){t===!0&&this.version++}setUsage(t){return this.usage=t,this}addUpdateRange(t,r){this.updateRanges.push({start:t,count:r})}clearUpdateRanges(){this.updateRanges.length=0}copy(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.usage=t.usage,this.gpuType=t.gpuType,this}copyAt(t,r,n){t*=this.itemSize,n*=r.itemSize;for(let i=0,a=this.itemSize;i<a;i++)this.array[t+i]=r.array[n+i];return this}copyArray(t){return this.array.set(t),this}applyMatrix3(t){if(this.itemSize===2)for(let r=0,n=this.count;r<n;r++)xg.fromBufferAttribute(this,r),xg.applyMatrix3(t),this.setXY(r,xg.x,xg.y);else if(this.itemSize===3)for(let r=0,n=this.count;r<n;r++)Hr.fromBufferAttribute(this,r),Hr.applyMatrix3(t),this.setXYZ(r,Hr.x,Hr.y,Hr.z);return this}applyMatrix4(t){for(let r=0,n=this.count;r<n;r++)Hr.fromBufferAttribute(this,r),Hr.applyMatrix4(t),this.setXYZ(r,Hr.x,Hr.y,Hr.z);return this}applyNormalMatrix(t){for(let r=0,n=this.count;r<n;r++)Hr.fromBufferAttribute(this,r),Hr.applyNormalMatrix(t),this.setXYZ(r,Hr.x,Hr.y,Hr.z);return this}transformDirection(t){for(let r=0,n=this.count;r<n;r++)Hr.fromBufferAttribute(this,r),Hr.transformDirection(t),this.setXYZ(r,Hr.x,Hr.y,Hr.z);return this}set(t,r=0){return this.array.set(t,r),this}getComponent(t,r){let n=this.array[t*this.itemSize+r];return this.normalized&&(n=Zc(n,this.array)),n}setComponent(t,r,n){return this.normalized&&(n=ri(n,this.array)),this.array[t*this.itemSize+r]=n,this}getX(t){let r=this.array[t*this.itemSize];return this.normalized&&(r=Zc(r,this.array)),r}setX(t,r){return this.normalized&&(r=ri(r,this.array)),this.array[t*this.itemSize]=r,this}getY(t){let r=this.array[t*this.itemSize+1];return this.normalized&&(r=Zc(r,this.array)),r}setY(t,r){return this.normalized&&(r=ri(r,this.array)),this.array[t*this.itemSize+1]=r,this}getZ(t){let r=this.array[t*this.itemSize+2];return this.normalized&&(r=Zc(r,this.array)),r}setZ(t,r){return this.normalized&&(r=ri(r,this.array)),this.array[t*this.itemSize+2]=r,this}getW(t){let r=this.array[t*this.itemSize+3];return this.normalized&&(r=Zc(r,this.array)),r}setW(t,r){return this.normalized&&(r=ri(r,this.array)),this.array[t*this.itemSize+3]=r,this}setXY(t,r,n){return t*=this.itemSize,this.normalized&&(r=ri(r,this.array),n=ri(n,this.array)),this.array[t+0]=r,this.array[t+1]=n,this}setXYZ(t,r,n,i){return t*=this.itemSize,this.normalized&&(r=ri(r,this.array),n=ri(n,this.array),i=ri(i,this.array)),this.array[t+0]=r,this.array[t+1]=n,this.array[t+2]=i,this}setXYZW(t,r,n,i,a){return t*=this.itemSize,this.normalized&&(r=ri(r,this.array),n=ri(n,this.array),i=ri(i,this.array),a=ri(a,this.array)),this.array[t+0]=r,this.array[t+1]=n,this.array[t+2]=i,this.array[t+3]=a,this}onUpload(t){return this.onUploadCallback=t,this}clone(){return new this.constructor(this.array,this.itemSize).copy(this)}toJSON(){const t={itemSize:this.itemSize,type:this.array.constructor.name,array:Array.from(this.array),normalized:this.normalized};return this.name!==""&&(t.name=this.name),this.usage!==jI&&(t.usage=this.usage),t}}class jG extends Za{constructor(t,r,n){super(new Uint16Array(t),r,n)}}class JG extends Za{constructor(t,r,n){super(new Uint32Array(t),r,n)}}class _u extends Za{constructor(t,r,n){super(new Float32Array(t),r,n)}}let eht=0;const Ai=new qr,z1=new hi,Oh=new lt,gi=new Yv,jc=new Yv,cn=new lt;class Yu extends oc{constructor(){super(),this.isBufferGeometry=!0,Object.defineProperty(this,"id",{value:eht++}),this.uuid=Wv(),this.name="",this.type="BufferGeometry",this.index=null,this.indirect=null,this.attributes={},this.morphAttributes={},this.morphTargetsRelative=!1,this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0},this.userData={}}getIndex(){return this.index}setIndex(t){return Array.isArray(t)?this.index=new(YG(t)?JG:jG)(t,1):this.index=t,this}setIndirect(t){return this.indirect=t,this}getIndirect(){return this.indirect}getAttribute(t){return this.attributes[t]}setAttribute(t,r){return this.attributes[t]=r,this}deleteAttribute(t){return delete this.attributes[t],this}hasAttribute(t){return this.attributes[t]!==void 0}addGroup(t,r,n=0){this.groups.push({start:t,count:r,materialIndex:n})}clearGroups(){this.groups=[]}setDrawRange(t,r){this.drawRange.start=t,this.drawRange.count=r}applyMatrix4(t){const r=this.attributes.position;r!==void 0&&(r.applyMatrix4(t),r.needsUpdate=!0);const n=this.attributes.normal;if(n!==void 0){const a=new Pe().getNormalMatrix(t);n.applyNormalMatrix(a),n.needsUpdate=!0}const i=this.attributes.tangent;return i!==void 0&&(i.transformDirection(t),i.needsUpdate=!0),this.boundingBox!==null&&this.computeBoundingBox(),this.boundingSphere!==null&&this.computeBoundingSphere(),this}applyQuaternion(t){return Ai.makeRotationFromQuaternion(t),this.applyMatrix4(Ai),this}rotateX(t){return Ai.makeRotationX(t),this.applyMatrix4(Ai),this}rotateY(t){return Ai.makeRotationY(t),this.applyMatrix4(Ai),this}rotateZ(t){return Ai.makeRotationZ(t),this.applyMatrix4(Ai),this}translate(t,r,n){return Ai.makeTranslation(t,r,n),this.applyMatrix4(Ai),this}scale(t,r,n){return Ai.makeScale(t,r,n),this.applyMatrix4(Ai),this}lookAt(t){return z1.lookAt(t),z1.updateMatrix(),this.applyMatrix4(z1.matrix),this}center(){return this.computeBoundingBox(),this.boundingBox.getCenter(Oh).negate(),this.translate(Oh.x,Oh.y,Oh.z),this}setFromPoints(t){const r=this.getAttribute("position");if(r===void 0){const n=[];for(let i=0,a=t.length;i<a;i++){const o=t[i];n.push(o.x,o.y,o.z||0)}this.setAttribute("position",new _u(n,3))}else{const n=Math.min(t.length,r.count);for(let i=0;i<n;i++){const a=t[i];r.setXYZ(i,a.x,a.y,a.z||0)}t.length>r.count&&console.warn("THREE.BufferGeometry: Buffer size too small for points data. Use .dispose() and create a new geometry."),r.needsUpdate=!0}return this}computeBoundingBox(){this.boundingBox===null&&(this.boundingBox=new Yv);const t=this.attributes.position,r=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingBox(): GLBufferAttribute requires a manual bounding box.",this),this.boundingBox.set(new lt(-1/0,-1/0,-1/0),new lt(1/0,1/0,1/0));return}if(t!==void 0){if(this.boundingBox.setFromBufferAttribute(t),r)for(let n=0,i=r.length;n<i;n++){const a=r[n];gi.setFromBufferAttribute(a),this.morphTargetsRelative?(cn.addVectors(this.boundingBox.min,gi.min),this.boundingBox.expandByPoint(cn),cn.addVectors(this.boundingBox.max,gi.max),this.boundingBox.expandByPoint(cn)):(this.boundingBox.expandByPoint(gi.min),this.boundingBox.expandByPoint(gi.max))}}else this.boundingBox.makeEmpty();(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox(): Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)}computeBoundingSphere(){this.boundingSphere===null&&(this.boundingSphere=new MA);const t=this.attributes.position,r=this.morphAttributes.position;if(t&&t.isGLBufferAttribute){console.error("THREE.BufferGeometry.computeBoundingSphere(): GLBufferAttribute requires a manual bounding sphere.",this),this.boundingSphere.set(new lt,1/0);return}if(t){const n=this.boundingSphere.center;if(gi.setFromBufferAttribute(t),r)for(let a=0,o=r.length;a<o;a++){const s=r[a];jc.setFromBufferAttribute(s),this.morphTargetsRelative?(cn.addVectors(gi.min,jc.min),gi.expandByPoint(cn),cn.addVectors(gi.max,jc.max),gi.expandByPoint(cn)):(gi.expandByPoint(jc.min),gi.expandByPoint(jc.max))}gi.getCenter(n);let i=0;for(let a=0,o=t.count;a<o;a++)cn.fromBufferAttribute(t,a),i=Math.max(i,n.distanceToSquared(cn));if(r)for(let a=0,o=r.length;a<o;a++){const s=r[a],l=this.morphTargetsRelative;for(let u=0,h=s.count;u<h;u++)cn.fromBufferAttribute(s,u),l&&(Oh.fromBufferAttribute(t,u),cn.add(Oh)),i=Math.max(i,n.distanceToSquared(cn))}this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}computeTangents(){const t=this.index,r=this.attributes;if(t===null||r.position===void 0||r.normal===void 0||r.uv===void 0){console.error("THREE.BufferGeometry: .computeTangents() failed. Missing required attributes (index, position, normal or uv)");return}const n=r.position,i=r.normal,a=r.uv;this.hasAttribute("tangent")===!1&&this.setAttribute("tangent",new Za(new Float32Array(4*n.count),4));const o=this.getAttribute("tangent"),s=[],l=[];for(let w=0;w<n.count;w++)s[w]=new lt,l[w]=new lt;const u=new lt,h=new lt,f=new lt,c=new pr,d=new pr,v=new pr,p=new lt,g=new lt;function m(w,b,A){u.fromBufferAttribute(n,w),h.fromBufferAttribute(n,b),f.fromBufferAttribute(n,A),c.fromBufferAttribute(a,w),d.fromBufferAttribute(a,b),v.fromBufferAttribute(a,A),h.sub(u),f.sub(u),d.sub(c),v.sub(c);const E=1/(d.x*v.y-v.x*d.y);isFinite(E)&&(p.copy(h).multiplyScalar(v.y).addScaledVector(f,-d.y).multiplyScalar(E),g.copy(f).multiplyScalar(d.x).addScaledVector(h,-v.x).multiplyScalar(E),s[w].add(p),s[b].add(p),s[A].add(p),l[w].add(g),l[b].add(g),l[A].add(g))}let _=this.groups;_.length===0&&(_=[{start:0,count:t.count}]);for(let w=0,b=_.length;w<b;++w){const A=_[w],E=A.start,C=A.count;for(let D=E,L=E+C;D<L;D+=3)m(t.getX(D+0),t.getX(D+1),t.getX(D+2))}const y=new lt,x=new lt,T=new lt,S=new lt;function M(w){T.fromBufferAttribute(i,w),S.copy(T);const b=s[w];y.copy(b),y.sub(T.multiplyScalar(T.dot(b))).normalize(),x.crossVectors(S,b);const E=x.dot(l[w])<0?-1:1;o.setXYZW(w,y.x,y.y,y.z,E)}for(let w=0,b=_.length;w<b;++w){const A=_[w],E=A.start,C=A.count;for(let D=E,L=E+C;D<L;D+=3)M(t.getX(D+0)),M(t.getX(D+1)),M(t.getX(D+2))}}computeVertexNormals(){const t=this.index,r=this.getAttribute("position");if(r!==void 0){let n=this.getAttribute("normal");if(n===void 0)n=new Za(new Float32Array(r.count*3),3),this.setAttribute("normal",n);else for(let c=0,d=n.count;c<d;c++)n.setXYZ(c,0,0,0);const i=new lt,a=new lt,o=new lt,s=new lt,l=new lt,u=new lt,h=new lt,f=new lt;if(t)for(let c=0,d=t.count;c<d;c+=3){const v=t.getX(c+0),p=t.getX(c+1),g=t.getX(c+2);i.fromBufferAttribute(r,v),a.fromBufferAttribute(r,p),o.fromBufferAttribute(r,g),h.subVectors(o,a),f.subVectors(i,a),h.cross(f),s.fromBufferAttribute(n,v),l.fromBufferAttribute(n,p),u.fromBufferAttribute(n,g),s.add(h),l.add(h),u.add(h),n.setXYZ(v,s.x,s.y,s.z),n.setXYZ(p,l.x,l.y,l.z),n.setXYZ(g,u.x,u.y,u.z)}else for(let c=0,d=r.count;c<d;c+=3)i.fromBufferAttribute(r,c+0),a.fromBufferAttribute(r,c+1),o.fromBufferAttribute(r,c+2),h.subVectors(o,a),f.subVectors(i,a),h.cross(f),n.setXYZ(c+0,h.x,h.y,h.z),n.setXYZ(c+1,h.x,h.y,h.z),n.setXYZ(c+2,h.x,h.y,h.z);this.normalizeNormals(),n.needsUpdate=!0}}normalizeNormals(){const t=this.attributes.normal;for(let r=0,n=t.count;r<n;r++)cn.fromBufferAttribute(t,r),cn.normalize(),t.setXYZ(r,cn.x,cn.y,cn.z)}toNonIndexed(){function t(s,l){const u=s.array,h=s.itemSize,f=s.normalized,c=new u.constructor(l.length*h);let d=0,v=0;for(let p=0,g=l.length;p<g;p++){s.isInterleavedBufferAttribute?d=l[p]*s.data.stride+s.offset:d=l[p]*h;for(let m=0;m<h;m++)c[v++]=u[d++]}return new Za(c,h,f)}if(this.index===null)return console.warn("THREE.BufferGeometry.toNonIndexed(): BufferGeometry is already non-indexed."),this;const r=new Yu,n=this.index.array,i=this.attributes;for(const s in i){const l=i[s],u=t(l,n);r.setAttribute(s,u)}const a=this.morphAttributes;for(const s in a){const l=[],u=a[s];for(let h=0,f=u.length;h<f;h++){const c=u[h],d=t(c,n);l.push(d)}r.morphAttributes[s]=l}r.morphTargetsRelative=this.morphTargetsRelative;const o=this.groups;for(let s=0,l=o.length;s<l;s++){const u=o[s];r.addGroup(u.start,u.count,u.materialIndex)}return r}toJSON(){const t={metadata:{version:4.6,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,this.name!==""&&(t.name=this.name),Object.keys(this.userData).length>0&&(t.userData=this.userData),this.parameters!==void 0){const l=this.parameters;for(const u in l)l[u]!==void 0&&(t[u]=l[u]);return t}t.data={attributes:{}};const r=this.index;r!==null&&(t.data.index={type:r.array.constructor.name,array:Array.prototype.slice.call(r.array)});const n=this.attributes;for(const l in n){const u=n[l];t.data.attributes[l]=u.toJSON(t.data)}const i={};let a=!1;for(const l in this.morphAttributes){const u=this.morphAttributes[l],h=[];for(let f=0,c=u.length;f<c;f++){const d=u[f];h.push(d.toJSON(t.data))}h.length>0&&(i[l]=h,a=!0)}a&&(t.data.morphAttributes=i,t.data.morphTargetsRelative=this.morphTargetsRelative);const o=this.groups;o.length>0&&(t.data.groups=JSON.parse(JSON.stringify(o)));const s=this.boundingSphere;return s!==null&&(t.data.boundingSphere={center:s.center.toArray(),radius:s.radius}),t}clone(){return new this.constructor().copy(this)}copy(t){this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null;const r={};this.name=t.name;const n=t.index;n!==null&&this.setIndex(n.clone(r));const i=t.attributes;for(const u in i){const h=i[u];this.setAttribute(u,h.clone(r))}const a=t.morphAttributes;for(const u in a){const h=[],f=a[u];for(let c=0,d=f.length;c<d;c++)h.push(f[c].clone(r));this.morphAttributes[u]=h}this.morphTargetsRelative=t.morphTargetsRelative;const o=t.groups;for(let u=0,h=o.length;u<h;u++){const f=o[u];this.addGroup(f.start,f.count,f.materialIndex)}const s=t.boundingBox;s!==null&&(this.boundingBox=s.clone());const l=t.boundingSphere;return l!==null&&(this.boundingSphere=l.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this.userData=t.userData,this}dispose(){this.dispatchEvent({type:"dispose"})}}const fN=new qr,Rl=new Zut,Sg=new MA,cN=new lt,Tg=new lt,bg=new lt,wg=new lt,k1=new lt,Mg=new lt,dN=new lt,Ag=new lt;class ka extends hi{constructor(t=new Yu,r=new AA){super(),this.isMesh=!0,this.type="Mesh",this.geometry=t,this.material=r,this.updateMorphTargets()}copy(t,r){return super.copy(t,r),t.morphTargetInfluences!==void 0&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),t.morphTargetDictionary!==void 0&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this.material=Array.isArray(t.material)?t.material.slice():t.material,this.geometry=t.geometry,this}updateMorphTargets(){const r=this.geometry.morphAttributes,n=Object.keys(r);if(n.length>0){const i=r[n[0]];if(i!==void 0){this.morphTargetInfluences=[],this.morphTargetDictionary={};for(let a=0,o=i.length;a<o;a++){const s=i[a].name||String(a);this.morphTargetInfluences.push(0),this.morphTargetDictionary[s]=a}}}}getVertexPosition(t,r){const n=this.geometry,i=n.attributes.position,a=n.morphAttributes.position,o=n.morphTargetsRelative;r.fromBufferAttribute(i,t);const s=this.morphTargetInfluences;if(a&&s){Mg.set(0,0,0);for(let l=0,u=a.length;l<u;l++){const h=s[l],f=a[l];h!==0&&(k1.fromBufferAttribute(f,t),o?Mg.addScaledVector(k1,h):Mg.addScaledVector(k1.sub(r),h))}r.add(Mg)}return r}raycast(t,r){const n=this.geometry,i=this.material,a=this.matrixWorld;i!==void 0&&(n.boundingSphere===null&&n.computeBoundingSphere(),Sg.copy(n.boundingSphere),Sg.applyMatrix4(a),Rl.copy(t.ray).recast(t.near),!(Sg.containsPoint(Rl.origin)===!1&&(Rl.intersectSphere(Sg,cN)===null||Rl.origin.distanceToSquared(cN)>(t.far-t.near)**2))&&(fN.copy(a).invert(),Rl.copy(t.ray).applyMatrix4(fN),!(n.boundingBox!==null&&Rl.intersectsBox(n.boundingBox)===!1)&&this._computeIntersections(t,r,Rl)))}_computeIntersections(t,r,n){let i;const a=this.geometry,o=this.material,s=a.index,l=a.attributes.position,u=a.attributes.uv,h=a.attributes.uv1,f=a.attributes.normal,c=a.groups,d=a.drawRange;if(s!==null)if(Array.isArray(o))for(let v=0,p=c.length;v<p;v++){const g=c[v],m=o[g.materialIndex],_=Math.max(g.start,d.start),y=Math.min(s.count,Math.min(g.start+g.count,d.start+d.count));for(let x=_,T=y;x<T;x+=3){const S=s.getX(x),M=s.getX(x+1),w=s.getX(x+2);i=Eg(this,m,t,n,u,h,f,S,M,w),i&&(i.faceIndex=Math.floor(x/3),i.face.materialIndex=g.materialIndex,r.push(i))}}else{const v=Math.max(0,d.start),p=Math.min(s.count,d.start+d.count);for(let g=v,m=p;g<m;g+=3){const _=s.getX(g),y=s.getX(g+1),x=s.getX(g+2);i=Eg(this,o,t,n,u,h,f,_,y,x),i&&(i.faceIndex=Math.floor(g/3),r.push(i))}}else if(l!==void 0)if(Array.isArray(o))for(let v=0,p=c.length;v<p;v++){const g=c[v],m=o[g.materialIndex],_=Math.max(g.start,d.start),y=Math.min(l.count,Math.min(g.start+g.count,d.start+d.count));for(let x=_,T=y;x<T;x+=3){const S=x,M=x+1,w=x+2;i=Eg(this,m,t,n,u,h,f,S,M,w),i&&(i.faceIndex=Math.floor(x/3),i.face.materialIndex=g.materialIndex,r.push(i))}}else{const v=Math.max(0,d.start),p=Math.min(l.count,d.start+d.count);for(let g=v,m=p;g<m;g+=3){const _=g,y=g+1,x=g+2;i=Eg(this,o,t,n,u,h,f,_,y,x),i&&(i.faceIndex=Math.floor(g/3),r.push(i))}}}}function rht(e,t,r,n,i,a,o,s){let l;if(t.side===li?l=n.intersectTriangle(o,a,i,!0,s):l=n.intersectTriangle(i,a,o,t.side===Gs,s),l===null)return null;Ag.copy(s),Ag.applyMatrix4(e.matrixWorld);const u=r.ray.origin.distanceTo(Ag);return u<r.near||u>r.far?null:{distance:u,point:Ag.clone(),object:e}}function Eg(e,t,r,n,i,a,o,s,l,u){e.getVertexPosition(s,Tg),e.getVertexPosition(l,bg),e.getVertexPosition(u,wg);const h=rht(e,t,r,n,Tg,bg,wg,dN);if(h){const f=new lt;ua.getBarycoord(dN,Tg,bg,wg,f),i&&(h.uv=ua.getInterpolatedAttribute(i,s,l,u,f,new pr)),a&&(h.uv1=ua.getInterpolatedAttribute(a,s,l,u,f,new pr)),o&&(h.normal=ua.getInterpolatedAttribute(o,s,l,u,f,new lt),h.normal.dot(n.direction)>0&&h.normal.multiplyScalar(-1));const c={a:s,b:l,c:u,normal:new lt,materialIndex:0};ua.getNormal(Tg,bg,wg,c.normal),h.face=c,h.barycoord=f}return h}class sc extends Yu{constructor(t=1,r=1,n=1,i=1,a=1,o=1){super(),this.type="BoxGeometry",this.parameters={width:t,height:r,depth:n,widthSegments:i,heightSegments:a,depthSegments:o};const s=this;i=Math.floor(i),a=Math.floor(a),o=Math.floor(o);const l=[],u=[],h=[],f=[];let c=0,d=0;v("z","y","x",-1,-1,n,r,t,o,a,0),v("z","y","x",1,-1,n,r,-t,o,a,1),v("x","z","y",1,1,t,n,r,i,o,2),v("x","z","y",1,-1,t,n,-r,i,o,3),v("x","y","z",1,-1,t,r,n,i,a,4),v("x","y","z",-1,-1,t,r,-n,i,a,5),this.setIndex(l),this.setAttribute("position",new _u(u,3)),this.setAttribute("normal",new _u(h,3)),this.setAttribute("uv",new _u(f,2));function v(p,g,m,_,y,x,T,S,M,w,b){const A=x/M,E=T/w,C=x/2,D=T/2,L=S/2,P=M+1,N=w+1;let O=0,I=0;const k=new lt;for(let z=0;z<N;z++){const X=z*E-D;for(let Y=0;Y<P;Y++){const $=Y*A-C;k[p]=$*_,k[g]=X*y,k[m]=L,u.push(k.x,k.y,k.z),k[p]=0,k[g]=0,k[m]=S>0?1:-1,h.push(k.x,k.y,k.z),f.push(Y/M),f.push(1-z/w),O+=1}}for(let z=0;z<w;z++)for(let X=0;X<M;X++){const Y=c+X+P*z,$=c+X+P*(z+1),H=c+(X+1)+P*(z+1),Z=c+(X+1)+P*z;l.push(Y,$,Z),l.push($,H,Z),I+=6}s.addGroup(d,I,b),d+=I,c+=O}}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new sc(t.width,t.height,t.depth,t.widthSegments,t.heightSegments,t.depthSegments)}}function Nf(e){const t={};for(const r in e){t[r]={};for(const n in e[r]){const i=e[r][n];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture||i.isQuaternion)?i.isRenderTargetTexture?(console.warn("UniformsUtils: Textures of render targets cannot be cloned via cloneUniforms() or mergeUniforms()."),t[r][n]=null):t[r][n]=i.clone():Array.isArray(i)?t[r][n]=i.slice():t[r][n]=i}}return t}function Nn(e){const t={};for(let r=0;r<e.length;r++){const n=Nf(e[r]);for(const i in n)t[i]=n[i]}return t}function nht(e){const t=[];for(let r=0;r<e.length;r++)t.push(e[r].clone());return t}function QG(e){const t=e.getRenderTarget();return t===null?e.outputColorSpace:t.isXRRenderTarget===!0?t.texture.colorSpace:tr.workingColorSpace}const iht={clone:Nf,merge:Nn};var aht=`void main() {
	gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
}`,oht=`void main() {
	gl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );
}`;class Vs extends m0{constructor(t){super(),this.isShaderMaterial=!0,this.type="ShaderMaterial",this.defines={},this.uniforms={},this.uniformsGroups=[],this.vertexShader=aht,this.fragmentShader=oht,this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.forceSinglePass=!0,this.extensions={clipCullDistance:!1,multiDraw:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv1:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,this.glslVersion=null,t!==void 0&&this.setValues(t)}copy(t){return super.copy(t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Nf(t.uniforms),this.uniformsGroups=nht(t.uniformsGroups),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.fog=t.fog,this.lights=t.lights,this.clipping=t.clipping,this.extensions=Object.assign({},t.extensions),this.glslVersion=t.glslVersion,this}toJSON(t){const r=super.toJSON(t);r.glslVersion=this.glslVersion,r.uniforms={};for(const i in this.uniforms){const o=this.uniforms[i].value;o&&o.isTexture?r.uniforms[i]={type:"t",value:o.toJSON(t).uuid}:o&&o.isColor?r.uniforms[i]={type:"c",value:o.getHex()}:o&&o.isVector2?r.uniforms[i]={type:"v2",value:o.toArray()}:o&&o.isVector3?r.uniforms[i]={type:"v3",value:o.toArray()}:o&&o.isVector4?r.uniforms[i]={type:"v4",value:o.toArray()}:o&&o.isMatrix3?r.uniforms[i]={type:"m3",value:o.toArray()}:o&&o.isMatrix4?r.uniforms[i]={type:"m4",value:o.toArray()}:r.uniforms[i]={value:o}}Object.keys(this.defines).length>0&&(r.defines=this.defines),r.vertexShader=this.vertexShader,r.fragmentShader=this.fragmentShader,r.lights=this.lights,r.clipping=this.clipping;const n={};for(const i in this.extensions)this.extensions[i]===!0&&(n[i]=!0);return Object.keys(n).length>0&&(r.extensions=n),r}}class t4 extends hi{constructor(){super(),this.isCamera=!0,this.type="Camera",this.matrixWorldInverse=new qr,this.projectionMatrix=new qr,this.projectionMatrixInverse=new qr,this.coordinateSystem=To}copy(t,r){return super.copy(t,r),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this.projectionMatrixInverse.copy(t.projectionMatrixInverse),this.coordinateSystem=t.coordinateSystem,this}getWorldDirection(t){return super.getWorldDirection(t).negate()}updateMatrixWorld(t){super.updateMatrixWorld(t),this.matrixWorldInverse.copy(this.matrixWorld).invert()}updateWorldMatrix(t,r){super.updateWorldMatrix(t,r),this.matrixWorldInverse.copy(this.matrixWorld).invert()}clone(){return new this.constructor().copy(this)}}const fs=new lt,vN=new pr,pN=new pr;class Bi extends t4{constructor(t=50,r=1,n=.1,i=2e3){super(),this.isPerspectiveCamera=!0,this.type="PerspectiveCamera",this.fov=t,this.zoom=1,this.near=n,this.far=i,this.focus=10,this.aspect=r,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}copy(t,r){return super.copy(t,r),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=t.view===null?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this}setFocalLength(t){const r=.5*this.getFilmHeight()/t;this.fov=Bb*2*Math.atan(r),this.updateProjectionMatrix()}getFocalLength(){const t=Math.tan(x1*.5*this.fov);return .5*this.getFilmHeight()/t}getEffectiveFOV(){return Bb*2*Math.atan(Math.tan(x1*.5*this.fov)/this.zoom)}getFilmWidth(){return this.filmGauge*Math.min(this.aspect,1)}getFilmHeight(){return this.filmGauge/Math.max(this.aspect,1)}getViewBounds(t,r,n){fs.set(-1,-1,.5).applyMatrix4(this.projectionMatrixInverse),r.set(fs.x,fs.y).multiplyScalar(-t/fs.z),fs.set(1,1,.5).applyMatrix4(this.projectionMatrixInverse),n.set(fs.x,fs.y).multiplyScalar(-t/fs.z)}getViewSize(t,r){return this.getViewBounds(t,vN,pN),r.subVectors(pN,vN)}setViewOffset(t,r,n,i,a,o){this.aspect=t/r,this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=this.near;let r=t*Math.tan(x1*.5*this.fov)/this.zoom,n=2*r,i=this.aspect*n,a=-.5*i;const o=this.view;if(this.view!==null&&this.view.enabled){const l=o.fullWidth,u=o.fullHeight;a+=o.offsetX*i/l,r-=o.offsetY*n/u,i*=o.width/l,n*=o.height/u}const s=this.filmOffset;s!==0&&(a+=t*s/this.getFilmWidth()),this.projectionMatrix.makePerspective(a,a+i,r,r-n,t,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const r=super.toJSON(t);return r.object.fov=this.fov,r.object.zoom=this.zoom,r.object.near=this.near,r.object.far=this.far,r.object.focus=this.focus,r.object.aspect=this.aspect,this.view!==null&&(r.object.view=Object.assign({},this.view)),r.object.filmGauge=this.filmGauge,r.object.filmOffset=this.filmOffset,r}}const Fh=-90,Bh=1;class sht extends hi{constructor(t,r,n){super(),this.type="CubeCamera",this.renderTarget=n,this.coordinateSystem=null,this.activeMipmapLevel=0;const i=new Bi(Fh,Bh,t,r);i.layers=this.layers,this.add(i);const a=new Bi(Fh,Bh,t,r);a.layers=this.layers,this.add(a);const o=new Bi(Fh,Bh,t,r);o.layers=this.layers,this.add(o);const s=new Bi(Fh,Bh,t,r);s.layers=this.layers,this.add(s);const l=new Bi(Fh,Bh,t,r);l.layers=this.layers,this.add(l);const u=new Bi(Fh,Bh,t,r);u.layers=this.layers,this.add(u)}updateCoordinateSystem(){const t=this.coordinateSystem,r=this.children.concat(),[n,i,a,o,s,l]=r;for(const u of r)this.remove(u);if(t===To)n.up.set(0,1,0),n.lookAt(1,0,0),i.up.set(0,1,0),i.lookAt(-1,0,0),a.up.set(0,0,-1),a.lookAt(0,1,0),o.up.set(0,0,1),o.lookAt(0,-1,0),s.up.set(0,1,0),s.lookAt(0,0,1),l.up.set(0,1,0),l.lookAt(0,0,-1);else if(t===__)n.up.set(0,-1,0),n.lookAt(-1,0,0),i.up.set(0,-1,0),i.lookAt(1,0,0),a.up.set(0,0,1),a.lookAt(0,1,0),o.up.set(0,0,-1),o.lookAt(0,-1,0),s.up.set(0,-1,0),s.lookAt(0,0,1),l.up.set(0,-1,0),l.lookAt(0,0,-1);else throw new Error("THREE.CubeCamera.updateCoordinateSystem(): Invalid coordinate system: "+t);for(const u of r)this.add(u),u.updateMatrixWorld()}update(t,r){this.parent===null&&this.updateMatrixWorld();const{renderTarget:n,activeMipmapLevel:i}=this;this.coordinateSystem!==t.coordinateSystem&&(this.coordinateSystem=t.coordinateSystem,this.updateCoordinateSystem());const[a,o,s,l,u,h]=this.children,f=t.getRenderTarget(),c=t.getActiveCubeFace(),d=t.getActiveMipmapLevel(),v=t.xr.enabled;t.xr.enabled=!1;const p=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,t.setRenderTarget(n,0,i),t.render(r,a),t.setRenderTarget(n,1,i),t.render(r,o),t.setRenderTarget(n,2,i),t.render(r,s),t.setRenderTarget(n,3,i),t.render(r,l),t.setRenderTarget(n,4,i),t.render(r,u),n.texture.generateMipmaps=p,t.setRenderTarget(n,5,i),t.render(r,h),t.setRenderTarget(f,c,d),t.xr.enabled=v,n.texture.needsPMREMUpdate=!0}}class e4 extends ui{constructor(t,r,n,i,a,o,s,l,u,h){t=t!==void 0?t:[],r=r!==void 0?r:Df,super(t,r,n,i,a,o,s,l,u,h),this.isCubeTexture=!0,this.flipY=!1}get images(){return this.image}set images(t){this.image=t}}class lht extends Nu{constructor(t=1,r={}){super(t,t,r),this.isWebGLCubeRenderTarget=!0;const n={width:t,height:t,depth:1},i=[n,n,n,n,n,n];this.texture=new e4(i,r.mapping,r.wrapS,r.wrapT,r.magFilter,r.minFilter,r.format,r.type,r.anisotropy,r.colorSpace),this.texture.isRenderTargetTexture=!0,this.texture.generateMipmaps=r.generateMipmaps!==void 0?r.generateMipmaps:!1,this.texture.minFilter=r.minFilter!==void 0?r.minFilter:za}fromEquirectangularTexture(t,r){this.texture.type=r.type,this.texture.colorSpace=r.colorSpace,this.texture.generateMipmaps=r.generateMipmaps,this.texture.minFilter=r.minFilter,this.texture.magFilter=r.magFilter;const n={uniforms:{tEquirect:{value:null}},vertexShader:`

				varying vec3 vWorldDirection;

				vec3 transformDirection( in vec3 dir, in mat4 matrix ) {

					return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );

				}

				void main() {

					vWorldDirection = transformDirection( position, modelMatrix );

					#include <begin_vertex>
					#include <project_vertex>

				}
			`,fragmentShader:`

				uniform sampler2D tEquirect;

				varying vec3 vWorldDirection;

				#include <common>

				void main() {

					vec3 direction = normalize( vWorldDirection );

					vec2 sampleUV = equirectUv( direction );

					gl_FragColor = texture2D( tEquirect, sampleUV );

				}
			`},i=new sc(5,5,5),a=new Vs({name:"CubemapFromEquirect",uniforms:Nf(n.uniforms),vertexShader:n.vertexShader,fragmentShader:n.fragmentShader,side:li,blending:Rs});a.uniforms.tEquirect.value=r;const o=new ka(i,a),s=r.minFilter;return r.minFilter===su&&(r.minFilter=za),new sht(1,10,this).update(t,o),r.minFilter=s,o.geometry.dispose(),o.material.dispose(),this}clear(t,r,n,i){const a=t.getRenderTarget();for(let o=0;o<6;o++)t.setRenderTarget(this,o),t.clear(r,n,i);t.setRenderTarget(a)}}class uht extends hi{constructor(){super(),this.isScene=!0,this.type="Scene",this.background=null,this.environment=null,this.fog=null,this.backgroundBlurriness=0,this.backgroundIntensity=1,this.backgroundRotation=new ko,this.environmentIntensity=1,this.environmentRotation=new ko,this.overrideMaterial=null,typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}copy(t,r){return super.copy(t,r),t.background!==null&&(this.background=t.background.clone()),t.environment!==null&&(this.environment=t.environment.clone()),t.fog!==null&&(this.fog=t.fog.clone()),this.backgroundBlurriness=t.backgroundBlurriness,this.backgroundIntensity=t.backgroundIntensity,this.backgroundRotation.copy(t.backgroundRotation),this.environmentIntensity=t.environmentIntensity,this.environmentRotation.copy(t.environmentRotation),t.overrideMaterial!==null&&(this.overrideMaterial=t.overrideMaterial.clone()),this.matrixAutoUpdate=t.matrixAutoUpdate,this}toJSON(t){const r=super.toJSON(t);return this.fog!==null&&(r.object.fog=this.fog.toJSON()),this.backgroundBlurriness>0&&(r.object.backgroundBlurriness=this.backgroundBlurriness),this.backgroundIntensity!==1&&(r.object.backgroundIntensity=this.backgroundIntensity),r.object.backgroundRotation=this.backgroundRotation.toArray(),this.environmentIntensity!==1&&(r.object.environmentIntensity=this.environmentIntensity),r.object.environmentRotation=this.environmentRotation.toArray(),r}}const G1=new lt,hht=new lt,fht=new Pe;class Gl{constructor(t=new lt(1,0,0),r=0){this.isPlane=!0,this.normal=t,this.constant=r}set(t,r){return this.normal.copy(t),this.constant=r,this}setComponents(t,r,n,i){return this.normal.set(t,r,n),this.constant=i,this}setFromNormalAndCoplanarPoint(t,r){return this.normal.copy(t),this.constant=-r.dot(this.normal),this}setFromCoplanarPoints(t,r,n){const i=G1.subVectors(n,r).cross(hht.subVectors(t,r)).normalize();return this.setFromNormalAndCoplanarPoint(i,t),this}copy(t){return this.normal.copy(t.normal),this.constant=t.constant,this}normalize(){const t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this}negate(){return this.constant*=-1,this.normal.negate(),this}distanceToPoint(t){return this.normal.dot(t)+this.constant}distanceToSphere(t){return this.distanceToPoint(t.center)-t.radius}projectPoint(t,r){return r.copy(t).addScaledVector(this.normal,-this.distanceToPoint(t))}intersectLine(t,r){const n=t.delta(G1),i=this.normal.dot(n);if(i===0)return this.distanceToPoint(t.start)===0?r.copy(t.start):null;const a=-(t.start.dot(this.normal)+this.constant)/i;return a<0||a>1?null:r.copy(t.start).addScaledVector(n,a)}intersectsLine(t){const r=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return r<0&&n>0||n<0&&r>0}intersectsBox(t){return t.intersectsPlane(this)}intersectsSphere(t){return t.intersectsPlane(this)}coplanarPoint(t){return t.copy(this.normal).multiplyScalar(-this.constant)}applyMatrix4(t,r){const n=r||fht.getNormalMatrix(t),i=this.coplanarPoint(G1).applyMatrix4(t),a=this.normal.applyMatrix3(n).normalize();return this.constant=-i.dot(a),this}translate(t){return this.constant-=t.dot(this.normal),this}equals(t){return t.normal.equals(this.normal)&&t.constant===this.constant}clone(){return new this.constructor().copy(this)}}const Pl=new MA,Cg=new lt;class r4{constructor(t=new Gl,r=new Gl,n=new Gl,i=new Gl,a=new Gl,o=new Gl){this.planes=[t,r,n,i,a,o]}set(t,r,n,i,a,o){const s=this.planes;return s[0].copy(t),s[1].copy(r),s[2].copy(n),s[3].copy(i),s[4].copy(a),s[5].copy(o),this}copy(t){const r=this.planes;for(let n=0;n<6;n++)r[n].copy(t.planes[n]);return this}setFromProjectionMatrix(t,r=To){const n=this.planes,i=t.elements,a=i[0],o=i[1],s=i[2],l=i[3],u=i[4],h=i[5],f=i[6],c=i[7],d=i[8],v=i[9],p=i[10],g=i[11],m=i[12],_=i[13],y=i[14],x=i[15];if(n[0].setComponents(l-a,c-u,g-d,x-m).normalize(),n[1].setComponents(l+a,c+u,g+d,x+m).normalize(),n[2].setComponents(l+o,c+h,g+v,x+_).normalize(),n[3].setComponents(l-o,c-h,g-v,x-_).normalize(),n[4].setComponents(l-s,c-f,g-p,x-y).normalize(),r===To)n[5].setComponents(l+s,c+f,g+p,x+y).normalize();else if(r===__)n[5].setComponents(s,f,p,y).normalize();else throw new Error("THREE.Frustum.setFromProjectionMatrix(): Invalid coordinate system: "+r);return this}intersectsObject(t){if(t.boundingSphere!==void 0)t.boundingSphere===null&&t.computeBoundingSphere(),Pl.copy(t.boundingSphere).applyMatrix4(t.matrixWorld);else{const r=t.geometry;r.boundingSphere===null&&r.computeBoundingSphere(),Pl.copy(r.boundingSphere).applyMatrix4(t.matrixWorld)}return this.intersectsSphere(Pl)}intersectsSprite(t){return Pl.center.set(0,0,0),Pl.radius=.7071067811865476,Pl.applyMatrix4(t.matrixWorld),this.intersectsSphere(Pl)}intersectsSphere(t){const r=this.planes,n=t.center,i=-t.radius;for(let a=0;a<6;a++)if(r[a].distanceToPoint(n)<i)return!1;return!0}intersectsBox(t){const r=this.planes;for(let n=0;n<6;n++){const i=r[n];if(Cg.x=i.normal.x>0?t.max.x:t.min.x,Cg.y=i.normal.y>0?t.max.y:t.min.y,Cg.z=i.normal.z>0?t.max.z:t.min.z,i.distanceToPoint(Cg)<0)return!1}return!0}containsPoint(t){const r=this.planes;for(let n=0;n<6;n++)if(r[n].distanceToPoint(t)<0)return!1;return!0}clone(){return new this.constructor().copy(this)}}class Dg extends hi{constructor(){super(),this.isGroup=!0,this.type="Group"}}class n4 extends ui{constructor(t,r,n,i,a,o,s,l,u,h=of){if(h!==of&&h!==Pf)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");n===void 0&&h===of&&(n=Iu),n===void 0&&h===Pf&&(n=Rf),super(null,i,a,o,s,l,h,n,u),this.isDepthTexture=!0,this.image={width:t,height:r},this.magFilter=s!==void 0?s:ga,this.minFilter=l!==void 0?l:ga,this.flipY=!1,this.generateMipmaps=!1,this.compareFunction=null}copy(t){return super.copy(t),this.compareFunction=t.compareFunction,this}toJSON(t){const r=super.toJSON(t);return this.compareFunction!==null&&(r.compareFunction=this.compareFunction),r}}class _0 extends Yu{constructor(t=1,r=1,n=1,i=1){super(),this.type="PlaneGeometry",this.parameters={width:t,height:r,widthSegments:n,heightSegments:i};const a=t/2,o=r/2,s=Math.floor(n),l=Math.floor(i),u=s+1,h=l+1,f=t/s,c=r/l,d=[],v=[],p=[],g=[];for(let m=0;m<h;m++){const _=m*c-o;for(let y=0;y<u;y++){const x=y*f-a;v.push(x,-_,0),p.push(0,0,1),g.push(y/s),g.push(1-m/l)}}for(let m=0;m<l;m++)for(let _=0;_<s;_++){const y=_+u*m,x=_+u*(m+1),T=_+1+u*(m+1),S=_+1+u*m;d.push(y,x,S),d.push(x,T,S)}this.setIndex(d),this.setAttribute("position",new _u(v,3)),this.setAttribute("normal",new _u(p,3)),this.setAttribute("uv",new _u(g,2))}copy(t){return super.copy(t),this.parameters=Object.assign({},t.parameters),this}static fromJSON(t){return new _0(t.width,t.height,t.widthSegments,t.heightSegments)}}class cht extends m0{constructor(t){super(),this.isMeshDepthMaterial=!0,this.type="MeshDepthMaterial",this.depthPacking=wut,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.setValues(t)}copy(t){return super.copy(t),this.depthPacking=t.depthPacking,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this}}class dht extends m0{constructor(t){super(),this.isMeshDistanceMaterial=!0,this.type="MeshDistanceMaterial",this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.setValues(t)}copy(t){return super.copy(t),this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this}}class vht extends hi{constructor(t,r=1){super(),this.isLight=!0,this.type="Light",this.color=new fr(t),this.intensity=r}dispose(){}copy(t,r){return super.copy(t,r),this.color.copy(t.color),this.intensity=t.intensity,this}toJSON(t){const r=super.toJSON(t);return r.object.color=this.color.getHex(),r.object.intensity=this.intensity,this.groundColor!==void 0&&(r.object.groundColor=this.groundColor.getHex()),this.distance!==void 0&&(r.object.distance=this.distance),this.angle!==void 0&&(r.object.angle=this.angle),this.decay!==void 0&&(r.object.decay=this.decay),this.penumbra!==void 0&&(r.object.penumbra=this.penumbra),this.shadow!==void 0&&(r.object.shadow=this.shadow.toJSON()),this.target!==void 0&&(r.object.target=this.target.uuid),r}}class pht extends t4{constructor(t=-1,r=1,n=1,i=-1,a=.1,o=2e3){super(),this.isOrthographicCamera=!0,this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=r,this.top=n,this.bottom=i,this.near=a,this.far=o,this.updateProjectionMatrix()}copy(t,r){return super.copy(t,r),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=t.view===null?null:Object.assign({},t.view),this}setViewOffset(t,r,n,i,a,o){this.view===null&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=r,this.view.offsetX=n,this.view.offsetY=i,this.view.width=a,this.view.height=o,this.updateProjectionMatrix()}clearViewOffset(){this.view!==null&&(this.view.enabled=!1),this.updateProjectionMatrix()}updateProjectionMatrix(){const t=(this.right-this.left)/(2*this.zoom),r=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,i=(this.top+this.bottom)/2;let a=n-t,o=n+t,s=i+r,l=i-r;if(this.view!==null&&this.view.enabled){const u=(this.right-this.left)/this.view.fullWidth/this.zoom,h=(this.top-this.bottom)/this.view.fullHeight/this.zoom;a+=u*this.view.offsetX,o=a+u*this.view.width,s-=h*this.view.offsetY,l=s-h*this.view.height}this.projectionMatrix.makeOrthographic(a,o,s,l,this.near,this.far,this.coordinateSystem),this.projectionMatrixInverse.copy(this.projectionMatrix).invert()}toJSON(t){const r=super.toJSON(t);return r.object.zoom=this.zoom,r.object.left=this.left,r.object.right=this.right,r.object.top=this.top,r.object.bottom=this.bottom,r.object.near=this.near,r.object.far=this.far,this.view!==null&&(r.object.view=Object.assign({},this.view)),r}}class ght extends vht{constructor(t,r){super(t,r),this.isAmbientLight=!0,this.type="AmbientLight"}}class mht extends Bi{constructor(t=[]){super(),this.isArrayCamera=!0,this.cameras=t}}function gN(e,t,r,n){const i=_ht(n);switch(r){case UG:return e*t;case kG:return e*t;case GG:return e*t*2;case VG:return e*t/i.components*i.byteLength;case TA:return e*t/i.components*i.byteLength;case HG:return e*t*2/i.components*i.byteLength;case bA:return e*t*2/i.components*i.byteLength;case zG:return e*t*3/i.components*i.byteLength;case ca:return e*t*4/i.components*i.byteLength;case wA:return e*t*4/i.components*i.byteLength;case am:case om:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case sm:case lm:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case cb:case vb:return Math.max(e,16)*Math.max(t,8)/4;case fb:case db:return Math.max(e,8)*Math.max(t,8)/2;case pb:case gb:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*8;case mb:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case _b:return Math.floor((e+3)/4)*Math.floor((t+3)/4)*16;case yb:return Math.floor((e+4)/5)*Math.floor((t+3)/4)*16;case xb:return Math.floor((e+4)/5)*Math.floor((t+4)/5)*16;case Sb:return Math.floor((e+5)/6)*Math.floor((t+4)/5)*16;case Tb:return Math.floor((e+5)/6)*Math.floor((t+5)/6)*16;case bb:return Math.floor((e+7)/8)*Math.floor((t+4)/5)*16;case wb:return Math.floor((e+7)/8)*Math.floor((t+5)/6)*16;case Mb:return Math.floor((e+7)/8)*Math.floor((t+7)/8)*16;case Ab:return Math.floor((e+9)/10)*Math.floor((t+4)/5)*16;case Eb:return Math.floor((e+9)/10)*Math.floor((t+5)/6)*16;case Cb:return Math.floor((e+9)/10)*Math.floor((t+7)/8)*16;case Db:return Math.floor((e+9)/10)*Math.floor((t+9)/10)*16;case Lb:return Math.floor((e+11)/12)*Math.floor((t+9)/10)*16;case Rb:return Math.floor((e+11)/12)*Math.floor((t+11)/12)*16;case um:case Pb:case Ib:return Math.ceil(e/4)*Math.ceil(t/4)*16;case WG:case Nb:return Math.ceil(e/4)*Math.ceil(t/4)*8;case Ob:case Fb:return Math.ceil(e/4)*Math.ceil(t/4)*16}throw new Error(`Unable to determine texture byte length for ${r} format.`)}function _ht(e){switch(e){case zo:case OG:return{byteLength:1,components:1};case mv:case FG:case Hv:return{byteLength:2,components:1};case xA:case SA:return{byteLength:2,components:4};case Iu:case yA:case So:return{byteLength:4,components:1};case BG:return{byteLength:4,components:3}}throw new Error(`Unknown texture type ${e}.`)}typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("register",{detail:{revision:_A}}));typeof window<"u"&&(window.__THREE__?console.warn("WARNING: Multiple instances of Three.js being imported."):window.__THREE__=_A);/**
 * @license
 * Copyright 2010-2024 Three.js Authors
 * SPDX-License-Identifier: MIT
 */function i4(){let e=null,t=!1,r=null,n=null;function i(a,o){r(a,o),n=e.requestAnimationFrame(i)}return{start:function(){t!==!0&&r!==null&&(n=e.requestAnimationFrame(i),t=!0)},stop:function(){e.cancelAnimationFrame(n),t=!1},setAnimationLoop:function(a){r=a},setContext:function(a){e=a}}}function yht(e){const t=new WeakMap;function r(s,l){const u=s.array,h=s.usage,f=u.byteLength,c=e.createBuffer();e.bindBuffer(l,c),e.bufferData(l,u,h),s.onUploadCallback();let d;if(u instanceof Float32Array)d=e.FLOAT;else if(u instanceof Uint16Array)s.isFloat16BufferAttribute?d=e.HALF_FLOAT:d=e.UNSIGNED_SHORT;else if(u instanceof Int16Array)d=e.SHORT;else if(u instanceof Uint32Array)d=e.UNSIGNED_INT;else if(u instanceof Int32Array)d=e.INT;else if(u instanceof Int8Array)d=e.BYTE;else if(u instanceof Uint8Array)d=e.UNSIGNED_BYTE;else if(u instanceof Uint8ClampedArray)d=e.UNSIGNED_BYTE;else throw new Error("THREE.WebGLAttributes: Unsupported buffer data format: "+u);return{buffer:c,type:d,bytesPerElement:u.BYTES_PER_ELEMENT,version:s.version,size:f}}function n(s,l,u){const h=l.array,f=l.updateRanges;if(e.bindBuffer(u,s),f.length===0)e.bufferSubData(u,0,h);else{f.sort((d,v)=>d.start-v.start);let c=0;for(let d=1;d<f.length;d++){const v=f[c],p=f[d];p.start<=v.start+v.count+1?v.count=Math.max(v.count,p.start+p.count-v.start):(++c,f[c]=p)}f.length=c+1;for(let d=0,v=f.length;d<v;d++){const p=f[d];e.bufferSubData(u,p.start*h.BYTES_PER_ELEMENT,h,p.start,p.count)}l.clearUpdateRanges()}l.onUploadCallback()}function i(s){return s.isInterleavedBufferAttribute&&(s=s.data),t.get(s)}function a(s){s.isInterleavedBufferAttribute&&(s=s.data);const l=t.get(s);l&&(e.deleteBuffer(l.buffer),t.delete(s))}function o(s,l){if(s.isInterleavedBufferAttribute&&(s=s.data),s.isGLBufferAttribute){const h=t.get(s);(!h||h.version<s.version)&&t.set(s,{buffer:s.buffer,type:s.type,bytesPerElement:s.elementSize,version:s.version});return}const u=t.get(s);if(u===void 0)t.set(s,r(s,l));else if(u.version<s.version){if(u.size!==s.array.byteLength)throw new Error("THREE.WebGLAttributes: The size of the buffer attribute's array buffer does not match the original size. Resizing buffer attributes is not supported.");n(u.buffer,s,l),u.version=s.version}}return{get:i,remove:a,update:o}}var xht=`#ifdef USE_ALPHAHASH
	if ( diffuseColor.a < getAlphaHashThreshold( vPosition ) ) discard;
#endif`,Sht=`#ifdef USE_ALPHAHASH
	const float ALPHA_HASH_SCALE = 0.05;
	float hash2D( vec2 value ) {
		return fract( 1.0e4 * sin( 17.0 * value.x + 0.1 * value.y ) * ( 0.1 + abs( sin( 13.0 * value.y + value.x ) ) ) );
	}
	float hash3D( vec3 value ) {
		return hash2D( vec2( hash2D( value.xy ), value.z ) );
	}
	float getAlphaHashThreshold( vec3 position ) {
		float maxDeriv = max(
			length( dFdx( position.xyz ) ),
			length( dFdy( position.xyz ) )
		);
		float pixScale = 1.0 / ( ALPHA_HASH_SCALE * maxDeriv );
		vec2 pixScales = vec2(
			exp2( floor( log2( pixScale ) ) ),
			exp2( ceil( log2( pixScale ) ) )
		);
		vec2 alpha = vec2(
			hash3D( floor( pixScales.x * position.xyz ) ),
			hash3D( floor( pixScales.y * position.xyz ) )
		);
		float lerpFactor = fract( log2( pixScale ) );
		float x = ( 1.0 - lerpFactor ) * alpha.x + lerpFactor * alpha.y;
		float a = min( lerpFactor, 1.0 - lerpFactor );
		vec3 cases = vec3(
			x * x / ( 2.0 * a * ( 1.0 - a ) ),
			( x - 0.5 * a ) / ( 1.0 - a ),
			1.0 - ( ( 1.0 - x ) * ( 1.0 - x ) / ( 2.0 * a * ( 1.0 - a ) ) )
		);
		float threshold = ( x < ( 1.0 - a ) )
			? ( ( x < a ) ? cases.x : cases.y )
			: cases.z;
		return clamp( threshold , 1.0e-6, 1.0 );
	}
#endif`,Tht=`#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, vAlphaMapUv ).g;
#endif`,bht=`#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,wht=`#ifdef USE_ALPHATEST
	#ifdef ALPHA_TO_COVERAGE
	diffuseColor.a = smoothstep( alphaTest, alphaTest + fwidth( diffuseColor.a ), diffuseColor.a );
	if ( diffuseColor.a == 0.0 ) discard;
	#else
	if ( diffuseColor.a < alphaTest ) discard;
	#endif
#endif`,Mht=`#ifdef USE_ALPHATEST
	uniform float alphaTest;
#endif`,Aht=`#ifdef USE_AOMAP
	float ambientOcclusion = ( texture2D( aoMap, vAoMapUv ).r - 1.0 ) * aoMapIntensity + 1.0;
	reflectedLight.indirectDiffuse *= ambientOcclusion;
	#if defined( USE_CLEARCOAT ) 
		clearcoatSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_SHEEN ) 
		sheenSpecularIndirect *= ambientOcclusion;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD )
		float dotNV = saturate( dot( geometryNormal, geometryViewDir ) );
		reflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.roughness );
	#endif
#endif`,Eht=`#ifdef USE_AOMAP
	uniform sampler2D aoMap;
	uniform float aoMapIntensity;
#endif`,Cht=`#ifdef USE_BATCHING
	#if ! defined( GL_ANGLE_multi_draw )
	#define gl_DrawID _gl_DrawID
	uniform int _gl_DrawID;
	#endif
	uniform highp sampler2D batchingTexture;
	uniform highp usampler2D batchingIdTexture;
	mat4 getBatchingMatrix( const in float i ) {
		int size = textureSize( batchingTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( batchingTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( batchingTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( batchingTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( batchingTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
	float getIndirectIndex( const in int i ) {
		int size = textureSize( batchingIdTexture, 0 ).x;
		int x = i % size;
		int y = i / size;
		return float( texelFetch( batchingIdTexture, ivec2( x, y ), 0 ).r );
	}
#endif
#ifdef USE_BATCHING_COLOR
	uniform sampler2D batchingColorTexture;
	vec3 getBatchingColor( const in float i ) {
		int size = textureSize( batchingColorTexture, 0 ).x;
		int j = int( i );
		int x = j % size;
		int y = j / size;
		return texelFetch( batchingColorTexture, ivec2( x, y ), 0 ).rgb;
	}
#endif`,Dht=`#ifdef USE_BATCHING
	mat4 batchingMatrix = getBatchingMatrix( getIndirectIndex( gl_DrawID ) );
#endif`,Lht=`vec3 transformed = vec3( position );
#ifdef USE_ALPHAHASH
	vPosition = vec3( position );
#endif`,Rht=`vec3 objectNormal = vec3( normal );
#ifdef USE_TANGENT
	vec3 objectTangent = vec3( tangent.xyz );
#endif`,Pht=`float G_BlinnPhong_Implicit( ) {
	return 0.25;
}
float D_BlinnPhong( const in float shininess, const in float dotNH ) {
	return RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );
}
vec3 BRDF_BlinnPhong( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in vec3 specularColor, const in float shininess ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( specularColor, 1.0, dotVH );
	float G = G_BlinnPhong_Implicit( );
	float D = D_BlinnPhong( shininess, dotNH );
	return F * ( G * D );
} // validated`,Iht=`#ifdef USE_IRIDESCENCE
	const mat3 XYZ_TO_REC709 = mat3(
		 3.2404542, -0.9692660,  0.0556434,
		-1.5371385,  1.8760108, -0.2040259,
		-0.4985314,  0.0415560,  1.0572252
	);
	vec3 Fresnel0ToIor( vec3 fresnel0 ) {
		vec3 sqrtF0 = sqrt( fresnel0 );
		return ( vec3( 1.0 ) + sqrtF0 ) / ( vec3( 1.0 ) - sqrtF0 );
	}
	vec3 IorToFresnel0( vec3 transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - vec3( incidentIor ) ) / ( transmittedIor + vec3( incidentIor ) ) );
	}
	float IorToFresnel0( float transmittedIor, float incidentIor ) {
		return pow2( ( transmittedIor - incidentIor ) / ( transmittedIor + incidentIor ));
	}
	vec3 evalSensitivity( float OPD, vec3 shift ) {
		float phase = 2.0 * PI * OPD * 1.0e-9;
		vec3 val = vec3( 5.4856e-13, 4.4201e-13, 5.2481e-13 );
		vec3 pos = vec3( 1.6810e+06, 1.7953e+06, 2.2084e+06 );
		vec3 var = vec3( 4.3278e+09, 9.3046e+09, 6.6121e+09 );
		vec3 xyz = val * sqrt( 2.0 * PI * var ) * cos( pos * phase + shift ) * exp( - pow2( phase ) * var );
		xyz.x += 9.7470e-14 * sqrt( 2.0 * PI * 4.5282e+09 ) * cos( 2.2399e+06 * phase + shift[ 0 ] ) * exp( - 4.5282e+09 * pow2( phase ) );
		xyz /= 1.0685e-7;
		vec3 rgb = XYZ_TO_REC709 * xyz;
		return rgb;
	}
	vec3 evalIridescence( float outsideIOR, float eta2, float cosTheta1, float thinFilmThickness, vec3 baseF0 ) {
		vec3 I;
		float iridescenceIOR = mix( outsideIOR, eta2, smoothstep( 0.0, 0.03, thinFilmThickness ) );
		float sinTheta2Sq = pow2( outsideIOR / iridescenceIOR ) * ( 1.0 - pow2( cosTheta1 ) );
		float cosTheta2Sq = 1.0 - sinTheta2Sq;
		if ( cosTheta2Sq < 0.0 ) {
			return vec3( 1.0 );
		}
		float cosTheta2 = sqrt( cosTheta2Sq );
		float R0 = IorToFresnel0( iridescenceIOR, outsideIOR );
		float R12 = F_Schlick( R0, 1.0, cosTheta1 );
		float T121 = 1.0 - R12;
		float phi12 = 0.0;
		if ( iridescenceIOR < outsideIOR ) phi12 = PI;
		float phi21 = PI - phi12;
		vec3 baseIOR = Fresnel0ToIor( clamp( baseF0, 0.0, 0.9999 ) );		vec3 R1 = IorToFresnel0( baseIOR, iridescenceIOR );
		vec3 R23 = F_Schlick( R1, 1.0, cosTheta2 );
		vec3 phi23 = vec3( 0.0 );
		if ( baseIOR[ 0 ] < iridescenceIOR ) phi23[ 0 ] = PI;
		if ( baseIOR[ 1 ] < iridescenceIOR ) phi23[ 1 ] = PI;
		if ( baseIOR[ 2 ] < iridescenceIOR ) phi23[ 2 ] = PI;
		float OPD = 2.0 * iridescenceIOR * thinFilmThickness * cosTheta2;
		vec3 phi = vec3( phi21 ) + phi23;
		vec3 R123 = clamp( R12 * R23, 1e-5, 0.9999 );
		vec3 r123 = sqrt( R123 );
		vec3 Rs = pow2( T121 ) * R23 / ( vec3( 1.0 ) - R123 );
		vec3 C0 = R12 + Rs;
		I = C0;
		vec3 Cm = Rs - T121;
		for ( int m = 1; m <= 2; ++ m ) {
			Cm *= r123;
			vec3 Sm = 2.0 * evalSensitivity( float( m ) * OPD, float( m ) * phi );
			I += Cm * Sm;
		}
		return max( I, vec3( 0.0 ) );
	}
#endif`,Nht=`#ifdef USE_BUMPMAP
	uniform sampler2D bumpMap;
	uniform float bumpScale;
	vec2 dHdxy_fwd() {
		vec2 dSTdx = dFdx( vBumpMapUv );
		vec2 dSTdy = dFdy( vBumpMapUv );
		float Hll = bumpScale * texture2D( bumpMap, vBumpMapUv ).x;
		float dBx = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdx ).x - Hll;
		float dBy = bumpScale * texture2D( bumpMap, vBumpMapUv + dSTdy ).x - Hll;
		return vec2( dBx, dBy );
	}
	vec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy, float faceDirection ) {
		vec3 vSigmaX = normalize( dFdx( surf_pos.xyz ) );
		vec3 vSigmaY = normalize( dFdy( surf_pos.xyz ) );
		vec3 vN = surf_norm;
		vec3 R1 = cross( vSigmaY, vN );
		vec3 R2 = cross( vN, vSigmaX );
		float fDet = dot( vSigmaX, R1 ) * faceDirection;
		vec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );
		return normalize( abs( fDet ) * surf_norm - vGrad );
	}
#endif`,Oht=`#if NUM_CLIPPING_PLANES > 0
	vec4 plane;
	#ifdef ALPHA_TO_COVERAGE
		float distanceToPlane, distanceGradient;
		float clipOpacity = 1.0;
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
			distanceGradient = fwidth( distanceToPlane ) / 2.0;
			clipOpacity *= smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			if ( clipOpacity == 0.0 ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			float unionClipOpacity = 1.0;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				distanceToPlane = - dot( vClipPosition, plane.xyz ) + plane.w;
				distanceGradient = fwidth( distanceToPlane ) / 2.0;
				unionClipOpacity *= 1.0 - smoothstep( - distanceGradient, distanceGradient, distanceToPlane );
			}
			#pragma unroll_loop_end
			clipOpacity *= 1.0 - unionClipOpacity;
		#endif
		diffuseColor.a *= clipOpacity;
		if ( diffuseColor.a == 0.0 ) discard;
	#else
		#pragma unroll_loop_start
		for ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {
			plane = clippingPlanes[ i ];
			if ( dot( vClipPosition, plane.xyz ) > plane.w ) discard;
		}
		#pragma unroll_loop_end
		#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES
			bool clipped = true;
			#pragma unroll_loop_start
			for ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {
				plane = clippingPlanes[ i ];
				clipped = ( dot( vClipPosition, plane.xyz ) > plane.w ) && clipped;
			}
			#pragma unroll_loop_end
			if ( clipped ) discard;
		#endif
	#endif
#endif`,Fht=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
	uniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];
#endif`,Bht=`#if NUM_CLIPPING_PLANES > 0
	varying vec3 vClipPosition;
#endif`,Uht=`#if NUM_CLIPPING_PLANES > 0
	vClipPosition = - mvPosition.xyz;
#endif`,zht=`#if defined( USE_COLOR_ALPHA )
	diffuseColor *= vColor;
#elif defined( USE_COLOR )
	diffuseColor.rgb *= vColor;
#endif`,kht=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR )
	varying vec3 vColor;
#endif`,Ght=`#if defined( USE_COLOR_ALPHA )
	varying vec4 vColor;
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	varying vec3 vColor;
#endif`,Vht=`#if defined( USE_COLOR_ALPHA )
	vColor = vec4( 1.0 );
#elif defined( USE_COLOR ) || defined( USE_INSTANCING_COLOR ) || defined( USE_BATCHING_COLOR )
	vColor = vec3( 1.0 );
#endif
#ifdef USE_COLOR
	vColor *= color;
#endif
#ifdef USE_INSTANCING_COLOR
	vColor.xyz *= instanceColor.xyz;
#endif
#ifdef USE_BATCHING_COLOR
	vec3 batchingColor = getBatchingColor( getIndirectIndex( gl_DrawID ) );
	vColor.xyz *= batchingColor.xyz;
#endif`,Hht=`#define PI 3.141592653589793
#define PI2 6.283185307179586
#define PI_HALF 1.5707963267948966
#define RECIPROCAL_PI 0.3183098861837907
#define RECIPROCAL_PI2 0.15915494309189535
#define EPSILON 1e-6
#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
#define whiteComplement( a ) ( 1.0 - saturate( a ) )
float pow2( const in float x ) { return x*x; }
vec3 pow2( const in vec3 x ) { return x*x; }
float pow3( const in float x ) { return x*x*x; }
float pow4( const in float x ) { float x2 = x*x; return x2*x2; }
float max3( const in vec3 v ) { return max( max( v.x, v.y ), v.z ); }
float average( const in vec3 v ) { return dot( v, vec3( 0.3333333 ) ); }
highp float rand( const in vec2 uv ) {
	const highp float a = 12.9898, b = 78.233, c = 43758.5453;
	highp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );
	return fract( sin( sn ) * c );
}
#ifdef HIGH_PRECISION
	float precisionSafeLength( vec3 v ) { return length( v ); }
#else
	float precisionSafeLength( vec3 v ) {
		float maxComponent = max3( abs( v ) );
		return length( v / maxComponent ) * maxComponent;
	}
#endif
struct IncidentLight {
	vec3 color;
	vec3 direction;
	bool visible;
};
struct ReflectedLight {
	vec3 directDiffuse;
	vec3 directSpecular;
	vec3 indirectDiffuse;
	vec3 indirectSpecular;
};
#ifdef USE_ALPHAHASH
	varying vec3 vPosition;
#endif
vec3 transformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );
}
vec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {
	return normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );
}
mat3 transposeMat3( const in mat3 m ) {
	mat3 tmp;
	tmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );
	tmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );
	tmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );
	return tmp;
}
bool isPerspectiveMatrix( mat4 m ) {
	return m[ 2 ][ 3 ] == - 1.0;
}
vec2 equirectUv( in vec3 dir ) {
	float u = atan( dir.z, dir.x ) * RECIPROCAL_PI2 + 0.5;
	float v = asin( clamp( dir.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;
	return vec2( u, v );
}
vec3 BRDF_Lambert( const in vec3 diffuseColor ) {
	return RECIPROCAL_PI * diffuseColor;
}
vec3 F_Schlick( const in vec3 f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
}
float F_Schlick( const in float f0, const in float f90, const in float dotVH ) {
	float fresnel = exp2( ( - 5.55473 * dotVH - 6.98316 ) * dotVH );
	return f0 * ( 1.0 - fresnel ) + ( f90 * fresnel );
} // validated`,Wht=`#ifdef ENVMAP_TYPE_CUBE_UV
	#define cubeUV_minMipLevel 4.0
	#define cubeUV_minTileSize 16.0
	float getFace( vec3 direction ) {
		vec3 absDirection = abs( direction );
		float face = - 1.0;
		if ( absDirection.x > absDirection.z ) {
			if ( absDirection.x > absDirection.y )
				face = direction.x > 0.0 ? 0.0 : 3.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		} else {
			if ( absDirection.z > absDirection.y )
				face = direction.z > 0.0 ? 2.0 : 5.0;
			else
				face = direction.y > 0.0 ? 1.0 : 4.0;
		}
		return face;
	}
	vec2 getUV( vec3 direction, float face ) {
		vec2 uv;
		if ( face == 0.0 ) {
			uv = vec2( direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 1.0 ) {
			uv = vec2( - direction.x, - direction.z ) / abs( direction.y );
		} else if ( face == 2.0 ) {
			uv = vec2( - direction.x, direction.y ) / abs( direction.z );
		} else if ( face == 3.0 ) {
			uv = vec2( - direction.z, direction.y ) / abs( direction.x );
		} else if ( face == 4.0 ) {
			uv = vec2( - direction.x, direction.z ) / abs( direction.y );
		} else {
			uv = vec2( direction.x, direction.y ) / abs( direction.z );
		}
		return 0.5 * ( uv + 1.0 );
	}
	vec3 bilinearCubeUV( sampler2D envMap, vec3 direction, float mipInt ) {
		float face = getFace( direction );
		float filterInt = max( cubeUV_minMipLevel - mipInt, 0.0 );
		mipInt = max( mipInt, cubeUV_minMipLevel );
		float faceSize = exp2( mipInt );
		highp vec2 uv = getUV( direction, face ) * ( faceSize - 2.0 ) + 1.0;
		if ( face > 2.0 ) {
			uv.y += faceSize;
			face -= 3.0;
		}
		uv.x += face * faceSize;
		uv.x += filterInt * 3.0 * cubeUV_minTileSize;
		uv.y += 4.0 * ( exp2( CUBEUV_MAX_MIP ) - faceSize );
		uv.x *= CUBEUV_TEXEL_WIDTH;
		uv.y *= CUBEUV_TEXEL_HEIGHT;
		#ifdef texture2DGradEXT
			return texture2DGradEXT( envMap, uv, vec2( 0.0 ), vec2( 0.0 ) ).rgb;
		#else
			return texture2D( envMap, uv ).rgb;
		#endif
	}
	#define cubeUV_r0 1.0
	#define cubeUV_m0 - 2.0
	#define cubeUV_r1 0.8
	#define cubeUV_m1 - 1.0
	#define cubeUV_r4 0.4
	#define cubeUV_m4 2.0
	#define cubeUV_r5 0.305
	#define cubeUV_m5 3.0
	#define cubeUV_r6 0.21
	#define cubeUV_m6 4.0
	float roughnessToMip( float roughness ) {
		float mip = 0.0;
		if ( roughness >= cubeUV_r1 ) {
			mip = ( cubeUV_r0 - roughness ) * ( cubeUV_m1 - cubeUV_m0 ) / ( cubeUV_r0 - cubeUV_r1 ) + cubeUV_m0;
		} else if ( roughness >= cubeUV_r4 ) {
			mip = ( cubeUV_r1 - roughness ) * ( cubeUV_m4 - cubeUV_m1 ) / ( cubeUV_r1 - cubeUV_r4 ) + cubeUV_m1;
		} else if ( roughness >= cubeUV_r5 ) {
			mip = ( cubeUV_r4 - roughness ) * ( cubeUV_m5 - cubeUV_m4 ) / ( cubeUV_r4 - cubeUV_r5 ) + cubeUV_m4;
		} else if ( roughness >= cubeUV_r6 ) {
			mip = ( cubeUV_r5 - roughness ) * ( cubeUV_m6 - cubeUV_m5 ) / ( cubeUV_r5 - cubeUV_r6 ) + cubeUV_m5;
		} else {
			mip = - 2.0 * log2( 1.16 * roughness );		}
		return mip;
	}
	vec4 textureCubeUV( sampler2D envMap, vec3 sampleDir, float roughness ) {
		float mip = clamp( roughnessToMip( roughness ), cubeUV_m0, CUBEUV_MAX_MIP );
		float mipF = fract( mip );
		float mipInt = floor( mip );
		vec3 color0 = bilinearCubeUV( envMap, sampleDir, mipInt );
		if ( mipF == 0.0 ) {
			return vec4( color0, 1.0 );
		} else {
			vec3 color1 = bilinearCubeUV( envMap, sampleDir, mipInt + 1.0 );
			return vec4( mix( color0, color1, mipF ), 1.0 );
		}
	}
#endif`,Xht=`vec3 transformedNormal = objectNormal;
#ifdef USE_TANGENT
	vec3 transformedTangent = objectTangent;
#endif
#ifdef USE_BATCHING
	mat3 bm = mat3( batchingMatrix );
	transformedNormal /= vec3( dot( bm[ 0 ], bm[ 0 ] ), dot( bm[ 1 ], bm[ 1 ] ), dot( bm[ 2 ], bm[ 2 ] ) );
	transformedNormal = bm * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = bm * transformedTangent;
	#endif
#endif
#ifdef USE_INSTANCING
	mat3 im = mat3( instanceMatrix );
	transformedNormal /= vec3( dot( im[ 0 ], im[ 0 ] ), dot( im[ 1 ], im[ 1 ] ), dot( im[ 2 ], im[ 2 ] ) );
	transformedNormal = im * transformedNormal;
	#ifdef USE_TANGENT
		transformedTangent = im * transformedTangent;
	#endif
#endif
transformedNormal = normalMatrix * transformedNormal;
#ifdef FLIP_SIDED
	transformedNormal = - transformedNormal;
#endif
#ifdef USE_TANGENT
	transformedTangent = ( modelViewMatrix * vec4( transformedTangent, 0.0 ) ).xyz;
	#ifdef FLIP_SIDED
		transformedTangent = - transformedTangent;
	#endif
#endif`,Yht=`#ifdef USE_DISPLACEMENTMAP
	uniform sampler2D displacementMap;
	uniform float displacementScale;
	uniform float displacementBias;
#endif`,Zht=`#ifdef USE_DISPLACEMENTMAP
	transformed += normalize( objectNormal ) * ( texture2D( displacementMap, vDisplacementMapUv ).x * displacementScale + displacementBias );
#endif`,qht=`#ifdef USE_EMISSIVEMAP
	vec4 emissiveColor = texture2D( emissiveMap, vEmissiveMapUv );
	#ifdef DECODE_VIDEO_TEXTURE_EMISSIVE
		emissiveColor = sRGBTransferEOTF( emissiveColor );
	#endif
	totalEmissiveRadiance *= emissiveColor.rgb;
#endif`,$ht=`#ifdef USE_EMISSIVEMAP
	uniform sampler2D emissiveMap;
#endif`,Kht="gl_FragColor = linearToOutputTexel( gl_FragColor );",jht=`vec4 LinearTransferOETF( in vec4 value ) {
	return value;
}
vec4 sRGBTransferEOTF( in vec4 value ) {
	return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.a );
}
vec4 sRGBTransferOETF( in vec4 value ) {
	return vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.a );
}`,Jht=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vec3 cameraToFrag;
		if ( isOrthographic ) {
			cameraToFrag = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToFrag = normalize( vWorldPosition - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vec3 reflectVec = reflect( cameraToFrag, worldNormal );
		#else
			vec3 reflectVec = refract( cameraToFrag, worldNormal, refractionRatio );
		#endif
	#else
		vec3 reflectVec = vReflect;
	#endif
	#ifdef ENVMAP_TYPE_CUBE
		vec4 envColor = textureCube( envMap, envMapRotation * vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );
	#else
		vec4 envColor = vec4( 0.0 );
	#endif
	#ifdef ENVMAP_BLENDING_MULTIPLY
		outgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_MIX )
		outgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );
	#elif defined( ENVMAP_BLENDING_ADD )
		outgoingLight += envColor.xyz * specularStrength * reflectivity;
	#endif
#endif`,Qht=`#ifdef USE_ENVMAP
	uniform float envMapIntensity;
	uniform float flipEnvMap;
	uniform mat3 envMapRotation;
	#ifdef ENVMAP_TYPE_CUBE
		uniform samplerCube envMap;
	#else
		uniform sampler2D envMap;
	#endif
	
#endif`,tft=`#ifdef USE_ENVMAP
	uniform float reflectivity;
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		varying vec3 vWorldPosition;
		uniform float refractionRatio;
	#else
		varying vec3 vReflect;
	#endif
#endif`,eft=`#ifdef USE_ENVMAP
	#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( LAMBERT )
		#define ENV_WORLDPOS
	#endif
	#ifdef ENV_WORLDPOS
		
		varying vec3 vWorldPosition;
	#else
		varying vec3 vReflect;
		uniform float refractionRatio;
	#endif
#endif`,rft=`#ifdef USE_ENVMAP
	#ifdef ENV_WORLDPOS
		vWorldPosition = worldPosition.xyz;
	#else
		vec3 cameraToVertex;
		if ( isOrthographic ) {
			cameraToVertex = normalize( vec3( - viewMatrix[ 0 ][ 2 ], - viewMatrix[ 1 ][ 2 ], - viewMatrix[ 2 ][ 2 ] ) );
		} else {
			cameraToVertex = normalize( worldPosition.xyz - cameraPosition );
		}
		vec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
		#ifdef ENVMAP_MODE_REFLECTION
			vReflect = reflect( cameraToVertex, worldNormal );
		#else
			vReflect = refract( cameraToVertex, worldNormal, refractionRatio );
		#endif
	#endif
#endif`,nft=`#ifdef USE_FOG
	vFogDepth = - mvPosition.z;
#endif`,ift=`#ifdef USE_FOG
	varying float vFogDepth;
#endif`,aft=`#ifdef USE_FOG
	#ifdef FOG_EXP2
		float fogFactor = 1.0 - exp( - fogDensity * fogDensity * vFogDepth * vFogDepth );
	#else
		float fogFactor = smoothstep( fogNear, fogFar, vFogDepth );
	#endif
	gl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );
#endif`,oft=`#ifdef USE_FOG
	uniform vec3 fogColor;
	varying float vFogDepth;
	#ifdef FOG_EXP2
		uniform float fogDensity;
	#else
		uniform float fogNear;
		uniform float fogFar;
	#endif
#endif`,sft=`#ifdef USE_GRADIENTMAP
	uniform sampler2D gradientMap;
#endif
vec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {
	float dotNL = dot( normal, lightDirection );
	vec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );
	#ifdef USE_GRADIENTMAP
		return vec3( texture2D( gradientMap, coord ).r );
	#else
		vec2 fw = fwidth( coord ) * 0.5;
		return mix( vec3( 0.7 ), vec3( 1.0 ), smoothstep( 0.7 - fw.x, 0.7 + fw.x, coord.x ) );
	#endif
}`,lft=`#ifdef USE_LIGHTMAP
	uniform sampler2D lightMap;
	uniform float lightMapIntensity;
#endif`,uft=`LambertMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularStrength = specularStrength;`,hft=`varying vec3 vViewPosition;
struct LambertMaterial {
	vec3 diffuseColor;
	float specularStrength;
};
void RE_Direct_Lambert( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Lambert( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in LambertMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Lambert
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Lambert`,fft=`uniform bool receiveShadow;
uniform vec3 ambientLightColor;
#if defined( USE_LIGHT_PROBES )
	uniform vec3 lightProbe[ 9 ];
#endif
vec3 shGetIrradianceAt( in vec3 normal, in vec3 shCoefficients[ 9 ] ) {
	float x = normal.x, y = normal.y, z = normal.z;
	vec3 result = shCoefficients[ 0 ] * 0.886227;
	result += shCoefficients[ 1 ] * 2.0 * 0.511664 * y;
	result += shCoefficients[ 2 ] * 2.0 * 0.511664 * z;
	result += shCoefficients[ 3 ] * 2.0 * 0.511664 * x;
	result += shCoefficients[ 4 ] * 2.0 * 0.429043 * x * y;
	result += shCoefficients[ 5 ] * 2.0 * 0.429043 * y * z;
	result += shCoefficients[ 6 ] * ( 0.743125 * z * z - 0.247708 );
	result += shCoefficients[ 7 ] * 2.0 * 0.429043 * x * z;
	result += shCoefficients[ 8 ] * 0.429043 * ( x * x - y * y );
	return result;
}
vec3 getLightProbeIrradiance( const in vec3 lightProbe[ 9 ], const in vec3 normal ) {
	vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
	vec3 irradiance = shGetIrradianceAt( worldNormal, lightProbe );
	return irradiance;
}
vec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {
	vec3 irradiance = ambientLightColor;
	return irradiance;
}
float getDistanceAttenuation( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {
	float distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );
	if ( cutoffDistance > 0.0 ) {
		distanceFalloff *= pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );
	}
	return distanceFalloff;
}
float getSpotAttenuation( const in float coneCosine, const in float penumbraCosine, const in float angleCosine ) {
	return smoothstep( coneCosine, penumbraCosine, angleCosine );
}
#if NUM_DIR_LIGHTS > 0
	struct DirectionalLight {
		vec3 direction;
		vec3 color;
	};
	uniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];
	void getDirectionalLightInfo( const in DirectionalLight directionalLight, out IncidentLight light ) {
		light.color = directionalLight.color;
		light.direction = directionalLight.direction;
		light.visible = true;
	}
#endif
#if NUM_POINT_LIGHTS > 0
	struct PointLight {
		vec3 position;
		vec3 color;
		float distance;
		float decay;
	};
	uniform PointLight pointLights[ NUM_POINT_LIGHTS ];
	void getPointLightInfo( const in PointLight pointLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = pointLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float lightDistance = length( lVector );
		light.color = pointLight.color;
		light.color *= getDistanceAttenuation( lightDistance, pointLight.distance, pointLight.decay );
		light.visible = ( light.color != vec3( 0.0 ) );
	}
#endif
#if NUM_SPOT_LIGHTS > 0
	struct SpotLight {
		vec3 position;
		vec3 direction;
		vec3 color;
		float distance;
		float decay;
		float coneCos;
		float penumbraCos;
	};
	uniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];
	void getSpotLightInfo( const in SpotLight spotLight, const in vec3 geometryPosition, out IncidentLight light ) {
		vec3 lVector = spotLight.position - geometryPosition;
		light.direction = normalize( lVector );
		float angleCos = dot( light.direction, spotLight.direction );
		float spotAttenuation = getSpotAttenuation( spotLight.coneCos, spotLight.penumbraCos, angleCos );
		if ( spotAttenuation > 0.0 ) {
			float lightDistance = length( lVector );
			light.color = spotLight.color * spotAttenuation;
			light.color *= getDistanceAttenuation( lightDistance, spotLight.distance, spotLight.decay );
			light.visible = ( light.color != vec3( 0.0 ) );
		} else {
			light.color = vec3( 0.0 );
			light.visible = false;
		}
	}
#endif
#if NUM_RECT_AREA_LIGHTS > 0
	struct RectAreaLight {
		vec3 color;
		vec3 position;
		vec3 halfWidth;
		vec3 halfHeight;
	};
	uniform sampler2D ltc_1;	uniform sampler2D ltc_2;
	uniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];
#endif
#if NUM_HEMI_LIGHTS > 0
	struct HemisphereLight {
		vec3 direction;
		vec3 skyColor;
		vec3 groundColor;
	};
	uniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];
	vec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in vec3 normal ) {
		float dotNL = dot( normal, hemiLight.direction );
		float hemiDiffuseWeight = 0.5 * dotNL + 0.5;
		vec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );
		return irradiance;
	}
#endif`,cft=`#ifdef USE_ENVMAP
	vec3 getIBLIrradiance( const in vec3 normal ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 worldNormal = inverseTransformDirection( normal, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * worldNormal, 1.0 );
			return PI * envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	vec3 getIBLRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness ) {
		#ifdef ENVMAP_TYPE_CUBE_UV
			vec3 reflectVec = reflect( - viewDir, normal );
			reflectVec = normalize( mix( reflectVec, normal, roughness * roughness) );
			reflectVec = inverseTransformDirection( reflectVec, viewMatrix );
			vec4 envMapColor = textureCubeUV( envMap, envMapRotation * reflectVec, roughness );
			return envMapColor.rgb * envMapIntensity;
		#else
			return vec3( 0.0 );
		#endif
	}
	#ifdef USE_ANISOTROPY
		vec3 getIBLAnisotropyRadiance( const in vec3 viewDir, const in vec3 normal, const in float roughness, const in vec3 bitangent, const in float anisotropy ) {
			#ifdef ENVMAP_TYPE_CUBE_UV
				vec3 bentNormal = cross( bitangent, viewDir );
				bentNormal = normalize( cross( bentNormal, bitangent ) );
				bentNormal = normalize( mix( bentNormal, normal, pow2( pow2( 1.0 - anisotropy * ( 1.0 - roughness ) ) ) ) );
				return getIBLRadiance( viewDir, bentNormal, roughness );
			#else
				return vec3( 0.0 );
			#endif
		}
	#endif
#endif`,dft=`ToonMaterial material;
material.diffuseColor = diffuseColor.rgb;`,vft=`varying vec3 vViewPosition;
struct ToonMaterial {
	vec3 diffuseColor;
};
void RE_Direct_Toon( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	vec3 irradiance = getGradientIrradiance( geometryNormal, directLight.direction ) * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Toon( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in ToonMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_Toon
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Toon`,pft=`BlinnPhongMaterial material;
material.diffuseColor = diffuseColor.rgb;
material.specularColor = specular;
material.specularShininess = shininess;
material.specularStrength = specularStrength;`,gft=`varying vec3 vViewPosition;
struct BlinnPhongMaterial {
	vec3 diffuseColor;
	vec3 specularColor;
	float specularShininess;
	float specularStrength;
};
void RE_Direct_BlinnPhong( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
	reflectedLight.directSpecular += irradiance * BRDF_BlinnPhong( directLight.direction, geometryViewDir, geometryNormal, material.specularColor, material.specularShininess ) * material.specularStrength;
}
void RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
#define RE_Direct				RE_Direct_BlinnPhong
#define RE_IndirectDiffuse		RE_IndirectDiffuse_BlinnPhong`,mft=`PhysicalMaterial material;
material.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );
vec3 dxy = max( abs( dFdx( nonPerturbedNormal ) ), abs( dFdy( nonPerturbedNormal ) ) );
float geometryRoughness = max( max( dxy.x, dxy.y ), dxy.z );
material.roughness = max( roughnessFactor, 0.0525 );material.roughness += geometryRoughness;
material.roughness = min( material.roughness, 1.0 );
#ifdef IOR
	material.ior = ior;
	#ifdef USE_SPECULAR
		float specularIntensityFactor = specularIntensity;
		vec3 specularColorFactor = specularColor;
		#ifdef USE_SPECULAR_COLORMAP
			specularColorFactor *= texture2D( specularColorMap, vSpecularColorMapUv ).rgb;
		#endif
		#ifdef USE_SPECULAR_INTENSITYMAP
			specularIntensityFactor *= texture2D( specularIntensityMap, vSpecularIntensityMapUv ).a;
		#endif
		material.specularF90 = mix( specularIntensityFactor, 1.0, metalnessFactor );
	#else
		float specularIntensityFactor = 1.0;
		vec3 specularColorFactor = vec3( 1.0 );
		material.specularF90 = 1.0;
	#endif
	material.specularColor = mix( min( pow2( ( material.ior - 1.0 ) / ( material.ior + 1.0 ) ) * specularColorFactor, vec3( 1.0 ) ) * specularIntensityFactor, diffuseColor.rgb, metalnessFactor );
#else
	material.specularColor = mix( vec3( 0.04 ), diffuseColor.rgb, metalnessFactor );
	material.specularF90 = 1.0;
#endif
#ifdef USE_CLEARCOAT
	material.clearcoat = clearcoat;
	material.clearcoatRoughness = clearcoatRoughness;
	material.clearcoatF0 = vec3( 0.04 );
	material.clearcoatF90 = 1.0;
	#ifdef USE_CLEARCOATMAP
		material.clearcoat *= texture2D( clearcoatMap, vClearcoatMapUv ).x;
	#endif
	#ifdef USE_CLEARCOAT_ROUGHNESSMAP
		material.clearcoatRoughness *= texture2D( clearcoatRoughnessMap, vClearcoatRoughnessMapUv ).y;
	#endif
	material.clearcoat = saturate( material.clearcoat );	material.clearcoatRoughness = max( material.clearcoatRoughness, 0.0525 );
	material.clearcoatRoughness += geometryRoughness;
	material.clearcoatRoughness = min( material.clearcoatRoughness, 1.0 );
#endif
#ifdef USE_DISPERSION
	material.dispersion = dispersion;
#endif
#ifdef USE_IRIDESCENCE
	material.iridescence = iridescence;
	material.iridescenceIOR = iridescenceIOR;
	#ifdef USE_IRIDESCENCEMAP
		material.iridescence *= texture2D( iridescenceMap, vIridescenceMapUv ).r;
	#endif
	#ifdef USE_IRIDESCENCE_THICKNESSMAP
		material.iridescenceThickness = (iridescenceThicknessMaximum - iridescenceThicknessMinimum) * texture2D( iridescenceThicknessMap, vIridescenceThicknessMapUv ).g + iridescenceThicknessMinimum;
	#else
		material.iridescenceThickness = iridescenceThicknessMaximum;
	#endif
#endif
#ifdef USE_SHEEN
	material.sheenColor = sheenColor;
	#ifdef USE_SHEEN_COLORMAP
		material.sheenColor *= texture2D( sheenColorMap, vSheenColorMapUv ).rgb;
	#endif
	material.sheenRoughness = clamp( sheenRoughness, 0.07, 1.0 );
	#ifdef USE_SHEEN_ROUGHNESSMAP
		material.sheenRoughness *= texture2D( sheenRoughnessMap, vSheenRoughnessMapUv ).a;
	#endif
#endif
#ifdef USE_ANISOTROPY
	#ifdef USE_ANISOTROPYMAP
		mat2 anisotropyMat = mat2( anisotropyVector.x, anisotropyVector.y, - anisotropyVector.y, anisotropyVector.x );
		vec3 anisotropyPolar = texture2D( anisotropyMap, vAnisotropyMapUv ).rgb;
		vec2 anisotropyV = anisotropyMat * normalize( 2.0 * anisotropyPolar.rg - vec2( 1.0 ) ) * anisotropyPolar.b;
	#else
		vec2 anisotropyV = anisotropyVector;
	#endif
	material.anisotropy = length( anisotropyV );
	if( material.anisotropy == 0.0 ) {
		anisotropyV = vec2( 1.0, 0.0 );
	} else {
		anisotropyV /= material.anisotropy;
		material.anisotropy = saturate( material.anisotropy );
	}
	material.alphaT = mix( pow2( material.roughness ), 1.0, pow2( material.anisotropy ) );
	material.anisotropyT = tbn[ 0 ] * anisotropyV.x + tbn[ 1 ] * anisotropyV.y;
	material.anisotropyB = tbn[ 1 ] * anisotropyV.x - tbn[ 0 ] * anisotropyV.y;
#endif`,_ft=`struct PhysicalMaterial {
	vec3 diffuseColor;
	float roughness;
	vec3 specularColor;
	float specularF90;
	float dispersion;
	#ifdef USE_CLEARCOAT
		float clearcoat;
		float clearcoatRoughness;
		vec3 clearcoatF0;
		float clearcoatF90;
	#endif
	#ifdef USE_IRIDESCENCE
		float iridescence;
		float iridescenceIOR;
		float iridescenceThickness;
		vec3 iridescenceFresnel;
		vec3 iridescenceF0;
	#endif
	#ifdef USE_SHEEN
		vec3 sheenColor;
		float sheenRoughness;
	#endif
	#ifdef IOR
		float ior;
	#endif
	#ifdef USE_TRANSMISSION
		float transmission;
		float transmissionAlpha;
		float thickness;
		float attenuationDistance;
		vec3 attenuationColor;
	#endif
	#ifdef USE_ANISOTROPY
		float anisotropy;
		float alphaT;
		vec3 anisotropyT;
		vec3 anisotropyB;
	#endif
};
vec3 clearcoatSpecularDirect = vec3( 0.0 );
vec3 clearcoatSpecularIndirect = vec3( 0.0 );
vec3 sheenSpecularDirect = vec3( 0.0 );
vec3 sheenSpecularIndirect = vec3(0.0 );
vec3 Schlick_to_F0( const in vec3 f, const in float f90, const in float dotVH ) {
    float x = clamp( 1.0 - dotVH, 0.0, 1.0 );
    float x2 = x * x;
    float x5 = clamp( x * x2 * x2, 0.0, 0.9999 );
    return ( f - vec3( f90 ) * x5 ) / ( 1.0 - x5 );
}
float V_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {
	float a2 = pow2( alpha );
	float gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );
	float gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );
	return 0.5 / max( gv + gl, EPSILON );
}
float D_GGX( const in float alpha, const in float dotNH ) {
	float a2 = pow2( alpha );
	float denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;
	return RECIPROCAL_PI * a2 / pow2( denom );
}
#ifdef USE_ANISOTROPY
	float V_GGX_SmithCorrelated_Anisotropic( const in float alphaT, const in float alphaB, const in float dotTV, const in float dotBV, const in float dotTL, const in float dotBL, const in float dotNV, const in float dotNL ) {
		float gv = dotNL * length( vec3( alphaT * dotTV, alphaB * dotBV, dotNV ) );
		float gl = dotNV * length( vec3( alphaT * dotTL, alphaB * dotBL, dotNL ) );
		float v = 0.5 / ( gv + gl );
		return saturate(v);
	}
	float D_GGX_Anisotropic( const in float alphaT, const in float alphaB, const in float dotNH, const in float dotTH, const in float dotBH ) {
		float a2 = alphaT * alphaB;
		highp vec3 v = vec3( alphaB * dotTH, alphaT * dotBH, a2 * dotNH );
		highp float v2 = dot( v, v );
		float w2 = a2 / v2;
		return RECIPROCAL_PI * a2 * pow2 ( w2 );
	}
#endif
#ifdef USE_CLEARCOAT
	vec3 BRDF_GGX_Clearcoat( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material) {
		vec3 f0 = material.clearcoatF0;
		float f90 = material.clearcoatF90;
		float roughness = material.clearcoatRoughness;
		float alpha = pow2( roughness );
		vec3 halfDir = normalize( lightDir + viewDir );
		float dotNL = saturate( dot( normal, lightDir ) );
		float dotNV = saturate( dot( normal, viewDir ) );
		float dotNH = saturate( dot( normal, halfDir ) );
		float dotVH = saturate( dot( viewDir, halfDir ) );
		vec3 F = F_Schlick( f0, f90, dotVH );
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
		return F * ( V * D );
	}
#endif
vec3 BRDF_GGX( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, const in PhysicalMaterial material ) {
	vec3 f0 = material.specularColor;
	float f90 = material.specularF90;
	float roughness = material.roughness;
	float alpha = pow2( roughness );
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float dotVH = saturate( dot( viewDir, halfDir ) );
	vec3 F = F_Schlick( f0, f90, dotVH );
	#ifdef USE_IRIDESCENCE
		F = mix( F, material.iridescenceFresnel, material.iridescence );
	#endif
	#ifdef USE_ANISOTROPY
		float dotTL = dot( material.anisotropyT, lightDir );
		float dotTV = dot( material.anisotropyT, viewDir );
		float dotTH = dot( material.anisotropyT, halfDir );
		float dotBL = dot( material.anisotropyB, lightDir );
		float dotBV = dot( material.anisotropyB, viewDir );
		float dotBH = dot( material.anisotropyB, halfDir );
		float V = V_GGX_SmithCorrelated_Anisotropic( material.alphaT, alpha, dotTV, dotBV, dotTL, dotBL, dotNV, dotNL );
		float D = D_GGX_Anisotropic( material.alphaT, alpha, dotNH, dotTH, dotBH );
	#else
		float V = V_GGX_SmithCorrelated( alpha, dotNL, dotNV );
		float D = D_GGX( alpha, dotNH );
	#endif
	return F * ( V * D );
}
vec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {
	const float LUT_SIZE = 64.0;
	const float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;
	const float LUT_BIAS = 0.5 / LUT_SIZE;
	float dotNV = saturate( dot( N, V ) );
	vec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );
	uv = uv * LUT_SCALE + LUT_BIAS;
	return uv;
}
float LTC_ClippedSphereFormFactor( const in vec3 f ) {
	float l = length( f );
	return max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );
}
vec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {
	float x = dot( v1, v2 );
	float y = abs( x );
	float a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;
	float b = 3.4175940 + ( 4.1616724 + y ) * y;
	float v = a / b;
	float theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;
	return cross( v1, v2 ) * theta_sintheta;
}
vec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {
	vec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];
	vec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];
	vec3 lightNormal = cross( v1, v2 );
	if( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );
	vec3 T1, T2;
	T1 = normalize( V - N * dot( V, N ) );
	T2 = - cross( N, T1 );
	mat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );
	vec3 coords[ 4 ];
	coords[ 0 ] = mat * ( rectCoords[ 0 ] - P );
	coords[ 1 ] = mat * ( rectCoords[ 1 ] - P );
	coords[ 2 ] = mat * ( rectCoords[ 2 ] - P );
	coords[ 3 ] = mat * ( rectCoords[ 3 ] - P );
	coords[ 0 ] = normalize( coords[ 0 ] );
	coords[ 1 ] = normalize( coords[ 1 ] );
	coords[ 2 ] = normalize( coords[ 2 ] );
	coords[ 3 ] = normalize( coords[ 3 ] );
	vec3 vectorFormFactor = vec3( 0.0 );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );
	vectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );
	float result = LTC_ClippedSphereFormFactor( vectorFormFactor );
	return vec3( result );
}
#if defined( USE_SHEEN )
float D_Charlie( float roughness, float dotNH ) {
	float alpha = pow2( roughness );
	float invAlpha = 1.0 / alpha;
	float cos2h = dotNH * dotNH;
	float sin2h = max( 1.0 - cos2h, 0.0078125 );
	return ( 2.0 + invAlpha ) * pow( sin2h, invAlpha * 0.5 ) / ( 2.0 * PI );
}
float V_Neubelt( float dotNV, float dotNL ) {
	return saturate( 1.0 / ( 4.0 * ( dotNL + dotNV - dotNL * dotNV ) ) );
}
vec3 BRDF_Sheen( const in vec3 lightDir, const in vec3 viewDir, const in vec3 normal, vec3 sheenColor, const in float sheenRoughness ) {
	vec3 halfDir = normalize( lightDir + viewDir );
	float dotNL = saturate( dot( normal, lightDir ) );
	float dotNV = saturate( dot( normal, viewDir ) );
	float dotNH = saturate( dot( normal, halfDir ) );
	float D = D_Charlie( sheenRoughness, dotNH );
	float V = V_Neubelt( dotNV, dotNL );
	return sheenColor * ( D * V );
}
#endif
float IBLSheenBRDF( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	float r2 = roughness * roughness;
	float a = roughness < 0.25 ? -339.2 * r2 + 161.4 * roughness - 25.9 : -8.48 * r2 + 14.3 * roughness - 9.95;
	float b = roughness < 0.25 ? 44.0 * r2 - 23.7 * roughness + 3.26 : 1.97 * r2 - 3.27 * roughness + 0.72;
	float DG = exp( a * dotNV + b ) + ( roughness < 0.25 ? 0.0 : 0.1 * ( roughness - 0.25 ) );
	return saturate( DG * RECIPROCAL_PI );
}
vec2 DFGApprox( const in vec3 normal, const in vec3 viewDir, const in float roughness ) {
	float dotNV = saturate( dot( normal, viewDir ) );
	const vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );
	const vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );
	vec4 r = roughness * c0 + c1;
	float a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;
	vec2 fab = vec2( - 1.04, 1.04 ) * a004 + r.zw;
	return fab;
}
vec3 EnvironmentBRDF( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness ) {
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	return specularColor * fab.x + specularF90 * fab.y;
}
#ifdef USE_IRIDESCENCE
void computeMultiscatteringIridescence( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float iridescence, const in vec3 iridescenceF0, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#else
void computeMultiscattering( const in vec3 normal, const in vec3 viewDir, const in vec3 specularColor, const in float specularF90, const in float roughness, inout vec3 singleScatter, inout vec3 multiScatter ) {
#endif
	vec2 fab = DFGApprox( normal, viewDir, roughness );
	#ifdef USE_IRIDESCENCE
		vec3 Fr = mix( specularColor, iridescenceF0, iridescence );
	#else
		vec3 Fr = specularColor;
	#endif
	vec3 FssEss = Fr * fab.x + specularF90 * fab.y;
	float Ess = fab.x + fab.y;
	float Ems = 1.0 - Ess;
	vec3 Favg = Fr + ( 1.0 - Fr ) * 0.047619;	vec3 Fms = FssEss * Favg / ( 1.0 - Ems * Favg );
	singleScatter += FssEss;
	multiScatter += Fms * Ems;
}
#if NUM_RECT_AREA_LIGHTS > 0
	void RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
		vec3 normal = geometryNormal;
		vec3 viewDir = geometryViewDir;
		vec3 position = geometryPosition;
		vec3 lightPos = rectAreaLight.position;
		vec3 halfWidth = rectAreaLight.halfWidth;
		vec3 halfHeight = rectAreaLight.halfHeight;
		vec3 lightColor = rectAreaLight.color;
		float roughness = material.roughness;
		vec3 rectCoords[ 4 ];
		rectCoords[ 0 ] = lightPos + halfWidth - halfHeight;		rectCoords[ 1 ] = lightPos - halfWidth - halfHeight;
		rectCoords[ 2 ] = lightPos - halfWidth + halfHeight;
		rectCoords[ 3 ] = lightPos + halfWidth + halfHeight;
		vec2 uv = LTC_Uv( normal, viewDir, roughness );
		vec4 t1 = texture2D( ltc_1, uv );
		vec4 t2 = texture2D( ltc_2, uv );
		mat3 mInv = mat3(
			vec3( t1.x, 0, t1.y ),
			vec3(    0, 1,    0 ),
			vec3( t1.z, 0, t1.w )
		);
		vec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );
		reflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );
		reflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );
	}
#endif
void RE_Direct_Physical( const in IncidentLight directLight, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	float dotNL = saturate( dot( geometryNormal, directLight.direction ) );
	vec3 irradiance = dotNL * directLight.color;
	#ifdef USE_CLEARCOAT
		float dotNLcc = saturate( dot( geometryClearcoatNormal, directLight.direction ) );
		vec3 ccIrradiance = dotNLcc * directLight.color;
		clearcoatSpecularDirect += ccIrradiance * BRDF_GGX_Clearcoat( directLight.direction, geometryViewDir, geometryClearcoatNormal, material );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularDirect += irradiance * BRDF_Sheen( directLight.direction, geometryViewDir, geometryNormal, material.sheenColor, material.sheenRoughness );
	#endif
	reflectedLight.directSpecular += irradiance * BRDF_GGX( directLight.direction, geometryViewDir, geometryNormal, material );
	reflectedLight.directDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {
	reflectedLight.indirectDiffuse += irradiance * BRDF_Lambert( material.diffuseColor );
}
void RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 irradiance, const in vec3 clearcoatRadiance, const in vec3 geometryPosition, const in vec3 geometryNormal, const in vec3 geometryViewDir, const in vec3 geometryClearcoatNormal, const in PhysicalMaterial material, inout ReflectedLight reflectedLight) {
	#ifdef USE_CLEARCOAT
		clearcoatSpecularIndirect += clearcoatRadiance * EnvironmentBRDF( geometryClearcoatNormal, geometryViewDir, material.clearcoatF0, material.clearcoatF90, material.clearcoatRoughness );
	#endif
	#ifdef USE_SHEEN
		sheenSpecularIndirect += irradiance * material.sheenColor * IBLSheenBRDF( geometryNormal, geometryViewDir, material.sheenRoughness );
	#endif
	vec3 singleScattering = vec3( 0.0 );
	vec3 multiScattering = vec3( 0.0 );
	vec3 cosineWeightedIrradiance = irradiance * RECIPROCAL_PI;
	#ifdef USE_IRIDESCENCE
		computeMultiscatteringIridescence( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.iridescence, material.iridescenceFresnel, material.roughness, singleScattering, multiScattering );
	#else
		computeMultiscattering( geometryNormal, geometryViewDir, material.specularColor, material.specularF90, material.roughness, singleScattering, multiScattering );
	#endif
	vec3 totalScattering = singleScattering + multiScattering;
	vec3 diffuse = material.diffuseColor * ( 1.0 - max( max( totalScattering.r, totalScattering.g ), totalScattering.b ) );
	reflectedLight.indirectSpecular += radiance * singleScattering;
	reflectedLight.indirectSpecular += multiScattering * cosineWeightedIrradiance;
	reflectedLight.indirectDiffuse += diffuse * cosineWeightedIrradiance;
}
#define RE_Direct				RE_Direct_Physical
#define RE_Direct_RectArea		RE_Direct_RectArea_Physical
#define RE_IndirectDiffuse		RE_IndirectDiffuse_Physical
#define RE_IndirectSpecular		RE_IndirectSpecular_Physical
float computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {
	return saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );
}`,yft=`
vec3 geometryPosition = - vViewPosition;
vec3 geometryNormal = normal;
vec3 geometryViewDir = ( isOrthographic ) ? vec3( 0, 0, 1 ) : normalize( vViewPosition );
vec3 geometryClearcoatNormal = vec3( 0.0 );
#ifdef USE_CLEARCOAT
	geometryClearcoatNormal = clearcoatNormal;
#endif
#ifdef USE_IRIDESCENCE
	float dotNVi = saturate( dot( normal, geometryViewDir ) );
	if ( material.iridescenceThickness == 0.0 ) {
		material.iridescence = 0.0;
	} else {
		material.iridescence = saturate( material.iridescence );
	}
	if ( material.iridescence > 0.0 ) {
		material.iridescenceFresnel = evalIridescence( 1.0, material.iridescenceIOR, dotNVi, material.iridescenceThickness, material.specularColor );
		material.iridescenceF0 = Schlick_to_F0( material.iridescenceFresnel, 1.0, dotNVi );
	}
#endif
IncidentLight directLight;
#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )
	PointLight pointLight;
	#if defined( USE_SHADOWMAP ) && NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {
		pointLight = pointLights[ i ];
		getPointLightInfo( pointLight, geometryPosition, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_POINT_LIGHT_SHADOWS )
		pointLightShadow = pointLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getPointShadow( pointShadowMap[ i ], pointLightShadow.shadowMapSize, pointLightShadow.shadowIntensity, pointLightShadow.shadowBias, pointLightShadow.shadowRadius, vPointShadowCoord[ i ], pointLightShadow.shadowCameraNear, pointLightShadow.shadowCameraFar ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )
	SpotLight spotLight;
	vec4 spotColor;
	vec3 spotLightCoord;
	bool inSpotLightMap;
	#if defined( USE_SHADOWMAP ) && NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {
		spotLight = spotLights[ i ];
		getSpotLightInfo( spotLight, geometryPosition, directLight );
		#if ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#define SPOT_LIGHT_MAP_INDEX UNROLLED_LOOP_INDEX
		#elif ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		#define SPOT_LIGHT_MAP_INDEX NUM_SPOT_LIGHT_MAPS
		#else
		#define SPOT_LIGHT_MAP_INDEX ( UNROLLED_LOOP_INDEX - NUM_SPOT_LIGHT_SHADOWS + NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS )
		#endif
		#if ( SPOT_LIGHT_MAP_INDEX < NUM_SPOT_LIGHT_MAPS )
			spotLightCoord = vSpotLightCoord[ i ].xyz / vSpotLightCoord[ i ].w;
			inSpotLightMap = all( lessThan( abs( spotLightCoord * 2. - 1. ), vec3( 1.0 ) ) );
			spotColor = texture2D( spotLightMap[ SPOT_LIGHT_MAP_INDEX ], spotLightCoord.xy );
			directLight.color = inSpotLightMap ? directLight.color * spotColor.rgb : directLight.color;
		#endif
		#undef SPOT_LIGHT_MAP_INDEX
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
		spotLightShadow = spotLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( spotShadowMap[ i ], spotLightShadow.shadowMapSize, spotLightShadow.shadowIntensity, spotLightShadow.shadowBias, spotLightShadow.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )
	DirectionalLight directionalLight;
	#if defined( USE_SHADOWMAP ) && NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLightShadow;
	#endif
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {
		directionalLight = directionalLights[ i ];
		getDirectionalLightInfo( directionalLight, directLight );
		#if defined( USE_SHADOWMAP ) && ( UNROLLED_LOOP_INDEX < NUM_DIR_LIGHT_SHADOWS )
		directionalLightShadow = directionalLightShadows[ i ];
		directLight.color *= ( directLight.visible && receiveShadow ) ? getShadow( directionalShadowMap[ i ], directionalLightShadow.shadowMapSize, directionalLightShadow.shadowIntensity, directionalLightShadow.shadowBias, directionalLightShadow.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
		#endif
		RE_Direct( directLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )
	RectAreaLight rectAreaLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {
		rectAreaLight = rectAreaLights[ i ];
		RE_Direct_RectArea( rectAreaLight, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
	}
	#pragma unroll_loop_end
#endif
#if defined( RE_IndirectDiffuse )
	vec3 iblIrradiance = vec3( 0.0 );
	vec3 irradiance = getAmbientLightIrradiance( ambientLightColor );
	#if defined( USE_LIGHT_PROBES )
		irradiance += getLightProbeIrradiance( lightProbe, geometryNormal );
	#endif
	#if ( NUM_HEMI_LIGHTS > 0 )
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {
			irradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometryNormal );
		}
		#pragma unroll_loop_end
	#endif
#endif
#if defined( RE_IndirectSpecular )
	vec3 radiance = vec3( 0.0 );
	vec3 clearcoatRadiance = vec3( 0.0 );
#endif`,xft=`#if defined( RE_IndirectDiffuse )
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		vec3 lightMapIrradiance = lightMapTexel.rgb * lightMapIntensity;
		irradiance += lightMapIrradiance;
	#endif
	#if defined( USE_ENVMAP ) && defined( STANDARD ) && defined( ENVMAP_TYPE_CUBE_UV )
		iblIrradiance += getIBLIrradiance( geometryNormal );
	#endif
#endif
#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )
	#ifdef USE_ANISOTROPY
		radiance += getIBLAnisotropyRadiance( geometryViewDir, geometryNormal, material.roughness, material.anisotropyB, material.anisotropy );
	#else
		radiance += getIBLRadiance( geometryViewDir, geometryNormal, material.roughness );
	#endif
	#ifdef USE_CLEARCOAT
		clearcoatRadiance += getIBLRadiance( geometryViewDir, geometryClearcoatNormal, material.clearcoatRoughness );
	#endif
#endif`,Sft=`#if defined( RE_IndirectDiffuse )
	RE_IndirectDiffuse( irradiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif
#if defined( RE_IndirectSpecular )
	RE_IndirectSpecular( radiance, iblIrradiance, clearcoatRadiance, geometryPosition, geometryNormal, geometryViewDir, geometryClearcoatNormal, material, reflectedLight );
#endif`,Tft=`#if defined( USE_LOGDEPTHBUF )
	gl_FragDepth = vIsPerspective == 0.0 ? gl_FragCoord.z : log2( vFragDepth ) * logDepthBufFC * 0.5;
#endif`,bft=`#if defined( USE_LOGDEPTHBUF )
	uniform float logDepthBufFC;
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,wft=`#ifdef USE_LOGDEPTHBUF
	varying float vFragDepth;
	varying float vIsPerspective;
#endif`,Mft=`#ifdef USE_LOGDEPTHBUF
	vFragDepth = 1.0 + gl_Position.w;
	vIsPerspective = float( isPerspectiveMatrix( projectionMatrix ) );
#endif`,Aft=`#ifdef USE_MAP
	vec4 sampledDiffuseColor = texture2D( map, vMapUv );
	#ifdef DECODE_VIDEO_TEXTURE
		sampledDiffuseColor = sRGBTransferEOTF( sampledDiffuseColor );
	#endif
	diffuseColor *= sampledDiffuseColor;
#endif`,Eft=`#ifdef USE_MAP
	uniform sampler2D map;
#endif`,Cft=`#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
	#if defined( USE_POINTS_UV )
		vec2 uv = vUv;
	#else
		vec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;
	#endif
#endif
#ifdef USE_MAP
	diffuseColor *= texture2D( map, uv );
#endif
#ifdef USE_ALPHAMAP
	diffuseColor.a *= texture2D( alphaMap, uv ).g;
#endif`,Dft=`#if defined( USE_POINTS_UV )
	varying vec2 vUv;
#else
	#if defined( USE_MAP ) || defined( USE_ALPHAMAP )
		uniform mat3 uvTransform;
	#endif
#endif
#ifdef USE_MAP
	uniform sampler2D map;
#endif
#ifdef USE_ALPHAMAP
	uniform sampler2D alphaMap;
#endif`,Lft=`float metalnessFactor = metalness;
#ifdef USE_METALNESSMAP
	vec4 texelMetalness = texture2D( metalnessMap, vMetalnessMapUv );
	metalnessFactor *= texelMetalness.b;
#endif`,Rft=`#ifdef USE_METALNESSMAP
	uniform sampler2D metalnessMap;
#endif`,Pft=`#ifdef USE_INSTANCING_MORPH
	float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	float morphTargetBaseInfluence = texelFetch( morphTexture, ivec2( 0, gl_InstanceID ), 0 ).r;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		morphTargetInfluences[i] =  texelFetch( morphTexture, ivec2( i + 1, gl_InstanceID ), 0 ).r;
	}
#endif`,Ift=`#if defined( USE_MORPHCOLORS )
	vColor *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		#if defined( USE_COLOR_ALPHA )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ) * morphTargetInfluences[ i ];
		#elif defined( USE_COLOR )
			if ( morphTargetInfluences[ i ] != 0.0 ) vColor += getMorph( gl_VertexID, i, 2 ).rgb * morphTargetInfluences[ i ];
		#endif
	}
#endif`,Nft=`#ifdef USE_MORPHNORMALS
	objectNormal *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) objectNormal += getMorph( gl_VertexID, i, 1 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Oft=`#ifdef USE_MORPHTARGETS
	#ifndef USE_INSTANCING_MORPH
		uniform float morphTargetBaseInfluence;
		uniform float morphTargetInfluences[ MORPHTARGETS_COUNT ];
	#endif
	uniform sampler2DArray morphTargetsTexture;
	uniform ivec2 morphTargetsTextureSize;
	vec4 getMorph( const in int vertexIndex, const in int morphTargetIndex, const in int offset ) {
		int texelIndex = vertexIndex * MORPHTARGETS_TEXTURE_STRIDE + offset;
		int y = texelIndex / morphTargetsTextureSize.x;
		int x = texelIndex - y * morphTargetsTextureSize.x;
		ivec3 morphUV = ivec3( x, y, morphTargetIndex );
		return texelFetch( morphTargetsTexture, morphUV, 0 );
	}
#endif`,Fft=`#ifdef USE_MORPHTARGETS
	transformed *= morphTargetBaseInfluence;
	for ( int i = 0; i < MORPHTARGETS_COUNT; i ++ ) {
		if ( morphTargetInfluences[ i ] != 0.0 ) transformed += getMorph( gl_VertexID, i, 0 ).xyz * morphTargetInfluences[ i ];
	}
#endif`,Bft=`float faceDirection = gl_FrontFacing ? 1.0 : - 1.0;
#ifdef FLAT_SHADED
	vec3 fdx = dFdx( vViewPosition );
	vec3 fdy = dFdy( vViewPosition );
	vec3 normal = normalize( cross( fdx, fdy ) );
#else
	vec3 normal = normalize( vNormal );
	#ifdef DOUBLE_SIDED
		normal *= faceDirection;
	#endif
#endif
#if defined( USE_NORMALMAP_TANGENTSPACE ) || defined( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY )
	#ifdef USE_TANGENT
		mat3 tbn = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn = getTangentFrame( - vViewPosition, normal,
		#if defined( USE_NORMALMAP )
			vNormalMapUv
		#elif defined( USE_CLEARCOAT_NORMALMAP )
			vClearcoatNormalMapUv
		#else
			vUv
		#endif
		);
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn[0] *= faceDirection;
		tbn[1] *= faceDirection;
	#endif
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	#ifdef USE_TANGENT
		mat3 tbn2 = mat3( normalize( vTangent ), normalize( vBitangent ), normal );
	#else
		mat3 tbn2 = getTangentFrame( - vViewPosition, normal, vClearcoatNormalMapUv );
	#endif
	#if defined( DOUBLE_SIDED ) && ! defined( FLAT_SHADED )
		tbn2[0] *= faceDirection;
		tbn2[1] *= faceDirection;
	#endif
#endif
vec3 nonPerturbedNormal = normal;`,Uft=`#ifdef USE_NORMALMAP_OBJECTSPACE
	normal = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	#ifdef FLIP_SIDED
		normal = - normal;
	#endif
	#ifdef DOUBLE_SIDED
		normal = normal * faceDirection;
	#endif
	normal = normalize( normalMatrix * normal );
#elif defined( USE_NORMALMAP_TANGENTSPACE )
	vec3 mapN = texture2D( normalMap, vNormalMapUv ).xyz * 2.0 - 1.0;
	mapN.xy *= normalScale;
	normal = normalize( tbn * mapN );
#elif defined( USE_BUMPMAP )
	normal = perturbNormalArb( - vViewPosition, normal, dHdxy_fwd(), faceDirection );
#endif`,zft=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,kft=`#ifndef FLAT_SHADED
	varying vec3 vNormal;
	#ifdef USE_TANGENT
		varying vec3 vTangent;
		varying vec3 vBitangent;
	#endif
#endif`,Gft=`#ifndef FLAT_SHADED
	vNormal = normalize( transformedNormal );
	#ifdef USE_TANGENT
		vTangent = normalize( transformedTangent );
		vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );
	#endif
#endif`,Vft=`#ifdef USE_NORMALMAP
	uniform sampler2D normalMap;
	uniform vec2 normalScale;
#endif
#ifdef USE_NORMALMAP_OBJECTSPACE
	uniform mat3 normalMatrix;
#endif
#if ! defined ( USE_TANGENT ) && ( defined ( USE_NORMALMAP_TANGENTSPACE ) || defined ( USE_CLEARCOAT_NORMALMAP ) || defined( USE_ANISOTROPY ) )
	mat3 getTangentFrame( vec3 eye_pos, vec3 surf_norm, vec2 uv ) {
		vec3 q0 = dFdx( eye_pos.xyz );
		vec3 q1 = dFdy( eye_pos.xyz );
		vec2 st0 = dFdx( uv.st );
		vec2 st1 = dFdy( uv.st );
		vec3 N = surf_norm;
		vec3 q1perp = cross( q1, N );
		vec3 q0perp = cross( N, q0 );
		vec3 T = q1perp * st0.x + q0perp * st1.x;
		vec3 B = q1perp * st0.y + q0perp * st1.y;
		float det = max( dot( T, T ), dot( B, B ) );
		float scale = ( det == 0.0 ) ? 0.0 : inversesqrt( det );
		return mat3( T * scale, B * scale, N );
	}
#endif`,Hft=`#ifdef USE_CLEARCOAT
	vec3 clearcoatNormal = nonPerturbedNormal;
#endif`,Wft=`#ifdef USE_CLEARCOAT_NORMALMAP
	vec3 clearcoatMapN = texture2D( clearcoatNormalMap, vClearcoatNormalMapUv ).xyz * 2.0 - 1.0;
	clearcoatMapN.xy *= clearcoatNormalScale;
	clearcoatNormal = normalize( tbn2 * clearcoatMapN );
#endif`,Xft=`#ifdef USE_CLEARCOATMAP
	uniform sampler2D clearcoatMap;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform sampler2D clearcoatNormalMap;
	uniform vec2 clearcoatNormalScale;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform sampler2D clearcoatRoughnessMap;
#endif`,Yft=`#ifdef USE_IRIDESCENCEMAP
	uniform sampler2D iridescenceMap;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform sampler2D iridescenceThicknessMap;
#endif`,Zft=`#ifdef OPAQUE
diffuseColor.a = 1.0;
#endif
#ifdef USE_TRANSMISSION
diffuseColor.a *= material.transmissionAlpha;
#endif
gl_FragColor = vec4( outgoingLight, diffuseColor.a );`,qft=`vec3 packNormalToRGB( const in vec3 normal ) {
	return normalize( normal ) * 0.5 + 0.5;
}
vec3 unpackRGBToNormal( const in vec3 rgb ) {
	return 2.0 * rgb.xyz - 1.0;
}
const float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;const float ShiftRight8 = 1. / 256.;
const float Inv255 = 1. / 255.;
const vec4 PackFactors = vec4( 1.0, 256.0, 256.0 * 256.0, 256.0 * 256.0 * 256.0 );
const vec2 UnpackFactors2 = vec2( UnpackDownscale, 1.0 / PackFactors.g );
const vec3 UnpackFactors3 = vec3( UnpackDownscale / PackFactors.rg, 1.0 / PackFactors.b );
const vec4 UnpackFactors4 = vec4( UnpackDownscale / PackFactors.rgb, 1.0 / PackFactors.a );
vec4 packDepthToRGBA( const in float v ) {
	if( v <= 0.0 )
		return vec4( 0., 0., 0., 0. );
	if( v >= 1.0 )
		return vec4( 1., 1., 1., 1. );
	float vuf;
	float af = modf( v * PackFactors.a, vuf );
	float bf = modf( vuf * ShiftRight8, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec4( vuf * Inv255, gf * PackUpscale, bf * PackUpscale, af );
}
vec3 packDepthToRGB( const in float v ) {
	if( v <= 0.0 )
		return vec3( 0., 0., 0. );
	if( v >= 1.0 )
		return vec3( 1., 1., 1. );
	float vuf;
	float bf = modf( v * PackFactors.b, vuf );
	float gf = modf( vuf * ShiftRight8, vuf );
	return vec3( vuf * Inv255, gf * PackUpscale, bf );
}
vec2 packDepthToRG( const in float v ) {
	if( v <= 0.0 )
		return vec2( 0., 0. );
	if( v >= 1.0 )
		return vec2( 1., 1. );
	float vuf;
	float gf = modf( v * 256., vuf );
	return vec2( vuf * Inv255, gf );
}
float unpackRGBAToDepth( const in vec4 v ) {
	return dot( v, UnpackFactors4 );
}
float unpackRGBToDepth( const in vec3 v ) {
	return dot( v, UnpackFactors3 );
}
float unpackRGToDepth( const in vec2 v ) {
	return v.r * UnpackFactors2.r + v.g * UnpackFactors2.g;
}
vec4 pack2HalfToRGBA( const in vec2 v ) {
	vec4 r = vec4( v.x, fract( v.x * 255.0 ), v.y, fract( v.y * 255.0 ) );
	return vec4( r.x - r.y / 255.0, r.y, r.z - r.w / 255.0, r.w );
}
vec2 unpackRGBATo2Half( const in vec4 v ) {
	return vec2( v.x + ( v.y / 255.0 ), v.z + ( v.w / 255.0 ) );
}
float viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {
	return ( viewZ + near ) / ( near - far );
}
float orthographicDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return depth * ( near - far ) - near;
}
float viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {
	return ( ( near + viewZ ) * far ) / ( ( far - near ) * viewZ );
}
float perspectiveDepthToViewZ( const in float depth, const in float near, const in float far ) {
	return ( near * far ) / ( ( far - near ) * depth - far );
}`,$ft=`#ifdef PREMULTIPLIED_ALPHA
	gl_FragColor.rgb *= gl_FragColor.a;
#endif`,Kft=`vec4 mvPosition = vec4( transformed, 1.0 );
#ifdef USE_BATCHING
	mvPosition = batchingMatrix * mvPosition;
#endif
#ifdef USE_INSTANCING
	mvPosition = instanceMatrix * mvPosition;
#endif
mvPosition = modelViewMatrix * mvPosition;
gl_Position = projectionMatrix * mvPosition;`,jft=`#ifdef DITHERING
	gl_FragColor.rgb = dithering( gl_FragColor.rgb );
#endif`,Jft=`#ifdef DITHERING
	vec3 dithering( vec3 color ) {
		float grid_position = rand( gl_FragCoord.xy );
		vec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );
		dither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );
		return color + dither_shift_RGB;
	}
#endif`,Qft=`float roughnessFactor = roughness;
#ifdef USE_ROUGHNESSMAP
	vec4 texelRoughness = texture2D( roughnessMap, vRoughnessMapUv );
	roughnessFactor *= texelRoughness.g;
#endif`,tct=`#ifdef USE_ROUGHNESSMAP
	uniform sampler2D roughnessMap;
#endif`,ect=`#if NUM_SPOT_LIGHT_COORDS > 0
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#if NUM_SPOT_LIGHT_MAPS > 0
	uniform sampler2D spotLightMap[ NUM_SPOT_LIGHT_MAPS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform sampler2D directionalShadowMap[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		uniform sampler2D spotShadowMap[ NUM_SPOT_LIGHT_SHADOWS ];
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform sampler2D pointShadowMap[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
	float texture2DCompare( sampler2D depths, vec2 uv, float compare ) {
		return step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );
	}
	vec2 texture2DDistribution( sampler2D shadow, vec2 uv ) {
		return unpackRGBATo2Half( texture2D( shadow, uv ) );
	}
	float VSMShadow (sampler2D shadow, vec2 uv, float compare ){
		float occlusion = 1.0;
		vec2 distribution = texture2DDistribution( shadow, uv );
		float hard_shadow = step( compare , distribution.x );
		if (hard_shadow != 1.0 ) {
			float distance = compare - distribution.x ;
			float variance = max( 0.00000, distribution.y * distribution.y );
			float softness_probability = variance / (variance + distance * distance );			softness_probability = clamp( ( softness_probability - 0.3 ) / ( 0.95 - 0.3 ), 0.0, 1.0 );			occlusion = clamp( max( hard_shadow, softness_probability ), 0.0, 1.0 );
		}
		return occlusion;
	}
	float getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord ) {
		float shadow = 1.0;
		shadowCoord.xyz /= shadowCoord.w;
		shadowCoord.z += shadowBias;
		bool inFrustum = shadowCoord.x >= 0.0 && shadowCoord.x <= 1.0 && shadowCoord.y >= 0.0 && shadowCoord.y <= 1.0;
		bool frustumTest = inFrustum && shadowCoord.z <= 1.0;
		if ( frustumTest ) {
		#if defined( SHADOWMAP_TYPE_PCF )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx0 = - texelSize.x * shadowRadius;
			float dy0 = - texelSize.y * shadowRadius;
			float dx1 = + texelSize.x * shadowRadius;
			float dy1 = + texelSize.y * shadowRadius;
			float dx2 = dx0 / 2.0;
			float dy2 = dy0 / 2.0;
			float dx3 = dx1 / 2.0;
			float dy3 = dy1 / 2.0;
			shadow = (
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy2 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx2, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx3, dy3 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )
			) * ( 1.0 / 17.0 );
		#elif defined( SHADOWMAP_TYPE_PCF_SOFT )
			vec2 texelSize = vec2( 1.0 ) / shadowMapSize;
			float dx = texelSize.x;
			float dy = texelSize.y;
			vec2 uv = shadowCoord.xy;
			vec2 f = fract( uv * shadowMapSize + 0.5 );
			uv -= f * texelSize;
			shadow = (
				texture2DCompare( shadowMap, uv, shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( dx, 0.0 ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + vec2( 0.0, dy ), shadowCoord.z ) +
				texture2DCompare( shadowMap, uv + texelSize, shadowCoord.z ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, 0.0 ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 0.0 ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( -dx, dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, dy ), shadowCoord.z ),
					 f.x ) +
				mix( texture2DCompare( shadowMap, uv + vec2( 0.0, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( 0.0, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( texture2DCompare( shadowMap, uv + vec2( dx, -dy ), shadowCoord.z ),
					 texture2DCompare( shadowMap, uv + vec2( dx, 2.0 * dy ), shadowCoord.z ),
					 f.y ) +
				mix( mix( texture2DCompare( shadowMap, uv + vec2( -dx, -dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, -dy ), shadowCoord.z ),
						  f.x ),
					 mix( texture2DCompare( shadowMap, uv + vec2( -dx, 2.0 * dy ), shadowCoord.z ),
						  texture2DCompare( shadowMap, uv + vec2( 2.0 * dx, 2.0 * dy ), shadowCoord.z ),
						  f.x ),
					 f.y )
			) * ( 1.0 / 9.0 );
		#elif defined( SHADOWMAP_TYPE_VSM )
			shadow = VSMShadow( shadowMap, shadowCoord.xy, shadowCoord.z );
		#else
			shadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );
		#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
	vec2 cubeToUV( vec3 v, float texelSizeY ) {
		vec3 absV = abs( v );
		float scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );
		absV *= scaleToCube;
		v *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );
		vec2 planar = v.xy;
		float almostATexel = 1.5 * texelSizeY;
		float almostOne = 1.0 - almostATexel;
		if ( absV.z >= almostOne ) {
			if ( v.z > 0.0 )
				planar.x = 4.0 - v.x;
		} else if ( absV.x >= almostOne ) {
			float signX = sign( v.x );
			planar.x = v.z * signX + 2.0 * signX;
		} else if ( absV.y >= almostOne ) {
			float signY = sign( v.y );
			planar.x = v.x + 2.0 * signY + 2.0;
			planar.y = v.z * signY - 2.0;
		}
		return vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );
	}
	float getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowIntensity, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {
		float shadow = 1.0;
		vec3 lightToPosition = shadowCoord.xyz;
		
		float lightToPositionLength = length( lightToPosition );
		if ( lightToPositionLength - shadowCameraFar <= 0.0 && lightToPositionLength - shadowCameraNear >= 0.0 ) {
			float dp = ( lightToPositionLength - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );			dp += shadowBias;
			vec3 bd3D = normalize( lightToPosition );
			vec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );
			#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT ) || defined( SHADOWMAP_TYPE_VSM )
				vec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;
				shadow = (
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +
					texture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )
				) * ( 1.0 / 9.0 );
			#else
				shadow = texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );
			#endif
		}
		return mix( 1.0, shadow, shadowIntensity );
	}
#endif`,rct=`#if NUM_SPOT_LIGHT_COORDS > 0
	uniform mat4 spotLightMatrix[ NUM_SPOT_LIGHT_COORDS ];
	varying vec4 vSpotLightCoord[ NUM_SPOT_LIGHT_COORDS ];
#endif
#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
		uniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHT_SHADOWS ];
		varying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHT_SHADOWS ];
		struct DirectionalLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform DirectionalLightShadow directionalLightShadows[ NUM_DIR_LIGHT_SHADOWS ];
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
		struct SpotLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
		};
		uniform SpotLightShadow spotLightShadows[ NUM_SPOT_LIGHT_SHADOWS ];
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		uniform mat4 pointShadowMatrix[ NUM_POINT_LIGHT_SHADOWS ];
		varying vec4 vPointShadowCoord[ NUM_POINT_LIGHT_SHADOWS ];
		struct PointLightShadow {
			float shadowIntensity;
			float shadowBias;
			float shadowNormalBias;
			float shadowRadius;
			vec2 shadowMapSize;
			float shadowCameraNear;
			float shadowCameraFar;
		};
		uniform PointLightShadow pointLightShadows[ NUM_POINT_LIGHT_SHADOWS ];
	#endif
#endif`,nct=`#if ( defined( USE_SHADOWMAP ) && ( NUM_DIR_LIGHT_SHADOWS > 0 || NUM_POINT_LIGHT_SHADOWS > 0 ) ) || ( NUM_SPOT_LIGHT_COORDS > 0 )
	vec3 shadowWorldNormal = inverseTransformDirection( transformedNormal, viewMatrix );
	vec4 shadowWorldPosition;
#endif
#if defined( USE_SHADOWMAP )
	#if NUM_DIR_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * directionalLightShadows[ i ].shadowNormalBias, 0 );
			vDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
		#pragma unroll_loop_start
		for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
			shadowWorldPosition = worldPosition + vec4( shadowWorldNormal * pointLightShadows[ i ].shadowNormalBias, 0 );
			vPointShadowCoord[ i ] = pointShadowMatrix[ i ] * shadowWorldPosition;
		}
		#pragma unroll_loop_end
	#endif
#endif
#if NUM_SPOT_LIGHT_COORDS > 0
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_COORDS; i ++ ) {
		shadowWorldPosition = worldPosition;
		#if ( defined( USE_SHADOWMAP ) && UNROLLED_LOOP_INDEX < NUM_SPOT_LIGHT_SHADOWS )
			shadowWorldPosition.xyz += shadowWorldNormal * spotLightShadows[ i ].shadowNormalBias;
		#endif
		vSpotLightCoord[ i ] = spotLightMatrix[ i ] * shadowWorldPosition;
	}
	#pragma unroll_loop_end
#endif`,ict=`float getShadowMask() {
	float shadow = 1.0;
	#ifdef USE_SHADOWMAP
	#if NUM_DIR_LIGHT_SHADOWS > 0
	DirectionalLightShadow directionalLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_DIR_LIGHT_SHADOWS; i ++ ) {
		directionalLight = directionalLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowIntensity, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_SPOT_LIGHT_SHADOWS > 0
	SpotLightShadow spotLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_SPOT_LIGHT_SHADOWS; i ++ ) {
		spotLight = spotLightShadows[ i ];
		shadow *= receiveShadow ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowIntensity, spotLight.shadowBias, spotLight.shadowRadius, vSpotLightCoord[ i ] ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#if NUM_POINT_LIGHT_SHADOWS > 0
	PointLightShadow pointLight;
	#pragma unroll_loop_start
	for ( int i = 0; i < NUM_POINT_LIGHT_SHADOWS; i ++ ) {
		pointLight = pointLightShadows[ i ];
		shadow *= receiveShadow ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowIntensity, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;
	}
	#pragma unroll_loop_end
	#endif
	#endif
	return shadow;
}`,act=`#ifdef USE_SKINNING
	mat4 boneMatX = getBoneMatrix( skinIndex.x );
	mat4 boneMatY = getBoneMatrix( skinIndex.y );
	mat4 boneMatZ = getBoneMatrix( skinIndex.z );
	mat4 boneMatW = getBoneMatrix( skinIndex.w );
#endif`,oct=`#ifdef USE_SKINNING
	uniform mat4 bindMatrix;
	uniform mat4 bindMatrixInverse;
	uniform highp sampler2D boneTexture;
	mat4 getBoneMatrix( const in float i ) {
		int size = textureSize( boneTexture, 0 ).x;
		int j = int( i ) * 4;
		int x = j % size;
		int y = j / size;
		vec4 v1 = texelFetch( boneTexture, ivec2( x, y ), 0 );
		vec4 v2 = texelFetch( boneTexture, ivec2( x + 1, y ), 0 );
		vec4 v3 = texelFetch( boneTexture, ivec2( x + 2, y ), 0 );
		vec4 v4 = texelFetch( boneTexture, ivec2( x + 3, y ), 0 );
		return mat4( v1, v2, v3, v4 );
	}
#endif`,sct=`#ifdef USE_SKINNING
	vec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );
	vec4 skinned = vec4( 0.0 );
	skinned += boneMatX * skinVertex * skinWeight.x;
	skinned += boneMatY * skinVertex * skinWeight.y;
	skinned += boneMatZ * skinVertex * skinWeight.z;
	skinned += boneMatW * skinVertex * skinWeight.w;
	transformed = ( bindMatrixInverse * skinned ).xyz;
#endif`,lct=`#ifdef USE_SKINNING
	mat4 skinMatrix = mat4( 0.0 );
	skinMatrix += skinWeight.x * boneMatX;
	skinMatrix += skinWeight.y * boneMatY;
	skinMatrix += skinWeight.z * boneMatZ;
	skinMatrix += skinWeight.w * boneMatW;
	skinMatrix = bindMatrixInverse * skinMatrix * bindMatrix;
	objectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;
	#ifdef USE_TANGENT
		objectTangent = vec4( skinMatrix * vec4( objectTangent, 0.0 ) ).xyz;
	#endif
#endif`,uct=`float specularStrength;
#ifdef USE_SPECULARMAP
	vec4 texelSpecular = texture2D( specularMap, vSpecularMapUv );
	specularStrength = texelSpecular.r;
#else
	specularStrength = 1.0;
#endif`,hct=`#ifdef USE_SPECULARMAP
	uniform sampler2D specularMap;
#endif`,fct=`#if defined( TONE_MAPPING )
	gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );
#endif`,cct=`#ifndef saturate
#define saturate( a ) clamp( a, 0.0, 1.0 )
#endif
uniform float toneMappingExposure;
vec3 LinearToneMapping( vec3 color ) {
	return saturate( toneMappingExposure * color );
}
vec3 ReinhardToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	return saturate( color / ( vec3( 1.0 ) + color ) );
}
vec3 CineonToneMapping( vec3 color ) {
	color *= toneMappingExposure;
	color = max( vec3( 0.0 ), color - 0.004 );
	return pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );
}
vec3 RRTAndODTFit( vec3 v ) {
	vec3 a = v * ( v + 0.0245786 ) - 0.000090537;
	vec3 b = v * ( 0.983729 * v + 0.4329510 ) + 0.238081;
	return a / b;
}
vec3 ACESFilmicToneMapping( vec3 color ) {
	const mat3 ACESInputMat = mat3(
		vec3( 0.59719, 0.07600, 0.02840 ),		vec3( 0.35458, 0.90834, 0.13383 ),
		vec3( 0.04823, 0.01566, 0.83777 )
	);
	const mat3 ACESOutputMat = mat3(
		vec3(  1.60475, -0.10208, -0.00327 ),		vec3( -0.53108,  1.10813, -0.07276 ),
		vec3( -0.07367, -0.00605,  1.07602 )
	);
	color *= toneMappingExposure / 0.6;
	color = ACESInputMat * color;
	color = RRTAndODTFit( color );
	color = ACESOutputMat * color;
	return saturate( color );
}
const mat3 LINEAR_REC2020_TO_LINEAR_SRGB = mat3(
	vec3( 1.6605, - 0.1246, - 0.0182 ),
	vec3( - 0.5876, 1.1329, - 0.1006 ),
	vec3( - 0.0728, - 0.0083, 1.1187 )
);
const mat3 LINEAR_SRGB_TO_LINEAR_REC2020 = mat3(
	vec3( 0.6274, 0.0691, 0.0164 ),
	vec3( 0.3293, 0.9195, 0.0880 ),
	vec3( 0.0433, 0.0113, 0.8956 )
);
vec3 agxDefaultContrastApprox( vec3 x ) {
	vec3 x2 = x * x;
	vec3 x4 = x2 * x2;
	return + 15.5 * x4 * x2
		- 40.14 * x4 * x
		+ 31.96 * x4
		- 6.868 * x2 * x
		+ 0.4298 * x2
		+ 0.1191 * x
		- 0.00232;
}
vec3 AgXToneMapping( vec3 color ) {
	const mat3 AgXInsetMatrix = mat3(
		vec3( 0.856627153315983, 0.137318972929847, 0.11189821299995 ),
		vec3( 0.0951212405381588, 0.761241990602591, 0.0767994186031903 ),
		vec3( 0.0482516061458583, 0.101439036467562, 0.811302368396859 )
	);
	const mat3 AgXOutsetMatrix = mat3(
		vec3( 1.1271005818144368, - 0.1413297634984383, - 0.14132976349843826 ),
		vec3( - 0.11060664309660323, 1.157823702216272, - 0.11060664309660294 ),
		vec3( - 0.016493938717834573, - 0.016493938717834257, 1.2519364065950405 )
	);
	const float AgxMinEv = - 12.47393;	const float AgxMaxEv = 4.026069;
	color *= toneMappingExposure;
	color = LINEAR_SRGB_TO_LINEAR_REC2020 * color;
	color = AgXInsetMatrix * color;
	color = max( color, 1e-10 );	color = log2( color );
	color = ( color - AgxMinEv ) / ( AgxMaxEv - AgxMinEv );
	color = clamp( color, 0.0, 1.0 );
	color = agxDefaultContrastApprox( color );
	color = AgXOutsetMatrix * color;
	color = pow( max( vec3( 0.0 ), color ), vec3( 2.2 ) );
	color = LINEAR_REC2020_TO_LINEAR_SRGB * color;
	color = clamp( color, 0.0, 1.0 );
	return color;
}
vec3 NeutralToneMapping( vec3 color ) {
	const float StartCompression = 0.8 - 0.04;
	const float Desaturation = 0.15;
	color *= toneMappingExposure;
	float x = min( color.r, min( color.g, color.b ) );
	float offset = x < 0.08 ? x - 6.25 * x * x : 0.04;
	color -= offset;
	float peak = max( color.r, max( color.g, color.b ) );
	if ( peak < StartCompression ) return color;
	float d = 1. - StartCompression;
	float newPeak = 1. - d * d / ( peak + d - StartCompression );
	color *= newPeak / peak;
	float g = 1. - 1. / ( Desaturation * ( peak - newPeak ) + 1. );
	return mix( color, vec3( newPeak ), g );
}
vec3 CustomToneMapping( vec3 color ) { return color; }`,dct=`#ifdef USE_TRANSMISSION
	material.transmission = transmission;
	material.transmissionAlpha = 1.0;
	material.thickness = thickness;
	material.attenuationDistance = attenuationDistance;
	material.attenuationColor = attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		material.transmission *= texture2D( transmissionMap, vTransmissionMapUv ).r;
	#endif
	#ifdef USE_THICKNESSMAP
		material.thickness *= texture2D( thicknessMap, vThicknessMapUv ).g;
	#endif
	vec3 pos = vWorldPosition;
	vec3 v = normalize( cameraPosition - pos );
	vec3 n = inverseTransformDirection( normal, viewMatrix );
	vec4 transmitted = getIBLVolumeRefraction(
		n, v, material.roughness, material.diffuseColor, material.specularColor, material.specularF90,
		pos, modelMatrix, viewMatrix, projectionMatrix, material.dispersion, material.ior, material.thickness,
		material.attenuationColor, material.attenuationDistance );
	material.transmissionAlpha = mix( material.transmissionAlpha, transmitted.a, material.transmission );
	totalDiffuse = mix( totalDiffuse, transmitted.rgb, material.transmission );
#endif`,vct=`#ifdef USE_TRANSMISSION
	uniform float transmission;
	uniform float thickness;
	uniform float attenuationDistance;
	uniform vec3 attenuationColor;
	#ifdef USE_TRANSMISSIONMAP
		uniform sampler2D transmissionMap;
	#endif
	#ifdef USE_THICKNESSMAP
		uniform sampler2D thicknessMap;
	#endif
	uniform vec2 transmissionSamplerSize;
	uniform sampler2D transmissionSamplerMap;
	uniform mat4 modelMatrix;
	uniform mat4 projectionMatrix;
	varying vec3 vWorldPosition;
	float w0( float a ) {
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - a + 3.0 ) - 3.0 ) + 1.0 );
	}
	float w1( float a ) {
		return ( 1.0 / 6.0 ) * ( a *  a * ( 3.0 * a - 6.0 ) + 4.0 );
	}
	float w2( float a ){
		return ( 1.0 / 6.0 ) * ( a * ( a * ( - 3.0 * a + 3.0 ) + 3.0 ) + 1.0 );
	}
	float w3( float a ) {
		return ( 1.0 / 6.0 ) * ( a * a * a );
	}
	float g0( float a ) {
		return w0( a ) + w1( a );
	}
	float g1( float a ) {
		return w2( a ) + w3( a );
	}
	float h0( float a ) {
		return - 1.0 + w1( a ) / ( w0( a ) + w1( a ) );
	}
	float h1( float a ) {
		return 1.0 + w3( a ) / ( w2( a ) + w3( a ) );
	}
	vec4 bicubic( sampler2D tex, vec2 uv, vec4 texelSize, float lod ) {
		uv = uv * texelSize.zw + 0.5;
		vec2 iuv = floor( uv );
		vec2 fuv = fract( uv );
		float g0x = g0( fuv.x );
		float g1x = g1( fuv.x );
		float h0x = h0( fuv.x );
		float h1x = h1( fuv.x );
		float h0y = h0( fuv.y );
		float h1y = h1( fuv.y );
		vec2 p0 = ( vec2( iuv.x + h0x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p1 = ( vec2( iuv.x + h1x, iuv.y + h0y ) - 0.5 ) * texelSize.xy;
		vec2 p2 = ( vec2( iuv.x + h0x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		vec2 p3 = ( vec2( iuv.x + h1x, iuv.y + h1y ) - 0.5 ) * texelSize.xy;
		return g0( fuv.y ) * ( g0x * textureLod( tex, p0, lod ) + g1x * textureLod( tex, p1, lod ) ) +
			g1( fuv.y ) * ( g0x * textureLod( tex, p2, lod ) + g1x * textureLod( tex, p3, lod ) );
	}
	vec4 textureBicubic( sampler2D sampler, vec2 uv, float lod ) {
		vec2 fLodSize = vec2( textureSize( sampler, int( lod ) ) );
		vec2 cLodSize = vec2( textureSize( sampler, int( lod + 1.0 ) ) );
		vec2 fLodSizeInv = 1.0 / fLodSize;
		vec2 cLodSizeInv = 1.0 / cLodSize;
		vec4 fSample = bicubic( sampler, uv, vec4( fLodSizeInv, fLodSize ), floor( lod ) );
		vec4 cSample = bicubic( sampler, uv, vec4( cLodSizeInv, cLodSize ), ceil( lod ) );
		return mix( fSample, cSample, fract( lod ) );
	}
	vec3 getVolumeTransmissionRay( const in vec3 n, const in vec3 v, const in float thickness, const in float ior, const in mat4 modelMatrix ) {
		vec3 refractionVector = refract( - v, normalize( n ), 1.0 / ior );
		vec3 modelScale;
		modelScale.x = length( vec3( modelMatrix[ 0 ].xyz ) );
		modelScale.y = length( vec3( modelMatrix[ 1 ].xyz ) );
		modelScale.z = length( vec3( modelMatrix[ 2 ].xyz ) );
		return normalize( refractionVector ) * thickness * modelScale;
	}
	float applyIorToRoughness( const in float roughness, const in float ior ) {
		return roughness * clamp( ior * 2.0 - 2.0, 0.0, 1.0 );
	}
	vec4 getTransmissionSample( const in vec2 fragCoord, const in float roughness, const in float ior ) {
		float lod = log2( transmissionSamplerSize.x ) * applyIorToRoughness( roughness, ior );
		return textureBicubic( transmissionSamplerMap, fragCoord.xy, lod );
	}
	vec3 volumeAttenuation( const in float transmissionDistance, const in vec3 attenuationColor, const in float attenuationDistance ) {
		if ( isinf( attenuationDistance ) ) {
			return vec3( 1.0 );
		} else {
			vec3 attenuationCoefficient = -log( attenuationColor ) / attenuationDistance;
			vec3 transmittance = exp( - attenuationCoefficient * transmissionDistance );			return transmittance;
		}
	}
	vec4 getIBLVolumeRefraction( const in vec3 n, const in vec3 v, const in float roughness, const in vec3 diffuseColor,
		const in vec3 specularColor, const in float specularF90, const in vec3 position, const in mat4 modelMatrix,
		const in mat4 viewMatrix, const in mat4 projMatrix, const in float dispersion, const in float ior, const in float thickness,
		const in vec3 attenuationColor, const in float attenuationDistance ) {
		vec4 transmittedLight;
		vec3 transmittance;
		#ifdef USE_DISPERSION
			float halfSpread = ( ior - 1.0 ) * 0.025 * dispersion;
			vec3 iors = vec3( ior - halfSpread, ior, ior + halfSpread );
			for ( int i = 0; i < 3; i ++ ) {
				vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, iors[ i ], modelMatrix );
				vec3 refractedRayExit = position + transmissionRay;
				vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
				vec2 refractionCoords = ndcPos.xy / ndcPos.w;
				refractionCoords += 1.0;
				refractionCoords /= 2.0;
				vec4 transmissionSample = getTransmissionSample( refractionCoords, roughness, iors[ i ] );
				transmittedLight[ i ] = transmissionSample[ i ];
				transmittedLight.a += transmissionSample.a;
				transmittance[ i ] = diffuseColor[ i ] * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance )[ i ];
			}
			transmittedLight.a /= 3.0;
		#else
			vec3 transmissionRay = getVolumeTransmissionRay( n, v, thickness, ior, modelMatrix );
			vec3 refractedRayExit = position + transmissionRay;
			vec4 ndcPos = projMatrix * viewMatrix * vec4( refractedRayExit, 1.0 );
			vec2 refractionCoords = ndcPos.xy / ndcPos.w;
			refractionCoords += 1.0;
			refractionCoords /= 2.0;
			transmittedLight = getTransmissionSample( refractionCoords, roughness, ior );
			transmittance = diffuseColor * volumeAttenuation( length( transmissionRay ), attenuationColor, attenuationDistance );
		#endif
		vec3 attenuatedColor = transmittance * transmittedLight.rgb;
		vec3 F = EnvironmentBRDF( n, v, specularColor, specularF90, roughness );
		float transmittanceFactor = ( transmittance.r + transmittance.g + transmittance.b ) / 3.0;
		return vec4( ( 1.0 - F ) * attenuatedColor, 1.0 - ( 1.0 - transmittedLight.a ) * transmittanceFactor );
	}
#endif`,pct=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_SPECULARMAP
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,gct=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	varying vec2 vUv;
#endif
#ifdef USE_MAP
	uniform mat3 mapTransform;
	varying vec2 vMapUv;
#endif
#ifdef USE_ALPHAMAP
	uniform mat3 alphaMapTransform;
	varying vec2 vAlphaMapUv;
#endif
#ifdef USE_LIGHTMAP
	uniform mat3 lightMapTransform;
	varying vec2 vLightMapUv;
#endif
#ifdef USE_AOMAP
	uniform mat3 aoMapTransform;
	varying vec2 vAoMapUv;
#endif
#ifdef USE_BUMPMAP
	uniform mat3 bumpMapTransform;
	varying vec2 vBumpMapUv;
#endif
#ifdef USE_NORMALMAP
	uniform mat3 normalMapTransform;
	varying vec2 vNormalMapUv;
#endif
#ifdef USE_DISPLACEMENTMAP
	uniform mat3 displacementMapTransform;
	varying vec2 vDisplacementMapUv;
#endif
#ifdef USE_EMISSIVEMAP
	uniform mat3 emissiveMapTransform;
	varying vec2 vEmissiveMapUv;
#endif
#ifdef USE_METALNESSMAP
	uniform mat3 metalnessMapTransform;
	varying vec2 vMetalnessMapUv;
#endif
#ifdef USE_ROUGHNESSMAP
	uniform mat3 roughnessMapTransform;
	varying vec2 vRoughnessMapUv;
#endif
#ifdef USE_ANISOTROPYMAP
	uniform mat3 anisotropyMapTransform;
	varying vec2 vAnisotropyMapUv;
#endif
#ifdef USE_CLEARCOATMAP
	uniform mat3 clearcoatMapTransform;
	varying vec2 vClearcoatMapUv;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	uniform mat3 clearcoatNormalMapTransform;
	varying vec2 vClearcoatNormalMapUv;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	uniform mat3 clearcoatRoughnessMapTransform;
	varying vec2 vClearcoatRoughnessMapUv;
#endif
#ifdef USE_SHEEN_COLORMAP
	uniform mat3 sheenColorMapTransform;
	varying vec2 vSheenColorMapUv;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	uniform mat3 sheenRoughnessMapTransform;
	varying vec2 vSheenRoughnessMapUv;
#endif
#ifdef USE_IRIDESCENCEMAP
	uniform mat3 iridescenceMapTransform;
	varying vec2 vIridescenceMapUv;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	uniform mat3 iridescenceThicknessMapTransform;
	varying vec2 vIridescenceThicknessMapUv;
#endif
#ifdef USE_SPECULARMAP
	uniform mat3 specularMapTransform;
	varying vec2 vSpecularMapUv;
#endif
#ifdef USE_SPECULAR_COLORMAP
	uniform mat3 specularColorMapTransform;
	varying vec2 vSpecularColorMapUv;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	uniform mat3 specularIntensityMapTransform;
	varying vec2 vSpecularIntensityMapUv;
#endif
#ifdef USE_TRANSMISSIONMAP
	uniform mat3 transmissionMapTransform;
	varying vec2 vTransmissionMapUv;
#endif
#ifdef USE_THICKNESSMAP
	uniform mat3 thicknessMapTransform;
	varying vec2 vThicknessMapUv;
#endif`,mct=`#if defined( USE_UV ) || defined( USE_ANISOTROPY )
	vUv = vec3( uv, 1 ).xy;
#endif
#ifdef USE_MAP
	vMapUv = ( mapTransform * vec3( MAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ALPHAMAP
	vAlphaMapUv = ( alphaMapTransform * vec3( ALPHAMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_LIGHTMAP
	vLightMapUv = ( lightMapTransform * vec3( LIGHTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_AOMAP
	vAoMapUv = ( aoMapTransform * vec3( AOMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_BUMPMAP
	vBumpMapUv = ( bumpMapTransform * vec3( BUMPMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_NORMALMAP
	vNormalMapUv = ( normalMapTransform * vec3( NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_DISPLACEMENTMAP
	vDisplacementMapUv = ( displacementMapTransform * vec3( DISPLACEMENTMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_EMISSIVEMAP
	vEmissiveMapUv = ( emissiveMapTransform * vec3( EMISSIVEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_METALNESSMAP
	vMetalnessMapUv = ( metalnessMapTransform * vec3( METALNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ROUGHNESSMAP
	vRoughnessMapUv = ( roughnessMapTransform * vec3( ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_ANISOTROPYMAP
	vAnisotropyMapUv = ( anisotropyMapTransform * vec3( ANISOTROPYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOATMAP
	vClearcoatMapUv = ( clearcoatMapTransform * vec3( CLEARCOATMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_NORMALMAP
	vClearcoatNormalMapUv = ( clearcoatNormalMapTransform * vec3( CLEARCOAT_NORMALMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_CLEARCOAT_ROUGHNESSMAP
	vClearcoatRoughnessMapUv = ( clearcoatRoughnessMapTransform * vec3( CLEARCOAT_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCEMAP
	vIridescenceMapUv = ( iridescenceMapTransform * vec3( IRIDESCENCEMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_IRIDESCENCE_THICKNESSMAP
	vIridescenceThicknessMapUv = ( iridescenceThicknessMapTransform * vec3( IRIDESCENCE_THICKNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_COLORMAP
	vSheenColorMapUv = ( sheenColorMapTransform * vec3( SHEEN_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SHEEN_ROUGHNESSMAP
	vSheenRoughnessMapUv = ( sheenRoughnessMapTransform * vec3( SHEEN_ROUGHNESSMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULARMAP
	vSpecularMapUv = ( specularMapTransform * vec3( SPECULARMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_COLORMAP
	vSpecularColorMapUv = ( specularColorMapTransform * vec3( SPECULAR_COLORMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_SPECULAR_INTENSITYMAP
	vSpecularIntensityMapUv = ( specularIntensityMapTransform * vec3( SPECULAR_INTENSITYMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_TRANSMISSIONMAP
	vTransmissionMapUv = ( transmissionMapTransform * vec3( TRANSMISSIONMAP_UV, 1 ) ).xy;
#endif
#ifdef USE_THICKNESSMAP
	vThicknessMapUv = ( thicknessMapTransform * vec3( THICKNESSMAP_UV, 1 ) ).xy;
#endif`,_ct=`#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP ) || defined ( USE_TRANSMISSION ) || NUM_SPOT_LIGHT_COORDS > 0
	vec4 worldPosition = vec4( transformed, 1.0 );
	#ifdef USE_BATCHING
		worldPosition = batchingMatrix * worldPosition;
	#endif
	#ifdef USE_INSTANCING
		worldPosition = instanceMatrix * worldPosition;
	#endif
	worldPosition = modelMatrix * worldPosition;
#endif`;const yct=`varying vec2 vUv;
uniform mat3 uvTransform;
void main() {
	vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	gl_Position = vec4( position.xy, 1.0, 1.0 );
}`,xct=`uniform sampler2D t2D;
uniform float backgroundIntensity;
varying vec2 vUv;
void main() {
	vec4 texColor = texture2D( t2D, vUv );
	#ifdef DECODE_VIDEO_TEXTURE
		texColor = vec4( mix( pow( texColor.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), texColor.rgb * 0.0773993808, vec3( lessThanEqual( texColor.rgb, vec3( 0.04045 ) ) ) ), texColor.w );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Sct=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,Tct=`#ifdef ENVMAP_TYPE_CUBE
	uniform samplerCube envMap;
#elif defined( ENVMAP_TYPE_CUBE_UV )
	uniform sampler2D envMap;
#endif
uniform float flipEnvMap;
uniform float backgroundBlurriness;
uniform float backgroundIntensity;
uniform mat3 backgroundRotation;
varying vec3 vWorldDirection;
#include <cube_uv_reflection_fragment>
void main() {
	#ifdef ENVMAP_TYPE_CUBE
		vec4 texColor = textureCube( envMap, backgroundRotation * vec3( flipEnvMap * vWorldDirection.x, vWorldDirection.yz ) );
	#elif defined( ENVMAP_TYPE_CUBE_UV )
		vec4 texColor = textureCubeUV( envMap, backgroundRotation * vWorldDirection, backgroundBlurriness );
	#else
		vec4 texColor = vec4( 0.0, 0.0, 0.0, 1.0 );
	#endif
	texColor.rgb *= backgroundIntensity;
	gl_FragColor = texColor;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,bct=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
	gl_Position.z = gl_Position.w;
}`,wct=`uniform samplerCube tCube;
uniform float tFlip;
uniform float opacity;
varying vec3 vWorldDirection;
void main() {
	vec4 texColor = textureCube( tCube, vec3( tFlip * vWorldDirection.x, vWorldDirection.yz ) );
	gl_FragColor = texColor;
	gl_FragColor.a *= opacity;
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Mct=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
varying vec2 vHighPrecisionZW;
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vHighPrecisionZW = gl_Position.zw;
}`,Act=`#if DEPTH_PACKING == 3200
	uniform float opacity;
#endif
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
varying vec2 vHighPrecisionZW;
void main() {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#if DEPTH_PACKING == 3200
		diffuseColor.a = opacity;
	#endif
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <logdepthbuf_fragment>
	float fragCoordZ = 0.5 * vHighPrecisionZW[0] / vHighPrecisionZW[1] + 0.5;
	#if DEPTH_PACKING == 3200
		gl_FragColor = vec4( vec3( 1.0 - fragCoordZ ), opacity );
	#elif DEPTH_PACKING == 3201
		gl_FragColor = packDepthToRGBA( fragCoordZ );
	#elif DEPTH_PACKING == 3202
		gl_FragColor = vec4( packDepthToRGB( fragCoordZ ), 1.0 );
	#elif DEPTH_PACKING == 3203
		gl_FragColor = vec4( packDepthToRG( fragCoordZ ), 0.0, 1.0 );
	#endif
}`,Ect=`#define DISTANCE
varying vec3 vWorldPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <skinbase_vertex>
	#include <morphinstance_vertex>
	#ifdef USE_DISPLACEMENTMAP
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <worldpos_vertex>
	#include <clipping_planes_vertex>
	vWorldPosition = worldPosition.xyz;
}`,Cct=`#define DISTANCE
uniform vec3 referencePosition;
uniform float nearDistance;
uniform float farDistance;
varying vec3 vWorldPosition;
#include <common>
#include <packing>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <clipping_planes_pars_fragment>
void main () {
	vec4 diffuseColor = vec4( 1.0 );
	#include <clipping_planes_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	float dist = length( vWorldPosition - referencePosition );
	dist = ( dist - nearDistance ) / ( farDistance - nearDistance );
	dist = saturate( dist );
	gl_FragColor = packDepthToRGBA( dist );
}`,Dct=`varying vec3 vWorldDirection;
#include <common>
void main() {
	vWorldDirection = transformDirection( position, modelMatrix );
	#include <begin_vertex>
	#include <project_vertex>
}`,Lct=`uniform sampler2D tEquirect;
varying vec3 vWorldDirection;
#include <common>
void main() {
	vec3 direction = normalize( vWorldDirection );
	vec2 sampleUV = equirectUv( direction );
	gl_FragColor = texture2D( tEquirect, sampleUV );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
}`,Rct=`uniform float scale;
attribute float lineDistance;
varying float vLineDistance;
#include <common>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	vLineDistance = scale * lineDistance;
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Pct=`uniform vec3 diffuse;
uniform float opacity;
uniform float dashSize;
uniform float totalSize;
varying float vLineDistance;
#include <common>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	if ( mod( vLineDistance, totalSize ) > dashSize ) {
		discard;
	}
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,Ict=`#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#if defined ( USE_ENVMAP ) || defined ( USE_SKINNING )
		#include <beginnormal_vertex>
		#include <morphnormal_vertex>
		#include <skinbase_vertex>
		#include <skinnormal_vertex>
		#include <defaultnormal_vertex>
	#endif
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <fog_vertex>
}`,Nct=`uniform vec3 diffuse;
uniform float opacity;
#ifndef FLAT_SHADED
	varying vec3 vNormal;
#endif
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	#ifdef USE_LIGHTMAP
		vec4 lightMapTexel = texture2D( lightMap, vLightMapUv );
		reflectedLight.indirectDiffuse += lightMapTexel.rgb * lightMapIntensity * RECIPROCAL_PI;
	#else
		reflectedLight.indirectDiffuse += vec3( 1.0 );
	#endif
	#include <aomap_fragment>
	reflectedLight.indirectDiffuse *= diffuseColor.rgb;
	vec3 outgoingLight = reflectedLight.indirectDiffuse;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Oct=`#define LAMBERT
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Fct=`#define LAMBERT
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_lambert_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_lambert_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Bct=`#define MATCAP
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <color_pars_vertex>
#include <displacementmap_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
	vViewPosition = - mvPosition.xyz;
}`,Uct=`#define MATCAP
uniform vec3 diffuse;
uniform float opacity;
uniform sampler2D matcap;
varying vec3 vViewPosition;
#include <common>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	vec3 viewDir = normalize( vViewPosition );
	vec3 x = normalize( vec3( viewDir.z, 0.0, - viewDir.x ) );
	vec3 y = cross( viewDir, x );
	vec2 uv = vec2( dot( x, normal ), dot( y, normal ) ) * 0.495 + 0.5;
	#ifdef USE_MATCAP
		vec4 matcapColor = texture2D( matcap, uv );
	#else
		vec4 matcapColor = vec4( vec3( mix( 0.2, 0.8, uv.y ) ), 1.0 );
	#endif
	vec3 outgoingLight = diffuseColor.rgb * matcapColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,zct=`#define NORMAL
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	vViewPosition = - mvPosition.xyz;
#endif
}`,kct=`#define NORMAL
uniform float opacity;
#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP_TANGENTSPACE )
	varying vec3 vViewPosition;
#endif
#include <packing>
#include <uv_pars_fragment>
#include <normal_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( 0.0, 0.0, 0.0, opacity );
	#include <clipping_planes_fragment>
	#include <logdepthbuf_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	gl_FragColor = vec4( packNormalToRGB( normal ), diffuseColor.a );
	#ifdef OPAQUE
		gl_FragColor.a = 1.0;
	#endif
}`,Gct=`#define PHONG
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <envmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <envmap_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Vct=`#define PHONG
uniform vec3 diffuse;
uniform vec3 emissive;
uniform vec3 specular;
uniform float shininess;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_phong_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <specularmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <specularmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_phong_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;
	#include <envmap_fragment>
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Hct=`#define STANDARD
varying vec3 vViewPosition;
#ifdef USE_TRANSMISSION
	varying vec3 vWorldPosition;
#endif
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
#ifdef USE_TRANSMISSION
	vWorldPosition = worldPosition.xyz;
#endif
}`,Wct=`#define STANDARD
#ifdef PHYSICAL
	#define IOR
	#define USE_SPECULAR
#endif
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float roughness;
uniform float metalness;
uniform float opacity;
#ifdef IOR
	uniform float ior;
#endif
#ifdef USE_SPECULAR
	uniform float specularIntensity;
	uniform vec3 specularColor;
	#ifdef USE_SPECULAR_COLORMAP
		uniform sampler2D specularColorMap;
	#endif
	#ifdef USE_SPECULAR_INTENSITYMAP
		uniform sampler2D specularIntensityMap;
	#endif
#endif
#ifdef USE_CLEARCOAT
	uniform float clearcoat;
	uniform float clearcoatRoughness;
#endif
#ifdef USE_DISPERSION
	uniform float dispersion;
#endif
#ifdef USE_IRIDESCENCE
	uniform float iridescence;
	uniform float iridescenceIOR;
	uniform float iridescenceThicknessMinimum;
	uniform float iridescenceThicknessMaximum;
#endif
#ifdef USE_SHEEN
	uniform vec3 sheenColor;
	uniform float sheenRoughness;
	#ifdef USE_SHEEN_COLORMAP
		uniform sampler2D sheenColorMap;
	#endif
	#ifdef USE_SHEEN_ROUGHNESSMAP
		uniform sampler2D sheenRoughnessMap;
	#endif
#endif
#ifdef USE_ANISOTROPY
	uniform vec2 anisotropyVector;
	#ifdef USE_ANISOTROPYMAP
		uniform sampler2D anisotropyMap;
	#endif
#endif
varying vec3 vViewPosition;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <iridescence_fragment>
#include <cube_uv_reflection_fragment>
#include <envmap_common_pars_fragment>
#include <envmap_physical_pars_fragment>
#include <fog_pars_fragment>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_physical_pars_fragment>
#include <transmission_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <clearcoat_pars_fragment>
#include <iridescence_pars_fragment>
#include <roughnessmap_pars_fragment>
#include <metalnessmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <roughnessmap_fragment>
	#include <metalnessmap_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <clearcoat_normal_fragment_begin>
	#include <clearcoat_normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_physical_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;
	vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;
	#include <transmission_fragment>
	vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;
	#ifdef USE_SHEEN
		float sheenEnergyComp = 1.0 - 0.157 * max3( material.sheenColor );
		outgoingLight = outgoingLight * sheenEnergyComp + sheenSpecularDirect + sheenSpecularIndirect;
	#endif
	#ifdef USE_CLEARCOAT
		float dotNVcc = saturate( dot( geometryClearcoatNormal, geometryViewDir ) );
		vec3 Fcc = F_Schlick( material.clearcoatF0, material.clearcoatF90, dotNVcc );
		outgoingLight = outgoingLight * ( 1.0 - material.clearcoat * Fcc ) + ( clearcoatSpecularDirect + clearcoatSpecularIndirect ) * material.clearcoat;
	#endif
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Xct=`#define TOON
varying vec3 vViewPosition;
#include <common>
#include <batching_pars_vertex>
#include <uv_pars_vertex>
#include <displacementmap_pars_vertex>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <normal_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <shadowmap_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <normal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <displacementmap_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	vViewPosition = - mvPosition.xyz;
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Yct=`#define TOON
uniform vec3 diffuse;
uniform vec3 emissive;
uniform float opacity;
#include <common>
#include <packing>
#include <dithering_pars_fragment>
#include <color_pars_fragment>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <aomap_pars_fragment>
#include <lightmap_pars_fragment>
#include <emissivemap_pars_fragment>
#include <gradientmap_pars_fragment>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <normal_pars_fragment>
#include <lights_toon_pars_fragment>
#include <shadowmap_pars_fragment>
#include <bumpmap_pars_fragment>
#include <normalmap_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	ReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );
	vec3 totalEmissiveRadiance = emissive;
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <color_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	#include <normal_fragment_begin>
	#include <normal_fragment_maps>
	#include <emissivemap_fragment>
	#include <lights_toon_fragment>
	#include <lights_fragment_begin>
	#include <lights_fragment_maps>
	#include <lights_fragment_end>
	#include <aomap_fragment>
	vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
	#include <dithering_fragment>
}`,Zct=`uniform float size;
uniform float scale;
#include <common>
#include <color_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
#ifdef USE_POINTS_UV
	varying vec2 vUv;
	uniform mat3 uvTransform;
#endif
void main() {
	#ifdef USE_POINTS_UV
		vUv = ( uvTransform * vec3( uv, 1 ) ).xy;
	#endif
	#include <color_vertex>
	#include <morphinstance_vertex>
	#include <morphcolor_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <project_vertex>
	gl_PointSize = size;
	#ifdef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) gl_PointSize *= ( scale / - mvPosition.z );
	#endif
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <worldpos_vertex>
	#include <fog_vertex>
}`,qct=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <color_pars_fragment>
#include <map_particle_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_particle_fragment>
	#include <color_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
	#include <premultiplied_alpha_fragment>
}`,$ct=`#include <common>
#include <batching_pars_vertex>
#include <fog_pars_vertex>
#include <morphtarget_pars_vertex>
#include <skinning_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <shadowmap_pars_vertex>
void main() {
	#include <batching_vertex>
	#include <beginnormal_vertex>
	#include <morphinstance_vertex>
	#include <morphnormal_vertex>
	#include <skinbase_vertex>
	#include <skinnormal_vertex>
	#include <defaultnormal_vertex>
	#include <begin_vertex>
	#include <morphtarget_vertex>
	#include <skinning_vertex>
	#include <project_vertex>
	#include <logdepthbuf_vertex>
	#include <worldpos_vertex>
	#include <shadowmap_vertex>
	#include <fog_vertex>
}`,Kct=`uniform vec3 color;
uniform float opacity;
#include <common>
#include <packing>
#include <fog_pars_fragment>
#include <bsdfs>
#include <lights_pars_begin>
#include <logdepthbuf_pars_fragment>
#include <shadowmap_pars_fragment>
#include <shadowmask_pars_fragment>
void main() {
	#include <logdepthbuf_fragment>
	gl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,jct=`uniform float rotation;
uniform vec2 center;
#include <common>
#include <uv_pars_vertex>
#include <fog_pars_vertex>
#include <logdepthbuf_pars_vertex>
#include <clipping_planes_pars_vertex>
void main() {
	#include <uv_vertex>
	vec4 mvPosition = modelViewMatrix[ 3 ];
	vec2 scale = vec2( length( modelMatrix[ 0 ].xyz ), length( modelMatrix[ 1 ].xyz ) );
	#ifndef USE_SIZEATTENUATION
		bool isPerspective = isPerspectiveMatrix( projectionMatrix );
		if ( isPerspective ) scale *= - mvPosition.z;
	#endif
	vec2 alignedPosition = ( position.xy - ( center - vec2( 0.5 ) ) ) * scale;
	vec2 rotatedPosition;
	rotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;
	rotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;
	mvPosition.xy += rotatedPosition;
	gl_Position = projectionMatrix * mvPosition;
	#include <logdepthbuf_vertex>
	#include <clipping_planes_vertex>
	#include <fog_vertex>
}`,Jct=`uniform vec3 diffuse;
uniform float opacity;
#include <common>
#include <uv_pars_fragment>
#include <map_pars_fragment>
#include <alphamap_pars_fragment>
#include <alphatest_pars_fragment>
#include <alphahash_pars_fragment>
#include <fog_pars_fragment>
#include <logdepthbuf_pars_fragment>
#include <clipping_planes_pars_fragment>
void main() {
	vec4 diffuseColor = vec4( diffuse, opacity );
	#include <clipping_planes_fragment>
	vec3 outgoingLight = vec3( 0.0 );
	#include <logdepthbuf_fragment>
	#include <map_fragment>
	#include <alphamap_fragment>
	#include <alphatest_fragment>
	#include <alphahash_fragment>
	outgoingLight = diffuseColor.rgb;
	#include <opaque_fragment>
	#include <tonemapping_fragment>
	#include <colorspace_fragment>
	#include <fog_fragment>
}`,Fe={alphahash_fragment:xht,alphahash_pars_fragment:Sht,alphamap_fragment:Tht,alphamap_pars_fragment:bht,alphatest_fragment:wht,alphatest_pars_fragment:Mht,aomap_fragment:Aht,aomap_pars_fragment:Eht,batching_pars_vertex:Cht,batching_vertex:Dht,begin_vertex:Lht,beginnormal_vertex:Rht,bsdfs:Pht,iridescence_fragment:Iht,bumpmap_pars_fragment:Nht,clipping_planes_fragment:Oht,clipping_planes_pars_fragment:Fht,clipping_planes_pars_vertex:Bht,clipping_planes_vertex:Uht,color_fragment:zht,color_pars_fragment:kht,color_pars_vertex:Ght,color_vertex:Vht,common:Hht,cube_uv_reflection_fragment:Wht,defaultnormal_vertex:Xht,displacementmap_pars_vertex:Yht,displacementmap_vertex:Zht,emissivemap_fragment:qht,emissivemap_pars_fragment:$ht,colorspace_fragment:Kht,colorspace_pars_fragment:jht,envmap_fragment:Jht,envmap_common_pars_fragment:Qht,envmap_pars_fragment:tft,envmap_pars_vertex:eft,envmap_physical_pars_fragment:cft,envmap_vertex:rft,fog_vertex:nft,fog_pars_vertex:ift,fog_fragment:aft,fog_pars_fragment:oft,gradientmap_pars_fragment:sft,lightmap_pars_fragment:lft,lights_lambert_fragment:uft,lights_lambert_pars_fragment:hft,lights_pars_begin:fft,lights_toon_fragment:dft,lights_toon_pars_fragment:vft,lights_phong_fragment:pft,lights_phong_pars_fragment:gft,lights_physical_fragment:mft,lights_physical_pars_fragment:_ft,lights_fragment_begin:yft,lights_fragment_maps:xft,lights_fragment_end:Sft,logdepthbuf_fragment:Tft,logdepthbuf_pars_fragment:bft,logdepthbuf_pars_vertex:wft,logdepthbuf_vertex:Mft,map_fragment:Aft,map_pars_fragment:Eft,map_particle_fragment:Cft,map_particle_pars_fragment:Dft,metalnessmap_fragment:Lft,metalnessmap_pars_fragment:Rft,morphinstance_vertex:Pft,morphcolor_vertex:Ift,morphnormal_vertex:Nft,morphtarget_pars_vertex:Oft,morphtarget_vertex:Fft,normal_fragment_begin:Bft,normal_fragment_maps:Uft,normal_pars_fragment:zft,normal_pars_vertex:kft,normal_vertex:Gft,normalmap_pars_fragment:Vft,clearcoat_normal_fragment_begin:Hft,clearcoat_normal_fragment_maps:Wft,clearcoat_pars_fragment:Xft,iridescence_pars_fragment:Yft,opaque_fragment:Zft,packing:qft,premultiplied_alpha_fragment:$ft,project_vertex:Kft,dithering_fragment:jft,dithering_pars_fragment:Jft,roughnessmap_fragment:Qft,roughnessmap_pars_fragment:tct,shadowmap_pars_fragment:ect,shadowmap_pars_vertex:rct,shadowmap_vertex:nct,shadowmask_pars_fragment:ict,skinbase_vertex:act,skinning_pars_vertex:oct,skinning_vertex:sct,skinnormal_vertex:lct,specularmap_fragment:uct,specularmap_pars_fragment:hct,tonemapping_fragment:fct,tonemapping_pars_fragment:cct,transmission_fragment:dct,transmission_pars_fragment:vct,uv_pars_fragment:pct,uv_pars_vertex:gct,uv_vertex:mct,worldpos_vertex:_ct,background_vert:yct,background_frag:xct,backgroundCube_vert:Sct,backgroundCube_frag:Tct,cube_vert:bct,cube_frag:wct,depth_vert:Mct,depth_frag:Act,distanceRGBA_vert:Ect,distanceRGBA_frag:Cct,equirect_vert:Dct,equirect_frag:Lct,linedashed_vert:Rct,linedashed_frag:Pct,meshbasic_vert:Ict,meshbasic_frag:Nct,meshlambert_vert:Oct,meshlambert_frag:Fct,meshmatcap_vert:Bct,meshmatcap_frag:Uct,meshnormal_vert:zct,meshnormal_frag:kct,meshphong_vert:Gct,meshphong_frag:Vct,meshphysical_vert:Hct,meshphysical_frag:Wct,meshtoon_vert:Xct,meshtoon_frag:Yct,points_vert:Zct,points_frag:qct,shadow_vert:$ct,shadow_frag:Kct,sprite_vert:jct,sprite_frag:Jct},Ht={common:{diffuse:{value:new fr(16777215)},opacity:{value:1},map:{value:null},mapTransform:{value:new Pe},alphaMap:{value:null},alphaMapTransform:{value:new Pe},alphaTest:{value:0}},specularmap:{specularMap:{value:null},specularMapTransform:{value:new Pe}},envmap:{envMap:{value:null},envMapRotation:{value:new Pe},flipEnvMap:{value:-1},reflectivity:{value:1},ior:{value:1.5},refractionRatio:{value:.98}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1},aoMapTransform:{value:new Pe}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1},lightMapTransform:{value:new Pe}},bumpmap:{bumpMap:{value:null},bumpMapTransform:{value:new Pe},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalMapTransform:{value:new Pe},normalScale:{value:new pr(1,1)}},displacementmap:{displacementMap:{value:null},displacementMapTransform:{value:new Pe},displacementScale:{value:1},displacementBias:{value:0}},emissivemap:{emissiveMap:{value:null},emissiveMapTransform:{value:new Pe}},metalnessmap:{metalnessMap:{value:null},metalnessMapTransform:{value:new Pe}},roughnessmap:{roughnessMap:{value:null},roughnessMapTransform:{value:new Pe}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new fr(16777215)}},lights:{ambientLightColor:{value:[]},lightProbe:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{}}},directionalLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{}}},spotLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{}}},spotLightMap:{value:[]},spotShadowMap:{value:[]},spotLightMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{}}},pointLightShadows:{value:[],properties:{shadowIntensity:1,shadowBias:{},shadowNormalBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}},ltc_1:{value:null},ltc_2:{value:null}},points:{diffuse:{value:new fr(16777215)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},alphaMap:{value:null},alphaMapTransform:{value:new Pe},alphaTest:{value:0},uvTransform:{value:new Pe}},sprite:{diffuse:{value:new fr(16777215)},opacity:{value:1},center:{value:new pr(.5,.5)},rotation:{value:0},map:{value:null},mapTransform:{value:new Pe},alphaMap:{value:null},alphaMapTransform:{value:new Pe},alphaTest:{value:0}}},Pa={basic:{uniforms:Nn([Ht.common,Ht.specularmap,Ht.envmap,Ht.aomap,Ht.lightmap,Ht.fog]),vertexShader:Fe.meshbasic_vert,fragmentShader:Fe.meshbasic_frag},lambert:{uniforms:Nn([Ht.common,Ht.specularmap,Ht.envmap,Ht.aomap,Ht.lightmap,Ht.emissivemap,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.fog,Ht.lights,{emissive:{value:new fr(0)}}]),vertexShader:Fe.meshlambert_vert,fragmentShader:Fe.meshlambert_frag},phong:{uniforms:Nn([Ht.common,Ht.specularmap,Ht.envmap,Ht.aomap,Ht.lightmap,Ht.emissivemap,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.fog,Ht.lights,{emissive:{value:new fr(0)},specular:{value:new fr(1118481)},shininess:{value:30}}]),vertexShader:Fe.meshphong_vert,fragmentShader:Fe.meshphong_frag},standard:{uniforms:Nn([Ht.common,Ht.envmap,Ht.aomap,Ht.lightmap,Ht.emissivemap,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.roughnessmap,Ht.metalnessmap,Ht.fog,Ht.lights,{emissive:{value:new fr(0)},roughness:{value:1},metalness:{value:0},envMapIntensity:{value:1}}]),vertexShader:Fe.meshphysical_vert,fragmentShader:Fe.meshphysical_frag},toon:{uniforms:Nn([Ht.common,Ht.aomap,Ht.lightmap,Ht.emissivemap,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.gradientmap,Ht.fog,Ht.lights,{emissive:{value:new fr(0)}}]),vertexShader:Fe.meshtoon_vert,fragmentShader:Fe.meshtoon_frag},matcap:{uniforms:Nn([Ht.common,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,Ht.fog,{matcap:{value:null}}]),vertexShader:Fe.meshmatcap_vert,fragmentShader:Fe.meshmatcap_frag},points:{uniforms:Nn([Ht.points,Ht.fog]),vertexShader:Fe.points_vert,fragmentShader:Fe.points_frag},dashed:{uniforms:Nn([Ht.common,Ht.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Fe.linedashed_vert,fragmentShader:Fe.linedashed_frag},depth:{uniforms:Nn([Ht.common,Ht.displacementmap]),vertexShader:Fe.depth_vert,fragmentShader:Fe.depth_frag},normal:{uniforms:Nn([Ht.common,Ht.bumpmap,Ht.normalmap,Ht.displacementmap,{opacity:{value:1}}]),vertexShader:Fe.meshnormal_vert,fragmentShader:Fe.meshnormal_frag},sprite:{uniforms:Nn([Ht.sprite,Ht.fog]),vertexShader:Fe.sprite_vert,fragmentShader:Fe.sprite_frag},background:{uniforms:{uvTransform:{value:new Pe},t2D:{value:null},backgroundIntensity:{value:1}},vertexShader:Fe.background_vert,fragmentShader:Fe.background_frag},backgroundCube:{uniforms:{envMap:{value:null},flipEnvMap:{value:-1},backgroundBlurriness:{value:0},backgroundIntensity:{value:1},backgroundRotation:{value:new Pe}},vertexShader:Fe.backgroundCube_vert,fragmentShader:Fe.backgroundCube_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Fe.cube_vert,fragmentShader:Fe.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Fe.equirect_vert,fragmentShader:Fe.equirect_frag},distanceRGBA:{uniforms:Nn([Ht.common,Ht.displacementmap,{referencePosition:{value:new lt},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Fe.distanceRGBA_vert,fragmentShader:Fe.distanceRGBA_frag},shadow:{uniforms:Nn([Ht.lights,Ht.fog,{color:{value:new fr(0)},opacity:{value:1}}]),vertexShader:Fe.shadow_vert,fragmentShader:Fe.shadow_frag}};Pa.physical={uniforms:Nn([Pa.standard.uniforms,{clearcoat:{value:0},clearcoatMap:{value:null},clearcoatMapTransform:{value:new Pe},clearcoatNormalMap:{value:null},clearcoatNormalMapTransform:{value:new Pe},clearcoatNormalScale:{value:new pr(1,1)},clearcoatRoughness:{value:0},clearcoatRoughnessMap:{value:null},clearcoatRoughnessMapTransform:{value:new Pe},dispersion:{value:0},iridescence:{value:0},iridescenceMap:{value:null},iridescenceMapTransform:{value:new Pe},iridescenceIOR:{value:1.3},iridescenceThicknessMinimum:{value:100},iridescenceThicknessMaximum:{value:400},iridescenceThicknessMap:{value:null},iridescenceThicknessMapTransform:{value:new Pe},sheen:{value:0},sheenColor:{value:new fr(0)},sheenColorMap:{value:null},sheenColorMapTransform:{value:new Pe},sheenRoughness:{value:1},sheenRoughnessMap:{value:null},sheenRoughnessMapTransform:{value:new Pe},transmission:{value:0},transmissionMap:{value:null},transmissionMapTransform:{value:new Pe},transmissionSamplerSize:{value:new pr},transmissionSamplerMap:{value:null},thickness:{value:0},thicknessMap:{value:null},thicknessMapTransform:{value:new Pe},attenuationDistance:{value:0},attenuationColor:{value:new fr(0)},specularColor:{value:new fr(1,1,1)},specularColorMap:{value:null},specularColorMapTransform:{value:new Pe},specularIntensity:{value:1},specularIntensityMap:{value:null},specularIntensityMapTransform:{value:new Pe},anisotropyVector:{value:new pr},anisotropyMap:{value:null},anisotropyMapTransform:{value:new Pe}}]),vertexShader:Fe.meshphysical_vert,fragmentShader:Fe.meshphysical_frag};const Lg={r:0,b:0,g:0},Il=new ko,Qct=new qr;function tdt(e,t,r,n,i,a,o){const s=new fr(0);let l=a===!0?0:1,u,h,f=null,c=0,d=null;function v(y){let x=y.isScene===!0?y.background:null;return x&&x.isTexture&&(x=(y.backgroundBlurriness>0?r:t).get(x)),x}function p(y){let x=!1;const T=v(y);T===null?m(s,l):T&&T.isColor&&(m(T,1),x=!0);const S=e.xr.getEnvironmentBlendMode();S==="additive"?n.buffers.color.setClear(0,0,0,1,o):S==="alpha-blend"&&n.buffers.color.setClear(0,0,0,0,o),(e.autoClear||x)&&(n.buffers.depth.setTest(!0),n.buffers.depth.setMask(!0),n.buffers.color.setMask(!0),e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil))}function g(y,x){const T=v(x);T&&(T.isCubeTexture||T.mapping===g0)?(h===void 0&&(h=new ka(new sc(1,1,1),new Vs({name:"BackgroundCubeMaterial",uniforms:Nf(Pa.backgroundCube.uniforms),vertexShader:Pa.backgroundCube.vertexShader,fragmentShader:Pa.backgroundCube.fragmentShader,side:li,depthTest:!1,depthWrite:!1,fog:!1})),h.geometry.deleteAttribute("normal"),h.geometry.deleteAttribute("uv"),h.onBeforeRender=function(S,M,w){this.matrixWorld.copyPosition(w.matrixWorld)},Object.defineProperty(h.material,"envMap",{get:function(){return this.uniforms.envMap.value}}),i.update(h)),Il.copy(x.backgroundRotation),Il.x*=-1,Il.y*=-1,Il.z*=-1,T.isCubeTexture&&T.isRenderTargetTexture===!1&&(Il.y*=-1,Il.z*=-1),h.material.uniforms.envMap.value=T,h.material.uniforms.flipEnvMap.value=T.isCubeTexture&&T.isRenderTargetTexture===!1?-1:1,h.material.uniforms.backgroundBlurriness.value=x.backgroundBlurriness,h.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,h.material.uniforms.backgroundRotation.value.setFromMatrix4(Qct.makeRotationFromEuler(Il)),h.material.toneMapped=tr.getTransfer(T.colorSpace)!==cr,(f!==T||c!==T.version||d!==e.toneMapping)&&(h.material.needsUpdate=!0,f=T,c=T.version,d=e.toneMapping),h.layers.enableAll(),y.unshift(h,h.geometry,h.material,0,0,null)):T&&T.isTexture&&(u===void 0&&(u=new ka(new _0(2,2),new Vs({name:"BackgroundMaterial",uniforms:Nf(Pa.background.uniforms),vertexShader:Pa.background.vertexShader,fragmentShader:Pa.background.fragmentShader,side:Gs,depthTest:!1,depthWrite:!1,fog:!1})),u.geometry.deleteAttribute("normal"),Object.defineProperty(u.material,"map",{get:function(){return this.uniforms.t2D.value}}),i.update(u)),u.material.uniforms.t2D.value=T,u.material.uniforms.backgroundIntensity.value=x.backgroundIntensity,u.material.toneMapped=tr.getTransfer(T.colorSpace)!==cr,T.matrixAutoUpdate===!0&&T.updateMatrix(),u.material.uniforms.uvTransform.value.copy(T.matrix),(f!==T||c!==T.version||d!==e.toneMapping)&&(u.material.needsUpdate=!0,f=T,c=T.version,d=e.toneMapping),u.layers.enableAll(),y.unshift(u,u.geometry,u.material,0,0,null))}function m(y,x){y.getRGB(Lg,QG(e)),n.buffers.color.setClear(Lg.r,Lg.g,Lg.b,x,o)}function _(){h!==void 0&&(h.geometry.dispose(),h.material.dispose()),u!==void 0&&(u.geometry.dispose(),u.material.dispose())}return{getClearColor:function(){return s},setClearColor:function(y,x=1){s.set(y),l=x,m(s,l)},getClearAlpha:function(){return l},setClearAlpha:function(y){l=y,m(s,l)},render:p,addToRenderList:g,dispose:_}}function edt(e,t){const r=e.getParameter(e.MAX_VERTEX_ATTRIBS),n={},i=c(null);let a=i,o=!1;function s(A,E,C,D,L){let P=!1;const N=f(D,C,E);a!==N&&(a=N,u(a.object)),P=d(A,D,C,L),P&&v(A,D,C,L),L!==null&&t.update(L,e.ELEMENT_ARRAY_BUFFER),(P||o)&&(o=!1,x(A,E,C,D),L!==null&&e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,t.get(L).buffer))}function l(){return e.createVertexArray()}function u(A){return e.bindVertexArray(A)}function h(A){return e.deleteVertexArray(A)}function f(A,E,C){const D=C.wireframe===!0;let L=n[A.id];L===void 0&&(L={},n[A.id]=L);let P=L[E.id];P===void 0&&(P={},L[E.id]=P);let N=P[D];return N===void 0&&(N=c(l()),P[D]=N),N}function c(A){const E=[],C=[],D=[];for(let L=0;L<r;L++)E[L]=0,C[L]=0,D[L]=0;return{geometry:null,program:null,wireframe:!1,newAttributes:E,enabledAttributes:C,attributeDivisors:D,object:A,attributes:{},index:null}}function d(A,E,C,D){const L=a.attributes,P=E.attributes;let N=0;const O=C.getAttributes();for(const I in O)if(O[I].location>=0){const z=L[I];let X=P[I];if(X===void 0&&(I==="instanceMatrix"&&A.instanceMatrix&&(X=A.instanceMatrix),I==="instanceColor"&&A.instanceColor&&(X=A.instanceColor)),z===void 0||z.attribute!==X||X&&z.data!==X.data)return!0;N++}return a.attributesNum!==N||a.index!==D}function v(A,E,C,D){const L={},P=E.attributes;let N=0;const O=C.getAttributes();for(const I in O)if(O[I].location>=0){let z=P[I];z===void 0&&(I==="instanceMatrix"&&A.instanceMatrix&&(z=A.instanceMatrix),I==="instanceColor"&&A.instanceColor&&(z=A.instanceColor));const X={};X.attribute=z,z&&z.data&&(X.data=z.data),L[I]=X,N++}a.attributes=L,a.attributesNum=N,a.index=D}function p(){const A=a.newAttributes;for(let E=0,C=A.length;E<C;E++)A[E]=0}function g(A){m(A,0)}function m(A,E){const C=a.newAttributes,D=a.enabledAttributes,L=a.attributeDivisors;C[A]=1,D[A]===0&&(e.enableVertexAttribArray(A),D[A]=1),L[A]!==E&&(e.vertexAttribDivisor(A,E),L[A]=E)}function _(){const A=a.newAttributes,E=a.enabledAttributes;for(let C=0,D=E.length;C<D;C++)E[C]!==A[C]&&(e.disableVertexAttribArray(C),E[C]=0)}function y(A,E,C,D,L,P,N){N===!0?e.vertexAttribIPointer(A,E,C,L,P):e.vertexAttribPointer(A,E,C,D,L,P)}function x(A,E,C,D){p();const L=D.attributes,P=C.getAttributes(),N=E.defaultAttributeValues;for(const O in P){const I=P[O];if(I.location>=0){let k=L[O];if(k===void 0&&(O==="instanceMatrix"&&A.instanceMatrix&&(k=A.instanceMatrix),O==="instanceColor"&&A.instanceColor&&(k=A.instanceColor)),k!==void 0){const z=k.normalized,X=k.itemSize,Y=t.get(k);if(Y===void 0)continue;const $=Y.buffer,H=Y.type,Z=Y.bytesPerElement,ct=H===e.INT||H===e.UNSIGNED_INT||k.gpuType===yA;if(k.isInterleavedBufferAttribute){const ut=k.data,tt=ut.stride,et=k.offset;if(ut.isInstancedInterleavedBuffer){for(let st=0;st<I.locationSize;st++)m(I.location+st,ut.meshPerAttribute);A.isInstancedMesh!==!0&&D._maxInstanceCount===void 0&&(D._maxInstanceCount=ut.meshPerAttribute*ut.count)}else for(let st=0;st<I.locationSize;st++)g(I.location+st);e.bindBuffer(e.ARRAY_BUFFER,$);for(let st=0;st<I.locationSize;st++)y(I.location+st,X/I.locationSize,H,z,tt*Z,(et+X/I.locationSize*st)*Z,ct)}else{if(k.isInstancedBufferAttribute){for(let ut=0;ut<I.locationSize;ut++)m(I.location+ut,k.meshPerAttribute);A.isInstancedMesh!==!0&&D._maxInstanceCount===void 0&&(D._maxInstanceCount=k.meshPerAttribute*k.count)}else for(let ut=0;ut<I.locationSize;ut++)g(I.location+ut);e.bindBuffer(e.ARRAY_BUFFER,$);for(let ut=0;ut<I.locationSize;ut++)y(I.location+ut,X/I.locationSize,H,z,X*Z,X/I.locationSize*ut*Z,ct)}}else if(N!==void 0){const z=N[O];if(z!==void 0)switch(z.length){case 2:e.vertexAttrib2fv(I.location,z);break;case 3:e.vertexAttrib3fv(I.location,z);break;case 4:e.vertexAttrib4fv(I.location,z);break;default:e.vertexAttrib1fv(I.location,z)}}}}_()}function T(){w();for(const A in n){const E=n[A];for(const C in E){const D=E[C];for(const L in D)h(D[L].object),delete D[L];delete E[C]}delete n[A]}}function S(A){if(n[A.id]===void 0)return;const E=n[A.id];for(const C in E){const D=E[C];for(const L in D)h(D[L].object),delete D[L];delete E[C]}delete n[A.id]}function M(A){for(const E in n){const C=n[E];if(C[A.id]===void 0)continue;const D=C[A.id];for(const L in D)h(D[L].object),delete D[L];delete C[A.id]}}function w(){b(),o=!0,a!==i&&(a=i,u(a.object))}function b(){i.geometry=null,i.program=null,i.wireframe=!1}return{setup:s,reset:w,resetDefaultState:b,dispose:T,releaseStatesOfGeometry:S,releaseStatesOfProgram:M,initAttributes:p,enableAttribute:g,disableUnusedAttributes:_}}function rdt(e,t,r){let n;function i(u){n=u}function a(u,h){e.drawArrays(n,u,h),r.update(h,n,1)}function o(u,h,f){f!==0&&(e.drawArraysInstanced(n,u,h,f),r.update(h,n,f))}function s(u,h,f){if(f===0)return;t.get("WEBGL_multi_draw").multiDrawArraysWEBGL(n,u,0,h,0,f);let d=0;for(let v=0;v<f;v++)d+=h[v];r.update(d,n,1)}function l(u,h,f,c){if(f===0)return;const d=t.get("WEBGL_multi_draw");if(d===null)for(let v=0;v<u.length;v++)o(u[v],h[v],c[v]);else{d.multiDrawArraysInstancedWEBGL(n,u,0,h,0,c,0,f);let v=0;for(let p=0;p<f;p++)v+=h[p]*c[p];r.update(v,n,1)}}this.setMode=i,this.render=a,this.renderInstances=o,this.renderMultiDraw=s,this.renderMultiDrawInstances=l}function ndt(e,t,r,n){let i;function a(){if(i!==void 0)return i;if(t.has("EXT_texture_filter_anisotropic")===!0){const M=t.get("EXT_texture_filter_anisotropic");i=e.getParameter(M.MAX_TEXTURE_MAX_ANISOTROPY_EXT)}else i=0;return i}function o(M){return!(M!==ca&&n.convert(M)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_FORMAT))}function s(M){const w=M===Hv&&(t.has("EXT_color_buffer_half_float")||t.has("EXT_color_buffer_float"));return!(M!==zo&&n.convert(M)!==e.getParameter(e.IMPLEMENTATION_COLOR_READ_TYPE)&&M!==So&&!w)}function l(M){if(M==="highp"){if(e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.HIGH_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT).precision>0)return"highp";M="mediump"}return M==="mediump"&&e.getShaderPrecisionFormat(e.VERTEX_SHADER,e.MEDIUM_FLOAT).precision>0&&e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}let u=r.precision!==void 0?r.precision:"highp";const h=l(u);h!==u&&(console.warn("THREE.WebGLRenderer:",u,"not supported, using",h,"instead."),u=h);const f=r.logarithmicDepthBuffer===!0,c=r.reverseDepthBuffer===!0&&t.has("EXT_clip_control"),d=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),v=e.getParameter(e.MAX_VERTEX_TEXTURE_IMAGE_UNITS),p=e.getParameter(e.MAX_TEXTURE_SIZE),g=e.getParameter(e.MAX_CUBE_MAP_TEXTURE_SIZE),m=e.getParameter(e.MAX_VERTEX_ATTRIBS),_=e.getParameter(e.MAX_VERTEX_UNIFORM_VECTORS),y=e.getParameter(e.MAX_VARYING_VECTORS),x=e.getParameter(e.MAX_FRAGMENT_UNIFORM_VECTORS),T=v>0,S=e.getParameter(e.MAX_SAMPLES);return{isWebGL2:!0,getMaxAnisotropy:a,getMaxPrecision:l,textureFormatReadable:o,textureTypeReadable:s,precision:u,logarithmicDepthBuffer:f,reverseDepthBuffer:c,maxTextures:d,maxVertexTextures:v,maxTextureSize:p,maxCubemapSize:g,maxAttributes:m,maxVertexUniforms:_,maxVaryings:y,maxFragmentUniforms:x,vertexTextures:T,maxSamples:S}}function idt(e){const t=this;let r=null,n=0,i=!1,a=!1;const o=new Gl,s=new Pe,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(f,c){const d=f.length!==0||c||n!==0||i;return i=c,n=f.length,d},this.beginShadows=function(){a=!0,h(null)},this.endShadows=function(){a=!1},this.setGlobalState=function(f,c){r=h(f,c,0)},this.setState=function(f,c,d){const v=f.clippingPlanes,p=f.clipIntersection,g=f.clipShadows,m=e.get(f);if(!i||v===null||v.length===0||a&&!g)a?h(null):u();else{const _=a?0:n,y=_*4;let x=m.clippingState||null;l.value=x,x=h(v,c,y,d);for(let T=0;T!==y;++T)x[T]=r[T];m.clippingState=x,this.numIntersection=p?this.numPlanes:0,this.numPlanes+=_}};function u(){l.value!==r&&(l.value=r,l.needsUpdate=n>0),t.numPlanes=n,t.numIntersection=0}function h(f,c,d,v){const p=f!==null?f.length:0;let g=null;if(p!==0){if(g=l.value,v!==!0||g===null){const m=d+p*4,_=c.matrixWorldInverse;s.getNormalMatrix(_),(g===null||g.length<m)&&(g=new Float32Array(m));for(let y=0,x=d;y!==p;++y,x+=4)o.copy(f[y]).applyMatrix4(_,s),o.normal.toArray(g,x),g[x+3]=o.constant}l.value=g,l.needsUpdate=!0}return t.numPlanes=p,t.numIntersection=0,g}}function adt(e){let t=new WeakMap;function r(o,s){return s===sb?o.mapping=Df:s===lb&&(o.mapping=Lf),o}function n(o){if(o&&o.isTexture){const s=o.mapping;if(s===sb||s===lb)if(t.has(o)){const l=t.get(o).texture;return r(l,o.mapping)}else{const l=o.image;if(l&&l.height>0){const u=new lht(l.height);return u.fromEquirectangularTexture(e,o),t.set(o,u),o.addEventListener("dispose",i),r(u.texture,o.mapping)}else return null}}return o}function i(o){const s=o.target;s.removeEventListener("dispose",i);const l=t.get(s);l!==void 0&&(t.delete(s),l.dispose())}function a(){t=new WeakMap}return{get:n,dispose:a}}const Kh=4,mN=[.125,.215,.35,.446,.526,.582],ql=20,V1=new pht,_N=new fr;let H1=null,W1=0,X1=0,Y1=!1;const Vl=(1+Math.sqrt(5))/2,Uh=1/Vl,yN=[new lt(-Vl,Uh,0),new lt(Vl,Uh,0),new lt(-Uh,0,Vl),new lt(Uh,0,Vl),new lt(0,Vl,-Uh),new lt(0,Vl,Uh),new lt(-1,1,-1),new lt(1,1,-1),new lt(-1,1,1),new lt(1,1,1)];class xN{constructor(t){this._renderer=t,this._pingPongRenderTarget=null,this._lodMax=0,this._cubeSize=0,this._lodPlanes=[],this._sizeLods=[],this._sigmas=[],this._blurMaterial=null,this._cubemapMaterial=null,this._equirectMaterial=null,this._compileMaterial(this._blurMaterial)}fromScene(t,r=0,n=.1,i=100){H1=this._renderer.getRenderTarget(),W1=this._renderer.getActiveCubeFace(),X1=this._renderer.getActiveMipmapLevel(),Y1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1,this._setSize(256);const a=this._allocateTargets();return a.depthBuffer=!0,this._sceneToCubeUV(t,n,i,a),r>0&&this._blur(a,0,0,r),this._applyPMREM(a),this._cleanup(a),a}fromEquirectangular(t,r=null){return this._fromTexture(t,r)}fromCubemap(t,r=null){return this._fromTexture(t,r)}compileCubemapShader(){this._cubemapMaterial===null&&(this._cubemapMaterial=bN(),this._compileMaterial(this._cubemapMaterial))}compileEquirectangularShader(){this._equirectMaterial===null&&(this._equirectMaterial=TN(),this._compileMaterial(this._equirectMaterial))}dispose(){this._dispose(),this._cubemapMaterial!==null&&this._cubemapMaterial.dispose(),this._equirectMaterial!==null&&this._equirectMaterial.dispose()}_setSize(t){this._lodMax=Math.floor(Math.log2(t)),this._cubeSize=Math.pow(2,this._lodMax)}_dispose(){this._blurMaterial!==null&&this._blurMaterial.dispose(),this._pingPongRenderTarget!==null&&this._pingPongRenderTarget.dispose();for(let t=0;t<this._lodPlanes.length;t++)this._lodPlanes[t].dispose()}_cleanup(t){this._renderer.setRenderTarget(H1,W1,X1),this._renderer.xr.enabled=Y1,t.scissorTest=!1,Rg(t,0,0,t.width,t.height)}_fromTexture(t,r){t.mapping===Df||t.mapping===Lf?this._setSize(t.image.length===0?16:t.image[0].width||t.image[0].image.width):this._setSize(t.image.width/4),H1=this._renderer.getRenderTarget(),W1=this._renderer.getActiveCubeFace(),X1=this._renderer.getActiveMipmapLevel(),Y1=this._renderer.xr.enabled,this._renderer.xr.enabled=!1;const n=r||this._allocateTargets();return this._textureToCubeUV(t,n),this._applyPMREM(n),this._cleanup(n),n}_allocateTargets(){const t=3*Math.max(this._cubeSize,112),r=4*this._cubeSize,n={magFilter:za,minFilter:za,generateMipmaps:!1,type:Hv,format:ca,colorSpace:If,depthBuffer:!1},i=SN(t,r,n);if(this._pingPongRenderTarget===null||this._pingPongRenderTarget.width!==t||this._pingPongRenderTarget.height!==r){this._pingPongRenderTarget!==null&&this._dispose(),this._pingPongRenderTarget=SN(t,r,n);const{_lodMax:a}=this;({sizeLods:this._sizeLods,lodPlanes:this._lodPlanes,sigmas:this._sigmas}=odt(a)),this._blurMaterial=sdt(a,t,r)}return i}_compileMaterial(t){const r=new ka(this._lodPlanes[0],t);this._renderer.compile(r,V1)}_sceneToCubeUV(t,r,n,i){const s=new Bi(90,1,r,n),l=[1,-1,1,1,1,1],u=[1,1,1,-1,-1,-1],h=this._renderer,f=h.autoClear,c=h.toneMapping;h.getClearColor(_N),h.toneMapping=Ps,h.autoClear=!1;const d=new AA({name:"PMREM.Background",side:li,depthWrite:!1,depthTest:!1}),v=new ka(new sc,d);let p=!1;const g=t.background;g?g.isColor&&(d.color.copy(g),t.background=null,p=!0):(d.color.copy(_N),p=!0);for(let m=0;m<6;m++){const _=m%3;_===0?(s.up.set(0,l[m],0),s.lookAt(u[m],0,0)):_===1?(s.up.set(0,0,l[m]),s.lookAt(0,u[m],0)):(s.up.set(0,l[m],0),s.lookAt(0,0,u[m]));const y=this._cubeSize;Rg(i,_*y,m>2?y:0,y,y),h.setRenderTarget(i),p&&h.render(v,s),h.render(t,s)}v.geometry.dispose(),v.material.dispose(),h.toneMapping=c,h.autoClear=f,t.background=g}_textureToCubeUV(t,r){const n=this._renderer,i=t.mapping===Df||t.mapping===Lf;i?(this._cubemapMaterial===null&&(this._cubemapMaterial=bN()),this._cubemapMaterial.uniforms.flipEnvMap.value=t.isRenderTargetTexture===!1?-1:1):this._equirectMaterial===null&&(this._equirectMaterial=TN());const a=i?this._cubemapMaterial:this._equirectMaterial,o=new ka(this._lodPlanes[0],a),s=a.uniforms;s.envMap.value=t;const l=this._cubeSize;Rg(r,0,0,3*l,2*l),n.setRenderTarget(r),n.render(o,V1)}_applyPMREM(t){const r=this._renderer,n=r.autoClear;r.autoClear=!1;const i=this._lodPlanes.length;for(let a=1;a<i;a++){const o=Math.sqrt(this._sigmas[a]*this._sigmas[a]-this._sigmas[a-1]*this._sigmas[a-1]),s=yN[(i-a-1)%yN.length];this._blur(t,a-1,a,o,s)}r.autoClear=n}_blur(t,r,n,i,a){const o=this._pingPongRenderTarget;this._halfBlur(t,o,r,n,i,"latitudinal",a),this._halfBlur(o,t,n,n,i,"longitudinal",a)}_halfBlur(t,r,n,i,a,o,s){const l=this._renderer,u=this._blurMaterial;o!=="latitudinal"&&o!=="longitudinal"&&console.error("blur direction must be either latitudinal or longitudinal!");const h=3,f=new ka(this._lodPlanes[i],u),c=u.uniforms,d=this._sizeLods[n]-1,v=isFinite(a)?Math.PI/(2*d):2*Math.PI/(2*ql-1),p=a/v,g=isFinite(a)?1+Math.floor(h*p):ql;g>ql&&console.warn(`sigmaRadians, ${a}, is too large and will clip, as it requested ${g} samples when the maximum is set to ${ql}`);const m=[];let _=0;for(let M=0;M<ql;++M){const w=M/p,b=Math.exp(-w*w/2);m.push(b),M===0?_+=b:M<g&&(_+=2*b)}for(let M=0;M<m.length;M++)m[M]=m[M]/_;c.envMap.value=t.texture,c.samples.value=g,c.weights.value=m,c.latitudinal.value=o==="latitudinal",s&&(c.poleAxis.value=s);const{_lodMax:y}=this;c.dTheta.value=v,c.mipInt.value=y-n;const x=this._sizeLods[i],T=3*x*(i>y-Kh?i-y+Kh:0),S=4*(this._cubeSize-x);Rg(r,T,S,3*x,2*x),l.setRenderTarget(r),l.render(f,V1)}}function odt(e){const t=[],r=[],n=[];let i=e;const a=e-Kh+1+mN.length;for(let o=0;o<a;o++){const s=Math.pow(2,i);r.push(s);let l=1/s;o>e-Kh?l=mN[o-e+Kh-1]:o===0&&(l=0),n.push(l);const u=1/(s-2),h=-u,f=1+u,c=[h,h,f,h,f,f,h,h,f,f,h,f],d=6,v=6,p=3,g=2,m=1,_=new Float32Array(p*v*d),y=new Float32Array(g*v*d),x=new Float32Array(m*v*d);for(let S=0;S<d;S++){const M=S%3*2/3-1,w=S>2?0:-1,b=[M,w,0,M+2/3,w,0,M+2/3,w+1,0,M,w,0,M+2/3,w+1,0,M,w+1,0];_.set(b,p*v*S),y.set(c,g*v*S);const A=[S,S,S,S,S,S];x.set(A,m*v*S)}const T=new Yu;T.setAttribute("position",new Za(_,p)),T.setAttribute("uv",new Za(y,g)),T.setAttribute("faceIndex",new Za(x,m)),t.push(T),i>Kh&&i--}return{lodPlanes:t,sizeLods:r,sigmas:n}}function SN(e,t,r){const n=new Nu(e,t,r);return n.texture.mapping=g0,n.texture.name="PMREM.cubeUv",n.scissorTest=!0,n}function Rg(e,t,r,n,i){e.viewport.set(t,r,n,i),e.scissor.set(t,r,n,i)}function sdt(e,t,r){const n=new Float32Array(ql),i=new lt(0,1,0);return new Vs({name:"SphericalGaussianBlur",defines:{n:ql,CUBEUV_TEXEL_WIDTH:1/t,CUBEUV_TEXEL_HEIGHT:1/r,CUBEUV_MAX_MIP:`${e}.0`},uniforms:{envMap:{value:null},samples:{value:1},weights:{value:n},latitudinal:{value:!1},dTheta:{value:0},mipInt:{value:0},poleAxis:{value:i}},vertexShader:EA(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;
			uniform int samples;
			uniform float weights[ n ];
			uniform bool latitudinal;
			uniform float dTheta;
			uniform float mipInt;
			uniform vec3 poleAxis;

			#define ENVMAP_TYPE_CUBE_UV
			#include <cube_uv_reflection_fragment>

			vec3 getSample( float theta, vec3 axis ) {

				float cosTheta = cos( theta );
				// Rodrigues' axis-angle rotation
				vec3 sampleDirection = vOutputDirection * cosTheta
					+ cross( axis, vOutputDirection ) * sin( theta )
					+ axis * dot( axis, vOutputDirection ) * ( 1.0 - cosTheta );

				return bilinearCubeUV( envMap, sampleDirection, mipInt );

			}

			void main() {

				vec3 axis = latitudinal ? poleAxis : cross( poleAxis, vOutputDirection );

				if ( all( equal( axis, vec3( 0.0 ) ) ) ) {

					axis = vec3( vOutputDirection.z, 0.0, - vOutputDirection.x );

				}

				axis = normalize( axis );

				gl_FragColor = vec4( 0.0, 0.0, 0.0, 1.0 );
				gl_FragColor.rgb += weights[ 0 ] * getSample( 0.0, axis );

				for ( int i = 1; i < n; i++ ) {

					if ( i >= samples ) {

						break;

					}

					float theta = dTheta * float( i );
					gl_FragColor.rgb += weights[ i ] * getSample( -1.0 * theta, axis );
					gl_FragColor.rgb += weights[ i ] * getSample( theta, axis );

				}

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function TN(){return new Vs({name:"EquirectangularToCubeUV",uniforms:{envMap:{value:null}},vertexShader:EA(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			varying vec3 vOutputDirection;

			uniform sampler2D envMap;

			#include <common>

			void main() {

				vec3 outputDirection = normalize( vOutputDirection );
				vec2 uv = equirectUv( outputDirection );

				gl_FragColor = vec4( texture2D ( envMap, uv ).rgb, 1.0 );

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function bN(){return new Vs({name:"CubemapToCubeUV",uniforms:{envMap:{value:null},flipEnvMap:{value:-1}},vertexShader:EA(),fragmentShader:`

			precision mediump float;
			precision mediump int;

			uniform float flipEnvMap;

			varying vec3 vOutputDirection;

			uniform samplerCube envMap;

			void main() {

				gl_FragColor = textureCube( envMap, vec3( flipEnvMap * vOutputDirection.x, vOutputDirection.yz ) );

			}
		`,blending:Rs,depthTest:!1,depthWrite:!1})}function EA(){return`

		precision mediump float;
		precision mediump int;

		attribute float faceIndex;

		varying vec3 vOutputDirection;

		// RH coordinate system; PMREM face-indexing convention
		vec3 getDirection( vec2 uv, float face ) {

			uv = 2.0 * uv - 1.0;

			vec3 direction = vec3( uv, 1.0 );

			if ( face == 0.0 ) {

				direction = direction.zyx; // ( 1, v, u ) pos x

			} else if ( face == 1.0 ) {

				direction = direction.xzy;
				direction.xz *= -1.0; // ( -u, 1, -v ) pos y

			} else if ( face == 2.0 ) {

				direction.x *= -1.0; // ( -u, v, 1 ) pos z

			} else if ( face == 3.0 ) {

				direction = direction.zyx;
				direction.xz *= -1.0; // ( -1, v, -u ) neg x

			} else if ( face == 4.0 ) {

				direction = direction.xzy;
				direction.xy *= -1.0; // ( -u, -1, v ) neg y

			} else if ( face == 5.0 ) {

				direction.z *= -1.0; // ( u, v, -1 ) neg z

			}

			return direction;

		}

		void main() {

			vOutputDirection = getDirection( uv, faceIndex );
			gl_Position = vec4( position, 1.0 );

		}
	`}function ldt(e){let t=new WeakMap,r=null;function n(s){if(s&&s.isTexture){const l=s.mapping,u=l===sb||l===lb,h=l===Df||l===Lf;if(u||h){let f=t.get(s);const c=f!==void 0?f.texture.pmremVersion:0;if(s.isRenderTargetTexture&&s.pmremVersion!==c)return r===null&&(r=new xN(e)),f=u?r.fromEquirectangular(s,f):r.fromCubemap(s,f),f.texture.pmremVersion=s.pmremVersion,t.set(s,f),f.texture;if(f!==void 0)return f.texture;{const d=s.image;return u&&d&&d.height>0||h&&d&&i(d)?(r===null&&(r=new xN(e)),f=u?r.fromEquirectangular(s):r.fromCubemap(s),f.texture.pmremVersion=s.pmremVersion,t.set(s,f),s.addEventListener("dispose",a),f.texture):null}}}return s}function i(s){let l=0;const u=6;for(let h=0;h<u;h++)s[h]!==void 0&&l++;return l===u}function a(s){const l=s.target;l.removeEventListener("dispose",a);const u=t.get(l);u!==void 0&&(t.delete(l),u.dispose())}function o(){t=new WeakMap,r!==null&&(r.dispose(),r=null)}return{get:n,dispose:o}}function udt(e){const t={};function r(n){if(t[n]!==void 0)return t[n];let i;switch(n){case"WEBGL_depth_texture":i=e.getExtension("WEBGL_depth_texture")||e.getExtension("MOZ_WEBGL_depth_texture")||e.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":i=e.getExtension("EXT_texture_filter_anisotropic")||e.getExtension("MOZ_EXT_texture_filter_anisotropic")||e.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":i=e.getExtension("WEBGL_compressed_texture_s3tc")||e.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":i=e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:i=e.getExtension(n)}return t[n]=i,i}return{has:function(n){return r(n)!==null},init:function(){r("EXT_color_buffer_float"),r("WEBGL_clip_cull_distance"),r("OES_texture_float_linear"),r("EXT_color_buffer_half_float"),r("WEBGL_multisampled_render_to_texture"),r("WEBGL_render_shared_exponent")},get:function(n){const i=r(n);return i===null&&Hh("THREE.WebGLRenderer: "+n+" extension not supported."),i}}}function hdt(e,t,r,n){const i={},a=new WeakMap;function o(f){const c=f.target;c.index!==null&&t.remove(c.index);for(const v in c.attributes)t.remove(c.attributes[v]);c.removeEventListener("dispose",o),delete i[c.id];const d=a.get(c);d&&(t.remove(d),a.delete(c)),n.releaseStatesOfGeometry(c),c.isInstancedBufferGeometry===!0&&delete c._maxInstanceCount,r.memory.geometries--}function s(f,c){return i[c.id]===!0||(c.addEventListener("dispose",o),i[c.id]=!0,r.memory.geometries++),c}function l(f){const c=f.attributes;for(const d in c)t.update(c[d],e.ARRAY_BUFFER)}function u(f){const c=[],d=f.index,v=f.attributes.position;let p=0;if(d!==null){const _=d.array;p=d.version;for(let y=0,x=_.length;y<x;y+=3){const T=_[y+0],S=_[y+1],M=_[y+2];c.push(T,S,S,M,M,T)}}else if(v!==void 0){const _=v.array;p=v.version;for(let y=0,x=_.length/3-1;y<x;y+=3){const T=y+0,S=y+1,M=y+2;c.push(T,S,S,M,M,T)}}else return;const g=new(YG(c)?JG:jG)(c,1);g.version=p;const m=a.get(f);m&&t.remove(m),a.set(f,g)}function h(f){const c=a.get(f);if(c){const d=f.index;d!==null&&c.version<d.version&&u(f)}else u(f);return a.get(f)}return{get:s,update:l,getWireframeAttribute:h}}function fdt(e,t,r){let n;function i(c){n=c}let a,o;function s(c){a=c.type,o=c.bytesPerElement}function l(c,d){e.drawElements(n,d,a,c*o),r.update(d,n,1)}function u(c,d,v){v!==0&&(e.drawElementsInstanced(n,d,a,c*o,v),r.update(d,n,v))}function h(c,d,v){if(v===0)return;t.get("WEBGL_multi_draw").multiDrawElementsWEBGL(n,d,0,a,c,0,v);let g=0;for(let m=0;m<v;m++)g+=d[m];r.update(g,n,1)}function f(c,d,v,p){if(v===0)return;const g=t.get("WEBGL_multi_draw");if(g===null)for(let m=0;m<c.length;m++)u(c[m]/o,d[m],p[m]);else{g.multiDrawElementsInstancedWEBGL(n,d,0,a,c,0,p,0,v);let m=0;for(let _=0;_<v;_++)m+=d[_]*p[_];r.update(m,n,1)}}this.setMode=i,this.setIndex=s,this.render=l,this.renderInstances=u,this.renderMultiDraw=h,this.renderMultiDrawInstances=f}function cdt(e){const t={geometries:0,textures:0},r={frame:0,calls:0,triangles:0,points:0,lines:0};function n(a,o,s){switch(r.calls++,o){case e.TRIANGLES:r.triangles+=s*(a/3);break;case e.LINES:r.lines+=s*(a/2);break;case e.LINE_STRIP:r.lines+=s*(a-1);break;case e.LINE_LOOP:r.lines+=s*a;break;case e.POINTS:r.points+=s*a;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",o);break}}function i(){r.calls=0,r.triangles=0,r.points=0,r.lines=0}return{memory:t,render:r,programs:null,autoReset:!0,reset:i,update:n}}function ddt(e,t,r){const n=new WeakMap,i=new Ur;function a(o,s,l){const u=o.morphTargetInfluences,h=s.morphAttributes.position||s.morphAttributes.normal||s.morphAttributes.color,f=h!==void 0?h.length:0;let c=n.get(s);if(c===void 0||c.count!==f){let A=function(){w.dispose(),n.delete(s),s.removeEventListener("dispose",A)};var d=A;c!==void 0&&c.texture.dispose();const v=s.morphAttributes.position!==void 0,p=s.morphAttributes.normal!==void 0,g=s.morphAttributes.color!==void 0,m=s.morphAttributes.position||[],_=s.morphAttributes.normal||[],y=s.morphAttributes.color||[];let x=0;v===!0&&(x=1),p===!0&&(x=2),g===!0&&(x=3);let T=s.attributes.position.count*x,S=1;T>t.maxTextureSize&&(S=Math.ceil(T/t.maxTextureSize),T=t.maxTextureSize);const M=new Float32Array(T*S*4*f),w=new qG(M,T,S,f);w.type=So,w.needsUpdate=!0;const b=x*4;for(let E=0;E<f;E++){const C=m[E],D=_[E],L=y[E],P=T*S*4*E;for(let N=0;N<C.count;N++){const O=N*b;v===!0&&(i.fromBufferAttribute(C,N),M[P+O+0]=i.x,M[P+O+1]=i.y,M[P+O+2]=i.z,M[P+O+3]=0),p===!0&&(i.fromBufferAttribute(D,N),M[P+O+4]=i.x,M[P+O+5]=i.y,M[P+O+6]=i.z,M[P+O+7]=0),g===!0&&(i.fromBufferAttribute(L,N),M[P+O+8]=i.x,M[P+O+9]=i.y,M[P+O+10]=i.z,M[P+O+11]=L.itemSize===4?i.w:1)}}c={count:f,texture:w,size:new pr(T,S)},n.set(s,c),s.addEventListener("dispose",A)}if(o.isInstancedMesh===!0&&o.morphTexture!==null)l.getUniforms().setValue(e,"morphTexture",o.morphTexture,r);else{let v=0;for(let g=0;g<u.length;g++)v+=u[g];const p=s.morphTargetsRelative?1:1-v;l.getUniforms().setValue(e,"morphTargetBaseInfluence",p),l.getUniforms().setValue(e,"morphTargetInfluences",u)}l.getUniforms().setValue(e,"morphTargetsTexture",c.texture,r),l.getUniforms().setValue(e,"morphTargetsTextureSize",c.size)}return{update:a}}function vdt(e,t,r,n){let i=new WeakMap;function a(l){const u=n.render.frame,h=l.geometry,f=t.get(l,h);if(i.get(f)!==u&&(t.update(f),i.set(f,u)),l.isInstancedMesh&&(l.hasEventListener("dispose",s)===!1&&l.addEventListener("dispose",s),i.get(l)!==u&&(r.update(l.instanceMatrix,e.ARRAY_BUFFER),l.instanceColor!==null&&r.update(l.instanceColor,e.ARRAY_BUFFER),i.set(l,u))),l.isSkinnedMesh){const c=l.skeleton;i.get(c)!==u&&(c.update(),i.set(c,u))}return f}function o(){i=new WeakMap}function s(l){const u=l.target;u.removeEventListener("dispose",s),r.remove(u.instanceMatrix),u.instanceColor!==null&&r.remove(u.instanceColor)}return{update:a,dispose:o}}const a4=new ui,wN=new n4(1,1),o4=new qG,s4=new Xut,l4=new e4,MN=[],AN=[],EN=new Float32Array(16),CN=new Float32Array(9),DN=new Float32Array(4);function lc(e,t,r){const n=e[0];if(n<=0||n>0)return e;const i=t*r;let a=MN[i];if(a===void 0&&(a=new Float32Array(i),MN[i]=a),t!==0){n.toArray(a,0);for(let o=1,s=0;o!==t;++o)s+=r,e[o].toArray(a,s)}return a}function ln(e,t){if(e.length!==t.length)return!1;for(let r=0,n=e.length;r<n;r++)if(e[r]!==t[r])return!1;return!0}function un(e,t){for(let r=0,n=t.length;r<n;r++)e[r]=t[r]}function y0(e,t){let r=AN[t];r===void 0&&(r=new Int32Array(t),AN[t]=r);for(let n=0;n!==t;++n)r[n]=e.allocateTextureUnit();return r}function pdt(e,t){const r=this.cache;r[0]!==t&&(e.uniform1f(this.addr,t),r[0]=t)}function gdt(e,t){const r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2f(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(ln(r,t))return;e.uniform2fv(this.addr,t),un(r,t)}}function mdt(e,t){const r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3f(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else if(t.r!==void 0)(r[0]!==t.r||r[1]!==t.g||r[2]!==t.b)&&(e.uniform3f(this.addr,t.r,t.g,t.b),r[0]=t.r,r[1]=t.g,r[2]=t.b);else{if(ln(r,t))return;e.uniform3fv(this.addr,t),un(r,t)}}function _dt(e,t){const r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4f(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(ln(r,t))return;e.uniform4fv(this.addr,t),un(r,t)}}function ydt(e,t){const r=this.cache,n=t.elements;if(n===void 0){if(ln(r,t))return;e.uniformMatrix2fv(this.addr,!1,t),un(r,t)}else{if(ln(r,n))return;DN.set(n),e.uniformMatrix2fv(this.addr,!1,DN),un(r,n)}}function xdt(e,t){const r=this.cache,n=t.elements;if(n===void 0){if(ln(r,t))return;e.uniformMatrix3fv(this.addr,!1,t),un(r,t)}else{if(ln(r,n))return;CN.set(n),e.uniformMatrix3fv(this.addr,!1,CN),un(r,n)}}function Sdt(e,t){const r=this.cache,n=t.elements;if(n===void 0){if(ln(r,t))return;e.uniformMatrix4fv(this.addr,!1,t),un(r,t)}else{if(ln(r,n))return;EN.set(n),e.uniformMatrix4fv(this.addr,!1,EN),un(r,n)}}function Tdt(e,t){const r=this.cache;r[0]!==t&&(e.uniform1i(this.addr,t),r[0]=t)}function bdt(e,t){const r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2i(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(ln(r,t))return;e.uniform2iv(this.addr,t),un(r,t)}}function wdt(e,t){const r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3i(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(ln(r,t))return;e.uniform3iv(this.addr,t),un(r,t)}}function Mdt(e,t){const r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4i(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(ln(r,t))return;e.uniform4iv(this.addr,t),un(r,t)}}function Adt(e,t){const r=this.cache;r[0]!==t&&(e.uniform1ui(this.addr,t),r[0]=t)}function Edt(e,t){const r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y)&&(e.uniform2ui(this.addr,t.x,t.y),r[0]=t.x,r[1]=t.y);else{if(ln(r,t))return;e.uniform2uiv(this.addr,t),un(r,t)}}function Cdt(e,t){const r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z)&&(e.uniform3ui(this.addr,t.x,t.y,t.z),r[0]=t.x,r[1]=t.y,r[2]=t.z);else{if(ln(r,t))return;e.uniform3uiv(this.addr,t),un(r,t)}}function Ddt(e,t){const r=this.cache;if(t.x!==void 0)(r[0]!==t.x||r[1]!==t.y||r[2]!==t.z||r[3]!==t.w)&&(e.uniform4ui(this.addr,t.x,t.y,t.z,t.w),r[0]=t.x,r[1]=t.y,r[2]=t.z,r[3]=t.w);else{if(ln(r,t))return;e.uniform4uiv(this.addr,t),un(r,t)}}function Ldt(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i);let a;this.type===e.SAMPLER_2D_SHADOW?(wN.compareFunction=XG,a=wN):a=a4,r.setTexture2D(t||a,i)}function Rdt(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture3D(t||s4,i)}function Pdt(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTextureCube(t||l4,i)}function Idt(e,t,r){const n=this.cache,i=r.allocateTextureUnit();n[0]!==i&&(e.uniform1i(this.addr,i),n[0]=i),r.setTexture2DArray(t||o4,i)}function Ndt(e){switch(e){case 5126:return pdt;case 35664:return gdt;case 35665:return mdt;case 35666:return _dt;case 35674:return ydt;case 35675:return xdt;case 35676:return Sdt;case 5124:case 35670:return Tdt;case 35667:case 35671:return bdt;case 35668:case 35672:return wdt;case 35669:case 35673:return Mdt;case 5125:return Adt;case 36294:return Edt;case 36295:return Cdt;case 36296:return Ddt;case 35678:case 36198:case 36298:case 36306:case 35682:return Ldt;case 35679:case 36299:case 36307:return Rdt;case 35680:case 36300:case 36308:case 36293:return Pdt;case 36289:case 36303:case 36311:case 36292:return Idt}}function Odt(e,t){e.uniform1fv(this.addr,t)}function Fdt(e,t){const r=lc(t,this.size,2);e.uniform2fv(this.addr,r)}function Bdt(e,t){const r=lc(t,this.size,3);e.uniform3fv(this.addr,r)}function Udt(e,t){const r=lc(t,this.size,4);e.uniform4fv(this.addr,r)}function zdt(e,t){const r=lc(t,this.size,4);e.uniformMatrix2fv(this.addr,!1,r)}function kdt(e,t){const r=lc(t,this.size,9);e.uniformMatrix3fv(this.addr,!1,r)}function Gdt(e,t){const r=lc(t,this.size,16);e.uniformMatrix4fv(this.addr,!1,r)}function Vdt(e,t){e.uniform1iv(this.addr,t)}function Hdt(e,t){e.uniform2iv(this.addr,t)}function Wdt(e,t){e.uniform3iv(this.addr,t)}function Xdt(e,t){e.uniform4iv(this.addr,t)}function Ydt(e,t){e.uniform1uiv(this.addr,t)}function Zdt(e,t){e.uniform2uiv(this.addr,t)}function qdt(e,t){e.uniform3uiv(this.addr,t)}function $dt(e,t){e.uniform4uiv(this.addr,t)}function Kdt(e,t,r){const n=this.cache,i=t.length,a=y0(r,i);ln(n,a)||(e.uniform1iv(this.addr,a),un(n,a));for(let o=0;o!==i;++o)r.setTexture2D(t[o]||a4,a[o])}function jdt(e,t,r){const n=this.cache,i=t.length,a=y0(r,i);ln(n,a)||(e.uniform1iv(this.addr,a),un(n,a));for(let o=0;o!==i;++o)r.setTexture3D(t[o]||s4,a[o])}function Jdt(e,t,r){const n=this.cache,i=t.length,a=y0(r,i);ln(n,a)||(e.uniform1iv(this.addr,a),un(n,a));for(let o=0;o!==i;++o)r.setTextureCube(t[o]||l4,a[o])}function Qdt(e,t,r){const n=this.cache,i=t.length,a=y0(r,i);ln(n,a)||(e.uniform1iv(this.addr,a),un(n,a));for(let o=0;o!==i;++o)r.setTexture2DArray(t[o]||o4,a[o])}function tvt(e){switch(e){case 5126:return Odt;case 35664:return Fdt;case 35665:return Bdt;case 35666:return Udt;case 35674:return zdt;case 35675:return kdt;case 35676:return Gdt;case 5124:case 35670:return Vdt;case 35667:case 35671:return Hdt;case 35668:case 35672:return Wdt;case 35669:case 35673:return Xdt;case 5125:return Ydt;case 36294:return Zdt;case 36295:return qdt;case 36296:return $dt;case 35678:case 36198:case 36298:case 36306:case 35682:return Kdt;case 35679:case 36299:case 36307:return jdt;case 35680:case 36300:case 36308:case 36293:return Jdt;case 36289:case 36303:case 36311:case 36292:return Qdt}}class evt{constructor(t,r,n){this.id=t,this.addr=n,this.cache=[],this.type=r.type,this.setValue=Ndt(r.type)}}class rvt{constructor(t,r,n){this.id=t,this.addr=n,this.cache=[],this.type=r.type,this.size=r.size,this.setValue=tvt(r.type)}}class nvt{constructor(t){this.id=t,this.seq=[],this.map={}}setValue(t,r,n){const i=this.seq;for(let a=0,o=i.length;a!==o;++a){const s=i[a];s.setValue(t,r[s.id],n)}}}const Z1=/(\w+)(\])?(\[|\.)?/g;function LN(e,t){e.seq.push(t),e.map[t.id]=t}function ivt(e,t,r){const n=e.name,i=n.length;for(Z1.lastIndex=0;;){const a=Z1.exec(n),o=Z1.lastIndex;let s=a[1];const l=a[2]==="]",u=a[3];if(l&&(s=s|0),u===void 0||u==="["&&o+2===i){LN(r,u===void 0?new evt(s,e,t):new rvt(s,e,t));break}else{let f=r.map[s];f===void 0&&(f=new nvt(s),LN(r,f)),r=f}}}class hm{constructor(t,r){this.seq=[],this.map={};const n=t.getProgramParameter(r,t.ACTIVE_UNIFORMS);for(let i=0;i<n;++i){const a=t.getActiveUniform(r,i),o=t.getUniformLocation(r,a.name);ivt(a,o,this)}}setValue(t,r,n,i){const a=this.map[r];a!==void 0&&a.setValue(t,n,i)}setOptional(t,r,n){const i=r[n];i!==void 0&&this.setValue(t,n,i)}static upload(t,r,n,i){for(let a=0,o=r.length;a!==o;++a){const s=r[a],l=n[s.id];l.needsUpdate!==!1&&s.setValue(t,l.value,i)}}static seqWithValue(t,r){const n=[];for(let i=0,a=t.length;i!==a;++i){const o=t[i];o.id in r&&n.push(o)}return n}}function RN(e,t,r){const n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}const avt=37297;let ovt=0;function svt(e,t){const r=e.split(`
`),n=[],i=Math.max(t-6,0),a=Math.min(t+6,r.length);for(let o=i;o<a;o++){const s=o+1;n.push(`${s===t?">":" "} ${s}: ${r[o]}`)}return n.join(`
`)}const PN=new Pe;function lvt(e){tr._getMatrix(PN,tr.workingColorSpace,e);const t=`mat3( ${PN.elements.map(r=>r.toFixed(4))} )`;switch(tr.getTransfer(e)){case m_:return[t,"LinearTransferOETF"];case cr:return[t,"sRGBTransferOETF"];default:return console.warn("THREE.WebGLProgram: Unsupported color space: ",e),[t,"LinearTransferOETF"]}}function IN(e,t,r){const n=e.getShaderParameter(t,e.COMPILE_STATUS),i=e.getShaderInfoLog(t).trim();if(n&&i==="")return"";const a=/ERROR: 0:(\d+)/.exec(i);if(a){const o=parseInt(a[1]);return r.toUpperCase()+`

`+i+`

`+svt(e.getShaderSource(t),o)}else return i}function uvt(e,t){const r=lvt(t);return[`vec4 ${e}( vec4 value ) {`,`	return ${r[1]}( vec4( value.rgb * ${r[0]}, value.a ) );`,"}"].join(`
`)}function hvt(e,t){let r;switch(t){case gut:r="Linear";break;case mut:r="Reinhard";break;case _ut:r="Cineon";break;case yut:r="ACESFilmic";break;case Sut:r="AgX";break;case Tut:r="Neutral";break;case xut:r="Custom";break;default:console.warn("THREE.WebGLProgram: Unsupported toneMapping:",t),r="Linear"}return"vec3 "+e+"( vec3 color ) { return "+r+"ToneMapping( color ); }"}const Pg=new lt;function fvt(){tr.getLuminanceCoefficients(Pg);const e=Pg.x.toFixed(4),t=Pg.y.toFixed(4),r=Pg.z.toFixed(4);return["float luminance( const in vec3 rgb ) {",`	const vec3 weights = vec3( ${e}, ${t}, ${r} );`,"	return dot( weights, rgb );","}"].join(`
`)}function cvt(e){return[e.extensionClipCullDistance?"#extension GL_ANGLE_clip_cull_distance : require":"",e.extensionMultiDraw?"#extension GL_ANGLE_multi_draw : require":""].filter(vd).join(`
`)}function dvt(e){const t=[];for(const r in e){const n=e[r];n!==!1&&t.push("#define "+r+" "+n)}return t.join(`
`)}function vvt(e,t){const r={},n=e.getProgramParameter(t,e.ACTIVE_ATTRIBUTES);for(let i=0;i<n;i++){const a=e.getActiveAttrib(t,i),o=a.name;let s=1;a.type===e.FLOAT_MAT2&&(s=2),a.type===e.FLOAT_MAT3&&(s=3),a.type===e.FLOAT_MAT4&&(s=4),r[o]={type:a.type,location:e.getAttribLocation(t,o),locationSize:s}}return r}function vd(e){return e!==""}function NN(e,t){const r=t.numSpotLightShadows+t.numSpotLightMaps-t.numSpotLightShadowsWithMaps;return e.replace(/NUM_DIR_LIGHTS/g,t.numDirLights).replace(/NUM_SPOT_LIGHTS/g,t.numSpotLights).replace(/NUM_SPOT_LIGHT_MAPS/g,t.numSpotLightMaps).replace(/NUM_SPOT_LIGHT_COORDS/g,r).replace(/NUM_RECT_AREA_LIGHTS/g,t.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,t.numPointLights).replace(/NUM_HEMI_LIGHTS/g,t.numHemiLights).replace(/NUM_DIR_LIGHT_SHADOWS/g,t.numDirLightShadows).replace(/NUM_SPOT_LIGHT_SHADOWS_WITH_MAPS/g,t.numSpotLightShadowsWithMaps).replace(/NUM_SPOT_LIGHT_SHADOWS/g,t.numSpotLightShadows).replace(/NUM_POINT_LIGHT_SHADOWS/g,t.numPointLightShadows)}function ON(e,t){return e.replace(/NUM_CLIPPING_PLANES/g,t.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,t.numClippingPlanes-t.numClipIntersection)}const pvt=/^[ \t]*#include +<([\w\d./]+)>/gm;function Ub(e){return e.replace(pvt,mvt)}const gvt=new Map;function mvt(e,t){let r=Fe[t];if(r===void 0){const n=gvt.get(t);if(n!==void 0)r=Fe[n],console.warn('THREE.WebGLRenderer: Shader chunk "%s" has been deprecated. Use "%s" instead.',t,n);else throw new Error("Can not resolve #include <"+t+">")}return Ub(r)}const _vt=/#pragma unroll_loop_start\s+for\s*\(\s*int\s+i\s*=\s*(\d+)\s*;\s*i\s*<\s*(\d+)\s*;\s*i\s*\+\+\s*\)\s*{([\s\S]+?)}\s+#pragma unroll_loop_end/g;function FN(e){return e.replace(_vt,yvt)}function yvt(e,t,r,n){let i="";for(let a=parseInt(t);a<parseInt(r);a++)i+=n.replace(/\[\s*i\s*\]/g,"[ "+a+" ]").replace(/UNROLLED_LOOP_INDEX/g,a);return i}function BN(e){let t=`precision ${e.precision} float;
	precision ${e.precision} int;
	precision ${e.precision} sampler2D;
	precision ${e.precision} samplerCube;
	precision ${e.precision} sampler3D;
	precision ${e.precision} sampler2DArray;
	precision ${e.precision} sampler2DShadow;
	precision ${e.precision} samplerCubeShadow;
	precision ${e.precision} sampler2DArrayShadow;
	precision ${e.precision} isampler2D;
	precision ${e.precision} isampler3D;
	precision ${e.precision} isamplerCube;
	precision ${e.precision} isampler2DArray;
	precision ${e.precision} usampler2D;
	precision ${e.precision} usampler3D;
	precision ${e.precision} usamplerCube;
	precision ${e.precision} usampler2DArray;
	`;return e.precision==="highp"?t+=`
#define HIGH_PRECISION`:e.precision==="mediump"?t+=`
#define MEDIUM_PRECISION`:e.precision==="lowp"&&(t+=`
#define LOW_PRECISION`),t}function xvt(e){let t="SHADOWMAP_TYPE_BASIC";return e.shadowMapType===PG?t="SHADOWMAP_TYPE_PCF":e.shadowMapType===$lt?t="SHADOWMAP_TYPE_PCF_SOFT":e.shadowMapType===co&&(t="SHADOWMAP_TYPE_VSM"),t}function Svt(e){let t="ENVMAP_TYPE_CUBE";if(e.envMap)switch(e.envMapMode){case Df:case Lf:t="ENVMAP_TYPE_CUBE";break;case g0:t="ENVMAP_TYPE_CUBE_UV";break}return t}function Tvt(e){let t="ENVMAP_MODE_REFLECTION";if(e.envMap)switch(e.envMapMode){case Lf:t="ENVMAP_MODE_REFRACTION";break}return t}function bvt(e){let t="ENVMAP_BLENDING_NONE";if(e.envMap)switch(e.combine){case IG:t="ENVMAP_BLENDING_MULTIPLY";break;case vut:t="ENVMAP_BLENDING_MIX";break;case put:t="ENVMAP_BLENDING_ADD";break}return t}function wvt(e){const t=e.envMapCubeUVHeight;if(t===null)return null;const r=Math.log2(t)-2,n=1/t;return{texelWidth:1/(3*Math.max(Math.pow(2,r),7*16)),texelHeight:n,maxMip:r}}function Mvt(e,t,r,n){const i=e.getContext(),a=r.defines;let o=r.vertexShader,s=r.fragmentShader;const l=xvt(r),u=Svt(r),h=Tvt(r),f=bvt(r),c=wvt(r),d=cvt(r),v=dvt(a),p=i.createProgram();let g,m,_=r.glslVersion?"#version "+r.glslVersion+`
`:"";r.isRawShaderMaterial?(g=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,v].filter(vd).join(`
`),g.length>0&&(g+=`
`),m=["#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,v].filter(vd).join(`
`),m.length>0&&(m+=`
`)):(g=[BN(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,v,r.extensionClipCullDistance?"#define USE_CLIP_DISTANCE":"",r.batching?"#define USE_BATCHING":"",r.batchingColor?"#define USE_BATCHING_COLOR":"",r.instancing?"#define USE_INSTANCING":"",r.instancingColor?"#define USE_INSTANCING_COLOR":"",r.instancingMorph?"#define USE_INSTANCING_MORPH":"",r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.map?"#define USE_MAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+h:"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.displacementMap?"#define USE_DISPLACEMENTMAP":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.mapUv?"#define MAP_UV "+r.mapUv:"",r.alphaMapUv?"#define ALPHAMAP_UV "+r.alphaMapUv:"",r.lightMapUv?"#define LIGHTMAP_UV "+r.lightMapUv:"",r.aoMapUv?"#define AOMAP_UV "+r.aoMapUv:"",r.emissiveMapUv?"#define EMISSIVEMAP_UV "+r.emissiveMapUv:"",r.bumpMapUv?"#define BUMPMAP_UV "+r.bumpMapUv:"",r.normalMapUv?"#define NORMALMAP_UV "+r.normalMapUv:"",r.displacementMapUv?"#define DISPLACEMENTMAP_UV "+r.displacementMapUv:"",r.metalnessMapUv?"#define METALNESSMAP_UV "+r.metalnessMapUv:"",r.roughnessMapUv?"#define ROUGHNESSMAP_UV "+r.roughnessMapUv:"",r.anisotropyMapUv?"#define ANISOTROPYMAP_UV "+r.anisotropyMapUv:"",r.clearcoatMapUv?"#define CLEARCOATMAP_UV "+r.clearcoatMapUv:"",r.clearcoatNormalMapUv?"#define CLEARCOAT_NORMALMAP_UV "+r.clearcoatNormalMapUv:"",r.clearcoatRoughnessMapUv?"#define CLEARCOAT_ROUGHNESSMAP_UV "+r.clearcoatRoughnessMapUv:"",r.iridescenceMapUv?"#define IRIDESCENCEMAP_UV "+r.iridescenceMapUv:"",r.iridescenceThicknessMapUv?"#define IRIDESCENCE_THICKNESSMAP_UV "+r.iridescenceThicknessMapUv:"",r.sheenColorMapUv?"#define SHEEN_COLORMAP_UV "+r.sheenColorMapUv:"",r.sheenRoughnessMapUv?"#define SHEEN_ROUGHNESSMAP_UV "+r.sheenRoughnessMapUv:"",r.specularMapUv?"#define SPECULARMAP_UV "+r.specularMapUv:"",r.specularColorMapUv?"#define SPECULAR_COLORMAP_UV "+r.specularColorMapUv:"",r.specularIntensityMapUv?"#define SPECULAR_INTENSITYMAP_UV "+r.specularIntensityMapUv:"",r.transmissionMapUv?"#define TRANSMISSIONMAP_UV "+r.transmissionMapUv:"",r.thicknessMapUv?"#define THICKNESSMAP_UV "+r.thicknessMapUv:"",r.vertexTangents&&r.flatShading===!1?"#define USE_TANGENT":"",r.vertexColors?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.flatShading?"#define FLAT_SHADED":"",r.skinning?"#define USE_SKINNING":"",r.morphTargets?"#define USE_MORPHTARGETS":"",r.morphNormals&&r.flatShading===!1?"#define USE_MORPHNORMALS":"",r.morphColors?"#define USE_MORPHCOLORS":"",r.morphTargetsCount>0?"#define MORPHTARGETS_TEXTURE_STRIDE "+r.morphTextureStride:"",r.morphTargetsCount>0?"#define MORPHTARGETS_COUNT "+r.morphTargetsCount:"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.sizeAttenuation?"#define USE_SIZEATTENUATION":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;","#ifdef USE_INSTANCING","	attribute mat4 instanceMatrix;","#endif","#ifdef USE_INSTANCING_COLOR","	attribute vec3 instanceColor;","#endif","#ifdef USE_INSTANCING_MORPH","	uniform sampler2D morphTexture;","#endif","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_UV1","	attribute vec2 uv1;","#endif","#ifdef USE_UV2","	attribute vec2 uv2;","#endif","#ifdef USE_UV3","	attribute vec2 uv3;","#endif","#ifdef USE_TANGENT","	attribute vec4 tangent;","#endif","#if defined( USE_COLOR_ALPHA )","	attribute vec4 color;","#elif defined( USE_COLOR )","	attribute vec3 color;","#endif","#ifdef USE_SKINNING","	attribute vec4 skinIndex;","	attribute vec4 skinWeight;","#endif",`
`].filter(vd).join(`
`),m=[BN(r),"#define SHADER_TYPE "+r.shaderType,"#define SHADER_NAME "+r.shaderName,v,r.useFog&&r.fog?"#define USE_FOG":"",r.useFog&&r.fogExp2?"#define FOG_EXP2":"",r.alphaToCoverage?"#define ALPHA_TO_COVERAGE":"",r.map?"#define USE_MAP":"",r.matcap?"#define USE_MATCAP":"",r.envMap?"#define USE_ENVMAP":"",r.envMap?"#define "+u:"",r.envMap?"#define "+h:"",r.envMap?"#define "+f:"",c?"#define CUBEUV_TEXEL_WIDTH "+c.texelWidth:"",c?"#define CUBEUV_TEXEL_HEIGHT "+c.texelHeight:"",c?"#define CUBEUV_MAX_MIP "+c.maxMip+".0":"",r.lightMap?"#define USE_LIGHTMAP":"",r.aoMap?"#define USE_AOMAP":"",r.bumpMap?"#define USE_BUMPMAP":"",r.normalMap?"#define USE_NORMALMAP":"",r.normalMapObjectSpace?"#define USE_NORMALMAP_OBJECTSPACE":"",r.normalMapTangentSpace?"#define USE_NORMALMAP_TANGENTSPACE":"",r.emissiveMap?"#define USE_EMISSIVEMAP":"",r.anisotropy?"#define USE_ANISOTROPY":"",r.anisotropyMap?"#define USE_ANISOTROPYMAP":"",r.clearcoat?"#define USE_CLEARCOAT":"",r.clearcoatMap?"#define USE_CLEARCOATMAP":"",r.clearcoatRoughnessMap?"#define USE_CLEARCOAT_ROUGHNESSMAP":"",r.clearcoatNormalMap?"#define USE_CLEARCOAT_NORMALMAP":"",r.dispersion?"#define USE_DISPERSION":"",r.iridescence?"#define USE_IRIDESCENCE":"",r.iridescenceMap?"#define USE_IRIDESCENCEMAP":"",r.iridescenceThicknessMap?"#define USE_IRIDESCENCE_THICKNESSMAP":"",r.specularMap?"#define USE_SPECULARMAP":"",r.specularColorMap?"#define USE_SPECULAR_COLORMAP":"",r.specularIntensityMap?"#define USE_SPECULAR_INTENSITYMAP":"",r.roughnessMap?"#define USE_ROUGHNESSMAP":"",r.metalnessMap?"#define USE_METALNESSMAP":"",r.alphaMap?"#define USE_ALPHAMAP":"",r.alphaTest?"#define USE_ALPHATEST":"",r.alphaHash?"#define USE_ALPHAHASH":"",r.sheen?"#define USE_SHEEN":"",r.sheenColorMap?"#define USE_SHEEN_COLORMAP":"",r.sheenRoughnessMap?"#define USE_SHEEN_ROUGHNESSMAP":"",r.transmission?"#define USE_TRANSMISSION":"",r.transmissionMap?"#define USE_TRANSMISSIONMAP":"",r.thicknessMap?"#define USE_THICKNESSMAP":"",r.vertexTangents&&r.flatShading===!1?"#define USE_TANGENT":"",r.vertexColors||r.instancingColor||r.batchingColor?"#define USE_COLOR":"",r.vertexAlphas?"#define USE_COLOR_ALPHA":"",r.vertexUv1s?"#define USE_UV1":"",r.vertexUv2s?"#define USE_UV2":"",r.vertexUv3s?"#define USE_UV3":"",r.pointsUvs?"#define USE_POINTS_UV":"",r.gradientMap?"#define USE_GRADIENTMAP":"",r.flatShading?"#define FLAT_SHADED":"",r.doubleSided?"#define DOUBLE_SIDED":"",r.flipSided?"#define FLIP_SIDED":"",r.shadowMapEnabled?"#define USE_SHADOWMAP":"",r.shadowMapEnabled?"#define "+l:"",r.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",r.numLightProbes>0?"#define USE_LIGHT_PROBES":"",r.decodeVideoTexture?"#define DECODE_VIDEO_TEXTURE":"",r.decodeVideoTextureEmissive?"#define DECODE_VIDEO_TEXTURE_EMISSIVE":"",r.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",r.reverseDepthBuffer?"#define USE_REVERSEDEPTHBUF":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;","uniform bool isOrthographic;",r.toneMapping!==Ps?"#define TONE_MAPPING":"",r.toneMapping!==Ps?Fe.tonemapping_pars_fragment:"",r.toneMapping!==Ps?hvt("toneMapping",r.toneMapping):"",r.dithering?"#define DITHERING":"",r.opaque?"#define OPAQUE":"",Fe.colorspace_pars_fragment,uvt("linearToOutputTexel",r.outputColorSpace),fvt(),r.useDepthPacking?"#define DEPTH_PACKING "+r.depthPacking:"",`
`].filter(vd).join(`
`)),o=Ub(o),o=NN(o,r),o=ON(o,r),s=Ub(s),s=NN(s,r),s=ON(s,r),o=FN(o),s=FN(s),r.isRawShaderMaterial!==!0&&(_=`#version 300 es
`,g=[d,"#define attribute in","#define varying out","#define texture2D texture"].join(`
`)+`
`+g,m=["#define varying in",r.glslVersion===JI?"":"layout(location = 0) out highp vec4 pc_fragColor;",r.glslVersion===JI?"":"#define gl_FragColor pc_fragColor","#define gl_FragDepthEXT gl_FragDepth","#define texture2D texture","#define textureCube texture","#define texture2DProj textureProj","#define texture2DLodEXT textureLod","#define texture2DProjLodEXT textureProjLod","#define textureCubeLodEXT textureLod","#define texture2DGradEXT textureGrad","#define texture2DProjGradEXT textureProjGrad","#define textureCubeGradEXT textureGrad"].join(`
`)+`
`+m);const y=_+g+o,x=_+m+s,T=RN(i,i.VERTEX_SHADER,y),S=RN(i,i.FRAGMENT_SHADER,x);i.attachShader(p,T),i.attachShader(p,S),r.index0AttributeName!==void 0?i.bindAttribLocation(p,0,r.index0AttributeName):r.morphTargets===!0&&i.bindAttribLocation(p,0,"position"),i.linkProgram(p);function M(E){if(e.debug.checkShaderErrors){const C=i.getProgramInfoLog(p).trim(),D=i.getShaderInfoLog(T).trim(),L=i.getShaderInfoLog(S).trim();let P=!0,N=!0;if(i.getProgramParameter(p,i.LINK_STATUS)===!1)if(P=!1,typeof e.debug.onShaderError=="function")e.debug.onShaderError(i,p,T,S);else{const O=IN(i,T,"vertex"),I=IN(i,S,"fragment");console.error("THREE.WebGLProgram: Shader Error "+i.getError()+" - VALIDATE_STATUS "+i.getProgramParameter(p,i.VALIDATE_STATUS)+`

Material Name: `+E.name+`
Material Type: `+E.type+`

Program Info Log: `+C+`
`+O+`
`+I)}else C!==""?console.warn("THREE.WebGLProgram: Program Info Log:",C):(D===""||L==="")&&(N=!1);N&&(E.diagnostics={runnable:P,programLog:C,vertexShader:{log:D,prefix:g},fragmentShader:{log:L,prefix:m}})}i.deleteShader(T),i.deleteShader(S),w=new hm(i,p),b=vvt(i,p)}let w;this.getUniforms=function(){return w===void 0&&M(this),w};let b;this.getAttributes=function(){return b===void 0&&M(this),b};let A=r.rendererExtensionParallelShaderCompile===!1;return this.isReady=function(){return A===!1&&(A=i.getProgramParameter(p,avt)),A},this.destroy=function(){n.releaseStatesOfProgram(this),i.deleteProgram(p),this.program=void 0},this.type=r.shaderType,this.name=r.shaderName,this.id=ovt++,this.cacheKey=t,this.usedTimes=1,this.program=p,this.vertexShader=T,this.fragmentShader=S,this}let Avt=0;class Evt{constructor(){this.shaderCache=new Map,this.materialCache=new Map}update(t){const r=t.vertexShader,n=t.fragmentShader,i=this._getShaderStage(r),a=this._getShaderStage(n),o=this._getShaderCacheForMaterial(t);return o.has(i)===!1&&(o.add(i),i.usedTimes++),o.has(a)===!1&&(o.add(a),a.usedTimes++),this}remove(t){const r=this.materialCache.get(t);for(const n of r)n.usedTimes--,n.usedTimes===0&&this.shaderCache.delete(n.code);return this.materialCache.delete(t),this}getVertexShaderID(t){return this._getShaderStage(t.vertexShader).id}getFragmentShaderID(t){return this._getShaderStage(t.fragmentShader).id}dispose(){this.shaderCache.clear(),this.materialCache.clear()}_getShaderCacheForMaterial(t){const r=this.materialCache;let n=r.get(t);return n===void 0&&(n=new Set,r.set(t,n)),n}_getShaderStage(t){const r=this.shaderCache;let n=r.get(t);return n===void 0&&(n=new Cvt(t),r.set(t,n)),n}}class Cvt{constructor(t){this.id=Avt++,this.code=t,this.usedTimes=0}}function Dvt(e,t,r,n,i,a,o){const s=new $G,l=new Evt,u=new Set,h=[],f=i.logarithmicDepthBuffer,c=i.vertexTextures;let d=i.precision;const v={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"toon",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",MeshMatcapMaterial:"matcap",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow",SpriteMaterial:"sprite"};function p(b){return u.add(b),b===0?"uv":`uv${b}`}function g(b,A,E,C,D){const L=C.fog,P=D.geometry,N=b.isMeshStandardMaterial?C.environment:null,O=(b.isMeshStandardMaterial?r:t).get(b.envMap||N),I=O&&O.mapping===g0?O.image.height:null,k=v[b.type];b.precision!==null&&(d=i.getMaxPrecision(b.precision),d!==b.precision&&console.warn("THREE.WebGLProgram.getParameters:",b.precision,"not supported, using",d,"instead."));const z=P.morphAttributes.position||P.morphAttributes.normal||P.morphAttributes.color,X=z!==void 0?z.length:0;let Y=0;P.morphAttributes.position!==void 0&&(Y=1),P.morphAttributes.normal!==void 0&&(Y=2),P.morphAttributes.color!==void 0&&(Y=3);let $,H,Z,ct;if(k){const ur=Pa[k];$=ur.vertexShader,H=ur.fragmentShader}else $=b.vertexShader,H=b.fragmentShader,l.update(b),Z=l.getVertexShaderID(b),ct=l.getFragmentShaderID(b);const ut=e.getRenderTarget(),tt=e.state.buffers.depth.getReversed(),et=D.isInstancedMesh===!0,st=D.isBatchedMesh===!0,nt=!!b.map,dt=!!b.matcap,At=!!O,G=!!b.aoMap,Dt=!!b.lightMap,Pt=!!b.bumpMap,Lt=!!b.normalMap,zt=!!b.displacementMap,ne=!!b.emissiveMap,kt=!!b.metalnessMap,V=!!b.roughnessMap,F=b.anisotropy>0,Q=b.clearcoat>0,_t=b.dispersion>0,gt=b.iridescence>0,pt=b.sheen>0,jt=b.transmission>0,Gt=F&&!!b.anisotropyMap,Jt=Q&&!!b.clearcoatMap,Ne=Q&&!!b.clearcoatNormalMap,wt=Q&&!!b.clearcoatRoughnessMap,qt=gt&&!!b.iridescenceMap,de=gt&&!!b.iridescenceThicknessMap,Se=pt&&!!b.sheenColorMap,ie=pt&&!!b.sheenRoughnessMap,qe=!!b.specularMap,Oe=!!b.specularColorMap,gr=!!b.specularIntensityMap,K=jt&&!!b.transmissionMap,Wt=jt&&!!b.thicknessMap,vt=!!b.gradientMap,St=!!b.alphaMap,$t=b.alphaTest>0,Zt=!!b.alphaHash,Re=!!b.extensions;let Ar=Ps;b.toneMapped&&(ut===null||ut.isXRRenderTarget===!0)&&(Ar=e.toneMapping);const Tn={shaderID:k,shaderType:b.type,shaderName:b.name,vertexShader:$,fragmentShader:H,defines:b.defines,customVertexShaderID:Z,customFragmentShaderID:ct,isRawShaderMaterial:b.isRawShaderMaterial===!0,glslVersion:b.glslVersion,precision:d,batching:st,batchingColor:st&&D._colorsTexture!==null,instancing:et,instancingColor:et&&D.instanceColor!==null,instancingMorph:et&&D.morphTexture!==null,supportsVertexTextures:c,outputColorSpace:ut===null?e.outputColorSpace:ut.isXRRenderTarget===!0?ut.texture.colorSpace:If,alphaToCoverage:!!b.alphaToCoverage,map:nt,matcap:dt,envMap:At,envMapMode:At&&O.mapping,envMapCubeUVHeight:I,aoMap:G,lightMap:Dt,bumpMap:Pt,normalMap:Lt,displacementMap:c&&zt,emissiveMap:ne,normalMapObjectSpace:Lt&&b.normalMapType===Eut,normalMapTangentSpace:Lt&&b.normalMapType===Aut,metalnessMap:kt,roughnessMap:V,anisotropy:F,anisotropyMap:Gt,clearcoat:Q,clearcoatMap:Jt,clearcoatNormalMap:Ne,clearcoatRoughnessMap:wt,dispersion:_t,iridescence:gt,iridescenceMap:qt,iridescenceThicknessMap:de,sheen:pt,sheenColorMap:Se,sheenRoughnessMap:ie,specularMap:qe,specularColorMap:Oe,specularIntensityMap:gr,transmission:jt,transmissionMap:K,thicknessMap:Wt,gradientMap:vt,opaque:b.transparent===!1&&b.blending===af&&b.alphaToCoverage===!1,alphaMap:St,alphaTest:$t,alphaHash:Zt,combine:b.combine,mapUv:nt&&p(b.map.channel),aoMapUv:G&&p(b.aoMap.channel),lightMapUv:Dt&&p(b.lightMap.channel),bumpMapUv:Pt&&p(b.bumpMap.channel),normalMapUv:Lt&&p(b.normalMap.channel),displacementMapUv:zt&&p(b.displacementMap.channel),emissiveMapUv:ne&&p(b.emissiveMap.channel),metalnessMapUv:kt&&p(b.metalnessMap.channel),roughnessMapUv:V&&p(b.roughnessMap.channel),anisotropyMapUv:Gt&&p(b.anisotropyMap.channel),clearcoatMapUv:Jt&&p(b.clearcoatMap.channel),clearcoatNormalMapUv:Ne&&p(b.clearcoatNormalMap.channel),clearcoatRoughnessMapUv:wt&&p(b.clearcoatRoughnessMap.channel),iridescenceMapUv:qt&&p(b.iridescenceMap.channel),iridescenceThicknessMapUv:de&&p(b.iridescenceThicknessMap.channel),sheenColorMapUv:Se&&p(b.sheenColorMap.channel),sheenRoughnessMapUv:ie&&p(b.sheenRoughnessMap.channel),specularMapUv:qe&&p(b.specularMap.channel),specularColorMapUv:Oe&&p(b.specularColorMap.channel),specularIntensityMapUv:gr&&p(b.specularIntensityMap.channel),transmissionMapUv:K&&p(b.transmissionMap.channel),thicknessMapUv:Wt&&p(b.thicknessMap.channel),alphaMapUv:St&&p(b.alphaMap.channel),vertexTangents:!!P.attributes.tangent&&(Lt||F),vertexColors:b.vertexColors,vertexAlphas:b.vertexColors===!0&&!!P.attributes.color&&P.attributes.color.itemSize===4,pointsUvs:D.isPoints===!0&&!!P.attributes.uv&&(nt||St),fog:!!L,useFog:b.fog===!0,fogExp2:!!L&&L.isFogExp2,flatShading:b.flatShading===!0,sizeAttenuation:b.sizeAttenuation===!0,logarithmicDepthBuffer:f,reverseDepthBuffer:tt,skinning:D.isSkinnedMesh===!0,morphTargets:P.morphAttributes.position!==void 0,morphNormals:P.morphAttributes.normal!==void 0,morphColors:P.morphAttributes.color!==void 0,morphTargetsCount:X,morphTextureStride:Y,numDirLights:A.directional.length,numPointLights:A.point.length,numSpotLights:A.spot.length,numSpotLightMaps:A.spotLightMap.length,numRectAreaLights:A.rectArea.length,numHemiLights:A.hemi.length,numDirLightShadows:A.directionalShadowMap.length,numPointLightShadows:A.pointShadowMap.length,numSpotLightShadows:A.spotShadowMap.length,numSpotLightShadowsWithMaps:A.numSpotLightShadowsWithMaps,numLightProbes:A.numLightProbes,numClippingPlanes:o.numPlanes,numClipIntersection:o.numIntersection,dithering:b.dithering,shadowMapEnabled:e.shadowMap.enabled&&E.length>0,shadowMapType:e.shadowMap.type,toneMapping:Ar,decodeVideoTexture:nt&&b.map.isVideoTexture===!0&&tr.getTransfer(b.map.colorSpace)===cr,decodeVideoTextureEmissive:ne&&b.emissiveMap.isVideoTexture===!0&&tr.getTransfer(b.emissiveMap.colorSpace)===cr,premultipliedAlpha:b.premultipliedAlpha,doubleSided:b.side===_o,flipSided:b.side===li,useDepthPacking:b.depthPacking>=0,depthPacking:b.depthPacking||0,index0AttributeName:b.index0AttributeName,extensionClipCullDistance:Re&&b.extensions.clipCullDistance===!0&&n.has("WEBGL_clip_cull_distance"),extensionMultiDraw:(Re&&b.extensions.multiDraw===!0||st)&&n.has("WEBGL_multi_draw"),rendererExtensionParallelShaderCompile:n.has("KHR_parallel_shader_compile"),customProgramCacheKey:b.customProgramCacheKey()};return Tn.vertexUv1s=u.has(1),Tn.vertexUv2s=u.has(2),Tn.vertexUv3s=u.has(3),u.clear(),Tn}function m(b){const A=[];if(b.shaderID?A.push(b.shaderID):(A.push(b.customVertexShaderID),A.push(b.customFragmentShaderID)),b.defines!==void 0)for(const E in b.defines)A.push(E),A.push(b.defines[E]);return b.isRawShaderMaterial===!1&&(_(A,b),y(A,b),A.push(e.outputColorSpace)),A.push(b.customProgramCacheKey),A.join()}function _(b,A){b.push(A.precision),b.push(A.outputColorSpace),b.push(A.envMapMode),b.push(A.envMapCubeUVHeight),b.push(A.mapUv),b.push(A.alphaMapUv),b.push(A.lightMapUv),b.push(A.aoMapUv),b.push(A.bumpMapUv),b.push(A.normalMapUv),b.push(A.displacementMapUv),b.push(A.emissiveMapUv),b.push(A.metalnessMapUv),b.push(A.roughnessMapUv),b.push(A.anisotropyMapUv),b.push(A.clearcoatMapUv),b.push(A.clearcoatNormalMapUv),b.push(A.clearcoatRoughnessMapUv),b.push(A.iridescenceMapUv),b.push(A.iridescenceThicknessMapUv),b.push(A.sheenColorMapUv),b.push(A.sheenRoughnessMapUv),b.push(A.specularMapUv),b.push(A.specularColorMapUv),b.push(A.specularIntensityMapUv),b.push(A.transmissionMapUv),b.push(A.thicknessMapUv),b.push(A.combine),b.push(A.fogExp2),b.push(A.sizeAttenuation),b.push(A.morphTargetsCount),b.push(A.morphAttributeCount),b.push(A.numDirLights),b.push(A.numPointLights),b.push(A.numSpotLights),b.push(A.numSpotLightMaps),b.push(A.numHemiLights),b.push(A.numRectAreaLights),b.push(A.numDirLightShadows),b.push(A.numPointLightShadows),b.push(A.numSpotLightShadows),b.push(A.numSpotLightShadowsWithMaps),b.push(A.numLightProbes),b.push(A.shadowMapType),b.push(A.toneMapping),b.push(A.numClippingPlanes),b.push(A.numClipIntersection),b.push(A.depthPacking)}function y(b,A){s.disableAll(),A.supportsVertexTextures&&s.enable(0),A.instancing&&s.enable(1),A.instancingColor&&s.enable(2),A.instancingMorph&&s.enable(3),A.matcap&&s.enable(4),A.envMap&&s.enable(5),A.normalMapObjectSpace&&s.enable(6),A.normalMapTangentSpace&&s.enable(7),A.clearcoat&&s.enable(8),A.iridescence&&s.enable(9),A.alphaTest&&s.enable(10),A.vertexColors&&s.enable(11),A.vertexAlphas&&s.enable(12),A.vertexUv1s&&s.enable(13),A.vertexUv2s&&s.enable(14),A.vertexUv3s&&s.enable(15),A.vertexTangents&&s.enable(16),A.anisotropy&&s.enable(17),A.alphaHash&&s.enable(18),A.batching&&s.enable(19),A.dispersion&&s.enable(20),A.batchingColor&&s.enable(21),b.push(s.mask),s.disableAll(),A.fog&&s.enable(0),A.useFog&&s.enable(1),A.flatShading&&s.enable(2),A.logarithmicDepthBuffer&&s.enable(3),A.reverseDepthBuffer&&s.enable(4),A.skinning&&s.enable(5),A.morphTargets&&s.enable(6),A.morphNormals&&s.enable(7),A.morphColors&&s.enable(8),A.premultipliedAlpha&&s.enable(9),A.shadowMapEnabled&&s.enable(10),A.doubleSided&&s.enable(11),A.flipSided&&s.enable(12),A.useDepthPacking&&s.enable(13),A.dithering&&s.enable(14),A.transmission&&s.enable(15),A.sheen&&s.enable(16),A.opaque&&s.enable(17),A.pointsUvs&&s.enable(18),A.decodeVideoTexture&&s.enable(19),A.decodeVideoTextureEmissive&&s.enable(20),A.alphaToCoverage&&s.enable(21),b.push(s.mask)}function x(b){const A=v[b.type];let E;if(A){const C=Pa[A];E=iht.clone(C.uniforms)}else E=b.uniforms;return E}function T(b,A){let E;for(let C=0,D=h.length;C<D;C++){const L=h[C];if(L.cacheKey===A){E=L,++E.usedTimes;break}}return E===void 0&&(E=new Mvt(e,A,b,a),h.push(E)),E}function S(b){if(--b.usedTimes===0){const A=h.indexOf(b);h[A]=h[h.length-1],h.pop(),b.destroy()}}function M(b){l.remove(b)}function w(){l.dispose()}return{getParameters:g,getProgramCacheKey:m,getUniforms:x,acquireProgram:T,releaseProgram:S,releaseShaderCache:M,programs:h,dispose:w}}function Lvt(){let e=new WeakMap;function t(o){return e.has(o)}function r(o){let s=e.get(o);return s===void 0&&(s={},e.set(o,s)),s}function n(o){e.delete(o)}function i(o,s,l){e.get(o)[s]=l}function a(){e=new WeakMap}return{has:t,get:r,remove:n,update:i,dispose:a}}function Rvt(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.material.id!==t.material.id?e.material.id-t.material.id:e.z!==t.z?e.z-t.z:e.id-t.id}function UN(e,t){return e.groupOrder!==t.groupOrder?e.groupOrder-t.groupOrder:e.renderOrder!==t.renderOrder?e.renderOrder-t.renderOrder:e.z!==t.z?t.z-e.z:e.id-t.id}function zN(){const e=[];let t=0;const r=[],n=[],i=[];function a(){t=0,r.length=0,n.length=0,i.length=0}function o(f,c,d,v,p,g){let m=e[t];return m===void 0?(m={id:f.id,object:f,geometry:c,material:d,groupOrder:v,renderOrder:f.renderOrder,z:p,group:g},e[t]=m):(m.id=f.id,m.object=f,m.geometry=c,m.material=d,m.groupOrder=v,m.renderOrder=f.renderOrder,m.z=p,m.group=g),t++,m}function s(f,c,d,v,p,g){const m=o(f,c,d,v,p,g);d.transmission>0?n.push(m):d.transparent===!0?i.push(m):r.push(m)}function l(f,c,d,v,p,g){const m=o(f,c,d,v,p,g);d.transmission>0?n.unshift(m):d.transparent===!0?i.unshift(m):r.unshift(m)}function u(f,c){r.length>1&&r.sort(f||Rvt),n.length>1&&n.sort(c||UN),i.length>1&&i.sort(c||UN)}function h(){for(let f=t,c=e.length;f<c;f++){const d=e[f];if(d.id===null)break;d.id=null,d.object=null,d.geometry=null,d.material=null,d.group=null}}return{opaque:r,transmissive:n,transparent:i,init:a,push:s,unshift:l,finish:h,sort:u}}function Pvt(){let e=new WeakMap;function t(n,i){const a=e.get(n);let o;return a===void 0?(o=new zN,e.set(n,[o])):i>=a.length?(o=new zN,a.push(o)):o=a[i],o}function r(){e=new WeakMap}return{get:t,dispose:r}}function Ivt(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={direction:new lt,color:new fr};break;case"SpotLight":r={position:new lt,direction:new lt,color:new fr,distance:0,coneCos:0,penumbraCos:0,decay:0};break;case"PointLight":r={position:new lt,color:new fr,distance:0,decay:0};break;case"HemisphereLight":r={direction:new lt,skyColor:new fr,groundColor:new fr};break;case"RectAreaLight":r={color:new fr,position:new lt,halfWidth:new lt,halfHeight:new lt};break}return e[t.id]=r,r}}}function Nvt(){const e={};return{get:function(t){if(e[t.id]!==void 0)return e[t.id];let r;switch(t.type){case"DirectionalLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pr};break;case"SpotLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pr};break;case"PointLight":r={shadowIntensity:1,shadowBias:0,shadowNormalBias:0,shadowRadius:1,shadowMapSize:new pr,shadowCameraNear:1,shadowCameraFar:1e3};break}return e[t.id]=r,r}}}let Ovt=0;function Fvt(e,t){return(t.castShadow?2:0)-(e.castShadow?2:0)+(t.map?1:0)-(e.map?1:0)}function Bvt(e){const t=new Ivt,r=Nvt(),n={version:0,hash:{directionalLength:-1,pointLength:-1,spotLength:-1,rectAreaLength:-1,hemiLength:-1,numDirectionalShadows:-1,numPointShadows:-1,numSpotShadows:-1,numSpotMaps:-1,numLightProbes:-1},ambient:[0,0,0],probe:[],directional:[],directionalShadow:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotLightMap:[],spotShadow:[],spotShadowMap:[],spotLightMatrix:[],rectArea:[],rectAreaLTC1:null,rectAreaLTC2:null,point:[],pointShadow:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[],numSpotLightShadowsWithMaps:0,numLightProbes:0};for(let u=0;u<9;u++)n.probe.push(new lt);const i=new lt,a=new qr,o=new qr;function s(u){let h=0,f=0,c=0;for(let b=0;b<9;b++)n.probe[b].set(0,0,0);let d=0,v=0,p=0,g=0,m=0,_=0,y=0,x=0,T=0,S=0,M=0;u.sort(Fvt);for(let b=0,A=u.length;b<A;b++){const E=u[b],C=E.color,D=E.intensity,L=E.distance,P=E.shadow&&E.shadow.map?E.shadow.map.texture:null;if(E.isAmbientLight)h+=C.r*D,f+=C.g*D,c+=C.b*D;else if(E.isLightProbe){for(let N=0;N<9;N++)n.probe[N].addScaledVector(E.sh.coefficients[N],D);M++}else if(E.isDirectionalLight){const N=t.get(E);if(N.color.copy(E.color).multiplyScalar(E.intensity),E.castShadow){const O=E.shadow,I=r.get(E);I.shadowIntensity=O.intensity,I.shadowBias=O.bias,I.shadowNormalBias=O.normalBias,I.shadowRadius=O.radius,I.shadowMapSize=O.mapSize,n.directionalShadow[d]=I,n.directionalShadowMap[d]=P,n.directionalShadowMatrix[d]=E.shadow.matrix,_++}n.directional[d]=N,d++}else if(E.isSpotLight){const N=t.get(E);N.position.setFromMatrixPosition(E.matrixWorld),N.color.copy(C).multiplyScalar(D),N.distance=L,N.coneCos=Math.cos(E.angle),N.penumbraCos=Math.cos(E.angle*(1-E.penumbra)),N.decay=E.decay,n.spot[p]=N;const O=E.shadow;if(E.map&&(n.spotLightMap[T]=E.map,T++,O.updateMatrices(E),E.castShadow&&S++),n.spotLightMatrix[p]=O.matrix,E.castShadow){const I=r.get(E);I.shadowIntensity=O.intensity,I.shadowBias=O.bias,I.shadowNormalBias=O.normalBias,I.shadowRadius=O.radius,I.shadowMapSize=O.mapSize,n.spotShadow[p]=I,n.spotShadowMap[p]=P,x++}p++}else if(E.isRectAreaLight){const N=t.get(E);N.color.copy(C).multiplyScalar(D),N.halfWidth.set(E.width*.5,0,0),N.halfHeight.set(0,E.height*.5,0),n.rectArea[g]=N,g++}else if(E.isPointLight){const N=t.get(E);if(N.color.copy(E.color).multiplyScalar(E.intensity),N.distance=E.distance,N.decay=E.decay,E.castShadow){const O=E.shadow,I=r.get(E);I.shadowIntensity=O.intensity,I.shadowBias=O.bias,I.shadowNormalBias=O.normalBias,I.shadowRadius=O.radius,I.shadowMapSize=O.mapSize,I.shadowCameraNear=O.camera.near,I.shadowCameraFar=O.camera.far,n.pointShadow[v]=I,n.pointShadowMap[v]=P,n.pointShadowMatrix[v]=E.shadow.matrix,y++}n.point[v]=N,v++}else if(E.isHemisphereLight){const N=t.get(E);N.skyColor.copy(E.color).multiplyScalar(D),N.groundColor.copy(E.groundColor).multiplyScalar(D),n.hemi[m]=N,m++}}g>0&&(e.has("OES_texture_float_linear")===!0?(n.rectAreaLTC1=Ht.LTC_FLOAT_1,n.rectAreaLTC2=Ht.LTC_FLOAT_2):(n.rectAreaLTC1=Ht.LTC_HALF_1,n.rectAreaLTC2=Ht.LTC_HALF_2)),n.ambient[0]=h,n.ambient[1]=f,n.ambient[2]=c;const w=n.hash;(w.directionalLength!==d||w.pointLength!==v||w.spotLength!==p||w.rectAreaLength!==g||w.hemiLength!==m||w.numDirectionalShadows!==_||w.numPointShadows!==y||w.numSpotShadows!==x||w.numSpotMaps!==T||w.numLightProbes!==M)&&(n.directional.length=d,n.spot.length=p,n.rectArea.length=g,n.point.length=v,n.hemi.length=m,n.directionalShadow.length=_,n.directionalShadowMap.length=_,n.pointShadow.length=y,n.pointShadowMap.length=y,n.spotShadow.length=x,n.spotShadowMap.length=x,n.directionalShadowMatrix.length=_,n.pointShadowMatrix.length=y,n.spotLightMatrix.length=x+T-S,n.spotLightMap.length=T,n.numSpotLightShadowsWithMaps=S,n.numLightProbes=M,w.directionalLength=d,w.pointLength=v,w.spotLength=p,w.rectAreaLength=g,w.hemiLength=m,w.numDirectionalShadows=_,w.numPointShadows=y,w.numSpotShadows=x,w.numSpotMaps=T,w.numLightProbes=M,n.version=Ovt++)}function l(u,h){let f=0,c=0,d=0,v=0,p=0;const g=h.matrixWorldInverse;for(let m=0,_=u.length;m<_;m++){const y=u[m];if(y.isDirectionalLight){const x=n.directional[f];x.direction.setFromMatrixPosition(y.matrixWorld),i.setFromMatrixPosition(y.target.matrixWorld),x.direction.sub(i),x.direction.transformDirection(g),f++}else if(y.isSpotLight){const x=n.spot[d];x.position.setFromMatrixPosition(y.matrixWorld),x.position.applyMatrix4(g),x.direction.setFromMatrixPosition(y.matrixWorld),i.setFromMatrixPosition(y.target.matrixWorld),x.direction.sub(i),x.direction.transformDirection(g),d++}else if(y.isRectAreaLight){const x=n.rectArea[v];x.position.setFromMatrixPosition(y.matrixWorld),x.position.applyMatrix4(g),o.identity(),a.copy(y.matrixWorld),a.premultiply(g),o.extractRotation(a),x.halfWidth.set(y.width*.5,0,0),x.halfHeight.set(0,y.height*.5,0),x.halfWidth.applyMatrix4(o),x.halfHeight.applyMatrix4(o),v++}else if(y.isPointLight){const x=n.point[c];x.position.setFromMatrixPosition(y.matrixWorld),x.position.applyMatrix4(g),c++}else if(y.isHemisphereLight){const x=n.hemi[p];x.direction.setFromMatrixPosition(y.matrixWorld),x.direction.transformDirection(g),p++}}}return{setup:s,setupView:l,state:n}}function kN(e){const t=new Bvt(e),r=[],n=[];function i(h){u.camera=h,r.length=0,n.length=0}function a(h){r.push(h)}function o(h){n.push(h)}function s(){t.setup(r)}function l(h){t.setupView(r,h)}const u={lightsArray:r,shadowsArray:n,camera:null,lights:t,transmissionRenderTarget:{}};return{init:i,state:u,setupLights:s,setupLightsView:l,pushLight:a,pushShadow:o}}function Uvt(e){let t=new WeakMap;function r(i,a=0){const o=t.get(i);let s;return o===void 0?(s=new kN(e),t.set(i,[s])):a>=o.length?(s=new kN(e),o.push(s)):s=o[a],s}function n(){t=new WeakMap}return{get:r,dispose:n}}const zvt=`void main() {
	gl_Position = vec4( position, 1.0 );
}`,kvt=`uniform sampler2D shadow_pass;
uniform vec2 resolution;
uniform float radius;
#include <packing>
void main() {
	const float samples = float( VSM_SAMPLES );
	float mean = 0.0;
	float squared_mean = 0.0;
	float uvStride = samples <= 1.0 ? 0.0 : 2.0 / ( samples - 1.0 );
	float uvStart = samples <= 1.0 ? 0.0 : - 1.0;
	for ( float i = 0.0; i < samples; i ++ ) {
		float uvOffset = uvStart + i * uvStride;
		#ifdef HORIZONTAL_PASS
			vec2 distribution = unpackRGBATo2Half( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( uvOffset, 0.0 ) * radius ) / resolution ) );
			mean += distribution.x;
			squared_mean += distribution.y * distribution.y + distribution.x * distribution.x;
		#else
			float depth = unpackRGBAToDepth( texture2D( shadow_pass, ( gl_FragCoord.xy + vec2( 0.0, uvOffset ) * radius ) / resolution ) );
			mean += depth;
			squared_mean += depth * depth;
		#endif
	}
	mean = mean / samples;
	squared_mean = squared_mean / samples;
	float std_dev = sqrt( squared_mean - mean * mean );
	gl_FragColor = pack2HalfToRGBA( vec2( mean, std_dev ) );
}`;function Gvt(e,t,r){let n=new r4;const i=new pr,a=new pr,o=new Ur,s=new cht({depthPacking:Mut}),l=new dht,u={},h=r.maxTextureSize,f={[Gs]:li,[li]:Gs,[_o]:_o},c=new Vs({defines:{VSM_SAMPLES:8},uniforms:{shadow_pass:{value:null},resolution:{value:new pr},radius:{value:4}},vertexShader:zvt,fragmentShader:kvt}),d=c.clone();d.defines.HORIZONTAL_PASS=1;const v=new Yu;v.setAttribute("position",new Za(new Float32Array([-1,-1,.5,3,-1,.5,-1,3,.5]),3));const p=new ka(v,c),g=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=PG;let m=this.type;this.render=function(S,M,w){if(g.enabled===!1||g.autoUpdate===!1&&g.needsUpdate===!1||S.length===0)return;const b=e.getRenderTarget(),A=e.getActiveCubeFace(),E=e.getActiveMipmapLevel(),C=e.state;C.setBlending(Rs),C.buffers.color.setClear(1,1,1,1),C.buffers.depth.setTest(!0),C.setScissorTest(!1);const D=m!==co&&this.type===co,L=m===co&&this.type!==co;for(let P=0,N=S.length;P<N;P++){const O=S[P],I=O.shadow;if(I===void 0){console.warn("THREE.WebGLShadowMap:",O,"has no shadow.");continue}if(I.autoUpdate===!1&&I.needsUpdate===!1)continue;i.copy(I.mapSize);const k=I.getFrameExtents();if(i.multiply(k),a.copy(I.mapSize),(i.x>h||i.y>h)&&(i.x>h&&(a.x=Math.floor(h/k.x),i.x=a.x*k.x,I.mapSize.x=a.x),i.y>h&&(a.y=Math.floor(h/k.y),i.y=a.y*k.y,I.mapSize.y=a.y)),I.map===null||D===!0||L===!0){const X=this.type!==co?{minFilter:ga,magFilter:ga}:{};I.map!==null&&I.map.dispose(),I.map=new Nu(i.x,i.y,X),I.map.texture.name=O.name+".shadowMap",I.camera.updateProjectionMatrix()}e.setRenderTarget(I.map),e.clear();const z=I.getViewportCount();for(let X=0;X<z;X++){const Y=I.getViewport(X);o.set(a.x*Y.x,a.y*Y.y,a.x*Y.z,a.y*Y.w),C.viewport(o),I.updateMatrices(O,X),n=I.getFrustum(),x(M,w,I.camera,O,this.type)}I.isPointLightShadow!==!0&&this.type===co&&_(I,w),I.needsUpdate=!1}m=this.type,g.needsUpdate=!1,e.setRenderTarget(b,A,E)};function _(S,M){const w=t.update(p);c.defines.VSM_SAMPLES!==S.blurSamples&&(c.defines.VSM_SAMPLES=S.blurSamples,d.defines.VSM_SAMPLES=S.blurSamples,c.needsUpdate=!0,d.needsUpdate=!0),S.mapPass===null&&(S.mapPass=new Nu(i.x,i.y)),c.uniforms.shadow_pass.value=S.map.texture,c.uniforms.resolution.value=S.mapSize,c.uniforms.radius.value=S.radius,e.setRenderTarget(S.mapPass),e.clear(),e.renderBufferDirect(M,null,w,c,p,null),d.uniforms.shadow_pass.value=S.mapPass.texture,d.uniforms.resolution.value=S.mapSize,d.uniforms.radius.value=S.radius,e.setRenderTarget(S.map),e.clear(),e.renderBufferDirect(M,null,w,d,p,null)}function y(S,M,w,b){let A=null;const E=w.isPointLight===!0?S.customDistanceMaterial:S.customDepthMaterial;if(E!==void 0)A=E;else if(A=w.isPointLight===!0?l:s,e.localClippingEnabled&&M.clipShadows===!0&&Array.isArray(M.clippingPlanes)&&M.clippingPlanes.length!==0||M.displacementMap&&M.displacementScale!==0||M.alphaMap&&M.alphaTest>0||M.map&&M.alphaTest>0){const C=A.uuid,D=M.uuid;let L=u[C];L===void 0&&(L={},u[C]=L);let P=L[D];P===void 0&&(P=A.clone(),L[D]=P,M.addEventListener("dispose",T)),A=P}if(A.visible=M.visible,A.wireframe=M.wireframe,b===co?A.side=M.shadowSide!==null?M.shadowSide:M.side:A.side=M.shadowSide!==null?M.shadowSide:f[M.side],A.alphaMap=M.alphaMap,A.alphaTest=M.alphaTest,A.map=M.map,A.clipShadows=M.clipShadows,A.clippingPlanes=M.clippingPlanes,A.clipIntersection=M.clipIntersection,A.displacementMap=M.displacementMap,A.displacementScale=M.displacementScale,A.displacementBias=M.displacementBias,A.wireframeLinewidth=M.wireframeLinewidth,A.linewidth=M.linewidth,w.isPointLight===!0&&A.isMeshDistanceMaterial===!0){const C=e.properties.get(A);C.light=w}return A}function x(S,M,w,b,A){if(S.visible===!1)return;if(S.layers.test(M.layers)&&(S.isMesh||S.isLine||S.isPoints)&&(S.castShadow||S.receiveShadow&&A===co)&&(!S.frustumCulled||n.intersectsObject(S))){S.modelViewMatrix.multiplyMatrices(w.matrixWorldInverse,S.matrixWorld);const D=t.update(S),L=S.material;if(Array.isArray(L)){const P=D.groups;for(let N=0,O=P.length;N<O;N++){const I=P[N],k=L[I.materialIndex];if(k&&k.visible){const z=y(S,k,b,A);S.onBeforeShadow(e,S,M,w,D,z,I),e.renderBufferDirect(w,null,D,z,S,I),S.onAfterShadow(e,S,M,w,D,z,I)}}}else if(L.visible){const P=y(S,L,b,A);S.onBeforeShadow(e,S,M,w,D,P,null),e.renderBufferDirect(w,null,D,P,S,null),S.onAfterShadow(e,S,M,w,D,P,null)}}const C=S.children;for(let D=0,L=C.length;D<L;D++)x(C[D],M,w,b,A)}function T(S){S.target.removeEventListener("dispose",T);for(const w in u){const b=u[w],A=S.target.uuid;A in b&&(b[A].dispose(),delete b[A])}}}const Vvt={[tb]:eb,[rb]:ab,[nb]:ob,[Cf]:ib,[eb]:tb,[ab]:rb,[ob]:nb,[ib]:Cf};function Hvt(e,t){function r(){let K=!1;const Wt=new Ur;let vt=null;const St=new Ur(0,0,0,0);return{setMask:function($t){vt!==$t&&!K&&(e.colorMask($t,$t,$t,$t),vt=$t)},setLocked:function($t){K=$t},setClear:function($t,Zt,Re,Ar,Tn){Tn===!0&&($t*=Ar,Zt*=Ar,Re*=Ar),Wt.set($t,Zt,Re,Ar),St.equals(Wt)===!1&&(e.clearColor($t,Zt,Re,Ar),St.copy(Wt))},reset:function(){K=!1,vt=null,St.set(-1,0,0,0)}}}function n(){let K=!1,Wt=!1,vt=null,St=null,$t=null;return{setReversed:function(Zt){if(Wt!==Zt){const Re=t.get("EXT_clip_control");Wt?Re.clipControlEXT(Re.LOWER_LEFT_EXT,Re.ZERO_TO_ONE_EXT):Re.clipControlEXT(Re.LOWER_LEFT_EXT,Re.NEGATIVE_ONE_TO_ONE_EXT);const Ar=$t;$t=null,this.setClear(Ar)}Wt=Zt},getReversed:function(){return Wt},setTest:function(Zt){Zt?ut(e.DEPTH_TEST):tt(e.DEPTH_TEST)},setMask:function(Zt){vt!==Zt&&!K&&(e.depthMask(Zt),vt=Zt)},setFunc:function(Zt){if(Wt&&(Zt=Vvt[Zt]),St!==Zt){switch(Zt){case tb:e.depthFunc(e.NEVER);break;case eb:e.depthFunc(e.ALWAYS);break;case rb:e.depthFunc(e.LESS);break;case Cf:e.depthFunc(e.LEQUAL);break;case nb:e.depthFunc(e.EQUAL);break;case ib:e.depthFunc(e.GEQUAL);break;case ab:e.depthFunc(e.GREATER);break;case ob:e.depthFunc(e.NOTEQUAL);break;default:e.depthFunc(e.LEQUAL)}St=Zt}},setLocked:function(Zt){K=Zt},setClear:function(Zt){$t!==Zt&&(Wt&&(Zt=1-Zt),e.clearDepth(Zt),$t=Zt)},reset:function(){K=!1,vt=null,St=null,$t=null,Wt=!1}}}function i(){let K=!1,Wt=null,vt=null,St=null,$t=null,Zt=null,Re=null,Ar=null,Tn=null;return{setTest:function(ur){K||(ur?ut(e.STENCIL_TEST):tt(e.STENCIL_TEST))},setMask:function(ur){Wt!==ur&&!K&&(e.stencilMask(ur),Wt=ur)},setFunc:function(ur,Ki,eo){(vt!==ur||St!==Ki||$t!==eo)&&(e.stencilFunc(ur,Ki,eo),vt=ur,St=Ki,$t=eo)},setOp:function(ur,Ki,eo){(Zt!==ur||Re!==Ki||Ar!==eo)&&(e.stencilOp(ur,Ki,eo),Zt=ur,Re=Ki,Ar=eo)},setLocked:function(ur){K=ur},setClear:function(ur){Tn!==ur&&(e.clearStencil(ur),Tn=ur)},reset:function(){K=!1,Wt=null,vt=null,St=null,$t=null,Zt=null,Re=null,Ar=null,Tn=null}}}const a=new r,o=new n,s=new i,l=new WeakMap,u=new WeakMap;let h={},f={},c=new WeakMap,d=[],v=null,p=!1,g=null,m=null,_=null,y=null,x=null,T=null,S=null,M=new fr(0,0,0),w=0,b=!1,A=null,E=null,C=null,D=null,L=null;const P=e.getParameter(e.MAX_COMBINED_TEXTURE_IMAGE_UNITS);let N=!1,O=0;const I=e.getParameter(e.VERSION);I.indexOf("WebGL")!==-1?(O=parseFloat(/^WebGL (\d)/.exec(I)[1]),N=O>=1):I.indexOf("OpenGL ES")!==-1&&(O=parseFloat(/^OpenGL ES (\d)/.exec(I)[1]),N=O>=2);let k=null,z={};const X=e.getParameter(e.SCISSOR_BOX),Y=e.getParameter(e.VIEWPORT),$=new Ur().fromArray(X),H=new Ur().fromArray(Y);function Z(K,Wt,vt,St){const $t=new Uint8Array(4),Zt=e.createTexture();e.bindTexture(K,Zt),e.texParameteri(K,e.TEXTURE_MIN_FILTER,e.NEAREST),e.texParameteri(K,e.TEXTURE_MAG_FILTER,e.NEAREST);for(let Re=0;Re<vt;Re++)K===e.TEXTURE_3D||K===e.TEXTURE_2D_ARRAY?e.texImage3D(Wt,0,e.RGBA,1,1,St,0,e.RGBA,e.UNSIGNED_BYTE,$t):e.texImage2D(Wt+Re,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,$t);return Zt}const ct={};ct[e.TEXTURE_2D]=Z(e.TEXTURE_2D,e.TEXTURE_2D,1),ct[e.TEXTURE_CUBE_MAP]=Z(e.TEXTURE_CUBE_MAP,e.TEXTURE_CUBE_MAP_POSITIVE_X,6),ct[e.TEXTURE_2D_ARRAY]=Z(e.TEXTURE_2D_ARRAY,e.TEXTURE_2D_ARRAY,1,1),ct[e.TEXTURE_3D]=Z(e.TEXTURE_3D,e.TEXTURE_3D,1,1),a.setClear(0,0,0,1),o.setClear(1),s.setClear(0),ut(e.DEPTH_TEST),o.setFunc(Cf),Pt(!1),Lt(YI),ut(e.CULL_FACE),G(Rs);function ut(K){h[K]!==!0&&(e.enable(K),h[K]=!0)}function tt(K){h[K]!==!1&&(e.disable(K),h[K]=!1)}function et(K,Wt){return f[K]!==Wt?(e.bindFramebuffer(K,Wt),f[K]=Wt,K===e.DRAW_FRAMEBUFFER&&(f[e.FRAMEBUFFER]=Wt),K===e.FRAMEBUFFER&&(f[e.DRAW_FRAMEBUFFER]=Wt),!0):!1}function st(K,Wt){let vt=d,St=!1;if(K){vt=c.get(Wt),vt===void 0&&(vt=[],c.set(Wt,vt));const $t=K.textures;if(vt.length!==$t.length||vt[0]!==e.COLOR_ATTACHMENT0){for(let Zt=0,Re=$t.length;Zt<Re;Zt++)vt[Zt]=e.COLOR_ATTACHMENT0+Zt;vt.length=$t.length,St=!0}}else vt[0]!==e.BACK&&(vt[0]=e.BACK,St=!0);St&&e.drawBuffers(vt)}function nt(K){return v!==K?(e.useProgram(K),v=K,!0):!1}const dt={[Zl]:e.FUNC_ADD,[jlt]:e.FUNC_SUBTRACT,[Jlt]:e.FUNC_REVERSE_SUBTRACT};dt[Qlt]=e.MIN,dt[tut]=e.MAX;const At={[eut]:e.ZERO,[rut]:e.ONE,[nut]:e.SRC_COLOR,[JT]:e.SRC_ALPHA,[uut]:e.SRC_ALPHA_SATURATE,[sut]:e.DST_COLOR,[aut]:e.DST_ALPHA,[iut]:e.ONE_MINUS_SRC_COLOR,[QT]:e.ONE_MINUS_SRC_ALPHA,[lut]:e.ONE_MINUS_DST_COLOR,[out]:e.ONE_MINUS_DST_ALPHA,[hut]:e.CONSTANT_COLOR,[fut]:e.ONE_MINUS_CONSTANT_COLOR,[cut]:e.CONSTANT_ALPHA,[dut]:e.ONE_MINUS_CONSTANT_ALPHA};function G(K,Wt,vt,St,$t,Zt,Re,Ar,Tn,ur){if(K===Rs){p===!0&&(tt(e.BLEND),p=!1);return}if(p===!1&&(ut(e.BLEND),p=!0),K!==Klt){if(K!==g||ur!==b){if((m!==Zl||x!==Zl)&&(e.blendEquation(e.FUNC_ADD),m=Zl,x=Zl),ur)switch(K){case af:e.blendFuncSeparate(e.ONE,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case ZI:e.blendFunc(e.ONE,e.ONE);break;case qI:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case $I:e.blendFuncSeparate(e.ZERO,e.SRC_COLOR,e.ZERO,e.SRC_ALPHA);break;default:console.error("THREE.WebGLState: Invalid blending: ",K);break}else switch(K){case af:e.blendFuncSeparate(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA);break;case ZI:e.blendFunc(e.SRC_ALPHA,e.ONE);break;case qI:e.blendFuncSeparate(e.ZERO,e.ONE_MINUS_SRC_COLOR,e.ZERO,e.ONE);break;case $I:e.blendFunc(e.ZERO,e.SRC_COLOR);break;default:console.error("THREE.WebGLState: Invalid blending: ",K);break}_=null,y=null,T=null,S=null,M.set(0,0,0),w=0,g=K,b=ur}return}$t=$t||Wt,Zt=Zt||vt,Re=Re||St,(Wt!==m||$t!==x)&&(e.blendEquationSeparate(dt[Wt],dt[$t]),m=Wt,x=$t),(vt!==_||St!==y||Zt!==T||Re!==S)&&(e.blendFuncSeparate(At[vt],At[St],At[Zt],At[Re]),_=vt,y=St,T=Zt,S=Re),(Ar.equals(M)===!1||Tn!==w)&&(e.blendColor(Ar.r,Ar.g,Ar.b,Tn),M.copy(Ar),w=Tn),g=K,b=!1}function Dt(K,Wt){K.side===_o?tt(e.CULL_FACE):ut(e.CULL_FACE);let vt=K.side===li;Wt&&(vt=!vt),Pt(vt),K.blending===af&&K.transparent===!1?G(Rs):G(K.blending,K.blendEquation,K.blendSrc,K.blendDst,K.blendEquationAlpha,K.blendSrcAlpha,K.blendDstAlpha,K.blendColor,K.blendAlpha,K.premultipliedAlpha),o.setFunc(K.depthFunc),o.setTest(K.depthTest),o.setMask(K.depthWrite),a.setMask(K.colorWrite);const St=K.stencilWrite;s.setTest(St),St&&(s.setMask(K.stencilWriteMask),s.setFunc(K.stencilFunc,K.stencilRef,K.stencilFuncMask),s.setOp(K.stencilFail,K.stencilZFail,K.stencilZPass)),ne(K.polygonOffset,K.polygonOffsetFactor,K.polygonOffsetUnits),K.alphaToCoverage===!0?ut(e.SAMPLE_ALPHA_TO_COVERAGE):tt(e.SAMPLE_ALPHA_TO_COVERAGE)}function Pt(K){A!==K&&(K?e.frontFace(e.CW):e.frontFace(e.CCW),A=K)}function Lt(K){K!==Zlt?(ut(e.CULL_FACE),K!==E&&(K===YI?e.cullFace(e.BACK):K===qlt?e.cullFace(e.FRONT):e.cullFace(e.FRONT_AND_BACK))):tt(e.CULL_FACE),E=K}function zt(K){K!==C&&(N&&e.lineWidth(K),C=K)}function ne(K,Wt,vt){K?(ut(e.POLYGON_OFFSET_FILL),(D!==Wt||L!==vt)&&(e.polygonOffset(Wt,vt),D=Wt,L=vt)):tt(e.POLYGON_OFFSET_FILL)}function kt(K){K?ut(e.SCISSOR_TEST):tt(e.SCISSOR_TEST)}function V(K){K===void 0&&(K=e.TEXTURE0+P-1),k!==K&&(e.activeTexture(K),k=K)}function F(K,Wt,vt){vt===void 0&&(k===null?vt=e.TEXTURE0+P-1:vt=k);let St=z[vt];St===void 0&&(St={type:void 0,texture:void 0},z[vt]=St),(St.type!==K||St.texture!==Wt)&&(k!==vt&&(e.activeTexture(vt),k=vt),e.bindTexture(K,Wt||ct[K]),St.type=K,St.texture=Wt)}function Q(){const K=z[k];K!==void 0&&K.type!==void 0&&(e.bindTexture(K.type,null),K.type=void 0,K.texture=void 0)}function _t(){try{e.compressedTexImage2D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function gt(){try{e.compressedTexImage3D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function pt(){try{e.texSubImage2D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function jt(){try{e.texSubImage3D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Gt(){try{e.compressedTexSubImage2D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Jt(){try{e.compressedTexSubImage3D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Ne(){try{e.texStorage2D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function wt(){try{e.texStorage3D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function qt(){try{e.texImage2D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function de(){try{e.texImage3D.apply(e,arguments)}catch(K){console.error("THREE.WebGLState:",K)}}function Se(K){$.equals(K)===!1&&(e.scissor(K.x,K.y,K.z,K.w),$.copy(K))}function ie(K){H.equals(K)===!1&&(e.viewport(K.x,K.y,K.z,K.w),H.copy(K))}function qe(K,Wt){let vt=u.get(Wt);vt===void 0&&(vt=new WeakMap,u.set(Wt,vt));let St=vt.get(K);St===void 0&&(St=e.getUniformBlockIndex(Wt,K.name),vt.set(K,St))}function Oe(K,Wt){const St=u.get(Wt).get(K);l.get(Wt)!==St&&(e.uniformBlockBinding(Wt,St,K.__bindingPointIndex),l.set(Wt,St))}function gr(){e.disable(e.BLEND),e.disable(e.CULL_FACE),e.disable(e.DEPTH_TEST),e.disable(e.POLYGON_OFFSET_FILL),e.disable(e.SCISSOR_TEST),e.disable(e.STENCIL_TEST),e.disable(e.SAMPLE_ALPHA_TO_COVERAGE),e.blendEquation(e.FUNC_ADD),e.blendFunc(e.ONE,e.ZERO),e.blendFuncSeparate(e.ONE,e.ZERO,e.ONE,e.ZERO),e.blendColor(0,0,0,0),e.colorMask(!0,!0,!0,!0),e.clearColor(0,0,0,0),e.depthMask(!0),e.depthFunc(e.LESS),o.setReversed(!1),e.clearDepth(1),e.stencilMask(4294967295),e.stencilFunc(e.ALWAYS,0,4294967295),e.stencilOp(e.KEEP,e.KEEP,e.KEEP),e.clearStencil(0),e.cullFace(e.BACK),e.frontFace(e.CCW),e.polygonOffset(0,0),e.activeTexture(e.TEXTURE0),e.bindFramebuffer(e.FRAMEBUFFER,null),e.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),e.bindFramebuffer(e.READ_FRAMEBUFFER,null),e.useProgram(null),e.lineWidth(1),e.scissor(0,0,e.canvas.width,e.canvas.height),e.viewport(0,0,e.canvas.width,e.canvas.height),h={},k=null,z={},f={},c=new WeakMap,d=[],v=null,p=!1,g=null,m=null,_=null,y=null,x=null,T=null,S=null,M=new fr(0,0,0),w=0,b=!1,A=null,E=null,C=null,D=null,L=null,$.set(0,0,e.canvas.width,e.canvas.height),H.set(0,0,e.canvas.width,e.canvas.height),a.reset(),o.reset(),s.reset()}return{buffers:{color:a,depth:o,stencil:s},enable:ut,disable:tt,bindFramebuffer:et,drawBuffers:st,useProgram:nt,setBlending:G,setMaterial:Dt,setFlipSided:Pt,setCullFace:Lt,setLineWidth:zt,setPolygonOffset:ne,setScissorTest:kt,activeTexture:V,bindTexture:F,unbindTexture:Q,compressedTexImage2D:_t,compressedTexImage3D:gt,texImage2D:qt,texImage3D:de,updateUBOMapping:qe,uniformBlockBinding:Oe,texStorage2D:Ne,texStorage3D:wt,texSubImage2D:pt,texSubImage3D:jt,compressedTexSubImage2D:Gt,compressedTexSubImage3D:Jt,scissor:Se,viewport:ie,reset:gr}}function Wvt(e,t,r,n,i,a,o){const s=t.has("WEBGL_multisampled_render_to_texture")?t.get("WEBGL_multisampled_render_to_texture"):null,l=typeof navigator>"u"?!1:/OculusBrowser/g.test(navigator.userAgent),u=new pr,h=new WeakMap;let f;const c=new WeakMap;let d=!1;try{d=typeof OffscreenCanvas<"u"&&new OffscreenCanvas(1,1).getContext("2d")!==null}catch{}function v(V,F){return d?new OffscreenCanvas(V,F):y_("canvas")}function p(V,F,Q){let _t=1;const gt=kt(V);if((gt.width>Q||gt.height>Q)&&(_t=Q/Math.max(gt.width,gt.height)),_t<1)if(typeof HTMLImageElement<"u"&&V instanceof HTMLImageElement||typeof HTMLCanvasElement<"u"&&V instanceof HTMLCanvasElement||typeof ImageBitmap<"u"&&V instanceof ImageBitmap||typeof VideoFrame<"u"&&V instanceof VideoFrame){const pt=Math.floor(_t*gt.width),jt=Math.floor(_t*gt.height);f===void 0&&(f=v(pt,jt));const Gt=F?v(pt,jt):f;return Gt.width=pt,Gt.height=jt,Gt.getContext("2d").drawImage(V,0,0,pt,jt),console.warn("THREE.WebGLRenderer: Texture has been resized from ("+gt.width+"x"+gt.height+") to ("+pt+"x"+jt+")."),Gt}else return"data"in V&&console.warn("THREE.WebGLRenderer: Image in DataTexture is too big ("+gt.width+"x"+gt.height+")."),V;return V}function g(V){return V.generateMipmaps}function m(V){e.generateMipmap(V)}function _(V){return V.isWebGLCubeRenderTarget?e.TEXTURE_CUBE_MAP:V.isWebGL3DRenderTarget?e.TEXTURE_3D:V.isWebGLArrayRenderTarget||V.isCompressedArrayTexture?e.TEXTURE_2D_ARRAY:e.TEXTURE_2D}function y(V,F,Q,_t,gt=!1){if(V!==null){if(e[V]!==void 0)return e[V];console.warn("THREE.WebGLRenderer: Attempt to use non-existing WebGL internal format '"+V+"'")}let pt=F;if(F===e.RED&&(Q===e.FLOAT&&(pt=e.R32F),Q===e.HALF_FLOAT&&(pt=e.R16F),Q===e.UNSIGNED_BYTE&&(pt=e.R8)),F===e.RED_INTEGER&&(Q===e.UNSIGNED_BYTE&&(pt=e.R8UI),Q===e.UNSIGNED_SHORT&&(pt=e.R16UI),Q===e.UNSIGNED_INT&&(pt=e.R32UI),Q===e.BYTE&&(pt=e.R8I),Q===e.SHORT&&(pt=e.R16I),Q===e.INT&&(pt=e.R32I)),F===e.RG&&(Q===e.FLOAT&&(pt=e.RG32F),Q===e.HALF_FLOAT&&(pt=e.RG16F),Q===e.UNSIGNED_BYTE&&(pt=e.RG8)),F===e.RG_INTEGER&&(Q===e.UNSIGNED_BYTE&&(pt=e.RG8UI),Q===e.UNSIGNED_SHORT&&(pt=e.RG16UI),Q===e.UNSIGNED_INT&&(pt=e.RG32UI),Q===e.BYTE&&(pt=e.RG8I),Q===e.SHORT&&(pt=e.RG16I),Q===e.INT&&(pt=e.RG32I)),F===e.RGB_INTEGER&&(Q===e.UNSIGNED_BYTE&&(pt=e.RGB8UI),Q===e.UNSIGNED_SHORT&&(pt=e.RGB16UI),Q===e.UNSIGNED_INT&&(pt=e.RGB32UI),Q===e.BYTE&&(pt=e.RGB8I),Q===e.SHORT&&(pt=e.RGB16I),Q===e.INT&&(pt=e.RGB32I)),F===e.RGBA_INTEGER&&(Q===e.UNSIGNED_BYTE&&(pt=e.RGBA8UI),Q===e.UNSIGNED_SHORT&&(pt=e.RGBA16UI),Q===e.UNSIGNED_INT&&(pt=e.RGBA32UI),Q===e.BYTE&&(pt=e.RGBA8I),Q===e.SHORT&&(pt=e.RGBA16I),Q===e.INT&&(pt=e.RGBA32I)),F===e.RGB&&Q===e.UNSIGNED_INT_5_9_9_9_REV&&(pt=e.RGB9_E5),F===e.RGBA){const jt=gt?m_:tr.getTransfer(_t);Q===e.FLOAT&&(pt=e.RGBA32F),Q===e.HALF_FLOAT&&(pt=e.RGBA16F),Q===e.UNSIGNED_BYTE&&(pt=jt===cr?e.SRGB8_ALPHA8:e.RGBA8),Q===e.UNSIGNED_SHORT_4_4_4_4&&(pt=e.RGBA4),Q===e.UNSIGNED_SHORT_5_5_5_1&&(pt=e.RGB5_A1)}return(pt===e.R16F||pt===e.R32F||pt===e.RG16F||pt===e.RG32F||pt===e.RGBA16F||pt===e.RGBA32F)&&t.get("EXT_color_buffer_float"),pt}function x(V,F){let Q;return V?F===null||F===Iu||F===Rf?Q=e.DEPTH24_STENCIL8:F===So?Q=e.DEPTH32F_STENCIL8:F===mv&&(Q=e.DEPTH24_STENCIL8,console.warn("DepthTexture: 16 bit depth attachment is not supported with stencil. Using 24-bit attachment.")):F===null||F===Iu||F===Rf?Q=e.DEPTH_COMPONENT24:F===So?Q=e.DEPTH_COMPONENT32F:F===mv&&(Q=e.DEPTH_COMPONENT16),Q}function T(V,F){return g(V)===!0||V.isFramebufferTexture&&V.minFilter!==ga&&V.minFilter!==za?Math.log2(Math.max(F.width,F.height))+1:V.mipmaps!==void 0&&V.mipmaps.length>0?V.mipmaps.length:V.isCompressedTexture&&Array.isArray(V.image)?F.mipmaps.length:1}function S(V){const F=V.target;F.removeEventListener("dispose",S),w(F),F.isVideoTexture&&h.delete(F)}function M(V){const F=V.target;F.removeEventListener("dispose",M),A(F)}function w(V){const F=n.get(V);if(F.__webglInit===void 0)return;const Q=V.source,_t=c.get(Q);if(_t){const gt=_t[F.__cacheKey];gt.usedTimes--,gt.usedTimes===0&&b(V),Object.keys(_t).length===0&&c.delete(Q)}n.remove(V)}function b(V){const F=n.get(V);e.deleteTexture(F.__webglTexture);const Q=V.source,_t=c.get(Q);delete _t[F.__cacheKey],o.memory.textures--}function A(V){const F=n.get(V);if(V.depthTexture&&(V.depthTexture.dispose(),n.remove(V.depthTexture)),V.isWebGLCubeRenderTarget)for(let _t=0;_t<6;_t++){if(Array.isArray(F.__webglFramebuffer[_t]))for(let gt=0;gt<F.__webglFramebuffer[_t].length;gt++)e.deleteFramebuffer(F.__webglFramebuffer[_t][gt]);else e.deleteFramebuffer(F.__webglFramebuffer[_t]);F.__webglDepthbuffer&&e.deleteRenderbuffer(F.__webglDepthbuffer[_t])}else{if(Array.isArray(F.__webglFramebuffer))for(let _t=0;_t<F.__webglFramebuffer.length;_t++)e.deleteFramebuffer(F.__webglFramebuffer[_t]);else e.deleteFramebuffer(F.__webglFramebuffer);if(F.__webglDepthbuffer&&e.deleteRenderbuffer(F.__webglDepthbuffer),F.__webglMultisampledFramebuffer&&e.deleteFramebuffer(F.__webglMultisampledFramebuffer),F.__webglColorRenderbuffer)for(let _t=0;_t<F.__webglColorRenderbuffer.length;_t++)F.__webglColorRenderbuffer[_t]&&e.deleteRenderbuffer(F.__webglColorRenderbuffer[_t]);F.__webglDepthRenderbuffer&&e.deleteRenderbuffer(F.__webglDepthRenderbuffer)}const Q=V.textures;for(let _t=0,gt=Q.length;_t<gt;_t++){const pt=n.get(Q[_t]);pt.__webglTexture&&(e.deleteTexture(pt.__webglTexture),o.memory.textures--),n.remove(Q[_t])}n.remove(V)}let E=0;function C(){E=0}function D(){const V=E;return V>=i.maxTextures&&console.warn("THREE.WebGLTextures: Trying to use "+V+" texture units while this GPU supports only "+i.maxTextures),E+=1,V}function L(V){const F=[];return F.push(V.wrapS),F.push(V.wrapT),F.push(V.wrapR||0),F.push(V.magFilter),F.push(V.minFilter),F.push(V.anisotropy),F.push(V.internalFormat),F.push(V.format),F.push(V.type),F.push(V.generateMipmaps),F.push(V.premultiplyAlpha),F.push(V.flipY),F.push(V.unpackAlignment),F.push(V.colorSpace),F.join()}function P(V,F){const Q=n.get(V);if(V.isVideoTexture&&zt(V),V.isRenderTargetTexture===!1&&V.version>0&&Q.__version!==V.version){const _t=V.image;if(_t===null)console.warn("THREE.WebGLRenderer: Texture marked for update but no image data found.");else if(_t.complete===!1)console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete");else{H(Q,V,F);return}}r.bindTexture(e.TEXTURE_2D,Q.__webglTexture,e.TEXTURE0+F)}function N(V,F){const Q=n.get(V);if(V.version>0&&Q.__version!==V.version){H(Q,V,F);return}r.bindTexture(e.TEXTURE_2D_ARRAY,Q.__webglTexture,e.TEXTURE0+F)}function O(V,F){const Q=n.get(V);if(V.version>0&&Q.__version!==V.version){H(Q,V,F);return}r.bindTexture(e.TEXTURE_3D,Q.__webglTexture,e.TEXTURE0+F)}function I(V,F){const Q=n.get(V);if(V.version>0&&Q.__version!==V.version){Z(Q,V,F);return}r.bindTexture(e.TEXTURE_CUBE_MAP,Q.__webglTexture,e.TEXTURE0+F)}const k={[ub]:e.REPEAT,[ou]:e.CLAMP_TO_EDGE,[hb]:e.MIRRORED_REPEAT},z={[ga]:e.NEAREST,[but]:e.NEAREST_MIPMAP_NEAREST,[fg]:e.NEAREST_MIPMAP_LINEAR,[za]:e.LINEAR,[y1]:e.LINEAR_MIPMAP_NEAREST,[su]:e.LINEAR_MIPMAP_LINEAR},X={[Cut]:e.NEVER,[Nut]:e.ALWAYS,[Dut]:e.LESS,[XG]:e.LEQUAL,[Lut]:e.EQUAL,[Iut]:e.GEQUAL,[Rut]:e.GREATER,[Put]:e.NOTEQUAL};function Y(V,F){if(F.type===So&&t.has("OES_texture_float_linear")===!1&&(F.magFilter===za||F.magFilter===y1||F.magFilter===fg||F.magFilter===su||F.minFilter===za||F.minFilter===y1||F.minFilter===fg||F.minFilter===su)&&console.warn("THREE.WebGLRenderer: Unable to use linear filtering with floating point textures. OES_texture_float_linear not supported on this device."),e.texParameteri(V,e.TEXTURE_WRAP_S,k[F.wrapS]),e.texParameteri(V,e.TEXTURE_WRAP_T,k[F.wrapT]),(V===e.TEXTURE_3D||V===e.TEXTURE_2D_ARRAY)&&e.texParameteri(V,e.TEXTURE_WRAP_R,k[F.wrapR]),e.texParameteri(V,e.TEXTURE_MAG_FILTER,z[F.magFilter]),e.texParameteri(V,e.TEXTURE_MIN_FILTER,z[F.minFilter]),F.compareFunction&&(e.texParameteri(V,e.TEXTURE_COMPARE_MODE,e.COMPARE_REF_TO_TEXTURE),e.texParameteri(V,e.TEXTURE_COMPARE_FUNC,X[F.compareFunction])),t.has("EXT_texture_filter_anisotropic")===!0){if(F.magFilter===ga||F.minFilter!==fg&&F.minFilter!==su||F.type===So&&t.has("OES_texture_float_linear")===!1)return;if(F.anisotropy>1||n.get(F).__currentAnisotropy){const Q=t.get("EXT_texture_filter_anisotropic");e.texParameterf(V,Q.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(F.anisotropy,i.getMaxAnisotropy())),n.get(F).__currentAnisotropy=F.anisotropy}}}function $(V,F){let Q=!1;V.__webglInit===void 0&&(V.__webglInit=!0,F.addEventListener("dispose",S));const _t=F.source;let gt=c.get(_t);gt===void 0&&(gt={},c.set(_t,gt));const pt=L(F);if(pt!==V.__cacheKey){gt[pt]===void 0&&(gt[pt]={texture:e.createTexture(),usedTimes:0},o.memory.textures++,Q=!0),gt[pt].usedTimes++;const jt=gt[V.__cacheKey];jt!==void 0&&(gt[V.__cacheKey].usedTimes--,jt.usedTimes===0&&b(F)),V.__cacheKey=pt,V.__webglTexture=gt[pt].texture}return Q}function H(V,F,Q){let _t=e.TEXTURE_2D;(F.isDataArrayTexture||F.isCompressedArrayTexture)&&(_t=e.TEXTURE_2D_ARRAY),F.isData3DTexture&&(_t=e.TEXTURE_3D);const gt=$(V,F),pt=F.source;r.bindTexture(_t,V.__webglTexture,e.TEXTURE0+Q);const jt=n.get(pt);if(pt.version!==jt.__version||gt===!0){r.activeTexture(e.TEXTURE0+Q);const Gt=tr.getPrimaries(tr.workingColorSpace),Jt=F.colorSpace===ps?null:tr.getPrimaries(F.colorSpace),Ne=F.colorSpace===ps||Gt===Jt?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,F.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,F.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,Ne);let wt=p(F.image,!1,i.maxTextureSize);wt=ne(F,wt);const qt=a.convert(F.format,F.colorSpace),de=a.convert(F.type);let Se=y(F.internalFormat,qt,de,F.colorSpace,F.isVideoTexture);Y(_t,F);let ie;const qe=F.mipmaps,Oe=F.isVideoTexture!==!0,gr=jt.__version===void 0||gt===!0,K=pt.dataReady,Wt=T(F,wt);if(F.isDepthTexture)Se=x(F.format===Pf,F.type),gr&&(Oe?r.texStorage2D(e.TEXTURE_2D,1,Se,wt.width,wt.height):r.texImage2D(e.TEXTURE_2D,0,Se,wt.width,wt.height,0,qt,de,null));else if(F.isDataTexture)if(qe.length>0){Oe&&gr&&r.texStorage2D(e.TEXTURE_2D,Wt,Se,qe[0].width,qe[0].height);for(let vt=0,St=qe.length;vt<St;vt++)ie=qe[vt],Oe?K&&r.texSubImage2D(e.TEXTURE_2D,vt,0,0,ie.width,ie.height,qt,de,ie.data):r.texImage2D(e.TEXTURE_2D,vt,Se,ie.width,ie.height,0,qt,de,ie.data);F.generateMipmaps=!1}else Oe?(gr&&r.texStorage2D(e.TEXTURE_2D,Wt,Se,wt.width,wt.height),K&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,wt.width,wt.height,qt,de,wt.data)):r.texImage2D(e.TEXTURE_2D,0,Se,wt.width,wt.height,0,qt,de,wt.data);else if(F.isCompressedTexture)if(F.isCompressedArrayTexture){Oe&&gr&&r.texStorage3D(e.TEXTURE_2D_ARRAY,Wt,Se,qe[0].width,qe[0].height,wt.depth);for(let vt=0,St=qe.length;vt<St;vt++)if(ie=qe[vt],F.format!==ca)if(qt!==null)if(Oe){if(K)if(F.layerUpdates.size>0){const $t=gN(ie.width,ie.height,F.format,F.type);for(const Zt of F.layerUpdates){const Re=ie.data.subarray(Zt*$t/ie.data.BYTES_PER_ELEMENT,(Zt+1)*$t/ie.data.BYTES_PER_ELEMENT);r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,vt,0,0,Zt,ie.width,ie.height,1,qt,Re)}F.clearLayerUpdates()}else r.compressedTexSubImage3D(e.TEXTURE_2D_ARRAY,vt,0,0,0,ie.width,ie.height,wt.depth,qt,ie.data)}else r.compressedTexImage3D(e.TEXTURE_2D_ARRAY,vt,Se,ie.width,ie.height,wt.depth,0,ie.data,0,0);else console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()");else Oe?K&&r.texSubImage3D(e.TEXTURE_2D_ARRAY,vt,0,0,0,ie.width,ie.height,wt.depth,qt,de,ie.data):r.texImage3D(e.TEXTURE_2D_ARRAY,vt,Se,ie.width,ie.height,wt.depth,0,qt,de,ie.data)}else{Oe&&gr&&r.texStorage2D(e.TEXTURE_2D,Wt,Se,qe[0].width,qe[0].height);for(let vt=0,St=qe.length;vt<St;vt++)ie=qe[vt],F.format!==ca?qt!==null?Oe?K&&r.compressedTexSubImage2D(e.TEXTURE_2D,vt,0,0,ie.width,ie.height,qt,ie.data):r.compressedTexImage2D(e.TEXTURE_2D,vt,Se,ie.width,ie.height,0,ie.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):Oe?K&&r.texSubImage2D(e.TEXTURE_2D,vt,0,0,ie.width,ie.height,qt,de,ie.data):r.texImage2D(e.TEXTURE_2D,vt,Se,ie.width,ie.height,0,qt,de,ie.data)}else if(F.isDataArrayTexture)if(Oe){if(gr&&r.texStorage3D(e.TEXTURE_2D_ARRAY,Wt,Se,wt.width,wt.height,wt.depth),K)if(F.layerUpdates.size>0){const vt=gN(wt.width,wt.height,F.format,F.type);for(const St of F.layerUpdates){const $t=wt.data.subarray(St*vt/wt.data.BYTES_PER_ELEMENT,(St+1)*vt/wt.data.BYTES_PER_ELEMENT);r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,St,wt.width,wt.height,1,qt,de,$t)}F.clearLayerUpdates()}else r.texSubImage3D(e.TEXTURE_2D_ARRAY,0,0,0,0,wt.width,wt.height,wt.depth,qt,de,wt.data)}else r.texImage3D(e.TEXTURE_2D_ARRAY,0,Se,wt.width,wt.height,wt.depth,0,qt,de,wt.data);else if(F.isData3DTexture)Oe?(gr&&r.texStorage3D(e.TEXTURE_3D,Wt,Se,wt.width,wt.height,wt.depth),K&&r.texSubImage3D(e.TEXTURE_3D,0,0,0,0,wt.width,wt.height,wt.depth,qt,de,wt.data)):r.texImage3D(e.TEXTURE_3D,0,Se,wt.width,wt.height,wt.depth,0,qt,de,wt.data);else if(F.isFramebufferTexture){if(gr)if(Oe)r.texStorage2D(e.TEXTURE_2D,Wt,Se,wt.width,wt.height);else{let vt=wt.width,St=wt.height;for(let $t=0;$t<Wt;$t++)r.texImage2D(e.TEXTURE_2D,$t,Se,vt,St,0,qt,de,null),vt>>=1,St>>=1}}else if(qe.length>0){if(Oe&&gr){const vt=kt(qe[0]);r.texStorage2D(e.TEXTURE_2D,Wt,Se,vt.width,vt.height)}for(let vt=0,St=qe.length;vt<St;vt++)ie=qe[vt],Oe?K&&r.texSubImage2D(e.TEXTURE_2D,vt,0,0,qt,de,ie):r.texImage2D(e.TEXTURE_2D,vt,Se,qt,de,ie);F.generateMipmaps=!1}else if(Oe){if(gr){const vt=kt(wt);r.texStorage2D(e.TEXTURE_2D,Wt,Se,vt.width,vt.height)}K&&r.texSubImage2D(e.TEXTURE_2D,0,0,0,qt,de,wt)}else r.texImage2D(e.TEXTURE_2D,0,Se,qt,de,wt);g(F)&&m(_t),jt.__version=pt.version,F.onUpdate&&F.onUpdate(F)}V.__version=F.version}function Z(V,F,Q){if(F.image.length!==6)return;const _t=$(V,F),gt=F.source;r.bindTexture(e.TEXTURE_CUBE_MAP,V.__webglTexture,e.TEXTURE0+Q);const pt=n.get(gt);if(gt.version!==pt.__version||_t===!0){r.activeTexture(e.TEXTURE0+Q);const jt=tr.getPrimaries(tr.workingColorSpace),Gt=F.colorSpace===ps?null:tr.getPrimaries(F.colorSpace),Jt=F.colorSpace===ps||jt===Gt?e.NONE:e.BROWSER_DEFAULT_WEBGL;e.pixelStorei(e.UNPACK_FLIP_Y_WEBGL,F.flipY),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,F.premultiplyAlpha),e.pixelStorei(e.UNPACK_ALIGNMENT,F.unpackAlignment),e.pixelStorei(e.UNPACK_COLORSPACE_CONVERSION_WEBGL,Jt);const Ne=F.isCompressedTexture||F.image[0].isCompressedTexture,wt=F.image[0]&&F.image[0].isDataTexture,qt=[];for(let St=0;St<6;St++)!Ne&&!wt?qt[St]=p(F.image[St],!0,i.maxCubemapSize):qt[St]=wt?F.image[St].image:F.image[St],qt[St]=ne(F,qt[St]);const de=qt[0],Se=a.convert(F.format,F.colorSpace),ie=a.convert(F.type),qe=y(F.internalFormat,Se,ie,F.colorSpace),Oe=F.isVideoTexture!==!0,gr=pt.__version===void 0||_t===!0,K=gt.dataReady;let Wt=T(F,de);Y(e.TEXTURE_CUBE_MAP,F);let vt;if(Ne){Oe&&gr&&r.texStorage2D(e.TEXTURE_CUBE_MAP,Wt,qe,de.width,de.height);for(let St=0;St<6;St++){vt=qt[St].mipmaps;for(let $t=0;$t<vt.length;$t++){const Zt=vt[$t];F.format!==ca?Se!==null?Oe?K&&r.compressedTexSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,$t,0,0,Zt.width,Zt.height,Se,Zt.data):r.compressedTexImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,$t,qe,Zt.width,Zt.height,0,Zt.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):Oe?K&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,$t,0,0,Zt.width,Zt.height,Se,ie,Zt.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,$t,qe,Zt.width,Zt.height,0,Se,ie,Zt.data)}}}else{if(vt=F.mipmaps,Oe&&gr){vt.length>0&&Wt++;const St=kt(qt[0]);r.texStorage2D(e.TEXTURE_CUBE_MAP,Wt,qe,St.width,St.height)}for(let St=0;St<6;St++)if(wt){Oe?K&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,0,0,0,qt[St].width,qt[St].height,Se,ie,qt[St].data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,0,qe,qt[St].width,qt[St].height,0,Se,ie,qt[St].data);for(let $t=0;$t<vt.length;$t++){const Re=vt[$t].image[St].image;Oe?K&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,$t+1,0,0,Re.width,Re.height,Se,ie,Re.data):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,$t+1,qe,Re.width,Re.height,0,Se,ie,Re.data)}}else{Oe?K&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,0,0,0,Se,ie,qt[St]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,0,qe,Se,ie,qt[St]);for(let $t=0;$t<vt.length;$t++){const Zt=vt[$t];Oe?K&&r.texSubImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,$t+1,0,0,Se,ie,Zt.image[St]):r.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+St,$t+1,qe,Se,ie,Zt.image[St])}}}g(F)&&m(e.TEXTURE_CUBE_MAP),pt.__version=gt.version,F.onUpdate&&F.onUpdate(F)}V.__version=F.version}function ct(V,F,Q,_t,gt,pt){const jt=a.convert(Q.format,Q.colorSpace),Gt=a.convert(Q.type),Jt=y(Q.internalFormat,jt,Gt,Q.colorSpace),Ne=n.get(F),wt=n.get(Q);if(wt.__renderTarget=F,!Ne.__hasExternalTextures){const qt=Math.max(1,F.width>>pt),de=Math.max(1,F.height>>pt);gt===e.TEXTURE_3D||gt===e.TEXTURE_2D_ARRAY?r.texImage3D(gt,pt,Jt,qt,de,F.depth,0,jt,Gt,null):r.texImage2D(gt,pt,Jt,qt,de,0,jt,Gt,null)}r.bindFramebuffer(e.FRAMEBUFFER,V),Lt(F)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,_t,gt,wt.__webglTexture,0,Pt(F)):(gt===e.TEXTURE_2D||gt>=e.TEXTURE_CUBE_MAP_POSITIVE_X&&gt<=e.TEXTURE_CUBE_MAP_NEGATIVE_Z)&&e.framebufferTexture2D(e.FRAMEBUFFER,_t,gt,wt.__webglTexture,pt),r.bindFramebuffer(e.FRAMEBUFFER,null)}function ut(V,F,Q){if(e.bindRenderbuffer(e.RENDERBUFFER,V),F.depthBuffer){const _t=F.depthTexture,gt=_t&&_t.isDepthTexture?_t.type:null,pt=x(F.stencilBuffer,gt),jt=F.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,Gt=Pt(F);Lt(F)?s.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Gt,pt,F.width,F.height):Q?e.renderbufferStorageMultisample(e.RENDERBUFFER,Gt,pt,F.width,F.height):e.renderbufferStorage(e.RENDERBUFFER,pt,F.width,F.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,jt,e.RENDERBUFFER,V)}else{const _t=F.textures;for(let gt=0;gt<_t.length;gt++){const pt=_t[gt],jt=a.convert(pt.format,pt.colorSpace),Gt=a.convert(pt.type),Jt=y(pt.internalFormat,jt,Gt,pt.colorSpace),Ne=Pt(F);Q&&Lt(F)===!1?e.renderbufferStorageMultisample(e.RENDERBUFFER,Ne,Jt,F.width,F.height):Lt(F)?s.renderbufferStorageMultisampleEXT(e.RENDERBUFFER,Ne,Jt,F.width,F.height):e.renderbufferStorage(e.RENDERBUFFER,Jt,F.width,F.height)}}e.bindRenderbuffer(e.RENDERBUFFER,null)}function tt(V,F){if(F&&F.isWebGLCubeRenderTarget)throw new Error("Depth Texture with cube render targets is not supported");if(r.bindFramebuffer(e.FRAMEBUFFER,V),!(F.depthTexture&&F.depthTexture.isDepthTexture))throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");const _t=n.get(F.depthTexture);_t.__renderTarget=F,(!_t.__webglTexture||F.depthTexture.image.width!==F.width||F.depthTexture.image.height!==F.height)&&(F.depthTexture.image.width=F.width,F.depthTexture.image.height=F.height,F.depthTexture.needsUpdate=!0),P(F.depthTexture,0);const gt=_t.__webglTexture,pt=Pt(F);if(F.depthTexture.format===of)Lt(F)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,gt,0,pt):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_ATTACHMENT,e.TEXTURE_2D,gt,0);else if(F.depthTexture.format===Pf)Lt(F)?s.framebufferTexture2DMultisampleEXT(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,gt,0,pt):e.framebufferTexture2D(e.FRAMEBUFFER,e.DEPTH_STENCIL_ATTACHMENT,e.TEXTURE_2D,gt,0);else throw new Error("Unknown depthTexture format")}function et(V){const F=n.get(V),Q=V.isWebGLCubeRenderTarget===!0;if(F.__boundDepthTexture!==V.depthTexture){const _t=V.depthTexture;if(F.__depthDisposeCallback&&F.__depthDisposeCallback(),_t){const gt=()=>{delete F.__boundDepthTexture,delete F.__depthDisposeCallback,_t.removeEventListener("dispose",gt)};_t.addEventListener("dispose",gt),F.__depthDisposeCallback=gt}F.__boundDepthTexture=_t}if(V.depthTexture&&!F.__autoAllocateDepthBuffer){if(Q)throw new Error("target.depthTexture not supported in Cube render targets");tt(F.__webglFramebuffer,V)}else if(Q){F.__webglDepthbuffer=[];for(let _t=0;_t<6;_t++)if(r.bindFramebuffer(e.FRAMEBUFFER,F.__webglFramebuffer[_t]),F.__webglDepthbuffer[_t]===void 0)F.__webglDepthbuffer[_t]=e.createRenderbuffer(),ut(F.__webglDepthbuffer[_t],V,!1);else{const gt=V.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,pt=F.__webglDepthbuffer[_t];e.bindRenderbuffer(e.RENDERBUFFER,pt),e.framebufferRenderbuffer(e.FRAMEBUFFER,gt,e.RENDERBUFFER,pt)}}else if(r.bindFramebuffer(e.FRAMEBUFFER,F.__webglFramebuffer),F.__webglDepthbuffer===void 0)F.__webglDepthbuffer=e.createRenderbuffer(),ut(F.__webglDepthbuffer,V,!1);else{const _t=V.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,gt=F.__webglDepthbuffer;e.bindRenderbuffer(e.RENDERBUFFER,gt),e.framebufferRenderbuffer(e.FRAMEBUFFER,_t,e.RENDERBUFFER,gt)}r.bindFramebuffer(e.FRAMEBUFFER,null)}function st(V,F,Q){const _t=n.get(V);F!==void 0&&ct(_t.__webglFramebuffer,V,V.texture,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,0),Q!==void 0&&et(V)}function nt(V){const F=V.texture,Q=n.get(V),_t=n.get(F);V.addEventListener("dispose",M);const gt=V.textures,pt=V.isWebGLCubeRenderTarget===!0,jt=gt.length>1;if(jt||(_t.__webglTexture===void 0&&(_t.__webglTexture=e.createTexture()),_t.__version=F.version,o.memory.textures++),pt){Q.__webglFramebuffer=[];for(let Gt=0;Gt<6;Gt++)if(F.mipmaps&&F.mipmaps.length>0){Q.__webglFramebuffer[Gt]=[];for(let Jt=0;Jt<F.mipmaps.length;Jt++)Q.__webglFramebuffer[Gt][Jt]=e.createFramebuffer()}else Q.__webglFramebuffer[Gt]=e.createFramebuffer()}else{if(F.mipmaps&&F.mipmaps.length>0){Q.__webglFramebuffer=[];for(let Gt=0;Gt<F.mipmaps.length;Gt++)Q.__webglFramebuffer[Gt]=e.createFramebuffer()}else Q.__webglFramebuffer=e.createFramebuffer();if(jt)for(let Gt=0,Jt=gt.length;Gt<Jt;Gt++){const Ne=n.get(gt[Gt]);Ne.__webglTexture===void 0&&(Ne.__webglTexture=e.createTexture(),o.memory.textures++)}if(V.samples>0&&Lt(V)===!1){Q.__webglMultisampledFramebuffer=e.createFramebuffer(),Q.__webglColorRenderbuffer=[],r.bindFramebuffer(e.FRAMEBUFFER,Q.__webglMultisampledFramebuffer);for(let Gt=0;Gt<gt.length;Gt++){const Jt=gt[Gt];Q.__webglColorRenderbuffer[Gt]=e.createRenderbuffer(),e.bindRenderbuffer(e.RENDERBUFFER,Q.__webglColorRenderbuffer[Gt]);const Ne=a.convert(Jt.format,Jt.colorSpace),wt=a.convert(Jt.type),qt=y(Jt.internalFormat,Ne,wt,Jt.colorSpace,V.isXRRenderTarget===!0),de=Pt(V);e.renderbufferStorageMultisample(e.RENDERBUFFER,de,qt,V.width,V.height),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+Gt,e.RENDERBUFFER,Q.__webglColorRenderbuffer[Gt])}e.bindRenderbuffer(e.RENDERBUFFER,null),V.depthBuffer&&(Q.__webglDepthRenderbuffer=e.createRenderbuffer(),ut(Q.__webglDepthRenderbuffer,V,!0)),r.bindFramebuffer(e.FRAMEBUFFER,null)}}if(pt){r.bindTexture(e.TEXTURE_CUBE_MAP,_t.__webglTexture),Y(e.TEXTURE_CUBE_MAP,F);for(let Gt=0;Gt<6;Gt++)if(F.mipmaps&&F.mipmaps.length>0)for(let Jt=0;Jt<F.mipmaps.length;Jt++)ct(Q.__webglFramebuffer[Gt][Jt],V,F,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+Gt,Jt);else ct(Q.__webglFramebuffer[Gt],V,F,e.COLOR_ATTACHMENT0,e.TEXTURE_CUBE_MAP_POSITIVE_X+Gt,0);g(F)&&m(e.TEXTURE_CUBE_MAP),r.unbindTexture()}else if(jt){for(let Gt=0,Jt=gt.length;Gt<Jt;Gt++){const Ne=gt[Gt],wt=n.get(Ne);r.bindTexture(e.TEXTURE_2D,wt.__webglTexture),Y(e.TEXTURE_2D,Ne),ct(Q.__webglFramebuffer,V,Ne,e.COLOR_ATTACHMENT0+Gt,e.TEXTURE_2D,0),g(Ne)&&m(e.TEXTURE_2D)}r.unbindTexture()}else{let Gt=e.TEXTURE_2D;if((V.isWebGL3DRenderTarget||V.isWebGLArrayRenderTarget)&&(Gt=V.isWebGL3DRenderTarget?e.TEXTURE_3D:e.TEXTURE_2D_ARRAY),r.bindTexture(Gt,_t.__webglTexture),Y(Gt,F),F.mipmaps&&F.mipmaps.length>0)for(let Jt=0;Jt<F.mipmaps.length;Jt++)ct(Q.__webglFramebuffer[Jt],V,F,e.COLOR_ATTACHMENT0,Gt,Jt);else ct(Q.__webglFramebuffer,V,F,e.COLOR_ATTACHMENT0,Gt,0);g(F)&&m(Gt),r.unbindTexture()}V.depthBuffer&&et(V)}function dt(V){const F=V.textures;for(let Q=0,_t=F.length;Q<_t;Q++){const gt=F[Q];if(g(gt)){const pt=_(V),jt=n.get(gt).__webglTexture;r.bindTexture(pt,jt),m(pt),r.unbindTexture()}}}const At=[],G=[];function Dt(V){if(V.samples>0){if(Lt(V)===!1){const F=V.textures,Q=V.width,_t=V.height;let gt=e.COLOR_BUFFER_BIT;const pt=V.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT,jt=n.get(V),Gt=F.length>1;if(Gt)for(let Jt=0;Jt<F.length;Jt++)r.bindFramebuffer(e.FRAMEBUFFER,jt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+Jt,e.RENDERBUFFER,null),r.bindFramebuffer(e.FRAMEBUFFER,jt.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+Jt,e.TEXTURE_2D,null,0);r.bindFramebuffer(e.READ_FRAMEBUFFER,jt.__webglMultisampledFramebuffer),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,jt.__webglFramebuffer);for(let Jt=0;Jt<F.length;Jt++){if(V.resolveDepthBuffer&&(V.depthBuffer&&(gt|=e.DEPTH_BUFFER_BIT),V.stencilBuffer&&V.resolveStencilBuffer&&(gt|=e.STENCIL_BUFFER_BIT)),Gt){e.framebufferRenderbuffer(e.READ_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.RENDERBUFFER,jt.__webglColorRenderbuffer[Jt]);const Ne=n.get(F[Jt]).__webglTexture;e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0,e.TEXTURE_2D,Ne,0)}e.blitFramebuffer(0,0,Q,_t,0,0,Q,_t,gt,e.NEAREST),l===!0&&(At.length=0,G.length=0,At.push(e.COLOR_ATTACHMENT0+Jt),V.depthBuffer&&V.resolveDepthBuffer===!1&&(At.push(pt),G.push(pt),e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,G)),e.invalidateFramebuffer(e.READ_FRAMEBUFFER,At))}if(r.bindFramebuffer(e.READ_FRAMEBUFFER,null),r.bindFramebuffer(e.DRAW_FRAMEBUFFER,null),Gt)for(let Jt=0;Jt<F.length;Jt++){r.bindFramebuffer(e.FRAMEBUFFER,jt.__webglMultisampledFramebuffer),e.framebufferRenderbuffer(e.FRAMEBUFFER,e.COLOR_ATTACHMENT0+Jt,e.RENDERBUFFER,jt.__webglColorRenderbuffer[Jt]);const Ne=n.get(F[Jt]).__webglTexture;r.bindFramebuffer(e.FRAMEBUFFER,jt.__webglFramebuffer),e.framebufferTexture2D(e.DRAW_FRAMEBUFFER,e.COLOR_ATTACHMENT0+Jt,e.TEXTURE_2D,Ne,0)}r.bindFramebuffer(e.DRAW_FRAMEBUFFER,jt.__webglMultisampledFramebuffer)}else if(V.depthBuffer&&V.resolveDepthBuffer===!1&&l){const F=V.stencilBuffer?e.DEPTH_STENCIL_ATTACHMENT:e.DEPTH_ATTACHMENT;e.invalidateFramebuffer(e.DRAW_FRAMEBUFFER,[F])}}}function Pt(V){return Math.min(i.maxSamples,V.samples)}function Lt(V){const F=n.get(V);return V.samples>0&&t.has("WEBGL_multisampled_render_to_texture")===!0&&F.__useRenderToTexture!==!1}function zt(V){const F=o.render.frame;h.get(V)!==F&&(h.set(V,F),V.update())}function ne(V,F){const Q=V.colorSpace,_t=V.format,gt=V.type;return V.isCompressedTexture===!0||V.isVideoTexture===!0||Q!==If&&Q!==ps&&(tr.getTransfer(Q)===cr?(_t!==ca||gt!==zo)&&console.warn("THREE.WebGLTextures: sRGB encoded textures have to use RGBAFormat and UnsignedByteType."):console.error("THREE.WebGLTextures: Unsupported texture color space:",Q)),F}function kt(V){return typeof HTMLImageElement<"u"&&V instanceof HTMLImageElement?(u.width=V.naturalWidth||V.width,u.height=V.naturalHeight||V.height):typeof VideoFrame<"u"&&V instanceof VideoFrame?(u.width=V.displayWidth,u.height=V.displayHeight):(u.width=V.width,u.height=V.height),u}this.allocateTextureUnit=D,this.resetTextureUnits=C,this.setTexture2D=P,this.setTexture2DArray=N,this.setTexture3D=O,this.setTextureCube=I,this.rebindTextures=st,this.setupRenderTarget=nt,this.updateRenderTargetMipmap=dt,this.updateMultisampleRenderTarget=Dt,this.setupDepthRenderbuffer=et,this.setupFrameBufferTexture=ct,this.useMultisampledRTT=Lt}function Xvt(e,t){function r(n,i=ps){let a;const o=tr.getTransfer(i);if(n===zo)return e.UNSIGNED_BYTE;if(n===xA)return e.UNSIGNED_SHORT_4_4_4_4;if(n===SA)return e.UNSIGNED_SHORT_5_5_5_1;if(n===BG)return e.UNSIGNED_INT_5_9_9_9_REV;if(n===OG)return e.BYTE;if(n===FG)return e.SHORT;if(n===mv)return e.UNSIGNED_SHORT;if(n===yA)return e.INT;if(n===Iu)return e.UNSIGNED_INT;if(n===So)return e.FLOAT;if(n===Hv)return e.HALF_FLOAT;if(n===UG)return e.ALPHA;if(n===zG)return e.RGB;if(n===ca)return e.RGBA;if(n===kG)return e.LUMINANCE;if(n===GG)return e.LUMINANCE_ALPHA;if(n===of)return e.DEPTH_COMPONENT;if(n===Pf)return e.DEPTH_STENCIL;if(n===VG)return e.RED;if(n===TA)return e.RED_INTEGER;if(n===HG)return e.RG;if(n===bA)return e.RG_INTEGER;if(n===wA)return e.RGBA_INTEGER;if(n===am||n===om||n===sm||n===lm)if(o===cr)if(a=t.get("WEBGL_compressed_texture_s3tc_srgb"),a!==null){if(n===am)return a.COMPRESSED_SRGB_S3TC_DXT1_EXT;if(n===om)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT;if(n===sm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT;if(n===lm)return a.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}else return null;else if(a=t.get("WEBGL_compressed_texture_s3tc"),a!==null){if(n===am)return a.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===om)return a.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===sm)return a.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===lm)return a.COMPRESSED_RGBA_S3TC_DXT5_EXT}else return null;if(n===fb||n===cb||n===db||n===vb)if(a=t.get("WEBGL_compressed_texture_pvrtc"),a!==null){if(n===fb)return a.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===cb)return a.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===db)return a.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===vb)return a.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}else return null;if(n===pb||n===gb||n===mb)if(a=t.get("WEBGL_compressed_texture_etc"),a!==null){if(n===pb||n===gb)return o===cr?a.COMPRESSED_SRGB8_ETC2:a.COMPRESSED_RGB8_ETC2;if(n===mb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC:a.COMPRESSED_RGBA8_ETC2_EAC}else return null;if(n===_b||n===yb||n===xb||n===Sb||n===Tb||n===bb||n===wb||n===Mb||n===Ab||n===Eb||n===Cb||n===Db||n===Lb||n===Rb)if(a=t.get("WEBGL_compressed_texture_astc"),a!==null){if(n===_b)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR:a.COMPRESSED_RGBA_ASTC_4x4_KHR;if(n===yb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR:a.COMPRESSED_RGBA_ASTC_5x4_KHR;if(n===xb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR:a.COMPRESSED_RGBA_ASTC_5x5_KHR;if(n===Sb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR:a.COMPRESSED_RGBA_ASTC_6x5_KHR;if(n===Tb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR:a.COMPRESSED_RGBA_ASTC_6x6_KHR;if(n===bb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR:a.COMPRESSED_RGBA_ASTC_8x5_KHR;if(n===wb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR:a.COMPRESSED_RGBA_ASTC_8x6_KHR;if(n===Mb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR:a.COMPRESSED_RGBA_ASTC_8x8_KHR;if(n===Ab)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR:a.COMPRESSED_RGBA_ASTC_10x5_KHR;if(n===Eb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR:a.COMPRESSED_RGBA_ASTC_10x6_KHR;if(n===Cb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR:a.COMPRESSED_RGBA_ASTC_10x8_KHR;if(n===Db)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR:a.COMPRESSED_RGBA_ASTC_10x10_KHR;if(n===Lb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR:a.COMPRESSED_RGBA_ASTC_12x10_KHR;if(n===Rb)return o===cr?a.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR:a.COMPRESSED_RGBA_ASTC_12x12_KHR}else return null;if(n===um||n===Pb||n===Ib)if(a=t.get("EXT_texture_compression_bptc"),a!==null){if(n===um)return o===cr?a.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT:a.COMPRESSED_RGBA_BPTC_UNORM_EXT;if(n===Pb)return a.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT;if(n===Ib)return a.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT}else return null;if(n===WG||n===Nb||n===Ob||n===Fb)if(a=t.get("EXT_texture_compression_rgtc"),a!==null){if(n===um)return a.COMPRESSED_RED_RGTC1_EXT;if(n===Nb)return a.COMPRESSED_SIGNED_RED_RGTC1_EXT;if(n===Ob)return a.COMPRESSED_RED_GREEN_RGTC2_EXT;if(n===Fb)return a.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}else return null;return n===Rf?e.UNSIGNED_INT_24_8:e[n]!==void 0?e[n]:null}return{convert:r}}const Yvt={type:"move"};class q1{constructor(){this._targetRay=null,this._grip=null,this._hand=null}getHandSpace(){return this._hand===null&&(this._hand=new Dg,this._hand.matrixAutoUpdate=!1,this._hand.visible=!1,this._hand.joints={},this._hand.inputState={pinching:!1}),this._hand}getTargetRaySpace(){return this._targetRay===null&&(this._targetRay=new Dg,this._targetRay.matrixAutoUpdate=!1,this._targetRay.visible=!1,this._targetRay.hasLinearVelocity=!1,this._targetRay.linearVelocity=new lt,this._targetRay.hasAngularVelocity=!1,this._targetRay.angularVelocity=new lt),this._targetRay}getGripSpace(){return this._grip===null&&(this._grip=new Dg,this._grip.matrixAutoUpdate=!1,this._grip.visible=!1,this._grip.hasLinearVelocity=!1,this._grip.linearVelocity=new lt,this._grip.hasAngularVelocity=!1,this._grip.angularVelocity=new lt),this._grip}dispatchEvent(t){return this._targetRay!==null&&this._targetRay.dispatchEvent(t),this._grip!==null&&this._grip.dispatchEvent(t),this._hand!==null&&this._hand.dispatchEvent(t),this}connect(t){if(t&&t.hand){const r=this._hand;if(r)for(const n of t.hand.values())this._getHandJoint(r,n)}return this.dispatchEvent({type:"connected",data:t}),this}disconnect(t){return this.dispatchEvent({type:"disconnected",data:t}),this._targetRay!==null&&(this._targetRay.visible=!1),this._grip!==null&&(this._grip.visible=!1),this._hand!==null&&(this._hand.visible=!1),this}update(t,r,n){let i=null,a=null,o=null;const s=this._targetRay,l=this._grip,u=this._hand;if(t&&r.session.visibilityState!=="visible-blurred"){if(u&&t.hand){o=!0;for(const p of t.hand.values()){const g=r.getJointPose(p,n),m=this._getHandJoint(u,p);g!==null&&(m.matrix.fromArray(g.transform.matrix),m.matrix.decompose(m.position,m.rotation,m.scale),m.matrixWorldNeedsUpdate=!0,m.jointRadius=g.radius),m.visible=g!==null}const h=u.joints["index-finger-tip"],f=u.joints["thumb-tip"],c=h.position.distanceTo(f.position),d=.02,v=.005;u.inputState.pinching&&c>d+v?(u.inputState.pinching=!1,this.dispatchEvent({type:"pinchend",handedness:t.handedness,target:this})):!u.inputState.pinching&&c<=d-v&&(u.inputState.pinching=!0,this.dispatchEvent({type:"pinchstart",handedness:t.handedness,target:this}))}else l!==null&&t.gripSpace&&(a=r.getPose(t.gripSpace,n),a!==null&&(l.matrix.fromArray(a.transform.matrix),l.matrix.decompose(l.position,l.rotation,l.scale),l.matrixWorldNeedsUpdate=!0,a.linearVelocity?(l.hasLinearVelocity=!0,l.linearVelocity.copy(a.linearVelocity)):l.hasLinearVelocity=!1,a.angularVelocity?(l.hasAngularVelocity=!0,l.angularVelocity.copy(a.angularVelocity)):l.hasAngularVelocity=!1));s!==null&&(i=r.getPose(t.targetRaySpace,n),i===null&&a!==null&&(i=a),i!==null&&(s.matrix.fromArray(i.transform.matrix),s.matrix.decompose(s.position,s.rotation,s.scale),s.matrixWorldNeedsUpdate=!0,i.linearVelocity?(s.hasLinearVelocity=!0,s.linearVelocity.copy(i.linearVelocity)):s.hasLinearVelocity=!1,i.angularVelocity?(s.hasAngularVelocity=!0,s.angularVelocity.copy(i.angularVelocity)):s.hasAngularVelocity=!1,this.dispatchEvent(Yvt)))}return s!==null&&(s.visible=i!==null),l!==null&&(l.visible=a!==null),u!==null&&(u.visible=o!==null),this}_getHandJoint(t,r){if(t.joints[r.jointName]===void 0){const n=new Dg;n.matrixAutoUpdate=!1,n.visible=!1,t.joints[r.jointName]=n,t.add(n)}return t.joints[r.jointName]}}const Zvt=`
void main() {

	gl_Position = vec4( position, 1.0 );

}`,qvt=`
uniform sampler2DArray depthColor;
uniform float depthWidth;
uniform float depthHeight;

void main() {

	vec2 coord = vec2( gl_FragCoord.x / depthWidth, gl_FragCoord.y / depthHeight );

	if ( coord.x >= 1.0 ) {

		gl_FragDepth = texture( depthColor, vec3( coord.x - 1.0, coord.y, 1 ) ).r;

	} else {

		gl_FragDepth = texture( depthColor, vec3( coord.x, coord.y, 0 ) ).r;

	}

}`;class $vt{constructor(){this.texture=null,this.mesh=null,this.depthNear=0,this.depthFar=0}init(t,r,n){if(this.texture===null){const i=new ui,a=t.properties.get(i);a.__webglTexture=r.texture,(r.depthNear!==n.depthNear||r.depthFar!==n.depthFar)&&(this.depthNear=r.depthNear,this.depthFar=r.depthFar),this.texture=i}}getMesh(t){if(this.texture!==null&&this.mesh===null){const r=t.cameras[0].viewport,n=new Vs({vertexShader:Zvt,fragmentShader:qvt,uniforms:{depthColor:{value:this.texture},depthWidth:{value:r.z},depthHeight:{value:r.w}}});this.mesh=new ka(new _0(20,20),n)}return this.mesh}reset(){this.texture=null,this.mesh=null}getDepthTexture(){return this.texture}}class Kvt extends oc{constructor(t,r){super();const n=this;let i=null,a=1,o=null,s="local-floor",l=1,u=null,h=null,f=null,c=null,d=null,v=null;const p=new $vt,g=r.getContextAttributes();let m=null,_=null;const y=[],x=[],T=new pr;let S=null;const M=new Bi;M.viewport=new Ur;const w=new Bi;w.viewport=new Ur;const b=[M,w],A=new mht;let E=null,C=null;this.cameraAutoUpdate=!0,this.enabled=!1,this.isPresenting=!1,this.getController=function(H){let Z=y[H];return Z===void 0&&(Z=new q1,y[H]=Z),Z.getTargetRaySpace()},this.getControllerGrip=function(H){let Z=y[H];return Z===void 0&&(Z=new q1,y[H]=Z),Z.getGripSpace()},this.getHand=function(H){let Z=y[H];return Z===void 0&&(Z=new q1,y[H]=Z),Z.getHandSpace()};function D(H){const Z=x.indexOf(H.inputSource);if(Z===-1)return;const ct=y[Z];ct!==void 0&&(ct.update(H.inputSource,H.frame,u||o),ct.dispatchEvent({type:H.type,data:H.inputSource}))}function L(){i.removeEventListener("select",D),i.removeEventListener("selectstart",D),i.removeEventListener("selectend",D),i.removeEventListener("squeeze",D),i.removeEventListener("squeezestart",D),i.removeEventListener("squeezeend",D),i.removeEventListener("end",L),i.removeEventListener("inputsourceschange",P);for(let H=0;H<y.length;H++){const Z=x[H];Z!==null&&(x[H]=null,y[H].disconnect(Z))}E=null,C=null,p.reset(),t.setRenderTarget(m),d=null,c=null,f=null,i=null,_=null,$.stop(),n.isPresenting=!1,t.setPixelRatio(S),t.setSize(T.width,T.height,!1),n.dispatchEvent({type:"sessionend"})}this.setFramebufferScaleFactor=function(H){a=H,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change framebuffer scale while presenting.")},this.setReferenceSpaceType=function(H){s=H,n.isPresenting===!0&&console.warn("THREE.WebXRManager: Cannot change reference space type while presenting.")},this.getReferenceSpace=function(){return u||o},this.setReferenceSpace=function(H){u=H},this.getBaseLayer=function(){return c!==null?c:d},this.getBinding=function(){return f},this.getFrame=function(){return v},this.getSession=function(){return i},this.setSession=async function(H){if(i=H,i!==null){if(m=t.getRenderTarget(),i.addEventListener("select",D),i.addEventListener("selectstart",D),i.addEventListener("selectend",D),i.addEventListener("squeeze",D),i.addEventListener("squeezestart",D),i.addEventListener("squeezeend",D),i.addEventListener("end",L),i.addEventListener("inputsourceschange",P),g.xrCompatible!==!0&&await r.makeXRCompatible(),S=t.getPixelRatio(),t.getSize(T),i.enabledFeatures!==void 0&&i.enabledFeatures.includes("layers")){let ct=null,ut=null,tt=null;g.depth&&(tt=g.stencil?r.DEPTH24_STENCIL8:r.DEPTH_COMPONENT24,ct=g.stencil?Pf:of,ut=g.stencil?Rf:Iu);const et={colorFormat:r.RGBA8,depthFormat:tt,scaleFactor:a};f=new XRWebGLBinding(i,r),c=f.createProjectionLayer(et),i.updateRenderState({layers:[c]}),t.setPixelRatio(1),t.setSize(c.textureWidth,c.textureHeight,!1),_=new Nu(c.textureWidth,c.textureHeight,{format:ca,type:zo,depthTexture:new n4(c.textureWidth,c.textureHeight,ut,void 0,void 0,void 0,void 0,void 0,void 0,ct),stencilBuffer:g.stencil,colorSpace:t.outputColorSpace,samples:g.antialias?4:0,resolveDepthBuffer:c.ignoreDepthValues===!1})}else{const ct={antialias:g.antialias,alpha:!0,depth:g.depth,stencil:g.stencil,framebufferScaleFactor:a};d=new XRWebGLLayer(i,r,ct),i.updateRenderState({baseLayer:d}),t.setPixelRatio(1),t.setSize(d.framebufferWidth,d.framebufferHeight,!1),_=new Nu(d.framebufferWidth,d.framebufferHeight,{format:ca,type:zo,colorSpace:t.outputColorSpace,stencilBuffer:g.stencil})}_.isXRRenderTarget=!0,this.setFoveation(l),u=null,o=await i.requestReferenceSpace(s),$.setContext(i),$.start(),n.isPresenting=!0,n.dispatchEvent({type:"sessionstart"})}},this.getEnvironmentBlendMode=function(){if(i!==null)return i.environmentBlendMode},this.getDepthTexture=function(){return p.getDepthTexture()};function P(H){for(let Z=0;Z<H.removed.length;Z++){const ct=H.removed[Z],ut=x.indexOf(ct);ut>=0&&(x[ut]=null,y[ut].disconnect(ct))}for(let Z=0;Z<H.added.length;Z++){const ct=H.added[Z];let ut=x.indexOf(ct);if(ut===-1){for(let et=0;et<y.length;et++)if(et>=x.length){x.push(ct),ut=et;break}else if(x[et]===null){x[et]=ct,ut=et;break}if(ut===-1)break}const tt=y[ut];tt&&tt.connect(ct)}}const N=new lt,O=new lt;function I(H,Z,ct){N.setFromMatrixPosition(Z.matrixWorld),O.setFromMatrixPosition(ct.matrixWorld);const ut=N.distanceTo(O),tt=Z.projectionMatrix.elements,et=ct.projectionMatrix.elements,st=tt[14]/(tt[10]-1),nt=tt[14]/(tt[10]+1),dt=(tt[9]+1)/tt[5],At=(tt[9]-1)/tt[5],G=(tt[8]-1)/tt[0],Dt=(et[8]+1)/et[0],Pt=st*G,Lt=st*Dt,zt=ut/(-G+Dt),ne=zt*-G;if(Z.matrixWorld.decompose(H.position,H.quaternion,H.scale),H.translateX(ne),H.translateZ(zt),H.matrixWorld.compose(H.position,H.quaternion,H.scale),H.matrixWorldInverse.copy(H.matrixWorld).invert(),tt[10]===-1)H.projectionMatrix.copy(Z.projectionMatrix),H.projectionMatrixInverse.copy(Z.projectionMatrixInverse);else{const kt=st+zt,V=nt+zt,F=Pt-ne,Q=Lt+(ut-ne),_t=dt*nt/V*kt,gt=At*nt/V*kt;H.projectionMatrix.makePerspective(F,Q,_t,gt,kt,V),H.projectionMatrixInverse.copy(H.projectionMatrix).invert()}}function k(H,Z){Z===null?H.matrixWorld.copy(H.matrix):H.matrixWorld.multiplyMatrices(Z.matrixWorld,H.matrix),H.matrixWorldInverse.copy(H.matrixWorld).invert()}this.updateCamera=function(H){if(i===null)return;let Z=H.near,ct=H.far;p.texture!==null&&(p.depthNear>0&&(Z=p.depthNear),p.depthFar>0&&(ct=p.depthFar)),A.near=w.near=M.near=Z,A.far=w.far=M.far=ct,(E!==A.near||C!==A.far)&&(i.updateRenderState({depthNear:A.near,depthFar:A.far}),E=A.near,C=A.far),M.layers.mask=H.layers.mask|2,w.layers.mask=H.layers.mask|4,A.layers.mask=M.layers.mask|w.layers.mask;const ut=H.parent,tt=A.cameras;k(A,ut);for(let et=0;et<tt.length;et++)k(tt[et],ut);tt.length===2?I(A,M,w):A.projectionMatrix.copy(M.projectionMatrix),z(H,A,ut)};function z(H,Z,ct){ct===null?H.matrix.copy(Z.matrixWorld):(H.matrix.copy(ct.matrixWorld),H.matrix.invert(),H.matrix.multiply(Z.matrixWorld)),H.matrix.decompose(H.position,H.quaternion,H.scale),H.updateMatrixWorld(!0),H.projectionMatrix.copy(Z.projectionMatrix),H.projectionMatrixInverse.copy(Z.projectionMatrixInverse),H.isPerspectiveCamera&&(H.fov=Bb*2*Math.atan(1/H.projectionMatrix.elements[5]),H.zoom=1)}this.getCamera=function(){return A},this.getFoveation=function(){if(!(c===null&&d===null))return l},this.setFoveation=function(H){l=H,c!==null&&(c.fixedFoveation=H),d!==null&&d.fixedFoveation!==void 0&&(d.fixedFoveation=H)},this.hasDepthSensing=function(){return p.texture!==null},this.getDepthSensingMesh=function(){return p.getMesh(A)};let X=null;function Y(H,Z){if(h=Z.getViewerPose(u||o),v=Z,h!==null){const ct=h.views;d!==null&&(t.setRenderTargetFramebuffer(_,d.framebuffer),t.setRenderTarget(_));let ut=!1;ct.length!==A.cameras.length&&(A.cameras.length=0,ut=!0);for(let et=0;et<ct.length;et++){const st=ct[et];let nt=null;if(d!==null)nt=d.getViewport(st);else{const At=f.getViewSubImage(c,st);nt=At.viewport,et===0&&(t.setRenderTargetTextures(_,At.colorTexture,c.ignoreDepthValues?void 0:At.depthStencilTexture),t.setRenderTarget(_))}let dt=b[et];dt===void 0&&(dt=new Bi,dt.layers.enable(et),dt.viewport=new Ur,b[et]=dt),dt.matrix.fromArray(st.transform.matrix),dt.matrix.decompose(dt.position,dt.quaternion,dt.scale),dt.projectionMatrix.fromArray(st.projectionMatrix),dt.projectionMatrixInverse.copy(dt.projectionMatrix).invert(),dt.viewport.set(nt.x,nt.y,nt.width,nt.height),et===0&&(A.matrix.copy(dt.matrix),A.matrix.decompose(A.position,A.quaternion,A.scale)),ut===!0&&A.cameras.push(dt)}const tt=i.enabledFeatures;if(tt&&tt.includes("depth-sensing")){const et=f.getDepthInformation(ct[0]);et&&et.isValid&&et.texture&&p.init(t,et,i.renderState)}}for(let ct=0;ct<y.length;ct++){const ut=x[ct],tt=y[ct];ut!==null&&tt!==void 0&&tt.update(ut,Z,u||o)}X&&X(H,Z),Z.detectedPlanes&&n.dispatchEvent({type:"planesdetected",data:Z}),v=null}const $=new i4;$.setAnimationLoop(Y),this.setAnimationLoop=function(H){X=H},this.dispose=function(){}}}const Nl=new ko,jvt=new qr;function Jvt(e,t){function r(g,m){g.matrixAutoUpdate===!0&&g.updateMatrix(),m.value.copy(g.matrix)}function n(g,m){m.color.getRGB(g.fogColor.value,QG(e)),m.isFog?(g.fogNear.value=m.near,g.fogFar.value=m.far):m.isFogExp2&&(g.fogDensity.value=m.density)}function i(g,m,_,y,x){m.isMeshBasicMaterial||m.isMeshLambertMaterial?a(g,m):m.isMeshToonMaterial?(a(g,m),f(g,m)):m.isMeshPhongMaterial?(a(g,m),h(g,m)):m.isMeshStandardMaterial?(a(g,m),c(g,m),m.isMeshPhysicalMaterial&&d(g,m,x)):m.isMeshMatcapMaterial?(a(g,m),v(g,m)):m.isMeshDepthMaterial?a(g,m):m.isMeshDistanceMaterial?(a(g,m),p(g,m)):m.isMeshNormalMaterial?a(g,m):m.isLineBasicMaterial?(o(g,m),m.isLineDashedMaterial&&s(g,m)):m.isPointsMaterial?l(g,m,_,y):m.isSpriteMaterial?u(g,m):m.isShadowMaterial?(g.color.value.copy(m.color),g.opacity.value=m.opacity):m.isShaderMaterial&&(m.uniformsNeedUpdate=!1)}function a(g,m){g.opacity.value=m.opacity,m.color&&g.diffuse.value.copy(m.color),m.emissive&&g.emissive.value.copy(m.emissive).multiplyScalar(m.emissiveIntensity),m.map&&(g.map.value=m.map,r(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,r(m.alphaMap,g.alphaMapTransform)),m.bumpMap&&(g.bumpMap.value=m.bumpMap,r(m.bumpMap,g.bumpMapTransform),g.bumpScale.value=m.bumpScale,m.side===li&&(g.bumpScale.value*=-1)),m.normalMap&&(g.normalMap.value=m.normalMap,r(m.normalMap,g.normalMapTransform),g.normalScale.value.copy(m.normalScale),m.side===li&&g.normalScale.value.negate()),m.displacementMap&&(g.displacementMap.value=m.displacementMap,r(m.displacementMap,g.displacementMapTransform),g.displacementScale.value=m.displacementScale,g.displacementBias.value=m.displacementBias),m.emissiveMap&&(g.emissiveMap.value=m.emissiveMap,r(m.emissiveMap,g.emissiveMapTransform)),m.specularMap&&(g.specularMap.value=m.specularMap,r(m.specularMap,g.specularMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest);const _=t.get(m),y=_.envMap,x=_.envMapRotation;y&&(g.envMap.value=y,Nl.copy(x),Nl.x*=-1,Nl.y*=-1,Nl.z*=-1,y.isCubeTexture&&y.isRenderTargetTexture===!1&&(Nl.y*=-1,Nl.z*=-1),g.envMapRotation.value.setFromMatrix4(jvt.makeRotationFromEuler(Nl)),g.flipEnvMap.value=y.isCubeTexture&&y.isRenderTargetTexture===!1?-1:1,g.reflectivity.value=m.reflectivity,g.ior.value=m.ior,g.refractionRatio.value=m.refractionRatio),m.lightMap&&(g.lightMap.value=m.lightMap,g.lightMapIntensity.value=m.lightMapIntensity,r(m.lightMap,g.lightMapTransform)),m.aoMap&&(g.aoMap.value=m.aoMap,g.aoMapIntensity.value=m.aoMapIntensity,r(m.aoMap,g.aoMapTransform))}function o(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,m.map&&(g.map.value=m.map,r(m.map,g.mapTransform))}function s(g,m){g.dashSize.value=m.dashSize,g.totalSize.value=m.dashSize+m.gapSize,g.scale.value=m.scale}function l(g,m,_,y){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.size.value=m.size*_,g.scale.value=y*.5,m.map&&(g.map.value=m.map,r(m.map,g.uvTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,r(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function u(g,m){g.diffuse.value.copy(m.color),g.opacity.value=m.opacity,g.rotation.value=m.rotation,m.map&&(g.map.value=m.map,r(m.map,g.mapTransform)),m.alphaMap&&(g.alphaMap.value=m.alphaMap,r(m.alphaMap,g.alphaMapTransform)),m.alphaTest>0&&(g.alphaTest.value=m.alphaTest)}function h(g,m){g.specular.value.copy(m.specular),g.shininess.value=Math.max(m.shininess,1e-4)}function f(g,m){m.gradientMap&&(g.gradientMap.value=m.gradientMap)}function c(g,m){g.metalness.value=m.metalness,m.metalnessMap&&(g.metalnessMap.value=m.metalnessMap,r(m.metalnessMap,g.metalnessMapTransform)),g.roughness.value=m.roughness,m.roughnessMap&&(g.roughnessMap.value=m.roughnessMap,r(m.roughnessMap,g.roughnessMapTransform)),m.envMap&&(g.envMapIntensity.value=m.envMapIntensity)}function d(g,m,_){g.ior.value=m.ior,m.sheen>0&&(g.sheenColor.value.copy(m.sheenColor).multiplyScalar(m.sheen),g.sheenRoughness.value=m.sheenRoughness,m.sheenColorMap&&(g.sheenColorMap.value=m.sheenColorMap,r(m.sheenColorMap,g.sheenColorMapTransform)),m.sheenRoughnessMap&&(g.sheenRoughnessMap.value=m.sheenRoughnessMap,r(m.sheenRoughnessMap,g.sheenRoughnessMapTransform))),m.clearcoat>0&&(g.clearcoat.value=m.clearcoat,g.clearcoatRoughness.value=m.clearcoatRoughness,m.clearcoatMap&&(g.clearcoatMap.value=m.clearcoatMap,r(m.clearcoatMap,g.clearcoatMapTransform)),m.clearcoatRoughnessMap&&(g.clearcoatRoughnessMap.value=m.clearcoatRoughnessMap,r(m.clearcoatRoughnessMap,g.clearcoatRoughnessMapTransform)),m.clearcoatNormalMap&&(g.clearcoatNormalMap.value=m.clearcoatNormalMap,r(m.clearcoatNormalMap,g.clearcoatNormalMapTransform),g.clearcoatNormalScale.value.copy(m.clearcoatNormalScale),m.side===li&&g.clearcoatNormalScale.value.negate())),m.dispersion>0&&(g.dispersion.value=m.dispersion),m.iridescence>0&&(g.iridescence.value=m.iridescence,g.iridescenceIOR.value=m.iridescenceIOR,g.iridescenceThicknessMinimum.value=m.iridescenceThicknessRange[0],g.iridescenceThicknessMaximum.value=m.iridescenceThicknessRange[1],m.iridescenceMap&&(g.iridescenceMap.value=m.iridescenceMap,r(m.iridescenceMap,g.iridescenceMapTransform)),m.iridescenceThicknessMap&&(g.iridescenceThicknessMap.value=m.iridescenceThicknessMap,r(m.iridescenceThicknessMap,g.iridescenceThicknessMapTransform))),m.transmission>0&&(g.transmission.value=m.transmission,g.transmissionSamplerMap.value=_.texture,g.transmissionSamplerSize.value.set(_.width,_.height),m.transmissionMap&&(g.transmissionMap.value=m.transmissionMap,r(m.transmissionMap,g.transmissionMapTransform)),g.thickness.value=m.thickness,m.thicknessMap&&(g.thicknessMap.value=m.thicknessMap,r(m.thicknessMap,g.thicknessMapTransform)),g.attenuationDistance.value=m.attenuationDistance,g.attenuationColor.value.copy(m.attenuationColor)),m.anisotropy>0&&(g.anisotropyVector.value.set(m.anisotropy*Math.cos(m.anisotropyRotation),m.anisotropy*Math.sin(m.anisotropyRotation)),m.anisotropyMap&&(g.anisotropyMap.value=m.anisotropyMap,r(m.anisotropyMap,g.anisotropyMapTransform))),g.specularIntensity.value=m.specularIntensity,g.specularColor.value.copy(m.specularColor),m.specularColorMap&&(g.specularColorMap.value=m.specularColorMap,r(m.specularColorMap,g.specularColorMapTransform)),m.specularIntensityMap&&(g.specularIntensityMap.value=m.specularIntensityMap,r(m.specularIntensityMap,g.specularIntensityMapTransform))}function v(g,m){m.matcap&&(g.matcap.value=m.matcap)}function p(g,m){const _=t.get(m).light;g.referencePosition.value.setFromMatrixPosition(_.matrixWorld),g.nearDistance.value=_.shadow.camera.near,g.farDistance.value=_.shadow.camera.far}return{refreshFogUniforms:n,refreshMaterialUniforms:i}}function Qvt(e,t,r,n){let i={},a={},o=[];const s=e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS);function l(_,y){const x=y.program;n.uniformBlockBinding(_,x)}function u(_,y){let x=i[_.id];x===void 0&&(v(_),x=h(_),i[_.id]=x,_.addEventListener("dispose",g));const T=y.program;n.updateUBOMapping(_,T);const S=t.render.frame;a[_.id]!==S&&(c(_),a[_.id]=S)}function h(_){const y=f();_.__bindingPointIndex=y;const x=e.createBuffer(),T=_.__size,S=_.usage;return e.bindBuffer(e.UNIFORM_BUFFER,x),e.bufferData(e.UNIFORM_BUFFER,T,S),e.bindBuffer(e.UNIFORM_BUFFER,null),e.bindBufferBase(e.UNIFORM_BUFFER,y,x),x}function f(){for(let _=0;_<s;_++)if(o.indexOf(_)===-1)return o.push(_),_;return console.error("THREE.WebGLRenderer: Maximum number of simultaneously usable uniforms groups reached."),0}function c(_){const y=i[_.id],x=_.uniforms,T=_.__cache;e.bindBuffer(e.UNIFORM_BUFFER,y);for(let S=0,M=x.length;S<M;S++){const w=Array.isArray(x[S])?x[S]:[x[S]];for(let b=0,A=w.length;b<A;b++){const E=w[b];if(d(E,S,b,T)===!0){const C=E.__offset,D=Array.isArray(E.value)?E.value:[E.value];let L=0;for(let P=0;P<D.length;P++){const N=D[P],O=p(N);typeof N=="number"||typeof N=="boolean"?(E.__data[0]=N,e.bufferSubData(e.UNIFORM_BUFFER,C+L,E.__data)):N.isMatrix3?(E.__data[0]=N.elements[0],E.__data[1]=N.elements[1],E.__data[2]=N.elements[2],E.__data[3]=0,E.__data[4]=N.elements[3],E.__data[5]=N.elements[4],E.__data[6]=N.elements[5],E.__data[7]=0,E.__data[8]=N.elements[6],E.__data[9]=N.elements[7],E.__data[10]=N.elements[8],E.__data[11]=0):(N.toArray(E.__data,L),L+=O.storage/Float32Array.BYTES_PER_ELEMENT)}e.bufferSubData(e.UNIFORM_BUFFER,C,E.__data)}}}e.bindBuffer(e.UNIFORM_BUFFER,null)}function d(_,y,x,T){const S=_.value,M=y+"_"+x;if(T[M]===void 0)return typeof S=="number"||typeof S=="boolean"?T[M]=S:T[M]=S.clone(),!0;{const w=T[M];if(typeof S=="number"||typeof S=="boolean"){if(w!==S)return T[M]=S,!0}else if(w.equals(S)===!1)return w.copy(S),!0}return!1}function v(_){const y=_.uniforms;let x=0;const T=16;for(let M=0,w=y.length;M<w;M++){const b=Array.isArray(y[M])?y[M]:[y[M]];for(let A=0,E=b.length;A<E;A++){const C=b[A],D=Array.isArray(C.value)?C.value:[C.value];for(let L=0,P=D.length;L<P;L++){const N=D[L],O=p(N),I=x%T,k=I%O.boundary,z=I+k;x+=k,z!==0&&T-z<O.storage&&(x+=T-z),C.__data=new Float32Array(O.storage/Float32Array.BYTES_PER_ELEMENT),C.__offset=x,x+=O.storage}}}const S=x%T;return S>0&&(x+=T-S),_.__size=x,_.__cache={},this}function p(_){const y={boundary:0,storage:0};return typeof _=="number"||typeof _=="boolean"?(y.boundary=4,y.storage=4):_.isVector2?(y.boundary=8,y.storage=8):_.isVector3||_.isColor?(y.boundary=16,y.storage=12):_.isVector4?(y.boundary=16,y.storage=16):_.isMatrix3?(y.boundary=48,y.storage=48):_.isMatrix4?(y.boundary=64,y.storage=64):_.isTexture?console.warn("THREE.WebGLRenderer: Texture samplers can not be part of an uniforms group."):console.warn("THREE.WebGLRenderer: Unsupported uniform value type.",_),y}function g(_){const y=_.target;y.removeEventListener("dispose",g);const x=o.indexOf(y.__bindingPointIndex);o.splice(x,1),e.deleteBuffer(i[y.id]),delete i[y.id],delete a[y.id]}function m(){for(const _ in i)e.deleteBuffer(i[_]);o=[],i={},a={}}return{bind:l,update:u,dispose:m}}class tpt{constructor(t={}){const{canvas:r=Fut(),context:n=null,depth:i=!0,stencil:a=!1,alpha:o=!1,antialias:s=!1,premultipliedAlpha:l=!0,preserveDrawingBuffer:u=!1,powerPreference:h="default",failIfMajorPerformanceCaveat:f=!1,reverseDepthBuffer:c=!1}=t;this.isWebGLRenderer=!0;let d;if(n!==null){if(typeof WebGLRenderingContext<"u"&&n instanceof WebGLRenderingContext)throw new Error("THREE.WebGLRenderer: WebGL 1 is not supported since r163.");d=n.getContextAttributes().alpha}else d=o;const v=new Uint32Array(4),p=new Int32Array(4);let g=null,m=null;const _=[],y=[];this.domElement=r,this.debug={checkShaderErrors:!0,onShaderError:null},this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this._outputColorSpace=Pi,this.toneMapping=Ps,this.toneMappingExposure=1;const x=this;let T=!1,S=0,M=0,w=null,b=-1,A=null;const E=new Ur,C=new Ur;let D=null;const L=new fr(0);let P=0,N=r.width,O=r.height,I=1,k=null,z=null;const X=new Ur(0,0,N,O),Y=new Ur(0,0,N,O);let $=!1;const H=new r4;let Z=!1,ct=!1;this.transmissionResolutionScale=1;const ut=new qr,tt=new qr,et=new lt,st=new Ur,nt={background:null,fog:null,environment:null,overrideMaterial:null,isScene:!0};let dt=!1;function At(){return w===null?I:1}let G=n;function Dt(B,j){return r.getContext(B,j)}try{const B={alpha:!0,depth:i,stencil:a,antialias:s,premultipliedAlpha:l,preserveDrawingBuffer:u,powerPreference:h,failIfMajorPerformanceCaveat:f};if("setAttribute"in r&&r.setAttribute("data-engine",`three.js r${_A}`),r.addEventListener("webglcontextlost",St,!1),r.addEventListener("webglcontextrestored",$t,!1),r.addEventListener("webglcontextcreationerror",Zt,!1),G===null){const j="webgl2";if(G=Dt(j,B),G===null)throw Dt(j)?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.")}}catch(B){throw console.error("THREE.WebGLRenderer: "+B.message),B}let Pt,Lt,zt,ne,kt,V,F,Q,_t,gt,pt,jt,Gt,Jt,Ne,wt,qt,de,Se,ie,qe,Oe,gr,K;function Wt(){Pt=new udt(G),Pt.init(),Oe=new Xvt(G,Pt),Lt=new ndt(G,Pt,t,Oe),zt=new Hvt(G,Pt),Lt.reverseDepthBuffer&&c&&zt.buffers.depth.setReversed(!0),ne=new cdt(G),kt=new Lvt,V=new Wvt(G,Pt,zt,kt,Lt,Oe,ne),F=new adt(x),Q=new ldt(x),_t=new yht(G),gr=new edt(G,_t),gt=new hdt(G,_t,ne,gr),pt=new vdt(G,gt,_t,ne),Se=new ddt(G,Lt,V),wt=new idt(kt),jt=new Dvt(x,F,Q,Pt,Lt,gr,wt),Gt=new Jvt(x,kt),Jt=new Pvt,Ne=new Uvt(Pt),de=new tdt(x,F,Q,zt,pt,d,l),qt=new Gvt(x,pt,Lt),K=new Qvt(G,ne,Lt,zt),ie=new rdt(G,Pt,ne),qe=new fdt(G,Pt,ne),ne.programs=jt.programs,x.capabilities=Lt,x.extensions=Pt,x.properties=kt,x.renderLists=Jt,x.shadowMap=qt,x.state=zt,x.info=ne}Wt();const vt=new Kvt(x,G);this.xr=vt,this.getContext=function(){return G},this.getContextAttributes=function(){return G.getContextAttributes()},this.forceContextLoss=function(){const B=Pt.get("WEBGL_lose_context");B&&B.loseContext()},this.forceContextRestore=function(){const B=Pt.get("WEBGL_lose_context");B&&B.restoreContext()},this.getPixelRatio=function(){return I},this.setPixelRatio=function(B){B!==void 0&&(I=B,this.setSize(N,O,!1))},this.getSize=function(B){return B.set(N,O)},this.setSize=function(B,j,it=!0){if(vt.isPresenting){console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");return}N=B,O=j,r.width=Math.floor(B*I),r.height=Math.floor(j*I),it===!0&&(r.style.width=B+"px",r.style.height=j+"px"),this.setViewport(0,0,B,j)},this.getDrawingBufferSize=function(B){return B.set(N*I,O*I).floor()},this.setDrawingBufferSize=function(B,j,it){N=B,O=j,I=it,r.width=Math.floor(B*it),r.height=Math.floor(j*it),this.setViewport(0,0,B,j)},this.getCurrentViewport=function(B){return B.copy(E)},this.getViewport=function(B){return B.copy(X)},this.setViewport=function(B,j,it,ot){B.isVector4?X.set(B.x,B.y,B.z,B.w):X.set(B,j,it,ot),zt.viewport(E.copy(X).multiplyScalar(I).round())},this.getScissor=function(B){return B.copy(Y)},this.setScissor=function(B,j,it,ot){B.isVector4?Y.set(B.x,B.y,B.z,B.w):Y.set(B,j,it,ot),zt.scissor(C.copy(Y).multiplyScalar(I).round())},this.getScissorTest=function(){return $},this.setScissorTest=function(B){zt.setScissorTest($=B)},this.setOpaqueSort=function(B){k=B},this.setTransparentSort=function(B){z=B},this.getClearColor=function(B){return B.copy(de.getClearColor())},this.setClearColor=function(){de.setClearColor.apply(de,arguments)},this.getClearAlpha=function(){return de.getClearAlpha()},this.setClearAlpha=function(){de.setClearAlpha.apply(de,arguments)},this.clear=function(B=!0,j=!0,it=!0){let ot=0;if(B){let J=!1;if(w!==null){const Rt=w.texture.format;J=Rt===wA||Rt===bA||Rt===TA}if(J){const Rt=w.texture.type,Xt=Rt===zo||Rt===Iu||Rt===mv||Rt===Rf||Rt===xA||Rt===SA,ee=de.getClearColor(),ae=de.getClearAlpha(),Te=ee.r,Me=ee.g,ve=ee.b;Xt?(v[0]=Te,v[1]=Me,v[2]=ve,v[3]=ae,G.clearBufferuiv(G.COLOR,0,v)):(p[0]=Te,p[1]=Me,p[2]=ve,p[3]=ae,G.clearBufferiv(G.COLOR,0,p))}else ot|=G.COLOR_BUFFER_BIT}j&&(ot|=G.DEPTH_BUFFER_BIT),it&&(ot|=G.STENCIL_BUFFER_BIT,this.state.buffers.stencil.setMask(4294967295)),G.clear(ot)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.dispose=function(){r.removeEventListener("webglcontextlost",St,!1),r.removeEventListener("webglcontextrestored",$t,!1),r.removeEventListener("webglcontextcreationerror",Zt,!1),de.dispose(),Jt.dispose(),Ne.dispose(),kt.dispose(),F.dispose(),Q.dispose(),pt.dispose(),gr.dispose(),K.dispose(),jt.dispose(),vt.dispose(),vt.removeEventListener("sessionstart",CA),vt.removeEventListener("sessionend",DA),Ks.stop()};function St(B){B.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),T=!0}function $t(){console.log("THREE.WebGLRenderer: Context Restored."),T=!1;const B=ne.autoReset,j=qt.enabled,it=qt.autoUpdate,ot=qt.needsUpdate,J=qt.type;Wt(),ne.autoReset=B,qt.enabled=j,qt.autoUpdate=it,qt.needsUpdate=ot,qt.type=J}function Zt(B){console.error("THREE.WebGLRenderer: A WebGL context could not be created. Reason: ",B.statusMessage)}function Re(B){const j=B.target;j.removeEventListener("dispose",Re),Ar(j)}function Ar(B){Tn(B),kt.remove(B)}function Tn(B){const j=kt.get(B).programs;j!==void 0&&(j.forEach(function(it){jt.releaseProgram(it)}),B.isShaderMaterial&&jt.releaseShaderCache(B))}this.renderBufferDirect=function(B,j,it,ot,J,Rt){j===null&&(j=nt);const Xt=J.isMesh&&J.matrixWorld.determinant()<0,ee=u4(B,j,it,ot,J);zt.setMaterial(ot,Xt);let ae=it.index,Te=1;if(ot.wireframe===!0){if(ae=gt.getWireframeAttribute(it),ae===void 0)return;Te=2}const Me=it.drawRange,ve=it.attributes.position;let Ke=Me.start*Te,ir=(Me.start+Me.count)*Te;Rt!==null&&(Ke=Math.max(Ke,Rt.start*Te),ir=Math.min(ir,(Rt.start+Rt.count)*Te)),ae!==null?(Ke=Math.max(Ke,0),ir=Math.min(ir,ae.count)):ve!=null&&(Ke=Math.max(Ke,0),ir=Math.min(ir,ve.count));const Gr=ir-Ke;if(Gr<0||Gr===1/0)return;gr.setup(J,ot,ee,it,ae);let Er,Qe=ie;if(ae!==null&&(Er=_t.get(ae),Qe=qe,Qe.setIndex(Er)),J.isMesh)ot.wireframe===!0?(zt.setLineWidth(ot.wireframeLinewidth*At()),Qe.setMode(G.LINES)):Qe.setMode(G.TRIANGLES);else if(J.isLine){let ge=ot.linewidth;ge===void 0&&(ge=1),zt.setLineWidth(ge*At()),J.isLineSegments?Qe.setMode(G.LINES):J.isLineLoop?Qe.setMode(G.LINE_LOOP):Qe.setMode(G.LINE_STRIP)}else J.isPoints?Qe.setMode(G.POINTS):J.isSprite&&Qe.setMode(G.TRIANGLES);if(J.isBatchedMesh)if(J._multiDrawInstances!==null)Qe.renderMultiDrawInstances(J._multiDrawStarts,J._multiDrawCounts,J._multiDrawCount,J._multiDrawInstances);else if(Pt.get("WEBGL_multi_draw"))Qe.renderMultiDraw(J._multiDrawStarts,J._multiDrawCounts,J._multiDrawCount);else{const ge=J._multiDrawStarts,_n=J._multiDrawCounts,ar=J._multiDrawCount,ji=ae?_t.get(ae).bytesPerElement:1,Zu=kt.get(ot).currentProgram.getUniforms();for(let di=0;di<ar;di++)Zu.setValue(G,"_gl_DrawID",di),Qe.render(ge[di]/ji,_n[di])}else if(J.isInstancedMesh)Qe.renderInstances(Ke,Gr,J.count);else if(it.isInstancedBufferGeometry){const ge=it._maxInstanceCount!==void 0?it._maxInstanceCount:1/0,_n=Math.min(it.instanceCount,ge);Qe.renderInstances(Ke,Gr,_n)}else Qe.render(Ke,Gr)};function ur(B,j,it){B.transparent===!0&&B.side===_o&&B.forceSinglePass===!1?(B.side=li,B.needsUpdate=!0,qv(B,j,it),B.side=Gs,B.needsUpdate=!0,qv(B,j,it),B.side=_o):qv(B,j,it)}this.compile=function(B,j,it=null){it===null&&(it=B),m=Ne.get(it),m.init(j),y.push(m),it.traverseVisible(function(J){J.isLight&&J.layers.test(j.layers)&&(m.pushLight(J),J.castShadow&&m.pushShadow(J))}),B!==it&&B.traverseVisible(function(J){J.isLight&&J.layers.test(j.layers)&&(m.pushLight(J),J.castShadow&&m.pushShadow(J))}),m.setupLights();const ot=new Set;return B.traverse(function(J){if(!(J.isMesh||J.isPoints||J.isLine||J.isSprite))return;const Rt=J.material;if(Rt)if(Array.isArray(Rt))for(let Xt=0;Xt<Rt.length;Xt++){const ee=Rt[Xt];ur(ee,it,J),ot.add(ee)}else ur(Rt,it,J),ot.add(Rt)}),y.pop(),m=null,ot},this.compileAsync=function(B,j,it=null){const ot=this.compile(B,j,it);return new Promise(J=>{function Rt(){if(ot.forEach(function(Xt){kt.get(Xt).currentProgram.isReady()&&ot.delete(Xt)}),ot.size===0){J(B);return}setTimeout(Rt,10)}Pt.get("KHR_parallel_shader_compile")!==null?Rt():setTimeout(Rt,10)})};let Ki=null;function eo(B){Ki&&Ki(B)}function CA(){Ks.stop()}function DA(){Ks.start()}const Ks=new i4;Ks.setAnimationLoop(eo),typeof self<"u"&&Ks.setContext(self),this.setAnimationLoop=function(B){Ki=B,vt.setAnimationLoop(B),B===null?Ks.stop():Ks.start()},vt.addEventListener("sessionstart",CA),vt.addEventListener("sessionend",DA),this.render=function(B,j){if(j!==void 0&&j.isCamera!==!0){console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");return}if(T===!0)return;if(B.matrixWorldAutoUpdate===!0&&B.updateMatrixWorld(),j.parent===null&&j.matrixWorldAutoUpdate===!0&&j.updateMatrixWorld(),vt.enabled===!0&&vt.isPresenting===!0&&(vt.cameraAutoUpdate===!0&&vt.updateCamera(j),j=vt.getCamera()),B.isScene===!0&&B.onBeforeRender(x,B,j,w),m=Ne.get(B,y.length),m.init(j),y.push(m),tt.multiplyMatrices(j.projectionMatrix,j.matrixWorldInverse),H.setFromProjectionMatrix(tt),ct=this.localClippingEnabled,Z=wt.init(this.clippingPlanes,ct),g=Jt.get(B,_.length),g.init(),_.push(g),vt.enabled===!0&&vt.isPresenting===!0){const Rt=x.xr.getDepthSensingMesh();Rt!==null&&x0(Rt,j,-1/0,x.sortObjects)}x0(B,j,0,x.sortObjects),g.finish(),x.sortObjects===!0&&g.sort(k,z),dt=vt.enabled===!1||vt.isPresenting===!1||vt.hasDepthSensing()===!1,dt&&de.addToRenderList(g,B),this.info.render.frame++,Z===!0&&wt.beginShadows();const it=m.state.shadowsArray;qt.render(it,B,j),Z===!0&&wt.endShadows(),this.info.autoReset===!0&&this.info.reset();const ot=g.opaque,J=g.transmissive;if(m.setupLights(),j.isArrayCamera){const Rt=j.cameras;if(J.length>0)for(let Xt=0,ee=Rt.length;Xt<ee;Xt++){const ae=Rt[Xt];RA(ot,J,B,ae)}dt&&de.render(B);for(let Xt=0,ee=Rt.length;Xt<ee;Xt++){const ae=Rt[Xt];LA(g,B,ae,ae.viewport)}}else J.length>0&&RA(ot,J,B,j),dt&&de.render(B),LA(g,B,j);w!==null&&M===0&&(V.updateMultisampleRenderTarget(w),V.updateRenderTargetMipmap(w)),B.isScene===!0&&B.onAfterRender(x,B,j),gr.resetDefaultState(),b=-1,A=null,y.pop(),y.length>0?(m=y[y.length-1],Z===!0&&wt.setGlobalState(x.clippingPlanes,m.state.camera)):m=null,_.pop(),_.length>0?g=_[_.length-1]:g=null};function x0(B,j,it,ot){if(B.visible===!1)return;if(B.layers.test(j.layers)){if(B.isGroup)it=B.renderOrder;else if(B.isLOD)B.autoUpdate===!0&&B.update(j);else if(B.isLight)m.pushLight(B),B.castShadow&&m.pushShadow(B);else if(B.isSprite){if(!B.frustumCulled||H.intersectsSprite(B)){ot&&st.setFromMatrixPosition(B.matrixWorld).applyMatrix4(tt);const Xt=pt.update(B),ee=B.material;ee.visible&&g.push(B,Xt,ee,it,st.z,null)}}else if((B.isMesh||B.isLine||B.isPoints)&&(!B.frustumCulled||H.intersectsObject(B))){const Xt=pt.update(B),ee=B.material;if(ot&&(B.boundingSphere!==void 0?(B.boundingSphere===null&&B.computeBoundingSphere(),st.copy(B.boundingSphere.center)):(Xt.boundingSphere===null&&Xt.computeBoundingSphere(),st.copy(Xt.boundingSphere.center)),st.applyMatrix4(B.matrixWorld).applyMatrix4(tt)),Array.isArray(ee)){const ae=Xt.groups;for(let Te=0,Me=ae.length;Te<Me;Te++){const ve=ae[Te],Ke=ee[ve.materialIndex];Ke&&Ke.visible&&g.push(B,Xt,Ke,it,st.z,ve)}}else ee.visible&&g.push(B,Xt,ee,it,st.z,null)}}const Rt=B.children;for(let Xt=0,ee=Rt.length;Xt<ee;Xt++)x0(Rt[Xt],j,it,ot)}function LA(B,j,it,ot){const J=B.opaque,Rt=B.transmissive,Xt=B.transparent;m.setupLightsView(it),Z===!0&&wt.setGlobalState(x.clippingPlanes,it),ot&&zt.viewport(E.copy(ot)),J.length>0&&Zv(J,j,it),Rt.length>0&&Zv(Rt,j,it),Xt.length>0&&Zv(Xt,j,it),zt.buffers.depth.setTest(!0),zt.buffers.depth.setMask(!0),zt.buffers.color.setMask(!0),zt.setPolygonOffset(!1)}function RA(B,j,it,ot){if((it.isScene===!0?it.overrideMaterial:null)!==null)return;m.state.transmissionRenderTarget[ot.id]===void 0&&(m.state.transmissionRenderTarget[ot.id]=new Nu(1,1,{generateMipmaps:!0,type:Pt.has("EXT_color_buffer_half_float")||Pt.has("EXT_color_buffer_float")?Hv:zo,minFilter:su,samples:4,stencilBuffer:a,resolveDepthBuffer:!1,resolveStencilBuffer:!1,colorSpace:tr.workingColorSpace}));const Rt=m.state.transmissionRenderTarget[ot.id],Xt=ot.viewport||E;Rt.setSize(Xt.z*x.transmissionResolutionScale,Xt.w*x.transmissionResolutionScale);const ee=x.getRenderTarget();x.setRenderTarget(Rt),x.getClearColor(L),P=x.getClearAlpha(),P<1&&x.setClearColor(16777215,.5),x.clear(),dt&&de.render(it);const ae=x.toneMapping;x.toneMapping=Ps;const Te=ot.viewport;if(ot.viewport!==void 0&&(ot.viewport=void 0),m.setupLightsView(ot),Z===!0&&wt.setGlobalState(x.clippingPlanes,ot),Zv(B,it,ot),V.updateMultisampleRenderTarget(Rt),V.updateRenderTargetMipmap(Rt),Pt.has("WEBGL_multisampled_render_to_texture")===!1){let Me=!1;for(let ve=0,Ke=j.length;ve<Ke;ve++){const ir=j[ve],Gr=ir.object,Er=ir.geometry,Qe=ir.material,ge=ir.group;if(Qe.side===_o&&Gr.layers.test(ot.layers)){const _n=Qe.side;Qe.side=li,Qe.needsUpdate=!0,PA(Gr,it,ot,Er,Qe,ge),Qe.side=_n,Qe.needsUpdate=!0,Me=!0}}Me===!0&&(V.updateMultisampleRenderTarget(Rt),V.updateRenderTargetMipmap(Rt))}x.setRenderTarget(ee),x.setClearColor(L,P),Te!==void 0&&(ot.viewport=Te),x.toneMapping=ae}function Zv(B,j,it){const ot=j.isScene===!0?j.overrideMaterial:null;for(let J=0,Rt=B.length;J<Rt;J++){const Xt=B[J],ee=Xt.object,ae=Xt.geometry,Te=ot===null?Xt.material:ot,Me=Xt.group;ee.layers.test(it.layers)&&PA(ee,j,it,ae,Te,Me)}}function PA(B,j,it,ot,J,Rt){B.onBeforeRender(x,j,it,ot,J,Rt),B.modelViewMatrix.multiplyMatrices(it.matrixWorldInverse,B.matrixWorld),B.normalMatrix.getNormalMatrix(B.modelViewMatrix),J.onBeforeRender(x,j,it,ot,B,Rt),J.transparent===!0&&J.side===_o&&J.forceSinglePass===!1?(J.side=li,J.needsUpdate=!0,x.renderBufferDirect(it,j,ot,J,B,Rt),J.side=Gs,J.needsUpdate=!0,x.renderBufferDirect(it,j,ot,J,B,Rt),J.side=_o):x.renderBufferDirect(it,j,ot,J,B,Rt),B.onAfterRender(x,j,it,ot,J,Rt)}function qv(B,j,it){j.isScene!==!0&&(j=nt);const ot=kt.get(B),J=m.state.lights,Rt=m.state.shadowsArray,Xt=J.state.version,ee=jt.getParameters(B,J.state,Rt,j,it),ae=jt.getProgramCacheKey(ee);let Te=ot.programs;ot.environment=B.isMeshStandardMaterial?j.environment:null,ot.fog=j.fog,ot.envMap=(B.isMeshStandardMaterial?Q:F).get(B.envMap||ot.environment),ot.envMapRotation=ot.environment!==null&&B.envMap===null?j.environmentRotation:B.envMapRotation,Te===void 0&&(B.addEventListener("dispose",Re),Te=new Map,ot.programs=Te);let Me=Te.get(ae);if(Me!==void 0){if(ot.currentProgram===Me&&ot.lightsStateVersion===Xt)return NA(B,ee),Me}else ee.uniforms=jt.getUniforms(B),B.onBeforeCompile(ee,x),Me=jt.acquireProgram(ee,ae),Te.set(ae,Me),ot.uniforms=ee.uniforms;const ve=ot.uniforms;return(!B.isShaderMaterial&&!B.isRawShaderMaterial||B.clipping===!0)&&(ve.clippingPlanes=wt.uniform),NA(B,ee),ot.needsLights=f4(B),ot.lightsStateVersion=Xt,ot.needsLights&&(ve.ambientLightColor.value=J.state.ambient,ve.lightProbe.value=J.state.probe,ve.directionalLights.value=J.state.directional,ve.directionalLightShadows.value=J.state.directionalShadow,ve.spotLights.value=J.state.spot,ve.spotLightShadows.value=J.state.spotShadow,ve.rectAreaLights.value=J.state.rectArea,ve.ltc_1.value=J.state.rectAreaLTC1,ve.ltc_2.value=J.state.rectAreaLTC2,ve.pointLights.value=J.state.point,ve.pointLightShadows.value=J.state.pointShadow,ve.hemisphereLights.value=J.state.hemi,ve.directionalShadowMap.value=J.state.directionalShadowMap,ve.directionalShadowMatrix.value=J.state.directionalShadowMatrix,ve.spotShadowMap.value=J.state.spotShadowMap,ve.spotLightMatrix.value=J.state.spotLightMatrix,ve.spotLightMap.value=J.state.spotLightMap,ve.pointShadowMap.value=J.state.pointShadowMap,ve.pointShadowMatrix.value=J.state.pointShadowMatrix),ot.currentProgram=Me,ot.uniformsList=null,Me}function IA(B){if(B.uniformsList===null){const j=B.currentProgram.getUniforms();B.uniformsList=hm.seqWithValue(j.seq,B.uniforms)}return B.uniformsList}function NA(B,j){const it=kt.get(B);it.outputColorSpace=j.outputColorSpace,it.batching=j.batching,it.batchingColor=j.batchingColor,it.instancing=j.instancing,it.instancingColor=j.instancingColor,it.instancingMorph=j.instancingMorph,it.skinning=j.skinning,it.morphTargets=j.morphTargets,it.morphNormals=j.morphNormals,it.morphColors=j.morphColors,it.morphTargetsCount=j.morphTargetsCount,it.numClippingPlanes=j.numClippingPlanes,it.numIntersection=j.numClipIntersection,it.vertexAlphas=j.vertexAlphas,it.vertexTangents=j.vertexTangents,it.toneMapping=j.toneMapping}function u4(B,j,it,ot,J){j.isScene!==!0&&(j=nt),V.resetTextureUnits();const Rt=j.fog,Xt=ot.isMeshStandardMaterial?j.environment:null,ee=w===null?x.outputColorSpace:w.isXRRenderTarget===!0?w.texture.colorSpace:If,ae=(ot.isMeshStandardMaterial?Q:F).get(ot.envMap||Xt),Te=ot.vertexColors===!0&&!!it.attributes.color&&it.attributes.color.itemSize===4,Me=!!it.attributes.tangent&&(!!ot.normalMap||ot.anisotropy>0),ve=!!it.morphAttributes.position,Ke=!!it.morphAttributes.normal,ir=!!it.morphAttributes.color;let Gr=Ps;ot.toneMapped&&(w===null||w.isXRRenderTarget===!0)&&(Gr=x.toneMapping);const Er=it.morphAttributes.position||it.morphAttributes.normal||it.morphAttributes.color,Qe=Er!==void 0?Er.length:0,ge=kt.get(ot),_n=m.state.lights;if(Z===!0&&(ct===!0||B!==A)){const Rn=B===A&&ot.id===b;wt.setState(ot,B,Rn)}let ar=!1;ot.version===ge.__version?(ge.needsLights&&ge.lightsStateVersion!==_n.state.version||ge.outputColorSpace!==ee||J.isBatchedMesh&&ge.batching===!1||!J.isBatchedMesh&&ge.batching===!0||J.isBatchedMesh&&ge.batchingColor===!0&&J.colorTexture===null||J.isBatchedMesh&&ge.batchingColor===!1&&J.colorTexture!==null||J.isInstancedMesh&&ge.instancing===!1||!J.isInstancedMesh&&ge.instancing===!0||J.isSkinnedMesh&&ge.skinning===!1||!J.isSkinnedMesh&&ge.skinning===!0||J.isInstancedMesh&&ge.instancingColor===!0&&J.instanceColor===null||J.isInstancedMesh&&ge.instancingColor===!1&&J.instanceColor!==null||J.isInstancedMesh&&ge.instancingMorph===!0&&J.morphTexture===null||J.isInstancedMesh&&ge.instancingMorph===!1&&J.morphTexture!==null||ge.envMap!==ae||ot.fog===!0&&ge.fog!==Rt||ge.numClippingPlanes!==void 0&&(ge.numClippingPlanes!==wt.numPlanes||ge.numIntersection!==wt.numIntersection)||ge.vertexAlphas!==Te||ge.vertexTangents!==Me||ge.morphTargets!==ve||ge.morphNormals!==Ke||ge.morphColors!==ir||ge.toneMapping!==Gr||ge.morphTargetsCount!==Qe)&&(ar=!0):(ar=!0,ge.__version=ot.version);let ji=ge.currentProgram;ar===!0&&(ji=qv(ot,j,J));let Zu=!1,di=!1,uc=!1;const Tr=ji.getUniforms(),yi=ge.uniforms;if(zt.useProgram(ji.program)&&(Zu=!0,di=!0,uc=!0),ot.id!==b&&(b=ot.id,di=!0),Zu||A!==B){zt.buffers.depth.getReversed()?(ut.copy(B.projectionMatrix),Uut(ut),zut(ut),Tr.setValue(G,"projectionMatrix",ut)):Tr.setValue(G,"projectionMatrix",B.projectionMatrix),Tr.setValue(G,"viewMatrix",B.matrixWorldInverse);const jn=Tr.map.cameraPosition;jn!==void 0&&jn.setValue(G,et.setFromMatrixPosition(B.matrixWorld)),Lt.logarithmicDepthBuffer&&Tr.setValue(G,"logDepthBufFC",2/(Math.log(B.far+1)/Math.LN2)),(ot.isMeshPhongMaterial||ot.isMeshToonMaterial||ot.isMeshLambertMaterial||ot.isMeshBasicMaterial||ot.isMeshStandardMaterial||ot.isShaderMaterial)&&Tr.setValue(G,"isOrthographic",B.isOrthographicCamera===!0),A!==B&&(A=B,di=!0,uc=!0)}if(J.isSkinnedMesh){Tr.setOptional(G,J,"bindMatrix"),Tr.setOptional(G,J,"bindMatrixInverse");const Rn=J.skeleton;Rn&&(Rn.boneTexture===null&&Rn.computeBoneTexture(),Tr.setValue(G,"boneTexture",Rn.boneTexture,V))}J.isBatchedMesh&&(Tr.setOptional(G,J,"batchingTexture"),Tr.setValue(G,"batchingTexture",J._matricesTexture,V),Tr.setOptional(G,J,"batchingIdTexture"),Tr.setValue(G,"batchingIdTexture",J._indirectTexture,V),Tr.setOptional(G,J,"batchingColorTexture"),J._colorsTexture!==null&&Tr.setValue(G,"batchingColorTexture",J._colorsTexture,V));const xi=it.morphAttributes;if((xi.position!==void 0||xi.normal!==void 0||xi.color!==void 0)&&Se.update(J,it,ji),(di||ge.receiveShadow!==J.receiveShadow)&&(ge.receiveShadow=J.receiveShadow,Tr.setValue(G,"receiveShadow",J.receiveShadow)),ot.isMeshGouraudMaterial&&ot.envMap!==null&&(yi.envMap.value=ae,yi.flipEnvMap.value=ae.isCubeTexture&&ae.isRenderTargetTexture===!1?-1:1),ot.isMeshStandardMaterial&&ot.envMap===null&&j.environment!==null&&(yi.envMapIntensity.value=j.environmentIntensity),di&&(Tr.setValue(G,"toneMappingExposure",x.toneMappingExposure),ge.needsLights&&h4(yi,uc),Rt&&ot.fog===!0&&Gt.refreshFogUniforms(yi,Rt),Gt.refreshMaterialUniforms(yi,ot,I,O,m.state.transmissionRenderTarget[B.id]),hm.upload(G,IA(ge),yi,V)),ot.isShaderMaterial&&ot.uniformsNeedUpdate===!0&&(hm.upload(G,IA(ge),yi,V),ot.uniformsNeedUpdate=!1),ot.isSpriteMaterial&&Tr.setValue(G,"center",J.center),Tr.setValue(G,"modelViewMatrix",J.modelViewMatrix),Tr.setValue(G,"normalMatrix",J.normalMatrix),Tr.setValue(G,"modelMatrix",J.matrixWorld),ot.isShaderMaterial||ot.isRawShaderMaterial){const Rn=ot.uniformsGroups;for(let jn=0,S0=Rn.length;jn<S0;jn++){const js=Rn[jn];K.update(js,ji),K.bind(js,ji)}}return ji}function h4(B,j){B.ambientLightColor.needsUpdate=j,B.lightProbe.needsUpdate=j,B.directionalLights.needsUpdate=j,B.directionalLightShadows.needsUpdate=j,B.pointLights.needsUpdate=j,B.pointLightShadows.needsUpdate=j,B.spotLights.needsUpdate=j,B.spotLightShadows.needsUpdate=j,B.rectAreaLights.needsUpdate=j,B.hemisphereLights.needsUpdate=j}function f4(B){return B.isMeshLambertMaterial||B.isMeshToonMaterial||B.isMeshPhongMaterial||B.isMeshStandardMaterial||B.isShadowMaterial||B.isShaderMaterial&&B.lights===!0}this.getActiveCubeFace=function(){return S},this.getActiveMipmapLevel=function(){return M},this.getRenderTarget=function(){return w},this.setRenderTargetTextures=function(B,j,it){kt.get(B.texture).__webglTexture=j,kt.get(B.depthTexture).__webglTexture=it;const ot=kt.get(B);ot.__hasExternalTextures=!0,ot.__autoAllocateDepthBuffer=it===void 0,ot.__autoAllocateDepthBuffer||Pt.has("WEBGL_multisampled_render_to_texture")===!0&&(console.warn("THREE.WebGLRenderer: Render-to-texture extension was disabled because an external texture was provided"),ot.__useRenderToTexture=!1)},this.setRenderTargetFramebuffer=function(B,j){const it=kt.get(B);it.__webglFramebuffer=j,it.__useDefaultFramebuffer=j===void 0};const c4=G.createFramebuffer();this.setRenderTarget=function(B,j=0,it=0){w=B,S=j,M=it;let ot=!0,J=null,Rt=!1,Xt=!1;if(B){const ae=kt.get(B);if(ae.__useDefaultFramebuffer!==void 0)zt.bindFramebuffer(G.FRAMEBUFFER,null),ot=!1;else if(ae.__webglFramebuffer===void 0)V.setupRenderTarget(B);else if(ae.__hasExternalTextures)V.rebindTextures(B,kt.get(B.texture).__webglTexture,kt.get(B.depthTexture).__webglTexture);else if(B.depthBuffer){const ve=B.depthTexture;if(ae.__boundDepthTexture!==ve){if(ve!==null&&kt.has(ve)&&(B.width!==ve.image.width||B.height!==ve.image.height))throw new Error("WebGLRenderTarget: Attached DepthTexture is initialized to the incorrect size.");V.setupDepthRenderbuffer(B)}}const Te=B.texture;(Te.isData3DTexture||Te.isDataArrayTexture||Te.isCompressedArrayTexture)&&(Xt=!0);const Me=kt.get(B).__webglFramebuffer;B.isWebGLCubeRenderTarget?(Array.isArray(Me[j])?J=Me[j][it]:J=Me[j],Rt=!0):B.samples>0&&V.useMultisampledRTT(B)===!1?J=kt.get(B).__webglMultisampledFramebuffer:Array.isArray(Me)?J=Me[it]:J=Me,E.copy(B.viewport),C.copy(B.scissor),D=B.scissorTest}else E.copy(X).multiplyScalar(I).floor(),C.copy(Y).multiplyScalar(I).floor(),D=$;if(it!==0&&(J=c4),zt.bindFramebuffer(G.FRAMEBUFFER,J)&&ot&&zt.drawBuffers(B,J),zt.viewport(E),zt.scissor(C),zt.setScissorTest(D),Rt){const ae=kt.get(B.texture);G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_CUBE_MAP_POSITIVE_X+j,ae.__webglTexture,it)}else if(Xt){const ae=kt.get(B.texture),Te=j;G.framebufferTextureLayer(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,ae.__webglTexture,it,Te)}else if(B!==null&&it!==0){const ae=kt.get(B.texture);G.framebufferTexture2D(G.FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,ae.__webglTexture,it)}b=-1},this.readRenderTargetPixels=function(B,j,it,ot,J,Rt,Xt){if(!(B&&B.isWebGLRenderTarget)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");return}let ee=kt.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&Xt!==void 0&&(ee=ee[Xt]),ee){zt.bindFramebuffer(G.FRAMEBUFFER,ee);try{const ae=B.texture,Te=ae.format,Me=ae.type;if(!Lt.textureFormatReadable(Te)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");return}if(!Lt.textureTypeReadable(Me)){console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");return}j>=0&&j<=B.width-ot&&it>=0&&it<=B.height-J&&G.readPixels(j,it,ot,J,Oe.convert(Te),Oe.convert(Me),Rt)}finally{const ae=w!==null?kt.get(w).__webglFramebuffer:null;zt.bindFramebuffer(G.FRAMEBUFFER,ae)}}},this.readRenderTargetPixelsAsync=async function(B,j,it,ot,J,Rt,Xt){if(!(B&&B.isWebGLRenderTarget))throw new Error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");let ee=kt.get(B).__webglFramebuffer;if(B.isWebGLCubeRenderTarget&&Xt!==void 0&&(ee=ee[Xt]),ee){const ae=B.texture,Te=ae.format,Me=ae.type;if(!Lt.textureFormatReadable(Te))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in RGBA or implementation defined format.");if(!Lt.textureTypeReadable(Me))throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: renderTarget is not in UnsignedByteType or implementation defined type.");if(j>=0&&j<=B.width-ot&&it>=0&&it<=B.height-J){zt.bindFramebuffer(G.FRAMEBUFFER,ee);const ve=G.createBuffer();G.bindBuffer(G.PIXEL_PACK_BUFFER,ve),G.bufferData(G.PIXEL_PACK_BUFFER,Rt.byteLength,G.STREAM_READ),G.readPixels(j,it,ot,J,Oe.convert(Te),Oe.convert(Me),0);const Ke=w!==null?kt.get(w).__webglFramebuffer:null;zt.bindFramebuffer(G.FRAMEBUFFER,Ke);const ir=G.fenceSync(G.SYNC_GPU_COMMANDS_COMPLETE,0);return G.flush(),await But(G,ir,4),G.bindBuffer(G.PIXEL_PACK_BUFFER,ve),G.getBufferSubData(G.PIXEL_PACK_BUFFER,0,Rt),G.deleteBuffer(ve),G.deleteSync(ir),Rt}else throw new Error("THREE.WebGLRenderer.readRenderTargetPixelsAsync: requested read bounds are out of range.")}},this.copyFramebufferToTexture=function(B,j=null,it=0){B.isTexture!==!0&&(Hh("WebGLRenderer: copyFramebufferToTexture function signature has changed."),j=arguments[0]||null,B=arguments[1]);const ot=Math.pow(2,-it),J=Math.floor(B.image.width*ot),Rt=Math.floor(B.image.height*ot),Xt=j!==null?j.x:0,ee=j!==null?j.y:0;V.setTexture2D(B,0),G.copyTexSubImage2D(G.TEXTURE_2D,it,0,0,Xt,ee,J,Rt),zt.unbindTexture()};const d4=G.createFramebuffer(),v4=G.createFramebuffer();this.copyTextureToTexture=function(B,j,it=null,ot=null,J=0,Rt=null){B.isTexture!==!0&&(Hh("WebGLRenderer: copyTextureToTexture function signature has changed."),ot=arguments[0]||null,B=arguments[1],j=arguments[2],Rt=arguments[3]||0,it=null),Rt===null&&(J!==0?(Hh("WebGLRenderer: copyTextureToTexture function signature has changed to support src and dst mipmap levels."),Rt=J,J=0):Rt=0);let Xt,ee,ae,Te,Me,ve,Ke,ir,Gr;const Er=B.isCompressedTexture?B.mipmaps[Rt]:B.image;if(it!==null)Xt=it.max.x-it.min.x,ee=it.max.y-it.min.y,ae=it.isBox3?it.max.z-it.min.z:1,Te=it.min.x,Me=it.min.y,ve=it.isBox3?it.min.z:0;else{const xi=Math.pow(2,-J);Xt=Math.floor(Er.width*xi),ee=Math.floor(Er.height*xi),B.isDataArrayTexture?ae=Er.depth:B.isData3DTexture?ae=Math.floor(Er.depth*xi):ae=1,Te=0,Me=0,ve=0}ot!==null?(Ke=ot.x,ir=ot.y,Gr=ot.z):(Ke=0,ir=0,Gr=0);const Qe=Oe.convert(j.format),ge=Oe.convert(j.type);let _n;j.isData3DTexture?(V.setTexture3D(j,0),_n=G.TEXTURE_3D):j.isDataArrayTexture||j.isCompressedArrayTexture?(V.setTexture2DArray(j,0),_n=G.TEXTURE_2D_ARRAY):(V.setTexture2D(j,0),_n=G.TEXTURE_2D),G.pixelStorei(G.UNPACK_FLIP_Y_WEBGL,j.flipY),G.pixelStorei(G.UNPACK_PREMULTIPLY_ALPHA_WEBGL,j.premultiplyAlpha),G.pixelStorei(G.UNPACK_ALIGNMENT,j.unpackAlignment);const ar=G.getParameter(G.UNPACK_ROW_LENGTH),ji=G.getParameter(G.UNPACK_IMAGE_HEIGHT),Zu=G.getParameter(G.UNPACK_SKIP_PIXELS),di=G.getParameter(G.UNPACK_SKIP_ROWS),uc=G.getParameter(G.UNPACK_SKIP_IMAGES);G.pixelStorei(G.UNPACK_ROW_LENGTH,Er.width),G.pixelStorei(G.UNPACK_IMAGE_HEIGHT,Er.height),G.pixelStorei(G.UNPACK_SKIP_PIXELS,Te),G.pixelStorei(G.UNPACK_SKIP_ROWS,Me),G.pixelStorei(G.UNPACK_SKIP_IMAGES,ve);const Tr=B.isDataArrayTexture||B.isData3DTexture,yi=j.isDataArrayTexture||j.isData3DTexture;if(B.isDepthTexture){const xi=kt.get(B),Rn=kt.get(j),jn=kt.get(xi.__renderTarget),S0=kt.get(Rn.__renderTarget);zt.bindFramebuffer(G.READ_FRAMEBUFFER,jn.__webglFramebuffer),zt.bindFramebuffer(G.DRAW_FRAMEBUFFER,S0.__webglFramebuffer);for(let js=0;js<ae;js++)Tr&&(G.framebufferTextureLayer(G.READ_FRAMEBUFFER,G.COLOR_ATTACHMENT0,kt.get(B).__webglTexture,J,ve+js),G.framebufferTextureLayer(G.DRAW_FRAMEBUFFER,G.COLOR_ATTACHMENT0,kt.get(j).__webglTexture,Rt,Gr+js)),G.blitFramebuffer(Te,Me,Xt,ee,Ke,ir,Xt,ee,G.DEPTH_BUFFER_BIT,G.NEAREST);zt.bindFramebuffer(G.READ_FRAMEBUFFER,null),zt.bindFramebuffer(G.DRAW_FRAMEBUFFER,null)}else if(J!==0||B.isRenderTargetTexture||kt.has(B)){const xi=kt.get(B),Rn=kt.get(j);zt.bindFramebuffer(G.READ_FRAMEBUFFER,d4),zt.bindFramebuffer(G.DRAW_FRAMEBUFFER,v4);for(let jn=0;jn<ae;jn++)Tr?G.framebufferTextureLayer(G.READ_FRAMEBUFFER,G.COLOR_ATTACHMENT0,xi.__webglTexture,J,ve+jn):G.framebufferTexture2D(G.READ_FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,xi.__webglTexture,J),yi?G.framebufferTextureLayer(G.DRAW_FRAMEBUFFER,G.COLOR_ATTACHMENT0,Rn.__webglTexture,Rt,Gr+jn):G.framebufferTexture2D(G.DRAW_FRAMEBUFFER,G.COLOR_ATTACHMENT0,G.TEXTURE_2D,Rn.__webglTexture,Rt),J!==0?G.blitFramebuffer(Te,Me,Xt,ee,Ke,ir,Xt,ee,G.COLOR_BUFFER_BIT,G.NEAREST):yi?G.copyTexSubImage3D(_n,Rt,Ke,ir,Gr+jn,Te,Me,Xt,ee):G.copyTexSubImage2D(_n,Rt,Ke,ir,Te,Me,Xt,ee);zt.bindFramebuffer(G.READ_FRAMEBUFFER,null),zt.bindFramebuffer(G.DRAW_FRAMEBUFFER,null)}else yi?B.isDataTexture||B.isData3DTexture?G.texSubImage3D(_n,Rt,Ke,ir,Gr,Xt,ee,ae,Qe,ge,Er.data):j.isCompressedArrayTexture?G.compressedTexSubImage3D(_n,Rt,Ke,ir,Gr,Xt,ee,ae,Qe,Er.data):G.texSubImage3D(_n,Rt,Ke,ir,Gr,Xt,ee,ae,Qe,ge,Er):B.isDataTexture?G.texSubImage2D(G.TEXTURE_2D,Rt,Ke,ir,Xt,ee,Qe,ge,Er.data):B.isCompressedTexture?G.compressedTexSubImage2D(G.TEXTURE_2D,Rt,Ke,ir,Er.width,Er.height,Qe,Er.data):G.texSubImage2D(G.TEXTURE_2D,Rt,Ke,ir,Xt,ee,Qe,ge,Er);G.pixelStorei(G.UNPACK_ROW_LENGTH,ar),G.pixelStorei(G.UNPACK_IMAGE_HEIGHT,ji),G.pixelStorei(G.UNPACK_SKIP_PIXELS,Zu),G.pixelStorei(G.UNPACK_SKIP_ROWS,di),G.pixelStorei(G.UNPACK_SKIP_IMAGES,uc),Rt===0&&j.generateMipmaps&&G.generateMipmap(_n),zt.unbindTexture()},this.copyTextureToTexture3D=function(B,j,it=null,ot=null,J=0){return B.isTexture!==!0&&(Hh("WebGLRenderer: copyTextureToTexture3D function signature has changed."),it=arguments[0]||null,ot=arguments[1]||null,B=arguments[2],j=arguments[3],J=arguments[4]||0),Hh('WebGLRenderer: copyTextureToTexture3D function has been deprecated. Use "copyTextureToTexture" instead.'),this.copyTextureToTexture(B,j,it,ot,J)},this.initRenderTarget=function(B){kt.get(B).__webglFramebuffer===void 0&&V.setupRenderTarget(B)},this.initTexture=function(B){B.isCubeTexture?V.setTextureCube(B,0):B.isData3DTexture?V.setTexture3D(B,0):B.isDataArrayTexture||B.isCompressedArrayTexture?V.setTexture2DArray(B,0):V.setTexture2D(B,0),zt.unbindTexture()},this.resetState=function(){S=0,M=0,w=null,zt.reset(),gr.reset()},typeof __THREE_DEVTOOLS__<"u"&&__THREE_DEVTOOLS__.dispatchEvent(new CustomEvent("observe",{detail:this}))}get coordinateSystem(){return To}get outputColorSpace(){return this._outputColorSpace}set outputColorSpace(t){this._outputColorSpace=t;const r=this.getContext();r.drawingBufferColorspace=tr._getDrawingBufferColorSpace(t),r.unpackColorSpace=tr._getUnpackColorSpace()}}let Ig=null;const ept=(e,t,r,n,i)=>{var u;const a=document.getElementById("chart");Ig===null&&(Ig=sX(a)),Ig.setOption({large:!0,largeThreshold:1e3,title:{text:`Max Sum of Mains A, B, C: ${i.toFixed(4)} kWhs`,left:"center"},tooltip:{trigger:"axis"},legend:{data:["Mains A (kWhs)","Mains B (kWhs)","Mains C (kWhs)"],top:"bottom"},xAxis:{type:"category",data:e,name:"Timestamp",nameLocation:"middle",nameGap:25},yAxis:{type:"value",name:"kWhs",nameLocation:"middle",nameGap:40},series:[{name:"Mains A (kWhs)",type:"bar",data:t,itemStyle:{color:"red"}},{name:"Mains B (kWhs)",type:"bar",data:r,itemStyle:{color:"green"}},{type:"custom",data:n,renderItem:(h,f)=>{const c=f.value(0),d=f.value(1),v=f.value(2),p=new sc(1,1,1),g=new AA({color:16734003}),m=new ka(p,g);return m.position.set(c,d,v),h.context.scene.add(m),{}}}],dataZoom:[{type:"slider",xAxisIndex:0},{type:"inside",xAxisIndex:0}]});const o=document.getElementById("max-sum");o.textContent=`Max Sum of Mains A, B, C: ${i.toFixed(4)} kWhs`,(u=document.getElementById("reset-zoom"))==null||u.addEventListener("click",()=>{});const l=Ig.getDom().getContext("webgl");if(l){const h=new uht,f=new Bi(75,window.innerWidth/window.innerHeight,.1,1e3),c=new tpt({context:l});c.setSize(window.innerWidth,window.innerHeight);const d=new ght(4210752);h.add(d),f.position.z=10;const v=()=>{requestAnimationFrame(v),h.rotation.x+=.01,h.rotation.y+=.01,c.render(h,f)};v()}},rpt=e=>{const t=[],r=[],n=[],i=[];let a=0;y4.parse(e,{header:!0,dynamicTyping:!0,step:o=>{const s=o.data,l=s[Object.keys(s)[0]],u=$1(s,"Mains_A"),h=$1(s,"Mains_B"),f=$1(s,"Mains_C");if(u!==void 0&&h!==void 0&&f!==void 0){t.push(l),r.push(u),n.push(h),i.push(f);let c=0;isNaN(u)||(c+=u),isNaN(h)||(c+=h),isNaN(f)||(c+=f),c>a&&(a=c)}},complete:()=>{ept(t,r,n,i,a)},error:o=>{console.error("Error parsing CSV file:",o.message)}})},$1=(e,t)=>{for(let r in e)if(e.hasOwnProperty(r)&&r.includes(t))return e[r]},npt=document.getElementById("fileInput");npt.addEventListener("change",e=>{var r;const t=(r=e.target.files)==null?void 0:r[0];t&&rpt(t)});
